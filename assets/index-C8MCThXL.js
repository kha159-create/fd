(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function qE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Tm={exports:{}},tu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O_;function OC(){if(O_)return tu;O_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:n,type:i,key:u,ref:o!==void 0?o:null,props:l}}return tu.Fragment=e,tu.jsx=t,tu.jsxs=t,tu}var q_;function qC(){return q_||(q_=1,Tm.exports=OC()),Tm.exports}var f=qC(),Em={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F_;function FC(){if(F_)return Le;F_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),b=Symbol.iterator;function C(B){return B===null||typeof B!="object"?null:(B=b&&B[b]||B["@@iterator"],typeof B=="function"?B:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,G={};function ne(B,re,ye){this.props=B,this.context=re,this.refs=G,this.updater=ye||P}ne.prototype.isReactComponent={},ne.prototype.setState=function(B,re){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,re,"setState")},ne.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function j(){}j.prototype=ne.prototype;function q(B,re,ye){this.props=B,this.context=re,this.refs=G,this.updater=ye||P}var H=q.prototype=new j;H.constructor=q,O(H,ne.prototype),H.isPureReactComponent=!0;var Z=Array.isArray;function U(){}var N={H:null,A:null,T:null,S:null},w=Object.prototype.hasOwnProperty;function R(B,re,ye){var ve=ye.ref;return{$$typeof:n,type:B,key:re,ref:ve!==void 0?ve:null,props:ye}}function k(B,re){return R(B.type,re,B.props)}function V(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function F(B){var re={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ye){return re[ye]})}var D=/\/+/g;function ke(B,re){return typeof B=="object"&&B!==null&&B.key!=null?F(""+B.key):re.toString(36)}function fe(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(U,U):(B.status="pending",B.then(function(re){B.status==="pending"&&(B.status="fulfilled",B.value=re)},function(re){B.status==="pending"&&(B.status="rejected",B.reason=re)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function $(B,re,ye,ve,ie){var ce=typeof B;(ce==="undefined"||ce==="boolean")&&(B=null);var xe=!1;if(B===null)xe=!0;else switch(ce){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(B.$$typeof){case n:case e:xe=!0;break;case T:return xe=B._init,$(xe(B._payload),re,ye,ve,ie)}}if(xe)return ie=ie(B),xe=ve===""?"."+ke(B,0):ve,Z(ie)?(ye="",xe!=null&&(ye=xe.replace(D,"$&/")+"/"),$(ie,re,ye,"",function(An){return An})):ie!=null&&(V(ie)&&(ie=k(ie,ye+(ie.key==null||B&&B.key===ie.key?"":(""+ie.key).replace(D,"$&/")+"/")+xe)),re.push(ie)),1;xe=0;var Ze=ve===""?".":ve+":";if(Z(B))for(var nt=0;nt<B.length;nt++)ve=B[nt],ce=Ze+ke(ve,nt),xe+=$(ve,re,ye,ce,ie);else if(nt=C(B),typeof nt=="function")for(B=nt.call(B),nt=0;!(ve=B.next()).done;)ve=ve.value,ce=Ze+ke(ve,nt++),xe+=$(ve,re,ye,ce,ie);else if(ce==="object"){if(typeof B.then=="function")return $(fe(B),re,ye,ve,ie);throw re=String(B),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return xe}function de(B,re,ye){if(B==null)return B;var ve=[],ie=0;return $(B,ve,"","",function(ce){return re.call(ye,ce,ie++)}),ve}function _e(B){if(B._status===-1){var re=B._result;re=re(),re.then(function(ye){(B._status===0||B._status===-1)&&(B._status=1,B._result=ye)},function(ye){(B._status===0||B._status===-1)&&(B._status=2,B._result=ye)}),B._status===-1&&(B._status=0,B._result=re)}if(B._status===1)return B._result.default;throw B._result}var je=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},We={map:de,forEach:function(B,re,ye){de(B,function(){re.apply(this,arguments)},ye)},count:function(B){var re=0;return de(B,function(){re++}),re},toArray:function(B){return de(B,function(re){return re})||[]},only:function(B){if(!V(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return Le.Activity=E,Le.Children=We,Le.Component=ne,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=q,Le.StrictMode=i,Le.Suspense=g,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Le.__COMPILER_RUNTIME={__proto__:null,c:function(B){return N.H.useMemoCache(B)}},Le.cache=function(B){return function(){return B.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(B,re,ye){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var ve=O({},B.props),ie=B.key;if(re!=null)for(ce in re.key!==void 0&&(ie=""+re.key),re)!w.call(re,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&re.ref===void 0||(ve[ce]=re[ce]);var ce=arguments.length-2;if(ce===1)ve.children=ye;else if(1<ce){for(var xe=Array(ce),Ze=0;Ze<ce;Ze++)xe[Ze]=arguments[Ze+2];ve.children=xe}return R(B.type,ie,ve)},Le.createContext=function(B){return B={$$typeof:u,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},Le.createElement=function(B,re,ye){var ve,ie={},ce=null;if(re!=null)for(ve in re.key!==void 0&&(ce=""+re.key),re)w.call(re,ve)&&ve!=="key"&&ve!=="__self"&&ve!=="__source"&&(ie[ve]=re[ve]);var xe=arguments.length-2;if(xe===1)ie.children=ye;else if(1<xe){for(var Ze=Array(xe),nt=0;nt<xe;nt++)Ze[nt]=arguments[nt+2];ie.children=Ze}if(B&&B.defaultProps)for(ve in xe=B.defaultProps,xe)ie[ve]===void 0&&(ie[ve]=xe[ve]);return R(B,ce,ie)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(B){return{$$typeof:d,render:B}},Le.isValidElement=V,Le.lazy=function(B){return{$$typeof:T,_payload:{_status:-1,_result:B},_init:_e}},Le.memo=function(B,re){return{$$typeof:m,type:B,compare:re===void 0?null:re}},Le.startTransition=function(B){var re=N.T,ye={};N.T=ye;try{var ve=B(),ie=N.S;ie!==null&&ie(ye,ve),typeof ve=="object"&&ve!==null&&typeof ve.then=="function"&&ve.then(U,je)}catch(ce){je(ce)}finally{re!==null&&ye.types!==null&&(re.types=ye.types),N.T=re}},Le.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Le.use=function(B){return N.H.use(B)},Le.useActionState=function(B,re,ye){return N.H.useActionState(B,re,ye)},Le.useCallback=function(B,re){return N.H.useCallback(B,re)},Le.useContext=function(B){return N.H.useContext(B)},Le.useDebugValue=function(){},Le.useDeferredValue=function(B,re){return N.H.useDeferredValue(B,re)},Le.useEffect=function(B,re){return N.H.useEffect(B,re)},Le.useEffectEvent=function(B){return N.H.useEffectEvent(B)},Le.useId=function(){return N.H.useId()},Le.useImperativeHandle=function(B,re,ye){return N.H.useImperativeHandle(B,re,ye)},Le.useInsertionEffect=function(B,re){return N.H.useInsertionEffect(B,re)},Le.useLayoutEffect=function(B,re){return N.H.useLayoutEffect(B,re)},Le.useMemo=function(B,re){return N.H.useMemo(B,re)},Le.useOptimistic=function(B,re){return N.H.useOptimistic(B,re)},Le.useReducer=function(B,re,ye){return N.H.useReducer(B,re,ye)},Le.useRef=function(B){return N.H.useRef(B)},Le.useState=function(B){return N.H.useState(B)},Le.useSyncExternalStore=function(B,re,ye){return N.H.useSyncExternalStore(B,re,ye)},Le.useTransition=function(){return N.H.useTransition()},Le.version="19.2.0",Le}var j_;function Cp(){return j_||(j_=1,Em.exports=FC()),Em.exports}var he=Cp();const FE=qE(he);var xm={exports:{}},nu={},bm={exports:{}},Am={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B_;function jC(){return B_||(B_=1,(function(n){function e($,de){var _e=$.length;$.push(de);e:for(;0<_e;){var je=_e-1>>>1,We=$[je];if(0<o(We,de))$[je]=de,$[_e]=We,_e=je;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var de=$[0],_e=$.pop();if(_e!==de){$[0]=_e;e:for(var je=0,We=$.length,B=We>>>1;je<B;){var re=2*(je+1)-1,ye=$[re],ve=re+1,ie=$[ve];if(0>o(ye,_e))ve<We&&0>o(ie,ye)?($[je]=ie,$[ve]=_e,je=ve):($[je]=ye,$[re]=_e,je=re);else if(ve<We&&0>o(ie,_e))$[je]=ie,$[ve]=_e,je=ve;else break e}}return de}function o($,de){var _e=$.sortIndex-de.sortIndex;return _e!==0?_e:$.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var g=[],m=[],T=1,E=null,b=3,C=!1,P=!1,O=!1,G=!1,ne=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function H($){for(var de=t(m);de!==null;){if(de.callback===null)i(m);else if(de.startTime<=$)i(m),de.sortIndex=de.expirationTime,e(g,de);else break;de=t(m)}}function Z($){if(O=!1,H($),!P)if(t(g)!==null)P=!0,U||(U=!0,F());else{var de=t(m);de!==null&&fe(Z,de.startTime-$)}}var U=!1,N=-1,w=5,R=-1;function k(){return G?!0:!(n.unstable_now()-R<w)}function V(){if(G=!1,U){var $=n.unstable_now();R=$;var de=!0;try{e:{P=!1,O&&(O=!1,j(N),N=-1),C=!0;var _e=b;try{t:{for(H($),E=t(g);E!==null&&!(E.expirationTime>$&&k());){var je=E.callback;if(typeof je=="function"){E.callback=null,b=E.priorityLevel;var We=je(E.expirationTime<=$);if($=n.unstable_now(),typeof We=="function"){E.callback=We,H($),de=!0;break t}E===t(g)&&i(g),H($)}else i(g);E=t(g)}if(E!==null)de=!0;else{var B=t(m);B!==null&&fe(Z,B.startTime-$),de=!1}}break e}finally{E=null,b=_e,C=!1}de=void 0}}finally{de?F():U=!1}}}var F;if(typeof q=="function")F=function(){q(V)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,ke=D.port2;D.port1.onmessage=V,F=function(){ke.postMessage(null)}}else F=function(){ne(V,0)};function fe($,de){N=ne(function(){$(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function($){switch(b){case 1:case 2:case 3:var de=3;break;default:de=b}var _e=b;b=de;try{return $()}finally{b=_e}},n.unstable_requestPaint=function(){G=!0},n.unstable_runWithPriority=function($,de){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var _e=b;b=$;try{return de()}finally{b=_e}},n.unstable_scheduleCallback=function($,de,_e){var je=n.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?je+_e:je):_e=je,$){case 1:var We=-1;break;case 2:We=250;break;case 5:We=1073741823;break;case 4:We=1e4;break;default:We=5e3}return We=_e+We,$={id:T++,callback:de,priorityLevel:$,startTime:_e,expirationTime:We,sortIndex:-1},_e>je?($.sortIndex=_e,e(m,$),t(g)===null&&$===t(m)&&(O?(j(N),N=-1):O=!0,fe(Z,_e-je))):($.sortIndex=We,e(g,$),P||C||(P=!0,U||(U=!0,F()))),$},n.unstable_shouldYield=k,n.unstable_wrapCallback=function($){var de=b;return function(){var _e=b;b=de;try{return $.apply(this,arguments)}finally{b=_e}}}})(Am)),Am}var z_;function BC(){return z_||(z_=1,bm.exports=jC()),bm.exports}var Sm={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H_;function zC(){if(H_)return mn;H_=1;var n=Cp();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(g,m,T){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:E==null?null:""+E,children:g,containerInfo:m,implementation:T}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,mn.createPortal=function(g,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,T)},mn.flushSync=function(g){var m=u.T,T=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=T,i.d.f()}},mn.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},mn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},mn.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var T=m.as,E=d(T,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,C=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;T==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:E,integrity:b,fetchPriority:C}):T==="script"&&i.d.X(g,{crossOrigin:E,integrity:b,fetchPriority:C,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},mn.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var T=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},mn.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var T=m.as,E=d(T,m.crossOrigin);i.d.L(g,T,{crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},mn.preloadModule=function(g,m){if(typeof g=="string")if(m){var T=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},mn.requestFormReset=function(g){i.d.r(g)},mn.unstable_batchedUpdates=function(g,m){return g(m)},mn.useFormState=function(g,m,T){return u.H.useFormState(g,m,T)},mn.useFormStatus=function(){return u.H.useHostTransitionStatus()},mn.version="19.2.0",mn}var G_;function HC(){if(G_)return Sm.exports;G_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sm.exports=zC(),Sm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function GC(){if(Y_)return nu;Y_=1;var n=BC(),e=Cp(),t=HC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,a=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(a=r.return),s=r.return;while(s)}return r.tag===3?a:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var a=s,c=r;;){var _=a.return;if(_===null)break;var v=_.alternate;if(v===null){if(c=_.return,c!==null){a=c;continue}break}if(_.child===v.child){for(v=_.child;v;){if(v===a)return g(_),s;if(v===c)return g(_),r;v=v.sibling}throw Error(i(188))}if(a.return!==c.return)a=_,c=v;else{for(var A=!1,I=_.child;I;){if(I===a){A=!0,a=_,c=v;break}if(I===c){A=!0,c=_,a=v;break}I=I.sibling}if(!A){for(I=v.child;I;){if(I===a){A=!0,a=v,c=_;break}if(I===c){A=!0,c=v,a=_;break}I=I.sibling}if(!A)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?s:r}function T(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=T(s),r!==null)return r;s=s.sibling}return null}var E=Object.assign,b=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),q=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function ke(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case O:return"Fragment";case ne:return"Profiler";case G:return"StrictMode";case Z:return"Suspense";case U:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case P:return"Portal";case q:return s.displayName||"Context";case j:return(s._context.displayName||"Context")+".Consumer";case H:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return r=s.displayName||null,r!==null?r:ke(s.type)||"Memo";case w:r=s._payload,s=s._init;try{return ke(s(r))}catch{}}return null}var fe=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},je=[],We=-1;function B(s){return{current:s}}function re(s){0>We||(s.current=je[We],je[We]=null,We--)}function ye(s,r){We++,je[We]=s.current,s.current=r}var ve=B(null),ie=B(null),ce=B(null),xe=B(null);function Ze(s,r){switch(ye(ce,r),ye(ie,s),ye(ve,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?a_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=a_(r),s=l_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(ve),ye(ve,s)}function nt(){re(ve),re(ie),re(ce)}function An(s){s.memoizedState!==null&&ye(xe,s);var r=ve.current,a=l_(r,s.type);r!==a&&(ye(ie,s),ye(ve,a))}function Ct(s){ie.current===s&&(re(ve),re(ie)),xe.current===s&&(re(xe),Xl._currentValue=_e)}var bs,Ui;function zn(s){if(bs===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);bs=r&&r[1]||"",Ui=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bs+s+Ui}var Vr=!1;function Xs(s,r){if(!s||Vr)return"";Vr=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(te){var W=te}Reflect.construct(s,[],ae)}else{try{ae.call()}catch(te){W=te}s.call(ae.prototype)}}else{try{throw Error()}catch(te){W=te}(ae=s())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(te){if(te&&W&&typeof te.stack=="string")return[te.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),A=v[0],I=v[1];if(A&&I){var L=A.split(`
`),X=I.split(`
`);for(_=c=0;c<L.length&&!L[c].includes("DetermineComponentFrameRoot");)c++;for(;_<X.length&&!X[_].includes("DetermineComponentFrameRoot");)_++;if(c===L.length||_===X.length)for(c=L.length-1,_=X.length-1;1<=c&&0<=_&&L[c]!==X[_];)_--;for(;1<=c&&0<=_;c--,_--)if(L[c]!==X[_]){if(c!==1||_!==1)do if(c--,_--,0>_||L[c]!==X[_]){var se=`
`+L[c].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=c&&0<=_);break}}}finally{Vr=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?zn(a):""}function Lr(s,r){switch(s.tag){case 26:case 27:case 5:return zn(s.type);case 16:return zn("Lazy");case 13:return s.child!==r&&r!==null?zn("Suspense Fallback"):zn("Suspense");case 19:return zn("SuspenseList");case 0:case 15:return Xs(s.type,!1);case 11:return Xs(s.type.render,!1);case 1:return Xs(s.type,!0);case 31:return zn("Activity");default:return""}}function Ur(s){try{var r="",a=null;do r+=Lr(s,a),a=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Nt=Object.prototype.hasOwnProperty,Dt=n.unstable_scheduleCallback,rs=n.unstable_cancelCallback,tl=n.unstable_shouldYield,Or=n.unstable_requestPaint,Zt=n.unstable_now,As=n.unstable_getCurrentPriorityLevel,Oi=n.unstable_ImmediatePriority,qi=n.unstable_UserBlockingPriority,K=n.unstable_NormalPriority,me=n.unstable_LowPriority,pe=n.unstable_IdlePriority,Se=n.log,Ve=n.unstable_setDisableYieldValue,et=null,qt=null;function Tn(s){if(typeof Se=="function"&&Ve(s),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(et,s)}catch{}}var wt=Math.clz32?Math.clz32:Mo,Ro=Math.log,Fi=Math.LN2;function Mo(s){return s>>>=0,s===0?32:31-(Ro(s)/Fi|0)|0}var Te=256,vt=262144,ut=4194304;function Pt(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function hn(s,r,a){var c=s.pendingLanes;if(c===0)return 0;var _=0,v=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var I=c&134217727;return I!==0?(c=I&~v,c!==0?_=Pt(c):(A&=I,A!==0?_=Pt(A):a||(a=I&~s,a!==0&&(_=Pt(a))))):(I=c&~v,I!==0?_=Pt(I):A!==0?_=Pt(A):a||(a=c&~s,a!==0&&(_=Pt(a)))),_===0?0:r!==0&&r!==_&&(r&v)===0&&(v=_&-_,a=r&-r,v>=a||v===32&&(a&4194048)!==0)?r:_}function ze(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Af(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uu(){var s=ut;return ut<<=1,(ut&62914560)===0&&(ut=4194304),s}function Ss(s){for(var r=[],a=0;31>a;a++)r.push(s);return r}function qr(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Sf(s,r,a,c,_,v){var A=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var I=s.entanglements,L=s.expirationTimes,X=s.hiddenUpdates;for(a=A&~a;0<a;){var se=31-wt(a),ae=1<<se;I[se]=0,L[se]=-1;var W=X[se];if(W!==null)for(X[se]=null,se=0;se<W.length;se++){var te=W[se];te!==null&&(te.lane&=-536870913)}a&=~ae}c!==0&&Fr(s,c,0),v!==0&&_===0&&s.tag!==0&&(s.suspendedLanes|=v&~(A&~r))}function Fr(s,r,a){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-wt(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|a&261930}function nl(s,r){var a=s.entangledLanes|=r;for(s=s.entanglements;a;){var c=31-wt(a),_=1<<c;_&r|s[c]&r&&(s[c]|=r),a&=~_}}function sl(s,r){var a=r&-r;return a=(a&42)!==0?1:jr(a),(a&(s.suspendedLanes|r))!==0?0:a}function jr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ws(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ou(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:M_(s.type))}function os(s,r){var a=de.p;try{return de.p=s,r()}finally{de.p=a}}var as=Math.random().toString(36).slice(2),Ft="__reactFiber$"+as,en="__reactProps$"+as,Cs="__reactContainer$"+as,Do="__reactEvents$"+as,Cf="__reactListeners$"+as,qu="__reactHandles$"+as,Fu="__reactResources$"+as,ws="__reactMarker$"+as;function Po(s){delete s[Ft],delete s[en],delete s[Do],delete s[Cf],delete s[qu]}function Is(s){var r=s[Ft];if(r)return r;for(var a=s.parentNode;a;){if(r=a[Cs]||a[Ft]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(s=p_(s);s!==null;){if(a=s[Ft])return a;s=p_(s)}return r}s=a,a=s.parentNode}return null}function Hn(s){if(s=s[Ft]||s[Cs]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Pn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Ns(s){var r=s[Fu];return r||(r=s[Fu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function jt(s){s[ws]=!0}var il=new Set,rl={};function Rs(s,r){Ms(s,r),Ms(s+"Capture",r)}function Ms(s,r){for(rl[s]=r,s=0;s<r.length;s++)il.add(r[s])}var ol=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),al={},ll={};function ju(s){return Nt.call(ll,s)?!0:Nt.call(al,s)?!1:ol.test(s)?ll[s]=!0:(al[s]=!0,!1)}function ko(s,r,a){if(ju(r))if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+a)}}function kn(s,r,a){if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+a)}}function Bt(s,r,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(r,a,""+c)}}function tn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ji(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ul(s,r,a){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var _=c.get,v=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return _.call(this)},set:function(A){a=""+A,v.call(this,A)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(A){a=""+A},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function ct(s){if(!s._valueTracker){var r=ji(s)?"checked":"value";s._valueTracker=ul(s,r,""+s[r])}}function Br(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return s&&(c=ji(s)?s.checked?"true":"false":s.value),s=c,s!==a?(r.setValue(s),!0):!1}function Ds(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var zr=/[\n"\\]/g;function Sn(s){return s.replace(zr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Vo(s,r,a,c,_,v,A,I){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),r!=null?A==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+tn(r)):s.value!==""+tn(r)&&(s.value=""+tn(r)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),r!=null?cl(s,A,tn(r)):a!=null?cl(s,A,tn(a)):c!=null&&s.removeAttribute("value"),_==null&&v!=null&&(s.defaultChecked=!!v),_!=null&&(s.checked=_&&typeof _!="function"&&typeof _!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+tn(I):s.removeAttribute("name")}function Bu(s,r,a,c,_,v,A,I){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),r!=null||a!=null){if(!(v!=="submit"&&v!=="reset"||r!=null)){ct(s);return}a=a!=null?""+tn(a):"",r=r!=null?""+tn(r):a,I||r===s.value||(s.value=r),s.defaultValue=r}c=c??_,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=I?s.checked:!!c,s.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),ct(s)}function cl(s,r,a){r==="number"&&Ds(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function Bi(s,r,a,c){if(s=s.options,r){r={};for(var _=0;_<a.length;_++)r["$"+a[_]]=!0;for(a=0;a<s.length;a++)_=r.hasOwnProperty("$"+s[a].value),s[a].selected!==_&&(s[a].selected=_),_&&c&&(s[a].defaultSelected=!0)}else{for(a=""+tn(a),r=null,_=0;_<s.length;_++){if(s[_].value===a){s[_].selected=!0,c&&(s[_].defaultSelected=!0);return}r!==null||s[_].disabled||(r=s[_])}r!==null&&(r.selected=!0)}}function zu(s,r,a){if(r!=null&&(r=""+tn(r),r!==s.value&&(s.value=r),a==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=a!=null?""+tn(a):""}function zi(s,r,a,c){if(r==null){if(c!=null){if(a!=null)throw Error(i(92));if(fe(c)){if(1<c.length)throw Error(i(93));c=c[0]}a=c}a==null&&(a=""),r=a}a=tn(r),s.defaultValue=a,c=s.textContent,c===a&&c!==""&&c!==null&&(s.value=c),ct(s)}function Cn(s,r){if(r){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=r;return}}s.textContent=r}var Hu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function dl(s,r,a){var c=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,a):typeof a!="number"||a===0||Hu.has(r)?r==="float"?s.cssFloat=a:s[r]=(""+a).trim():s[r]=a+"px"}function fl(s,r,a){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var _ in r)c=r[_],r.hasOwnProperty(_)&&a[_]!==c&&dl(s,_,c)}else for(var v in r)r.hasOwnProperty(v)&&dl(s,v,r[v])}function Lo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Uo(s){return Hi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ls(){}var hl=null;function Gn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gi=null,Ps=null;function Hr(s){var r=Hn(s);if(r&&(s=r.stateNode)){var a=s[en]||null;e:switch(s=r.stateNode,r.type){case"input":if(Vo(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Sn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==s&&c.form===s.form){var _=c[en]||null;if(!_)throw Error(i(90));Vo(c,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(r=0;r<a.length;r++)c=a[r],c.form===s.form&&Br(c)}break e;case"textarea":zu(s,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Bi(s,!!a.multiple,r,!1)}}}var Oo=!1;function Yi(s,r,a){if(Oo)return s(r,a);Oo=!0;try{var c=s(r);return c}finally{if(Oo=!1,(Gi!==null||Ps!==null)&&(Oc(),Gi&&(r=Gi,s=Ps,Ps=Gi=null,Hr(r),s)))for(r=0;r<s.length;r++)Hr(s[r])}}function us(s,r){var a=s.stateNode;if(a===null)return null;var c=a[en]||null;if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gr=!1;if(Yn)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){Gr=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{Gr=!1}var ks=null,ml=null,Yr=null;function pl(){if(Yr)return Yr;var s,r=ml,a=r.length,c,_="value"in ks?ks.value:ks.textContent,v=_.length;for(s=0;s<a&&r[s]===_[s];s++);var A=a-s;for(c=1;c<=A&&r[a-c]===_[v-c];c++);return Yr=_.slice(s,1<c?1-c:void 0)}function $r(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Zs(){return!0}function cs(){return!1}function an(s){function r(a,c,_,v,A){this._reactName=a,this._targetInst=_,this.type=c,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(a=s[I],this[I]=a?a(v):v[I]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Zs:cs,this.isPropagationStopped=cs,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Zs)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Zs)},persist:function(){},isPersistent:Zs}),r}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vs=an(ei),$i=E({},ei,{view:0,detail:0}),gl=an($i),Ji,qo,Ls,Fo=E({},$i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ki,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ls&&(Ls&&s.type==="mousemove"?(Ji=s.screenX-Ls.screenX,qo=s.screenY-Ls.screenY):qo=Ji=0,Ls=s),Ji)},movementY:function(s){return"movementY"in s?s.movementY:qo}}),yl=an(Fo),Jr=E({},Fo,{dataTransfer:0}),Yu=an(Jr),$u=E({},$i,{relatedTarget:0}),Kr=an($u),_l=E({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),Ju=an(_l),jo=E({},ei,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ku=an(jo),Qu=E({},ei,{data:0}),Us=an(Qu),Xu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ec(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Zu[s])?!!r[s]:!1}function Ki(){return ec}var En=E({},$i,{key:function(s){if(s.key){var r=Xu[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=$r(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Wu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ki,charCode:function(s){return s.type==="keypress"?$r(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?$r(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),tc=an(En),nc=E({},Fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ti=an(nc),p=E({},$i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ki}),x=an(p),S=E({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=an(S),J=E({},Fo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ee=an(J),ge=E({},ei,{newState:0,oldState:0}),qe=an(ge),kt=[9,13,27,32],ot=Yn&&"CompositionEvent"in window,At=null;Yn&&"documentMode"in document&&(At=document.documentMode);var $n=Yn&&"TextEvent"in window&&!At,Os=Yn&&(!ot||At&&8<At&&11>=At),ds=" ",fs=!1;function Qr(s,r){switch(s){case"keyup":return kt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zo=!1;function lS(s,r){switch(s){case"compositionend":return Bo(r);case"keypress":return r.which!==32?null:(fs=!0,ds);case"textInput":return s=r.data,s===ds&&fs?null:s;default:return null}}function uS(s,r){if(zo)return s==="compositionend"||!ot&&Qr(s,r)?(s=pl(),Yr=ml=ks=null,zo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Os&&r.locale!=="ko"?null:r.data;default:return null}}var cS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!cS[s.type]:r==="textarea"}function vg(s,r,a,c){Gi?Ps?Ps.push(c):Ps=[c]:Gi=c,r=Gc(r,"onChange"),0<r.length&&(a=new Vs("onChange","change",null,a,c),s.push({event:a,listeners:r}))}var vl=null,Tl=null;function dS(s){t_(s,0)}function sc(s){var r=Pn(s);if(Br(r))return s}function Tg(s,r){if(s==="change")return r}var Eg=!1;if(Yn){var wf;if(Yn){var If="oninput"in document;if(!If){var xg=document.createElement("div");xg.setAttribute("oninput","return;"),If=typeof xg.oninput=="function"}wf=If}else wf=!1;Eg=wf&&(!document.documentMode||9<document.documentMode)}function bg(){vl&&(vl.detachEvent("onpropertychange",Ag),Tl=vl=null)}function Ag(s){if(s.propertyName==="value"&&sc(Tl)){var r=[];vg(r,Tl,s,Gn(s)),Yi(dS,r)}}function fS(s,r,a){s==="focusin"?(bg(),vl=r,Tl=a,vl.attachEvent("onpropertychange",Ag)):s==="focusout"&&bg()}function hS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return sc(Tl)}function mS(s,r){if(s==="click")return sc(r)}function pS(s,r){if(s==="input"||s==="change")return sc(r)}function gS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Vn=typeof Object.is=="function"?Object.is:gS;function El(s,r){if(Vn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var a=Object.keys(s),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var _=a[c];if(!Nt.call(r,_)||!Vn(s[_],r[_]))return!1}return!0}function Sg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Cg(s,r){var a=Sg(s);s=0;for(var c;a;){if(a.nodeType===3){if(c=s+a.textContent.length,s<=r&&c>=r)return{node:a,offset:r-s};s=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Sg(a)}}function wg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?wg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ig(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ds(s.document);r instanceof s.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)s=r.contentWindow;else break;r=Ds(s.document)}return r}function Nf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var yS=Yn&&"documentMode"in document&&11>=document.documentMode,Ho=null,Rf=null,xl=null,Mf=!1;function Ng(s,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Mf||Ho==null||Ho!==Ds(c)||(c=Ho,"selectionStart"in c&&Nf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),xl&&El(xl,c)||(xl=c,c=Gc(Rf,"onSelect"),0<c.length&&(r=new Vs("onSelect","select",null,r,a),s.push({event:r,listeners:c}),r.target=Ho)))}function Xr(s,r){var a={};return a[s.toLowerCase()]=r.toLowerCase(),a["Webkit"+s]="webkit"+r,a["Moz"+s]="moz"+r,a}var Go={animationend:Xr("Animation","AnimationEnd"),animationiteration:Xr("Animation","AnimationIteration"),animationstart:Xr("Animation","AnimationStart"),transitionrun:Xr("Transition","TransitionRun"),transitionstart:Xr("Transition","TransitionStart"),transitioncancel:Xr("Transition","TransitionCancel"),transitionend:Xr("Transition","TransitionEnd")},Df={},Rg={};Yn&&(Rg=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function Wr(s){if(Df[s])return Df[s];if(!Go[s])return s;var r=Go[s],a;for(a in r)if(r.hasOwnProperty(a)&&a in Rg)return Df[s]=r[a];return s}var Mg=Wr("animationend"),Dg=Wr("animationiteration"),Pg=Wr("animationstart"),_S=Wr("transitionrun"),vS=Wr("transitionstart"),TS=Wr("transitioncancel"),kg=Wr("transitionend"),Vg=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function hs(s,r){Vg.set(s,r),Rs(r,[s])}var ic=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Jn=[],Yo=0,kf=0;function rc(){for(var s=Yo,r=kf=Yo=0;r<s;){var a=Jn[r];Jn[r++]=null;var c=Jn[r];Jn[r++]=null;var _=Jn[r];Jn[r++]=null;var v=Jn[r];if(Jn[r++]=null,c!==null&&_!==null){var A=c.pending;A===null?_.next=_:(_.next=A.next,A.next=_),c.pending=_}v!==0&&Lg(a,_,v)}}function oc(s,r,a,c){Jn[Yo++]=s,Jn[Yo++]=r,Jn[Yo++]=a,Jn[Yo++]=c,kf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Vf(s,r,a,c){return oc(s,r,a,c),ac(s)}function Zr(s,r){return oc(s,null,null,r),ac(s)}function Lg(s,r,a){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a);for(var _=!1,v=s.return;v!==null;)v.childLanes|=a,c=v.alternate,c!==null&&(c.childLanes|=a),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(_=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,_&&r!==null&&(_=31-wt(a),s=v.hiddenUpdates,c=s[_],c===null?s[_]=[r]:c.push(r),r.lane=a|536870912),v):null}function ac(s){if(50<Hl)throw Hl=0,Hh=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var $o={};function ES(s,r,a,c){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(s,r,a,c){return new ES(s,r,a,c)}function Lf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ni(s,r){var a=s.alternate;return a===null?(a=Ln(s.tag,r,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=r,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,r=s.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function Ug(s,r){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,r=a.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function lc(s,r,a,c,_,v){var A=0;if(c=s,typeof s=="function")Lf(s)&&(A=1);else if(typeof s=="string")A=CC(s,a,ve.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Ln(31,a,r,_),s.elementType=R,s.lanes=v,s;case O:return eo(a.children,_,v,r);case G:A=8,_|=24;break;case ne:return s=Ln(12,a,r,_|2),s.elementType=ne,s.lanes=v,s;case Z:return s=Ln(13,a,r,_),s.elementType=Z,s.lanes=v,s;case U:return s=Ln(19,a,r,_),s.elementType=U,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case q:A=10;break e;case j:A=9;break e;case H:A=11;break e;case N:A=14;break e;case w:A=16,c=null;break e}A=29,a=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=Ln(A,a,r,_),r.elementType=s,r.type=c,r.lanes=v,r}function eo(s,r,a,c){return s=Ln(7,s,c,r),s.lanes=a,s}function Uf(s,r,a){return s=Ln(6,s,null,r),s.lanes=a,s}function Og(s){var r=Ln(18,null,null,0);return r.stateNode=s,r}function Of(s,r,a){return r=Ln(4,s.children!==null?s.children:[],s.key,r),r.lanes=a,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var qg=new WeakMap;function Kn(s,r){if(typeof s=="object"&&s!==null){var a=qg.get(s);return a!==void 0?a:(r={value:s,source:r,stack:Ur(r)},qg.set(s,r),r)}return{value:s,source:r,stack:Ur(r)}}var Jo=[],Ko=0,uc=null,bl=0,Qn=[],Xn=0,Qi=null,qs=1,Fs="";function si(s,r){Jo[Ko++]=bl,Jo[Ko++]=uc,uc=s,bl=r}function Fg(s,r,a){Qn[Xn++]=qs,Qn[Xn++]=Fs,Qn[Xn++]=Qi,Qi=s;var c=qs;s=Fs;var _=32-wt(c)-1;c&=~(1<<_),a+=1;var v=32-wt(r)+_;if(30<v){var A=_-_%5;v=(c&(1<<A)-1).toString(32),c>>=A,_-=A,qs=1<<32-wt(r)+_|a<<_|c,Fs=v+s}else qs=1<<v|a<<_|c,Fs=s}function qf(s){s.return!==null&&(si(s,1),Fg(s,1,0))}function Ff(s){for(;s===uc;)uc=Jo[--Ko],Jo[Ko]=null,bl=Jo[--Ko],Jo[Ko]=null;for(;s===Qi;)Qi=Qn[--Xn],Qn[Xn]=null,Fs=Qn[--Xn],Qn[Xn]=null,qs=Qn[--Xn],Qn[Xn]=null}function jg(s,r){Qn[Xn++]=qs,Qn[Xn++]=Fs,Qn[Xn++]=Qi,qs=r.id,Fs=r.overflow,Qi=s}var ln=null,Tt=null,Xe=!1,Xi=null,Wn=!1,jf=Error(i(519));function Wi(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Al(Kn(r,s)),jf}function Bg(s){var r=s.stateNode,a=s.type,c=s.memoizedProps;switch(r[Ft]=s,r[en]=c,a){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(a=0;a<Yl.length;a++)Ge(Yl[a],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ge("invalid",r),Bu(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ge("invalid",r);break;case"textarea":Ge("invalid",r),zi(r,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||c.suppressHydrationWarning===!0||r_(r.textContent,a)?(c.popover!=null&&(Ge("beforetoggle",r),Ge("toggle",r)),c.onScroll!=null&&Ge("scroll",r),c.onScrollEnd!=null&&Ge("scrollend",r),c.onClick!=null&&(r.onclick=ls),r=!0):r=!1,r||Wi(s,!0)}function zg(s){for(ln=s.return;ln;)switch(ln.tag){case 5:case 31:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:ln=ln.return}}function Qo(s){if(s!==ln)return!1;if(!Xe)return zg(s),Xe=!0,!1;var r=s.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||rm(s.type,s.memoizedProps)),a=!a),a&&Tt&&Wi(s),zg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Tt=m_(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Tt=m_(s)}else r===27?(r=Tt,fr(s.type)?(s=cm,cm=null,Tt=s):Tt=r):Tt=ln?es(s.stateNode.nextSibling):null;return!0}function to(){Tt=ln=null,Xe=!1}function Bf(){var s=Xi;return s!==null&&(Rn===null?Rn=s:Rn.push.apply(Rn,s),Xi=null),s}function Al(s){Xi===null?Xi=[s]:Xi.push(s)}var zf=B(null),no=null,ii=null;function Zi(s,r,a){ye(zf,r._currentValue),r._currentValue=a}function ri(s){s._currentValue=zf.current,re(zf)}function Hf(s,r,a){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===a)break;s=s.return}}function Gf(s,r,a,c){var _=s.child;for(_!==null&&(_.return=s);_!==null;){var v=_.dependencies;if(v!==null){var A=_.child;v=v.firstContext;e:for(;v!==null;){var I=v;v=_;for(var L=0;L<r.length;L++)if(I.context===r[L]){v.lanes|=a,I=v.alternate,I!==null&&(I.lanes|=a),Hf(v.return,a,s),c||(A=null);break e}v=I.next}}else if(_.tag===18){if(A=_.return,A===null)throw Error(i(341));A.lanes|=a,v=A.alternate,v!==null&&(v.lanes|=a),Hf(A,a,s),A=null}else A=_.child;if(A!==null)A.return=_;else for(A=_;A!==null;){if(A===s){A=null;break}if(_=A.sibling,_!==null){_.return=A.return,A=_;break}A=A.return}_=A}}function Xo(s,r,a,c){s=null;for(var _=r,v=!1;_!==null;){if(!v){if((_.flags&524288)!==0)v=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var A=_.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var I=_.type;Vn(_.pendingProps.value,A.value)||(s!==null?s.push(I):s=[I])}}else if(_===xe.current){if(A=_.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(s!==null?s.push(Xl):s=[Xl])}_=_.return}s!==null&&Gf(r,s,a,c),r.flags|=262144}function cc(s){for(s=s.firstContext;s!==null;){if(!Vn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function so(s){no=s,ii=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function un(s){return Hg(no,s)}function dc(s,r){return no===null&&so(s),Hg(s,r)}function Hg(s,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},ii===null){if(s===null)throw Error(i(308));ii=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ii=ii.next=r;return a}var xS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(a,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(a){return a()})}},bS=n.unstable_scheduleCallback,AS=n.unstable_NormalPriority,zt={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new xS,data:new Map,refCount:0}}function Sl(s){s.refCount--,s.refCount===0&&bS(AS,function(){s.controller.abort()})}var Cl=null,$f=0,Wo=0,Zo=null;function SS(s,r){if(Cl===null){var a=Cl=[];$f=0,Wo=Qh(),Zo={status:"pending",value:void 0,then:function(c){a.push(c)}}}return $f++,r.then(Gg,Gg),r}function Gg(){if(--$f===0&&Cl!==null){Zo!==null&&(Zo.status="fulfilled");var s=Cl;Cl=null,Wo=0,Zo=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function CS(s,r){var a=[],c={status:"pending",value:null,reason:null,then:function(_){a.push(_)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var _=0;_<a.length;_++)(0,a[_])(r)},function(_){for(c.status="rejected",c.reason=_,_=0;_<a.length;_++)(0,a[_])(void 0)}),c}var Yg=$.S;$.S=function(s,r){N0=Zt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&SS(s,r),Yg!==null&&Yg(s,r)};var io=B(null);function Jf(){var s=io.current;return s!==null?s:yt.pooledCache}function fc(s,r){r===null?ye(io,io.current):ye(io,r.pool)}function $g(){var s=Jf();return s===null?null:{parent:zt._currentValue,pool:s}}var ea=Error(i(460)),Kf=Error(i(474)),hc=Error(i(542)),mc={then:function(){}};function Jg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Kg(s,r,a){switch(a=s[a],a===void 0?s.push(r):a!==r&&(r.then(ls,ls),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Xg(s),s;default:if(typeof r.status=="string")r.then(ls,ls);else{if(s=yt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var _=r;_.status="fulfilled",_.value=c}},function(c){if(r.status==="pending"){var _=r;_.status="rejected",_.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Xg(s),s}throw oo=r,ea}}function ro(s){try{var r=s._init;return r(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(oo=a,ea):a}}var oo=null;function Qg(){if(oo===null)throw Error(i(459));var s=oo;return oo=null,s}function Xg(s){if(s===ea||s===hc)throw Error(i(483))}var ta=null,wl=0;function pc(s){var r=wl;return wl+=1,ta===null&&(ta=[]),Kg(ta,s,r)}function Il(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function gc(s,r){throw r.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Wg(s){function r(Y,z){if(s){var Q=Y.deletions;Q===null?(Y.deletions=[z],Y.flags|=16):Q.push(z)}}function a(Y,z){if(!s)return null;for(;z!==null;)r(Y,z),z=z.sibling;return null}function c(Y){for(var z=new Map;Y!==null;)Y.key!==null?z.set(Y.key,Y):z.set(Y.index,Y),Y=Y.sibling;return z}function _(Y,z){return Y=ni(Y,z),Y.index=0,Y.sibling=null,Y}function v(Y,z,Q){return Y.index=Q,s?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<z?(Y.flags|=67108866,z):Q):(Y.flags|=67108866,z)):(Y.flags|=1048576,z)}function A(Y){return s&&Y.alternate===null&&(Y.flags|=67108866),Y}function I(Y,z,Q,oe){return z===null||z.tag!==6?(z=Uf(Q,Y.mode,oe),z.return=Y,z):(z=_(z,Q),z.return=Y,z)}function L(Y,z,Q,oe){var Ie=Q.type;return Ie===O?se(Y,z,Q.props.children,oe,Q.key):z!==null&&(z.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===w&&ro(Ie)===z.type)?(z=_(z,Q.props),Il(z,Q),z.return=Y,z):(z=lc(Q.type,Q.key,Q.props,null,Y.mode,oe),Il(z,Q),z.return=Y,z)}function X(Y,z,Q,oe){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=Of(Q,Y.mode,oe),z.return=Y,z):(z=_(z,Q.children||[]),z.return=Y,z)}function se(Y,z,Q,oe,Ie){return z===null||z.tag!==7?(z=eo(Q,Y.mode,oe,Ie),z.return=Y,z):(z=_(z,Q),z.return=Y,z)}function ae(Y,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Uf(""+z,Y.mode,Q),z.return=Y,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case C:return Q=lc(z.type,z.key,z.props,null,Y.mode,Q),Il(Q,z),Q.return=Y,Q;case P:return z=Of(z,Y.mode,Q),z.return=Y,z;case w:return z=ro(z),ae(Y,z,Q)}if(fe(z)||F(z))return z=eo(z,Y.mode,Q,null),z.return=Y,z;if(typeof z.then=="function")return ae(Y,pc(z),Q);if(z.$$typeof===q)return ae(Y,dc(Y,z),Q);gc(Y,z)}return null}function W(Y,z,Q,oe){var Ie=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ie!==null?null:I(Y,z,""+Q,oe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case C:return Q.key===Ie?L(Y,z,Q,oe):null;case P:return Q.key===Ie?X(Y,z,Q,oe):null;case w:return Q=ro(Q),W(Y,z,Q,oe)}if(fe(Q)||F(Q))return Ie!==null?null:se(Y,z,Q,oe,null);if(typeof Q.then=="function")return W(Y,z,pc(Q),oe);if(Q.$$typeof===q)return W(Y,z,dc(Y,Q),oe);gc(Y,Q)}return null}function te(Y,z,Q,oe,Ie){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Y=Y.get(Q)||null,I(z,Y,""+oe,Ie);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case C:return Y=Y.get(oe.key===null?Q:oe.key)||null,L(z,Y,oe,Ie);case P:return Y=Y.get(oe.key===null?Q:oe.key)||null,X(z,Y,oe,Ie);case w:return oe=ro(oe),te(Y,z,Q,oe,Ie)}if(fe(oe)||F(oe))return Y=Y.get(Q)||null,se(z,Y,oe,Ie,null);if(typeof oe.then=="function")return te(Y,z,Q,pc(oe),Ie);if(oe.$$typeof===q)return te(Y,z,Q,dc(z,oe),Ie);gc(z,oe)}return null}function be(Y,z,Q,oe){for(var Ie=null,st=null,we=z,Be=z=0,$e=null;we!==null&&Be<Q.length;Be++){we.index>Be?($e=we,we=null):$e=we.sibling;var it=W(Y,we,Q[Be],oe);if(it===null){we===null&&(we=$e);break}s&&we&&it.alternate===null&&r(Y,we),z=v(it,z,Be),st===null?Ie=it:st.sibling=it,st=it,we=$e}if(Be===Q.length)return a(Y,we),Xe&&si(Y,Be),Ie;if(we===null){for(;Be<Q.length;Be++)we=ae(Y,Q[Be],oe),we!==null&&(z=v(we,z,Be),st===null?Ie=we:st.sibling=we,st=we);return Xe&&si(Y,Be),Ie}for(we=c(we);Be<Q.length;Be++)$e=te(we,Y,Be,Q[Be],oe),$e!==null&&(s&&$e.alternate!==null&&we.delete($e.key===null?Be:$e.key),z=v($e,z,Be),st===null?Ie=$e:st.sibling=$e,st=$e);return s&&we.forEach(function(yr){return r(Y,yr)}),Xe&&si(Y,Be),Ie}function Re(Y,z,Q,oe){if(Q==null)throw Error(i(151));for(var Ie=null,st=null,we=z,Be=z=0,$e=null,it=Q.next();we!==null&&!it.done;Be++,it=Q.next()){we.index>Be?($e=we,we=null):$e=we.sibling;var yr=W(Y,we,it.value,oe);if(yr===null){we===null&&(we=$e);break}s&&we&&yr.alternate===null&&r(Y,we),z=v(yr,z,Be),st===null?Ie=yr:st.sibling=yr,st=yr,we=$e}if(it.done)return a(Y,we),Xe&&si(Y,Be),Ie;if(we===null){for(;!it.done;Be++,it=Q.next())it=ae(Y,it.value,oe),it!==null&&(z=v(it,z,Be),st===null?Ie=it:st.sibling=it,st=it);return Xe&&si(Y,Be),Ie}for(we=c(we);!it.done;Be++,it=Q.next())it=te(we,Y,Be,it.value,oe),it!==null&&(s&&it.alternate!==null&&we.delete(it.key===null?Be:it.key),z=v(it,z,Be),st===null?Ie=it:st.sibling=it,st=it);return s&&we.forEach(function(UC){return r(Y,UC)}),Xe&&si(Y,Be),Ie}function gt(Y,z,Q,oe){if(typeof Q=="object"&&Q!==null&&Q.type===O&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case C:e:{for(var Ie=Q.key;z!==null;){if(z.key===Ie){if(Ie=Q.type,Ie===O){if(z.tag===7){a(Y,z.sibling),oe=_(z,Q.props.children),oe.return=Y,Y=oe;break e}}else if(z.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===w&&ro(Ie)===z.type){a(Y,z.sibling),oe=_(z,Q.props),Il(oe,Q),oe.return=Y,Y=oe;break e}a(Y,z);break}else r(Y,z);z=z.sibling}Q.type===O?(oe=eo(Q.props.children,Y.mode,oe,Q.key),oe.return=Y,Y=oe):(oe=lc(Q.type,Q.key,Q.props,null,Y.mode,oe),Il(oe,Q),oe.return=Y,Y=oe)}return A(Y);case P:e:{for(Ie=Q.key;z!==null;){if(z.key===Ie)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){a(Y,z.sibling),oe=_(z,Q.children||[]),oe.return=Y,Y=oe;break e}else{a(Y,z);break}else r(Y,z);z=z.sibling}oe=Of(Q,Y.mode,oe),oe.return=Y,Y=oe}return A(Y);case w:return Q=ro(Q),gt(Y,z,Q,oe)}if(fe(Q))return be(Y,z,Q,oe);if(F(Q)){if(Ie=F(Q),typeof Ie!="function")throw Error(i(150));return Q=Ie.call(Q),Re(Y,z,Q,oe)}if(typeof Q.then=="function")return gt(Y,z,pc(Q),oe);if(Q.$$typeof===q)return gt(Y,z,dc(Y,Q),oe);gc(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,z!==null&&z.tag===6?(a(Y,z.sibling),oe=_(z,Q),oe.return=Y,Y=oe):(a(Y,z),oe=Uf(Q,Y.mode,oe),oe.return=Y,Y=oe),A(Y)):a(Y,z)}return function(Y,z,Q,oe){try{wl=0;var Ie=gt(Y,z,Q,oe);return ta=null,Ie}catch(we){if(we===ea||we===hc)throw we;var st=Ln(29,we,null,Y.mode);return st.lanes=oe,st.return=Y,st}finally{}}}var ao=Wg(!0),Zg=Wg(!1),er=!1;function Qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function tr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function nr(s,r,a){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var _=c.pending;return _===null?r.next=r:(r.next=_.next,_.next=r),c.pending=r,r=ac(s),Lg(s,null,a),r}return oc(s,c,r,a),ac(s)}function Nl(s,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,nl(s,a)}}function Wf(s,r){var a=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var _=null,v=null;if(a=a.firstBaseUpdate,a!==null){do{var A={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};v===null?_=v=A:v=v.next=A,a=a.next}while(a!==null);v===null?_=v=r:v=v.next=r}else _=v=r;a={baseState:c.baseState,firstBaseUpdate:_,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=r:s.next=r,a.lastBaseUpdate=r}var Zf=!1;function Rl(){if(Zf){var s=Zo;if(s!==null)throw s}}function Ml(s,r,a,c){Zf=!1;var _=s.updateQueue;er=!1;var v=_.firstBaseUpdate,A=_.lastBaseUpdate,I=_.shared.pending;if(I!==null){_.shared.pending=null;var L=I,X=L.next;L.next=null,A===null?v=X:A.next=X,A=L;var se=s.alternate;se!==null&&(se=se.updateQueue,I=se.lastBaseUpdate,I!==A&&(I===null?se.firstBaseUpdate=X:I.next=X,se.lastBaseUpdate=L))}if(v!==null){var ae=_.baseState;A=0,se=X=L=null,I=v;do{var W=I.lane&-536870913,te=W!==I.lane;if(te?(Ye&W)===W:(c&W)===W){W!==0&&W===Wo&&(Zf=!0),se!==null&&(se=se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var be=s,Re=I;W=r;var gt=a;switch(Re.tag){case 1:if(be=Re.payload,typeof be=="function"){ae=be.call(gt,ae,W);break e}ae=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Re.payload,W=typeof be=="function"?be.call(gt,ae,W):be,W==null)break e;ae=E({},ae,W);break e;case 2:er=!0}}W=I.callback,W!==null&&(s.flags|=64,te&&(s.flags|=8192),te=_.callbacks,te===null?_.callbacks=[W]:te.push(W))}else te={lane:W,tag:I.tag,payload:I.payload,callback:I.callback,next:null},se===null?(X=se=te,L=ae):se=se.next=te,A|=W;if(I=I.next,I===null){if(I=_.shared.pending,I===null)break;te=I,I=te.next,te.next=null,_.lastBaseUpdate=te,_.shared.pending=null}}while(!0);se===null&&(L=ae),_.baseState=L,_.firstBaseUpdate=X,_.lastBaseUpdate=se,v===null&&(_.shared.lanes=0),ar|=A,s.lanes=A,s.memoizedState=ae}}function ey(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function ty(s,r){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)ey(a[s],r)}var na=B(null),yc=B(0);function ny(s,r){s=mi,ye(yc,s),ye(na,r),mi=s|r.baseLanes}function eh(){ye(yc,mi),ye(na,na.current)}function th(){mi=yc.current,re(na),re(yc)}var Un=B(null),Zn=null;function sr(s){var r=s.alternate;ye(Vt,Vt.current&1),ye(Un,s),Zn===null&&(r===null||na.current!==null||r.memoizedState!==null)&&(Zn=s)}function nh(s){ye(Vt,Vt.current),ye(Un,s),Zn===null&&(Zn=s)}function sy(s){s.tag===22?(ye(Vt,Vt.current),ye(Un,s),Zn===null&&(Zn=s)):ir()}function ir(){ye(Vt,Vt.current),ye(Un,Un.current)}function On(s){re(Un),Zn===s&&(Zn=null),re(Vt)}var Vt=B(0);function _c(s){for(var r=s;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||lm(a)||um(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var oi=0,Fe=null,mt=null,Ht=null,vc=!1,sa=!1,lo=!1,Tc=0,Dl=0,ia=null,wS=0;function Rt(){throw Error(i(321))}function sh(s,r){if(r===null)return!1;for(var a=0;a<r.length&&a<s.length;a++)if(!Vn(s[a],r[a]))return!1;return!0}function ih(s,r,a,c,_,v){return oi=v,Fe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,$.H=s===null||s.memoizedState===null?Fy:vh,lo=!1,v=a(c,_),lo=!1,sa&&(v=ry(r,a,c,_)),iy(s),v}function iy(s){$.H=Vl;var r=mt!==null&&mt.next!==null;if(oi=0,Ht=mt=Fe=null,vc=!1,Dl=0,ia=null,r)throw Error(i(300));s===null||Gt||(s=s.dependencies,s!==null&&cc(s)&&(Gt=!0))}function ry(s,r,a,c){Fe=s;var _=0;do{if(sa&&(ia=null),Dl=0,sa=!1,25<=_)throw Error(i(301));if(_+=1,Ht=mt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}$.H=jy,v=r(a,c)}while(sa);return v}function IS(){var s=$.H,r=s.useState()[0];return r=typeof r.then=="function"?Pl(r):r,s=s.useState()[0],(mt!==null?mt.memoizedState:null)!==s&&(Fe.flags|=1024),r}function rh(){var s=Tc!==0;return Tc=0,s}function oh(s,r,a){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~a}function ah(s){if(vc){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}vc=!1}oi=0,Ht=mt=Fe=null,sa=!1,Dl=Tc=0,ia=null}function xn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?Fe.memoizedState=Ht=s:Ht=Ht.next=s,Ht}function Lt(){if(mt===null){var s=Fe.alternate;s=s!==null?s.memoizedState:null}else s=mt.next;var r=Ht===null?Fe.memoizedState:Ht.next;if(r!==null)Ht=r,mt=s;else{if(s===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));mt=s,s={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Ht===null?Fe.memoizedState=Ht=s:Ht=Ht.next=s}return Ht}function Ec(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pl(s){var r=Dl;return Dl+=1,ia===null&&(ia=[]),s=Kg(ia,s,r),r=Fe,(Ht===null?r.memoizedState:Ht.next)===null&&(r=r.alternate,$.H=r===null||r.memoizedState===null?Fy:vh),s}function xc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Pl(s);if(s.$$typeof===q)return un(s)}throw Error(i(438,String(s)))}function lh(s){var r=null,a=Fe.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var c=Fe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(_){return _.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=Ec(),Fe.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(s),c=0;c<s;c++)a[c]=k;return r.index++,a}function ai(s,r){return typeof r=="function"?r(s):r}function bc(s){var r=Lt();return uh(r,mt,s)}function uh(s,r,a){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var _=s.baseQueue,v=c.pending;if(v!==null){if(_!==null){var A=_.next;_.next=v.next,v.next=A}r.baseQueue=_=v,c.pending=null}if(v=s.baseState,_===null)s.memoizedState=v;else{r=_.next;var I=A=null,L=null,X=r,se=!1;do{var ae=X.lane&-536870913;if(ae!==X.lane?(Ye&ae)===ae:(oi&ae)===ae){var W=X.revertLane;if(W===0)L!==null&&(L=L.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),ae===Wo&&(se=!0);else if((oi&W)===W){X=X.next,W===Wo&&(se=!0);continue}else ae={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},L===null?(I=L=ae,A=v):L=L.next=ae,Fe.lanes|=W,ar|=W;ae=X.action,lo&&a(v,ae),v=X.hasEagerState?X.eagerState:a(v,ae)}else W={lane:ae,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},L===null?(I=L=W,A=v):L=L.next=W,Fe.lanes|=ae,ar|=ae;X=X.next}while(X!==null&&X!==r);if(L===null?A=v:L.next=I,!Vn(v,s.memoizedState)&&(Gt=!0,se&&(a=Zo,a!==null)))throw a;s.memoizedState=v,s.baseState=A,s.baseQueue=L,c.lastRenderedState=v}return _===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function ch(s){var r=Lt(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=s;var c=a.dispatch,_=a.pending,v=r.memoizedState;if(_!==null){a.pending=null;var A=_=_.next;do v=s(v,A.action),A=A.next;while(A!==_);Vn(v,r.memoizedState)||(Gt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),a.lastRenderedState=v}return[v,c]}function oy(s,r,a){var c=Fe,_=Lt(),v=Xe;if(v){if(a===void 0)throw Error(i(407));a=a()}else a=r();var A=!Vn((mt||_).memoizedState,a);if(A&&(_.memoizedState=a,Gt=!0),_=_.queue,hh(uy.bind(null,c,_,s),[s]),_.getSnapshot!==r||A||Ht!==null&&Ht.memoizedState.tag&1){if(c.flags|=2048,ra(9,{destroy:void 0},ly.bind(null,c,_,a,r),null),yt===null)throw Error(i(349));v||(oi&127)!==0||ay(c,r,a)}return a}function ay(s,r,a){s.flags|=16384,s={getSnapshot:r,value:a},r=Fe.updateQueue,r===null?(r=Ec(),Fe.updateQueue=r,r.stores=[s]):(a=r.stores,a===null?r.stores=[s]:a.push(s))}function ly(s,r,a,c){r.value=a,r.getSnapshot=c,cy(r)&&dy(s)}function uy(s,r,a){return a(function(){cy(r)&&dy(s)})}function cy(s){var r=s.getSnapshot;s=s.value;try{var a=r();return!Vn(s,a)}catch{return!0}}function dy(s){var r=Zr(s,2);r!==null&&Mn(r,s,2)}function dh(s){var r=xn();if(typeof s=="function"){var a=s;if(s=a(),lo){Tn(!0);try{a()}finally{Tn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:s},r}function fy(s,r,a,c){return s.baseState=a,uh(s,mt,typeof c=="function"?c:ai)}function NS(s,r,a,c,_){if(Cc(s))throw Error(i(485));if(s=r.action,s!==null){var v={payload:_,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){v.listeners.push(A)}};$.T!==null?a(!0):v.isTransition=!1,c(v),a=r.pending,a===null?(v.next=r.pending=v,hy(r,v)):(v.next=a.next,r.pending=a.next=v)}}function hy(s,r){var a=r.action,c=r.payload,_=s.state;if(r.isTransition){var v=$.T,A={};$.T=A;try{var I=a(_,c),L=$.S;L!==null&&L(A,I),my(s,r,I)}catch(X){fh(s,r,X)}finally{v!==null&&A.types!==null&&(v.types=A.types),$.T=v}}else try{v=a(_,c),my(s,r,v)}catch(X){fh(s,r,X)}}function my(s,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){py(s,r,c)},function(c){return fh(s,r,c)}):py(s,r,a)}function py(s,r,a){r.status="fulfilled",r.value=a,gy(r),s.state=a,r=s.pending,r!==null&&(a=r.next,a===r?s.pending=null:(a=a.next,r.next=a,hy(s,a)))}function fh(s,r,a){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=a,gy(r),r=r.next;while(r!==c)}s.action=null}function gy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function yy(s,r){return r}function _y(s,r){if(Xe){var a=yt.formState;if(a!==null){e:{var c=Fe;if(Xe){if(Tt){t:{for(var _=Tt,v=Wn;_.nodeType!==8;){if(!v){_=null;break t}if(_=es(_.nextSibling),_===null){_=null;break t}}v=_.data,_=v==="F!"||v==="F"?_:null}if(_){Tt=es(_.nextSibling),c=_.data==="F!";break e}}Wi(c)}c=!1}c&&(r=a[0])}}return a=xn(),a.memoizedState=a.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yy,lastRenderedState:r},a.queue=c,a=Uy.bind(null,Fe,c),c.dispatch=a,c=dh(!1),v=_h.bind(null,Fe,!1,c.queue),c=xn(),_={state:r,dispatch:null,action:s,pending:null},c.queue=_,a=NS.bind(null,Fe,_,v,a),_.dispatch=a,c.memoizedState=s,[r,a,!1]}function vy(s){var r=Lt();return Ty(r,mt,s)}function Ty(s,r,a){if(r=uh(s,r,yy)[0],s=bc(ai)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Pl(r)}catch(A){throw A===ea?hc:A}else c=r;r=Lt();var _=r.queue,v=_.dispatch;return a!==r.memoizedState&&(Fe.flags|=2048,ra(9,{destroy:void 0},RS.bind(null,_,a),null)),[c,v,s]}function RS(s,r){s.action=r}function Ey(s){var r=Lt(),a=mt;if(a!==null)return Ty(r,a,s);Lt(),r=r.memoizedState,a=Lt();var c=a.queue.dispatch;return a.memoizedState=s,[r,c,!1]}function ra(s,r,a,c){return s={tag:s,create:a,deps:c,inst:r,next:null},r=Fe.updateQueue,r===null&&(r=Ec(),Fe.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=s.next=s:(c=a.next,a.next=s,s.next=c,r.lastEffect=s),s}function xy(){return Lt().memoizedState}function Ac(s,r,a,c){var _=xn();Fe.flags|=s,_.memoizedState=ra(1|r,{destroy:void 0},a,c===void 0?null:c)}function Sc(s,r,a,c){var _=Lt();c=c===void 0?null:c;var v=_.memoizedState.inst;mt!==null&&c!==null&&sh(c,mt.memoizedState.deps)?_.memoizedState=ra(r,v,a,c):(Fe.flags|=s,_.memoizedState=ra(1|r,v,a,c))}function by(s,r){Ac(8390656,8,s,r)}function hh(s,r){Sc(2048,8,s,r)}function MS(s){Fe.flags|=4;var r=Fe.updateQueue;if(r===null)r=Ec(),Fe.updateQueue=r,r.events=[s];else{var a=r.events;a===null?r.events=[s]:a.push(s)}}function Ay(s){var r=Lt().memoizedState;return MS({ref:r,nextImpl:s}),function(){if((at&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Sy(s,r){return Sc(4,2,s,r)}function Cy(s,r){return Sc(4,4,s,r)}function wy(s,r){if(typeof r=="function"){s=s();var a=r(s);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Iy(s,r,a){a=a!=null?a.concat([s]):null,Sc(4,4,wy.bind(null,r,s),a)}function mh(){}function Ny(s,r){var a=Lt();r=r===void 0?null:r;var c=a.memoizedState;return r!==null&&sh(r,c[1])?c[0]:(a.memoizedState=[s,r],s)}function Ry(s,r){var a=Lt();r=r===void 0?null:r;var c=a.memoizedState;if(r!==null&&sh(r,c[1]))return c[0];if(c=s(),lo){Tn(!0);try{s()}finally{Tn(!1)}}return a.memoizedState=[c,r],c}function ph(s,r,a){return a===void 0||(oi&1073741824)!==0&&(Ye&261930)===0?s.memoizedState=r:(s.memoizedState=a,s=M0(),Fe.lanes|=s,ar|=s,a)}function My(s,r,a,c){return Vn(a,r)?a:na.current!==null?(s=ph(s,a,c),Vn(s,r)||(Gt=!0),s):(oi&42)===0||(oi&1073741824)!==0&&(Ye&261930)===0?(Gt=!0,s.memoizedState=a):(s=M0(),Fe.lanes|=s,ar|=s,r)}function Dy(s,r,a,c,_){var v=de.p;de.p=v!==0&&8>v?v:8;var A=$.T,I={};$.T=I,_h(s,!1,r,a);try{var L=_(),X=$.S;if(X!==null&&X(I,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var se=CS(L,c);kl(s,r,se,jn(s))}else kl(s,r,c,jn(s))}catch(ae){kl(s,r,{then:function(){},status:"rejected",reason:ae},jn())}finally{de.p=v,A!==null&&I.types!==null&&(A.types=I.types),$.T=A}}function DS(){}function gh(s,r,a,c){if(s.tag!==5)throw Error(i(476));var _=Py(s).queue;Dy(s,_,r,_e,a===null?DS:function(){return ky(s),a(c)})}function Py(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:_e},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:a},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function ky(s){var r=Py(s);r.next===null&&(r=s.alternate.memoizedState),kl(s,r.next.queue,{},jn())}function yh(){return un(Xl)}function Vy(){return Lt().memoizedState}function Ly(){return Lt().memoizedState}function PS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var a=jn();s=tr(a);var c=nr(r,s,a);c!==null&&(Mn(c,r,a),Nl(c,r,a)),r={cache:Yf()},s.payload=r;return}r=r.return}}function kS(s,r,a){var c=jn();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Cc(s)?Oy(r,a):(a=Vf(s,r,a,c),a!==null&&(Mn(a,s,c),qy(a,r,c)))}function Uy(s,r,a){var c=jn();kl(s,r,a,c)}function kl(s,r,a,c){var _={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Cc(s))Oy(r,_);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var A=r.lastRenderedState,I=v(A,a);if(_.hasEagerState=!0,_.eagerState=I,Vn(I,A))return oc(s,r,_,0),yt===null&&rc(),!1}catch{}finally{}if(a=Vf(s,r,_,c),a!==null)return Mn(a,s,c),qy(a,r,c),!0}return!1}function _h(s,r,a,c){if(c={lane:2,revertLane:Qh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Cc(s)){if(r)throw Error(i(479))}else r=Vf(s,a,c,2),r!==null&&Mn(r,s,2)}function Cc(s){var r=s.alternate;return s===Fe||r!==null&&r===Fe}function Oy(s,r){sa=vc=!0;var a=s.pending;a===null?r.next=r:(r.next=a.next,a.next=r),s.pending=r}function qy(s,r,a){if((a&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,nl(s,a)}}var Vl={readContext:un,use:xc,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};Vl.useEffectEvent=Rt;var Fy={readContext:un,use:xc,useCallback:function(s,r){return xn().memoizedState=[s,r===void 0?null:r],s},useContext:un,useEffect:by,useImperativeHandle:function(s,r,a){a=a!=null?a.concat([s]):null,Ac(4194308,4,wy.bind(null,r,s),a)},useLayoutEffect:function(s,r){return Ac(4194308,4,s,r)},useInsertionEffect:function(s,r){Ac(4,2,s,r)},useMemo:function(s,r){var a=xn();r=r===void 0?null:r;var c=s();if(lo){Tn(!0);try{s()}finally{Tn(!1)}}return a.memoizedState=[c,r],c},useReducer:function(s,r,a){var c=xn();if(a!==void 0){var _=a(r);if(lo){Tn(!0);try{a(r)}finally{Tn(!1)}}}else _=r;return c.memoizedState=c.baseState=_,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:_},c.queue=s,s=s.dispatch=kS.bind(null,Fe,s),[c.memoizedState,s]},useRef:function(s){var r=xn();return s={current:s},r.memoizedState=s},useState:function(s){s=dh(s);var r=s.queue,a=Uy.bind(null,Fe,r);return r.dispatch=a,[s.memoizedState,a]},useDebugValue:mh,useDeferredValue:function(s,r){var a=xn();return ph(a,s,r)},useTransition:function(){var s=dh(!1);return s=Dy.bind(null,Fe,s.queue,!0,!1),xn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,a){var c=Fe,_=xn();if(Xe){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),yt===null)throw Error(i(349));(Ye&127)!==0||ay(c,r,a)}_.memoizedState=a;var v={value:a,getSnapshot:r};return _.queue=v,by(uy.bind(null,c,v,s),[s]),c.flags|=2048,ra(9,{destroy:void 0},ly.bind(null,c,v,a,r),null),a},useId:function(){var s=xn(),r=yt.identifierPrefix;if(Xe){var a=Fs,c=qs;a=(c&~(1<<32-wt(c)-1)).toString(32)+a,r="_"+r+"R_"+a,a=Tc++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=wS++,r="_"+r+"r_"+a.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:yh,useFormState:_y,useActionState:_y,useOptimistic:function(s){var r=xn();r.memoizedState=r.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=_h.bind(null,Fe,!0,a),a.dispatch=r,[s,r]},useMemoCache:lh,useCacheRefresh:function(){return xn().memoizedState=PS.bind(null,Fe)},useEffectEvent:function(s){var r=xn(),a={impl:s};return r.memoizedState=a,function(){if((at&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}},vh={readContext:un,use:xc,useCallback:Ny,useContext:un,useEffect:hh,useImperativeHandle:Iy,useInsertionEffect:Sy,useLayoutEffect:Cy,useMemo:Ry,useReducer:bc,useRef:xy,useState:function(){return bc(ai)},useDebugValue:mh,useDeferredValue:function(s,r){var a=Lt();return My(a,mt.memoizedState,s,r)},useTransition:function(){var s=bc(ai)[0],r=Lt().memoizedState;return[typeof s=="boolean"?s:Pl(s),r]},useSyncExternalStore:oy,useId:Vy,useHostTransitionStatus:yh,useFormState:vy,useActionState:vy,useOptimistic:function(s,r){var a=Lt();return fy(a,mt,s,r)},useMemoCache:lh,useCacheRefresh:Ly};vh.useEffectEvent=Ay;var jy={readContext:un,use:xc,useCallback:Ny,useContext:un,useEffect:hh,useImperativeHandle:Iy,useInsertionEffect:Sy,useLayoutEffect:Cy,useMemo:Ry,useReducer:ch,useRef:xy,useState:function(){return ch(ai)},useDebugValue:mh,useDeferredValue:function(s,r){var a=Lt();return mt===null?ph(a,s,r):My(a,mt.memoizedState,s,r)},useTransition:function(){var s=ch(ai)[0],r=Lt().memoizedState;return[typeof s=="boolean"?s:Pl(s),r]},useSyncExternalStore:oy,useId:Vy,useHostTransitionStatus:yh,useFormState:Ey,useActionState:Ey,useOptimistic:function(s,r){var a=Lt();return mt!==null?fy(a,mt,s,r):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:lh,useCacheRefresh:Ly};jy.useEffectEvent=Ay;function Th(s,r,a,c){r=s.memoizedState,a=a(c,r),a=a==null?r:E({},r,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Eh={enqueueSetState:function(s,r,a){s=s._reactInternals;var c=jn(),_=tr(c);_.payload=r,a!=null&&(_.callback=a),r=nr(s,_,c),r!==null&&(Mn(r,s,c),Nl(r,s,c))},enqueueReplaceState:function(s,r,a){s=s._reactInternals;var c=jn(),_=tr(c);_.tag=1,_.payload=r,a!=null&&(_.callback=a),r=nr(s,_,c),r!==null&&(Mn(r,s,c),Nl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var a=jn(),c=tr(a);c.tag=2,r!=null&&(c.callback=r),r=nr(s,c,a),r!==null&&(Mn(r,s,a),Nl(r,s,a))}};function By(s,r,a,c,_,v,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,v,A):r.prototype&&r.prototype.isPureReactComponent?!El(a,c)||!El(_,v):!0}function zy(s,r,a,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==s&&Eh.enqueueReplaceState(r,r.state,null)}function uo(s,r){var a=r;if("ref"in r){a={};for(var c in r)c!=="ref"&&(a[c]=r[c])}if(s=s.defaultProps){a===r&&(a=E({},a));for(var _ in s)a[_]===void 0&&(a[_]=s[_])}return a}function Hy(s){ic(s)}function Gy(s){console.error(s)}function Yy(s){ic(s)}function wc(s,r){try{var a=s.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function $y(s,r,a){try{var c=s.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function xh(s,r,a){return a=tr(a),a.tag=3,a.payload={element:null},a.callback=function(){wc(s,r)},a}function Jy(s){return s=tr(s),s.tag=3,s}function Ky(s,r,a,c){var _=a.type.getDerivedStateFromError;if(typeof _=="function"){var v=c.value;s.payload=function(){return _(v)},s.callback=function(){$y(r,a,c)}}var A=a.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){$y(r,a,c),typeof _!="function"&&(lr===null?lr=new Set([this]):lr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function VS(s,r,a,c,_){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=a.alternate,r!==null&&Xo(r,a,_,!0),a=Un.current,a!==null){switch(a.tag){case 31:case 13:return Zn===null?qc():a.alternate===null&&Mt===0&&(Mt=3),a.flags&=-257,a.flags|=65536,a.lanes=_,c===mc?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([c]):r.add(c),$h(s,c,_)),!1;case 22:return a.flags|=65536,c===mc?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([c]):a.add(c)),$h(s,c,_)),!1}throw Error(i(435,a.tag))}return $h(s,c,_),qc(),!1}if(Xe)return r=Un.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=_,c!==jf&&(s=Error(i(422),{cause:c}),Al(Kn(s,a)))):(c!==jf&&(r=Error(i(423),{cause:c}),Al(Kn(r,a))),s=s.current.alternate,s.flags|=65536,_&=-_,s.lanes|=_,c=Kn(c,a),_=xh(s.stateNode,c,_),Wf(s,_),Mt!==4&&(Mt=2)),!1;var v=Error(i(520),{cause:c});if(v=Kn(v,a),zl===null?zl=[v]:zl.push(v),Mt!==4&&(Mt=2),r===null)return!0;c=Kn(c,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,s=_&-_,a.lanes|=s,s=xh(a.stateNode,c,s),Wf(a,s),!1;case 1:if(r=a.type,v=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(lr===null||!lr.has(v))))return a.flags|=65536,_&=-_,a.lanes|=_,_=Jy(_),Ky(_,s,a,c),Wf(a,_),!1}a=a.return}while(a!==null);return!1}var bh=Error(i(461)),Gt=!1;function cn(s,r,a,c){r.child=s===null?Zg(r,null,a,c):ao(r,s.child,a,c)}function Qy(s,r,a,c,_){a=a.render;var v=r.ref;if("ref"in c){var A={};for(var I in c)I!=="ref"&&(A[I]=c[I])}else A=c;return so(r),c=ih(s,r,a,A,v,_),I=rh(),s!==null&&!Gt?(oh(s,r,_),li(s,r,_)):(Xe&&I&&qf(r),r.flags|=1,cn(s,r,c,_),r.child)}function Xy(s,r,a,c,_){if(s===null){var v=a.type;return typeof v=="function"&&!Lf(v)&&v.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=v,Wy(s,r,v,c,_)):(s=lc(a.type,null,c,r,r.mode,_),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,!Mh(s,_)){var A=v.memoizedProps;if(a=a.compare,a=a!==null?a:El,a(A,c)&&s.ref===r.ref)return li(s,r,_)}return r.flags|=1,s=ni(v,c),s.ref=r.ref,s.return=r,r.child=s}function Wy(s,r,a,c,_){if(s!==null){var v=s.memoizedProps;if(El(v,c)&&s.ref===r.ref)if(Gt=!1,r.pendingProps=c=v,Mh(s,_))(s.flags&131072)!==0&&(Gt=!0);else return r.lanes=s.lanes,li(s,r,_)}return Ah(s,r,a,c,_)}function Zy(s,r,a,c){var _=c.children,v=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(v=v!==null?v.baseLanes|a:a,s!==null){for(c=r.child=s.child,_=0;c!==null;)_=_|c.lanes|c.childLanes,c=c.sibling;c=_&~v}else c=0,r.child=null;return e0(s,r,v,a,c)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&fc(r,v!==null?v.cachePool:null),v!==null?ny(r,v):eh(),sy(r);else return c=r.lanes=536870912,e0(s,r,v!==null?v.baseLanes|a:a,a,c)}else v!==null?(fc(r,v.cachePool),ny(r,v),ir(),r.memoizedState=null):(s!==null&&fc(r,null),eh(),ir());return cn(s,r,_,a),r.child}function Ll(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function e0(s,r,a,c,_){var v=Jf();return v=v===null?null:{parent:zt._currentValue,pool:v},r.memoizedState={baseLanes:a,cachePool:v},s!==null&&fc(r,null),eh(),sy(r),s!==null&&Xo(s,r,c,!0),r.childLanes=_,null}function Ic(s,r){return r=Rc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function t0(s,r,a){return ao(r,s.child,null,a),s=Ic(r,r.pendingProps),s.flags|=2,On(r),r.memoizedState=null,s}function LS(s,r,a){var c=r.pendingProps,_=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Xe){if(c.mode==="hidden")return s=Ic(r,c),r.lanes=536870912,Ll(null,s);if(nh(r),(s=Tt)?(s=h_(s,Wn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Qi!==null?{id:qs,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},a=Og(s),a.return=r,r.child=a,ln=r,Tt=null)):s=null,s===null)throw Wi(r);return r.lanes=536870912,null}return Ic(r,c)}var v=s.memoizedState;if(v!==null){var A=v.dehydrated;if(nh(r),_)if(r.flags&256)r.flags&=-257,r=t0(s,r,a);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Gt||Xo(s,r,a,!1),_=(a&s.childLanes)!==0,Gt||_){if(c=yt,c!==null&&(A=sl(c,a),A!==0&&A!==v.retryLane))throw v.retryLane=A,Zr(s,A),Mn(c,s,A),bh;qc(),r=t0(s,r,a)}else s=v.treeContext,Tt=es(A.nextSibling),ln=r,Xe=!0,Xi=null,Wn=!1,s!==null&&jg(r,s),r=Ic(r,c),r.flags|=4096;return r}return s=ni(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Nc(s,r){var a=r.ref;if(a===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(s===null||s.ref!==a)&&(r.flags|=4194816)}}function Ah(s,r,a,c,_){return so(r),a=ih(s,r,a,c,void 0,_),c=rh(),s!==null&&!Gt?(oh(s,r,_),li(s,r,_)):(Xe&&c&&qf(r),r.flags|=1,cn(s,r,a,_),r.child)}function n0(s,r,a,c,_,v){return so(r),r.updateQueue=null,a=ry(r,c,a,_),iy(s),c=rh(),s!==null&&!Gt?(oh(s,r,v),li(s,r,v)):(Xe&&c&&qf(r),r.flags|=1,cn(s,r,a,v),r.child)}function s0(s,r,a,c,_){if(so(r),r.stateNode===null){var v=$o,A=a.contextType;typeof A=="object"&&A!==null&&(v=un(A)),v=new a(c,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Eh,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=c,v.state=r.memoizedState,v.refs={},Qf(r),A=a.contextType,v.context=typeof A=="object"&&A!==null?un(A):$o,v.state=r.memoizedState,A=a.getDerivedStateFromProps,typeof A=="function"&&(Th(r,a,A,c),v.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(A=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),A!==v.state&&Eh.enqueueReplaceState(v,v.state,null),Ml(r,c,v,_),Rl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){v=r.stateNode;var I=r.memoizedProps,L=uo(a,I);v.props=L;var X=v.context,se=a.contextType;A=$o,typeof se=="object"&&se!==null&&(A=un(se));var ae=a.getDerivedStateFromProps;se=typeof ae=="function"||typeof v.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,se||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I||X!==A)&&zy(r,v,c,A),er=!1;var W=r.memoizedState;v.state=W,Ml(r,c,v,_),Rl(),X=r.memoizedState,I||W!==X||er?(typeof ae=="function"&&(Th(r,a,ae,c),X=r.memoizedState),(L=er||By(r,a,L,c,W,X,A))?(se||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=X),v.props=c,v.state=X,v.context=A,c=L):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{v=r.stateNode,Xf(s,r),A=r.memoizedProps,se=uo(a,A),v.props=se,ae=r.pendingProps,W=v.context,X=a.contextType,L=$o,typeof X=="object"&&X!==null&&(L=un(X)),I=a.getDerivedStateFromProps,(X=typeof I=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==ae||W!==L)&&zy(r,v,c,L),er=!1,W=r.memoizedState,v.state=W,Ml(r,c,v,_),Rl();var te=r.memoizedState;A!==ae||W!==te||er||s!==null&&s.dependencies!==null&&cc(s.dependencies)?(typeof I=="function"&&(Th(r,a,I,c),te=r.memoizedState),(se=er||By(r,a,se,c,W,te,L)||s!==null&&s.dependencies!==null&&cc(s.dependencies))?(X||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,te,L),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,te,L)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),v.props=c,v.state=te,v.context=L,c=se):(typeof v.componentDidUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),c=!1)}return v=c,Nc(s,r),c=(r.flags&128)!==0,v||c?(v=r.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,s!==null&&c?(r.child=ao(r,s.child,null,_),r.child=ao(r,null,a,_)):cn(s,r,a,_),r.memoizedState=v.state,s=r.child):s=li(s,r,_),s}function i0(s,r,a,c){return to(),r.flags|=256,cn(s,r,a,c),r.child}var Sh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ch(s){return{baseLanes:s,cachePool:$g()}}function wh(s,r,a){return s=s!==null?s.childLanes&~a:0,r&&(s|=Fn),s}function r0(s,r,a){var c=r.pendingProps,_=!1,v=(r.flags&128)!==0,A;if((A=v)||(A=s!==null&&s.memoizedState===null?!1:(Vt.current&2)!==0),A&&(_=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,s===null){if(Xe){if(_?sr(r):ir(),(s=Tt)?(s=h_(s,Wn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Qi!==null?{id:qs,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},a=Og(s),a.return=r,r.child=a,ln=r,Tt=null)):s=null,s===null)throw Wi(r);return um(s)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,_?(ir(),_=r.mode,I=Rc({mode:"hidden",children:I},_),c=eo(c,_,a,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=Ch(a),c.childLanes=wh(s,A,a),r.memoizedState=Sh,Ll(null,c)):(sr(r),Ih(r,I))}var L=s.memoizedState;if(L!==null&&(I=L.dehydrated,I!==null)){if(v)r.flags&256?(sr(r),r.flags&=-257,r=Nh(s,r,a)):r.memoizedState!==null?(ir(),r.child=s.child,r.flags|=128,r=null):(ir(),I=c.fallback,_=r.mode,c=Rc({mode:"visible",children:c.children},_),I=eo(I,_,a,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,ao(r,s.child,null,a),c=r.child,c.memoizedState=Ch(a),c.childLanes=wh(s,A,a),r.memoizedState=Sh,r=Ll(null,c));else if(sr(r),um(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var X=A.dgst;A=X,c=Error(i(419)),c.stack="",c.digest=A,Al({value:c,source:null,stack:null}),r=Nh(s,r,a)}else if(Gt||Xo(s,r,a,!1),A=(a&s.childLanes)!==0,Gt||A){if(A=yt,A!==null&&(c=sl(A,a),c!==0&&c!==L.retryLane))throw L.retryLane=c,Zr(s,c),Mn(A,s,c),bh;lm(I)||qc(),r=Nh(s,r,a)}else lm(I)?(r.flags|=192,r.child=s.child,r=null):(s=L.treeContext,Tt=es(I.nextSibling),ln=r,Xe=!0,Xi=null,Wn=!1,s!==null&&jg(r,s),r=Ih(r,c.children),r.flags|=4096);return r}return _?(ir(),I=c.fallback,_=r.mode,L=s.child,X=L.sibling,c=ni(L,{mode:"hidden",children:c.children}),c.subtreeFlags=L.subtreeFlags&65011712,X!==null?I=ni(X,I):(I=eo(I,_,a,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,Ll(null,c),c=r.child,I=s.child.memoizedState,I===null?I=Ch(a):(_=I.cachePool,_!==null?(L=zt._currentValue,_=_.parent!==L?{parent:L,pool:L}:_):_=$g(),I={baseLanes:I.baseLanes|a,cachePool:_}),c.memoizedState=I,c.childLanes=wh(s,A,a),r.memoizedState=Sh,Ll(s.child,c)):(sr(r),a=s.child,s=a.sibling,a=ni(a,{mode:"visible",children:c.children}),a.return=r,a.sibling=null,s!==null&&(A=r.deletions,A===null?(r.deletions=[s],r.flags|=16):A.push(s)),r.child=a,r.memoizedState=null,a)}function Ih(s,r){return r=Rc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Rc(s,r){return s=Ln(22,s,null,r),s.lanes=0,s}function Nh(s,r,a){return ao(r,s.child,null,a),s=Ih(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function o0(s,r,a){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Hf(s.return,r,a)}function Rh(s,r,a,c,_,v){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:_,treeForkCount:v}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=a,A.tailMode=_,A.treeForkCount=v)}function a0(s,r,a){var c=r.pendingProps,_=c.revealOrder,v=c.tail;c=c.children;var A=Vt.current,I=(A&2)!==0;if(I?(A=A&1|2,r.flags|=128):A&=1,ye(Vt,A),cn(s,r,c,a),c=Xe?bl:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&o0(s,a,r);else if(s.tag===19)o0(s,a,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(_){case"forwards":for(a=r.child,_=null;a!==null;)s=a.alternate,s!==null&&_c(s)===null&&(_=a),a=a.sibling;a=_,a===null?(_=r.child,r.child=null):(_=a.sibling,a.sibling=null),Rh(r,!1,_,a,v,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,_=r.child,r.child=null;_!==null;){if(s=_.alternate,s!==null&&_c(s)===null){r.child=_;break}s=_.sibling,_.sibling=a,a=_,_=s}Rh(r,!0,a,null,v,c);break;case"together":Rh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function li(s,r,a){if(s!==null&&(r.dependencies=s.dependencies),ar|=r.lanes,(a&r.childLanes)===0)if(s!==null){if(Xo(s,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,a=ni(s,s.pendingProps),r.child=a,a.return=r;s.sibling!==null;)s=s.sibling,a=a.sibling=ni(s,s.pendingProps),a.return=r;a.sibling=null}return r.child}function Mh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&cc(s)))}function US(s,r,a){switch(r.tag){case 3:Ze(r,r.stateNode.containerInfo),Zi(r,zt,s.memoizedState.cache),to();break;case 27:case 5:An(r);break;case 4:Ze(r,r.stateNode.containerInfo);break;case 10:Zi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,nh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(sr(r),r.flags|=128,null):(a&r.child.childLanes)!==0?r0(s,r,a):(sr(r),s=li(s,r,a),s!==null?s.sibling:null);sr(r);break;case 19:var _=(s.flags&128)!==0;if(c=(a&r.childLanes)!==0,c||(Xo(s,r,a,!1),c=(a&r.childLanes)!==0),_){if(c)return a0(s,r,a);r.flags|=128}if(_=r.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ye(Vt,Vt.current),c)break;return null;case 22:return r.lanes=0,Zy(s,r,a,r.pendingProps);case 24:Zi(r,zt,s.memoizedState.cache)}return li(s,r,a)}function l0(s,r,a){if(s!==null)if(s.memoizedProps!==r.pendingProps)Gt=!0;else{if(!Mh(s,a)&&(r.flags&128)===0)return Gt=!1,US(s,r,a);Gt=(s.flags&131072)!==0}else Gt=!1,Xe&&(r.flags&1048576)!==0&&Fg(r,bl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=ro(r.elementType),r.type=s,typeof s=="function")Lf(s)?(c=uo(s,c),r.tag=1,r=s0(null,r,s,c,a)):(r.tag=0,r=Ah(null,r,s,c,a));else{if(s!=null){var _=s.$$typeof;if(_===H){r.tag=11,r=Qy(null,r,s,c,a);break e}else if(_===N){r.tag=14,r=Xy(null,r,s,c,a);break e}}throw r=ke(s)||s,Error(i(306,r,""))}}return r;case 0:return Ah(s,r,r.type,r.pendingProps,a);case 1:return c=r.type,_=uo(c,r.pendingProps),s0(s,r,c,_,a);case 3:e:{if(Ze(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var v=r.memoizedState;_=v.element,Xf(s,r),Ml(r,c,null,a);var A=r.memoizedState;if(c=A.cache,Zi(r,zt,c),c!==v.cache&&Gf(r,[zt],a,!0),Rl(),c=A.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=i0(s,r,c,a);break e}else if(c!==_){_=Kn(Error(i(424)),r),Al(_),r=i0(s,r,c,a);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=es(s.firstChild),ln=r,Xe=!0,Xi=null,Wn=!0,a=Zg(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(to(),c===_){r=li(s,r,a);break e}cn(s,r,c,a)}r=r.child}return r;case 26:return Nc(s,r),s===null?(a=v_(r.type,null,r.pendingProps,null))?r.memoizedState=a:Xe||(a=r.type,s=r.pendingProps,c=Yc(ce.current).createElement(a),c[Ft]=r,c[en]=s,dn(c,a,s),jt(c),r.stateNode=c):r.memoizedState=v_(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return An(r),s===null&&Xe&&(c=r.stateNode=g_(r.type,r.pendingProps,ce.current),ln=r,Wn=!0,_=Tt,fr(r.type)?(cm=_,Tt=es(c.firstChild)):Tt=_),cn(s,r,r.pendingProps.children,a),Nc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Xe&&((_=c=Tt)&&(c=hC(c,r.type,r.pendingProps,Wn),c!==null?(r.stateNode=c,ln=r,Tt=es(c.firstChild),Wn=!1,_=!0):_=!1),_||Wi(r)),An(r),_=r.type,v=r.pendingProps,A=s!==null?s.memoizedProps:null,c=v.children,rm(_,v)?c=null:A!==null&&rm(_,A)&&(r.flags|=32),r.memoizedState!==null&&(_=ih(s,r,IS,null,null,a),Xl._currentValue=_),Nc(s,r),cn(s,r,c,a),r.child;case 6:return s===null&&Xe&&((s=a=Tt)&&(a=mC(a,r.pendingProps,Wn),a!==null?(r.stateNode=a,ln=r,Tt=null,s=!0):s=!1),s||Wi(r)),null;case 13:return r0(s,r,a);case 4:return Ze(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=ao(r,null,c,a):cn(s,r,c,a),r.child;case 11:return Qy(s,r,r.type,r.pendingProps,a);case 7:return cn(s,r,r.pendingProps,a),r.child;case 8:return cn(s,r,r.pendingProps.children,a),r.child;case 12:return cn(s,r,r.pendingProps.children,a),r.child;case 10:return c=r.pendingProps,Zi(r,r.type,c.value),cn(s,r,c.children,a),r.child;case 9:return _=r.type._context,c=r.pendingProps.children,so(r),_=un(_),c=c(_),r.flags|=1,cn(s,r,c,a),r.child;case 14:return Xy(s,r,r.type,r.pendingProps,a);case 15:return Wy(s,r,r.type,r.pendingProps,a);case 19:return a0(s,r,a);case 31:return LS(s,r,a);case 22:return Zy(s,r,a,r.pendingProps);case 24:return so(r),c=un(zt),s===null?(_=Jf(),_===null&&(_=yt,v=Yf(),_.pooledCache=v,v.refCount++,v!==null&&(_.pooledCacheLanes|=a),_=v),r.memoizedState={parent:c,cache:_},Qf(r),Zi(r,zt,_)):((s.lanes&a)!==0&&(Xf(s,r),Ml(r,null,null,a),Rl()),_=s.memoizedState,v=r.memoizedState,_.parent!==c?(_={parent:c,cache:c},r.memoizedState=_,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=_),Zi(r,zt,c)):(c=v.cache,Zi(r,zt,c),c!==_.cache&&Gf(r,[zt],a,!0))),cn(s,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function ui(s){s.flags|=4}function Dh(s,r,a,c,_){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(_&335544128)===_)if(s.stateNode.complete)s.flags|=8192;else if(V0())s.flags|=8192;else throw oo=mc,Kf}else s.flags&=-16777217}function u0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!A_(r))if(V0())s.flags|=8192;else throw oo=mc,Kf}function Mc(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Uu():536870912,s.lanes|=r,ua|=r)}function Ul(s,r){if(!Xe)switch(s.tailMode){case"hidden":r=s.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function Et(s){var r=s.alternate!==null&&s.alternate.child===s.child,a=0,c=0;if(r)for(var _=s.child;_!==null;)a|=_.lanes|_.childLanes,c|=_.subtreeFlags&65011712,c|=_.flags&65011712,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)a|=_.lanes|_.childLanes,c|=_.subtreeFlags,c|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=c,s.childLanes=a,r}function OS(s,r,a){var c=r.pendingProps;switch(Ff(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(r),null;case 1:return Et(r),null;case 3:return a=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ri(zt),nt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(Qo(r)?ui(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Bf())),Et(r),null;case 26:var _=r.type,v=r.memoizedState;return s===null?(ui(r),v!==null?(Et(r),u0(r,v)):(Et(r),Dh(r,_,null,c,a))):v?v!==s.memoizedState?(ui(r),Et(r),u0(r,v)):(Et(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&ui(r),Et(r),Dh(r,_,s,c,a)),null;case 27:if(Ct(r),a=ce.current,_=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&ui(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Et(r),null}s=ve.current,Qo(r)?Bg(r):(s=g_(_,c,a),r.stateNode=s,ui(r))}return Et(r),null;case 5:if(Ct(r),_=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&ui(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Et(r),null}if(v=ve.current,Qo(r))Bg(r);else{var A=Yc(ce.current);switch(v){case 1:v=A.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:v=A.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":v=A.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":v=A.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":v=A.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?A.createElement(_,{is:c.is}):A.createElement(_)}}v[Ft]=r,v[en]=c;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)v.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=v;e:switch(dn(v,_,c),_){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ui(r)}}return Et(r),Dh(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,a),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&ui(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=ce.current,Qo(r)){if(s=r.stateNode,a=r.memoizedProps,c=null,_=ln,_!==null)switch(_.tag){case 27:case 5:c=_.memoizedProps}s[Ft]=r,s=!!(s.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||r_(s.nodeValue,a)),s||Wi(r,!0)}else s=Yc(s).createTextNode(c),s[Ft]=r,r.stateNode=s}return Et(r),null;case 31:if(a=r.memoizedState,s===null||s.memoizedState!==null){if(c=Qo(r),a!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ft]=r}else to(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Et(r),s=!1}else a=Bf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return r.flags&256?(On(r),r):(On(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Et(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_=Qo(r),c!==null&&c.dehydrated!==null){if(s===null){if(!_)throw Error(i(318));if(_=r.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(i(317));_[Ft]=r}else to(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Et(r),_=!1}else _=Bf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=_),_=!0;if(!_)return r.flags&256?(On(r),r):(On(r),null)}return On(r),(r.flags&128)!==0?(r.lanes=a,r):(a=c!==null,s=s!==null&&s.memoizedState!==null,a&&(c=r.child,_=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(_=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==_&&(c.flags|=2048)),a!==s&&a&&(r.child.flags|=8192),Mc(r,r.updateQueue),Et(r),null);case 4:return nt(),s===null&&em(r.stateNode.containerInfo),Et(r),null;case 10:return ri(r.type),Et(r),null;case 19:if(re(Vt),c=r.memoizedState,c===null)return Et(r),null;if(_=(r.flags&128)!==0,v=c.rendering,v===null)if(_)Ul(c,!1);else{if(Mt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(v=_c(s),v!==null){for(r.flags|=128,Ul(c,!1),s=v.updateQueue,r.updateQueue=s,Mc(r,s),r.subtreeFlags=0,s=a,a=r.child;a!==null;)Ug(a,s),a=a.sibling;return ye(Vt,Vt.current&1|2),Xe&&si(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&Zt()>Lc&&(r.flags|=128,_=!0,Ul(c,!1),r.lanes=4194304)}else{if(!_)if(s=_c(v),s!==null){if(r.flags|=128,_=!0,s=s.updateQueue,r.updateQueue=s,Mc(r,s),Ul(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!Xe)return Et(r),null}else 2*Zt()-c.renderingStartTime>Lc&&a!==536870912&&(r.flags|=128,_=!0,Ul(c,!1),r.lanes=4194304);c.isBackwards?(v.sibling=r.child,r.child=v):(s=c.last,s!==null?s.sibling=v:r.child=v,c.last=v)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Zt(),s.sibling=null,a=Vt.current,ye(Vt,_?a&1|2:a&1),Xe&&si(r,c.treeForkCount),s):(Et(r),null);case 22:case 23:return On(r),th(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(a&536870912)!==0&&(r.flags&128)===0&&(Et(r),r.subtreeFlags&6&&(r.flags|=8192)):Et(r),a=r.updateQueue,a!==null&&Mc(r,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==a&&(r.flags|=2048),s!==null&&re(io),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),ri(zt),Et(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function qS(s,r){switch(Ff(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ri(zt),nt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Ct(r),null;case 31:if(r.memoizedState!==null){if(On(r),r.alternate===null)throw Error(i(340));to()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(On(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));to()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return re(Vt),null;case 4:return nt(),null;case 10:return ri(r.type),null;case 22:case 23:return On(r),th(),s!==null&&re(io),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ri(zt),null;case 25:return null;default:return null}}function c0(s,r){switch(Ff(r),r.tag){case 3:ri(zt),nt();break;case 26:case 27:case 5:Ct(r);break;case 4:nt();break;case 31:r.memoizedState!==null&&On(r);break;case 13:On(r);break;case 19:re(Vt);break;case 10:ri(r.type);break;case 22:case 23:On(r),th(),s!==null&&re(io);break;case 24:ri(zt)}}function Ol(s,r){try{var a=r.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var _=c.next;a=_;do{if((a.tag&s)===s){c=void 0;var v=a.create,A=a.inst;c=v(),A.destroy=c}a=a.next}while(a!==_)}}catch(I){ft(r,r.return,I)}}function rr(s,r,a){try{var c=r.updateQueue,_=c!==null?c.lastEffect:null;if(_!==null){var v=_.next;c=v;do{if((c.tag&s)===s){var A=c.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,_=r;var L=a,X=I;try{X()}catch(se){ft(_,L,se)}}}c=c.next}while(c!==v)}}catch(se){ft(r,r.return,se)}}function d0(s){var r=s.updateQueue;if(r!==null){var a=s.stateNode;try{ty(r,a)}catch(c){ft(s,s.return,c)}}}function f0(s,r,a){a.props=uo(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(c){ft(s,r,c)}}function ql(s,r){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof a=="function"?s.refCleanup=a(c):a.current=c}}catch(_){ft(s,r,_)}}function js(s,r){var a=s.ref,c=s.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(_){ft(s,r,_)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(_){ft(s,r,_)}else a.current=null}function h0(s){var r=s.type,a=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(_){ft(s,s.return,_)}}function Ph(s,r,a){try{var c=s.stateNode;aC(c,s.type,a,r),c[en]=r}catch(_){ft(s,s.return,_)}}function m0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&fr(s.type)||s.tag===4}function kh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||m0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&fr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vh(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(s),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=ls));else if(c!==4&&(c===27&&fr(s.type)&&(a=s.stateNode,r=null),s=s.child,s!==null))for(Vh(s,r,a),s=s.sibling;s!==null;)Vh(s,r,a),s=s.sibling}function Dc(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?a.insertBefore(s,r):a.appendChild(s);else if(c!==4&&(c===27&&fr(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(Dc(s,r,a),s=s.sibling;s!==null;)Dc(s,r,a),s=s.sibling}function p0(s){var r=s.stateNode,a=s.memoizedProps;try{for(var c=s.type,_=r.attributes;_.length;)r.removeAttributeNode(_[0]);dn(r,c,a),r[Ft]=s,r[en]=a}catch(v){ft(s,s.return,v)}}var ci=!1,Yt=!1,Lh=!1,g0=typeof WeakSet=="function"?WeakSet:Set,nn=null;function FS(s,r){if(s=s.containerInfo,sm=Zc,s=Ig(s),Nf(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var _=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{a.nodeType,v.nodeType}catch{a=null;break e}var A=0,I=-1,L=-1,X=0,se=0,ae=s,W=null;t:for(;;){for(var te;ae!==a||_!==0&&ae.nodeType!==3||(I=A+_),ae!==v||c!==0&&ae.nodeType!==3||(L=A+c),ae.nodeType===3&&(A+=ae.nodeValue.length),(te=ae.firstChild)!==null;)W=ae,ae=te;for(;;){if(ae===s)break t;if(W===a&&++X===_&&(I=A),W===v&&++se===c&&(L=A),(te=ae.nextSibling)!==null)break;ae=W,W=ae.parentNode}ae=te}a=I===-1||L===-1?null:{start:I,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(im={focusedElem:s,selectionRange:a},Zc=!1,nn=r;nn!==null;)if(r=nn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,nn=s;else for(;nn!==null;){switch(r=nn,v=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)_=s[a],_.ref.impl=_.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,a=r,_=v.memoizedProps,v=v.memoizedState,c=a.stateNode;try{var be=uo(a.type,_);s=c.getSnapshotBeforeUpdate(be,v),c.__reactInternalSnapshotBeforeUpdate=s}catch(Re){ft(a,a.return,Re)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,a=s.nodeType,a===9)am(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":am(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,nn=s;break}nn=r.return}}function y0(s,r,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:fi(s,a),c&4&&Ol(5,a);break;case 1:if(fi(s,a),c&4)if(s=a.stateNode,r===null)try{s.componentDidMount()}catch(A){ft(a,a.return,A)}else{var _=uo(a.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(_,r,s.__reactInternalSnapshotBeforeUpdate)}catch(A){ft(a,a.return,A)}}c&64&&d0(a),c&512&&ql(a,a.return);break;case 3:if(fi(s,a),c&64&&(s=a.updateQueue,s!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{ty(s,r)}catch(A){ft(a,a.return,A)}}break;case 27:r===null&&c&4&&p0(a);case 26:case 5:fi(s,a),r===null&&c&4&&h0(a),c&512&&ql(a,a.return);break;case 12:fi(s,a);break;case 31:fi(s,a),c&4&&T0(s,a);break;case 13:fi(s,a),c&4&&E0(s,a),c&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=KS.bind(null,a),pC(s,a))));break;case 22:if(c=a.memoizedState!==null||ci,!c){r=r!==null&&r.memoizedState!==null||Yt,_=ci;var v=Yt;ci=c,(Yt=r)&&!v?hi(s,a,(a.subtreeFlags&8772)!==0):fi(s,a),ci=_,Yt=v}break;case 30:break;default:fi(s,a)}}function _0(s){var r=s.alternate;r!==null&&(s.alternate=null,_0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Po(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var St=null,wn=!1;function di(s,r,a){for(a=a.child;a!==null;)v0(s,r,a),a=a.sibling}function v0(s,r,a){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(et,a)}catch{}switch(a.tag){case 26:Yt||js(a,r),di(s,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Yt||js(a,r);var c=St,_=wn;fr(a.type)&&(St=a.stateNode,wn=!1),di(s,r,a),Jl(a.stateNode),St=c,wn=_;break;case 5:Yt||js(a,r);case 6:if(c=St,_=wn,St=null,di(s,r,a),St=c,wn=_,St!==null)if(wn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(a.stateNode)}catch(v){ft(a,r,v)}else try{St.removeChild(a.stateNode)}catch(v){ft(a,r,v)}break;case 18:St!==null&&(wn?(s=St,d_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),ya(s)):d_(St,a.stateNode));break;case 4:c=St,_=wn,St=a.stateNode.containerInfo,wn=!0,di(s,r,a),St=c,wn=_;break;case 0:case 11:case 14:case 15:rr(2,a,r),Yt||rr(4,a,r),di(s,r,a);break;case 1:Yt||(js(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"&&f0(a,r,c)),di(s,r,a);break;case 21:di(s,r,a);break;case 22:Yt=(c=Yt)||a.memoizedState!==null,di(s,r,a),Yt=c;break;default:di(s,r,a)}}function T0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{ya(s)}catch(a){ft(r,r.return,a)}}}function E0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ya(s)}catch(a){ft(r,r.return,a)}}function jS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new g0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new g0),r;default:throw Error(i(435,s.tag))}}function Pc(s,r){var a=jS(s);r.forEach(function(c){if(!a.has(c)){a.add(c);var _=QS.bind(null,s,c);c.then(_,_)}})}function In(s,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var _=a[c],v=s,A=r,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(fr(I.type)){St=I.stateNode,wn=!1;break e}break;case 5:St=I.stateNode,wn=!1;break e;case 3:case 4:St=I.stateNode.containerInfo,wn=!0;break e}I=I.return}if(St===null)throw Error(i(160));v0(v,A,_),St=null,wn=!1,v=_.alternate,v!==null&&(v.return=null),_.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)x0(r,s),r=r.sibling}var ms=null;function x0(s,r){var a=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:In(r,s),Nn(s),c&4&&(rr(3,s,s.return),Ol(3,s),rr(5,s,s.return));break;case 1:In(r,s),Nn(s),c&512&&(Yt||a===null||js(a,a.return)),c&64&&ci&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var _=ms;if(In(r,s),Nn(s),c&512&&(Yt||a===null||js(a,a.return)),c&4){var v=a!==null?a.memoizedState:null;if(c=s.memoizedState,a===null)if(c===null)if(s.stateNode===null){e:{c=s.type,a=s.memoizedProps,_=_.ownerDocument||_;t:switch(c){case"title":v=_.getElementsByTagName("title")[0],(!v||v[ws]||v[Ft]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=_.createElement(c),_.head.insertBefore(v,_.querySelector("head > title"))),dn(v,c,a),v[Ft]=s,jt(v),c=v;break e;case"link":var A=x_("link","href",_).get(c+(a.href||""));if(A){for(var I=0;I<A.length;I++)if(v=A[I],v.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&v.getAttribute("rel")===(a.rel==null?null:a.rel)&&v.getAttribute("title")===(a.title==null?null:a.title)&&v.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){A.splice(I,1);break t}}v=_.createElement(c),dn(v,c,a),_.head.appendChild(v);break;case"meta":if(A=x_("meta","content",_).get(c+(a.content||""))){for(I=0;I<A.length;I++)if(v=A[I],v.getAttribute("content")===(a.content==null?null:""+a.content)&&v.getAttribute("name")===(a.name==null?null:a.name)&&v.getAttribute("property")===(a.property==null?null:a.property)&&v.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&v.getAttribute("charset")===(a.charSet==null?null:a.charSet)){A.splice(I,1);break t}}v=_.createElement(c),dn(v,c,a),_.head.appendChild(v);break;default:throw Error(i(468,c))}v[Ft]=s,jt(v),c=v}s.stateNode=c}else b_(_,s.type,s.stateNode);else s.stateNode=E_(_,c,s.memoizedProps);else v!==c?(v===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):v.count--,c===null?b_(_,s.type,s.stateNode):E_(_,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Ph(s,s.memoizedProps,a.memoizedProps)}break;case 27:In(r,s),Nn(s),c&512&&(Yt||a===null||js(a,a.return)),a!==null&&c&4&&Ph(s,s.memoizedProps,a.memoizedProps);break;case 5:if(In(r,s),Nn(s),c&512&&(Yt||a===null||js(a,a.return)),s.flags&32){_=s.stateNode;try{Cn(_,"")}catch(be){ft(s,s.return,be)}}c&4&&s.stateNode!=null&&(_=s.memoizedProps,Ph(s,_,a!==null?a.memoizedProps:_)),c&1024&&(Lh=!0);break;case 6:if(In(r,s),Nn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,a=s.stateNode;try{a.nodeValue=c}catch(be){ft(s,s.return,be)}}break;case 3:if(Kc=null,_=ms,ms=$c(r.containerInfo),In(r,s),ms=_,Nn(s),c&4&&a!==null&&a.memoizedState.isDehydrated)try{ya(r.containerInfo)}catch(be){ft(s,s.return,be)}Lh&&(Lh=!1,b0(s));break;case 4:c=ms,ms=$c(s.stateNode.containerInfo),In(r,s),Nn(s),ms=c;break;case 12:In(r,s),Nn(s);break;case 31:In(r,s),Nn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Pc(s,c)));break;case 13:In(r,s),Nn(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Vc=Zt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Pc(s,c)));break;case 22:_=s.memoizedState!==null;var L=a!==null&&a.memoizedState!==null,X=ci,se=Yt;if(ci=X||_,Yt=se||L,In(r,s),Yt=se,ci=X,Nn(s),c&8192)e:for(r=s.stateNode,r._visibility=_?r._visibility&-2:r._visibility|1,_&&(a===null||L||ci||Yt||co(s)),a=null,r=s;;){if(r.tag===5||r.tag===26){if(a===null){L=a=r;try{if(v=L.stateNode,_)A=v.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=L.stateNode;var ae=L.memoizedProps.style,W=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;I.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(be){ft(L,L.return,be)}}}else if(r.tag===6){if(a===null){L=r;try{L.stateNode.nodeValue=_?"":L.memoizedProps}catch(be){ft(L,L.return,be)}}}else if(r.tag===18){if(a===null){L=r;try{var te=L.stateNode;_?f_(te,!0):f_(L.stateNode,!1)}catch(be){ft(L,L.return,be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,Pc(s,a))));break;case 19:In(r,s),Nn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Pc(s,c)));break;case 30:break;case 21:break;default:In(r,s),Nn(s)}}function Nn(s){var r=s.flags;if(r&2){try{for(var a,c=s.return;c!==null;){if(m0(c)){a=c;break}c=c.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var _=a.stateNode,v=kh(s);Dc(s,v,_);break;case 5:var A=a.stateNode;a.flags&32&&(Cn(A,""),a.flags&=-33);var I=kh(s);Dc(s,I,A);break;case 3:case 4:var L=a.stateNode.containerInfo,X=kh(s);Vh(s,X,L);break;default:throw Error(i(161))}}catch(se){ft(s,s.return,se)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function b0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;b0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function fi(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)y0(s,r.alternate,r),r=r.sibling}function co(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:rr(4,r,r.return),co(r);break;case 1:js(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&f0(r,r.return,a),co(r);break;case 27:Jl(r.stateNode);case 26:case 5:js(r,r.return),co(r);break;case 22:r.memoizedState===null&&co(r);break;case 30:co(r);break;default:co(r)}s=s.sibling}}function hi(s,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,_=s,v=r,A=v.flags;switch(v.tag){case 0:case 11:case 15:hi(_,v,a),Ol(4,v);break;case 1:if(hi(_,v,a),c=v,_=c.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(X){ft(c,c.return,X)}if(c=v,_=c.updateQueue,_!==null){var I=c.stateNode;try{var L=_.shared.hiddenCallbacks;if(L!==null)for(_.shared.hiddenCallbacks=null,_=0;_<L.length;_++)ey(L[_],I)}catch(X){ft(c,c.return,X)}}a&&A&64&&d0(v),ql(v,v.return);break;case 27:p0(v);case 26:case 5:hi(_,v,a),a&&c===null&&A&4&&h0(v),ql(v,v.return);break;case 12:hi(_,v,a);break;case 31:hi(_,v,a),a&&A&4&&T0(_,v);break;case 13:hi(_,v,a),a&&A&4&&E0(_,v);break;case 22:v.memoizedState===null&&hi(_,v,a),ql(v,v.return);break;case 30:break;default:hi(_,v,a)}r=r.sibling}}function Uh(s,r){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&Sl(a))}function Oh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Sl(s))}function ps(s,r,a,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)A0(s,r,a,c),r=r.sibling}function A0(s,r,a,c){var _=r.flags;switch(r.tag){case 0:case 11:case 15:ps(s,r,a,c),_&2048&&Ol(9,r);break;case 1:ps(s,r,a,c);break;case 3:ps(s,r,a,c),_&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Sl(s)));break;case 12:if(_&2048){ps(s,r,a,c),s=r.stateNode;try{var v=r.memoizedProps,A=v.id,I=v.onPostCommit;typeof I=="function"&&I(A,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(L){ft(r,r.return,L)}}else ps(s,r,a,c);break;case 31:ps(s,r,a,c);break;case 13:ps(s,r,a,c);break;case 23:break;case 22:v=r.stateNode,A=r.alternate,r.memoizedState!==null?v._visibility&2?ps(s,r,a,c):Fl(s,r):v._visibility&2?ps(s,r,a,c):(v._visibility|=2,oa(s,r,a,c,(r.subtreeFlags&10256)!==0||!1)),_&2048&&Uh(A,r);break;case 24:ps(s,r,a,c),_&2048&&Oh(r.alternate,r);break;default:ps(s,r,a,c)}}function oa(s,r,a,c,_){for(_=_&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var v=s,A=r,I=a,L=c,X=A.flags;switch(A.tag){case 0:case 11:case 15:oa(v,A,I,L,_),Ol(8,A);break;case 23:break;case 22:var se=A.stateNode;A.memoizedState!==null?se._visibility&2?oa(v,A,I,L,_):Fl(v,A):(se._visibility|=2,oa(v,A,I,L,_)),_&&X&2048&&Uh(A.alternate,A);break;case 24:oa(v,A,I,L,_),_&&X&2048&&Oh(A.alternate,A);break;default:oa(v,A,I,L,_)}r=r.sibling}}function Fl(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=s,c=r,_=c.flags;switch(c.tag){case 22:Fl(a,c),_&2048&&Uh(c.alternate,c);break;case 24:Fl(a,c),_&2048&&Oh(c.alternate,c);break;default:Fl(a,c)}r=r.sibling}}var jl=8192;function aa(s,r,a){if(s.subtreeFlags&jl)for(s=s.child;s!==null;)S0(s,r,a),s=s.sibling}function S0(s,r,a){switch(s.tag){case 26:aa(s,r,a),s.flags&jl&&s.memoizedState!==null&&wC(a,ms,s.memoizedState,s.memoizedProps);break;case 5:aa(s,r,a);break;case 3:case 4:var c=ms;ms=$c(s.stateNode.containerInfo),aa(s,r,a),ms=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=jl,jl=16777216,aa(s,r,a),jl=c):aa(s,r,a));break;default:aa(s,r,a)}}function C0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Bl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];nn=c,I0(c,s)}C0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)w0(s),s=s.sibling}function w0(s){switch(s.tag){case 0:case 11:case 15:Bl(s),s.flags&2048&&rr(9,s,s.return);break;case 3:Bl(s);break;case 12:Bl(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,kc(s)):Bl(s);break;default:Bl(s)}}function kc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];nn=c,I0(c,s)}C0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:rr(8,r,r.return),kc(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,kc(r));break;default:kc(r)}s=s.sibling}}function I0(s,r){for(;nn!==null;){var a=nn;switch(a.tag){case 0:case 11:case 15:rr(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Sl(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,nn=c;else e:for(a=s;nn!==null;){c=nn;var _=c.sibling,v=c.return;if(_0(c),c===a){nn=null;break e}if(_!==null){_.return=v,nn=_;break e}nn=v}}}var BS={getCacheForType:function(s){var r=un(zt),a=r.data.get(s);return a===void 0&&(a=s(),r.data.set(s,a)),a},cacheSignal:function(){return un(zt).controller.signal}},zS=typeof WeakMap=="function"?WeakMap:Map,at=0,yt=null,He=null,Ye=0,dt=0,qn=null,or=!1,la=!1,qh=!1,mi=0,Mt=0,ar=0,fo=0,Fh=0,Fn=0,ua=0,zl=null,Rn=null,jh=!1,Vc=0,N0=0,Lc=1/0,Uc=null,lr=null,Qt=0,ur=null,ca=null,pi=0,Bh=0,zh=null,R0=null,Hl=0,Hh=null;function jn(){return(at&2)!==0&&Ye!==0?Ye&-Ye:$.T!==null?Qh():Ou()}function M0(){if(Fn===0)if((Ye&536870912)===0||Xe){var s=vt;vt<<=1,(vt&3932160)===0&&(vt=262144),Fn=s}else Fn=536870912;return s=Un.current,s!==null&&(s.flags|=32),Fn}function Mn(s,r,a){(s===yt&&(dt===2||dt===9)||s.cancelPendingCommit!==null)&&(da(s,0),cr(s,Ye,Fn,!1)),qr(s,a),((at&2)===0||s!==yt)&&(s===yt&&((at&2)===0&&(fo|=a),Mt===4&&cr(s,Ye,Fn,!1)),Bs(s))}function D0(s,r,a){if((at&6)!==0)throw Error(i(327));var c=!a&&(r&127)===0&&(r&s.expiredLanes)===0||ze(s,r),_=c?YS(s,r):Yh(s,r,!0),v=c;do{if(_===0){la&&!c&&cr(s,r,0,!1);break}else{if(a=s.current.alternate,v&&!HS(a)){_=Yh(s,r,!1),v=!1;continue}if(_===2){if(v=r,s.errorRecoveryDisabledLanes&v)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var I=s;_=zl;var L=I.current.memoizedState.isDehydrated;if(L&&(da(I,A).flags|=256),A=Yh(I,A,!1),A!==2){if(qh&&!L){I.errorRecoveryDisabledLanes|=v,fo|=v,_=4;break e}v=Rn,Rn=_,v!==null&&(Rn===null?Rn=v:Rn.push.apply(Rn,v))}_=A}if(v=!1,_!==2)continue}}if(_===1){da(s,0),cr(s,r,0,!0);break}e:{switch(c=s,v=_,v){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:cr(c,r,Fn,!or);break e;case 2:Rn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(_=Vc+300-Zt(),10<_)){if(cr(c,r,Fn,!or),hn(c,0,!0)!==0)break e;pi=r,c.timeoutHandle=u_(P0.bind(null,c,a,Rn,Uc,jh,r,Fn,fo,ua,or,v,"Throttled",-0,0),_);break e}P0(c,a,Rn,Uc,jh,r,Fn,fo,ua,or,v,null,-0,0)}}break}while(!0);Bs(s)}function P0(s,r,a,c,_,v,A,I,L,X,se,ae,W,te){if(s.timeoutHandle=-1,ae=r.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},S0(r,v,ae);var be=(v&62914560)===v?Vc-Zt():(v&4194048)===v?N0-Zt():0;if(be=IC(ae,be),be!==null){pi=v,s.cancelPendingCommit=be(j0.bind(null,s,r,v,a,c,_,A,I,L,se,ae,null,W,te)),cr(s,v,A,!X);return}}j0(s,r,v,a,c,_,A,I,L)}function HS(s){for(var r=s;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var _=a[c],v=_.getSnapshot;_=_.value;try{if(!Vn(v(),_))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function cr(s,r,a,c){r&=~Fh,r&=~fo,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var _=r;0<_;){var v=31-wt(_),A=1<<v;c[v]=-1,_&=~A}a!==0&&Fr(s,a,r)}function Oc(){return(at&6)===0?(Gl(0),!1):!0}function Gh(){if(He!==null){if(dt===0)var s=He.return;else s=He,ii=no=null,ah(s),ta=null,wl=0,s=He;for(;s!==null;)c0(s.alternate,s),s=s.return;He=null}}function da(s,r){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,cC(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),pi=0,Gh(),yt=s,He=a=ni(s.current,null),Ye=r,dt=0,qn=null,or=!1,la=ze(s,r),qh=!1,ua=Fn=Fh=fo=ar=Mt=0,Rn=zl=null,jh=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var _=31-wt(c),v=1<<_;r|=s[_],c&=~v}return mi=r,rc(),a}function k0(s,r){Fe=null,$.H=Vl,r===ea||r===hc?(r=Qg(),dt=3):r===Kf?(r=Qg(),dt=4):dt=r===bh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,qn=r,He===null&&(Mt=1,wc(s,Kn(r,s.current)))}function V0(){var s=Un.current;return s===null?!0:(Ye&4194048)===Ye?Zn===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?s===Zn:!1}function L0(){var s=$.H;return $.H=Vl,s===null?Vl:s}function U0(){var s=$.A;return $.A=BS,s}function qc(){Mt=4,or||(Ye&4194048)!==Ye&&Un.current!==null||(la=!0),(ar&134217727)===0&&(fo&134217727)===0||yt===null||cr(yt,Ye,Fn,!1)}function Yh(s,r,a){var c=at;at|=2;var _=L0(),v=U0();(yt!==s||Ye!==r)&&(Uc=null,da(s,r)),r=!1;var A=Mt;e:do try{if(dt!==0&&He!==null){var I=He,L=qn;switch(dt){case 8:Gh(),A=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(r=!0);var X=dt;if(dt=0,qn=null,fa(s,I,L,X),a&&la){A=0;break e}break;default:X=dt,dt=0,qn=null,fa(s,I,L,X)}}GS(),A=Mt;break}catch(se){k0(s,se)}while(!0);return r&&s.shellSuspendCounter++,ii=no=null,at=c,$.H=_,$.A=v,He===null&&(yt=null,Ye=0,rc()),A}function GS(){for(;He!==null;)O0(He)}function YS(s,r){var a=at;at|=2;var c=L0(),_=U0();yt!==s||Ye!==r?(Uc=null,Lc=Zt()+500,da(s,r)):la=ze(s,r);e:do try{if(dt!==0&&He!==null){r=He;var v=qn;t:switch(dt){case 1:dt=0,qn=null,fa(s,r,v,1);break;case 2:case 9:if(Jg(v)){dt=0,qn=null,q0(r);break}r=function(){dt!==2&&dt!==9||yt!==s||(dt=7),Bs(s)},v.then(r,r);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:Jg(v)?(dt=0,qn=null,q0(r)):(dt=0,qn=null,fa(s,r,v,7));break;case 5:var A=null;switch(He.tag){case 26:A=He.memoizedState;case 5:case 27:var I=He;if(A?A_(A):I.stateNode.complete){dt=0,qn=null;var L=I.sibling;if(L!==null)He=L;else{var X=I.return;X!==null?(He=X,Fc(X)):He=null}break t}}dt=0,qn=null,fa(s,r,v,5);break;case 6:dt=0,qn=null,fa(s,r,v,6);break;case 8:Gh(),Mt=6;break e;default:throw Error(i(462))}}$S();break}catch(se){k0(s,se)}while(!0);return ii=no=null,$.H=c,$.A=_,at=a,He!==null?0:(yt=null,Ye=0,rc(),Mt)}function $S(){for(;He!==null&&!tl();)O0(He)}function O0(s){var r=l0(s.alternate,s,mi);s.memoizedProps=s.pendingProps,r===null?Fc(s):He=r}function q0(s){var r=s,a=r.alternate;switch(r.tag){case 15:case 0:r=n0(a,r,r.pendingProps,r.type,void 0,Ye);break;case 11:r=n0(a,r,r.pendingProps,r.type.render,r.ref,Ye);break;case 5:ah(r);default:c0(a,r),r=He=Ug(r,mi),r=l0(a,r,mi)}s.memoizedProps=s.pendingProps,r===null?Fc(s):He=r}function fa(s,r,a,c){ii=no=null,ah(r),ta=null,wl=0;var _=r.return;try{if(VS(s,_,r,a,Ye)){Mt=1,wc(s,Kn(a,s.current)),He=null;return}}catch(v){if(_!==null)throw He=_,v;Mt=1,wc(s,Kn(a,s.current)),He=null;return}r.flags&32768?(Xe||c===1?s=!0:la||(Ye&536870912)!==0?s=!1:(or=s=!0,(c===2||c===9||c===3||c===6)&&(c=Un.current,c!==null&&c.tag===13&&(c.flags|=16384))),F0(r,s)):Fc(r)}function Fc(s){var r=s;do{if((r.flags&32768)!==0){F0(r,or);return}s=r.return;var a=OS(r.alternate,r,mi);if(a!==null){He=a;return}if(r=r.sibling,r!==null){He=r;return}He=r=s}while(r!==null);Mt===0&&(Mt=5)}function F0(s,r){do{var a=qS(s.alternate,s);if(a!==null){a.flags&=32767,He=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(s=s.sibling,s!==null)){He=s;return}He=s=a}while(s!==null);Mt=6,He=null}function j0(s,r,a,c,_,v,A,I,L){s.cancelPendingCommit=null;do jc();while(Qt!==0);if((at&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(v=r.lanes|r.childLanes,v|=kf,Sf(s,a,v,A,I,L),s===yt&&(He=yt=null,Ye=0),ca=r,ur=s,pi=a,Bh=v,zh=_,R0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,XS(K,function(){return Y0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,_=de.p,de.p=2,A=at,at|=4;try{FS(s,r,a)}finally{at=A,de.p=_,$.T=c}}Qt=1,B0(),z0(),H0()}}function B0(){if(Qt===1){Qt=0;var s=ur,r=ca,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=$.T,$.T=null;var c=de.p;de.p=2;var _=at;at|=4;try{x0(r,s);var v=im,A=Ig(s.containerInfo),I=v.focusedElem,L=v.selectionRange;if(A!==I&&I&&I.ownerDocument&&wg(I.ownerDocument.documentElement,I)){if(L!==null&&Nf(I)){var X=L.start,se=L.end;if(se===void 0&&(se=X),"selectionStart"in I)I.selectionStart=X,I.selectionEnd=Math.min(se,I.value.length);else{var ae=I.ownerDocument||document,W=ae&&ae.defaultView||window;if(W.getSelection){var te=W.getSelection(),be=I.textContent.length,Re=Math.min(L.start,be),gt=L.end===void 0?Re:Math.min(L.end,be);!te.extend&&Re>gt&&(A=gt,gt=Re,Re=A);var Y=Cg(I,Re),z=Cg(I,gt);if(Y&&z&&(te.rangeCount!==1||te.anchorNode!==Y.node||te.anchorOffset!==Y.offset||te.focusNode!==z.node||te.focusOffset!==z.offset)){var Q=ae.createRange();Q.setStart(Y.node,Y.offset),te.removeAllRanges(),Re>gt?(te.addRange(Q),te.extend(z.node,z.offset)):(Q.setEnd(z.node,z.offset),te.addRange(Q))}}}}for(ae=[],te=I;te=te.parentNode;)te.nodeType===1&&ae.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ae.length;I++){var oe=ae[I];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}Zc=!!sm,im=sm=null}finally{at=_,de.p=c,$.T=a}}s.current=r,Qt=2}}function z0(){if(Qt===2){Qt=0;var s=ur,r=ca,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=$.T,$.T=null;var c=de.p;de.p=2;var _=at;at|=4;try{y0(s,r.alternate,r)}finally{at=_,de.p=c,$.T=a}}Qt=3}}function H0(){if(Qt===4||Qt===3){Qt=0,Or();var s=ur,r=ca,a=pi,c=R0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Qt=5:(Qt=0,ca=ur=null,G0(s,s.pendingLanes));var _=s.pendingLanes;if(_===0&&(lr=null),Ws(a),r=r.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(et,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=$.T,_=de.p,de.p=2,$.T=null;try{for(var v=s.onRecoverableError,A=0;A<c.length;A++){var I=c[A];v(I.value,{componentStack:I.stack})}}finally{$.T=r,de.p=_}}(pi&3)!==0&&jc(),Bs(s),_=s.pendingLanes,(a&261930)!==0&&(_&42)!==0?s===Hh?Hl++:(Hl=0,Hh=s):Hl=0,Gl(0)}}function G0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Sl(r)))}function jc(){return B0(),z0(),H0(),Y0()}function Y0(){if(Qt!==5)return!1;var s=ur,r=Bh;Bh=0;var a=Ws(pi),c=$.T,_=de.p;try{de.p=32>a?32:a,$.T=null,a=zh,zh=null;var v=ur,A=pi;if(Qt=0,ca=ur=null,pi=0,(at&6)!==0)throw Error(i(331));var I=at;if(at|=4,w0(v.current),A0(v,v.current,A,a),at=I,Gl(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(et,v)}catch{}return!0}finally{de.p=_,$.T=c,G0(s,r)}}function $0(s,r,a){r=Kn(a,r),r=xh(s.stateNode,r,2),s=nr(s,r,2),s!==null&&(qr(s,2),Bs(s))}function ft(s,r,a){if(s.tag===3)$0(s,s,a);else for(;r!==null;){if(r.tag===3){$0(r,s,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(lr===null||!lr.has(c))){s=Kn(a,s),a=Jy(2),c=nr(r,a,2),c!==null&&(Ky(a,c,r,s),qr(c,2),Bs(c));break}}r=r.return}}function $h(s,r,a){var c=s.pingCache;if(c===null){c=s.pingCache=new zS;var _=new Set;c.set(r,_)}else _=c.get(r),_===void 0&&(_=new Set,c.set(r,_));_.has(a)||(qh=!0,_.add(a),s=JS.bind(null,s,r,a),r.then(s,s))}function JS(s,r,a){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,yt===s&&(Ye&a)===a&&(Mt===4||Mt===3&&(Ye&62914560)===Ye&&300>Zt()-Vc?(at&2)===0&&da(s,0):Fh|=a,ua===Ye&&(ua=0)),Bs(s)}function J0(s,r){r===0&&(r=Uu()),s=Zr(s,r),s!==null&&(qr(s,r),Bs(s))}function KS(s){var r=s.memoizedState,a=0;r!==null&&(a=r.retryLane),J0(s,a)}function QS(s,r){var a=0;switch(s.tag){case 31:case 13:var c=s.stateNode,_=s.memoizedState;_!==null&&(a=_.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),J0(s,a)}function XS(s,r){return Dt(s,r)}var Bc=null,ha=null,Jh=!1,zc=!1,Kh=!1,dr=0;function Bs(s){s!==ha&&s.next===null&&(ha===null?Bc=ha=s:ha=ha.next=s),zc=!0,Jh||(Jh=!0,ZS())}function Gl(s,r){if(!Kh&&zc){Kh=!0;do for(var a=!1,c=Bc;c!==null;){if(s!==0){var _=c.pendingLanes;if(_===0)var v=0;else{var A=c.suspendedLanes,I=c.pingedLanes;v=(1<<31-wt(42|s)+1)-1,v&=_&~(A&~I),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(a=!0,W0(c,v))}else v=Ye,v=hn(c,c===yt?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||ze(c,v)||(a=!0,W0(c,v));c=c.next}while(a);Kh=!1}}function WS(){K0()}function K0(){zc=Jh=!1;var s=0;dr!==0&&uC()&&(s=dr);for(var r=Zt(),a=null,c=Bc;c!==null;){var _=c.next,v=Q0(c,r);v===0?(c.next=null,a===null?Bc=_:a.next=_,_===null&&(ha=a)):(a=c,(s!==0||(v&3)!==0)&&(zc=!0)),c=_}Qt!==0&&Qt!==5||Gl(s),dr!==0&&(dr=0)}function Q0(s,r){for(var a=s.suspendedLanes,c=s.pingedLanes,_=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var A=31-wt(v),I=1<<A,L=_[A];L===-1?((I&a)===0||(I&c)!==0)&&(_[A]=Af(I,r)):L<=r&&(s.expiredLanes|=I),v&=~I}if(r=yt,a=Ye,a=hn(s,s===r?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,a===0||s===r&&(dt===2||dt===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&rs(c),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||ze(s,a)){if(r=a&-a,r===s.callbackPriority)return r;switch(c!==null&&rs(c),Ws(a)){case 2:case 8:a=qi;break;case 32:a=K;break;case 268435456:a=pe;break;default:a=K}return c=X0.bind(null,s),a=Dt(a,c),s.callbackPriority=r,s.callbackNode=a,r}return c!==null&&c!==null&&rs(c),s.callbackPriority=2,s.callbackNode=null,2}function X0(s,r){if(Qt!==0&&Qt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(jc()&&s.callbackNode!==a)return null;var c=Ye;return c=hn(s,s===yt?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(D0(s,c,r),Q0(s,Zt()),s.callbackNode!=null&&s.callbackNode===a?X0.bind(null,s):null)}function W0(s,r){if(jc())return null;D0(s,r,!0)}function ZS(){dC(function(){(at&6)!==0?Dt(Oi,WS):K0()})}function Qh(){if(dr===0){var s=Wo;s===0&&(s=Te,Te<<=1,(Te&261888)===0&&(Te=256)),dr=s}return dr}function Z0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Uo(""+s)}function e_(s,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,s.id&&a.setAttribute("form",s.id),r.parentNode.insertBefore(a,r),s=new FormData(s),a.parentNode.removeChild(a),s}function eC(s,r,a,c,_){if(r==="submit"&&a&&a.stateNode===_){var v=Z0((_[en]||null).action),A=c.submitter;A&&(r=(r=A[en]||null)?Z0(r.formAction):A.getAttribute("formAction"),r!==null&&(v=r,A=null));var I=new Vs("action","action",null,c,_);s.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(dr!==0){var L=A?e_(_,A):new FormData(_);gh(a,{pending:!0,data:L,method:_.method,action:v},null,L)}}else typeof v=="function"&&(I.preventDefault(),L=A?e_(_,A):new FormData(_),gh(a,{pending:!0,data:L,method:_.method,action:v},v,L))},currentTarget:_}]})}}for(var Xh=0;Xh<Pf.length;Xh++){var Wh=Pf[Xh],tC=Wh.toLowerCase(),nC=Wh[0].toUpperCase()+Wh.slice(1);hs(tC,"on"+nC)}hs(Mg,"onAnimationEnd"),hs(Dg,"onAnimationIteration"),hs(Pg,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(_S,"onTransitionRun"),hs(vS,"onTransitionStart"),hs(TS,"onTransitionCancel"),hs(kg,"onTransitionEnd"),Ms("onMouseEnter",["mouseout","mouseover"]),Ms("onMouseLeave",["mouseout","mouseover"]),Ms("onPointerEnter",["pointerout","pointerover"]),Ms("onPointerLeave",["pointerout","pointerover"]),Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yl));function t_(s,r){r=(r&4)!==0;for(var a=0;a<s.length;a++){var c=s[a],_=c.event;c=c.listeners;e:{var v=void 0;if(r)for(var A=c.length-1;0<=A;A--){var I=c[A],L=I.instance,X=I.currentTarget;if(I=I.listener,L!==v&&_.isPropagationStopped())break e;v=I,_.currentTarget=X;try{v(_)}catch(se){ic(se)}_.currentTarget=null,v=L}else for(A=0;A<c.length;A++){if(I=c[A],L=I.instance,X=I.currentTarget,I=I.listener,L!==v&&_.isPropagationStopped())break e;v=I,_.currentTarget=X;try{v(_)}catch(se){ic(se)}_.currentTarget=null,v=L}}}}function Ge(s,r){var a=r[Do];a===void 0&&(a=r[Do]=new Set);var c=s+"__bubble";a.has(c)||(n_(r,s,2,!1),a.add(c))}function Zh(s,r,a){var c=0;r&&(c|=4),n_(a,s,c,r)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function em(s){if(!s[Hc]){s[Hc]=!0,il.forEach(function(a){a!=="selectionchange"&&(sC.has(a)||Zh(a,!1,s),Zh(a,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Hc]||(r[Hc]=!0,Zh("selectionchange",!1,r))}}function n_(s,r,a,c){switch(M_(r)){case 2:var _=MC;break;case 8:_=DC;break;default:_=pm}a=_.bind(null,r,a,s),_=void 0,!Gr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(_=!0),c?_!==void 0?s.addEventListener(r,a,{capture:!0,passive:_}):s.addEventListener(r,a,!0):_!==void 0?s.addEventListener(r,a,{passive:_}):s.addEventListener(r,a,!1)}function tm(s,r,a,c,_){var v=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var I=c.stateNode.containerInfo;if(I===_)break;if(A===4)for(A=c.return;A!==null;){var L=A.tag;if((L===3||L===4)&&A.stateNode.containerInfo===_)return;A=A.return}for(;I!==null;){if(A=Is(I),A===null)return;if(L=A.tag,L===5||L===6||L===26||L===27){c=v=A;continue e}I=I.parentNode}}c=c.return}Yi(function(){var X=v,se=Gn(a),ae=[];e:{var W=Vg.get(s);if(W!==void 0){var te=Vs,be=s;switch(s){case"keypress":if($r(a)===0)break e;case"keydown":case"keyup":te=tc;break;case"focusin":be="focus",te=Kr;break;case"focusout":be="blur",te=Kr;break;case"beforeblur":case"afterblur":te=Kr;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=yl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Yu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=x;break;case Mg:case Dg:case Pg:te=Ju;break;case kg:te=M;break;case"scroll":case"scrollend":te=gl;break;case"wheel":te=ee;break;case"copy":case"cut":case"paste":te=Ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=ti;break;case"toggle":case"beforetoggle":te=qe}var Re=(r&4)!==0,gt=!Re&&(s==="scroll"||s==="scrollend"),Y=Re?W!==null?W+"Capture":null:W;Re=[];for(var z=X,Q;z!==null;){var oe=z;if(Q=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||Q===null||Y===null||(oe=us(z,Y),oe!=null&&Re.push($l(z,oe,Q))),gt)break;z=z.return}0<Re.length&&(W=new te(W,be,null,a,se),ae.push({event:W,listeners:Re}))}}if((r&7)===0){e:{if(W=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",W&&a!==hl&&(be=a.relatedTarget||a.fromElement)&&(Is(be)||be[Cs]))break e;if((te||W)&&(W=se.window===se?se:(W=se.ownerDocument)?W.defaultView||W.parentWindow:window,te?(be=a.relatedTarget||a.toElement,te=X,be=be?Is(be):null,be!==null&&(gt=l(be),Re=be.tag,be!==gt||Re!==5&&Re!==27&&Re!==6)&&(be=null)):(te=null,be=X),te!==be)){if(Re=yl,oe="onMouseLeave",Y="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Re=ti,oe="onPointerLeave",Y="onPointerEnter",z="pointer"),gt=te==null?W:Pn(te),Q=be==null?W:Pn(be),W=new Re(oe,z+"leave",te,a,se),W.target=gt,W.relatedTarget=Q,oe=null,Is(se)===X&&(Re=new Re(Y,z+"enter",be,a,se),Re.target=Q,Re.relatedTarget=gt,oe=Re),gt=oe,te&&be)t:{for(Re=iC,Y=te,z=be,Q=0,oe=Y;oe;oe=Re(oe))Q++;oe=0;for(var Ie=z;Ie;Ie=Re(Ie))oe++;for(;0<Q-oe;)Y=Re(Y),Q--;for(;0<oe-Q;)z=Re(z),oe--;for(;Q--;){if(Y===z||z!==null&&Y===z.alternate){Re=Y;break t}Y=Re(Y),z=Re(z)}Re=null}else Re=null;te!==null&&s_(ae,W,te,Re,!1),be!==null&&gt!==null&&s_(ae,gt,be,Re,!0)}}e:{if(W=X?Pn(X):window,te=W.nodeName&&W.nodeName.toLowerCase(),te==="select"||te==="input"&&W.type==="file")var st=Tg;else if(_g(W))if(Eg)st=pS;else{st=hS;var we=fS}else te=W.nodeName,!te||te.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?X&&Lo(X.elementType)&&(st=Tg):st=mS;if(st&&(st=st(s,X))){vg(ae,st,a,se);break e}we&&we(s,W,X),s==="focusout"&&X&&W.type==="number"&&X.memoizedProps.value!=null&&cl(W,"number",W.value)}switch(we=X?Pn(X):window,s){case"focusin":(_g(we)||we.contentEditable==="true")&&(Ho=we,Rf=X,xl=null);break;case"focusout":xl=Rf=Ho=null;break;case"mousedown":Mf=!0;break;case"contextmenu":case"mouseup":case"dragend":Mf=!1,Ng(ae,a,se);break;case"selectionchange":if(yS)break;case"keydown":case"keyup":Ng(ae,a,se)}var Be;if(ot)e:{switch(s){case"compositionstart":var $e="onCompositionStart";break e;case"compositionend":$e="onCompositionEnd";break e;case"compositionupdate":$e="onCompositionUpdate";break e}$e=void 0}else zo?Qr(s,a)&&($e="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&($e="onCompositionStart");$e&&(Os&&a.locale!=="ko"&&(zo||$e!=="onCompositionStart"?$e==="onCompositionEnd"&&zo&&(Be=pl()):(ks=se,ml="value"in ks?ks.value:ks.textContent,zo=!0)),we=Gc(X,$e),0<we.length&&($e=new Us($e,s,null,a,se),ae.push({event:$e,listeners:we}),Be?$e.data=Be:(Be=Bo(a),Be!==null&&($e.data=Be)))),(Be=$n?lS(s,a):uS(s,a))&&($e=Gc(X,"onBeforeInput"),0<$e.length&&(we=new Us("onBeforeInput","beforeinput",null,a,se),ae.push({event:we,listeners:$e}),we.data=Be)),eC(ae,s,X,a,se)}t_(ae,r)})}function $l(s,r,a){return{instance:s,listener:r,currentTarget:a}}function Gc(s,r){for(var a=r+"Capture",c=[];s!==null;){var _=s,v=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||v===null||(_=us(s,a),_!=null&&c.unshift($l(s,_,v)),_=us(s,r),_!=null&&c.push($l(s,_,v))),s.tag===3)return c;s=s.return}return[]}function iC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function s_(s,r,a,c,_){for(var v=r._reactName,A=[];a!==null&&a!==c;){var I=a,L=I.alternate,X=I.stateNode;if(I=I.tag,L!==null&&L===c)break;I!==5&&I!==26&&I!==27||X===null||(L=X,_?(X=us(a,v),X!=null&&A.unshift($l(a,X,L))):_||(X=us(a,v),X!=null&&A.push($l(a,X,L)))),a=a.return}A.length!==0&&s.push({event:r,listeners:A})}var rC=/\r\n?/g,oC=/\u0000|\uFFFD/g;function i_(s){return(typeof s=="string"?s:""+s).replace(rC,`
`).replace(oC,"")}function r_(s,r){return r=i_(r),i_(s)===r}function pt(s,r,a,c,_,v){switch(a){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Cn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Cn(s,""+c);break;case"className":kn(s,"class",c);break;case"tabIndex":kn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":kn(s,a,c);break;case"style":fl(s,c,v);break;case"data":if(r!=="object"){kn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||a!=="href")){s.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=Uo(""+c),s.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(a==="formAction"?(r!=="input"&&pt(s,r,"name",_.name,_,null),pt(s,r,"formEncType",_.formEncType,_,null),pt(s,r,"formMethod",_.formMethod,_,null),pt(s,r,"formTarget",_.formTarget,_,null)):(pt(s,r,"encType",_.encType,_,null),pt(s,r,"method",_.method,_,null),pt(s,r,"target",_.target,_,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=Uo(""+c),s.setAttribute(a,c);break;case"onClick":c!=null&&(s.onclick=ls);break;case"onScroll":c!=null&&Ge("scroll",s);break;case"onScrollEnd":c!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(_.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}a=Uo(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""+c):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":c===!0?s.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,c):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(a,c):s.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(a):s.setAttribute(a,c);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),ko(s,"popover",c);break;case"xlinkActuate":Bt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Bt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Bt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Bt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Bt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Bt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Bt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Bt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Bt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ko(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Gu.get(a)||a,ko(s,a,c))}}function nm(s,r,a,c,_,v){switch(a){case"style":fl(s,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(_.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"children":typeof c=="string"?Cn(s,c):(typeof c=="number"||typeof c=="bigint")&&Cn(s,""+c);break;case"onScroll":c!=null&&Ge("scroll",s);break;case"onScrollEnd":c!=null&&Ge("scrollend",s);break;case"onClick":c!=null&&(s.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!rl.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(_=a.endsWith("Capture"),r=a.slice(2,_?a.length-7:void 0),v=s[en]||null,v=v!=null?v[a]:null,typeof v=="function"&&s.removeEventListener(r,v,_),typeof c=="function")){typeof v!="function"&&v!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(r,c,_);break e}a in s?s[a]=c:c===!0?s.setAttribute(a,""):ko(s,a,c)}}}function dn(s,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var c=!1,_=!1,v;for(v in a)if(a.hasOwnProperty(v)){var A=a[v];if(A!=null)switch(v){case"src":c=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:pt(s,r,v,A,a,null)}}_&&pt(s,r,"srcSet",a.srcSet,a,null),c&&pt(s,r,"src",a.src,a,null);return;case"input":Ge("invalid",s);var I=v=A=_=null,L=null,X=null;for(c in a)if(a.hasOwnProperty(c)){var se=a[c];if(se!=null)switch(c){case"name":_=se;break;case"type":A=se;break;case"checked":L=se;break;case"defaultChecked":X=se;break;case"value":v=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:pt(s,r,c,se,a,null)}}Bu(s,v,I,L,X,A,_,!1);return;case"select":Ge("invalid",s),c=A=v=null;for(_ in a)if(a.hasOwnProperty(_)&&(I=a[_],I!=null))switch(_){case"value":v=I;break;case"defaultValue":A=I;break;case"multiple":c=I;default:pt(s,r,_,I,a,null)}r=v,a=A,s.multiple=!!c,r!=null?Bi(s,!!c,r,!1):a!=null&&Bi(s,!!c,a,!0);return;case"textarea":Ge("invalid",s),v=_=c=null;for(A in a)if(a.hasOwnProperty(A)&&(I=a[A],I!=null))switch(A){case"value":c=I;break;case"defaultValue":_=I;break;case"children":v=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:pt(s,r,A,I,a,null)}zi(s,c,_,v);return;case"option":for(L in a)if(a.hasOwnProperty(L)&&(c=a[L],c!=null))switch(L){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:pt(s,r,L,c,a,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(c=0;c<Yl.length;c++)Ge(Yl[c],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in a)if(a.hasOwnProperty(X)&&(c=a[X],c!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:pt(s,r,X,c,a,null)}return;default:if(Lo(r)){for(se in a)a.hasOwnProperty(se)&&(c=a[se],c!==void 0&&nm(s,r,se,c,a,void 0));return}}for(I in a)a.hasOwnProperty(I)&&(c=a[I],c!=null&&pt(s,r,I,c,a,null))}function aC(s,r,a,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,v=null,A=null,I=null,L=null,X=null,se=null;for(te in a){var ae=a[te];if(a.hasOwnProperty(te)&&ae!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":L=ae;default:c.hasOwnProperty(te)||pt(s,r,te,null,c,ae)}}for(var W in c){var te=c[W];if(ae=a[W],c.hasOwnProperty(W)&&(te!=null||ae!=null))switch(W){case"type":v=te;break;case"name":_=te;break;case"checked":X=te;break;case"defaultChecked":se=te;break;case"value":A=te;break;case"defaultValue":I=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,r));break;default:te!==ae&&pt(s,r,W,te,c,ae)}}Vo(s,A,I,L,X,se,v,_);return;case"select":te=A=I=W=null;for(v in a)if(L=a[v],a.hasOwnProperty(v)&&L!=null)switch(v){case"value":break;case"multiple":te=L;default:c.hasOwnProperty(v)||pt(s,r,v,null,c,L)}for(_ in c)if(v=c[_],L=a[_],c.hasOwnProperty(_)&&(v!=null||L!=null))switch(_){case"value":W=v;break;case"defaultValue":I=v;break;case"multiple":A=v;default:v!==L&&pt(s,r,_,v,c,L)}r=I,a=A,c=te,W!=null?Bi(s,!!a,W,!1):!!c!=!!a&&(r!=null?Bi(s,!!a,r,!0):Bi(s,!!a,a?[]:"",!1));return;case"textarea":te=W=null;for(I in a)if(_=a[I],a.hasOwnProperty(I)&&_!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:pt(s,r,I,null,c,_)}for(A in c)if(_=c[A],v=a[A],c.hasOwnProperty(A)&&(_!=null||v!=null))switch(A){case"value":W=_;break;case"defaultValue":te=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(i(91));break;default:_!==v&&pt(s,r,A,_,c,v)}zu(s,W,te);return;case"option":for(var be in a)if(W=a[be],a.hasOwnProperty(be)&&W!=null&&!c.hasOwnProperty(be))switch(be){case"selected":s.selected=!1;break;default:pt(s,r,be,null,c,W)}for(L in c)if(W=c[L],te=a[L],c.hasOwnProperty(L)&&W!==te&&(W!=null||te!=null))switch(L){case"selected":s.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:pt(s,r,L,W,c,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in a)W=a[Re],a.hasOwnProperty(Re)&&W!=null&&!c.hasOwnProperty(Re)&&pt(s,r,Re,null,c,W);for(X in c)if(W=c[X],te=a[X],c.hasOwnProperty(X)&&W!==te&&(W!=null||te!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,r));break;default:pt(s,r,X,W,c,te)}return;default:if(Lo(r)){for(var gt in a)W=a[gt],a.hasOwnProperty(gt)&&W!==void 0&&!c.hasOwnProperty(gt)&&nm(s,r,gt,void 0,c,W);for(se in c)W=c[se],te=a[se],!c.hasOwnProperty(se)||W===te||W===void 0&&te===void 0||nm(s,r,se,W,c,te);return}}for(var Y in a)W=a[Y],a.hasOwnProperty(Y)&&W!=null&&!c.hasOwnProperty(Y)&&pt(s,r,Y,null,c,W);for(ae in c)W=c[ae],te=a[ae],!c.hasOwnProperty(ae)||W===te||W==null&&te==null||pt(s,r,ae,W,c,te)}function o_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var _=a[c],v=_.transferSize,A=_.initiatorType,I=_.duration;if(v&&I&&o_(A)){for(A=0,I=_.responseEnd,c+=1;c<a.length;c++){var L=a[c],X=L.startTime;if(X>I)break;var se=L.transferSize,ae=L.initiatorType;se&&o_(ae)&&(L=L.responseEnd,A+=se*(L<I?1:(I-X)/(L-X)))}if(--c,r+=8*(v+A)/(_.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var sm=null,im=null;function Yc(s){return s.nodeType===9?s:s.ownerDocument}function a_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function l_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function rm(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var om=null;function uC(){var s=window.event;return s&&s.type==="popstate"?s===om?!1:(om=s,!0):(om=null,!1)}var u_=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,c_=typeof Promise=="function"?Promise:void 0,dC=typeof queueMicrotask=="function"?queueMicrotask:typeof c_<"u"?function(s){return c_.resolve(null).then(s).catch(fC)}:u_;function fC(s){setTimeout(function(){throw s})}function fr(s){return s==="head"}function d_(s,r){var a=r,c=0;do{var _=a.nextSibling;if(s.removeChild(a),_&&_.nodeType===8)if(a=_.data,a==="/$"||a==="/&"){if(c===0){s.removeChild(_),ya(r);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")Jl(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,Jl(a);for(var v=a.firstChild;v;){var A=v.nextSibling,I=v.nodeName;v[ws]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&v.rel.toLowerCase()==="stylesheet"||a.removeChild(v),v=A}}else a==="body"&&Jl(s.ownerDocument.body);a=_}while(a);ya(r)}function f_(s,r){var a=s;s=0;do{var c=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=c}while(a)}function am(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":am(a),Po(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function hC(s,r,a,c){for(;s.nodeType===1;){var _=a;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[ws])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==_.rel||s.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||s.getAttribute("title")!==(_.title==null?null:_.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(_.src==null?null:_.src)||s.getAttribute("type")!==(_.type==null?null:_.type)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var v=_.name==null?null:""+_.name;if(_.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=es(s.nextSibling),s===null)break}return null}function mC(s,r,a){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=es(s.nextSibling),s===null))return null;return s}function h_(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=es(s.nextSibling),s===null))return null;return s}function lm(s){return s.data==="$?"||s.data==="$~"}function um(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function pC(s,r){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||a.readyState!=="loading")r();else{var c=function(){r(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function es(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var cm=null;function m_(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(r===0)return es(s.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}s=s.nextSibling}return null}function p_(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return s;r--}else a!=="/$"&&a!=="/&"||r++}s=s.previousSibling}return null}function g_(s,r,a){switch(r=Yc(a),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Jl(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Po(s)}var ts=new Map,y_=new Set;function $c(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var gi=de.d;de.d={f:gC,r:yC,D:_C,C:vC,L:TC,m:EC,X:bC,S:xC,M:AC};function gC(){var s=gi.f(),r=Oc();return s||r}function yC(s){var r=Hn(s);r!==null&&r.tag===5&&r.type==="form"?ky(r):gi.r(s)}var ma=typeof document>"u"?null:document;function __(s,r,a){var c=ma;if(c&&typeof r=="string"&&r){var _=Sn(r);_='link[rel="'+s+'"][href="'+_+'"]',typeof a=="string"&&(_+='[crossorigin="'+a+'"]'),y_.has(_)||(y_.add(_),s={rel:s,crossOrigin:a,href:r},c.querySelector(_)===null&&(r=c.createElement("link"),dn(r,"link",s),jt(r),c.head.appendChild(r)))}}function _C(s){gi.D(s),__("dns-prefetch",s,null)}function vC(s,r){gi.C(s,r),__("preconnect",s,r)}function TC(s,r,a){gi.L(s,r,a);var c=ma;if(c&&s&&r){var _='link[rel="preload"][as="'+Sn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(_+='[imagesrcset="'+Sn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(_+='[imagesizes="'+Sn(a.imageSizes)+'"]')):_+='[href="'+Sn(s)+'"]';var v=_;switch(r){case"style":v=pa(s);break;case"script":v=ga(s)}ts.has(v)||(s=E({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:s,as:r},a),ts.set(v,s),c.querySelector(_)!==null||r==="style"&&c.querySelector(Kl(v))||r==="script"&&c.querySelector(Ql(v))||(r=c.createElement("link"),dn(r,"link",s),jt(r),c.head.appendChild(r)))}}function EC(s,r){gi.m(s,r);var a=ma;if(a&&s){var c=r&&typeof r.as=="string"?r.as:"script",_='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(s)+'"]',v=_;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ga(s)}if(!ts.has(v)&&(s=E({rel:"modulepreload",href:s},r),ts.set(v,s),a.querySelector(_)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ql(v)))return}c=a.createElement("link"),dn(c,"link",s),jt(c),a.head.appendChild(c)}}}function xC(s,r,a){gi.S(s,r,a);var c=ma;if(c&&s){var _=Ns(c).hoistableStyles,v=pa(s);r=r||"default";var A=_.get(v);if(!A){var I={loading:0,preload:null};if(A=c.querySelector(Kl(v)))I.loading=5;else{s=E({rel:"stylesheet",href:s,"data-precedence":r},a),(a=ts.get(v))&&dm(s,a);var L=A=c.createElement("link");jt(L),dn(L,"link",s),L._p=new Promise(function(X,se){L.onload=X,L.onerror=se}),L.addEventListener("load",function(){I.loading|=1}),L.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Jc(A,r,c)}A={type:"stylesheet",instance:A,count:1,state:I},_.set(v,A)}}}function bC(s,r){gi.X(s,r);var a=ma;if(a&&s){var c=Ns(a).hoistableScripts,_=ga(s),v=c.get(_);v||(v=a.querySelector(Ql(_)),v||(s=E({src:s,async:!0},r),(r=ts.get(_))&&fm(s,r),v=a.createElement("script"),jt(v),dn(v,"link",s),a.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(_,v))}}function AC(s,r){gi.M(s,r);var a=ma;if(a&&s){var c=Ns(a).hoistableScripts,_=ga(s),v=c.get(_);v||(v=a.querySelector(Ql(_)),v||(s=E({src:s,async:!0,type:"module"},r),(r=ts.get(_))&&fm(s,r),v=a.createElement("script"),jt(v),dn(v,"link",s),a.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(_,v))}}function v_(s,r,a,c){var _=(_=ce.current)?$c(_):null;if(!_)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=pa(a.href),a=Ns(_).hoistableStyles,c=a.get(r),c||(c={type:"style",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=pa(a.href);var v=Ns(_).hoistableStyles,A=v.get(s);if(A||(_=_.ownerDocument||_,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,A),(v=_.querySelector(Kl(s)))&&!v._p&&(A.instance=v,A.state.loading=5),ts.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ts.set(s,a),v||SC(_,s,a,A.state))),r&&c===null)throw Error(i(528,""));return A}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ga(a),a=Ns(_).hoistableScripts,c=a.get(r),c||(c={type:"script",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function pa(s){return'href="'+Sn(s)+'"'}function Kl(s){return'link[rel="stylesheet"]['+s+"]"}function T_(s){return E({},s,{"data-precedence":s.precedence,precedence:null})}function SC(s,r,a,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),dn(r,"link",a),jt(r),s.head.appendChild(r))}function ga(s){return'[src="'+Sn(s)+'"]'}function Ql(s){return"script[async]"+s}function E_(s,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+Sn(a.href)+'"]');if(c)return r.instance=c,jt(c),c;var _=E({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),jt(c),dn(c,"style",_),Jc(c,a.precedence,s),r.instance=c;case"stylesheet":_=pa(a.href);var v=s.querySelector(Kl(_));if(v)return r.state.loading|=4,r.instance=v,jt(v),v;c=T_(a),(_=ts.get(_))&&dm(c,_),v=(s.ownerDocument||s).createElement("link"),jt(v);var A=v;return A._p=new Promise(function(I,L){A.onload=I,A.onerror=L}),dn(v,"link",c),r.state.loading|=4,Jc(v,a.precedence,s),r.instance=v;case"script":return v=ga(a.src),(_=s.querySelector(Ql(v)))?(r.instance=_,jt(_),_):(c=a,(_=ts.get(v))&&(c=E({},a),fm(c,_)),s=s.ownerDocument||s,_=s.createElement("script"),jt(_),dn(_,"link",c),s.head.appendChild(_),r.instance=_);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Jc(c,a.precedence,s));return r.instance}function Jc(s,r,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=c.length?c[c.length-1]:null,v=_,A=0;A<c.length;A++){var I=c[A];if(I.dataset.precedence===r)v=I;else if(v!==_)break}v?v.parentNode.insertBefore(s,v.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(s,r.firstChild))}function dm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function fm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Kc=null;function x_(s,r,a){if(Kc===null){var c=new Map,_=Kc=new Map;_.set(a,c)}else _=Kc,c=_.get(a),c||(c=new Map,_.set(a,c));if(c.has(s))return c;for(c.set(s,null),a=a.getElementsByTagName(s),_=0;_<a.length;_++){var v=a[_];if(!(v[ws]||v[Ft]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var A=v.getAttribute(r)||"";A=s+A;var I=c.get(A);I?I.push(v):c.set(A,[v])}}return c}function b_(s,r,a){s=s.ownerDocument||s,s.head.insertBefore(a,r==="title"?s.querySelector("head > title"):null)}function CC(s,r,a){if(a===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function A_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function wC(s,r,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var _=pa(c.href),v=r.querySelector(Kl(_));if(v){r=v._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Qc.bind(s),r.then(s,s)),a.state.loading|=4,a.instance=v,jt(v);return}v=r.ownerDocument||r,c=T_(c),(_=ts.get(_))&&dm(c,_),v=v.createElement("link"),jt(v);var A=v;A._p=new Promise(function(I,L){A.onload=I,A.onerror=L}),dn(v,"link",c),a.instance=v}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=Qc.bind(s),r.addEventListener("load",a),r.addEventListener("error",a))}}var hm=0;function IC(s,r){return s.stylesheets&&s.count===0&&Wc(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var c=setTimeout(function(){if(s.stylesheets&&Wc(s,s.stylesheets),s.unsuspend){var v=s.unsuspend;s.unsuspend=null,v()}},6e4+r);0<s.imgBytes&&hm===0&&(hm=62500*lC());var _=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Wc(s,s.stylesheets),s.unsuspend)){var v=s.unsuspend;s.unsuspend=null,v()}},(s.imgBytes>hm?50:800)+r);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(_)}}:null}function Qc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Xc=null;function Wc(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Xc=new Map,r.forEach(NC,s),Xc=null,Qc.call(s))}function NC(s,r){if(!(r.state.loading&4)){var a=Xc.get(s);if(a)var c=a.get(null);else{a=new Map,Xc.set(s,a);for(var _=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<_.length;v++){var A=_[v];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(a.set(A.dataset.precedence,A),c=A)}c&&a.set(null,c)}_=r.instance,A=_.getAttribute("data-precedence"),v=a.get(A)||c,v===c&&a.set(null,_),a.set(A,_),this.count++,c=Qc.bind(this),_.addEventListener("load",c),_.addEventListener("error",c),v?v.parentNode.insertBefore(_,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(_,s.firstChild)),r.state.loading|=4}}var Xl={$$typeof:q,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function RC(s,r,a,c,_,v,A,I,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ss(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ss(0),this.hiddenUpdates=Ss(null),this.identifierPrefix=c,this.onUncaughtError=_,this.onCaughtError=v,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function S_(s,r,a,c,_,v,A,I,L,X,se,ae){return s=new RC(s,r,a,A,L,X,se,ae,I),r=1,v===!0&&(r|=24),v=Ln(3,null,null,r),s.current=v,v.stateNode=s,r=Yf(),r.refCount++,s.pooledCache=r,r.refCount++,v.memoizedState={element:c,isDehydrated:a,cache:r},Qf(v),s}function C_(s){return s?(s=$o,s):$o}function w_(s,r,a,c,_,v){_=C_(_),c.context===null?c.context=_:c.pendingContext=_,c=tr(r),c.payload={element:a},v=v===void 0?null:v,v!==null&&(c.callback=v),a=nr(s,c,r),a!==null&&(Mn(a,s,r),Nl(a,s,r))}function I_(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<r?a:r}}function mm(s,r){I_(s,r),(s=s.alternate)&&I_(s,r)}function N_(s){if(s.tag===13||s.tag===31){var r=Zr(s,67108864);r!==null&&Mn(r,s,67108864),mm(s,67108864)}}function R_(s){if(s.tag===13||s.tag===31){var r=jn();r=jr(r);var a=Zr(s,r);a!==null&&Mn(a,s,r),mm(s,r)}}var Zc=!0;function MC(s,r,a,c){var _=$.T;$.T=null;var v=de.p;try{de.p=2,pm(s,r,a,c)}finally{de.p=v,$.T=_}}function DC(s,r,a,c){var _=$.T;$.T=null;var v=de.p;try{de.p=8,pm(s,r,a,c)}finally{de.p=v,$.T=_}}function pm(s,r,a,c){if(Zc){var _=gm(c);if(_===null)tm(s,r,c,ed,a),D_(s,c);else if(kC(_,s,r,a,c))c.stopPropagation();else if(D_(s,c),r&4&&-1<PC.indexOf(s)){for(;_!==null;){var v=Hn(_);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var A=Pt(v.pendingLanes);if(A!==0){var I=v;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var L=1<<31-wt(A);I.entanglements[1]|=L,A&=~L}Bs(v),(at&6)===0&&(Lc=Zt()+500,Gl(0))}}break;case 31:case 13:I=Zr(v,2),I!==null&&Mn(I,v,2),Oc(),mm(v,2)}if(v=gm(c),v===null&&tm(s,r,c,ed,a),v===_)break;_=v}_!==null&&c.stopPropagation()}else tm(s,r,c,null,a)}}function gm(s){return s=Gn(s),ym(s)}var ed=null;function ym(s){if(ed=null,s=Is(s),s!==null){var r=l(s);if(r===null)s=null;else{var a=r.tag;if(a===13){if(s=u(r),s!==null)return s;s=null}else if(a===31){if(s=d(r),s!==null)return s;s=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return ed=s,null}function M_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(As()){case Oi:return 2;case qi:return 8;case K:case me:return 32;case pe:return 268435456;default:return 32}default:return 32}}var _m=!1,hr=null,mr=null,pr=null,Wl=new Map,Zl=new Map,gr=[],PC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function D_(s,r){switch(s){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":mr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":Wl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zl.delete(r.pointerId)}}function eu(s,r,a,c,_,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:v,targetContainers:[_]},r!==null&&(r=Hn(r),r!==null&&N_(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,_!==null&&r.indexOf(_)===-1&&r.push(_),s)}function kC(s,r,a,c,_){switch(r){case"focusin":return hr=eu(hr,s,r,a,c,_),!0;case"dragenter":return mr=eu(mr,s,r,a,c,_),!0;case"mouseover":return pr=eu(pr,s,r,a,c,_),!0;case"pointerover":var v=_.pointerId;return Wl.set(v,eu(Wl.get(v)||null,s,r,a,c,_)),!0;case"gotpointercapture":return v=_.pointerId,Zl.set(v,eu(Zl.get(v)||null,s,r,a,c,_)),!0}return!1}function P_(s){var r=Is(s.target);if(r!==null){var a=l(r);if(a!==null){if(r=a.tag,r===13){if(r=u(a),r!==null){s.blockedOn=r,os(s.priority,function(){R_(a)});return}}else if(r===31){if(r=d(a),r!==null){s.blockedOn=r,os(s.priority,function(){R_(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function td(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var a=gm(s.nativeEvent);if(a===null){a=s.nativeEvent;var c=new a.constructor(a.type,a);hl=c,a.target.dispatchEvent(c),hl=null}else return r=Hn(a),r!==null&&N_(r),s.blockedOn=a,!1;r.shift()}return!0}function k_(s,r,a){td(s)&&a.delete(r)}function VC(){_m=!1,hr!==null&&td(hr)&&(hr=null),mr!==null&&td(mr)&&(mr=null),pr!==null&&td(pr)&&(pr=null),Wl.forEach(k_),Zl.forEach(k_)}function nd(s,r){s.blockedOn===r&&(s.blockedOn=null,_m||(_m=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,VC)))}var sd=null;function V_(s){sd!==s&&(sd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){sd===s&&(sd=null);for(var r=0;r<s.length;r+=3){var a=s[r],c=s[r+1],_=s[r+2];if(typeof c!="function"){if(ym(c||a)===null)continue;break}var v=Hn(a);v!==null&&(s.splice(r,3),r-=3,gh(v,{pending:!0,data:_,method:a.method,action:c},c,_))}}))}function ya(s){function r(L){return nd(L,s)}hr!==null&&nd(hr,s),mr!==null&&nd(mr,s),pr!==null&&nd(pr,s),Wl.forEach(r),Zl.forEach(r);for(var a=0;a<gr.length;a++){var c=gr[a];c.blockedOn===s&&(c.blockedOn=null)}for(;0<gr.length&&(a=gr[0],a.blockedOn===null);)P_(a),a.blockedOn===null&&gr.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var _=a[c],v=a[c+1],A=_[en]||null;if(typeof v=="function")A||V_(a);else if(A){var I=null;if(v&&v.hasAttribute("formAction")){if(_=v,A=v[en]||null)I=A.formAction;else if(ym(_)!==null)continue}else I=A.action;typeof I=="function"?a[c+1]=I:(a.splice(c,3),c-=3),V_(a)}}}function L_(){function s(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(A){return _=A})},focusReset:"manual",scroll:"manual"})}function r(){_!==null&&(_(),_=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,_=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),_!==null&&(_(),_=null)}}}function vm(s){this._internalRoot=s}id.prototype.render=vm.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var a=r.current,c=jn();w_(a,c,s,r,null,null)},id.prototype.unmount=vm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;w_(s.current,2,null,s,null,null),Oc(),r[Cs]=null}};function id(s){this._internalRoot=s}id.prototype.unstable_scheduleHydration=function(s){if(s){var r=Ou();s={blockedOn:null,target:s,priority:r};for(var a=0;a<gr.length&&r!==0&&r<gr[a].priority;a++);gr.splice(a,0,s),a===0&&P_(s)}};var U_=e.version;if(U_!=="19.2.0")throw Error(i(527,U_,"19.2.0"));de.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?T(s):null,s=s===null?null:s.stateNode,s};var LC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{et=rd.inject(LC),qt=rd}catch{}}return nu.createRoot=function(s,r){if(!o(s))throw Error(i(299));var a=!1,c="",_=Hy,v=Gy,A=Yy;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(_=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=S_(s,1,!1,null,null,a,c,null,_,v,A,L_),s[Cs]=r.current,em(s),new vm(r)},nu.hydrateRoot=function(s,r,a){if(!o(s))throw Error(i(299));var c=!1,_="",v=Hy,A=Gy,I=Yy,L=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(_=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(A=a.onCaughtError),a.onRecoverableError!==void 0&&(I=a.onRecoverableError),a.formState!==void 0&&(L=a.formState)),r=S_(s,1,!0,r,a??null,c,_,L,v,A,I,L_),r.context=C_(null),a=r.current,c=jn(),c=jr(c),_=tr(c),_.callback=null,nr(a,_,c),a=c,r.current.lanes=a,qr(r,a),Bs(r),s[Cs]=r.current,em(s),new id(r)},nu.version="19.2.0",nu}var $_;function YC(){if($_)return xm.exports;$_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xm.exports=GC(),xm.exports}var $C=YC();const JC=qE($C),od=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KC,QC;function XC(){return{geminiUrl:KC,vertexUrl:QC}}function WC(n,e,t,i){var o,l;if(!(n!=null&&n.baseUrl)){const u=XC();return e?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(l=u.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bo{}function Ae(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const l=e[o];return l!=null?String(l):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function y(n,e,t){for(let l=0;l<e.length-1;l++){const u=e[l];if(u.endsWith("[]")){const d=u.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[d])){const g=n[d];if(Array.isArray(t))for(let m=0;m<g.length;m++){const T=g[m];y(T,e.slice(l+1),t[m])}else for(const m of g)y(m,e.slice(l+1),t)}return}else if(u.endsWith("[0]")){const d=u.slice(0,-3);d in n||(n[d]=[{}]);const g=n[d];y(g[0],e.slice(l+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(l in n){const u=n[l];return Array.isArray(u)?u.map(d=>h(d,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wp(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZC(n){const e={},t=h(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function ew(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],nw(u)),e}function tw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],sw(u)),e}function nw(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>iw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function sw(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>rw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function iw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],lw(t)),e}function rw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],uw(t)),e}function ow(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function aw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function lw(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],wp(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function uw(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],wp(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var J_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(J_||(J_={}));var K_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(K_||(K_={}));var vr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(vr||(vr={}));var Q_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Q_||(Q_={}));var X_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(X_||(X_={}));var W_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(W_||(W_={}));var Z_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Z_||(Z_={}));var ev;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(ev||(ev={}));var tv;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(tv||(tv={}));var nv;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(nv||(nv={}));var sv;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(sv||(sv={}));var iv;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(iv||(iv={}));var rv;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(rv||(rv={}));var ov;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(ov||(ov={}));var av;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(av||(av={}));var Cd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Cd||(Cd={}));var lv;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(lv||(lv={}));var Gm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Gm||(Gm={}));var uv;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(uv||(uv={}));var cv;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(cv||(cv={}));var dv;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(dv||(dv={}));var fv;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(fv||(fv={}));var hv;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(hv||(hv={}));var mv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(mv||(mv={}));var pv;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pv||(pv={}));var gv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(gv||(gv={}));var yv;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(yv||(yv={}));var _v;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(_v||(_v={}));var vv;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(vv||(vv={}));var Tv;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Tv||(Tv={}));var Ev;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ev||(Ev={}));var xv;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xv||(xv={}));var bv;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(bv||(bv={}));var Av;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(Av||(Av={}));var Sv;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(Sv||(Sv={}));var Cv;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Cv||(Cv={}));var wv;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(wv||(wv={}));var Iv;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Iv||(Iv={}));var Nv;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(Nv||(Nv={}));var Rv;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Rv||(Rv={}));var Mv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(Mv||(Mv={}));var Dv;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Dv||(Dv={}));var Pv;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Pv||(Pv={}));var kv;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(kv||(kv={}));var Vv;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Vv||(Vv={}));var Lv;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Lv||(Lv={}));var Uv;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Uv||(Uv={}));var Ov;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(Ov||(Ov={}));var xa;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(xa||(xa={}));class Ym{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class su{get text(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",T=!1;const E=[];for(const b of(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&g!==void 0?g:[]){for(const[C,P]of Object.entries(b))C!=="text"&&C!=="thought"&&(P!==null||P!==void 0)&&E.push(C);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;T=!0,m+=b.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?m:void 0}get data(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const T=[];for(const E of(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&g!==void 0?g:[]){for(const[b,C]of Object.entries(E))b!=="inlineData"&&(C!==null||C!==void 0)&&T.push(b);E.inlineData&&typeof E.inlineData.data=="string"&&(m+=atob(E.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,i,o,l,u,d,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,o,l,u,d,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.output}}class qv{}class Fv{}class cw{}class dw{}class fw{}class hw{}class jv{}class Bv{}class zv{}class mw{}class wd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new wd;let o;const l=e;return t?o=tw(l):o=ew(l),Object.assign(i,o),i}}class Hv{}class Gv{}class Yv{}class pw{}class gw{}class yw{}class $v{}class _w{get text(){var e,t,i;let o="",l=!1;const u=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,m]of Object.entries(d))g!=="text"&&g!=="thought"&&m!==null&&u.push(g);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;l=!0,o+=d.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var e,t,i;let o="";const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,g]of Object.entries(u))d!=="inlineData"&&g!==null&&l.push(d);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class vw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function jE(n,e){const t=rt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function BE(n){return Array.isArray(n)?n.map(e=>Id(e)):[Id(n)]}function Id(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function zE(n){const e=Id(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function HE(n){const e=Id(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Jv(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function GE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>Jv(e)):[Jv(n)]}function $m(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Kv(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function Qv(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function _n(n){if(n==null)throw new Error("ContentUnion is required");return $m(n)?n:{role:"user",parts:GE(n)}}function Ip(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=_n(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=_n(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>_n(t)):[_n(e)]}function is(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Kv(n)||Qv(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[_n(n)]}const e=[],t=[],i=$m(n[0]);for(const o of n){const l=$m(o);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(o);else{if(Kv(o)||Qv(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:GE(t)}),e}function Tw(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(vr).includes(t[0].toUpperCase())?t[0].toUpperCase():vr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(vr).includes(i.toUpperCase())?i.toUpperCase():vr.TYPE_UNSPECIFIED})}}function Sa(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&Tw(n.type,e);for(const[u,d]of Object.entries(n))if(d!=null)if(u=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(vr).includes(d.toUpperCase())?d.toUpperCase():vr.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Sa(d);else if(i.includes(u)){const g=[];for(const m of d){if(m.type=="null"){e.nullable=!0;continue}g.push(Sa(m))}e[u]=g}else if(o.includes(u)){const g={};for(const[m,T]of Object.entries(d))g[m]=Sa(T);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=d}return e}function Np(n){return Sa(n)}function Rp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Mp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function za(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Sa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Sa(e.response));return n}function Ha(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Ew(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function ki(n,e){if(typeof e!="string")throw new Error("name must be a string");return Ew(n,e,"cachedContents")}function YE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Pr(n){return wp(n)}function xw(n){return n!=null&&typeof n=="object"&&"name"in n}function bw(n){return n!=null&&typeof n=="object"&&"video"in n}function Aw(n){return n!=null&&typeof n=="object"&&"uri"in n}function $E(n){var e;let t;if(xw(n)&&(t=n.name),!(Aw(n)&&(t=n.uri,t===void 0))&&!(bw(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function JE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function KE(n){for(const e of["models","tunedModels","publisherModels"])if(Sw(n,e))return n[e];return[]}function Sw(n,e){return n!==null&&typeof n=="object"&&e in n}function Cw(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function ww(n,e={}){const t=[],i=new Set;for(const o of n){const l=o.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const u=Cw(o,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function QE(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Iw(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function XE(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let l=!1;for(const u of o){if(typeof u!="object"||u===null)continue;const g=u.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Ga(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function WE(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nw(n){const e={},t=h(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>rI(u))),y(e,["inlinedResponses"],l)}const o=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["inlinedEmbedContentResponses"],l)}return e}function Rw(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigqueryDestination","outputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Mw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigqueryDestination","outputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function iu(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["metadata","state"]);o!=null&&y(e,["state"],WE(o));const l=h(n,["metadata","createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const d=h(n,["metadata","updateTime"]);d!=null&&y(e,["updateTime"],d);const g=h(n,["metadata","model"]);g!=null&&y(e,["model"],g);const m=h(n,["metadata","output"]);return m!=null&&y(e,["dest"],Nw(XE(m))),e}function Jm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],WE(o));const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["createTime"]);u!=null&&y(e,["createTime"],u);const d=h(n,["startTime"]);d!=null&&y(e,["startTime"],d);const g=h(n,["endTime"]);g!=null&&y(e,["endTime"],g);const m=h(n,["updateTime"]);m!=null&&y(e,["updateTime"],m);const T=h(n,["model"]);T!=null&&y(e,["model"],T);const E=h(n,["inputConfig"]);E!=null&&y(e,["src"],Dw(E));const b=h(n,["outputConfig"]);return b!=null&&y(e,["dest"],Rw(XE(b))),e}function Dw(n){const e={},t=h(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigquerySource","inputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Pw(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&y(t,["fileName"],i);const o=h(e,["inlinedRequests"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>iI(n,u))),y(t,["requests","requests"],l)}return t}function kw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigquerySource","inputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Vw(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Lw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function Uw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function Ow(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],qw(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=h(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=h(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(C=>C)),y(e,["safetyRatings"],b)}return e}function qw(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function ZE(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>fI(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function Fw(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function jw(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["dest"]);return e!==void 0&&o!=null&&y(e,["outputConfig"],Mw(Iw(o))),t}function Xv(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],Pw(n,QE(n,o)));const l=h(e,["config"]);return l!=null&&Fw(l,t),t}function Bw(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],rt(n,i));const o=h(e,["src"]);o!=null&&y(t,["inputConfig"],kw(QE(n,o)));const l=h(e,["config"]);return l!=null&&jw(l,t),t}function zw(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function Cm(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],Qw(n,o));const l=h(e,["config"]);return l!=null&&zw(l,t),t}function Hw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function Gw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function Yw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function $w(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function Jw(n,e){const t={},i=h(e,["contents"]);if(i!=null){let l=Ip(n,i);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["requests[]","request","content"],l)}const o=h(e,["config"]);return o!=null&&y(t,["_self"],Kw(o,t)),t}function Kw(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Qw(n,e){const t={},i=h(e,["fileName"]);i!=null&&y(t,["file_name"],i);const o=h(e,["inlinedRequests"]);return o!=null&&y(t,["requests"],Jw(n,o)),t}function Xw(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Ww(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],ZE(_n(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&y(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&y(i,["seed"],O);const G=h(e,["responseMimeType"]);G!=null&&y(i,["responseMimeType"],G);const ne=h(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Np(ne));const j=h(e,["responseJsonSchema"]);if(j!=null&&y(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=h(e,["safetySettings"]);if(t!==void 0&&q!=null){let F=q;Array.isArray(F)&&(F=F.map(D=>hI(D))),y(t,["safetySettings"],F)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let F=Ha(H);Array.isArray(F)&&(F=F.map(D=>mI(za(D)))),y(t,["tools"],F)}const Z=h(e,["toolConfig"]);if(t!==void 0&&Z!=null&&y(t,["toolConfig"],Z),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=h(e,["cachedContent"]);t!==void 0&&U!=null&&y(t,["cachedContent"],ki(n,U));const N=h(e,["responseModalities"]);N!=null&&y(i,["responseModalities"],N);const w=h(e,["mediaResolution"]);w!=null&&y(i,["mediaResolution"],w);const R=h(e,["speechConfig"]);if(R!=null&&y(i,["speechConfig"],Rp(R)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=h(e,["thinkingConfig"]);k!=null&&y(i,["thinkingConfig"],k);const V=h(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function Zw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>Ow(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function eI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function tI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ga(n,i)),t}function nI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function sI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["request","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let d=is(o);Array.isArray(d)&&(d=d.map(g=>ZE(g))),y(t,["request","contents"],d)}const l=h(e,["metadata"]);l!=null&&y(t,["metadata"],l);const u=h(e,["config"]);return u!=null&&y(t,["request","generationConfig"],Ww(n,u,h(t,["request"],{}))),t}function rI(n){const e={},t=h(n,["response"]);t!=null&&y(e,["response"],Zw(t));const i=h(n,["error"]);return i!=null&&y(e,["error"],i),e}function oI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);if(e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function aI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function lI(n){const e={},t=h(n,["config"]);return t!=null&&oI(t,e),e}function uI(n){const e={},t=h(n,["config"]);return t!=null&&aI(t,e),e}function cI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["operations"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>iu(u))),y(e,["batchJobs"],l)}return e}function dI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["batchPredictionJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Jm(u))),y(e,["batchJobs"],l)}return e}function fI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],Vw(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],Xw(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function hI(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function mI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],sI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],nI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var go;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(go||(go={}));class Au{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pI extends bo{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var i,o;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const d=this.createInlinedEmbedContentRequest(t),g=d.path,m=d.body,T=Cm(this.apiClient,t)._query||{};return this.apiClient.request({path:g,queryParams:T,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(b=>b.json()).then(b=>iu(b))},this.list=async(t={})=>new Au(go.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=Xv(this.apiClient,e),i=t._url,o=Ae("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,g=d.requests,m=[];for(const T of g){const E=Object.assign({},T);if(E.systemInstruction){const b=E.systemInstruction;delete E.systemInstruction;const C=E.request;C.systemInstruction=b,E.request=C}m.push(E)}return d.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}createInlinedEmbedContentRequest(e){const t=Cm(this.apiClient,e),i=t._url,o=Ae("{model}:asyncBatchEmbedContent",i),d=t.batch.inputConfig.requests,g=d.requests,m=[];delete d.config;for(const T of g){const E=Object.assign({},T),b=E.request;for(const C in E)C!=="request"&&(b[C]=E[C],delete E[C]);m.push(E)}return d.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const l=this.getGcsUri(e),u=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${o}`;else if(u)i.dest=`${u}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=Bw(this.apiClient,e);return d=Ae("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=Xv(this.apiClient,e);return d=Ae("{model}:batchGenerateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>iu(T))}}async createEmbeddingsInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Cm(this.apiClient,e);return l=Ae("{model}:asyncBatchEmbedContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>iu(g))}}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=tI(this.apiClient,e);return d=Ae("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=eI(this.apiClient,e);return d=Ae("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>iu(T))}}async cancel(e){var t,i,o,l;let u="",d={};if(this.apiClient.isVertexAI()){const g=Uw(this.apiClient,e);u=Ae("batchPredictionJobs/{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=Lw(this.apiClient,e);u=Ae("batches/{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=uI(e);return d=Ae("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=dI(T),b=new $v;return Object.assign(b,E),b})}else{const m=lI(e);return d=Ae("batches",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=cI(T),b=new $v;return Object.assign(b,E),b})}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=Gw(this.apiClient,e);return d=Ae("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>$w(T))}else{const m=Hw(this.apiClient,e);return d=Ae("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Yw(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Wv(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>UI(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function yI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let T=is(u);Array.isArray(T)&&(T=T.map(E=>Wv(E))),y(e,["contents"],T)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],Wv(_n(d)));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>OI(E))),y(e,["tools"],T)}const m=h(n,["toolConfig"]);if(e!==void 0&&m!=null&&y(e,["toolConfig"],m),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function _I(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let E=is(u);Array.isArray(E)&&(E=E.map(b=>b)),y(e,["contents"],E)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],_n(d));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let E=g;Array.isArray(E)&&(E=E.map(b=>qI(b))),y(e,["tools"],E)}const m=h(n,["toolConfig"]);e!==void 0&&m!=null&&y(e,["toolConfig"],m);const T=h(n,["kmsKeyName"]);return e!==void 0&&T!=null&&y(e,["encryption_spec","kmsKeyName"],T),t}function vI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],jE(n,i));const o=h(e,["config"]);return o!=null&&yI(o,t),t}function TI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],jE(n,i));const o=h(e,["config"]);return o!=null&&_I(o,t),t}function EI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],ki(n,i)),t}function xI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],ki(n,i)),t}function bI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function AI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function SI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function CI(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function wI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],ki(n,i)),t}function II(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],ki(n,i)),t}function NI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function RI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function MI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function DI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function PI(n){const e={},t=h(n,["config"]);return t!=null&&MI(t,e),e}function kI(n){const e={},t=h(n,["config"]);return t!=null&&DI(t,e),e}function VI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function LI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function UI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],gI(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],SI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function OI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],RI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],NI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function qI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>CI(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function FI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function jI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function BI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],ki(n,i));const o=h(e,["config"]);return o!=null&&FI(o,t),t}function zI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],ki(n,i));const o=h(e,["config"]);return o!=null&&jI(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HI extends bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Au(go.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=TI(this.apiClient,e);return d=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=vI(this.apiClient,e);return d=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=II(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=wI(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=xI(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=AI(T),b=new Gv;return Object.assign(b,E),b})}else{const m=EI(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=bI(T),b=new Gv;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=zI(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=BI(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=kI(e);return d=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=LI(T),b=new Yv;return Object.assign(b,E),b})}else{const m=PI(e);return d=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=VI(T),b=new Yv;return Object.assign(b,E),b})}}}function Zv(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xt(n){return this instanceof xt?(this.v=n,this):new xt(n)}function Ca(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(C){return function(P){return Promise.resolve(P).then(C,E)}}function d(C,P){i[C]&&(o[C]=function(O){return new Promise(function(G,ne){l.push([C,O,G,ne])>1||g(C,O)})},P&&(o[C]=P(o[C])))}function g(C,P){try{m(i[C](P))}catch(O){b(l[0][3],O)}}function m(C){C.value instanceof xt?Promise.resolve(C.value.v).then(T,E):b(l[0][2],C)}function T(C){g("next",C)}function E(C){g("throw",C)}function b(C,P){C(P),l.shift(),l.length&&g(l[0][0],l[0][1])}}function cu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Zv=="function"?Zv(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(u){return new Promise(function(d,g){u=n[l](u),o(d,g,u.done,u.value)})}}function o(l,u,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GI(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ex(t)}function ex(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function YI(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function eT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let l=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),l&&!ex(n[i])&&(l=!1),i++;l?e.push(...o):e.pop()}return e}class $I{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new JI(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class JI{constructor(e,t,i,o={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=l,this.sendPromise=Promise.resolve(),YI(l)}async sendMessage(e){var t;await this.sendPromise;const i=_n(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,u,d;const g=await o,m=(u=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,T=g.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let b=[];T!=null&&(b=(d=T.slice(E))!==null&&d!==void 0?d:[]);const C=m?[m]:[];this.recordHistory(i,C,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=_n(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const l=await o;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?eT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,o;return Ca(this,arguments,function*(){var u,d,g,m;const T=[];try{for(var E=!0,b=cu(e),C;C=yield xt(b.next()),u=C.done,!u;E=!0){m=C.value,E=!1;const P=m;if(GI(P)){const O=(o=(i=P.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;O!==void 0&&T.push(O)}yield yield xt(P)}}catch(P){d={error:P}}finally{try{!E&&!u&&(g=b.return)&&(yield xt(g.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,T)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(l=>l.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...eT(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Qd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KI(n){const e={},t=h(n,["file"]);return t!=null&&y(e,["file"],t),e}function QI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function XI(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],$E(t)),e}function WI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function ZI(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],$E(t)),e}function eN(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function tN(n){const e={},t=h(n,["config"]);return t!=null&&eN(t,e),e}function nN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["files"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sN extends bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Au(go.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=tN(e);return l=Ae("files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=nN(g),T=new pw;return Object.assign(T,m),T})}}async createInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=KI(e);return l=Ae("upload/v1beta/files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=QI(g),T=new gw;return Object.assign(T,m),T})}}async get(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=ZI(e);return l=Ae("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async delete(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=XI(e);return l=Ae("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=WI(g),T=new yw;return Object.assign(T,m),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gd(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function iN(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>vN(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function rN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function oN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function aN(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=h(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const C=h(n,["responseMimeType"]);C!=null&&y(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const O=h(n,["responseSchema"]);O!=null&&y(e,["responseSchema"],O);const G=h(n,["routingConfig"]);G!=null&&y(e,["routingConfig"],G);const ne=h(n,["seed"]);ne!=null&&y(e,["seed"],ne);const j=h(n,["speechConfig"]);j!=null&&y(e,["speechConfig"],tx(j));const q=h(n,["stopSequences"]);q!=null&&y(e,["stopSequences"],q);const H=h(n,["temperature"]);H!=null&&y(e,["temperature"],H);const Z=h(n,["thinkingConfig"]);Z!=null&&y(e,["thinkingConfig"],Z);const U=h(n,["topK"]);U!=null&&y(e,["topK"],U);const N=h(n,["topP"]);return N!=null&&y(e,["topP"],N),e}function lN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function uN(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function cN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Mp(E));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],iN(_n(P)));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let U=Ha(O);Array.isArray(U)&&(U=U.map(N=>EN(za(N)))),y(e,["setup","tools"],U)}const G=h(n,["sessionResumption"]);e!==void 0&&G!=null&&y(e,["setup","sessionResumption"],TN(G));const ne=h(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&y(e,["setup","outputAudioTranscription"],j);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&y(e,["setup","realtimeInputConfig"],q);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&y(e,["setup","contextWindowCompression"],H);const Z=h(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function dN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],aN(i));const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],tx(Mp(E)));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],_n(P));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let U=Ha(O);Array.isArray(U)&&(U=U.map(N=>xN(za(N)))),y(e,["setup","tools"],U)}const G=h(n,["sessionResumption"]);e!==void 0&&G!=null&&y(e,["setup","sessionResumption"],G);const ne=h(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&y(e,["setup","outputAudioTranscription"],j);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&y(e,["setup","realtimeInputConfig"],q);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&y(e,["setup","contextWindowCompression"],H);const Z=h(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function fN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],cN(o,t)),t}function hN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],dN(o,t)),t}function mN(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function pN(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["weightedPrompts"],i)}return e}function gN(n){const e={},t=h(n,["media"]);if(t!=null){let m=BE(t);Array.isArray(m)&&(m=m.map(T=>gd(T))),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],gd(HE(i)));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],gd(zE(l)));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function yN(n){const e={},t=h(n,["media"]);if(t!=null){let m=BE(t);Array.isArray(m)&&(m=m.map(T=>T)),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],HE(i));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],zE(l));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function _N(n){const e={},t=h(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const o=h(n,["toolCall"]);o!=null&&y(e,["toolCall"],o);const l=h(n,["toolCallCancellation"]);l!=null&&y(e,["toolCallCancellation"],l);const u=h(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],bN(u));const d=h(n,["goAway"]);d!=null&&y(e,["goAway"],d);const g=h(n,["sessionResumptionUpdate"]);return g!=null&&y(e,["sessionResumptionUpdate"],g),e}function vN(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],gd(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],rN(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function TN(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function tx(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function EN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],uN(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],lN(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function xN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>oN(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function bN(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const o=h(n,["candidatesTokenCount"]);o!=null&&y(e,["responseTokenCount"],o);const l=h(n,["toolUsePromptTokenCount"]);l!=null&&y(e,["toolUsePromptTokenCount"],l);const u=h(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const d=h(n,["totalTokenCount"]);d!=null&&y(e,["totalTokenCount"],d);const g=h(n,["promptTokensDetails"]);if(g!=null){let C=g;Array.isArray(C)&&(C=C.map(P=>P)),y(e,["promptTokensDetails"],C)}const m=h(n,["cacheTokensDetails"]);if(m!=null){let C=m;Array.isArray(C)&&(C=C.map(P=>P)),y(e,["cacheTokensDetails"],C)}const T=h(n,["candidatesTokensDetails"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(P=>P)),y(e,["responseTokensDetails"],C)}const E=h(n,["toolUsePromptTokensDetails"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(P=>P)),y(e,["toolUsePromptTokensDetails"],C)}const b=h(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function SN(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],CN(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=h(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=h(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(C=>C)),y(e,["safetyRatings"],b)}return e}function CN(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function wN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let l=is(o);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["contents"],l)}return t}function IN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["tokensInfo"],o)}return e}function NN(n){const e={},t=h(n,["values"]);t!=null&&y(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&y(e,["statistics"],RN(i)),e}function RN(n){const e={},t=h(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function Xd(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>VR(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function MN(n){const e={},t=h(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function DN(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function PN(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],_n(i));const o=h(n,["tools"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>ox(d))),y(e,["tools"],u)}const l=h(n,["generationConfig"]);return e!==void 0&&l!=null&&y(e,["generationConfig"],xR(l)),t}function kN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let u=is(o);Array.isArray(u)&&(u=u.map(d=>Xd(d))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&DN(l),t}function VN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let u=is(o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&PN(l,t),t}function LN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const o=h(n,["cachedContentTokenCount"]);return o!=null&&y(e,["cachedContentTokenCount"],o),e}function UN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function ON(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function qN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function FN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function jN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function BN(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const C=h(n,["language"]);e!==void 0&&C!=null&&y(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const O=h(n,["outputCompressionQuality"]);e!==void 0&&O!=null&&y(e,["parameters","outputOptions","compressionQuality"],O);const G=h(n,["addWatermark"]);e!==void 0&&G!=null&&y(e,["parameters","addWatermark"],G);const ne=h(n,["labels"]);e!==void 0&&ne!=null&&y(e,["labels"],ne);const j=h(n,["editMode"]);e!==void 0&&j!=null&&y(e,["parameters","editMode"],j);const q=h(n,["baseSteps"]);return e!==void 0&&q!=null&&y(e,["parameters","editConfig","baseSteps"],q),t}function zN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(g=>jR(g))),y(t,["instances[0]","referenceImages"],d)}const u=h(e,["config"]);return u!=null&&BN(u,t),t}function HN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Wd(l))),y(e,["generatedImages"],o)}return e}function GN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function YN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["instances[]","title"],o);const l=h(n,["outputDimensionality"]);e!==void 0&&l!=null&&y(e,["parameters","outputDimensionality"],l);const u=h(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const d=h(n,["autoTruncate"]);return e!==void 0&&d!=null&&y(e,["parameters","autoTruncate"],d),t}function $N(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let d=Ip(n,o);Array.isArray(d)&&(d=d.map(g=>g)),y(t,["requests[]","content"],d)}const l=h(e,["config"]);l!=null&&GN(l,t);const u=h(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],rt(n,u)),t}function JN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let u=Ip(n,o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["instances[]","content"],u)}const l=h(e,["config"]);return l!=null&&YN(l,t),t}function KN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function QN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>NN(u))),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function XN(n){const e={},t=h(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function WN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function ZN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function eR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],Xd(_n(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&y(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&y(i,["seed"],O);const G=h(e,["responseMimeType"]);G!=null&&y(i,["responseMimeType"],G);const ne=h(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Np(ne));const j=h(e,["responseJsonSchema"]);if(j!=null&&y(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=h(e,["safetySettings"]);if(t!==void 0&&q!=null){let F=q;Array.isArray(F)&&(F=F.map(D=>BR(D))),y(t,["safetySettings"],F)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let F=Ha(H);Array.isArray(F)&&(F=F.map(D=>JR(za(D)))),y(t,["tools"],F)}const Z=h(e,["toolConfig"]);if(t!==void 0&&Z!=null&&y(t,["toolConfig"],Z),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=h(e,["cachedContent"]);t!==void 0&&U!=null&&y(t,["cachedContent"],ki(n,U));const N=h(e,["responseModalities"]);N!=null&&y(i,["responseModalities"],N);const w=h(e,["mediaResolution"]);w!=null&&y(i,["mediaResolution"],w);const R=h(e,["speechConfig"]);if(R!=null&&y(i,["speechConfig"],Rp(R)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=h(e,["thinkingConfig"]);k!=null&&y(i,["thinkingConfig"],k);const V=h(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function tR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],_n(o));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const C=h(e,["presencePenalty"]);C!=null&&y(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&y(i,["seed"],O);const G=h(e,["responseMimeType"]);G!=null&&y(i,["responseMimeType"],G);const ne=h(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Np(ne));const j=h(e,["responseJsonSchema"]);j!=null&&y(i,["responseJsonSchema"],j);const q=h(e,["routingConfig"]);q!=null&&y(i,["routingConfig"],q);const H=h(e,["modelSelectionConfig"]);H!=null&&y(i,["modelConfig"],H);const Z=h(e,["safetySettings"]);if(t!==void 0&&Z!=null){let $=Z;Array.isArray($)&&($=$.map(de=>de)),y(t,["safetySettings"],$)}const U=h(e,["tools"]);if(t!==void 0&&U!=null){let $=Ha(U);Array.isArray($)&&($=$.map(de=>ox(za(de)))),y(t,["tools"],$)}const N=h(e,["toolConfig"]);t!==void 0&&N!=null&&y(t,["toolConfig"],N);const w=h(e,["labels"]);t!==void 0&&w!=null&&y(t,["labels"],w);const R=h(e,["cachedContent"]);t!==void 0&&R!=null&&y(t,["cachedContent"],ki(n,R));const k=h(e,["responseModalities"]);k!=null&&y(i,["responseModalities"],k);const V=h(e,["mediaResolution"]);V!=null&&y(i,["mediaResolution"],V);const F=h(e,["speechConfig"]);F!=null&&y(i,["speechConfig"],rx(Rp(F)));const D=h(e,["audioTimestamp"]);D!=null&&y(i,["audioTimestamp"],D);const ke=h(e,["thinkingConfig"]);ke!=null&&y(i,["thinkingConfig"],ke);const fe=h(e,["imageConfig"]);return fe!=null&&y(i,["imageConfig"],fe),i}function tT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let u=is(o);Array.isArray(u)&&(u=u.map(d=>Xd(d))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],eR(n,l,t)),t}function nT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["contents"]);if(o!=null){let u=is(o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],tR(n,l,t)),t}function sT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>SN(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function iT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["candidates"],m)}const o=h(n,["createTime"]);o!=null&&y(e,["createTime"],o);const l=h(n,["modelVersion"]);l!=null&&y(e,["modelVersion"],l);const u=h(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const d=h(n,["responseId"]);d!=null&&y(e,["responseId"],d);const g=h(n,["usageMetadata"]);return g!=null&&y(e,["usageMetadata"],g),e}function nR(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const l=h(n,["guidanceScale"]);if(e!==void 0&&l!=null&&y(e,["parameters","guidanceScale"],l),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const g=h(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&y(e,["parameters","includeSafetyAttributes"],g);const m=h(n,["includeRaiReason"]);e!==void 0&&m!=null&&y(e,["parameters","includeRaiReason"],m);const T=h(n,["language"]);e!==void 0&&T!=null&&y(e,["parameters","language"],T);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","mimeType"],E);const b=h(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=h(n,["imageSize"]);if(e!==void 0&&C!=null&&y(e,["parameters","sampleImageSize"],C),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function sR(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const C=h(n,["language"]);e!==void 0&&C!=null&&y(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const O=h(n,["outputCompressionQuality"]);e!==void 0&&O!=null&&y(e,["parameters","outputOptions","compressionQuality"],O);const G=h(n,["addWatermark"]);e!==void 0&&G!=null&&y(e,["parameters","addWatermark"],G);const ne=h(n,["labels"]);e!==void 0&&ne!=null&&y(e,["labels"],ne);const j=h(n,["imageSize"]);e!==void 0&&j!=null&&y(e,["parameters","sampleImageSize"],j);const q=h(n,["enhancePrompt"]);return e!==void 0&&q!=null&&y(e,["parameters","enhancePrompt"],q),t}function iR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&nR(l,t),t}function rR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&sR(l,t),t}function oR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>_R(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],sx(o)),e}function aR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>Wd(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],ix(o)),e}function lR(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=h(n,["durationSeconds"]);if(e!==void 0&&o!=null&&y(e,["parameters","durationSeconds"],o),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const u=h(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const d=h(n,["personGeneration"]);if(e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=h(n,["negativePrompt"]);e!==void 0&&g!=null&&y(e,["parameters","negativePrompt"],g);const m=h(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&y(e,["parameters","enhancePrompt"],m),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=h(n,["lastFrame"]);e!==void 0&&T!=null&&y(e,["instances[0]","lastFrame"],Zd(T));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let b=E;Array.isArray(b)&&(b=b.map(C=>a1(C))),y(e,["instances[0]","referenceImages"],b)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function uR(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const l=h(n,["fps"]);e!==void 0&&l!=null&&y(e,["parameters","fps"],l);const u=h(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const d=h(n,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const g=h(n,["aspectRatio"]);e!==void 0&&g!=null&&y(e,["parameters","aspectRatio"],g);const m=h(n,["resolution"]);e!==void 0&&m!=null&&y(e,["parameters","resolution"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&y(e,["parameters","pubsubTopic"],E);const b=h(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const C=h(n,["enhancePrompt"]);e!==void 0&&C!=null&&y(e,["parameters","enhancePrompt"],C);const P=h(n,["generateAudio"]);e!==void 0&&P!=null&&y(e,["parameters","generateAudio"],P);const O=h(n,["lastFrame"]);e!==void 0&&O!=null&&y(e,["instances[0]","lastFrame"],xs(O));const G=h(n,["referenceImages"]);if(e!==void 0&&G!=null){let q=G;Array.isArray(q)&&(q=q.map(H=>l1(H))),y(e,["instances[0]","referenceImages"],q)}const ne=h(n,["mask"]);e!==void 0&&ne!=null&&y(e,["instances[0]","mask"],o1(ne));const j=h(n,["compressionQuality"]);return e!==void 0&&j!=null&&y(e,["parameters","compressionQuality"],j),t}function cR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],mR(u)),e}function dR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],pR(u)),e}function fR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],Zd(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],ax(u));const d=h(e,["source"]);d!=null&&gR(d,t);const g=h(e,["config"]);return g!=null&&lR(g,t),t}function hR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],xs(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],lx(u));const d=h(e,["source"]);d!=null&&yR(d,t);const g=h(e,["config"]);return g!=null&&uR(g,t),t}function mR(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>TR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function pR(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>ER(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function gR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],Zd(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],ax(l)),t}function yR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],xs(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],lx(l)),t}function _R(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],wR(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);return o!=null&&y(e,["safetyAttributes"],sx(o)),e}function Wd(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],nx(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);o!=null&&y(e,["safetyAttributes"],ix(o));const l=h(n,["prompt"]);return l!=null&&y(e,["enhancedPrompt"],l),e}function vR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["mask"],nx(t));const i=h(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["labels"],o)}return e}function TR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],i1(t)),e}function ER(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],r1(t)),e}function xR(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=h(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const C=h(n,["responseMimeType"]);C!=null&&y(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const O=h(n,["responseSchema"]);O!=null&&y(e,["responseSchema"],O);const G=h(n,["routingConfig"]);G!=null&&y(e,["routingConfig"],G);const ne=h(n,["seed"]);ne!=null&&y(e,["seed"],ne);const j=h(n,["speechConfig"]);j!=null&&y(e,["speechConfig"],rx(j));const q=h(n,["stopSequences"]);q!=null&&y(e,["stopSequences"],q);const H=h(n,["temperature"]);H!=null&&y(e,["temperature"],H);const Z=h(n,["thinkingConfig"]);Z!=null&&y(e,["thinkingConfig"],Z);const U=h(n,["topK"]);U!=null&&y(e,["topK"],U);const N=h(n,["topP"]);return N!=null&&y(e,["topP"],N),e}function bR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function AR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function SR(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function CR(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function wR(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Pr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function nx(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],Pr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function Zd(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Pr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function xs(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Pr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function IR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],JE(n,d)),i}function NR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],JE(n,d)),i}function RR(n,e){const t={},i=h(e,["config"]);return i!=null&&IR(n,i,t),t}function MR(n,e){const t={},i=h(e,["config"]);return i!=null&&NR(n,i,t),t}function DR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=KE(o);Array.isArray(l)&&(l=l.map(u=>Km(u))),y(e,["models"],l)}return e}function PR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=KE(o);Array.isArray(l)&&(l=l.map(u=>Qm(u))),y(e,["models"],l)}return e}function kR(n){const e={},t=h(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const o=h(n,["maskDilation"]);return o!=null&&y(e,["dilation"],o),e}function Km(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["version"]);l!=null&&y(e,["version"],l);const u=h(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],KR(u));const d=h(n,["inputTokenLimit"]);d!=null&&y(e,["inputTokenLimit"],d);const g=h(n,["outputTokenLimit"]);g!=null&&y(e,["outputTokenLimit"],g);const m=h(n,["supportedGenerationMethods"]);return m!=null&&y(e,["supportedActions"],m),e}function Qm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["versionId"]);l!=null&&y(e,["version"],l);const u=h(n,["deployedModels"]);if(u!=null){let E=u;Array.isArray(E)&&(E=E.map(b=>XN(b))),y(e,["endpoints"],E)}const d=h(n,["labels"]);d!=null&&y(e,["labels"],d);const g=h(n,["_self"]);g!=null&&y(e,["tunedModelInfo"],QR(g));const m=h(n,["defaultCheckpointId"]);m!=null&&y(e,["defaultCheckpointId"],m);const T=h(n,["checkpoints"]);if(T!=null){let E=T;Array.isArray(E)&&(E=E.map(b=>b)),y(e,["checkpoints"],E)}return e}function VR(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],AN(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],WN(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function LR(n){const e={},t=h(n,["productImage"]);return t!=null&&y(e,["image"],xs(t)),e}function UR(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["baseSteps"]);e!==void 0&&o!=null&&y(e,["parameters","editConfig","baseSteps"],o);const l=h(n,["outputGcsUri"]);e!==void 0&&l!=null&&y(e,["parameters","storageUri"],l);const u=h(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&y(e,["parameters","personGeneration"],g);const m=h(n,["addWatermark"]);e!==void 0&&m!=null&&y(e,["parameters","addWatermark"],m);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&y(e,["parameters","outputOptions","mimeType"],T);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const b=h(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const C=h(n,["labels"]);return e!==void 0&&C!=null&&y(e,["labels"],C),t}function OR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["source"]);o!=null&&FR(o,t);const l=h(e,["config"]);return l!=null&&UR(l,t),t}function qR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>Wd(o))),y(e,["generatedImages"],i)}return e}function FR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["personImage"]);e!==void 0&&o!=null&&y(e,["instances[0]","personImage","image"],xs(o));const l=h(n,["productImages"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(d=>LR(d))),y(e,["instances[0]","productImages"],u)}return t}function jR(n){const e={},t=h(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],xs(t));const i=h(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const o=h(n,["referenceType"]);o!=null&&y(e,["referenceType"],o);const l=h(n,["maskImageConfig"]);l!=null&&y(e,["maskImageConfig"],kR(l));const u=h(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],MN(u));const d=h(n,["styleImageConfig"]);d!=null&&y(e,["styleImageConfig"],d);const g=h(n,["subjectImageConfig"]);return g!=null&&y(e,["subjectImageConfig"],g),e}function sx(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function ix(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function BR(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function zR(n){const e={},t=h(n,["image"]);return t!=null&&y(e,["image"],xs(t)),e}function HR(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const o=h(n,["maxPredictions"]);e!==void 0&&o!=null&&y(e,["parameters","maxPredictions"],o);const l=h(n,["confidenceThreshold"]);e!==void 0&&l!=null&&y(e,["parameters","confidenceThreshold"],l);const u=h(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const d=h(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&y(e,["parameters","binaryColorThreshold"],d);const g=h(n,["labels"]);return e!==void 0&&g!=null&&y(e,["labels"],g),t}function GR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["source"]);o!=null&&$R(o,t);const l=h(e,["config"]);return l!=null&&HR(l,t),t}function YR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>vR(o))),y(e,["generatedMasks"],i)}return e}function $R(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],xs(o));const l=h(n,["scribbleImage"]);return e!==void 0&&l!=null&&y(e,["instances[0]","scribble"],zR(l)),t}function rx(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function JR(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],CR(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],SR(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function ox(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>ZN(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function KR(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function QR(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function XR(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function WR(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function ZR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","name"],rt(n,i));const o=h(e,["config"]);return o!=null&&XR(o,t),t}function e1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["config"]);return o!=null&&WR(o,t),t}function t1(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["includeRaiReason"]);e!==void 0&&o!=null&&y(e,["parameters","includeRaiReason"],o);const l=h(n,["outputMimeType"]);e!==void 0&&l!=null&&y(e,["parameters","outputOptions","mimeType"],l);const u=h(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const d=h(n,["enhanceInputImage"]);e!==void 0&&d!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],d);const g=h(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const m=h(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&y(e,["parameters","sampleCount"],T);const E=h(n,["mode"]);return e!==void 0&&E!=null&&y(e,["parameters","mode"],E),t}function n1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=h(e,["image"]);o!=null&&y(t,["instances[0]","image"],xs(o));const l=h(e,["upscaleFactor"]);l!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],l);const u=h(e,["config"]);return u!=null&&t1(u,t),t}function s1(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Wd(l))),y(e,["generatedImages"],o)}return e}function i1(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Pr(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function r1(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Pr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function o1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["_self"],xs(t));const i=h(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function a1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],Zd(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function l1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],xs(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function ax(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["video","uri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["video","encodedVideo"],Pr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["encoding"],o),e}function lx(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Pr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const u1="Content-Type",c1="X-Server-Timeout",d1="User-Agent",Xm="x-goog-api-client",f1="1.24.0",h1=`google-genai-sdk/${f1}`,m1="v1beta1",p1="v1beta",rT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class g1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:m1,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:p1,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,d]of Object.entries(e.queryParams))o.searchParams.append(u,String(d));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(o,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,l]of Object.entries(t))typeof l=="object"?i[o]=Object.assign(Object.assign({},i[o]),l):l!==void 0&&(i[o]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(o,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&y1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await oT(o),new Ym(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await oT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return Ca(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:d,value:g}=yield xt(o.read());if(d){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(g,{stream:!0});try{const E=JSON.parse(m);if("error"in E){const b=JSON.parse(JSON.stringify(E.error)),C=b.status,P=b.code,O=`got status: ${C}. ${JSON.stringify(E)}`;if(P>=400&&P<600)throw new Qd({message:O,status:P})}}catch(E){if(E.name==="ApiError")throw E}u+=m;let T=u.match(rT);for(;T;){const E=T[1];try{const b=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield xt(new Ym(b)),u=u.slice(T[0].length),T=u.match(rT)}catch(b){throw new Error(`exception parsing stream chunk ${E}. ${b}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=h1+" "+this.clientOptions.userAgentExtra;return e[d1]=t,e[Xm]=t,e[u1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))t.append(i,o);e.timeout&&e.timeout>0&&t.append(c1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);o.sizeBytes=String(u.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=d;const g=await this.fetchUploadUrl(o,t);return l.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let o={};t!=null&&t.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},u=await this.request({path:Ae("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function oT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new Qd({message:o,status:t}):new Error(o)}}function y1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,u){const d=Object.assign({},l);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const m=u[g],T=d[g];m&&typeof m=="object"&&!Array.isArray(m)&&T&&typeof T=="object"&&!Array.isArray(T)?d[g]=i(T,m):(T&&m&&typeof T!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof T}, New type: ${typeof m}. Overwriting.`),d[g]=m)}return d}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _1="mcp_used/unknown";let v1=!1;function ux(n){for(const e of n)if(T1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return v1}function cx(n){var e;const t=(e=n[Xm])!==null&&e!==void 0?e:"";n[Xm]=(t+` ${_1}`).trimStart()}function T1(n){return n!==null&&typeof n=="object"&&n instanceof Dp}function E1(n,e=100){return Ca(this,arguments,function*(){let i,o=0;for(;o<e;){const l=yield xt(n.listTools({cursor:i}));for(const u of l.tools)yield yield xt(u),o++;if(!l.nextCursor)break;i=l.nextCursor}})}class Dp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Dp(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const l={},u=[];for(const T of this.mcpClients)try{for(var d=!0,g=(t=void 0,cu(E1(T))),m;m=await g.next(),e=m.done,!e;d=!0){o=m.value,d=!1;const E=o;u.push(E);const b=E.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=T}}catch(E){t={error:E}}finally{try{!d&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),ww(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const u=await o.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function x1(n,e,t){const i=new vw;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class b1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),u=C1(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),g=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${d}`;let m=()=>{};const T=new Promise(q=>{m=q}),E=e.callbacks,b=function(){m({})},C=this.apiClient,P={onopen:b,onmessage:q=>{x1(C,E.onmessage,q)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(q){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(q){}},O=this.webSocketFactory.create(g,S1(u),P);O.connect(),await T;const j={setup:{model:rt(this.apiClient,e.model)}};return O.send(JSON.stringify(j)),new A1(O,this.apiClient)}}class A1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=pN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=mN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(xa.PLAY)}pause(){this.sendPlaybackControl(xa.PAUSE)}stop(){this.sendPlaybackControl(xa.STOP)}resetContext(){this.sendPlaybackControl(xa.RESET_CONTEXT)}close(){this.conn.close()}}function S1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function C1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const w1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function I1(n,e,t){const i=new _w;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const l=JSON.parse(o);if(n.isVertexAI()){const u=_N(l);Object.assign(i,u)}else Object.assign(i,l);e(i)}class N1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new b1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,l,u,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let T;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&ux(e.config.tools)&&cx(E);const b=P1(E);if(this.apiClient.isVertexAI())T=`${g}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const R=this.apiClient.getApiKey();let k="BidiGenerateContent",V="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",V="access_token"),T=`${g}/ws/google.ai.generativelanguage.${m}.GenerativeService.${k}?${V}=${R}`}let C=()=>{};const P=new Promise(R=>{C=R}),O=e.callbacks,G=function(){var R;(R=O==null?void 0:O.onopen)===null||R===void 0||R.call(O),C({})},ne=this.apiClient,j={onopen:G,onmessage:R=>{I1(ne,O.onmessage,R)},onerror:(t=O==null?void 0:O.onerror)!==null&&t!==void 0?t:function(R){},onclose:(i=O==null?void 0:O.onclose)!==null&&i!==void 0?i:function(R){}},q=this.webSocketFactory.create(T,D1(b),j);q.connect(),await P;let H=rt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&H.startsWith("publishers/")){const R=this.apiClient.getProject(),k=this.apiClient.getLocation();H=`projects/${R}/locations/${k}/`+H}let Z={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Cd.AUDIO]}:e.config.responseModalities=[Cd.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=(d=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[],N=[];for(const R of U)if(this.isCallableTool(R)){const k=R;N.push(await k.tool())}else N.push(R);N.length>0&&(e.config.tools=N);const w={model:H,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Z=hN(this.apiClient,w):Z=fN(this.apiClient,w),delete Z.config,q.send(JSON.stringify(Z)),new M1(q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const R1={turnComplete:!0};class M1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=is(t.turns),e.isVertexAI()||(i=i.map(o=>Xd(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(w1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},R1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:yN(e)}:t={realtimeInput:gN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function D1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function P1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aT=10;function lT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(wa(u)){o=!0;break}if(!o)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function wa(n){return"callTool"in n&&typeof n.callTool=="function"}function k1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>wa(o)))!==null&&i!==void 0?i:!1}function V1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!wa(o)))!==null&&i!==void 0?i:!1}function uT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class L1 extends bo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,l,u,d;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!k1(t)||lT(t.config))return await this.generateContentInternal(g);if(V1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,T;const E=is(g.contents),b=(l=(o=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&l!==void 0?l:aT;let C=0;for(;C<b&&(m=await this.generateContentInternal(g),!(!m.functionCalls||m.functionCalls.length===0));){const P=m.candidates[0].content,O=[];for(const G of(d=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[])if(wa(G)){const j=await G.callTool(m.functionCalls);O.push(...j)}C++,T={role:"user",parts:O},g.contents=is(g.contents),g.contents.push(P),g.contents.push(T),uT(g.config)&&(E.push(P),E.push(T))}return uT(g.config)&&(m.automaticFunctionCallingHistory=E),m},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),lT(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let l;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((o=g==null?void 0:g.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:u.push(g);let d;return l?d={generatedImages:u,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Au(go.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const u=await Promise.all(l.map(async g=>wa(g)?await g.tool():g)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(d.config.tools=u,e.config&&e.config.tools&&ux(e.config.tools)){const g=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let m=Object.assign({},g);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),cx(m),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return d}async initAfcToolsMap(e){var t,i,o;const l=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(wa(u)){const d=u,g=await d.tool();for(const m of(o=g.functionDeclarations)!==null&&o!==void 0?o:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,d)}}return l}async processAfcStream(e){var t,i,o;const l=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:aT;let u=!1,d=0;const g=await this.initAfcToolsMap(e);return(function(m,T,E){var b,C;return Ca(this,arguments,function*(){for(var P,O,G,ne;d<l;){u&&(d++,u=!1);const Z=yield xt(m.processParamsMaybeAddMcpUsage(E)),U=yield xt(m.generateContentStreamInternal(Z)),N=[],w=[];try{for(var j=!0,q=(O=void 0,cu(U)),H;H=yield xt(q.next()),P=H.done,!P;j=!0){ne=H.value,j=!1;const R=ne;if(yield yield xt(R),R.candidates&&(!((b=R.candidates[0])===null||b===void 0)&&b.content)){w.push(R.candidates[0].content);for(const k of(C=R.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(d<l&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(k.functionCall.name)){const V=yield xt(T.get(k.functionCall.name).callTool([k.functionCall]));N.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(R){O={error:R}}finally{try{!j&&!P&&(G=q.return)&&(yield xt(G.call(q)))}finally{if(O)throw O.error}}if(N.length>0){u=!0;const R=new su;R.candidates=[{content:{role:"user",parts:N}}],yield yield xt(R);const k=[];k.push(...w),k.push({role:"user",parts:N});const V=is(E.contents).concat(k);E.contents=V}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=nT(this.apiClient,e);return d=Ae("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=iT(T),b=new su;return Object.assign(b,E),b})}else{const m=tT(this.apiClient,e);return d=Ae("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=sT(T),b=new su;return Object.assign(b,E),b})}}async generateContentStreamInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=nT(this.apiClient,e);return d=Ae("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(E){return Ca(this,arguments,function*(){var b,C,P,O;try{for(var G=!0,ne=cu(E),j;j=yield xt(ne.next()),b=j.done,!b;G=!0){O=j.value,G=!1;const q=O,H=iT(yield xt(q.json()));H.sdkHttpResponse={headers:q.headers};const Z=new su;Object.assign(Z,H),yield yield xt(Z)}}catch(q){C={error:q}}finally{try{!G&&!b&&(P=ne.return)&&(yield xt(P.call(ne)))}finally{if(C)throw C.error}}})})}else{const m=tT(this.apiClient,e);return d=Ae("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),u.then(function(E){return Ca(this,arguments,function*(){var b,C,P,O;try{for(var G=!0,ne=cu(E),j;j=yield xt(ne.next()),b=j.done,!b;G=!0){O=j.value,G=!1;const q=O,H=sT(yield xt(q.json()));H.sdkHttpResponse={headers:q.headers};const Z=new su;Object.assign(Z,H),yield yield xt(Z)}}catch(q){C={error:q}}finally{try{!G&&!b&&(P=ne.return)&&(yield xt(P.call(ne)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=JN(this.apiClient,e);return d=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=QN(T),b=new qv;return Object.assign(b,E),b})}else{const m=$N(this.apiClient,e);return d=Ae("{model}:batchEmbedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=KN(T),b=new qv;return Object.assign(b,E),b})}}async generateImagesInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=rR(this.apiClient,e);return d=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=aR(T),b=new Fv;return Object.assign(b,E),b})}else{const m=iR(this.apiClient,e);return d=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=oR(T),b=new Fv;return Object.assign(b,E),b})}}async editImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=zN(this.apiClient,e);return l=Ae("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=HN(g),T=new cw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=n1(this.apiClient,e);return l=Ae("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=s1(g),T=new dw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=OR(this.apiClient,e);return l=Ae("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=qR(g),T=new fw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=GR(this.apiClient,e);return l=Ae("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=YR(g),T=new hw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=AR(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=bR(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=MR(this.apiClient,e);return d=Ae("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=PR(T),b=new jv;return Object.assign(b,E),b})}else{const m=RR(this.apiClient,e);return d=Ae("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=DR(T),b=new jv;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=e1(this.apiClient,e);return d=Ae("{model}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=ZR(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=qN(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=jN(T),b=new Bv;return Object.assign(b,E),b})}else{const m=ON(this.apiClient,e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=FN(T),b=new Bv;return Object.assign(b,E),b})}}async countTokens(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=VN(this.apiClient,e);return d=Ae("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=UN(T),b=new zv;return Object.assign(b,E),b})}else{const m=kN(this.apiClient,e);return d=Ae("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=LN(T),b=new zv;return Object.assign(b,E),b})}}async computeTokens(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=wN(this.apiClient,e);return l=Ae("{model}:computeTokens",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=IN(g),T=new mw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=hR(this.apiClient,e);return d=Ae("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>{const E=dR(T),b=new wd;return Object.assign(b,E),b})}else{const m=fR(this.apiClient,e);return d=Ae("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>{const E=cR(T),b=new wd;return Object.assign(b,E),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U1 extends bo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=aw(e);return d=Ae("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u}else{const m=ow(e);return d=Ae("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=ZC(e);return l=Ae("{resourceName}:fetchPredictOperation",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function q1(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>$1(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function F1(n,e,t){const i={},o=h(e,["expireTime"]);t!==void 0&&o!=null&&y(t,["expireTime"],o);const l=h(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&y(t,["newSessionExpireTime"],l);const u=h(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const d=h(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&y(t,["bidiGenerateContentSetup"],Y1(n,d));const g=h(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&y(t,["fieldMask"],g),i}function j1(n,e){const t={},i=h(e,["config"]);return i!=null&&y(t,["config"],F1(n,i,t)),t}function B1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function z1(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function H1(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function G1(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Mp(E));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],q1(_n(P)));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let U=Ha(O);Array.isArray(U)&&(U=U.map(N=>K1(za(N)))),y(e,["setup","tools"],U)}const G=h(n,["sessionResumption"]);e!==void 0&&G!=null&&y(e,["setup","sessionResumption"],J1(G));const ne=h(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&y(e,["setup","outputAudioTranscription"],j);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&y(e,["setup","realtimeInputConfig"],q);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&y(e,["setup","contextWindowCompression"],H);const Z=h(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function Y1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],G1(o,t)),t}function $1(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],O1(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],B1(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function J1(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function K1(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],H1(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],z1(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Q1(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(l=>`${t}.${l}`);e.push(...o)}else e.push(t)}return e.join(",")}function X1(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const l=Q1(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];o.length>0&&(d=o.map(m=>u.includes(m)?`generationConfig.${m}`:m));const g=[];l&&g.push(l),d.length>0&&g.push(...d),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class W1 extends bo{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=j1(this.apiClient,e);l=Ae("auth_tokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const g=X1(d,e.config);return o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),o.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z1(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function eM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function tM(n,e){const t={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=h(n,["epochCount"]);e!==void 0&&o!=null&&y(e,["tuningTask","hyperparameters","epochCount"],o);const l=h(n,["learningRateMultiplier"]);if(l!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=h(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const d=h(n,["learningRate"]);if(e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","learningRate"],d),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function nM(n,e){const t={},i=h(n,["validationDataset"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec"],yM(i,t));const o=h(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&y(e,["tunedModelDisplayName"],o);const l=h(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);const u=h(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=h(n,["learningRateMultiplier"]);e!==void 0&&d!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const g=h(n,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const m=h(n,["adapterSize"]);if(e!==void 0&&m!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m),h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=h(n,["labels"]);return e!==void 0&&T!=null&&y(e,["labels"],T),t}function sM(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["tuningTask","trainingData"],mM(o));const l=h(n,["config"]);return l!=null&&tM(l,e),e}function iM(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],pM(o,e));const l=h(n,["config"]);return l!=null&&nM(l,e),e}function rM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function oM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function aM(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function lM(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function uM(n){const e={},t=h(n,["config"]);return t!=null&&aM(t,e),e}function cM(n){const e={},t=h(n,["config"]);return t!=null&&lM(t,e),e}function dM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>dx(u))),y(e,["tuningJobs"],l)}return e}function fM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Wm(u))),y(e,["tuningJobs"],l)}return e}function hM(n){const e={},t=h(n,["name"]);t!=null&&y(e,["model"],t);const i=h(n,["name"]);return i!=null&&y(e,["endpoint"],i),e}function mM(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["examples","examples"],i)}return e}function pM(n,e){const t={},i=h(n,["gcsUri"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);if(e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function dx(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],YE(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const d=h(n,["tuningTask","completeTime"]);d!=null&&y(e,["endTime"],d);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["description"]);m!=null&&y(e,["description"],m);const T=h(n,["baseModel"]);T!=null&&y(e,["baseModel"],T);const E=h(n,["_self"]);E!=null&&y(e,["tunedModel"],hM(E));const b=h(n,["customBaseModel"]);b!=null&&y(e,["customBaseModel"],b);const C=h(n,["experiment"]);C!=null&&y(e,["experiment"],C);const P=h(n,["labels"]);P!=null&&y(e,["labels"],P);const O=h(n,["outputUri"]);O!=null&&y(e,["outputUri"],O);const G=h(n,["pipelineJob"]);G!=null&&y(e,["pipelineJob"],G);const ne=h(n,["serviceAccount"]);ne!=null&&y(e,["serviceAccount"],ne);const j=h(n,["tunedModelDisplayName"]);j!=null&&y(e,["tunedModelDisplayName"],j);const q=h(n,["veoTuningSpec"]);return q!=null&&y(e,["veoTuningSpec"],q),e}function Wm(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],YE(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["startTime"]);u!=null&&y(e,["startTime"],u);const d=h(n,["endTime"]);d!=null&&y(e,["endTime"],d);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["error"]);m!=null&&y(e,["error"],m);const T=h(n,["description"]);T!=null&&y(e,["description"],T);const E=h(n,["baseModel"]);E!=null&&y(e,["baseModel"],E);const b=h(n,["tunedModel"]);b!=null&&y(e,["tunedModel"],b);const C=h(n,["preTunedModel"]);C!=null&&y(e,["preTunedModel"],C);const P=h(n,["supervisedTuningSpec"]);P!=null&&y(e,["supervisedTuningSpec"],P);const O=h(n,["tuningDataStats"]);O!=null&&y(e,["tuningDataStats"],O);const G=h(n,["encryptionSpec"]);G!=null&&y(e,["encryptionSpec"],G);const ne=h(n,["partnerModelTuningSpec"]);ne!=null&&y(e,["partnerModelTuningSpec"],ne);const j=h(n,["customBaseModel"]);j!=null&&y(e,["customBaseModel"],j);const q=h(n,["experiment"]);q!=null&&y(e,["experiment"],q);const H=h(n,["labels"]);H!=null&&y(e,["labels"],H);const Z=h(n,["outputUri"]);Z!=null&&y(e,["outputUri"],Z);const U=h(n,["pipelineJob"]);U!=null&&y(e,["pipelineJob"],U);const N=h(n,["serviceAccount"]);N!=null&&y(e,["serviceAccount"],N);const w=h(n,["tunedModelDisplayName"]);w!=null&&y(e,["tunedModelDisplayName"],w);const R=h(n,["veoTuningSpec"]);return R!=null&&y(e,["veoTuningSpec"],R),e}function gM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["metadata"]);o!=null&&y(e,["metadata"],o);const l=h(n,["done"]);l!=null&&y(e,["done"],l);const u=h(n,["error"]);return u!=null&&y(e,["error"],u),e}function yM(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);return e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _M extends bo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Au(go.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:o});return l.baseModel=void 0,await this.tuneInternal(l)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),l=await this.tuneMldevInternal(o);let u="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?u=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(u=l.name.split("/operations/")[0]),{name:u,state:Gm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=oM(e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Wm(T))}else{const m=rM(e);return d=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>dx(T))}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=cM(e);return d=Ae("tuningJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=fM(T),b=new Hv;return Object.assign(b,E),b})}else{const m=uM(e);return d=Ae("tunedModels",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=dM(T),b=new Hv;return Object.assign(b,E),b})}}async cancel(e){var t,i,o,l;let u="",d={};if(this.apiClient.isVertexAI()){const g=eM(e);u=Ae("{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=Z1(e);u=Ae("{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=iM(e);return l=Ae("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>Wm(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=sM(e);return l=Ae("tunedModels",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>gM(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vM{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const TM=1024*1024*8,EM=3,xM=1e3,bM=2,wm="x-goog-upload-status";async function AM(n,e,t){var i,o,l;let u=0,d=0,g=new Ym(new Response),m="upload";for(u=n.size;d<u;){const E=Math.min(TM,u-d),b=n.slice(d,d+E);d+E>=u&&(m+=", finalize");let C=0,P=xM;for(;C<EM&&(g=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(d),"Content-Length":String(E)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[wm]));)C++,await CM(P),P=P*bM;if(d+=E,((o=g==null?void 0:g.headers)===null||o===void 0?void 0:o[wm])!=="active")break;if(u<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(g==null?void 0:g.json());if(((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[wm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function SM(n){return{size:n.size,type:n.type}}function CM(n){return new Promise(e=>setTimeout(e,n))}class wM{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await AM(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM{create(e,t,i){return new NM(e,t,i)}}class NM{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cT="x-goog-api-key";class RM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(cT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(cT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MM="gl-node/";class DM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=WC(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new RM(this.apiKey);this.apiClient=new g1({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:MM+"web",uploader:new wM,downloader:new vM}),this.models=new L1(this.apiClient),this.live=new N1(this.apiClient,o,new IM),this.batches=new pI(this.apiClient),this.chats=new $I(this.models,this.apiClient),this.caches=new HI(this.apiClient),this.files=new sN(this.apiClient),this.operations=new U1(this.apiClient),this.authTokens=new W1(this.apiClient),this.tunings=new _M(this.apiClient)}}const fx={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},Ot={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:Ot.app.environment,firebaseApiKey:Ot.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:Ot.firebase.authDomain||"❌ مفقود",firebaseProjectId:Ot.firebase.projectId||"❌ مفقود",firebaseStorageBucket:Ot.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:Ot.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:Ot.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(fx).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(fx).filter(n=>n.startsWith("VITE_")));const Ia=()=>{const n=[];return Ot.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),Ot.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),Ot.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),Ot.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),Ot.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),Ot.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!Ot.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=Ia();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Nd;const PM="gemini-2.5-flash",hx=()=>{if(Nd)return;const n=Ia();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Nd=new DM({apiKey:Ot.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},Ya={FINANCIAL_ANALYST:`You are an expert financial analyst assistant, "المحلل الذكي". You have full access to the user's financial data for a specific period. Your purpose is to provide detailed, insightful analysis and answer complex questions in Arabic based ONLY on the data provided for that period.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- Analyze the user's provided financial state (transactions, card details, bank balance, investments, installments) for the specified period to answer their query.
- Be thorough. Connect different parts of their financial data to give holistic answers.
- DO NOT just state data, INTERPRET it. Provide insights, identify trends, and offer observations.
- Be friendly, professional, and act as a true financial advisor.`,INVESTMENT_COACH:`You are an educational investment coach named "المستشار الذكي". Your primary role is to educate the user about investment concepts and strategies, particularly within the context of the Saudi stock market (Tadawul).
- You MUST NOT give direct financial advice. Do not recommend buying or selling specific stocks (e.g., "Buy Aramco").
- When asked for a recommendation, you MUST politely decline and instead explain HOW the user can research and make their own informed decisions.
- Your tone should be encouraging, educational, and responsible.
- Keep your answers clear, concise, and in Arabic.`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`},$a=async(n,e,t=!1)=>{if(!Nd)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Nd.models.generateContent({model:PM,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(i){console.error("Gemini API Error:",i);let o="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw i instanceof Error&&"message"in i&&i.message.includes("403")&&(o="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(o)}},mx=(n,e)=>$a(Ya.FINANCIAL_ANALYST,`User Query: "${n}"

Financial Data: ${JSON.stringify(e)}`),px=(n,e,t,i)=>{const o=Object.keys(t),l=Object.keys(i);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...o].map(g=>`'${g}'`).join(", ")}].
`;Object.values(i).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),Object.values(t).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const d=Ya.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return $a(d,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},gx=n=>$a(Ya.INVESTMENT_COACH,n),Zm=n=>$a(Ya.ICON_SUGGESTER,`Category: ${n}`),yx=(n,e,t)=>$a(Ya.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),_x=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,i=await $a(Ya.EXCHANGE_RATE,t,!0);try{const o=JSON.parse(i);return{rate:parseFloat(o.rate),fromCurrency:o.fromCurrency,toCurrency:o.toCurrency,lastUpdated:o.lastUpdated}}catch(o){throw console.error("Error parsing exchange rate:",o),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},kM=Object.freeze(Object.defineProperty({__proto__:null,analyzeFinancialData:mx,analyzePastedText:px,generateBudgetPlan:yx,generateInvestmentAdvice:gx,getExchangeRate:_x,initializeAi:hx,suggestCategoryIcon:Zm},Symbol.toStringTag,{value:"Module"})),VM="modulepreload",LM=function(n){return"/fd/"+n},dT={},yi=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let u=function(m){return Promise.all(m.map(T=>Promise.resolve(T).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=u(t.map(m=>{if(m=LM(m),m in dT)return;dT[m]=!0;const T=m.endsWith(".css"),E=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${E}`))return;const b=document.createElement("link");if(b.rel=T?"stylesheet":VM,T||(b.as="script"),b.crossOrigin="",b.href=m,g&&b.setAttribute("nonce",g),document.head.appendChild(b),T)return new Promise((C,P)=>{b.addEventListener("load",C),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},UM=()=>{};var fT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},OM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[i++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],u=n[t++],d=n[t++],g=((o&7)<<18|(l&63)<<12|(u&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(l&63)<<6|u&63)}}return e.join("")},Tx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const l=n[o],u=o+1<n.length,d=u?n[o+1]:0,g=o+2<n.length,m=g?n[o+2]:0,T=l>>2,E=(l&3)<<4|d>>4;let b=(d&15)<<2|m>>6,C=m&63;g||(C=64,u||(b=64)),i.push(t[T],t[E],t[b],t[C])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):OM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||d==null||m==null||E==null)throw new qM;const b=l<<2|d>>4;if(i.push(b),m!==64){const C=d<<4&240|m>>2;if(i.push(C),E!==64){const P=m<<6&192|E;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class qM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FM=function(n){const e=vx(n);return Tx.encodeByteArray(e,!0)},Rd=function(n){return FM(n).replace(/\./g,"")},Ex=function(n){try{return Tx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BM=()=>jM().__FIREBASE_DEFAULTS__,zM=()=>{if(typeof process>"u"||typeof fT>"u")return;const n=fT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},HM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ex(n[1]);return e&&JSON.parse(e)},ef=()=>{try{return UM()||BM()||zM()||HM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xx=n=>{var e,t;return(t=(e=ef())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},GM=n=>{const e=xx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},bx=()=>{var n;return(n=ef())==null?void 0:n.config},Ax=n=>{var e;return(e=ef())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sx(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $M(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Rd(JSON.stringify(t)),Rd(JSON.stringify(u)),""].join(".")}const du={};function JM(){const n={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?n.emulator.push(e):n.prod.push(e);return n}function KM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let hT=!1;function Cx(n,e){if(typeof window>"u"||typeof document>"u"||!Ja(window.location.host)||du[n]===e||du[n]||hT)return;du[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=JM().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function d(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function m(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{hT=!0,u()},b}function T(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function E(){const b=KM(i),C=t("text"),P=document.getElementById(C)||document.createElement("span"),O=t("learnmore"),G=document.getElementById(O)||document.createElement("a"),ne=t("preprendIcon"),j=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const q=b.element;d(q),T(G,O);const H=m();g(j,ne),q.append(j,P,G,H),document.body.appendChild(q)}l?(P.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vn())}function XM(){var e;const n=(e=ef())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ZM(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tD(){const n=vn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function nD(){return!XM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sD(){try{return typeof indexedDB=="object"}catch{return!1}}function iD(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="FirebaseError";class Vi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=rD,Object.setPrototypeOf(this,Vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Su.prototype.create)}}class Su{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],u=l?oD(l,i):"Error",d=`${this.serviceName}: ${u} (${o}).`;return new Vi(o,d,i)}}function oD(n,e){return n.replace(aD,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const aD=/\{\$([^}]+)}/g;function lD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const l=n[o],u=e[o];if(mT(l)&&mT(u)){if(!yo(l,u))return!1}else if(l!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function mT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ru(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,l]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function ou(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function uD(n,e){const t=new cD(n,e);return t.subscribe.bind(t)}class cD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");dD(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Im),o.error===void 0&&(o.error=Im),o.complete===void 0&&(o.complete=Im);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Im(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(n){return n&&n._delegate?n._delegate:n}class _o{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new YM;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mD(e))try{this.getOrInitializeService({instanceIdentifier:ho})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});i.resolve(l)}catch{}}}}clearInstance(e=ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ho){return this.instances.has(e)}getOptions(e=ho){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&u.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const l=this.instances.get(i);return l&&e(l,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:hD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ho){return this.component?this.component.multipleInstances?e:ho:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hD(n){return n===ho?void 0:n}function mD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new fD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Je||(Je={}));const gD={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},yD=Je.INFO,_D={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},vD=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=_D[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pp{constructor(e){this.name=e,this._logLevel=yD,this._logHandler=vD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const TD=(n,e)=>e.some(t=>n instanceof t);let pT,gT;function ED(){return pT||(pT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xD(){return gT||(gT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wx=new WeakMap,ep=new WeakMap,Ix=new WeakMap,Nm=new WeakMap,kp=new WeakMap;function bD(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(Er(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&wx.set(t,n)}).catch(()=>{}),kp.set(e,n),e}function AD(n){if(ep.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});ep.set(n,e)}let tp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ep.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ix.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Er(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SD(n){tp=n(tp)}function CD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Rm(this),e,...t);return Ix.set(i,e.sort?e.sort():[e]),Er(i)}:xD().includes(n)?function(...e){return n.apply(Rm(this),e),Er(wx.get(this))}:function(...e){return Er(n.apply(Rm(this),e))}}function wD(n){return typeof n=="function"?CD(n):(n instanceof IDBTransaction&&AD(n),TD(n,ED())?new Proxy(n,tp):n)}function Er(n){if(n instanceof IDBRequest)return bD(n);if(Nm.has(n))return Nm.get(n);const e=wD(n);return e!==n&&(Nm.set(n,e),kp.set(e,n)),e}const Rm=n=>kp.get(n);function ID(n,e,{blocked:t,upgrade:i,blocking:o,terminated:l}={}){const u=indexedDB.open(n,e),d=Er(u);return i&&u.addEventListener("upgradeneeded",g=>{i(Er(u.result),g.oldVersion,g.newVersion,Er(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),d.then(g=>{l&&g.addEventListener("close",()=>l()),o&&g.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const ND=["get","getKey","getAll","getAllKeys","count"],RD=["put","add","delete","clear"],Mm=new Map;function yT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mm.get(e))return Mm.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=RD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||ND.includes(t)))return;const l=async function(u,...d){const g=this.transaction(u,o?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),o&&g.done]))[0]};return Mm.set(e,l),l}SD(n=>({...n,get:(e,t,i)=>yT(e,t)||n.get(e,t,i),has:(e,t)=>!!yT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(DD(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function DD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",_T="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni=new Pp("@firebase/app"),PD="@firebase/app-compat",kD="@firebase/analytics-compat",VD="@firebase/analytics",LD="@firebase/app-check-compat",UD="@firebase/app-check",OD="@firebase/auth",qD="@firebase/auth-compat",FD="@firebase/database",jD="@firebase/data-connect",BD="@firebase/database-compat",zD="@firebase/functions",HD="@firebase/functions-compat",GD="@firebase/installations",YD="@firebase/installations-compat",$D="@firebase/messaging",JD="@firebase/messaging-compat",KD="@firebase/performance",QD="@firebase/performance-compat",XD="@firebase/remote-config",WD="@firebase/remote-config-compat",ZD="@firebase/storage",e2="@firebase/storage-compat",t2="@firebase/firestore",n2="@firebase/ai",s2="@firebase/firestore-compat",i2="firebase",r2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",o2={[np]:"fire-core",[PD]:"fire-core-compat",[VD]:"fire-analytics",[kD]:"fire-analytics-compat",[UD]:"fire-app-check",[LD]:"fire-app-check-compat",[OD]:"fire-auth",[qD]:"fire-auth-compat",[FD]:"fire-rtdb",[jD]:"fire-data-connect",[BD]:"fire-rtdb-compat",[zD]:"fire-fn",[HD]:"fire-fn-compat",[GD]:"fire-iid",[YD]:"fire-iid-compat",[$D]:"fire-fcm",[JD]:"fire-fcm-compat",[KD]:"fire-perf",[QD]:"fire-perf-compat",[XD]:"fire-rc",[WD]:"fire-rc-compat",[ZD]:"fire-gcs",[e2]:"fire-gcs-compat",[t2]:"fire-fst",[s2]:"fire-fst-compat",[n2]:"fire-vertex","fire-js":"fire-js",[i2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=new Map,a2=new Map,ip=new Map;function vT(n,e){try{n.container.addComponent(e)}catch(t){Ni.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ka(n){const e=n.name;if(ip.has(e))return Ni.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,n);for(const t of Md.values())vT(t,n);for(const t of a2.values())vT(t,n);return!0}function Vp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ns(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new Su("app","Firebase",l2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new _o("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=r2;function Nx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:sp,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw xr.create("bad-app-name",{appName:String(o)});if(t||(t=bx()),!t)throw xr.create("no-options");const l=Md.get(o);if(l){if(yo(t,l.options)&&yo(i,l.config))return l;throw xr.create("duplicate-app",{appName:o})}const u=new pD(o);for(const g of ip.values())u.addComponent(g);const d=new u2(t,i,u);return Md.set(o,d),d}function Rx(n=sp){const e=Md.get(n);if(!e&&n===sp&&bx())return Nx();if(!e)throw xr.create("no-app",{appName:n});return e}function br(n,e,t){let i=o2[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ni.warn(u.join(" "));return}ka(new _o(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="firebase-heartbeat-database",d2=1,_u="firebase-heartbeat-store";let Dm=null;function Mx(){return Dm||(Dm=ID(c2,d2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_u)}catch(t){console.warn(t)}}}}).catch(n=>{throw xr.create("idb-open",{originalErrorMessage:n.message})})),Dm}async function f2(n){try{const t=(await Mx()).transaction(_u),i=await t.objectStore(_u).get(Dx(n));return await t.done,i}catch(e){if(e instanceof Vi)Ni.warn(e.message);else{const t=xr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ni.warn(t.message)}}}async function TT(n,e){try{const i=(await Mx()).transaction(_u,"readwrite");await i.objectStore(_u).put(e,Dx(n)),await i.done}catch(t){if(t instanceof Vi)Ni.warn(t.message);else{const i=xr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ni.warn(i.message)}}}function Dx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=1024,m2=30;class p2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new y2(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=ET();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>m2){const u=_2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ni.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ET(),{heartbeatsToSend:i,unsentEntries:o}=g2(this._heartbeatsCache.heartbeats),l=Rd(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ni.warn(t),""}}}function ET(){return new Date().toISOString().substring(0,10)}function g2(n,e=h2){const t=[];let i=n.slice();for(const o of n){const l=t.find(u=>u.agent===o.agent);if(l){if(l.dates.push(o.date),xT(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),xT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class y2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sD()?iD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await f2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return TT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return TT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function xT(n){return Rd(JSON.stringify({version:2,heartbeats:n})).length}function _2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(n){ka(new _o("platform-logger",e=>new MD(e),"PRIVATE")),ka(new _o("heartbeat",e=>new p2(e),"PRIVATE")),br(np,_T,n),br(np,_T,"esm2020"),br("fire-js","")}v2("");var T2="firebase",E2="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */br(T2,E2,"app");var bT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ar,Px;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,w){function R(){}R.prototype=w.prototype,N.F=w.prototype,N.prototype=new R,N.prototype.constructor=N,N.D=function(k,V,F){for(var D=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)D[ke-2]=arguments[ke];return w.prototype[V].apply(k,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(N,w,R){R||(R=0);const k=Array(16);if(typeof w=="string")for(var V=0;V<16;++V)k[V]=w.charCodeAt(R++)|w.charCodeAt(R++)<<8|w.charCodeAt(R++)<<16|w.charCodeAt(R++)<<24;else for(V=0;V<16;++V)k[V]=w[R++]|w[R++]<<8|w[R++]<<16|w[R++]<<24;w=N.g[0],R=N.g[1],V=N.g[2];let F=N.g[3],D;D=w+(F^R&(V^F))+k[0]+3614090360&4294967295,w=R+(D<<7&4294967295|D>>>25),D=F+(V^w&(R^V))+k[1]+3905402710&4294967295,F=w+(D<<12&4294967295|D>>>20),D=V+(R^F&(w^R))+k[2]+606105819&4294967295,V=F+(D<<17&4294967295|D>>>15),D=R+(w^V&(F^w))+k[3]+3250441966&4294967295,R=V+(D<<22&4294967295|D>>>10),D=w+(F^R&(V^F))+k[4]+4118548399&4294967295,w=R+(D<<7&4294967295|D>>>25),D=F+(V^w&(R^V))+k[5]+1200080426&4294967295,F=w+(D<<12&4294967295|D>>>20),D=V+(R^F&(w^R))+k[6]+2821735955&4294967295,V=F+(D<<17&4294967295|D>>>15),D=R+(w^V&(F^w))+k[7]+4249261313&4294967295,R=V+(D<<22&4294967295|D>>>10),D=w+(F^R&(V^F))+k[8]+1770035416&4294967295,w=R+(D<<7&4294967295|D>>>25),D=F+(V^w&(R^V))+k[9]+2336552879&4294967295,F=w+(D<<12&4294967295|D>>>20),D=V+(R^F&(w^R))+k[10]+4294925233&4294967295,V=F+(D<<17&4294967295|D>>>15),D=R+(w^V&(F^w))+k[11]+2304563134&4294967295,R=V+(D<<22&4294967295|D>>>10),D=w+(F^R&(V^F))+k[12]+1804603682&4294967295,w=R+(D<<7&4294967295|D>>>25),D=F+(V^w&(R^V))+k[13]+4254626195&4294967295,F=w+(D<<12&4294967295|D>>>20),D=V+(R^F&(w^R))+k[14]+2792965006&4294967295,V=F+(D<<17&4294967295|D>>>15),D=R+(w^V&(F^w))+k[15]+1236535329&4294967295,R=V+(D<<22&4294967295|D>>>10),D=w+(V^F&(R^V))+k[1]+4129170786&4294967295,w=R+(D<<5&4294967295|D>>>27),D=F+(R^V&(w^R))+k[6]+3225465664&4294967295,F=w+(D<<9&4294967295|D>>>23),D=V+(w^R&(F^w))+k[11]+643717713&4294967295,V=F+(D<<14&4294967295|D>>>18),D=R+(F^w&(V^F))+k[0]+3921069994&4294967295,R=V+(D<<20&4294967295|D>>>12),D=w+(V^F&(R^V))+k[5]+3593408605&4294967295,w=R+(D<<5&4294967295|D>>>27),D=F+(R^V&(w^R))+k[10]+38016083&4294967295,F=w+(D<<9&4294967295|D>>>23),D=V+(w^R&(F^w))+k[15]+3634488961&4294967295,V=F+(D<<14&4294967295|D>>>18),D=R+(F^w&(V^F))+k[4]+3889429448&4294967295,R=V+(D<<20&4294967295|D>>>12),D=w+(V^F&(R^V))+k[9]+568446438&4294967295,w=R+(D<<5&4294967295|D>>>27),D=F+(R^V&(w^R))+k[14]+3275163606&4294967295,F=w+(D<<9&4294967295|D>>>23),D=V+(w^R&(F^w))+k[3]+4107603335&4294967295,V=F+(D<<14&4294967295|D>>>18),D=R+(F^w&(V^F))+k[8]+1163531501&4294967295,R=V+(D<<20&4294967295|D>>>12),D=w+(V^F&(R^V))+k[13]+2850285829&4294967295,w=R+(D<<5&4294967295|D>>>27),D=F+(R^V&(w^R))+k[2]+4243563512&4294967295,F=w+(D<<9&4294967295|D>>>23),D=V+(w^R&(F^w))+k[7]+1735328473&4294967295,V=F+(D<<14&4294967295|D>>>18),D=R+(F^w&(V^F))+k[12]+2368359562&4294967295,R=V+(D<<20&4294967295|D>>>12),D=w+(R^V^F)+k[5]+4294588738&4294967295,w=R+(D<<4&4294967295|D>>>28),D=F+(w^R^V)+k[8]+2272392833&4294967295,F=w+(D<<11&4294967295|D>>>21),D=V+(F^w^R)+k[11]+1839030562&4294967295,V=F+(D<<16&4294967295|D>>>16),D=R+(V^F^w)+k[14]+4259657740&4294967295,R=V+(D<<23&4294967295|D>>>9),D=w+(R^V^F)+k[1]+2763975236&4294967295,w=R+(D<<4&4294967295|D>>>28),D=F+(w^R^V)+k[4]+1272893353&4294967295,F=w+(D<<11&4294967295|D>>>21),D=V+(F^w^R)+k[7]+4139469664&4294967295,V=F+(D<<16&4294967295|D>>>16),D=R+(V^F^w)+k[10]+3200236656&4294967295,R=V+(D<<23&4294967295|D>>>9),D=w+(R^V^F)+k[13]+681279174&4294967295,w=R+(D<<4&4294967295|D>>>28),D=F+(w^R^V)+k[0]+3936430074&4294967295,F=w+(D<<11&4294967295|D>>>21),D=V+(F^w^R)+k[3]+3572445317&4294967295,V=F+(D<<16&4294967295|D>>>16),D=R+(V^F^w)+k[6]+76029189&4294967295,R=V+(D<<23&4294967295|D>>>9),D=w+(R^V^F)+k[9]+3654602809&4294967295,w=R+(D<<4&4294967295|D>>>28),D=F+(w^R^V)+k[12]+3873151461&4294967295,F=w+(D<<11&4294967295|D>>>21),D=V+(F^w^R)+k[15]+530742520&4294967295,V=F+(D<<16&4294967295|D>>>16),D=R+(V^F^w)+k[2]+3299628645&4294967295,R=V+(D<<23&4294967295|D>>>9),D=w+(V^(R|~F))+k[0]+4096336452&4294967295,w=R+(D<<6&4294967295|D>>>26),D=F+(R^(w|~V))+k[7]+1126891415&4294967295,F=w+(D<<10&4294967295|D>>>22),D=V+(w^(F|~R))+k[14]+2878612391&4294967295,V=F+(D<<15&4294967295|D>>>17),D=R+(F^(V|~w))+k[5]+4237533241&4294967295,R=V+(D<<21&4294967295|D>>>11),D=w+(V^(R|~F))+k[12]+1700485571&4294967295,w=R+(D<<6&4294967295|D>>>26),D=F+(R^(w|~V))+k[3]+2399980690&4294967295,F=w+(D<<10&4294967295|D>>>22),D=V+(w^(F|~R))+k[10]+4293915773&4294967295,V=F+(D<<15&4294967295|D>>>17),D=R+(F^(V|~w))+k[1]+2240044497&4294967295,R=V+(D<<21&4294967295|D>>>11),D=w+(V^(R|~F))+k[8]+1873313359&4294967295,w=R+(D<<6&4294967295|D>>>26),D=F+(R^(w|~V))+k[15]+4264355552&4294967295,F=w+(D<<10&4294967295|D>>>22),D=V+(w^(F|~R))+k[6]+2734768916&4294967295,V=F+(D<<15&4294967295|D>>>17),D=R+(F^(V|~w))+k[13]+1309151649&4294967295,R=V+(D<<21&4294967295|D>>>11),D=w+(V^(R|~F))+k[4]+4149444226&4294967295,w=R+(D<<6&4294967295|D>>>26),D=F+(R^(w|~V))+k[11]+3174756917&4294967295,F=w+(D<<10&4294967295|D>>>22),D=V+(w^(F|~R))+k[2]+718787259&4294967295,V=F+(D<<15&4294967295|D>>>17),D=R+(F^(V|~w))+k[9]+3951481745&4294967295,N.g[0]=N.g[0]+w&4294967295,N.g[1]=N.g[1]+(V+(D<<21&4294967295|D>>>11))&4294967295,N.g[2]=N.g[2]+V&4294967295,N.g[3]=N.g[3]+F&4294967295}i.prototype.v=function(N,w){w===void 0&&(w=N.length);const R=w-this.blockSize,k=this.C;let V=this.h,F=0;for(;F<w;){if(V==0)for(;F<=R;)o(this,N,F),F+=this.blockSize;if(typeof N=="string"){for(;F<w;)if(k[V++]=N.charCodeAt(F++),V==this.blockSize){o(this,k),V=0;break}}else for(;F<w;)if(k[V++]=N[F++],V==this.blockSize){o(this,k),V=0;break}}this.h=V,this.o+=w},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var w=1;w<N.length-8;++w)N[w]=0;w=this.o*8;for(var R=N.length-8;R<N.length;++R)N[R]=w&255,w/=256;for(this.v(N),N=Array(16),w=0,R=0;R<4;++R)for(let k=0;k<32;k+=8)N[w++]=this.g[R]>>>k&255;return N};function l(N,w){var R=d;return Object.prototype.hasOwnProperty.call(R,N)?R[N]:R[N]=w(N)}function u(N,w){this.h=w;const R=[];let k=!0;for(let V=N.length-1;V>=0;V--){const F=N[V]|0;k&&F==w||(R[V]=F,k=!1)}this.g=R}var d={};function g(N){return-128<=N&&N<128?l(N,function(w){return new u([w|0],w<0?-1:0)}):new u([N|0],N<0?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return E;if(N<0)return G(m(-N));const w=[];let R=1;for(let k=0;N>=R;k++)w[k]=N/R|0,R*=4294967296;return new u(w,0)}function T(N,w){if(N.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(N.charAt(0)=="-")return G(T(N.substring(1),w));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=m(Math.pow(w,8));let k=E;for(let F=0;F<N.length;F+=8){var V=Math.min(8,N.length-F);const D=parseInt(N.substring(F,F+V),w);V<8?(V=m(Math.pow(w,V)),k=k.j(V).add(m(D))):(k=k.j(R),k=k.add(m(D)))}return k}var E=g(0),b=g(1),C=g(16777216);n=u.prototype,n.m=function(){if(O(this))return-G(this).m();let N=0,w=1;for(let R=0;R<this.g.length;R++){const k=this.i(R);N+=(k>=0?k:4294967296+k)*w,w*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(P(this))return"0";if(O(this))return"-"+G(this).toString(N);const w=m(Math.pow(N,6));var R=this;let k="";for(;;){const V=H(R,w).g;R=ne(R,V.j(w));let F=((R.g.length>0?R.g[0]:R.h)>>>0).toString(N);if(R=V,P(R))return F+k;for(;F.length<6;)F="0"+F;k=F+k}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function P(N){if(N.h!=0)return!1;for(let w=0;w<N.g.length;w++)if(N.g[w]!=0)return!1;return!0}function O(N){return N.h==-1}n.l=function(N){return N=ne(this,N),O(N)?-1:P(N)?0:1};function G(N){const w=N.g.length,R=[];for(let k=0;k<w;k++)R[k]=~N.g[k];return new u(R,~N.h).add(b)}n.abs=function(){return O(this)?G(this):this},n.add=function(N){const w=Math.max(this.g.length,N.g.length),R=[];let k=0;for(let V=0;V<=w;V++){let F=k+(this.i(V)&65535)+(N.i(V)&65535),D=(F>>>16)+(this.i(V)>>>16)+(N.i(V)>>>16);k=D>>>16,F&=65535,D&=65535,R[V]=D<<16|F}return new u(R,R[R.length-1]&-2147483648?-1:0)};function ne(N,w){return N.add(G(w))}n.j=function(N){if(P(this)||P(N))return E;if(O(this))return O(N)?G(this).j(G(N)):G(G(this).j(N));if(O(N))return G(this.j(G(N)));if(this.l(C)<0&&N.l(C)<0)return m(this.m()*N.m());const w=this.g.length+N.g.length,R=[];for(var k=0;k<2*w;k++)R[k]=0;for(k=0;k<this.g.length;k++)for(let V=0;V<N.g.length;V++){const F=this.i(k)>>>16,D=this.i(k)&65535,ke=N.i(V)>>>16,fe=N.i(V)&65535;R[2*k+2*V]+=D*fe,j(R,2*k+2*V),R[2*k+2*V+1]+=F*fe,j(R,2*k+2*V+1),R[2*k+2*V+1]+=D*ke,j(R,2*k+2*V+1),R[2*k+2*V+2]+=F*ke,j(R,2*k+2*V+2)}for(N=0;N<w;N++)R[N]=R[2*N+1]<<16|R[2*N];for(N=w;N<2*w;N++)R[N]=0;return new u(R,0)};function j(N,w){for(;(N[w]&65535)!=N[w];)N[w+1]+=N[w]>>>16,N[w]&=65535,w++}function q(N,w){this.g=N,this.h=w}function H(N,w){if(P(w))throw Error("division by zero");if(P(N))return new q(E,E);if(O(N))return w=H(G(N),w),new q(G(w.g),G(w.h));if(O(w))return w=H(N,G(w)),new q(G(w.g),w.h);if(N.g.length>30){if(O(N)||O(w))throw Error("slowDivide_ only works with positive integers.");for(var R=b,k=w;k.l(N)<=0;)R=Z(R),k=Z(k);var V=U(R,1),F=U(k,1);for(k=U(k,2),R=U(R,2);!P(k);){var D=F.add(k);D.l(N)<=0&&(V=V.add(R),F=D),k=U(k,1),R=U(R,1)}return w=ne(N,V.j(w)),new q(V,w)}for(V=E;N.l(w)>=0;){for(R=Math.max(1,Math.floor(N.m()/w.m())),k=Math.ceil(Math.log(R)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),F=m(R),D=F.j(w);O(D)||D.l(N)>0;)R-=k,F=m(R),D=F.j(w);P(F)&&(F=b),V=V.add(F),N=ne(N,D)}return new q(V,N)}n.B=function(N){return H(this,N).h},n.and=function(N){const w=Math.max(this.g.length,N.g.length),R=[];for(let k=0;k<w;k++)R[k]=this.i(k)&N.i(k);return new u(R,this.h&N.h)},n.or=function(N){const w=Math.max(this.g.length,N.g.length),R=[];for(let k=0;k<w;k++)R[k]=this.i(k)|N.i(k);return new u(R,this.h|N.h)},n.xor=function(N){const w=Math.max(this.g.length,N.g.length),R=[];for(let k=0;k<w;k++)R[k]=this.i(k)^N.i(k);return new u(R,this.h^N.h)};function Z(N){const w=N.g.length+1,R=[];for(let k=0;k<w;k++)R[k]=N.i(k)<<1|N.i(k-1)>>>31;return new u(R,N.h)}function U(N,w){const R=w>>5;w%=32;const k=N.g.length-R,V=[];for(let F=0;F<k;F++)V[F]=w>0?N.i(F+R)>>>w|N.i(F+R+1)<<32-w:N.i(F+R);return new u(V,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Px=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=T,Ar=u}).apply(typeof bT<"u"?bT:typeof self<"u"?self:typeof window<"u"?window:{});var ad=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kx,au,Vx,yd,rp,Lx,Ux,Ox;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof ad=="object"&&ad];for(var x=0;x<p.length;++x){var S=p[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function o(p,x){if(x)e:{var S=i;p=p.split(".");for(var M=0;M<p.length-1;M++){var J=p[M];if(!(J in S))break e;S=S[J]}p=p[p.length-1],M=S[p],x=x(M),x!=M&&x!=null&&e(S,p,{configurable:!0,writable:!0,value:x})}}o("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(p){return p||function(x){var S=[],M;for(M in x)Object.prototype.hasOwnProperty.call(x,M)&&S.push([M,x[M]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function d(p){var x=typeof p;return x=="object"&&p!=null||x=="function"}function g(p,x,S){return p.call.apply(p.bind,arguments)}function m(p,x,S){return m=g,m.apply(null,arguments)}function T(p,x){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function E(p,x){function S(){}S.prototype=x.prototype,p.Z=x.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(M,J,ee){for(var ge=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)ge[qe-2]=arguments[qe];return x.prototype[J].apply(M,ge)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function C(p){const x=p.length;if(x>0){const S=Array(x);for(let M=0;M<x;M++)S[M]=p[M];return S}return[]}function P(p,x){for(let M=1;M<arguments.length;M++){const J=arguments[M];var S=typeof J;if(S=S!="object"?S:J?Array.isArray(J)?"array":S:"null",S=="array"||S=="object"&&typeof J.length=="number"){S=p.length||0;const ee=J.length||0;p.length=S+ee;for(let ge=0;ge<ee;ge++)p[S+ge]=J[ge]}else p.push(J)}}class O{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function G(p){u.setTimeout(()=>{throw p},0)}function ne(){var p=N;let x=null;return p.g&&(x=p.g,p.g=p.g.next,p.g||(p.h=null),x.next=null),x}class j{constructor(){this.h=this.g=null}add(x,S){const M=q.get();M.set(x,S),this.h?this.h.next=M:this.g=M,this.h=M}}var q=new O(()=>new H,p=>p.reset());class H{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,U=!1,N=new j,w=()=>{const p=Promise.resolve(void 0);Z=()=>{p.then(R)}};function R(){for(var p;p=ne();){try{p.h.call(p.g)}catch(S){G(S)}var x=q;x.j(p),x.h<100&&(x.h++,p.next=x.g,x.g=p)}U=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(p,x){this.type=p,this.g=this.target=x,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,x=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};u.addEventListener("test",S,x),u.removeEventListener("test",S,x)}catch{}return p})();function D(p){return/^[\s\xa0]*$/.test(p)}function ke(p,x){V.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,x)}E(ke,V),ke.prototype.init=function(p,x){const S=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=x,x=p.relatedTarget,x||(S=="mouseover"?x=p.fromElement:S=="mouseout"&&(x=p.toElement)),this.relatedTarget=x,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var fe="closure_listenable_"+(Math.random()*1e6|0),$=0;function de(p,x,S,M,J){this.listener=p,this.proxy=null,this.src=x,this.type=S,this.capture=!!M,this.ha=J,this.key=++$,this.da=this.fa=!1}function _e(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function je(p,x,S){for(const M in p)x.call(S,p[M],M,p)}function We(p,x){for(const S in p)x.call(void 0,p[S],S,p)}function B(p){const x={};for(const S in p)x[S]=p[S];return x}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(p,x){let S,M;for(let J=1;J<arguments.length;J++){M=arguments[J];for(S in M)p[S]=M[S];for(let ee=0;ee<re.length;ee++)S=re[ee],Object.prototype.hasOwnProperty.call(M,S)&&(p[S]=M[S])}}function ve(p){this.src=p,this.g={},this.h=0}ve.prototype.add=function(p,x,S,M,J){const ee=p.toString();p=this.g[ee],p||(p=this.g[ee]=[],this.h++);const ge=ce(p,x,M,J);return ge>-1?(x=p[ge],S||(x.fa=!1)):(x=new de(x,this.src,ee,!!M,J),x.fa=S,p.push(x)),x};function ie(p,x){const S=x.type;if(S in p.g){var M=p.g[S],J=Array.prototype.indexOf.call(M,x,void 0),ee;(ee=J>=0)&&Array.prototype.splice.call(M,J,1),ee&&(_e(x),p.g[S].length==0&&(delete p.g[S],p.h--))}}function ce(p,x,S,M){for(let J=0;J<p.length;++J){const ee=p[J];if(!ee.da&&ee.listener==x&&ee.capture==!!S&&ee.ha==M)return J}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),Ze={};function nt(p,x,S,M,J){if(Array.isArray(x)){for(let ee=0;ee<x.length;ee++)nt(p,x[ee],S,M,J);return null}return S=Ur(S),p&&p[fe]?p.J(x,S,d(M)?!!M.capture:!1,J):An(p,x,S,!1,M,J)}function An(p,x,S,M,J,ee){if(!x)throw Error("Invalid event type");const ge=d(J)?!!J.capture:!!J;let qe=Xs(p);if(qe||(p[xe]=qe=new ve(p)),S=qe.add(x,S,M,ge,ee),S.proxy)return S;if(M=Ct(),S.proxy=M,M.src=p,M.listener=S,p.addEventListener)F||(J=ge),J===void 0&&(J=!1),p.addEventListener(x.toString(),M,J);else if(p.attachEvent)p.attachEvent(zn(x.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Ct(){function p(S){return x.call(p.src,p.listener,S)}const x=Vr;return p}function bs(p,x,S,M,J){if(Array.isArray(x))for(var ee=0;ee<x.length;ee++)bs(p,x[ee],S,M,J);else M=d(M)?!!M.capture:!!M,S=Ur(S),p&&p[fe]?(p=p.i,ee=String(x).toString(),ee in p.g&&(x=p.g[ee],S=ce(x,S,M,J),S>-1&&(_e(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete p.g[ee],p.h--)))):p&&(p=Xs(p))&&(x=p.g[x.toString()],p=-1,x&&(p=ce(x,S,M,J)),(S=p>-1?x[p]:null)&&Ui(S))}function Ui(p){if(typeof p!="number"&&p&&!p.da){var x=p.src;if(x&&x[fe])ie(x.i,p);else{var S=p.type,M=p.proxy;x.removeEventListener?x.removeEventListener(S,M,p.capture):x.detachEvent?x.detachEvent(zn(S),M):x.addListener&&x.removeListener&&x.removeListener(M),(S=Xs(x))?(ie(S,p),S.h==0&&(S.src=null,x[xe]=null)):_e(p)}}}function zn(p){return p in Ze?Ze[p]:Ze[p]="on"+p}function Vr(p,x){if(p.da)p=!0;else{x=new ke(x,this);const S=p.listener,M=p.ha||p.src;p.fa&&Ui(p),p=S.call(M,x)}return p}function Xs(p){return p=p[xe],p instanceof ve?p:null}var Lr="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ur(p){return typeof p=="function"?p:(p[Lr]||(p[Lr]=function(x){return p.handleEvent(x)}),p[Lr])}function Nt(){k.call(this),this.i=new ve(this),this.M=this,this.G=null}E(Nt,k),Nt.prototype[fe]=!0,Nt.prototype.removeEventListener=function(p,x,S,M){bs(this,p,x,S,M)};function Dt(p,x){var S,M=p.G;if(M)for(S=[];M;M=M.G)S.push(M);if(p=p.M,M=x.type||x,typeof x=="string")x=new V(x,p);else if(x instanceof V)x.target=x.target||p;else{var J=x;x=new V(M,p),ye(x,J)}J=!0;let ee,ge;if(S)for(ge=S.length-1;ge>=0;ge--)ee=x.g=S[ge],J=rs(ee,M,!0,x)&&J;if(ee=x.g=p,J=rs(ee,M,!0,x)&&J,J=rs(ee,M,!1,x)&&J,S)for(ge=0;ge<S.length;ge++)ee=x.g=S[ge],J=rs(ee,M,!1,x)&&J}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var p=this.i;for(const x in p.g){const S=p.g[x];for(let M=0;M<S.length;M++)_e(S[M]);delete p.g[x],p.h--}}this.G=null},Nt.prototype.J=function(p,x,S,M){return this.i.add(String(p),x,!1,S,M)},Nt.prototype.K=function(p,x,S,M){return this.i.add(String(p),x,!0,S,M)};function rs(p,x,S,M){if(x=p.i.g[String(x)],!x)return!0;x=x.concat();let J=!0;for(let ee=0;ee<x.length;++ee){const ge=x[ee];if(ge&&!ge.da&&ge.capture==S){const qe=ge.listener,kt=ge.ha||ge.src;ge.fa&&ie(p.i,ge),J=qe.call(kt,M)!==!1&&J}}return J&&!M.defaultPrevented}function tl(p,x){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:u.setTimeout(p,x||0)}function Or(p){p.g=tl(()=>{p.g=null,p.i&&(p.i=!1,Or(p))},p.l);const x=p.h;p.h=null,p.m.apply(null,x)}class Zt extends k{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Or(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function As(p){k.call(this),this.h=p,this.g={}}E(As,k);var Oi=[];function qi(p){je(p.g,function(x,S){this.g.hasOwnProperty(S)&&Ui(x)},p),p.g={}}As.prototype.N=function(){As.Z.N.call(this),qi(this)},As.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var K=u.JSON.stringify,me=u.JSON.parse,pe=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function Se(){}function Ve(){}var et={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function qt(){V.call(this,"d")}E(qt,V);function Tn(){V.call(this,"c")}E(Tn,V);var wt={},Ro=null;function Fi(){return Ro=Ro||new Nt}wt.Ia="serverreachability";function Mo(p){V.call(this,wt.Ia,p)}E(Mo,V);function Te(p){const x=Fi();Dt(x,new Mo(x))}wt.STAT_EVENT="statevent";function vt(p,x){V.call(this,wt.STAT_EVENT,p),this.stat=x}E(vt,V);function ut(p){const x=Fi();Dt(x,new vt(x,p))}wt.Ja="timingevent";function Pt(p,x){V.call(this,wt.Ja,p),this.size=x}E(Pt,V);function hn(p,x){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},x)}function ze(){this.g=!0}ze.prototype.ua=function(){this.g=!1};function Af(p,x,S,M,J,ee){p.info(function(){if(p.g)if(ee){var ge="",qe=ee.split("&");for(let ot=0;ot<qe.length;ot++){var kt=qe[ot].split("=");if(kt.length>1){const At=kt[0];kt=kt[1];const $n=At.split("_");ge=$n.length>=2&&$n[1]=="type"?ge+(At+"="+kt+"&"):ge+(At+"=redacted&")}}}else ge=null;else ge=ee;return"XMLHTTP REQ ("+M+") [attempt "+J+"]: "+x+`
`+S+`
`+ge})}function Uu(p,x,S,M,J,ee,ge){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+J+"]: "+x+`
`+S+`
`+ee+" "+ge})}function Ss(p,x,S,M){p.info(function(){return"XMLHTTP TEXT ("+x+"): "+Sf(p,S)+(M?" "+M:"")})}function qr(p,x){p.info(function(){return"TIMEOUT: "+x})}ze.prototype.info=function(){};function Sf(p,x){if(!p.g)return x;if(!x)return null;try{const ee=JSON.parse(x);if(ee){for(p=0;p<ee.length;p++)if(Array.isArray(ee[p])){var S=ee[p];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var J=M[0];if(J!="noop"&&J!="stop"&&J!="close")for(let ge=1;ge<M.length;ge++)M[ge]=""}}}}return K(ee)}catch{return x}}var Fr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},sl;function jr(){}E(jr,Se),jr.prototype.g=function(){return new XMLHttpRequest},sl=new jr;function Ws(p){return encodeURIComponent(String(p))}function Ou(p){var x=1;p=p.split(":");const S=[];for(;x>0&&p.length;)S.push(p.shift()),x--;return p.length&&S.push(p.join(":")),S}function os(p,x,S,M){this.j=p,this.i=x,this.l=S,this.S=M||1,this.V=new As(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new as}function as(){this.i=null,this.g="",this.h=!1}var Ft={},en={};function Cs(p,x,S){p.M=1,p.A=Br(Bt(x)),p.u=S,p.R=!0,Do(p,null)}function Do(p,x){p.F=Date.now(),ws(p),p.B=Bt(p.A);var S=p.B,M=p.S;Array.isArray(M)||(M=[String(M)]),Lo(S.i,"t",M),p.C=0,S=p.j.L,p.h=new as,p.g=Zu(p.j,S?x:null,!p.u),p.P>0&&(p.O=new Zt(m(p.Y,p,p.g),p.P)),x=p.V,S=p.g,M=p.ba;var J="readystatechange";Array.isArray(J)||(J&&(Oi[0]=J.toString()),J=Oi);for(let ee=0;ee<J.length;ee++){const ge=nt(S,J[ee],M||x.handleEvent,!1,x.h||x);if(!ge)break;x.g[ge.key]=ge}x=p.J?B(p.J):{},p.u?(p.v||(p.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,x)):(p.v="GET",p.g.ea(p.B,p.v,null,x)),Te(),Af(p.i,p.v,p.B,p.l,p.S,p.u)}os.prototype.ba=function(p){p=p.target;const x=this.O;x&&cs(p)==3?x.j():this.Y(p)},os.prototype.Y=function(p){try{if(p==this.g)e:{const qe=cs(this.g),kt=this.g.ya(),ot=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||an(this.g)))){this.K||qe!=4||kt==7||(kt==8||ot<=0?Te(3):Te(2)),Is(this);var x=this.g.ca();this.X=x;var S=Cf(this);if(this.o=x==200,Uu(this.i,this.v,this.B,this.l,this.S,qe,x),this.o){if(this.U&&!this.L){t:{if(this.g){var M,J=this.g;if((M=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(M)){var ee=M;break t}}ee=null}if(p=ee)Ss(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ns(this,p);else{this.o=!1,this.m=3,ut(12),Pn(this),Hn(this);break e}}if(this.R){p=!0;let At;for(;!this.K&&this.C<S.length;)if(At=Fu(this,S),At==en){qe==4&&(this.m=4,ut(14),p=!1),Ss(this.i,this.l,null,"[Incomplete Response]");break}else if(At==Ft){this.m=4,ut(15),Ss(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Ss(this.i,this.l,At,null),Ns(this,At);if(qu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,ut(16),p=!1),this.o=this.o&&p,!p)Ss(this.i,this.l,S,"[Invalid Chunked Response]"),Pn(this),Hn(this);else if(S.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),_l(ge),ge.P=!0,ut(11))}}else Ss(this.i,this.l,S,null),Ns(this,S);qe==4&&Pn(this),this.o&&!this.K&&(qe==4?Ku(this.j,this):(this.o=!1,ws(this)))}else ei(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,ut(12)):(this.m=0,ut(13)),Pn(this),Hn(this)}}}catch{}finally{}};function Cf(p){if(!qu(p))return p.g.la();const x=an(p.g);if(x==="")return"";let S="";const M=x.length,J=cs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Pn(p),Hn(p),"";p.h.i=new u.TextDecoder}for(let ee=0;ee<M;ee++)p.h.h=!0,S+=p.h.i.decode(x[ee],{stream:!(J&&ee==M-1)});return x.length=0,p.h.g+=S,p.C=0,p.h.g}function qu(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Fu(p,x){var S=p.C,M=x.indexOf(`
`,S);return M==-1?en:(S=Number(x.substring(S,M)),isNaN(S)?Ft:(M+=1,M+S>x.length?en:(x=x.slice(M,M+S),p.C=M+S,x)))}os.prototype.cancel=function(){this.K=!0,Pn(this)};function ws(p){p.T=Date.now()+p.H,Po(p,p.H)}function Po(p,x){if(p.D!=null)throw Error("WatchDog timer not null");p.D=hn(m(p.aa,p),x)}function Is(p){p.D&&(u.clearTimeout(p.D),p.D=null)}os.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(qr(this.i,this.B),this.M!=2&&(Te(),ut(17)),Pn(this),this.m=2,Hn(this)):Po(this,this.T-p)};function Hn(p){p.j.I==0||p.K||Ku(p.j,p)}function Pn(p){Is(p);var x=p.O;x&&typeof x.dispose=="function"&&x.dispose(),p.O=null,qi(p.V),p.g&&(x=p.g,p.g=null,x.abort(),x.dispose())}function Ns(p,x){try{var S=p.j;if(S.I!=0&&(S.g==p||Ms(S.h,p))){if(!p.L&&Ms(S.h,p)&&S.I==3){try{var M=S.Ba.g.parse(x)}catch{M=null}if(Array.isArray(M)&&M.length==3){var J=M;if(J[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)jo(S),Ji(S);else break e;Kr(S),ut(18)}}else S.xa=J[1],0<S.xa-S.K&&J[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=hn(m(S.Va,S),6e3));Rs(S.h)<=1&&S.ta&&(S.ta=void 0)}else Us(S,11)}else if((p.L||S.g==p)&&jo(S),!D(x))for(J=S.Ba.g.parse(x),x=0;x<J.length;x++){let ot=J[x];const At=ot[0];if(!(At<=S.K))if(S.K=At,ot=ot[1],S.I==2)if(ot[0]=="c"){S.M=ot[1],S.ba=ot[2];const $n=ot[3];$n!=null&&(S.ka=$n,S.j.info("VER="+S.ka));const Os=ot[4];Os!=null&&(S.za=Os,S.j.info("SVER="+S.za));const ds=ot[5];ds!=null&&typeof ds=="number"&&ds>0&&(M=1.5*ds,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const fs=p.g;if(fs){const Qr=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qr){var ee=M.h;ee.g||Qr.indexOf("spdy")==-1&&Qr.indexOf("quic")==-1&&Qr.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(ol(ee,ee.h),ee.h=null))}if(M.G){const Bo=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;Bo&&(M.wa=Bo,ct(M.J,M.G,Bo))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var ge=p;if(M.na=Wu(M,M.L?M.ba:null,M.W),ge.L){al(M.h,ge);var qe=ge,kt=M.O;kt&&(qe.H=kt),qe.D&&(Is(qe),ws(qe)),M.g=ge}else $u(M);S.i.length>0&&Ls(S)}else ot[0]!="stop"&&ot[0]!="close"||Us(S,7);else S.I==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?Us(S,7):gl(S):ot[0]!="noop"&&S.l&&S.l.qa(ot),S.A=0)}}Te(4)}catch{}}var jt=class{constructor(p,x){this.g=p,this.map=x}};function il(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function rl(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Rs(p){return p.h?1:p.g?p.g.size:0}function Ms(p,x){return p.h?p.h==x:p.g?p.g.has(x):!1}function ol(p,x){p.g?p.g.add(x):p.h=x}function al(p,x){p.h&&p.h==x?p.h=null:p.g&&p.g.has(x)&&p.g.delete(x)}il.prototype.cancel=function(){if(this.i=ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function ll(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let x=p.i;for(const S of p.g.values())x=x.concat(S.G);return x}return C(p.i)}var ju=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ko(p,x){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const M=p[S].indexOf("=");let J,ee=null;M>=0?(J=p[S].substring(0,M),ee=p[S].substring(M+1)):J=p[S],x(J,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function kn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;p instanceof kn?(this.l=p.l,tn(this,p.j),this.o=p.o,this.g=p.g,ji(this,p.u),this.h=p.h,ul(this,Gu(p.i)),this.m=p.m):p&&(x=String(p).match(ju))?(this.l=!1,tn(this,x[1]||"",!0),this.o=Ds(x[2]||""),this.g=Ds(x[3]||"",!0),ji(this,x[4]),this.h=Ds(x[5]||"",!0),ul(this,x[6]||"",!0),this.m=Ds(x[7]||"")):(this.l=!1,this.i=new zi(null,this.l))}kn.prototype.toString=function(){const p=[];var x=this.j;x&&p.push(zr(x,Vo,!0),":");var S=this.g;return(S||x=="file")&&(p.push("//"),(x=this.o)&&p.push(zr(x,Vo,!0),"@"),p.push(Ws(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(zr(S,S.charAt(0)=="/"?cl:Bu,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",zr(S,zu)),p.join("")},kn.prototype.resolve=function(p){const x=Bt(this);let S=!!p.j;S?tn(x,p.j):S=!!p.o,S?x.o=p.o:S=!!p.g,S?x.g=p.g:S=p.u!=null;var M=p.h;if(S)ji(x,p.u);else if(S=!!p.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var J=x.h.lastIndexOf("/");J!=-1&&(M=x.h.slice(0,J+1)+M)}if(J=M,J==".."||J==".")M="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){M=J.lastIndexOf("/",0)==0,J=J.split("/");const ee=[];for(let ge=0;ge<J.length;){const qe=J[ge++];qe=="."?M&&ge==J.length&&ee.push(""):qe==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),M&&ge==J.length&&ee.push("")):(ee.push(qe),M=!0)}M=ee.join("/")}else M=J}return S?x.h=M:S=p.i.toString()!=="",S?ul(x,Gu(p.i)):S=!!p.m,S&&(x.m=p.m),x};function Bt(p){return new kn(p)}function tn(p,x,S){p.j=S?Ds(x,!0):x,p.j&&(p.j=p.j.replace(/:$/,""))}function ji(p,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);p.u=x}else p.u=null}function ul(p,x,S){x instanceof zi?(p.i=x,Uo(p.i,p.l)):(S||(x=zr(x,Bi)),p.i=new zi(x,p.l))}function ct(p,x,S){p.i.set(x,S)}function Br(p){return ct(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Ds(p,x){return p?x?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function zr(p,x,S){return typeof p=="string"?(p=encodeURI(p).replace(x,Sn),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Sn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Vo=/[#\/\?@]/g,Bu=/[#\?:]/g,cl=/[#\?]/g,Bi=/[#\?@]/g,zu=/#/g;function zi(p,x){this.h=this.g=null,this.i=p||null,this.j=!!x}function Cn(p){p.g||(p.g=new Map,p.h=0,p.i&&ko(p.i,function(x,S){p.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}n=zi.prototype,n.add=function(p,x){Cn(this),this.i=null,p=Hi(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(x),this.h+=1,this};function Hu(p,x){Cn(p),x=Hi(p,x),p.g.has(x)&&(p.i=null,p.h-=p.g.get(x).length,p.g.delete(x))}function dl(p,x){return Cn(p),x=Hi(p,x),p.g.has(x)}n.forEach=function(p,x){Cn(this),this.g.forEach(function(S,M){S.forEach(function(J){p.call(x,J,M,this)},this)},this)};function fl(p,x){Cn(p);let S=[];if(typeof x=="string")dl(p,x)&&(S=S.concat(p.g.get(Hi(p,x))));else for(p=Array.from(p.g.values()),x=0;x<p.length;x++)S=S.concat(p[x]);return S}n.set=function(p,x){return Cn(this),this.i=null,p=Hi(this,p),dl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[x]),this.h+=1,this},n.get=function(p,x){return p?(p=fl(this,p),p.length>0?String(p[0]):x):x};function Lo(p,x,S){Hu(p,x),S.length>0&&(p.i=null,p.g.set(Hi(p,x),C(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],x=Array.from(this.g.keys());for(let M=0;M<x.length;M++){var S=x[M];const J=Ws(S);S=fl(this,S);for(let ee=0;ee<S.length;ee++){let ge=J;S[ee]!==""&&(ge+="="+Ws(S[ee])),p.push(ge)}}return this.i=p.join("&")};function Gu(p){const x=new zi;return x.i=p.i,p.g&&(x.g=new Map(p.g),x.h=p.h),x}function Hi(p,x){return x=String(x),p.j&&(x=x.toLowerCase()),x}function Uo(p,x){x&&!p.j&&(Cn(p),p.i=null,p.g.forEach(function(S,M){const J=M.toLowerCase();M!=J&&(Hu(this,M),Lo(this,J,S))},p)),p.j=x}function ls(p,x){const S=new ze;if(u.Image){const M=new Image;M.onload=T(Gn,S,"TestLoadImage: loaded",!0,x,M),M.onerror=T(Gn,S,"TestLoadImage: error",!1,x,M),M.onabort=T(Gn,S,"TestLoadImage: abort",!1,x,M),M.ontimeout=T(Gn,S,"TestLoadImage: timeout",!1,x,M),u.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else x(!1)}function hl(p,x){const S=new ze,M=new AbortController,J=setTimeout(()=>{M.abort(),Gn(S,"TestPingServer: timeout",!1,x)},1e4);fetch(p,{signal:M.signal}).then(ee=>{clearTimeout(J),ee.ok?Gn(S,"TestPingServer: ok",!0,x):Gn(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(J),Gn(S,"TestPingServer: error",!1,x)})}function Gn(p,x,S,M,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),M(S)}catch{}}function Gi(){this.g=new pe}function Ps(p){this.i=p.Sb||null,this.h=p.ab||!1}E(Ps,Se),Ps.prototype.g=function(){return new Hr(this.i,this.h)};function Hr(p,x){Nt.call(this),this.H=p,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(Hr,Nt),n=Hr.prototype,n.open=function(p,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=x,this.readyState=1,us(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(x.body=p),(this.H||u).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,us(this)),this.g&&(this.readyState=3,us(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Oo(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Oo(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var x=p.value?p.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!p.done}))&&(this.response=this.responseText+=x)}p.done?Yi(this):us(this),this.readyState==3&&Oo(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Yi(this))},n.Na=function(p){this.g&&(this.response=p,Yi(this))},n.ga=function(){this.g&&Yi(this)};function Yi(p){p.readyState=4,p.l=null,p.j=null,p.B=null,us(p)}n.setRequestHeader=function(p,x){this.A.append(p,x)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=x.next();return p.join(`\r
`)};function us(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Hr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Yn(p){let x="";return je(p,function(S,M){x+=M,x+=":",x+=S,x+=`\r
`}),x}function Gr(p,x,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=Yn(S),typeof p=="string"?S!=null&&Ws(S):ct(p,x,S))}function ht(p){Nt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(ht,Nt);var ks=/^https?$/i,ml=["POST","PUT"];n=ht.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,x,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);x=x?x.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():sl.g(),this.g.onreadystatechange=b(m(this.Ca,this));try{this.B=!0,this.g.open(x,String(p),!0),this.B=!1}catch(ee){Yr(this,ee);return}if(p=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var J in M)S.set(J,M[J]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ee of M.keys())S.set(ee,M.get(ee));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(ee=>ee.toLowerCase()=="content-type"),J=u.FormData&&p instanceof u.FormData,!(Array.prototype.indexOf.call(ml,x,void 0)>=0)||M||J||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,ge]of S)this.g.setRequestHeader(ee,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ee){Yr(this,ee)}};function Yr(p,x){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=x,p.o=5,pl(p),Zs(p)}function pl(p){p.A||(p.A=!0,Dt(p,"complete"),Dt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Dt(this,"complete"),Dt(this,"abort"),Zs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zs(this,!0)),ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?$r(this):this.Xa())},n.Xa=function(){$r(this)};function $r(p){if(p.h&&typeof l<"u"){if(p.v&&cs(p)==4)setTimeout(p.Ca.bind(p),0);else if(Dt(p,"readystatechange"),cs(p)==4){p.h=!1;try{const ee=p.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var M;if(M=ee===0){let ge=String(p.D).match(ju)[1]||null;!ge&&u.self&&u.self.location&&(ge=u.self.location.protocol.slice(0,-1)),M=!ks.test(ge?ge.toLowerCase():"")}S=M}if(S)Dt(p,"complete"),Dt(p,"success");else{p.o=6;try{var J=cs(p)>2?p.g.statusText:""}catch{J=""}p.l=J+" ["+p.ca()+"]",pl(p)}}finally{Zs(p)}}}}function Zs(p,x){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,x||Dt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function cs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var x=this.g.responseText;return p&&x.indexOf(p)==0&&(x=x.substring(p.length)),me(x)}};function an(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ei(p){const x={};p=(p.g&&cs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(D(p[M]))continue;var S=Ou(p[M]);const J=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ee=x[J]||[];x[J]=ee,ee.push(S)}We(x,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(p,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||x}function $i(p){this.za=0,this.i=[],this.j=new ze,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vs("baseRetryDelayMs",5e3,p),this.Za=Vs("retryDelaySeedMs",1e4,p),this.Ta=Vs("forwardChannelMaxRetries",2,p),this.va=Vs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new il(p&&p.concurrentRequestLimit),this.Ba=new Gi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$i.prototype,n.ka=8,n.I=1,n.connect=function(p,x,S,M){ut(0),this.W=p,this.H=x||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=Wu(this,null,this.W),Ls(this)};function gl(p){if(qo(p),p.I==3){var x=p.V++,S=Bt(p.J);if(ct(S,"SID",p.M),ct(S,"RID",x),ct(S,"TYPE","terminate"),Jr(p,S),x=new os(p,p.j,x),x.M=2,x.A=Br(Bt(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=x.A,S=!0),S||(x.g=Zu(x.j,null),x.g.ea(x.A)),x.F=Date.now(),ws(x)}Xu(p)}function Ji(p){p.g&&(_l(p),p.g.cancel(),p.g=null)}function qo(p){Ji(p),p.v&&(u.clearTimeout(p.v),p.v=null),jo(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&u.clearTimeout(p.m),p.m=null)}function Ls(p){if(!rl(p.h)&&!p.m){p.m=!0;var x=p.Ea;Z||w(),U||(Z(),U=!0),N.add(x,p),p.D=0}}function Fo(p,x){return Rs(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=x.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=hn(m(p.Ea,p,x),Qu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const J=new os(this,this.j,p);let ee=this.o;if(this.U&&(ee?(ee=B(ee),ye(ee,this.U)):ee=this.U),this.u!==null||this.R||(J.J=ee,ee=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(x+=M,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Yu(this,J,x),S=Bt(this.J),ct(S,"RID",p),ct(S,"CVER",22),this.G&&ct(S,"X-HTTP-Session-Id",this.G),Jr(this,S),ee&&(this.R?x="headers="+Ws(Yn(ee))+"&"+x:this.u&&Gr(S,this.u,ee)),ol(this.h,J),this.Ra&&ct(S,"TYPE","init"),this.S?(ct(S,"$req",x),ct(S,"SID","null"),J.U=!0,Cs(J,S,null)):Cs(J,S,x),this.I=2}}else this.I==3&&(p?yl(this,p):this.i.length==0||rl(this.h)||yl(this))};function yl(p,x){var S;x?S=x.l:S=p.V++;const M=Bt(p.J);ct(M,"SID",p.M),ct(M,"RID",S),ct(M,"AID",p.K),Jr(p,M),p.u&&p.o&&Gr(M,p.u,p.o),S=new os(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),x&&(p.i=x.G.concat(p.i)),x=Yu(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ol(p.h,S),Cs(S,M,x)}function Jr(p,x){p.H&&je(p.H,function(S,M){ct(x,M,S)}),p.l&&je({},function(S,M){ct(x,M,S)})}function Yu(p,x,S){S=Math.min(p.i.length,S);const M=p.l?m(p.l.Ka,p.l,p):null;e:{var J=p.i;let qe=-1;for(;;){const kt=["count="+S];qe==-1?S>0?(qe=J[0].g,kt.push("ofs="+qe)):qe=0:kt.push("ofs="+qe);let ot=!0;for(let At=0;At<S;At++){var ee=J[At].g;const $n=J[At].map;if(ee-=qe,ee<0)qe=Math.max(0,J[At].g-100),ot=!1;else try{ee="req"+ee+"_"||"";try{var ge=$n instanceof Map?$n:Object.entries($n);for(const[Os,ds]of ge){let fs=ds;d(ds)&&(fs=K(ds)),kt.push(ee+Os+"="+encodeURIComponent(fs))}}catch(Os){throw kt.push(ee+"type="+encodeURIComponent("_badmap")),Os}}catch{M&&M($n)}}if(ot){ge=kt.join("&");break e}}ge=void 0}return p=p.i.splice(0,S),x.G=p,ge}function $u(p){if(!p.g&&!p.v){p.Y=1;var x=p.Da;Z||w(),U||(Z(),U=!0),N.add(x,p),p.A=0}}function Kr(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=hn(m(p.Da,p),Qu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Ju(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=hn(m(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ut(10),Ji(this),Ju(this))};function _l(p){p.B!=null&&(u.clearTimeout(p.B),p.B=null)}function Ju(p){p.g=new os(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var x=Bt(p.na);ct(x,"RID","rpc"),ct(x,"SID",p.M),ct(x,"AID",p.K),ct(x,"CI",p.F?"0":"1"),!p.F&&p.ia&&ct(x,"TO",p.ia),ct(x,"TYPE","xmlhttp"),Jr(p,x),p.u&&p.o&&Gr(x,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Br(Bt(x)),S.u=null,S.R=!0,Do(S,p)}n.Va=function(){this.C!=null&&(this.C=null,Ji(this),Kr(this),ut(19))};function jo(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Ku(p,x){var S=null;if(p.g==x){jo(p),_l(p),p.g=null;var M=2}else if(Ms(p.h,x))S=x.G,al(p.h,x),M=1;else return;if(p.I!=0){if(x.o)if(M==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var J=p.D;M=Fi(),Dt(M,new Pt(M,S)),Ls(p)}else $u(p);else if(J=x.m,J==3||J==0&&x.X>0||!(M==1&&Fo(p,x)||M==2&&Kr(p)))switch(S&&S.length>0&&(x=p.h,x.i=x.i.concat(S)),J){case 1:Us(p,5);break;case 4:Us(p,10);break;case 3:Us(p,6);break;default:Us(p,2)}}}function Qu(p,x){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*x}function Us(p,x){if(p.j.info("Error code "+x),x==2){var S=m(p.bb,p),M=p.Ua;const J=!M;M=new kn(M||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||tn(M,"https"),Br(M),J?ls(M.toString(),S):hl(M.toString(),S)}else ut(2);p.I=0,p.l&&p.l.pa(x),Xu(p),qo(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function Xu(p){if(p.I=0,p.ja=[],p.l){const x=ll(p.h);(x.length!=0||p.i.length!=0)&&(P(p.ja,x),P(p.ja,p.i),p.h.i.length=0,C(p.i),p.i.length=0),p.l.oa()}}function Wu(p,x,S){var M=S instanceof kn?Bt(S):new kn(S);if(M.g!="")x&&(M.g=x+"."+M.g),ji(M,M.u);else{var J=u.location;M=J.protocol,x=x?x+"."+J.hostname:J.hostname,J=+J.port;const ee=new kn(null);M&&tn(ee,M),x&&(ee.g=x),J&&ji(ee,J),S&&(ee.h=S),M=ee}return S=p.G,x=p.wa,S&&x&&ct(M,S,x),ct(M,"VER",p.ka),Jr(p,M),M}function Zu(p,x,S){if(x&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=p.Aa&&!p.ma?new ht(new Ps({ab:S})):new ht(p.ma),x.Fa(p.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ec(){}n=ec.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ki(){}Ki.prototype.g=function(p,x){return new En(p,x)};function En(p,x){Nt.call(this),this.g=new $i(x),this.l=p,this.h=x&&x.messageUrlParams||null,p=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(p?p["X-WebChannel-Content-Type"]=x.messageContentType:p={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(p?p["X-WebChannel-Client-Profile"]=x.sa:p={"X-WebChannel-Client-Profile":x.sa}),this.g.U=p,(p=x&&x.Qb)&&!D(p)&&(this.g.u=p),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!D(x)&&(this.g.G=x,p=this.h,p!==null&&x in p&&(p=this.h,x in p&&delete p[x])),this.j=new ti(this)}E(En,Nt),En.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){gl(this.g)},En.prototype.o=function(p){var x=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=K(p),p=S);x.i.push(new jt(x.Ya++,p)),x.I==3&&Ls(x)},En.prototype.N=function(){this.g.l=null,delete this.j,gl(this.g),delete this.g,En.Z.N.call(this)};function tc(p){qt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var x=p.__sm__;if(x){e:{for(const S in x){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,x=x!==null&&p in x?x[p]:void 0),this.data=x}else this.data=p}E(tc,qt);function nc(){Tn.call(this),this.status=1}E(nc,Tn);function ti(p){this.g=p}E(ti,ec),ti.prototype.ra=function(){Dt(this.g,"a")},ti.prototype.qa=function(p){Dt(this.g,new tc(p))},ti.prototype.pa=function(p){Dt(this.g,new nc)},ti.prototype.oa=function(){Dt(this.g,"b")},Ki.prototype.createWebChannel=Ki.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,Ox=function(){return new Ki},Ux=function(){return Fi()},Lx=wt,rp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fr.NO_ERROR=0,Fr.TIMEOUT=8,Fr.HTTP_ERROR=6,yd=Fr,nl.COMPLETE="complete",Vx=nl,Ve.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,au=Ve,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,kx=ht}).apply(typeof ad<"u"?ad:typeof self<"u"?self:typeof window<"u"?window:{});const AT="@firebase/firestore",ST="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new Pp("@firebase/firestore");function _a(){return vo.logLevel}function Ee(n,...e){if(vo.logLevel<=Je.DEBUG){const t=e.map(Lp);vo.debug(`Firestore (${Qa}): ${n}`,...t)}}function Ri(n,...e){if(vo.logLevel<=Je.ERROR){const t=e.map(Lp);vo.error(`Firestore (${Qa}): ${n}`,...t)}}function To(n,...e){if(vo.logLevel<=Je.WARN){const t=e.map(Lp);vo.warn(`Firestore (${Qa}): ${n}`,...t)}}function Lp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,qx(n,i,t)}function qx(n,e,t){let i=`FIRESTORE (${Qa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ri(i),new Error(i)}function lt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||qx(e,o,i)}function Oe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gn.UNAUTHENTICATED)))}shutdown(){}}class x2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class b2{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lt(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ci,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},d=g=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>d(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?d(g):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ci)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(lt(typeof i.accessToken=="string",31837,{l:i}),new Fx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new gn(e)}}class A2{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class S2{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new A2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class CT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class C2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ns(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lt(this.o===void 0,3512);const i=l=>{l.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Ee("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const o=l=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new CT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new CT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=w2(40);for(let l=0;l<o.length;++l)i.length<20&&o[l]<t&&(i+=e.charAt(o[l]%62))}return i}}function Ke(n,e){return n<e?-1:n>e?1:0}function op(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),l=e.charAt(i);if(o!==l)return Pm(o)===Pm(l)?Ke(o,l):Pm(o)?1:-1}return Ke(n.length,e.length)}const I2=55296,N2=57343;function Pm(n){const e=n.charCodeAt(0);return e>=I2&&e<=N2}function Va(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="__name__";class zs{constructor(e,t,i){t===void 0?t=0:t>e.length&&De(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&De(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return zs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const l=zs.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return Ke(e.length,t.length)}static compareSegments(e,t){const i=zs.isNumericId(e),o=zs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?zs.extractNumericId(e).compare(zs.extractNumericId(t)):op(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ar.fromString(e.substring(4,e.length-2))}}class bt extends zs{construct(e,t,i){return new bt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new bt(t)}static emptyPath(){return new bt([])}}const R2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rn extends zs{construct(e,t,i){return new rn(e,t,i)}static isValidIdentifier(e){return R2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===wT}static keyField(){return new rn([wT])}static fromServerFormat(e){const t=[];let i="",o=0;const l=()=>{if(i.length===0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ce(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ce(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else d==="`"?(u=!u,o++):d!=="."||u?(i+=d,o++):(l(),o++)}if(l(),u)throw new Ce(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rn(t)}static emptyPath(){return new rn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(bt.fromString(e))}static fromName(e){return new Ne(bt.fromString(e).popFirst(5))}static empty(){return new Ne(bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return bt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new bt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(n,e,t){if(!t)throw new Ce(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zx(n,e,t,i){if(e===!0&&i===!0)throw new Ce(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IT(n){if(!Ne.isDocumentKey(n))throw new Ce(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function NT(n){if(Ne.isDocumentKey(n))throw new Ce(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Up(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":De(12329,{type:typeof n})}function Mi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Up(n);throw new Ce(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(n,e){const t={typeString:n};return e&&(t.value=e),t}function wu(n,e){if(!Hx(n))throw new Ce(ue.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(o&&typeof u!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Ce(ue.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=-62135596800,MT=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*MT);return new _t(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RT)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MT}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wu(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Jt("string",_t._jsonSchemaVersion),seconds:Jt("number"),nanoseconds:Jt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new _t(0,0))}static max(){return new Pe(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=-1;function M2(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Pe.fromTimestamp(i===1e9?new _t(t+1,0):new _t(t,i));return new Cr(o,Ne.empty(),e)}function D2(n){return new Cr(n.readTime,n.key,vu)}class Cr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Cr(Pe.min(),Ne.empty(),vu)}static max(){return new Cr(Pe.max(),Ne.empty(),vu)}}function P2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:Ke(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xa(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==k2)throw n;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&De(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((i,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,i)=>{t(e)}))}static reject(e){return new le(((t,i)=>{i(e)}))}static waitFor(e){return new le(((t,i)=>{let o=0,l=0,u=!1;e.forEach((d=>{++o,d.next((()=>{++l,u&&l===o&&t()}),(g=>i(g)))})),u=!0,l===o&&t()}))}static or(e){let t=le.resolve(!1);for(const i of e)t=t.next((o=>o?le.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,l)=>{i.push(t.call(this,o,l))})),this.waitFor(i)}static mapArray(e,t){return new le(((i,o)=>{const l=e.length,u=new Array(l);let d=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((T=>{u[m]=T,++d,d===l&&i(u)}),(T=>o(T)))}}))}static doWhile(e,t){return new le(((i,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):i()};l()}))}}function L2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Wa(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op=-1;function sf(n){return n==null}function Dd(n){return n===0&&1/n==-1/0}function U2(n){return typeof n=="number"&&Number.isInteger(n)&&!Dd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx="";function O2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=DT(e)),e=q2(n.get(t),e);return DT(e)}function q2(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case Gx:t+="";break;default:t+=l}}return t}function DT(n){return n+Gx+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ao(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Yx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t){this.comparator=e,this.root=t||fn.EMPTY}insert(e,t){return new It(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ld(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ld(this.root,e,this.comparator,!1)}getReverseIterator(){return new ld(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ld(this.root,e,this.comparator,!0)}}class ld{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fn{constructor(e,t,i,o,l){this.key=e,this.value=t,this.color=i??fn.RED,this.left=o??fn.EMPTY,this.right=l??fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,l){return new fn(e??this.key,t??this.value,i??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const l=i(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,i),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return fn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw De(43730,{key:this.key,value:this.value});if(this.right.isRed())throw De(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw De(27949);return e+(this.isRed()?0:1)}}fn.EMPTY=null,fn.RED=!0,fn.BLACK=!1;fn.EMPTY=new class{constructor(){this.size=0}get key(){throw De(57766)}get value(){throw De(16141)}get color(){throw De(16727)}get left(){throw De(29726)}get right(){throw De(36894)}copy(e,t,i,o,l){return this}insert(e,t,i){return new fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kT(this.data.getIterator())}getIteratorFrom(e){return new kT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Wt(this.comparator);return t.data=e,t}}class kT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.fields=e,e.sort(rn.comparator)}static empty(){return new ys([])}unionWith(e){let t=new Wt(rn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ys(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Va(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new $x("Invalid base64 string: "+l):l}})(e);return new on(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let u=0;u<o.length;++u)l+=String.fromCharCode(o[u]);return l})(e);return new on(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}on.EMPTY_BYTE_STRING=new on("");const F2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(n){if(lt(!!n,39018),typeof n=="string"){let e=0;const t=F2.exec(n);if(lt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ut(n.seconds),nanos:Ut(n.nanos)}}function Ut(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ir(n){return typeof n=="string"?on.fromBase64String(n):on.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx="server_timestamp",Kx="__type__",Qx="__previous_value__",Xx="__local_write_time__";function qp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Kx])==null?void 0:i.stringValue)===Jx}function rf(n){const e=n.mapValue.fields[Qx];return qp(e)?rf(e):e}function Tu(n){const e=wr(n.mapValue.fields[Xx].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,t,i,o,l,u,d,g,m,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=T}}const Pd="(default)";class La{constructor(e,t){this.projectId=e,this.database=t||Pd}static empty(){return new La("","")}get isDefaultDatabase(){return this.database===Pd}isEqual(e){return e instanceof La&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="__type__",B2="__max__",ud={mapValue:{}},Zx="__vector__",kd="value";function Nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qp(n)?4:H2(n)?9007199254740991:z2(n)?10:11:De(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Nr(n);if(t!==Nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tu(n).isEqual(Tu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const u=wr(o.timestampValue),d=wr(l.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return Ir(o.bytesValue).isEqual(Ir(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return Ut(o.geoPointValue.latitude)===Ut(l.geoPointValue.latitude)&&Ut(o.geoPointValue.longitude)===Ut(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return Ut(o.integerValue)===Ut(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const u=Ut(o.doubleValue),d=Ut(l.doubleValue);return u===d?Dd(u)===Dd(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return Va(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return(function(o,l){const u=o.mapValue.fields||{},d=l.mapValue.fields||{};if(PT(u)!==PT(d))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(d[g]===void 0||!Ks(u[g],d[g])))return!1;return!0})(n,e);default:return De(52216,{left:n})}}function Eu(n,e){return(n.values||[]).find((t=>Ks(t,e)))!==void 0}function Ua(n,e){if(n===e)return 0;const t=Nr(n),i=Nr(e);if(t!==i)return Ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const d=Ut(l.integerValue||l.doubleValue),g=Ut(u.integerValue||u.doubleValue);return d<g?-1:d>g?1:d===g?0:isNaN(d)?isNaN(g)?0:-1:1})(n,e);case 3:return VT(n.timestampValue,e.timestampValue);case 4:return VT(Tu(n),Tu(e));case 5:return op(n.stringValue,e.stringValue);case 6:return(function(l,u){const d=Ir(l),g=Ir(u);return d.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const d=l.split("/"),g=u.split("/");for(let m=0;m<d.length&&m<g.length;m++){const T=Ke(d[m],g[m]);if(T!==0)return T}return Ke(d.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const d=Ke(Ut(l.latitude),Ut(u.latitude));return d!==0?d:Ke(Ut(l.longitude),Ut(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return LT(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var b,C,P,O;const d=l.fields||{},g=u.fields||{},m=(b=d[kd])==null?void 0:b.arrayValue,T=(C=g[kd])==null?void 0:C.arrayValue,E=Ke(((P=m==null?void 0:m.values)==null?void 0:P.length)||0,((O=T==null?void 0:T.values)==null?void 0:O.length)||0);return E!==0?E:LT(m,T)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===ud.mapValue&&u===ud.mapValue)return 0;if(l===ud.mapValue)return 1;if(u===ud.mapValue)return-1;const d=l.fields||{},g=Object.keys(d),m=u.fields||{},T=Object.keys(m);g.sort(),T.sort();for(let E=0;E<g.length&&E<T.length;++E){const b=op(g[E],T[E]);if(b!==0)return b;const C=Ua(d[g[E]],m[T[E]]);if(C!==0)return C}return Ke(g.length,T.length)})(n.mapValue,e.mapValue);default:throw De(23264,{he:t})}}function VT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ke(n,e);const t=wr(n),i=wr(e),o=Ke(t.seconds,i.seconds);return o!==0?o:Ke(t.nanos,i.nanos)}function LT(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const l=Ua(t[o],i[o]);if(l)return l}return Ke(t.length,i.length)}function Oa(n){return ap(n)}function ap(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=wr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ir(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ne.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const l of t.values||[])o?o=!1:i+=",",i+=ap(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const u of i)l?l=!1:o+=",",o+=`${u}:${ap(t.fields[u])}`;return o+"}"})(n.mapValue):De(61005,{value:n})}function _d(n){switch(Nr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rf(n);return e?16+_d(e):16;case 5:return 2*n.stringValue.length;case 6:return Ir(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,l)=>o+_d(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Ao(i.fields,((l,u)=>{o+=l.length+_d(u)})),o})(n.mapValue);default:throw De(13486,{value:n})}}function lp(n){return!!n&&"integerValue"in n}function Fp(n){return!!n&&"arrayValue"in n}function UT(n){return!!n&&"nullValue"in n}function OT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vd(n){return!!n&&"mapValue"in n}function z2(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Wx])==null?void 0:i.stringValue)===Zx}function fu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ao(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=fu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fu(n.arrayValue.values[t]);return e}return{...n}}function H2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===B2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.value=e}static empty(){return new ss({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!vd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fu(t)}setAll(e){let t=rn.emptyPath(),i={},o=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const g=this.getFieldsMap(t);this.applyChanges(g,i,o),i={},o=[],t=d.popLast()}u?i[d.lastSegment()]=fu(u):o.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,o)}delete(e){const t=this.field(e.popLast());vd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];vd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Ao(t,((o,l)=>e[o]=l));for(const o of i)delete e[o]}clone(){return new ss(fu(this.value))}}function eb(n){const e=[];return Ao(n.fields,((t,i)=>{const o=new rn([t]);if(vd(i)){const l=eb(i.mapValue).fields;if(l.length===0)e.push(o);else for(const u of l)e.push(o.child(u))}else e.push(o)})),new ys(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,t,i,o,l,u,d){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=l,this.data=u,this.documentState=d}static newInvalidDocument(e){return new yn(e,0,Pe.min(),Pe.min(),Pe.min(),ss.empty(),0)}static newFoundDocument(e,t,i,o){return new yn(e,1,t,Pe.min(),i,o,0)}static newNoDocument(e,t){return new yn(e,2,t,Pe.min(),Pe.min(),ss.empty(),0)}static newUnknownDocument(e,t){return new yn(e,3,t,Pe.min(),Pe.min(),ss.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e,t){this.position=e,this.inclusive=t}}function qT(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const l=e[o],u=n.position[o];if(l.field.isKeyField()?i=Ne.comparator(Ne.fromName(u.referenceValue),t.key):i=Ua(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function FT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t="asc"){this.field=e,this.dir=t}}function G2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{}class Xt extends tb{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new $2(e,t,i):t==="array-contains"?new Q2(e,i):t==="in"?new X2(e,i):t==="not-in"?new W2(e,i):t==="array-contains-any"?new Z2(e,i):new Xt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new J2(e,i):new K2(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ua(t,this.value)):t!==null&&Nr(this.value)===Nr(t)&&this.matchesComparison(Ua(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return De(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qs extends tb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qs(e,t)}matches(e){return nb(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function nb(n){return n.op==="and"}function sb(n){return Y2(n)&&nb(n)}function Y2(n){for(const e of n.filters)if(e instanceof Qs)return!1;return!0}function up(n){if(n instanceof Xt)return n.field.canonicalString()+n.op.toString()+Oa(n.value);if(sb(n))return n.filters.map((e=>up(e))).join(",");{const e=n.filters.map((t=>up(t))).join(",");return`${n.op}(${e})`}}function ib(n,e){return n instanceof Xt?(function(i,o){return o instanceof Xt&&i.op===o.op&&i.field.isEqual(o.field)&&Ks(i.value,o.value)})(n,e):n instanceof Qs?(function(i,o){return o instanceof Qs&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((l,u,d)=>l&&ib(u,o.filters[d])),!0):!1})(n,e):void De(19439)}function rb(n){return n instanceof Xt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Oa(t.value)}`})(n):n instanceof Qs?(function(t){return t.op.toString()+" {"+t.getFilters().map(rb).join(" ,")+"}"})(n):"Filter"}class $2 extends Xt{constructor(e,t,i){super(e,t,i),this.key=Ne.fromName(i.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class J2 extends Xt{constructor(e,t){super(e,"in",t),this.keys=ob("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class K2 extends Xt{constructor(e,t){super(e,"not-in",t),this.keys=ob("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ob(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ne.fromName(i.referenceValue)))}class Q2 extends Xt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Fp(t)&&Eu(t.arrayValue,this.value)}}class X2 extends Xt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Eu(this.value.arrayValue,t)}}class W2 extends Xt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Eu(this.value.arrayValue,t)}}class Z2 extends Xt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Fp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Eu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,t=null,i=[],o=[],l=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=l,this.startAt=u,this.endAt=d,this.Te=null}}function jT(n,e=null,t=[],i=[],o=null,l=null,u=null){return new eP(n,e,t,i,o,l,u)}function jp(n){const e=Oe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>up(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Oa(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Oa(i))).join(",")),e.Te=t}return e.Te}function Bp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!G2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ib(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!FT(n.startAt,e.startAt)&&FT(n.endAt,e.endAt)}function cp(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t=null,i=[],o=[],l=null,u="F",d=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=l,this.limitType=u,this.startAt=d,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tP(n,e,t,i,o,l,u,d){return new of(n,e,t,i,o,l,u,d)}function zp(n){return new of(n)}function BT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nP(n){return n.collectionGroup!==null}function hu(n){const e=Oe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Wt(rn.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ld(l,i))})),t.has(rn.keyField().canonicalString())||e.Ie.push(new Ld(rn.keyField(),i))}return e.Ie}function Hs(n){const e=Oe(n);return e.Ee||(e.Ee=sP(e,hu(n))),e.Ee}function sP(n,e){if(n.limitType==="F")return jT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Ld(o.field,l)}));const t=n.endAt?new Vd(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Vd(n.startAt.position,n.startAt.inclusive):null;return jT(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function dp(n,e,t){return new of(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function af(n,e){return Bp(Hs(n),Hs(e))&&n.limitType===e.limitType}function ab(n){return`${jp(Hs(n))}|lt:${n.limitType}`}function va(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>rb(o))).join(", ")}]`),sf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Oa(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Oa(o))).join(",")),`Target(${i})`})(Hs(n))}; limitType=${n.limitType})`}function lf(n,e){return e.isFoundDocument()&&(function(i,o){const l=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ne.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,o){for(const l of hu(i))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const l of i.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(u,d,g){const m=qT(u,d,g);return u.inclusive?m<=0:m<0})(i.startAt,hu(i),o)||i.endAt&&!(function(u,d,g){const m=qT(u,d,g);return u.inclusive?m>=0:m>0})(i.endAt,hu(i),o))})(n,e)}function iP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function lb(n){return(e,t)=>{let i=!1;for(const o of hu(n)){const l=rP(o,e,t);if(l!==0)return l;i=i||o.field.isKeyField()}return 0}}function rP(n,e,t){const i=n.field.isKeyField()?Ne.comparator(e.key,t.key):(function(l,u,d){const g=u.data.field(l),m=d.data.field(l);return g!==null&&m!==null?Ua(g,m):De(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return De(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,l]of i)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,((t,i)=>{for(const[o,l]of i)e(o,l)}))}isEmpty(){return Yx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=new It(Ne.comparator);function Di(){return oP}const ub=new It(Ne.comparator);function lu(...n){let e=ub;for(const t of n)e=e.insert(t.key,t);return e}function cb(n){let e=ub;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function mo(){return mu()}function db(){return mu()}function mu(){return new So((n=>n.toString()),((n,e)=>n.isEqual(e)))}const aP=new It(Ne.comparator),lP=new Wt(Ne.comparator);function Qe(...n){let e=lP;for(const t of n)e=e.add(t);return e}const uP=new Wt(Ke);function cP(){return uP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dd(e)?"-0":e}}function fb(n){return{integerValue:""+n}}function dP(n,e){return U2(e)?fb(e):Hp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(){this._=void 0}}function fP(n,e,t){return n instanceof Ud?(function(o,l){const u={fields:{[Kx]:{stringValue:Jx},[Xx]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&qp(l)&&(l=rf(l)),l&&(u.fields[Qx]=l),{mapValue:u}})(t,e):n instanceof xu?mb(n,e):n instanceof bu?pb(n,e):(function(o,l){const u=hb(o,l),d=zT(u)+zT(o.Ae);return lp(u)&&lp(o.Ae)?fb(d):Hp(o.serializer,d)})(n,e)}function hP(n,e,t){return n instanceof xu?mb(n,e):n instanceof bu?pb(n,e):t}function hb(n,e){return n instanceof Od?(function(i){return lp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Ud extends uf{}class xu extends uf{constructor(e){super(),this.elements=e}}function mb(n,e){const t=gb(e);for(const i of n.elements)t.some((o=>Ks(o,i)))||t.push(i);return{arrayValue:{values:t}}}class bu extends uf{constructor(e){super(),this.elements=e}}function pb(n,e){let t=gb(e);for(const i of n.elements)t=t.filter((o=>!Ks(o,i)));return{arrayValue:{values:t}}}class Od extends uf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function zT(n){return Ut(n.integerValue||n.doubleValue)}function gb(n){return Fp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function mP(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof xu&&o instanceof xu||i instanceof bu&&o instanceof bu?Va(i.elements,o.elements,Ks):i instanceof Od&&o instanceof Od?Ks(i.Ae,o.Ae):i instanceof Ud&&o instanceof Ud})(n.transform,e.transform)}class pP{constructor(e,t){this.version=e,this.transformResults=t}}class Gs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gs}static exists(e){return new Gs(void 0,e)}static updateTime(e){return new Gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Td(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class cf{}function yb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Gp(n.key,Gs.none()):new Iu(n.key,n.data,Gs.none());{const t=n.data,i=ss.empty();let o=new Wt(rn.comparator);for(let l of e.fields)if(!o.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),o=o.add(l)}return new Co(n.key,i,new ys(o.toArray()),Gs.none())}}function gP(n,e,t){n instanceof Iu?(function(o,l,u){const d=o.value.clone(),g=GT(o.fieldTransforms,l,u.transformResults);d.setAll(g),l.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Co?(function(o,l,u){if(!Td(o.precondition,l))return void l.convertToUnknownDocument(u.version);const d=GT(o.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(_b(o)),g.setAll(d),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(o,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function pu(n,e,t,i){return n instanceof Iu?(function(l,u,d,g){if(!Td(l.precondition,u))return d;const m=l.value.clone(),T=YT(l.fieldTransforms,g,u);return m.setAll(T),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Co?(function(l,u,d,g){if(!Td(l.precondition,u))return d;const m=YT(l.fieldTransforms,g,u),T=u.data;return T.setAll(_b(l)),T.setAll(m),u.convertToFoundDocument(u.version,T).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(l,u,d){return Td(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function yP(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),l=hb(i.transform,o||null);l!=null&&(t===null&&(t=ss.empty()),t.set(i.field,l))}return t||null}function HT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Va(i,o,((l,u)=>mP(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Iu extends cf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Co extends cf{constructor(e,t,i,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function _b(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function GT(n,e,t){const i=new Map;lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],u=l.transform,d=e.data.field(l.field);i.set(l.field,hP(u,d,t[o]))}return i}function YT(n,e,t){const i=new Map;for(const o of n){const l=o.transform,u=t.data.field(o.field);i.set(o.field,fP(l,u,e))}return i}class Gp extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _P extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&gP(l,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=pu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=db();return this.mutations.forEach((o=>{const l=e.get(o.key),u=l.overlayedDocument;let d=this.applyToLocalView(u,l.mutatedFields);d=t.has(o.key)?null:d;const g=yb(u,d);g!==null&&i.set(o.key,g),u.isValidDocument()||u.convertToNoDocument(Pe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Qe())}isEqual(e){return this.batchId===e.batchId&&Va(this.mutations,e.mutations,((t,i)=>HT(t,i)))&&Va(this.baseMutations,e.baseMutations,((t,i)=>HT(t,i)))}}class Yp{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){lt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return aP})();const l=e.mutations;for(let u=0;u<l.length;u++)o=o.insert(l[u].key,i[u].version);return new Yp(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t,tt;function xP(n){switch(n){case ue.OK:return De(64938);case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0;default:return De(15467,{code:n})}}function vb(n){if(n===void 0)return Ri("GRPC error has no .code"),ue.UNKNOWN;switch(n){case $t.OK:return ue.OK;case $t.CANCELLED:return ue.CANCELLED;case $t.UNKNOWN:return ue.UNKNOWN;case $t.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case $t.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case $t.INTERNAL:return ue.INTERNAL;case $t.UNAVAILABLE:return ue.UNAVAILABLE;case $t.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case $t.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case $t.NOT_FOUND:return ue.NOT_FOUND;case $t.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case $t.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case $t.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case $t.ABORTED:return ue.ABORTED;case $t.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case $t.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case $t.DATA_LOSS:return ue.DATA_LOSS;default:return De(39323,{code:n})}}(tt=$t||($t={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=new Ar([4294967295,4294967295],0);function $T(n){const e=bP().encode(n),t=new Px;return t.update(e),new Uint8Array(t.digest())}function JT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Ar([t,i],0),new Ar([o,l],0)]}class $p{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new uu(`Invalid padding: ${t}`);if(i<0)throw new uu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new uu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new uu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ar.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Ar.fromNumber(i)));return o.compare(AP)===1&&(o=new Ar([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=$T(e),[i,o]=JT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new $p(l,o,t);return i.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=$T(e),[i,o]=JT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class uu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,t,i,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new df(Pe.min(),o,new It(Ke),Di(),Qe())}}class Nu{constructor(e,t,i,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Nu(i,t,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class Tb{constructor(e,t){this.targetId=e,this.Ce=t}}class Eb{constructor(e,t,i=on.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class KT{constructor(){this.ve=0,this.Fe=QT(),this.Me=on.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Qe(),t=Qe(),i=Qe();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:De(38017,{changeType:l})}})),new Nu(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=QT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class SP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Di(),this.Je=cd(),this.He=cd(),this.Ye=new It(Ke)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:De(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(cp(l))if(i===0){const u=new Ne(l.path);this.et(t,u,yn.newNoDocument(u,Pe.min()))}else lt(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const d=this.ut(e),g=d?this.ct(d,e,u):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:l=0}=t;let u,d;try{u=Ir(i).toUint8Array()}catch(g){if(g instanceof $x)return To("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{d=new $p(u,o,l)}catch(g){return To(g instanceof uu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((l=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const d=this.ot(u);if(d){if(l.current&&cp(d.target)){const g=new Ne(d.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,yn.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let i=Qe();this.He.forEach(((l,u)=>{let d=!0;u.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const o=new df(e,t,this.Ye,this.je,i);return this.je=Di(),this.Je=cd(),this.He=cd(),this.Ye=new It(Ke),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new KT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Wt(Ke),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Wt(Ke),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ee("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new KT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function cd(){return new It(Ne.comparator)}function QT(){return new It(Ne.comparator)}const CP={asc:"ASCENDING",desc:"DESCENDING"},wP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IP={and:"AND",or:"OR"};class NP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fp(n,e){return n.useProto3Json||sf(e)?e:{value:e}}function qd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RP(n,e){return qd(n,e.toTimestamp())}function Ys(n){return lt(!!n,49232),Pe.fromTimestamp((function(t){const i=wr(t);return new _t(i.seconds,i.nanos)})(n))}function Jp(n,e){return hp(n,e).canonicalString()}function hp(n,e){const t=(function(o){return new bt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function bb(n){const e=bt.fromString(n);return lt(Ib(e),10190,{key:e.toString()}),e}function mp(n,e){return Jp(n.databaseId,e.path)}function km(n,e){const t=bb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(Sb(t))}function Ab(n,e){return Jp(n.databaseId,e)}function MP(n){const e=bb(n);return e.length===4?bt.emptyPath():Sb(e)}function pp(n){return new bt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Sb(n){return lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function XT(n,e,t){return{name:mp(n,e),fields:t.value.mapValue.fields}}function DP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:De(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(m,T){return m.useProto3Json?(lt(T===void 0||typeof T=="string",58123),on.fromBase64String(T||"")):(lt(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),on.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(m){const T=m.code===void 0?ue.UNKNOWN:vb(m.code);return new Ce(T,m.message||"")})(u);t=new Eb(i,o,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=km(n,i.document.name),l=Ys(i.document.updateTime),u=i.document.createTime?Ys(i.document.createTime):Pe.min(),d=new ss({mapValue:{fields:i.document.fields}}),g=yn.newFoundDocument(o,l,u,d),m=i.targetIds||[],T=i.removedTargetIds||[];t=new Ed(m,T,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=km(n,i.document),l=i.readTime?Ys(i.readTime):Pe.min(),u=yn.newNoDocument(o,l),d=i.removedTargetIds||[];t=new Ed([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=km(n,i.document),l=i.removedTargetIds||[];t=new Ed([],l,o,null)}else{if(!("filter"in e))return De(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:l}=i,u=new EP(o,l),d=i.targetId;t=new Tb(d,u)}}return t}function PP(n,e){let t;if(e instanceof Iu)t={update:XT(n,e.key,e.value)};else if(e instanceof Gp)t={delete:mp(n,e.key)};else if(e instanceof Co)t={update:XT(n,e.key,e.data),updateMask:BP(e.fieldMask)};else{if(!(e instanceof _P))return De(16599,{Vt:e.type});t={verify:mp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const d=u.transform;if(d instanceof Ud)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof xu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof bu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Od)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw De(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:RP(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:De(27497)})(n,e.precondition)),t}function kP(n,e){return n&&n.length>0?(lt(e!==void 0,14353),n.map((t=>(function(o,l){let u=o.updateTime?Ys(o.updateTime):Ys(l);return u.isEqual(Pe.min())&&(u=Ys(l)),new pP(u,o.transformResults||[])})(t,e)))):[]}function VP(n,e){return{documents:[Ab(n,e.path)]}}function LP(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Ab(n,o);const l=(function(m){if(m.length!==0)return wb(Qs.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((T=>(function(b){return{field:Ta(b.field),direction:qP(b.dir)}})(T)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=fp(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:o}}function UP(n){let e=MP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){lt(i===1,65062);const T=t.from[0];T.allDescendants?o=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(E){const b=Cb(E);return b instanceof Qs&&sb(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((b=>(function(P){return new Ld(Ea(P.field),(function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(b)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let b;return b=typeof E=="object"?E.value:E,sf(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(E){const b=!!E.before,C=E.values||[];return new Vd(C,b)})(t.startAt));let m=null;return t.endAt&&(m=(function(E){const b=!E.before,C=E.values||[];return new Vd(C,b)})(t.endAt)),tP(e,o,u,l,d,"F",g,m)}function OP(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return De(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Cb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ea(t.unaryFilter.field);return Xt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Ea(t.unaryFilter.field);return Xt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Ea(t.unaryFilter.field);return Xt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Ea(t.unaryFilter.field);return Xt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return De(61313);default:return De(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Xt.create(Ea(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return De(58110);default:return De(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qs.create(t.compositeFilter.filters.map((i=>Cb(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return De(1026)}})(t.compositeFilter.op))})(n):De(30097,{filter:n})}function qP(n){return CP[n]}function FP(n){return wP[n]}function jP(n){return IP[n]}function Ta(n){return{fieldPath:n.canonicalString()}}function Ea(n){return rn.fromServerFormat(n.fieldPath)}function wb(n){return n instanceof Xt?(function(t){if(t.op==="=="){if(OT(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NAN"}};if(UT(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(OT(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NOT_NAN"}};if(UT(t.value))return{unaryFilter:{field:Ta(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ta(t.field),op:FP(t.op),value:t.value}}})(n):n instanceof Qs?(function(t){const i=t.getFilters().map((o=>wb(o)));return i.length===1?i[0]:{compositeFilter:{op:jP(t.op),filters:i}}})(n):De(54877,{filter:n})}function BP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ib(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t,i,o,l=Pe.min(),u=Pe.min(),d=on.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=g}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.yt=e}}function HP(n){const e=UP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(){this.Cn=new YP}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Cr.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Cr.min())}updateCollectionGroup(e,t,i){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class YP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Wt(bt.comparator),l=!o.has(i);return this.index[t]=o.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Wt(bt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nb=41943040;class Dn{static withCacheSize(e){return new Dn(e,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dn.DEFAULT_COLLECTION_PERCENTILE=10,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dn.DEFAULT=new Dn(Nb,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dn.DISABLED=new Dn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qa(0)}static cr(){return new qa(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="LruGarbageCollector",$P=1048576;function eE([n,e],[t,i]){const o=Ke(n,t);return o===0?Ke(e,i):o}class JP{constructor(e){this.Ir=e,this.buffer=new Wt(eE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();eE(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KP{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ee(ZT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wa(t)?Ee(ZT,"Ignoring IndexedDB error during garbage collection: ",t):await Xa(t)}await this.Vr(3e5)}))}}class QP{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(nf.ce);const i=new JP(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(WT)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,l,u,d,g,m;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,u=Date.now(),this.nthSequenceNumber(e,o)))).next((E=>(i=E,d=Date.now(),this.removeTargets(e,i,t)))).next((E=>(l=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(m=Date.now(),_a()<=Je.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-T}ms
	Determined least recently used ${o} in `+(d-u)+`ms
	Removed ${l} targets in `+(g-d)+`ms
	Removed ${E} documents in `+(m-g)+`ms
Total Duration: ${m-T}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:E}))))}}function XP(n,e){return new QP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(){this.changes=new So((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?le.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&pu(i.mutation,o,ys.empty(),_t.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Qe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Qe()){const o=mo();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((l=>{let u=lu();return l.forEach(((d,g)=>{u=u.insert(d,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=mo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Qe())))}populateOverlays(e,t,i){const o=[];return i.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,i,o){let l=Di();const u=mu(),d=(function(){return mu()})();return t.forEach(((g,m)=>{const T=i.get(m.key);o.has(m.key)&&(T===void 0||T.mutation instanceof Co)?l=l.insert(m.key,m):T!==void 0?(u.set(m.key,T.mutation.getFieldMask()),pu(T.mutation,m,T.mutation.getFieldMask(),_t.now())):u.set(m.key,ys.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,T)=>u.set(m,T))),t.forEach(((m,T)=>d.set(m,new ZP(T,u.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=mu();let o=new It(((u,d)=>u-d)),l=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let T=i.get(g)||ys.empty();T=d.applyToLocalView(m,T),i.set(g,T);const E=(o.get(d.batchId)||Qe()).add(g);o=o.insert(d.batchId,E)}))})).next((()=>{const u=[],d=o.getReverseIterator();for(;d.hasNext();){const g=d.getNext(),m=g.key,T=g.value,E=db();T.forEach((b=>{if(!l.has(b)){const C=yb(t.get(b),i.get(b));C!==null&&E.set(b,C),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,E))}return le.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(u){return Ne.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((l=>{const u=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-l.size):le.resolve(mo());let d=vu,g=l;return u.next((m=>le.forEach(m,((T,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),l.get(T)?le.resolve():this.remoteDocumentCache.getEntry(e,T).next((b=>{g=g.insert(T,b)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,Qe()))).next((T=>({batchId:d,changes:cb(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next((i=>{let o=lu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const l=t.collectionGroup;let u=lu();return this.indexManager.getCollectionParents(e,l).next((d=>le.forEach(d,(g=>{const m=(function(E,b){return new of(b,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next((T=>{T.forEach(((E,b)=>{u=u.insert(E,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,o)))).next((u=>{l.forEach(((g,m)=>{const T=m.getKey();u.get(T)===null&&(u=u.insert(T,yn.newInvalidDocument(T)))}));let d=lu();return u.forEach(((g,m)=>{const T=l.get(g);T!==void 0&&pu(T.mutation,m,ys.empty(),_t.now()),lf(t,m)&&(d=d.insert(g,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return le.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Ys(o.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:HP(o.bundledQuery),readTime:Ys(o.readTime)}})(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.overlays=new It(Ne.comparator),this.qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const i=mo();return le.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&i.set(o,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,l)=>{this.St(e,t,l)})),le.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),le.resolve()}getOverlaysForCollection(e,t,i){const o=mo(),l=t.length+1,u=new Ne(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const g=d.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&o.set(g.getKey(),g)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let l=new It(((m,T)=>m-T));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let T=l.get(m.largestBatchId);T===null&&(T=mo(),l=l.insert(m.largestBatchId,T)),T.set(m.getKey(),m)}}const d=mo(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,T)=>d.set(m,T))),!(d.size()>=o)););return le.resolve(d)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new TP(t,i));let l=this.qr.get(t);l===void 0&&(l=Qe(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(){this.Qr=new Wt(sn.$r),this.Ur=new Wt(sn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new sn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new sn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ne(new bt([])),i=new sn(t,e),o=new sn(t,e+1),l=[];return this.Ur.forEachInRange([i,o],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ne(new bt([])),i=new sn(t,e),o=new sn(t,e+1);let l=Qe();return this.Ur.forEachInRange([i,o],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new sn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class sn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ne.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Wt(sn.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new vP(l,t,i,o);this.mutationQueue.push(u);for(const d of o)this.Zr=this.Zr.add(new sn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return le.resolve(u)}lookupMutationBatch(e,t){return le.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),l=o<0?0:o;return le.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?Op:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new sn(t,0),o=new sn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,o],(u=>{const d=this.Xr(u.Yr);l.push(d)})),le.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Wt(Ke);return t.forEach((o=>{const l=new sn(o,0),u=new sn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(d=>{i=i.add(d.Yr)}))})),le.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let l=i;Ne.isDocumentKey(l)||(l=l.child(""));const u=new sn(new Ne(l),0);let d=new Wt(Ke);return this.Zr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(d=d.add(g.Yr)),!0)}),u),le.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return le.forEach(t.mutations,(o=>{const l=new sn(o.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new sn(t,0),o=this.Zr.firstAfterOrEqual(i);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.ri=e,this.docs=(function(){return new It(Ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),l=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return le.resolve(i?i.document.mutableCopy():yn.newInvalidDocument(t))}getEntries(e,t){let i=Di();return t.forEach((o=>{const l=this.docs.get(o);i=i.insert(o,l?l.document.mutableCopy():yn.newInvalidDocument(o))})),le.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let l=Di();const u=t.path,d=new Ne(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(d);for(;g.hasNext();){const{key:m,value:{document:T}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||P2(D2(T),i)<=0||(o.has(T.key)||lf(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return le.resolve(l)}getAllFromCollectionGroup(e,t,i,o){De(9500)}ii(e,t){return le.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new ok(this)}getSize(e){return le.resolve(this.size)}}class ok extends WP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),le.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.persistence=e,this.si=new So((t=>jp(t)),Bp),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new Kp,this.targetCount=0,this.ai=qa.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),le.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new qa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Pr(t),le.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,i){let o=0;const l=[];return this.si.forEach(((u,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),le.waitFor(l).next((()=>o))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return le.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),le.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((u=>{l.push(o.markPotentiallyOrphaned(e,u))})),le.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return le.resolve(i)}containsKey(e,t){return le.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,t){this.ui={},this.overlays={},this.ci=new nf(0),this.li=!1,this.li=!0,this.hi=new sk,this.referenceDelegate=e(this),this.Pi=new ak(this),this.indexManager=new GP,this.remoteDocumentCache=(function(o){return new rk(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new zP(t),this.Ii=new tk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new ik(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ee("MemoryPersistence","Starting transaction:",e);const o=new lk(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return le.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class lk extends V2{constructor(e){super(),this.currentSequenceNumber=e}}class Qp{constructor(e){this.persistence=e,this.Ri=new Kp,this.Vi=null}static mi(e){return new Qp(e)}get fi(){if(this.Vi)return this.Vi;throw De(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),le.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(i=>{const o=Ne.fromPath(i);return this.gi(e,o).next((l=>{l||t.removeEntry(o,Pe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Fd{constructor(e,t){this.persistence=e,this.pi=new So((i=>O2(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=XP(this,t)}static mi(e,t){return new Fd(e,t)}Ei(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return le.forEach(this.pi,((i,o)=>this.br(e,i,o).next((l=>l?le.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((d=>{d||(i++,l.removeEntry(u,Pe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),le.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_d(e.data.value)),t}br(e,t,i){return le.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return le.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=Qe(),o=Qe();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Xp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return nD()?8:L2(vn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,o,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new uk;return this.Ss(e,t,u).next((d=>{if(l.result=d,this.Vs)return this.bs(e,t,u,d.size)}))})).next((()=>l.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(_a()<=Je.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",va(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(_a()<=Je.DEBUG&&Ee("QueryEngine","Query:",va(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(_a()<=Je.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",va(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hs(t))):le.resolve())}ys(e,t){if(BT(t))return le.resolve(null);let i=Hs(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=dp(t,null,"F"),i=Hs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=Qe(...l);return this.ps.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.Ds(t,d);return this.Cs(t,m,u,g.readTime)?this.ys(e,dp(t,null,"F")):this.vs(e,m,t,g)}))))})))))}ws(e,t,i,o){return BT(t)||o.isEqual(Pe.min())?le.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,i,o)?le.resolve(null):(_a()<=Je.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),va(t)),this.vs(e,u,t,M2(o,vu)).next((d=>d)))}))}Ds(e,t){let i=new Wt(lb(e));return t.forEach(((o,l)=>{lf(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,i){return _a()<=Je.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",va(t)),this.ps.getDocumentsMatchingQuery(e,t,Cr.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="LocalStore",dk=3e8;class fk{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new It(Ke),this.xs=new So((l=>jp(l)),Bp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ek(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function hk(n,e,t,i){return new fk(n,e,t,i)}async function Mb(n,e){const t=Oe(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],d=[];let g=Qe();for(const m of o){u.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}for(const m of l){d.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ls:m,removedBatchIds:u,addedBatchIds:d})))}))}))}function mk(n,e){const t=Oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,g,m,T){const E=m.batch,b=E.keys();let C=le.resolve();return b.forEach((P=>{C=C.next((()=>T.getEntry(g,P))).next((O=>{const G=m.docVersions.get(P);lt(G!==null,48541),O.version.compareTo(G)<0&&(E.applyToRemoteDocument(O,m),O.isValidDocument()&&(O.setReadTime(m.commitVersion),T.addEntry(O)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let g=Qe();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(g=g.add(d.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function Db(n){const e=Oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function pk(n,e){const t=Oe(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const d=[];e.targetChanges.forEach(((T,E)=>{const b=o.get(E);if(!b)return;d.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,E))));let C=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?C=C.withResumeToken(on.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):T.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(T.resumeToken,i)),o=o.insert(E,C),(function(O,G,ne){return O.resumeToken.approximateByteSize()===0||G.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=dk?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(b,C,T)&&d.push(t.Pi.updateTargetData(l,C))}));let g=Di(),m=Qe();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),d.push(gk(l,u,e.documentUpdates).next((T=>{g=T.ks,m=T.qs}))),!i.isEqual(Pe.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((E=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(T)}return le.waitFor(d).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.Ms=o,l)))}function gk(n,e,t){let i=Qe(),o=Qe();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=Di();return t.forEach(((d,g)=>{const m=l.get(d);g.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(d)),g.isNoDocument()&&g.version.isEqual(Pe.min())?(e.removeEntry(d,g.readTime),u=u.insert(d,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(d,g)):Ee(Wp,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",g.version)})),{ks:u,qs:o}}))}function yk(n,e){const t=Oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Op),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function _k(n,e){const t=Oe(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((l=>l?(o=l,le.resolve(o)):t.Pi.allocateTargetId(i).next((u=>(o=new Tr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function gp(n,e,t){const i=Oe(n),o=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!Wa(u))throw u;Ee(Wp,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function tE(n,e,t){const i=Oe(n);let o=Pe.min(),l=Qe();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,m,T){const E=Oe(g),b=E.xs.get(T);return b!==void 0?le.resolve(E.Ms.get(b)):E.Pi.getTargetData(m,T)})(i,u,Hs(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,d.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?o:Pe.min(),t?l:Qe()))).next((d=>(vk(i,iP(e),d),{documents:d,Qs:l})))))}function vk(n,e,t){let i=n.Os.get(e)||Pe.min();t.forEach(((o,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class nE{constructor(){this.activeTargetIds=cP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Tk{constructor(){this.Mo=new nE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new nE,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="ConnectivityMonitor";class iE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ee(sE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ee(sE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dd=null;function yp(){return dd===null?dd=(function(){return 268435456+Math.round(2147483648*Math.random())})():dd++,"0x"+dd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="RestConnection",xk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===Pd?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,l){const u=yp(),d=this.zo(e,t.toUriEncodedString());Ee(Vm,`Sending RPC '${e}' ${u}:`,d,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,o,l);const{host:m}=new URL(d),T=Ja(m);return this.Jo(e,d,g,i,T).then((E=>(Ee(Vm,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw To(Vm,`RPC '${e}' ${u} failed with error: `,E,"url: ",d,"request:",i),E}))}Ho(e,t,i,o,l,u){return this.Go(e,t,i,o,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Qa})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),i&&i.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const i=xk[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class Sk extends bk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,l){const u=yp();return new Promise(((d,g)=>{const m=new kx;m.setWithCredentials(!0),m.listenOnce(Vx.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case yd.NO_ERROR:const E=m.getResponseJson();Ee(pn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),d(E);break;case yd.TIMEOUT:Ee(pn,`RPC '${e}' ${u} timed out`),g(new Ce(ue.DEADLINE_EXCEEDED,"Request time out"));break;case yd.HTTP_ERROR:const b=m.getStatus();if(Ee(pn,`RPC '${e}' ${u} failed with status:`,b,"response text:",m.getResponseText()),b>0){let C=m.getResponseJson();Array.isArray(C)&&(C=C[0]);const P=C==null?void 0:C.error;if(P&&P.status&&P.message){const O=(function(ne){const j=ne.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(j)>=0?j:ue.UNKNOWN})(P.status);g(new Ce(O,P.message))}else g(new Ce(ue.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new Ce(ue.UNAVAILABLE,"Connection failed."));break;default:De(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ee(pn,`RPC '${e}' ${u} completed.`)}}));const T=JSON.stringify(o);Ee(pn,`RPC '${e}' ${u} sending request:`,o),m.send(t,"POST",T,i,15)}))}T_(e,t,i){const o=yp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Ox(),d=Ux(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(g.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const T=l.join("");Ee(pn,`Creating RPC '${e}' stream ${o}: ${T}`,g);const E=u.createWebChannel(T,g);this.I_(E);let b=!1,C=!1;const P=new Ak({Yo:G=>{C?Ee(pn,`Not sending because RPC '${e}' stream ${o} is closed:`,G):(b||(Ee(pn,`Opening RPC '${e}' stream ${o} transport.`),E.open(),b=!0),Ee(pn,`RPC '${e}' stream ${o} sending:`,G),E.send(G))},Zo:()=>E.close()}),O=(G,ne,j)=>{G.listen(ne,(q=>{try{j(q)}catch(H){setTimeout((()=>{throw H}),0)}}))};return O(E,au.EventType.OPEN,(()=>{C||(Ee(pn,`RPC '${e}' stream ${o} transport opened.`),P.o_())})),O(E,au.EventType.CLOSE,(()=>{C||(C=!0,Ee(pn,`RPC '${e}' stream ${o} transport closed`),P.a_(),this.E_(E))})),O(E,au.EventType.ERROR,(G=>{C||(C=!0,To(pn,`RPC '${e}' stream ${o} transport errored. Name:`,G.name,"Message:",G.message),P.a_(new Ce(ue.UNAVAILABLE,"The operation could not be completed")))})),O(E,au.EventType.MESSAGE,(G=>{var ne;if(!C){const j=G.data[0];lt(!!j,16349);const q=j,H=(q==null?void 0:q.error)||((ne=q[0])==null?void 0:ne.error);if(H){Ee(pn,`RPC '${e}' stream ${o} received error:`,H);const Z=H.status;let U=(function(R){const k=$t[R];if(k!==void 0)return vb(k)})(Z),N=H.message;U===void 0&&(U=ue.INTERNAL,N="Unknown error status: "+Z+" with message "+H.message),C=!0,P.a_(new Ce(U,N)),E.close()}else Ee(pn,`RPC '${e}' stream ${o} received:`,j),P.u_(j)}})),O(d,Lx.STAT_EVENT,(G=>{G.stat===rp.PROXY?Ee(pn,`RPC '${e}' stream ${o} detected buffering proxy`):G.stat===rp.NOPROXY&&Ee(pn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Lm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(n){return new NP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t,i=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Ee("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="PersistentStream";class kb{constructor(e,t,i,o,l,u,d,g){this.Mi=e,this.S_=i,this.b_=o,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Pb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Ri(t.toString()),Ri("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ce(ue.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ee(rE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ee(rE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ck extends kb{constructor(e,t,i,o,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=DP(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Pe.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Pe.min():u.readTime?Ys(u.readTime):Pe.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=pp(this.serializer),t.addTarget=(function(l,u){let d;const g=u.target;if(d=cp(g)?{documents:VP(l,g)}:{query:LP(l,g).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=xb(l,u.resumeToken);const m=fp(l,u.expectedCount);m!==null&&(d.expectedCount=m)}else if(u.snapshotVersion.compareTo(Pe.min())>0){d.readTime=qd(l,u.snapshotVersion.toTimestamp());const m=fp(l,u.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const i=OP(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=pp(this.serializer),t.removeTarget=e,this.q_(t)}}class wk extends kb{constructor(e,t,i,o,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=kP(e.writeResults,e.commitTime),i=Ys(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=pp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>PP(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{}class Nk extends Ik{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,hp(t,i),o,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ce(ue.UNKNOWN,l.toString())}))}Ho(e,t,i,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Ho(e,hp(t,i),o,u,d,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(ue.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Rk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ri(t),this.aa=!1):Ee("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo="RemoteStore";class Mk{constructor(e,t,i,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{wo(this)&&(Ee(Eo,"Restarting streams for network reachability change."),await(async function(g){const m=Oe(g);m.Ea.add(4),await Ru(m),m.Ra.set("Unknown"),m.Ea.delete(4),await hf(m)})(this))}))})),this.Ra=new Rk(i,o)}}async function hf(n){if(wo(n))for(const e of n.da)await e(!0)}async function Ru(n){for(const e of n.da)await e(!1)}function Vb(n,e){const t=Oe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ng(t)?tg(t):Za(t).O_()&&eg(t,e))}function Zp(n,e){const t=Oe(n),i=Za(t);t.Ia.delete(e),i.O_()&&Lb(t,e),t.Ia.size===0&&(i.O_()?i.L_():wo(t)&&t.Ra.set("Unknown"))}function eg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Za(n).Y_(e)}function Lb(n,e){n.Va.Ue(e),Za(n).Z_(e)}function tg(n){n.Va=new SP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Za(n).start(),n.Ra.ua()}function ng(n){return wo(n)&&!Za(n).x_()&&n.Ia.size>0}function wo(n){return Oe(n).Ea.size===0}function Ub(n){n.Va=void 0}async function Dk(n){n.Ra.set("Online")}async function Pk(n){n.Ia.forEach(((e,t)=>{eg(n,e)}))}async function kk(n,e){Ub(n),ng(n)?(n.Ra.ha(e),tg(n)):n.Ra.set("Unknown")}async function Vk(n,e,t){if(n.Ra.set("Online"),e instanceof Eb&&e.state===2&&e.cause)try{await(async function(o,l){const u=l.cause;for(const d of l.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,u),o.Ia.delete(d),o.Va.removeTarget(d))})(n,e)}catch(i){Ee(Eo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await jd(n,i)}else if(e instanceof Ed?n.Va.Ze(e):e instanceof Tb?n.Va.st(e):n.Va.tt(e),!t.isEqual(Pe.min()))try{const i=await Db(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const d=l.Va.Tt(u);return d.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const T=l.Ia.get(m);T&&l.Ia.set(m,T.withResumeToken(g.resumeToken,u))}})),d.targetMismatches.forEach(((g,m)=>{const T=l.Ia.get(g);if(!T)return;l.Ia.set(g,T.withResumeToken(on.EMPTY_BYTE_STRING,T.snapshotVersion)),Lb(l,g);const E=new Tr(T.target,g,m,T.sequenceNumber);eg(l,E)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){Ee(Eo,"Failed to raise snapshot:",i),await jd(n,i)}}async function jd(n,e,t){if(!Wa(e))throw e;n.Ea.add(1),await Ru(n),n.Ra.set("Offline"),t||(t=()=>Db(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ee(Eo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await hf(n)}))}function Ob(n,e){return e().catch((t=>jd(n,t,e)))}async function mf(n){const e=Oe(n),t=Rr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Op;for(;Lk(e);)try{const o=await yk(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,Uk(e,o)}catch(o){await jd(e,o)}qb(e)&&Fb(e)}function Lk(n){return wo(n)&&n.Ta.length<10}function Uk(n,e){n.Ta.push(e);const t=Rr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function qb(n){return wo(n)&&!Rr(n).x_()&&n.Ta.length>0}function Fb(n){Rr(n).start()}async function Ok(n){Rr(n).ra()}async function qk(n){const e=Rr(n);for(const t of n.Ta)e.ea(t.mutations)}async function Fk(n,e,t){const i=n.Ta.shift(),o=Yp.from(i,e,t);await Ob(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await mf(n)}async function jk(n,e){e&&Rr(n).X_&&await(async function(i,o){if((function(u){return xP(u)&&u!==ue.ABORTED})(o.code)){const l=i.Ta.shift();Rr(i).B_(),await Ob(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,o))),await mf(i)}})(n,e),qb(n)&&Fb(n)}async function oE(n,e){const t=Oe(n);t.asyncQueue.verifyOperationInProgress(),Ee(Eo,"RemoteStore received new credentials");const i=wo(t);t.Ea.add(3),await Ru(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await hf(t)}async function Bk(n,e){const t=Oe(n);e?(t.Ea.delete(2),await hf(t)):e||(t.Ea.add(2),await Ru(t),t.Ra.set("Unknown"))}function Za(n){return n.ma||(n.ma=(function(t,i,o){const l=Oe(t);return l.sa(),new Ck(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:Dk.bind(null,n),t_:Pk.bind(null,n),r_:kk.bind(null,n),H_:Vk.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ng(n)?tg(n):n.Ra.set("Unknown")):(await n.ma.stop(),Ub(n))}))),n.ma}function Rr(n){return n.fa||(n.fa=(function(t,i,o){const l=Oe(t);return l.sa(),new wk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ok.bind(null,n),r_:jk.bind(null,n),ta:qk.bind(null,n),na:Fk.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await mf(n)):(await n.fa.stop(),n.Ta.length>0&&(Ee(Eo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,t,i,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=l,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,l){const u=Date.now()+i,d=new sg(e,t,u,o,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ig(n,e){if(Ri("AsyncQueue",`${e}: ${n}`),Wa(n))return new Ce(ue.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{static emptySet(e){return new Na(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ne.comparator(t.key,i.key):(t,i)=>Ne.comparator(t.key,i.key),this.keyedMap=lu(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Na)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Na;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(){this.ga=new It(Ne.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):De(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Fa{constructor(e,t,i,o,l,u,d,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,l){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new Fa(e,t,Na.emptySet(t),u,i,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&af(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Hk{constructor(){this.queries=lE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=Oe(t),l=o.queries;o.queries=lE(),l.forEach(((u,d)=>{for(const g of d.Sa)g.onError(i)}))})(this,new Ce(ue.ABORTED,"Firestore shutting down"))}}function lE(){return new So((n=>ab(n)),af)}async function jb(n,e){const t=Oe(n);let i=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(i=2):(l=new zk,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const d=ig(u,`Initialization of query '${va(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&rg(t)}async function Bb(n,e){const t=Oe(n),i=e.query;let o=3;const l=t.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Gk(n,e){const t=Oe(n);let i=!1;for(const o of e){const l=o.query,u=t.queries.get(l);if(u){for(const d of u.Sa)d.Fa(o)&&(i=!0);u.wa=o}}i&&rg(t)}function Yk(n,e,t){const i=Oe(n),o=i.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);i.queries.delete(e)}function rg(n){n.Ca.forEach((e=>{e.next()}))}var _p,uE;(uE=_p||(_p={})).Ma="default",uE.Cache="cache";class zb{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Fa(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Fa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_p.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.key=e}}class Gb{constructor(e){this.key=e}}class $k{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Qe(),this.mutatedKeys=Qe(),this.eu=lb(e),this.tu=new Na(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new aE,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=o,d=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((T,E)=>{const b=o.get(T),C=lf(this.query,E)?E:null,P=!!b&&this.mutatedKeys.has(b.key),O=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let G=!1;b&&C?b.data.isEqual(C.data)?P!==O&&(i.track({type:3,doc:C}),G=!0):this.su(b,C)||(i.track({type:2,doc:C}),G=!0,(g&&this.eu(C,g)>0||m&&this.eu(C,m)<0)&&(d=!0)):!b&&C?(i.track({type:0,doc:C}),G=!0):b&&!C&&(i.track({type:1,doc:b}),G=!0,(g||m)&&(d=!0)),G&&(C?(u=u.add(C),l=O?l.add(T):l.delete(T)):(u=u.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const T=this.query.limitType==="F"?u.last():u.first();u=u.delete(T.key),l=l.delete(T.key),i.track({type:1,doc:T})}return{tu:u,iu:i,Cs:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((T,E)=>(function(C,P){const O=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return De(20277,{Rt:G})}};return O(C)-O(P)})(T.type,E.type)||this.eu(T.doc,E.doc))),this.ou(i),o=o??!1;const d=t&&!o?this._u():[],g=this.Xa.size===0&&this.current&&!o?1:0,m=g!==this.Za;return this.Za=g,u.length!==0||m?{snapshot:new Fa(this.query,e.tu,l,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new aE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Qe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Gb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Hb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Qe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Fa.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const og="SyncEngine";class Jk{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Kk{constructor(e){this.key=e,this.hu=!1}}class Qk{constructor(e,t,i,o,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new So((d=>ab(d)),af),this.Iu=new Map,this.Eu=new Set,this.du=new It(Ne.comparator),this.Au=new Map,this.Ru=new Kp,this.Vu={},this.mu=new Map,this.fu=qa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Xk(n,e,t=!0){const i=Xb(n);let o;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await Yb(i,e,t,!0),o}async function Wk(n,e){const t=Xb(n);await Yb(t,e,!0,!1)}async function Yb(n,e,t,i){const o=await _k(n.localStore,Hs(e)),l=o.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await Zk(n,e,l,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&Vb(n.remoteStore,o),d}async function Zk(n,e,t,i,o){n.pu=(E,b,C)=>(async function(O,G,ne,j){let q=G.view.ru(ne);q.Cs&&(q=await tE(O.localStore,G.query,!1).then((({documents:N})=>G.view.ru(N,q))));const H=j&&j.targetChanges.get(G.targetId),Z=j&&j.targetMismatches.get(G.targetId)!=null,U=G.view.applyChanges(q,O.isPrimaryClient,H,Z);return dE(O,G.targetId,U.au),U.snapshot})(n,E,b,C);const l=await tE(n.localStore,e,!0),u=new $k(e,l.Qs),d=u.ru(l.documents),g=Nu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),m=u.applyChanges(d,n.isPrimaryClient,g);dE(n,t,m.au);const T=new Jk(e,t,u);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function eV(n,e,t){const i=Oe(n),o=i.Tu.get(e),l=i.Iu.get(o.targetId);if(l.length>1)return i.Iu.set(o.targetId,l.filter((u=>!af(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await gp(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Zp(i.remoteStore,o.targetId),vp(i,o.targetId)})).catch(Xa)):(vp(i,o.targetId),await gp(i.localStore,o.targetId,!0))}async function tV(n,e){const t=Oe(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Zp(t.remoteStore,i.targetId))}async function nV(n,e,t){const i=uV(n);try{const o=await(function(u,d){const g=Oe(u),m=_t.now(),T=d.reduce(((C,P)=>C.add(P.key)),Qe());let E,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let P=Di(),O=Qe();return g.Ns.getEntries(C,T).next((G=>{P=G,P.forEach(((ne,j)=>{j.isValidDocument()||(O=O.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(C,P))).next((G=>{E=G;const ne=[];for(const j of d){const q=yP(j,E.get(j.key).overlayedDocument);q!=null&&ne.push(new Co(j.key,q,eb(q.value.mapValue),Gs.exists(!0)))}return g.mutationQueue.addMutationBatch(C,m,ne,d)})).next((G=>{b=G;const ne=G.applyToLocalDocumentSet(E,O);return g.documentOverlayCache.saveOverlays(C,G.batchId,ne)}))})).then((()=>({batchId:b.batchId,changes:cb(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(u,d,g){let m=u.Vu[u.currentUser.toKey()];m||(m=new It(Ke)),m=m.insert(d,g),u.Vu[u.currentUser.toKey()]=m})(i,o.batchId,t),await Mu(i,o.changes),await mf(i.remoteStore)}catch(o){const l=ig(o,"Failed to persist write");t.reject(l)}}async function $b(n,e){const t=Oe(n);try{const i=await pk(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const u=t.Au.get(l);u&&(lt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?lt(u.hu,14607):o.removedDocuments.size>0&&(lt(u.hu,42227),u.hu=!1))})),await Mu(t,i,e)}catch(i){await Xa(i)}}function cE(n,e,t){const i=Oe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((l,u)=>{const d=u.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(u,d){const g=Oe(u);g.onlineState=d;let m=!1;g.queries.forEach(((T,E)=>{for(const b of E.Sa)b.va(d)&&(m=!0)})),m&&rg(g)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sV(n,e,t){const i=Oe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),l=o&&o.key;if(l){let u=new It(Ne.comparator);u=u.insert(l,yn.newNoDocument(l,Pe.min()));const d=Qe().add(l),g=new df(Pe.min(),new Map,new It(Ke),u,d);await $b(i,g),i.du=i.du.remove(l),i.Au.delete(e),ag(i)}else await gp(i.localStore,e,!1).then((()=>vp(i,e,t))).catch(Xa)}async function iV(n,e){const t=Oe(n),i=e.batch.batchId;try{const o=await mk(t.localStore,e);Kb(t,i,null),Jb(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Mu(t,o)}catch(o){await Xa(o)}}async function rV(n,e,t){const i=Oe(n);try{const o=await(function(u,d){const g=Oe(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let T;return g.mutationQueue.lookupMutationBatch(m,d).next((E=>(lt(E!==null,37113),T=E.keys(),g.mutationQueue.removeMutationBatch(m,E)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,T,d))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,T))).next((()=>g.localDocuments.getDocuments(m,T)))}))})(i.localStore,e);Kb(i,e,t),Jb(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Mu(i,o)}catch(o){await Xa(o)}}function Jb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Kb(n,e,t){const i=Oe(n);let o=i.Vu[i.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),i.Vu[i.currentUser.toKey()]=o}}function vp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Qb(n,i)}))}function Qb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Zp(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ag(n))}function dE(n,e,t){for(const i of t)i instanceof Hb?(n.Ru.addReference(i.key,e),oV(n,i)):i instanceof Gb?(Ee(og,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Qb(n,i.key)):De(19791,{wu:i})}function oV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Ee(og,"New document in limbo: "+t),n.Eu.add(i),ag(n))}function ag(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ne(bt.fromString(e)),i=n.fu.next();n.Au.set(i,new Kk(t)),n.du=n.du.insert(t,i),Vb(n.remoteStore,new Tr(Hs(zp(t.path)),i,"TargetPurposeLimboResolution",nf.ce))}}async function Mu(n,e,t){const i=Oe(n),o=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,g)=>{u.push(i.pu(g,e,t).then((m=>{var T;if((m||t)&&i.isPrimaryClient){const E=m?!m.fromCache:(T=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:T.current;i.sharedClientState.updateQueryState(g.targetId,E?"current":"not-current")}if(m){o.push(m);const E=Xp.As(g.targetId,m);l.push(E)}})))})),await Promise.all(u),i.Pu.H_(o),await(async function(g,m){const T=Oe(g);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>le.forEach(m,(b=>le.forEach(b.Es,(C=>T.persistence.referenceDelegate.addReference(E,b.targetId,C))).next((()=>le.forEach(b.ds,(C=>T.persistence.referenceDelegate.removeReference(E,b.targetId,C)))))))))}catch(E){if(!Wa(E))throw E;Ee(Wp,"Failed to update sequence numbers: "+E)}for(const E of m){const b=E.targetId;if(!E.fromCache){const C=T.Ms.get(b),P=C.snapshotVersion,O=C.withLastLimboFreeSnapshotVersion(P);T.Ms=T.Ms.insert(b,O)}}})(i.localStore,l))}async function aV(n,e){const t=Oe(n);if(!t.currentUser.isEqual(e)){Ee(og,"User change. New user:",e.toKey());const i=await Mb(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((d=>{d.forEach((g=>{g.reject(new Ce(ue.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Mu(t,i.Ls)}}function lV(n,e){const t=Oe(n),i=t.Au.get(e);if(i&&i.hu)return Qe().add(i.key);{let o=Qe();const l=t.Iu.get(e);if(!l)return o;for(const u of l){const d=t.Tu.get(u);o=o.unionWith(d.view.nu)}return o}}function Xb(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$b.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sV.bind(null,e),e.Pu.H_=Gk.bind(null,e.eventManager),e.Pu.yu=Yk.bind(null,e.eventManager),e}function uV(n){const e=Oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rV.bind(null,e),e}class Bd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ff(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return hk(this.persistence,new ck,e.initialUser,this.serializer)}Cu(e){return new Rb(Qp.mi,this.serializer)}Du(e){return new Tk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bd.provider={build:()=>new Bd};class cV extends Bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){lt(this.persistence.referenceDelegate instanceof Fd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new KP(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dn.withCacheSize(this.cacheSizeBytes):Dn.DEFAULT;return new Rb((i=>Fd.mi(i,t)),this.serializer)}}class Tp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>cE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=aV.bind(null,this.syncEngine),await Bk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Hk})()}createDatastore(e){const t=ff(e.databaseInfo.databaseId),i=(function(l){return new Sk(l)})(e.databaseInfo);return(function(l,u,d,g){return new Nk(l,u,d,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,l,u,d){return new Mk(i,o,l,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>cE(this.syncEngine,t,0)),(function(){return iE.v()?new iE:new Ek})())}createSyncEngine(e,t){return(function(o,l,u,d,g,m,T){const E=new Qk(o,l,u,d,g,m);return T&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const l=Oe(o);Ee(Eo,"RemoteStore shutting down."),l.Ea.add(5),await Ru(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ri("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class dV{constructor(e,t,i,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=gn.UNAUTHENTICATED,this.clientId=tf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{Ee(Mr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ee(Mr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ig(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Um(n,e){n.asyncQueue.verifyOperationInProgress(),Ee(Mr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Mb(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function fE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await fV(n);Ee(Mr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>oE(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>oE(e.remoteStore,o))),n._onlineComponents=e}async function fV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ee(Mr,"Using user provided OfflineComponentProvider");try{await Um(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ue.FAILED_PRECONDITION||o.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;To("Error using user provided cache. Falling back to memory cache: "+t),await Um(n,new Bd)}}else Ee(Mr,"Using default OfflineComponentProvider"),await Um(n,new cV(void 0));return n._offlineComponents}async function Zb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ee(Mr,"Using user provided OnlineComponentProvider"),await fE(n,n._uninitializedComponentsProvider._online)):(Ee(Mr,"Using default OnlineComponentProvider"),await fE(n,new Tp))),n._onlineComponents}function hV(n){return Zb(n).then((e=>e.syncEngine))}async function eA(n){const e=await Zb(n),t=e.eventManager;return t.onListen=Xk.bind(null,e.syncEngine),t.onUnlisten=eV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Wk.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tV.bind(null,e.syncEngine),t}function mV(n,e,t={}){const i=new Ci;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const T=new Wb({next:b=>{T.Nu(),u.enqueueAndForget((()=>Bb(l,E)));const C=b.docs.has(d);!C&&b.fromCache?m.reject(new Ce(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&b.fromCache&&g&&g.source==="server"?m.reject(new Ce(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(b)},error:b=>m.reject(b)}),E=new zb(zp(d.path),T,{includeMetadataChanges:!0,qa:!0});return jb(l,E)})(await eA(n),n.asyncQueue,e,t,i))),i.promise}function pV(n,e,t={}){const i=new Ci;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const T=new Wb({next:b=>{T.Nu(),u.enqueueAndForget((()=>Bb(l,E))),b.fromCache&&g.source==="server"?m.reject(new Ce(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(b)},error:b=>m.reject(b)}),E=new zb(d,T,{includeMetadataChanges:!0,qa:!0});return jb(l,E)})(await eA(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firestore.googleapis.com",mE=!0;class pE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nA,this.ssl=mE}else this.host=e.host,this.ssl=e.ssl??mE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Nb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$P)throw new Ce(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new jx;switch(i.type){case"firstParty":return new S2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=hE.get(t);i&&(Ee("ComponentProvider","Removing Datastore"),hE.delete(t),i.terminate())})(this),Promise.resolve()}}function sA(n,e,t,i={}){var m;n=Mi(n,pf);const o=Ja(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(Sx(`https://${d}`),Cx("Firestore",!0)),l.host!==nA&&l.host!==d&&To("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:d,ssl:o,emulatorOptions:i};if(!yo(g,u)&&(n._setSettings(g),i.mockUserToken)){let T,E;if(typeof i.mockUserToken=="string")T=i.mockUserToken,E=gn.MOCK_USER;else{T=$M(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Ce(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new gn(b)}n._authCredentials=new x2(new Fx(T,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Du(this.firestore,e,this._query)}}class Kt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Kt(this.firestore,e,this._key)}toJSON(){return{type:Kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(wu(t,Kt._jsonSchema))return new Kt(e,i||null,new Ne(bt.fromString(t.referencePath)))}}Kt._jsonSchemaVersion="firestore/documentReference/1.0",Kt._jsonSchema={type:Jt("string",Kt._jsonSchemaVersion),referencePath:Jt("string")};class wi extends Du{constructor(e,t,i){super(e,t,zp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Kt(this.firestore,null,new Ne(e))}withConverter(e){return new wi(this.firestore,e,this._path)}}function gV(n,e,...t){if(n=bn(n),Bx("collection","path",e),n instanceof pf){const i=bt.fromString(e,...t);return NT(i),new wi(n,null,i)}{if(!(n instanceof Kt||n instanceof wi))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(bt.fromString(e,...t));return NT(i),new wi(n.firestore,null,i)}}function yV(n,e,...t){if(n=bn(n),arguments.length===1&&(e=tf.newId()),Bx("doc","path",e),n instanceof pf){const i=bt.fromString(e,...t);return IT(i),new Kt(n,null,new Ne(i))}{if(!(n instanceof Kt||n instanceof wi))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(bt.fromString(e,...t));return IT(i),new Kt(n.firestore,n instanceof wi?n.converter:null,new Ne(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="AsyncQueue";class yE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Pb(this,"async_queue_retry"),this._c=()=>{const i=Lm();i&&Ee(gE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Lm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Lm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ci;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Wa(e))throw e;Ee(gE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ri("INTERNAL UNHANDLED ERROR: ",_E(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=sg.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&De(47125,{Pc:_E(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _E(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class el extends pf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new yE,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yE(e),this._firestoreClient=void 0,await e}}}function iA(n,e){const t=typeof n=="object"?n:Rx(),i=typeof n=="string"?n:Pd,o=Vp(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const l=GM("firestore");l&&sA(o,...l)}return o}function gf(n){if(n._terminated)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_V(n),n._firestoreClient}function _V(n){var i,o,l;const e=n._freezeSettings(),t=(function(d,g,m,T){return new j2(d,g,m,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,tA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new dV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const g=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bn(on.fromBase64String(e))}catch(t){throw new Ce(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bn(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wu(e,Bn._jsonSchema))return Bn.fromBase64String(e.bytes)}}Bn._jsonSchemaVersion="firestore/bytes/1.0",Bn._jsonSchema={type:Jt("string",Bn._jsonSchemaVersion),bytes:Jt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vs._jsonSchemaVersion}}static fromJSON(e){if(wu(e,vs._jsonSchema))return new vs(e.latitude,e.longitude)}}vs._jsonSchemaVersion="firestore/geoPoint/1.0",vs._jsonSchema={type:Jt("string",vs._jsonSchemaVersion),latitude:Jt("number"),longitude:Jt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wu(e,Ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ts(e.vectorValues);throw new Ce(ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ts._jsonSchemaVersion="firestore/vectorValue/1.0",Ts._jsonSchema={type:Jt("string",Ts._jsonSchemaVersion),vectorValues:Jt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=/^__.*__$/;class TV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Co(e,this.data,this.fieldMask,t,this.fieldTransforms):new Iu(e,this.data,t,this.fieldTransforms)}}function rA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw De(40011,{Ac:n})}}class ug{constructor(e,t,i,o,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ug({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return zd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(rA(this.Ac)&&vV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class EV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ff(e)}Cc(e,t,i,o=!1){return new ug({Ac:e,methodName:t,Dc:i,path:rn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xV(n){const e=n._freezeSettings(),t=ff(n._databaseId);return new EV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bV(n,e,t,i,o,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);uA("Data must be an object, but it was:",u,i);const d=aA(i,u);let g,m;if(l.merge)g=new ys(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const T=[];for(const E of l.mergeFields){const b=AV(e,E,t);if(!u.contains(b))throw new Ce(ue.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);CV(T,b)||T.push(b)}g=new ys(T),m=u.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,m=u.fieldTransforms;return new TV(new ss(d),g,m)}function oA(n,e){if(lA(n=bn(n)))return uA("Unsupported field value:",e,n),aA(n,e);if(n instanceof lg)return(function(i,o){if(!rA(o.Ac))throw o.Sc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,o){const l=[];let u=0;for(const d of i){let g=oA(d,o.wc(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,o){if((i=bn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return dP(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=_t.fromDate(i);return{timestampValue:qd(o.serializer,l)}}if(i instanceof _t){const l=new _t(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:qd(o.serializer,l)}}if(i instanceof vs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Bn)return{bytesValue:xb(o.serializer,i._byteString)};if(i instanceof Kt){const l=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Jp(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Ts)return(function(u,d){return{mapValue:{fields:{[Wx]:{stringValue:Zx},[kd]:{arrayValue:{values:u.toArray().map((m=>{if(typeof m!="number")throw d.Sc("VectorValues must only contain numeric values.");return Hp(d.serializer,m)}))}}}}}})(i,o);throw o.Sc(`Unsupported field value: ${Up(i)}`)})(n,e)}function aA(n,e){const t={};return Yx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(n,((i,o)=>{const l=oA(o,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function lA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof vs||n instanceof Bn||n instanceof Kt||n instanceof lg||n instanceof Ts)}function uA(n,e,t){if(!lA(t)||!Hx(t)){const i=Up(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function AV(n,e,t){if((e=bn(e))instanceof yf)return e._internalPath;if(typeof e=="string")return cA(n,e);throw zd("Field path arguments must be of type string or ",n,!1,void 0,t)}const SV=new RegExp("[~\\*/\\[\\]]");function cA(n,e,t){if(e.search(SV)>=0)throw zd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yf(...e.split("."))._internalPath}catch{throw zd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zd(n,e,t,i,o){const l=i&&!i.isEmpty(),u=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${o}`),g+=")"),new Ce(ue.INVALID_ARGUMENT,d+n+g)}function CV(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,t,i,o,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class wV extends dA{data(){return super.data()}}function fA(n,e){return typeof e=="string"?cA(n,e):e instanceof yf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hA{convertValue(e,t="none"){switch(Nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw De(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ao(e,((o,l)=>{i[o]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,o,l;const t=(l=(o=(i=e.fields)==null?void 0:i[kd].arrayValue)==null?void 0:o.values)==null?void 0:l.map((u=>Ut(u.doubleValue)));return new Ts(t)}convertGeoPoint(e){return new vs(Ut(e.latitude),Ut(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=rf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Tu(e));default:return null}}convertTimestamp(e){const t=wr(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=bt.fromString(e);lt(Ib(i),9688,{name:e});const o=new La(i.get(1),i.get(3)),l=new Ne(i.popFirst(5));return o.isEqual(t)||Ri(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NV(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class ba{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sr extends dA{constructor(e,t,i,o,l,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(fA("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Sr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Sr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Sr._jsonSchema={type:Jt("string",Sr._jsonSchemaVersion),bundleSource:Jt("string","DocumentSnapshot"),bundleName:Jt("string"),bundle:Jt("string")};class gu extends Sr{data(e={}){return super.data(e)}}class po{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new ba(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new gu(this._firestore,this._userDataWriter,i.key,i,new ba(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((d=>{const g=new gu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new ba(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const g=new gu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new ba(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,T=-1;return d.type!==0&&(m=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),T=u.indexOf(d.doc.key)),{type:RV(d.type),doc:g,oldIndex:m,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=po._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=tf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return De(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MV(n){n=Mi(n,Kt);const e=Mi(n.firestore,el);return mV(gf(e),n._key).then((t=>VV(e,n,t)))}po._jsonSchemaVersion="firestore/querySnapshot/1.0",po._jsonSchema={type:Jt("string",po._jsonSchemaVersion),bundleSource:Jt("string","QuerySnapshot"),bundleName:Jt("string"),bundle:Jt("string")};class mA extends hA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Kt(this.firestore,null,t)}}function DV(n){n=Mi(n,Du);const e=Mi(n.firestore,el),t=gf(e),i=new mA(e);return IV(n._query),pV(t,n._query).then((o=>new po(e,i,n,o)))}function PV(n,e,t){n=Mi(n,Kt);const i=Mi(n.firestore,el),o=NV(n.converter,e,t);return cg(i,[bV(xV(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,Gs.none())])}function kV(n){return cg(Mi(n.firestore,el),[new Gp(n._key,Gs.none())])}function cg(n,e){return(function(i,o){const l=new Ci;return i.asyncQueue.enqueueAndForget((async()=>nV(await hV(i),o,l))),l.promise})(gf(n),e)}function VV(n,e,t){const i=t.docs.get(e._key),o=new mA(n);return new Sr(n,o,e._key,i,new ba(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){Qa=o})(Ka),ka(new _o("firestore",((i,{instanceIdentifier:o,options:l})=>{const u=i.getProvider("app").getImmediate(),d=new el(new b2(i.getProvider("auth-internal")),new C2(u,i.getProvider("app-check-internal")),(function(m,T){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ce(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new La(m.options.projectId,T)})(u,o),u);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),br(AT,ST,e),br(AT,ST,"esm2020")})();const fd=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:hA,Bytes:Bn,CollectionReference:wi,DocumentReference:Kt,DocumentSnapshot:Sr,FieldPath:yf,FieldValue:lg,Firestore:el,FirestoreError:Ce,GeoPoint:vs,Query:Du,QueryDocumentSnapshot:gu,QuerySnapshot:po,SnapshotMetadata:ba,Timestamp:_t,VectorValue:Ts,_AutoId:tf,_ByteString:on,_DatabaseId:La,_DocumentKey:Ne,_EmptyAuthCredentialsProvider:jx,_FieldPath:rn,_cast:Mi,_logWarn:To,_validateIsNotUsedTogether:zx,collection:gV,connectFirestoreEmulator:sA,deleteDoc:kV,doc:yV,ensureFirestoreConfigured:gf,executeWrite:cg,getDoc:MV,getDocs:DV,getFirestore:iA,setDoc:PV},Symbol.toStringTag,{value:"Module"}));function pA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gA=pA,yA=new Su("auth","Firebase",pA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=new Pp("@firebase/auth");function LV(n,...e){Hd.logLevel<=Je.WARN&&Hd.warn(`Auth (${Ka}): ${n}`,...e)}function xd(n,...e){Hd.logLevel<=Je.ERROR&&Hd.error(`Auth (${Ka}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(n,...e){throw dg(n,...e)}function $s(n,...e){return dg(n,...e)}function _A(n,e,t){const i={...gA(),[e]:t};return new Su("auth","Firebase",i).create(e,{appName:n.name})}function Ii(n){return _A(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return yA.create(n,...e)}function Me(n,e,...t){if(!n)throw dg(e,...t)}function Ai(n){const e="INTERNAL ASSERTION FAILED: "+n;throw xd(e),new Error(e)}function Pi(n,e){n||Ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function UV(){return vE()==="http:"||vE()==="https:"}function vE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UV()||ZM()||"connection"in navigator)?navigator.onLine:!0}function qV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Pi(t>e,"Short delay should be less than long delay!"),this.isMobile=QM()||eD()}get(){return OV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(n,e){Pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],BV=new Pu(3e4,6e4);function kr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Li(n,e,t,i,o={}){return TA(n,o,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const d=Cu({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return WM()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Ja(n.emulatorConfig.host)&&(m.credentials="include"),vA.fetch()(await EA(n,n.config.apiHost,t,d),m)})}async function TA(n,e,t){n._canInitEmulator=!1;const i={...FV,...e};try{const o=new HV(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw hd(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const d=l.ok?u.errorMessage:u.error.message,[g,m]=d.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw hd(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw hd(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw hd(n,"user-disabled",u);const T=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw _A(n,T,m);Es(n,T)}}catch(o){if(o instanceof Vi)throw o;Es(n,"network-request-failed",{message:String(o)})}}async function ku(n,e,t,i,o={}){const l=await Li(n,e,t,i,o);return"mfaPendingCredential"in l&&Es(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function EA(n,e,t,i){const o=`${e}${t}?${i}`,l=n,u=l.config.emulator?fg(n.config,o):`${n.config.apiScheme}://${o}`;return jV.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function zV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class HV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i($s(this.auth,"network-request-failed")),BV.get())})}}function hd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=$s(n,e,i);return o.customData._tokenResponse=t,o}function TE(n){return n!==void 0&&n.enterprise!==void 0}class GV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return zV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YV(n,e){return Li(n,"GET","/v2/recaptchaConfig",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $V(n,e){return Li(n,"POST","/v1/accounts:delete",e)}async function Gd(n,e){return Li(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xA(n,e=!1){const t=bn(n),i=await t.getIdToken(e),o=hg(i);Me(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:o,token:i,authTime:yu(Om(o.auth_time)),issuedAtTime:yu(Om(o.iat)),expirationTime:yu(Om(o.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Om(n){return Number(n)*1e3}function hg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return xd("JWT malformed, contained fewer than 3 sections"),null;try{const o=Ex(t);return o?JSON.parse(o):(xd("Failed to decode base64 JWT payload"),null)}catch(o){return xd("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function EE(n){const e=hg(n);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Vi&&JV(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function JV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yu(this.lastLoginAt),this.creationTime=yu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yd(n){var E;const e=n.auth,t=await n.getIdToken(),i=await ja(n,Gd(e,{idToken:t}));Me(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const l=(E=o.providerUserInfo)!=null&&E.length?AA(o.providerUserInfo):[],u=QV(n.providerData,l),d=n.isAnonymous,g=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),m=d?g:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new xp(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(n,T)}async function bA(n){const e=bn(n);await Yd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function QV(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function AA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XV(n,e){const t=await TA(n,{},async()=>{const i=Cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,u=await EA(n,o,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:d,body:i};return n.emulatorConfig&&Ja(n.emulatorConfig.host)&&(g.credentials="include"),vA.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function WV(n,e){return Li(n,"POST","/v2/accounts:revokeToken",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):EE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const t=EE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:l}=await XV(e,t);this.updateTokensAndExpiration(i,o,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:l}=t,u=new Ra;return i&&(Me(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(Me(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),l&&(Me(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ra,this.toJSON())}_performRefresh(){return Ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(n,e){Me(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _s{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new KV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new xp(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await ja(this,this.stsTokenManager.getToken(this.auth,e));return Me(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return xA(this,e)}reload(){return bA(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _s({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Yd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ns(this.auth.app))return Promise.reject(Ii(this.auth));const e=await this.getIdToken();return await ja(this,$V(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:E,emailVerified:b,isAnonymous:C,providerData:P,stsTokenManager:O}=t;Me(E&&O,e,"internal-error");const G=Ra.fromJSON(this.name,O);Me(typeof E=="string",e,"internal-error"),_r(i,e.name),_r(o,e.name),Me(typeof b=="boolean",e,"internal-error"),Me(typeof C=="boolean",e,"internal-error"),_r(l,e.name),_r(u,e.name),_r(d,e.name),_r(g,e.name),_r(m,e.name),_r(T,e.name);const ne=new _s({uid:E,auth:e,email:o,emailVerified:b,displayName:i,isAnonymous:C,photoURL:u,phoneNumber:l,tenantId:d,stsTokenManager:G,createdAt:m,lastLoginAt:T});return P&&Array.isArray(P)&&(ne.providerData=P.map(j=>({...j}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,t,i=!1){const o=new Ra;o.updateFromServerResponse(t);const l=new _s({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Yd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Me(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?AA(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(l!=null&&l.length),d=new Ra;d.updateFromIdToken(i);const g=new _s({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:u}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new xp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=new Map;function Si(n){Pi(n instanceof Function,"Expected a class definition");let e=xE.get(n);return e?(Pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}SA.type="NONE";const bp=SA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(n,e,t){return`firebase:${n}:${e}:${t}`}class Ma{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:l}=this.auth;this.fullUserKey=bd(this.userKey,o.apiKey,l),this.fullPersistenceKey=bd("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Gd(this.auth,{idToken:e}).catch(()=>{});return t?_s._fromGetAccountInfoResponse(this.auth,t,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ma(Si(bp),e,i);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=o[0]||Si(bp);const u=bd(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const T=await m._get(u);if(T){let E;if(typeof T=="string"){const b=await Gd(e,{idToken:T}).catch(()=>{});if(!b)break;E=await _s._fromGetAccountInfoResponse(e,b,T)}else E=_s._fromJSON(e,T);m!==l&&(d=E),l=m;break}}catch{}const g=o.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Ma(l,e,i):(l=g[0],d&&await l._set(u,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new Ma(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(NA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(MA(e))return"Blackberry";if(DA(e))return"Webos";if(wA(e))return"Safari";if((e.includes("chrome/")||IA(e))&&!e.includes("edge/"))return"Chrome";if(RA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function CA(n=vn()){return/firefox\//i.test(n)}function wA(n=vn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IA(n=vn()){return/crios\//i.test(n)}function NA(n=vn()){return/iemobile/i.test(n)}function RA(n=vn()){return/android/i.test(n)}function MA(n=vn()){return/blackberry/i.test(n)}function DA(n=vn()){return/webos/i.test(n)}function mg(n=vn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ZV(n=vn()){var e;return mg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function eL(){return tD()&&document.documentMode===10}function PA(n=vn()){return mg(n)||RA(n)||DA(n)||MA(n)||/windows phone/i.test(n)||NA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(n,e=[]){let t;switch(n){case"Browser":t=bE(vn());break;case"Worker":t=`${bE(vn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ka}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,d)=>{try{const g=e(l);u(g)}catch(g){d(g)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nL(n,e={}){return Li(n,"GET","/v2/passwordPolicy",kr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL=6;class iL{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??sL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AE(this),this.idTokenSubscription=new AE(this),this.beforeStateQueue=new tL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Si(t)),this._initializationPromise=this.queue(async()=>{var i,o,l;if(!this._deleted&&(this.persistenceManager=await Ma.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Gd(this,{idToken:e}),i=await _s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(ns(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&(g!=null&&g.user)&&(i=g.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ns(this.app))return Promise.reject(Ii(this));const t=e?bn(e):null;return t&&Me(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ns(this.app)?Promise.reject(Ii(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ns(this.app)?Promise.reject(Ii(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nL(this),t=new iL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Su("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await WV(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Si(e)||this._popupRedirectResolver;Me(t,this,"argument-error"),this.redirectPersistenceManager=await Ma.create(this,[Si(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(d,this,"internal-error"),d.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,o);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(ns(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&LV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Io(n){return bn(n)}class AE{constructor(e){this.auth=e,this.observer=null,this.addObserver=uD(t=>this.observer=t)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _f={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oL(n){_f=n}function VA(n){return _f.loadJS(n)}function aL(){return _f.recaptchaEnterpriseScript}function lL(){return _f.gapiScript}function uL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class cL{constructor(){this.enterprise=new dL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class dL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const fL="recaptcha-enterprise",LA="NO_RECAPTCHA";class hL{constructor(e){this.type=fL,this.auth=Io(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,d)=>{YV(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new GV(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(g=>{d(g)})})}function o(l,u,d){const g=window.grecaptcha;TE(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(LA)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new cL().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(d=>{if(!t&&TE(window.grecaptcha))o(d,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=aL();g.length!==0&&(g+=d),VA(g).then(()=>{o(d,l,u)}).catch(m=>{u(m)})}}).catch(d=>{u(d)})})}}async function SE(n,e,t,i=!1,o=!1){const l=new hL(n);let u;if(o)u=LA;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const g=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const g=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Ap(n,e,t,i,o){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await SE(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await SE(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(n,e){const t=Vp(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(yo(l,e??{}))return o;Es(o,"already-initialized")}return t.initialize({options:e})}function mL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Si);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function OA(n,e,t){const i=Io(n);Me(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,l=qA(e),{host:u,port:d}=pL(e),g=d===null?"":`:${d}`,m={url:`${l}//${u}${g}/`},T=Object.freeze({host:u,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Me(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Me(yo(m,i.config.emulator)&&yo(T,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=T,i.settings.appVerificationDisabledForTesting=!0,Ja(u)?(Sx(`${l}//${u}${g}`),Cx("Auth",!0)):gL()}function qA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pL(n){const e=qA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const l=o[1];return{host:l,port:CE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:CE(u)}}}function CE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ai("not implemented")}_getIdTokenResponse(e){return Ai("not implemented")}_linkToIdToken(e,t){return Ai("not implemented")}_getReauthenticationResolver(e){return Ai("not implemented")}}async function yL(n,e){return Li(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _L(n,e){return ku(n,"POST","/v1/accounts:signInWithPassword",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(n,e){return ku(n,"POST","/v1/accounts:signInWithEmailLink",kr(n,e))}async function TL(n,e){return ku(n,"POST","/v1/accounts:signInWithEmailLink",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba extends vf{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Ba(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ba(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,t,"signInWithPassword",_L);case"emailLink":return vL(e,{email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,i,"signUpPassword",yL);case"emailLink":return TL(e,{idToken:t,email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Da(n,e){return ku(n,"POST","/v1/accounts:signInWithIdp",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL="http://localhost";class Dr extends vf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Es("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...l}=t;if(!i||!o)return null;const u=new Dr(i,o);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Da(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Da(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Da(e,t)}buildRequest(){const e={requestUri:EL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function bL(n){const e=ru(ou(n)).link,t=e?ru(ou(e)).deep_link_id:null,i=ru(ou(n)).deep_link_id;return(i?ru(ou(i)).link:null)||i||t||e||n}class Tf{constructor(e){const t=ru(ou(e)),i=t.apiKey??null,o=t.oobCode??null,l=xL(t.mode??null);Me(i&&o&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=bL(e);try{return new Tf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(){this.providerId=No.PROVIDER_ID}static credential(e,t){return Ba._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Tf.parseLink(t);return Me(i,"argument-error"),Ba._fromEmailAndCode(e,i.code,i.tenantId)}}No.PROVIDER_ID="password";No.EMAIL_PASSWORD_SIGN_IN_METHOD="password";No.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends FA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Vu{constructor(){super("facebook.com")}static credential(e){return Dr._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dr._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ti.credential(t,i)}catch{return null}}}Ti.GOOGLE_SIGN_IN_METHOD="google.com";Ti.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Vu{constructor(){super("github.com")}static credential(e){return Dr._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Vu{constructor(){super("twitter.com")}static credential(e,t){return Dr._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return xi.credential(t,i)}catch{return null}}}xi.TWITTER_SIGN_IN_METHOD="twitter.com";xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(n,e){return ku(n,"POST","/v1/accounts:signUp",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const l=await _s._fromIdTokenResponse(e,i,o),u=wE(i);return new xo({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=wE(i);return new xo({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function wE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d extends Vi{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,$d.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new $d(e,t,i,o)}}function jA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?$d._fromErrorAndOperation(n,l,e,i):l})}async function SL(n,e,t=!1){const i=await ja(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(n,e,t=!1){const{auth:i}=n;if(ns(i.app))return Promise.reject(Ii(i));const o="reauthenticate";try{const l=await ja(n,jA(i,o,e,n),t);Me(l.idToken,i,"internal-error");const u=hg(l.idToken);Me(u,i,"internal-error");const{sub:d}=u;return Me(n.uid===d,i,"user-mismatch"),xo._forOperation(n,o,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Es(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BA(n,e,t=!1){if(ns(n.app))return Promise.reject(Ii(n));const i="signIn",o=await jA(n,i,e),l=await xo._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(l.user),l}async function zA(n,e){return BA(Io(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HA(n){const e=Io(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wL(n,e,t){if(ns(n.app))return Promise.reject(Ii(n));const i=Io(n),u=await Ap(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AL).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&HA(n),g}),d=await xo._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(d.user),d}function IL(n,e,t){return ns(n.app)?Promise.reject(Ii(n)):zA(bn(n),No.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&HA(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NL(n,e){return Li(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=bn(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await ja(i,NL(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const d=i.providerData.find(({providerId:g})=>g==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function GA(n,e,t,i){return bn(n).onIdTokenChanged(e,t,i)}function YA(n,e,t){return bn(n).beforeAuthStateChanged(e,t)}function ML(n,e,t,i){return bn(n).onAuthStateChanged(e,t,i)}function DL(n){return bn(n).signOut()}const Jd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Jd,"1"),this.storage.removeItem(Jd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL=1e3,kL=10;class JA extends $A{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);eL()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,kL):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},PL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JA.type="LOCAL";const KA=JA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA extends $A{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}QA.type="SESSION";const pg=QA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Ef(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:l}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const d=Array.from(u).map(async m=>m(t.origin,l)),g=await VL(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ef.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,u;return new Promise((d,g)=>{const m=gg("",20);o.port1.start();const T=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(E){const b=E;if(b.data.eventId===m)switch(b.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(b.data.response);break;default:clearTimeout(T),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(){return window}function UL(n){Js().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(){return typeof Js().WorkerGlobalScope<"u"&&typeof Js().importScripts=="function"}async function OL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function FL(){return XA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA="firebaseLocalStorageDb",jL=1,Kd="firebaseLocalStorage",ZA="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function xf(n,e){return n.transaction([Kd],e?"readwrite":"readonly").objectStore(Kd)}function BL(){const n=indexedDB.deleteDatabase(WA);return new Lu(n).toPromise()}function Sp(){const n=indexedDB.open(WA,jL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Kd,{keyPath:ZA})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Kd)?e(i):(i.close(),await BL(),e(await Sp()))})})}async function IE(n,e,t){const i=xf(n,!0).put({[ZA]:e,value:t});return new Lu(i).toPromise()}async function zL(n,e){const t=xf(n,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function NE(n,e){const t=xf(n,!0).delete(e);return new Lu(t).toPromise()}const HL=800,GL=3;class eS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>GL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ef._getInstance(FL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await OL(),!this.activeServiceWorker)return;this.sender=new LL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await IE(e,Jd,"1"),await NE(e,Jd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>IE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>zL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>NE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=xf(o,!1).getAll();return new Lu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),HL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}eS.type="LOCAL";const tS=eS;new Pu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(n,e){return e?Si(e):(Me(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg extends vf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Da(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Da(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Da(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $L(n){return BA(n.auth,new yg(n),n.bypassAuthState)}function JL(n){const{auth:e,user:t}=n;return Me(t,e,"internal-error"),CL(t,new yg(n),n.bypassAuthState)}async function KL(n){const{auth:e,user:t}=n;return Me(t,e,"internal-error"),SL(t,new yg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,t,i,o,l=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:l,error:u,type:d}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $L;case"linkViaPopup":case"linkViaRedirect":return KL;case"reauthViaPopup":case"reauthViaRedirect":return JL;default:Es(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL=new Pu(2e3,1e4);class Aa extends nS{constructor(e,t,i,o,l){super(e,t,o,l),this.provider=i,this.authWindow=null,this.pollId=null,Aa.currentPopupAction&&Aa.currentPopupAction.cancel(),Aa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject($s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Aa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QL.get())};e()}}Aa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL="pendingRedirect",Ad=new Map;class WL extends nS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Ad.get(this.auth._key());if(!e){try{const i=await ZL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Ad.set(this.auth._key(),e)}return this.bypassAuthState||Ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZL(n,e){const t=nU(e),i=tU(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function eU(n,e){Ad.set(n._key(),e)}function tU(n){return Si(n._redirectPersistence)}function nU(n){return bd(XL,n.config.apiKey,n.name)}async function sU(n,e,t=!1){if(ns(n.app))return Promise.reject(Ii(n));const i=Io(n),o=YL(i,e),u=await new WL(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iU=600*1e3;class rU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!sS(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError($s(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iU&&this.cachedEventUids.clear(),this.cachedEventUids.has(RE(e))}saveEventToCache(e){this.cachedEventUids.add(RE(e)),this.lastProcessedEventTime=Date.now()}}function RE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function sS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function oU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aU(n,e={}){return Li(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,uU=/^https?/;async function cU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await aU(n);for(const t of e)try{if(dU(t))return}catch{}Es(n,"unauthorized-domain")}function dU(n){const e=Ep(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!uU.test(t))return!1;if(lU.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=new Pu(3e4,6e4);function ME(){const n=Js().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function hU(n){return new Promise((e,t)=>{var o,l,u;function i(){ME(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ME(),t($s(n,"network-request-failed"))},timeout:fU.get()})}if((l=(o=Js().gapi)==null?void 0:o.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=Js().gapi)!=null&&u.load)i();else{const d=uL("iframefcb");return Js()[d]=()=>{gapi.load?i():t($s(n,"network-request-failed"))},VA(`${lL()}?onload=${d}`).catch(g=>t(g))}}).catch(e=>{throw Sd=null,e})}let Sd=null;function mU(n){return Sd=Sd||hU(n),Sd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=new Pu(5e3,15e3),gU="__/auth/iframe",yU="emulator/auth/iframe",_U={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TU(n){const e=n.config;Me(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?fg(e,yU):`https://${n.config.authDomain}/${gU}`,i={apiKey:e.apiKey,appName:n.name,v:Ka},o=vU.get(n.config.apiHost);o&&(i.eid=o);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Cu(i).slice(1)}`}async function EU(n){const e=await mU(n),t=Js().gapi;return Me(t,n,"internal-error"),e.open({where:document.body,url:TU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_U,dontclear:!0},i=>new Promise(async(o,l)=>{await i.restyle({setHideOnLeave:!1});const u=$s(n,"network-request-failed"),d=Js().setTimeout(()=>{l(u)},pU.get());function g(){Js().clearTimeout(d),o(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bU=500,AU=600,SU="_blank",CU="http://localhost";class DE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wU(n,e,t,i=bU,o=AU){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const g={...xU,width:i.toString(),height:o.toString(),top:l,left:u},m=vn().toLowerCase();t&&(d=IA(m)?SU:t),CA(m)&&(e=e||CU,g.scrollbars="yes");const T=Object.entries(g).reduce((b,[C,P])=>`${b}${C}=${P},`,"");if(ZV(m)&&d!=="_self")return IU(e||"",d),new DE(null);const E=window.open(e||"",d,T);Me(E,n,"popup-blocked");try{E.focus()}catch{}return new DE(E)}function IU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU="__/auth/handler",RU="emulator/auth/handler",MU=encodeURIComponent("fac");async function PE(n,e,t,i,o,l){Me(n.config.authDomain,n,"auth-domain-config-required"),Me(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ka,eventId:o};if(e instanceof FA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",lD(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,E]of Object.entries({}))u[T]=E}if(e instanceof Vu){const T=e.getScopes().filter(E=>E!=="");T.length>0&&(u.scopes=T.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const T of Object.keys(d))d[T]===void 0&&delete d[T];const g=await n._getAppCheckToken(),m=g?`#${MU}=${encodeURIComponent(g)}`:"";return`${DU(n)}?${Cu(d).slice(1)}${m}`}function DU({config:n}){return n.emulator?fg(n,RU):`https://${n.authDomain}/${NU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="webStorageSupport";class PU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pg,this._completeRedirectFn=sU,this._overrideRedirectResult=eU}async _openPopup(e,t,i,o){var u;Pi((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await PE(e,t,i,Ep(),o);return wU(e,l,gg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const l=await PE(e,t,i,Ep(),o);return UL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(Pi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await EU(e),i=new rU(e);return t.register("authEvent",o=>(Me(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qm,{type:qm},o=>{var u;const l=(u=o==null?void 0:o[0])==null?void 0:u[qm];l!==void 0&&t(!!l),Es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return PA()||wA()||mg()}}const iS=PU;var kE="@firebase/auth",VE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LU(n){ka(new _o("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=i.options;Me(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kA(n)},m=new rL(i,o,l,g);return mL(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ka(new _o("auth-internal",e=>{const t=Io(e.getProvider("auth").getImmediate());return(i=>new kU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),br(kE,VE,VU(n)),br(kE,VE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UU=300,OU=Ax("authIdTokenMaxAge")||UU;let LE=null;const qU=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>OU)return;const o=t==null?void 0:t.token;LE!==o&&(LE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function rS(n=Rx()){const e=Vp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=UA(n,{popupRedirectResolver:iS,persistence:[tS,KA,pg]}),i=Ax("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=qU(l.toString());YA(t,u,()=>u(t.currentUser)),GA(t,d=>u(d))}}const o=xx("auth");return o&&OA(t,`http://${o}`),t}function FU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}oL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const l=$s("internal-error");l.customData=o,t(l)},i.type="text/javascript",i.charset="UTF-8",FU().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LU("Browser");const md=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Tf,AuthCredential:vf,EmailAuthCredential:Ba,EmailAuthProvider:No,FacebookAuthProvider:vi,GithubAuthProvider:Ei,GoogleAuthProvider:Ti,OAuthCredential:Dr,TwitterAuthProvider:xi,beforeAuthStateChanged:YA,browserLocalPersistence:KA,browserPopupRedirectResolver:iS,browserSessionPersistence:pg,connectAuthEmulator:OA,createUserWithEmailAndPassword:wL,getAuth:rS,getIdTokenResult:xA,inMemoryPersistence:bp,indexedDBLocalPersistence:tS,initializeAuth:UA,onAuthStateChanged:ML,onIdTokenChanged:GA,prodErrorMap:gA,reload:bA,signInWithCredential:zA,signInWithEmailAndPassword:IL,signOut:DL,updateProfile:RL},Symbol.toStringTag,{value:"Module"}));let Fm=null,_i=null,gs=null;const jU=()=>{try{return Ia().hasFirebase?(Fm=Nx(Ot.firebase),_i=iA(Fm),gs=rS(Fm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};jU();const bi={async signUp(n,e,t){if(!gs)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:i,updateProfile:o}=await yi(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:d}=await Promise.resolve().then(()=>md);return{createUserWithEmailAndPassword:u,updateProfile:d}},void 0),l=await i(gs,n,e);return await o(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(i){return console.error("خطأ في التسجيل:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async signIn(n,e){if(!gs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await yi(async()=>{const{signInWithEmailAndPassword:o}=await Promise.resolve().then(()=>md);return{signInWithEmailAndPassword:o}},void 0);return{success:!0,user:(await t(gs,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!gs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await yi(async()=>{const{signOut:e}=await Promise.resolve().then(()=>md);return{signOut:e}},void 0);return await n(gs),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return gs?gs.currentUser:null},async onAuthStateChanged(n){if(!gs)return n(null),()=>{};try{const{onAuthStateChanged:e}=await yi(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>md);return{onAuthStateChanged:t}},void 0);return e(gs,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:i,setDoc:o}=await yi(async()=>{const{doc:u,setDoc:d}=await Promise.resolve().then(()=>fd);return{doc:u,setDoc:d}},void 0),l=i(_i,n,e);return await o(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(i){return console.error("خطأ في حفظ البيانات:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async getData(n,e){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:i}=await yi(async()=>{const{doc:u,getDoc:d}=await Promise.resolve().then(()=>fd);return{doc:u,getDoc:d}},void 0),o=t(_i,n,e),l=await i(o);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await yi(async()=>{const{collection:l,getDocs:u}=await Promise.resolve().then(()=>fd);return{collection:l,getDocs:u}},void 0),i=await t(e(_i,n)),o=[];return i.forEach(l=>{o.push({id:l.id,...l.data()})}),{success:!0,data:o}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:i}=await yi(async()=>{const{doc:l,deleteDoc:u}=await Promise.resolve().then(()=>fd);return{doc:l,deleteDoc:u}},void 0),o=t(_i,n,e);return await i(o),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},UE=({onSuccess:n,onClose:e,hideCloseButton:t=!1})=>{const[i,o]=he.useState(!0),[l,u]=he.useState({email:"",password:"",displayName:""}),[d,g]=he.useState(!1),[m,T]=he.useState(""),E=async C=>{C.preventDefault(),g(!0),T("");try{let P;if(i)P=await bi.signIn(l.email,l.password);else{if(!l.displayName.trim()){T("الاسم مطلوب"),g(!1);return}P=await bi.signUp(l.email,l.password,l.displayName)}P.success?n(P.user):T(P.error||"حدث خطأ غير متوقع")}catch{T("حدث خطأ في الاتصال")}finally{g(!1)}},b=C=>{u(P=>({...P,[C.target.name]:C.target.value}))};return f.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:i?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&f.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),f.jsxs("form",{onSubmit:E,className:"space-y-4",children:[!i&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),f.jsx("input",{type:"text",id:"displayName",name:"displayName",value:l.displayName,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!i})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),f.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),f.jsx("input",{type:"password",id:"password",name:"password",value:l.password,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),m&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:f.jsx("p",{className:"text-red-600 text-sm",children:m})}),f.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:d?"⏳ جاري المعالجة...":i?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("button",{onClick:()=>o(!i),className:"text-blue-600 hover:text-blue-700 font-medium",children:i?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},oS=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),f.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Pa=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),f.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),BU=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),f.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),zU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),HU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),GU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),YU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),$U=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),bf=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),jm=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Bm=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),JU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),KU=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:i,onAddTransaction:o,currentUser:l,onSignOut:u})=>{const d=he.useMemo(()=>{const m=new Date().getFullYear(),T=[];for(let E=m+1;E>=2020;E--)T.push(E);return T},[]),g=he.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return f.jsx("header",{className:"bg-slate-50/95 backdrop-blur-lg border-b border-slate-200 py-3 shadow-sm",children:f.jsx("div",{className:"container mx-auto px-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-wide",children:"لوحة التحكم المالية"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Developed by K.A Team"})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 p-1.5 rounded-lg",children:[f.jsx("select",{value:n,onChange:m=>t(parseInt(m.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:d.map(m=>f.jsx("option",{value:m,children:m},m))}),f.jsx("select",{value:e,onChange:m=>i(m.target.value==="all"?"all":parseInt(m.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:g.map(m=>f.jsx("option",{value:m.value,children:m.label},m.value))})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:l.displayName||"المستخدم"}),f.jsx("p",{className:"text-xs text-slate-500",children:l.email})]}),f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),f.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),f.jsxs("button",{onClick:o,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[f.jsx($U,{className:"w-5 h-5"}),f.jsx("span",{children:"إضافة حركة"})]})]})]})})})},zm=[{id:"summary",label:"📊 الملخص",icon:zU},{id:"analysis",label:"📈 التحليل",icon:HU},{id:"transactions",label:"💳 الحركات",icon:GU},{id:"budget",label:"✨ الميزانية"},{id:"investment",label:"💹 الاستثمار"},{id:"ai-assistant",label:"🤖 المحلل الذكي"},{id:"cards",label:"💳 إدارة البطاقات"},{id:"bank",label:"🏦 البنك"},{id:"installments",label:"📱 الأقساط"},{id:"debts-loans",label:"📊 الديون والقروض"},{id:"settings",label:"⚙️ الإعدادات"}],OE=["summary","analysis","transactions"],QU=({activeTab:n,setActiveTab:e})=>{const[t,i]=he.useState(!1),o=d=>{e(d),i(!1)},l=zm.filter(d=>OE.includes(d.id)),u=zm.filter(d=>!OE.includes(d.id));return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:zm.map(d=>f.jsx("button",{onClick:()=>o(d.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===d.id?"active":""}`,children:d.label},d.id))}),f.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[l.map(d=>{const g=d.icon;return f.jsxs("button",{onClick:()=>o(d.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===d.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[g&&f.jsx(g,{}),f.jsx("span",{className:"text-xs",children:d.label.split(" ")[1]})]},d.id)}),f.jsxs("button",{onClick:()=>i(!t),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${t?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[f.jsx(YU,{}),f.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),t&&f.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>i(!1),children:f.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:d=>d.stopPropagation(),children:[f.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),f.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:u.map(d=>f.jsxs("button",{onClick:()=>o(d.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===d.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[f.jsx("span",{className:"text-2xl",children:d.label.split(" ")[0]}),f.jsx("span",{className:"text-xs font-semibold",children:d.label.split(" ")[1]})]},d.id))})]})})]})},XU=({className:n})=>f.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-slate-200/80 to-transparent ${n}`}),Hm=()=>f.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[f.jsx("div",{className:"h-6 w-1/2 bg-slate-200 rounded mb-6"}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),f.jsx("div",{className:"h-4 w-5/6 bg-slate-200 rounded"}),f.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),f.jsx("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]}),f.jsx(XU,{})]}),WU=()=>f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[f.jsx("div",{className:"h-16 mb-3"}),f.jsx("div",{className:"flex flex-wrap justify-center mb-8 bg-slate-100 rounded-xl p-2 h-14"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[f.jsx(Hm,{}),f.jsx(Hm,{}),f.jsx(Hm,{})]})]}),Ue=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),ZU=({title:n,details:e,barColor:t})=>f.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("h4",{className:"font-bold text-sm text-slate-800",children:n}),f.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),f.jsxs("div",{className:"bg-slate-50 p-2 rounded-lg border border-gray-200",children:[f.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[f.jsx("span",{className:"text-slate-600",children:"المستحق:"}),f.jsx("span",{className:"font-semibold number-display text-slate-900 text-xs",children:Ue(e.balance)})]}),f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsx("span",{className:"text-slate-600",children:"المتبقي:"}),f.jsx("span",{className:"font-semibold number-display text-emerald-700 text-xs",children:Ue(e.available)})]})]}),f.jsx("div",{className:"bg-slate-200 rounded-full h-1.5 overflow-hidden",children:f.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),e4=({calculations:n,categories:e})=>{const t=Object.values(n.expensesByCategory).reduce((o,l)=>o+Number(l),0);if(t===0)return f.jsx("p",{className:"text-slate-500 text-center p-4 text-sm",children:"لا توجد مصاريف في هذه الفترة."});const i=Object.entries(n.expensesByCategory).sort(([,o],[,l])=>l-o);return f.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:i.map(([o,l])=>{const u=e.find(g=>g.id===o);u&&`${u.icon}${u.name}`;const d=Number(l)/t*100;return f.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-base",children:(u==null?void 0:u.icon)||"📊"}),f.jsx("span",{className:"font-medium text-slate-700 truncate text-sm",title:u==null?void 0:u.name,children:(u==null?void 0:u.name)||"غير مصنف"})]}),f.jsx("span",{className:"font-semibold text-slate-900 number-display text-sm bg-slate-50 px-2 py-1 rounded border border-gray-200",children:Ue(l)})]}),f.jsx("div",{className:"mt-2 bg-slate-200 rounded-full h-1.5 overflow-hidden",children:f.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${d.toFixed(1)}%`}})}),f.jsxs("div",{className:"text-xs text-slate-500 mt-1 text-center",children:[d.toFixed(1),"%"]})]},o)})})},t4=({calculations:n,categories:e})=>{const{totalIncome:t,totalExpenses:i,cardDetails:o,cardPayments:l,bankAccountDetails:u,totalDebt:d,totalAvailable:g,totalLimits:m,totalBankBalance:T}=n,E=t-i,b=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"];return f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[f.jsxs("div",{className:"card-consistent xl:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"💳 ملخص ديون البطاقات"}),f.jsx("div",{className:"space-y-4",children:Object.values(o).map((C,P)=>f.jsx(ZU,{title:C.name,details:C,barColor:b[P%b.length]},C.id))}),f.jsx("div",{className:"mt-4 p-3 bg-slate-100 rounded-lg",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[f.jsx("p",{className:"text-red-600 font-semibold text-xs mb-2",children:"إجمالي الديون"}),f.jsx("p",{className:"font-bold text-sm text-red-600 number-display",children:Ue(d)})]}),f.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[f.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-2",children:"إجمالي المتاح"}),f.jsx("p",{className:"font-bold text-sm text-emerald-600 number-display",children:Ue(g)})]}),f.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[f.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),f.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:Ue(m)})]})]})})]}),f.jsxs("div",{className:"card-consistent xl:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),f.jsx("div",{className:"space-y-3",children:Object.values(u).map(C=>{const P=C.balance>0?"bank-card-positive":C.balance<0?"bank-card-negative":"bank-card-neutral";return f.jsxs("div",{className:`card-consistent ${P} h-32 flex flex-col justify-between`,children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:C.name}),f.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:Ue(C.balance)})}),f.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),f.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",Ue(C.deposits)]})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),f.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",Ue(C.withdrawals)]})]})]})]},C.id)})}),f.jsxs("div",{className:"mt-4 card-consistent text-center",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-2",children:"🏦 إجمالي الأرصدة البنكية"}),f.jsx("p",{className:"font-bold text-xl text-blue-900 number-display",children:Ue(T)})]})]}),f.jsxs("div",{className:"card-consistent xl:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"إجمالي الدخل:"}),f.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:Ue(t)})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"إجمالي المصاريف:"}),f.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:Ue(i)})]}),f.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(o).map((C,P)=>f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsxs("span",{className:"text-slate-500",children:["مصاريف ",C.name,":"]}),f.jsx("span",{className:`font-semibold ${b[P%b.length].replace("bg-","text-")} number-display`,children:Ue(C.balance+(l[C.id]||0))})]},C.id)),f.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(l).map(([C,P])=>{var O;return f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(O=o[C])==null?void 0:O.name,":"]}),f.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:Ue(P)})]},C)}),f.jsx("hr",{className:"my-2 border-slate-200"}),f.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[f.jsx("span",{children:"الصافي:"}),f.jsx("span",{className:`number-display ${E>=0?"text-emerald-500":"text-red-500"}`,children:Ue(E)})]})]})]}),f.jsxs("div",{className:"card-consistent xl:col-span-1",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),f.jsx(e4,{calculations:n,categories:e})]})]})},n4=({transactions:n,allTransactions:e,categories:t,deleteTransaction:i,editTransaction:o,state:l})=>{const[u,d]=he.useState(""),[g,m]=he.useState(""),[T,E]=he.useState(""),[b,C]=he.useState(""),[P,O]=he.useState(""),G=H=>{const Z={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return Z[H]?Z[H]:l.cards[H]?`💳 ${l.cards[H].name}`:l.bankAccounts[H]?`🏦 ${l.bankAccounts[H].name}`:H},ne=H=>{const Z={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(Z[H])return Z[H];if(H.endsWith("-payment")){const U=H.replace("-payment","");if(l.cards[U])return`💳 سداد ${l.cards[U].name}`}return H},j=he.useMemo(()=>{let H=n;if(b&&P){const Z=new Date(b),U=new Date(P);U.setHours(23,59,59,999),H=e.filter(N=>{const w=new Date(N.date);return w>=Z&&w<=U})}return H=H.filter(Z=>{const U=u.toLowerCase(),N=t.find(V=>V.id===Z.categoryId),w=Z.description.toLowerCase().includes(U)||(N==null?void 0:N.name.toLowerCase().includes(U)),R=!g||Z.paymentMethod===g,k=!T||Z.categoryId===T;return w&&R&&k}),H.sort((Z,U)=>{const N=parseInt(Z.id.replace("trans-","").split("-")[0]);return parseInt(U.id.replace("trans-","").split("-")[0])-N})},[n,e,u,g,T,b,P,t]),q=he.useMemo(()=>j.reduce((H,Z)=>(Z.type==="income"||Z.type.toString().includes("payment")||Z.type==="investment-withdrawal"?H.positive+=Z.amount:H.negative+=Z.amount,H),{positive:0,negative:0}),[j]);return f.jsx("div",{className:"space-y-6 animate-fade-in",children:f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),f.jsx("input",{type:"date",id:"dateFrom",value:b,onChange:H=>C(H.target.value),className:"w-full p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),f.jsx("input",{type:"date",id:"dateTo",value:P,onChange:H=>O(H.target.value),className:"w-full p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),f.jsxs("select",{id:"filterMethod",value:g,onChange:H=>m(H.target.value),className:"p-2 w-full",children:[f.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(H=>f.jsxs("option",{value:H.id,children:["🏦 ",H.name]},H.id)),f.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(H=>f.jsxs("option",{value:H.id,children:["💳 ",H.name]},H.id)),f.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),f.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),f.jsxs("select",{id:"filterCategory",value:T,onChange:H=>E(H.target.value),className:"p-2 w-full",children:[f.jsx("option",{value:"",children:"كل الفئات"}),t.map(H=>f.jsx("option",{value:H.id,children:H.name},H.id))]})]}),f.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[f.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),f.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:u,onChange:H=>d(H.target.value),className:"p-2 w-full"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),f.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),f.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:f.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:Ue(q.positive)})})]}),f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),f.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),f.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:f.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:Ue(q.negative)})})]}),f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),f.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),f.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:f.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:Ue(q.positive-q.negative)})})]})]}),f.jsxs("div",{className:"overflow-x-auto",children:[f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),f.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),f.jsx("tbody",{children:j.map(H=>{const Z=t.find(N=>N.id===H.categoryId),U=H.type==="income"||H.type.toString().includes("payment")||H.type==="investment-withdrawal";return f.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[f.jsx("td",{className:"p-3",children:H.date}),f.jsx("td",{className:"p-3",children:G(H.paymentMethod)}),f.jsx("td",{className:"p-3",children:ne(H.type)}),f.jsxs("td",{className:`p-3 font-semibold number-display ${U?"text-emerald-500":"text-red-500"}`,children:[U?"+":"-"," ",Ue(H.amount)]}),f.jsx("td",{className:"p-3",children:Z?`${Z.icon} ${Z.name}`:"غير محدد"}),f.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:H.description||"-"}),f.jsx("td",{className:"p-3 text-center",children:f.jsxs("div",{className:"flex gap-2 justify-center",children:[f.jsx("button",{onClick:()=>o(H.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),f.jsx("button",{onClick:()=>i(H.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:f.jsx(Pa,{})})]})})]},H.id)})})]}),j.length===0&&f.jsxs("div",{className:"text-center p-8 text-slate-500",children:[f.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),f.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},s4=()=>f.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),i4=({calculations:n,filteredTransactions:e})=>{const[t,i]=he.useState([{id:"1",text:'أهلاً بك! أنا مساعدك المالي الشامل. يمكنك أن تسألني أسئلة تفصيلية عن وضعك المالي، مثل "ما هو إجمالي ديوني؟" أو "هل إنفاقي هذا الشهر يتوافق مع أهدافي؟"',sender:"ai"}]),[o,l]=he.useState(""),[u,d]=he.useState(!1),g=he.useRef(null);he.useEffect(()=>{var T;(T=g.current)==null||T.scrollTo(0,g.current.scrollHeight)},[t,u]);const m=async T=>{T.preventDefault();const E=o.trim();if(!E||u)return;const b={id:Date.now().toString(),text:E,sender:"user"};i(C=>[...C,b]),l(""),d(!0);try{const P=await mx(E,{periodSummary:n,transactions:e}),O={id:(Date.now()+1).toString(),text:P,sender:"ai"};i(G=>[...G,O])}catch(C){const P={id:(Date.now()+1).toString(),text:C instanceof Error?C.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};i(O=>[...O,P])}finally{d(!1)}};return f.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[f.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل المالي الذكي"}),f.jsx("p",{className:"text-sm text-slate-500",children:"اسأل أي شيء عن بياناتك المالية للشهر المحدد"})]}),f.jsxs("div",{ref:g,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[t.map(T=>f.jsx("div",{className:`chat-bubble ${T.sender==="user"?"user-bubble":"ai-bubble"}`,children:f.jsx("p",{dangerouslySetInnerHTML:{__html:T.text.replace(/\n/g,"<br />")}})},T.id)),u&&f.jsx(s4,{})]}),f.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:f.jsxs("form",{onSubmit:m,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:o,onChange:T=>l(T.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:u}),f.jsx("button",{type:"submit",disabled:u,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:f.jsx(oS,{})})]})})]})},r4=({calculations:n,categories:e,allTransactions:t})=>{const i=he.useRef(null),o=he.useRef(null),l=he.useRef({}),u=he.useMemo(()=>Object.entries(n.expensesByCategory).map(([g,m])=>{const T=e.find(E=>E.id===g);return{name:T?`${T.icon} ${T.name}`:"غير محدد",value:m}}).sort((g,m)=>m.value-g.value),[n.expensesByCategory,e]),d=he.useMemo(()=>{const g={},m=new Date;for(let T=5;T>=0;T--){const b=new Date(m.getFullYear(),m.getMonth()-T,1).toLocaleString("en-US",{month:"short",year:"numeric"});g[b]={income:0,expenses:0}}return t.forEach(T=>{const b=new Date(T.date).toLocaleString("en-US",{month:"short",year:"numeric"});g[b]&&(T.type==="income"&&(g[b].income+=T.amount),(T.type==="expense"||T.type==="bnpl-payment")&&(g[b].expenses+=T.amount))}),{labels:Object.keys(g),incomeData:Object.values(g).map(T=>T.income),expensesData:Object.values(g).map(T=>T.expenses)}},[t]);return he.useEffect(()=>{var m,T;const g=window.Chart;if(g){if((m=l.current.pie)==null||m.destroy(),(T=l.current.bar)==null||T.destroy(),i.current&&u.length>0){const E=i.current.getContext("2d");E&&(l.current.pie=new g(E,{type:"doughnut",data:{labels:u.map(b=>b.name),datasets:[{data:u.map(b=>b.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(o.current&&d.labels.length>0){const E=o.current.getContext("2d");E&&(l.current.bar=new g(E,{type:"bar",data:{labels:d.labels,datasets:[{label:"الدخل",data:d.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:d.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var E,b;(E=l.current.pie)==null||E.destroy(),(b=l.current.bar)==null||b.destroy()}}},[u,d]),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📊 توزيع مصاريف الفترة"}),f.jsx("div",{className:"h-80",children:u.length>0?f.jsx("canvas",{ref:i}):f.jsx("p",{className:"text-center text-slate-500 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),f.jsx("div",{className:"h-80",children:f.jsx("canvas",{ref:o})})]})]})},o4=({state:n,setLoading:e,setModal:t})=>{const[i,o]=he.useState(""),[l,u]=he.useState(""),d=async()=>{const g=parseFloat(i);if(isNaN(g)||g<=0){t({title:"خطأ",body:"<p>الرجاء إدخال مبلغ ميزانية صحيح.</p>",confirmText:"موافق",hideCancel:!0});return}e(!0,"جاري إنشاء خطة الميزانية..."),u("");try{const m=new Date;m.setDate(m.getDate()-60);const T=n.transactions.filter(b=>new Date(b.date)>=m&&b.type==="expense");if(T.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const E=await yx(g,n.categories,T);u(E)}catch(m){const T=m instanceof Error?m.message:"حدث خطأ غير متوقع.";t({title:"خطأ في إنشاء الميزانية",body:`<p>${T}</p>`,confirmText:"موافق",hideCancel:!0})}finally{e(!1)}};return f.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"✨ الميزانية الشهرية الذكية"}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 bg-slate-100 rounded-lg",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx("label",{htmlFor:"monthly-budget-input",className:"block text-sm font-medium text-slate-600 mb-1",children:"أدخل إجمالي ميزانيتك الشهرية (ريال)"}),f.jsx("input",{type:"number",id:"monthly-budget-input",className:"w-full p-2",placeholder:"5000",value:i,onChange:g=>o(g.target.value)})]}),f.jsx("button",{onClick:d,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:"✨ إنشاء خطة الميزانية"})]}),f.jsx("div",{className:"prose max-w-none",children:l?f.jsx("div",{dangerouslySetInnerHTML:{__html:l.replace(/### (.*)/g,'<h4 class="text-lg font-bold text-slate-900 mt-3 mb-2">$1</h4>').replace(/\n/g,"<br />")}}):f.jsx("p",{className:"text-center text-slate-500",children:"أدخل ميزانيتك أعلاه للحصول على خطة مخصصة بناءً على إنفاقك."})})]})},a4=({state:n,setState:e,calculations:t,setModal:i})=>{const[o,l]=he.useState([{id:"1",text:'أهلاً بك! أنا مرشدك لفهم عالم الاستثمار. يمكنك سؤالي عن استراتيجيات، أو مفاهيم مثل "ما هو الاستثمار طويل الأجل؟". تذكر، أنا لا أقدم نصائح مباشرة لشراء أسهم معينة.',sender:"ai"}]),[u,d]=he.useState(""),[g,m]=he.useState(!1),T=he.useRef(null);he.useEffect(()=>{var P;(P=T.current)==null||P.scrollTo(0,T.current.scrollHeight)},[o,g]);const E=P=>{P.preventDefault();const O=P.target,G=parseFloat(O.elements.namedItem("investment-amount").value),ne=O.elements.namedItem("investment-type").value,j=O.elements.namedItem("payment-method").value;if(isNaN(G)||G<=0){i({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const q={amount:G,date:new Date().toISOString().split("T")[0],description:ne==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:j,type:ne==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(H=>({...H,transactions:[...H.transactions,{...q,id:`trans-${Date.now()}`}]})),O.reset()},b=async P=>{P.preventDefault();const O=u.trim();if(!(!O||g)){l(G=>[...G,{id:Date.now().toString(),text:O,sender:"user"}]),d(""),m(!0);try{const G=await gx(O);l(ne=>[...ne,{id:(Date.now()+1).toString(),text:G,sender:"ai"}])}catch(G){l(ne=>[...ne,{id:(Date.now()+1).toString(),text:G instanceof Error?G.message:"عذراً، حدث خطأ.",sender:"ai"}])}finally{m(!1)}}},C=()=>{const P=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;i({show:!0,title:"تحديث قيمة المحفظة",body:P,confirmText:"حفظ",onConfirm:()=>{const O=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(O)||O<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(G=>({...G,investments:{...G.investments,currentValue:O}}))}})};return f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[f.jsxs("div",{className:"glass-card p-6 text-center",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),f.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:Ue(n.investments.currentValue)}),f.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",f.jsx("span",{className:"font-semibold number-display text-slate-600",children:Ue(t.totalInvestmentDeposits)})]}),f.jsx("button",{onClick:C,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),f.jsxs("form",{onSubmit:E,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),f.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),f.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[f.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),f.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),f.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(P=>f.jsxs("option",{value:P.id,children:["🏦 ",P.name]},P.id))})]}),f.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),f.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[f.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 مستشارك الاستثماري الذكي"}),f.jsx("p",{className:"text-sm text-slate-500",children:"اسأل عن المفاهيم والاستراتيجيات لاتخاذ قرارات أفضل"})]}),f.jsxs("div",{ref:T,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[o.map(P=>f.jsx("div",{className:`chat-bubble ${P.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:P.text.replace(/\n/g,"<br/>")}},P.id)),g&&f.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),f.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:f.jsxs("form",{onSubmit:b,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:u,onChange:P=>d(P.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:g}),f.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:g,children:f.jsx(oS,{})})]})})]})]})},l4=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:i})=>{const o=l=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(u=>`
            <tr class="hover:bg-slate-50">
                <td class="p-2">${u.postingDate||u.date}</td>
                <td class="p-2 truncate" title="${u.description}">${u.description}</td>
                <td class="p-2 number-display text-red-500">${Ue(u.amount)}</td>
            </tr>
        `).join("");return f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>i(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:f.jsx(Pa,{})})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),f.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),f.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:f.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[Ue(e.statementDueAmount)," ريال"]})}),f.jsxs("div",{className:"flex justify-between items-center text-xs",children:[f.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),f.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),f.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[f.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),f.jsxs("p",{className:"font-bold text-red-800 number-display",children:[Ue(n.balance)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[f.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),f.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[Ue(n.limit)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[f.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),f.jsxs("p",{className:"font-bold text-green-800 number-display",children:[Ue(n.available)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[f.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),f.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),f.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[f.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),f.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:f.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${o(e.upcomingTransactions)}</tbody>`}})})]})]})},u4=({state:n,openCardFormModal:e,deleteCard:t})=>{const i=he.useMemo(()=>{const l={};return Object.values(n.cards).forEach(u=>{const d=new Date,g=d.getDate(),m=d.getMonth(),T=d.getFullYear();let E,b,C;g>u.statementDay?E=new Date(T,m,u.statementDay):E=new Date(T,m-1,u.statementDay),b=new Date(E.getFullYear(),E.getMonth()-1,u.statementDay+1);let P=E.getMonth()+1,O=E.getFullYear();P>11&&(P=0,O+=1),C=new Date(O,P,u.dueDay);const G=n.transactions.filter(q=>{const H=new Date(q.postingDate||q.date);return q.paymentMethod===u.id&&(q.type==="expense"||q.type==="bnpl-payment")&&H>=b&&H<=E}),ne=n.transactions.filter(q=>{const H=new Date(q.postingDate||q.date);return q.paymentMethod===u.id&&(q.type==="expense"||q.type==="bnpl-payment")&&H>E}),j=G.reduce((q,H)=>q+H.amount,0);l[u.id]={statementDueAmount:j,dueDate:C,totalOutstanding:0,upcomingTransactions:ne}}),l},[n.transactions,n.cards]),o=Object.values(n.cards);return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),f.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(l=>{const u=n.transactions.filter(g=>g.paymentMethod===l.id&&(g.type==="expense"||g.type==="bnpl-payment")).reduce((g,m)=>g+m.amount,0)-n.transactions.filter(g=>g.type===`${l.id}-payment`).reduce((g,m)=>g+m.amount,0),d={...l,balance:u,available:l.limit-u,usagePercentage:l.limit>0?u/l.limit*100:0};return f.jsx(l4,{card:d,statementDetails:i[d.id],openCardFormModal:e,deleteCard:t},d.id)})})]})},c4=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const i=n.replace("-payment","");if(e.cards[i])return`💳 سداد ${e.cards[i].name}`}return n},d4=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),f.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:f.jsx(Pa,{})})]})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[f.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),f.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:Ue(n.balance)})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[f.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),f.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:Ue(n.deposits)})]}),f.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[f.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),f.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:Ue(n.withdrawals)})]})]})]}),f4=({state:n,setState:e,calculations:t,filteredTransactions:i,categories:o,setModal:l,openBankAccountFormModal:u,deleteBankAccount:d,openTransferModal:g})=>f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),f.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&f.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),f.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(m=>f.jsx(d4,{account:m,openBankAccountFormModal:u,deleteBankAccount:d},m.id))}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),f.jsx("tbody",{children:i.filter(m=>n.bankAccounts[m.paymentMethod]).sort((m,T)=>new Date(T.date).getTime()-new Date(m.date).getTime()).map(m=>{var C;const T=["income","investment-withdrawal"].includes(m.type),E=T?"text-emerald-500":"text-red-500",b=o.find(P=>P.id===m.categoryId);return f.jsxs("tr",{className:"border-b border-gray-200/50",children:[f.jsx("td",{className:"p-3",children:m.date}),f.jsx("td",{className:"p-3",children:(C=n.bankAccounts[m.paymentMethod])==null?void 0:C.name}),f.jsx("td",{className:"p-3",children:c4(m.type,n)}),f.jsxs("td",{className:`p-3 font-semibold ${E} number-display`,children:[T?"+":"-",Ue(m.amount)]}),f.jsx("td",{className:"p-3",children:b?`${b.icon} ${b.name}`:"-"}),f.jsx("td",{className:"p-3 text-slate-500",children:m.description||"-"})]},m.id)})})]})})]})]}),pd=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},h4=({state:n,setState:e,filteredTransactions:t,setModal:i})=>{const[o,l]=FE.useState(!1),u=()=>{const j=n.installments.filter(w=>w.paid<w.total),q=j.filter(w=>w.provider==="tabby-bnpl"),H=j.filter(w=>w.provider==="tamara-bnpl"),Z=q.reduce((w,R)=>{const k=R.total-R.paid;return w+R.installmentAmount*k},0),U=H.reduce((w,R)=>{const k=R.total-R.paid;return w+R.installmentAmount*k},0),N=Z+U;return{tabbyTotal:Z,tamaraTotal:U,grandTotal:N,activeCount:j.length,completedCount:n.installments.filter(w=>w.paid>=w.total).length}},d=()=>{const j=n.installments.filter(Z=>Z.paid<Z.total);if(j.length===0)return null;const q=n.transactions.filter(Z=>Z.isInstallmentPayment);if(q.length===0){const Z=j.sort((w,R)=>new Date(w.createdAt).getTime()-new Date(R.createdAt).getTime())[0],U=new Date(Z.createdAt),N=new Date(U);return N.setDate(N.getDate()+30),N.toISOString().split("T")[0]}let H=null;for(const Z of j){const U=q.filter(N=>N.installmentId===Z.id).sort((N,w)=>new Date(w.date).getTime()-new Date(N.date).getTime());if(U.length>0){const N=U[0],w=new Date(N.date),R=new Date(w);R.setDate(R.getDate()+30),(!H||R<new Date(H))&&(H=R.toISOString().split("T")[0])}else{const N=new Date(Z.createdAt),w=new Date(N);w.setDate(w.getDate()+30),(!H||w<new Date(H))&&(H=w.toISOString().split("T")[0])}}return H},g=()=>n.installments.filter(q=>q.paid<q.total).reduce((q,H)=>q+H.installmentAmount,0),m=()=>{const j=n.installments.filter(H=>H.paid<H.total),q=n.transactions.filter(H=>H.isInstallmentPayment);return j.map(H=>{const Z=q.filter(N=>N.installmentId===H.id).sort((N,w)=>new Date(w.date).getTime()-new Date(N.date).getTime());let U;if(Z.length>0){const N=Z[0],w=new Date(N.date),R=new Date(w);R.setDate(R.getDate()+30),U=R.toISOString().split("T")[0]}else{const N=new Date(H.createdAt),w=new Date(N);w.setDate(w.getDate()+30),U=w.toISOString().split("T")[0]}return{installment:H,nextPaymentDate:U}}).sort((H,Z)=>new Date(H.nextPaymentDate).getTime()-new Date(Z.nextPaymentDate).getTime())},T=j=>{const q=n.transactions.find(U=>U.id===j);if(!q||!q.isInstallmentPayment||!n.installments.find(U=>U.id===q.installmentId))return;const Z=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${q.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${q.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${q.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(U=>`<option value="${U.id}" ${q.paymentMethod===U.id?"selected":""}>🏦 ${U.name}</option>`).join("")}
                        <option value="cash" ${q.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(U=>`<option value="${U.id}" ${q.paymentMethod===U.id?"selected":""}>💳 ${U.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;i({show:!0,title:"تعديل حركة القسط",body:Z,confirmText:"حفظ التعديلات",onConfirm:()=>{const U=parseFloat(document.getElementById("edit-amount").value),N=document.getElementById("edit-date").value,w=document.getElementById("edit-description").value,R=document.getElementById("edit-payment-method").value;e(k=>({...k,transactions:k.transactions.map(V=>V.id===j?{...V,amount:U,date:N,description:w,paymentMethod:R}:V)})),i({show:!1})}})},E=j=>{const q=n.transactions.find(Z=>Z.id===j);if(!q||!q.isInstallmentPayment)return;i({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const Z=q.installmentId;e(U=>({...U,transactions:U.transactions.filter(N=>N.id!==j),installments:U.installments.map(N=>N.id===Z?{...N,paid:Math.max(0,N.paid-1)}:N)})),i({show:!1})}})},b=j=>{const q=n.installments.find(Z=>Z.id===j);if(!q)return;const H=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${q.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${q.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${q.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${q.paid}" min="0" max="${q.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;i({show:!0,title:"تعديل خطة القسط",body:H,confirmText:"حفظ التعديلات",onConfirm:()=>{const Z=document.getElementById("edit-description").value,U=parseFloat(document.getElementById("edit-amount").value),N=parseInt(document.getElementById("edit-total").value),w=parseInt(document.getElementById("edit-paid").value);e(R=>({...R,installments:R.installments.map(k=>k.id===j?{...k,description:Z,installmentAmount:U,total:N,paid:w}:k)})),i({show:!1})}})},C=j=>{const q=n.installments.find(Z=>Z.id===j);if(!q)return;const H=`<p>هل أنت متأكد من حذف خطة القسط "${q.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;i({show:!0,title:"حذف خطة القسط",body:H,confirmText:"حذف",onConfirm:()=>{e(Z=>({...Z,installments:Z.installments.filter(U=>U.id!==j),transactions:Z.transactions.filter(U=>U.installmentId!==j)})),i({show:!1})}})},P=j=>{const q=n.installments.find(U=>U.id===j);if(!q||q.paid>=q.total)return;let H="";Object.values(n.bankAccounts).forEach(U=>{H+=`<option value="${U.id}">🏦 ${U.name}</option>`}),H+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(U=>{H+=`<option value="${U.id}">💳 ${U.name}</option>`});const Z=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${q.description}" بقيمة ${Ue(q.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${H}</select></div>`;i({show:!0,title:"سداد قسط",body:Z,confirmText:"تأكيد الدفع",onConfirm:()=>{var k;const U=document.getElementById("installment-payment-source").value,N=n.categories.find(V=>V.name==="سداد فواتير"||V.name==="💳 سداد فواتير"),w=(N==null?void 0:N.id)||((k=n.categories.find(V=>V.name==="أخرى"))==null?void 0:k.id)||"",R={id:"trans-"+Date.now(),amount:q.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${q.paid+1} لـ: ${q.description}`,paymentMethod:U,type:"bnpl-payment",categoryId:w,isInstallmentPayment:!0,installmentId:j};e(V=>{const F=V.installments.map(D=>{if(D.id===j){const ke={...D,paid:D.paid+1};return console.log("🔄 تحديث قسط:",{id:D.id,paid:D.paid,newPaid:ke.paid,total:D.total}),ke}return D});return{...V,transactions:[...V.transactions,R],installments:F}})}})},O=n.installments.filter(j=>j.paid<j.total),G=n.transactions.filter(j=>j.isInstallmentPayment),ne=u();return d(),g(),f.jsxs("div",{className:"animate-fade-in",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[f.jsx("div",{className:"flex justify-between items-start mb-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"ملخص الأقساط"}),f.jsx("p",{className:"text-sm text-slate-600",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"🎯"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),f.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Ue(ne.grandTotal)})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"📱"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Ue(ne.tabbyTotal)})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"📱"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Ue(ne.tamaraTotal)})]})]}),m().length>0&&f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("span",{className:"text-2xl",children:"⏰"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),f.jsx("div",{className:"space-y-2",children:m().slice(0,3).map((j,q)=>f.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-slate-700",children:j.installment.description}),f.jsx("p",{className:"text-xs text-slate-500",children:pd(j.installment.provider,n)})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(j.nextPaymentDate).toLocaleDateString("en-GB")}),f.jsx("p",{className:"text-xs text-slate-600",children:Ue(j.installment.installmentAmount)})]})]},j.installment.id))})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ne.activeCount}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),f.jsx("div",{className:"text-center",children:f.jsxs("button",{onClick:()=>l(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[f.jsx("p",{className:"text-2xl font-bold text-green-600",children:ne.completedCount}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),m().length>0&&f.jsx("button",{onClick:()=>{n.installments.filter(q=>q.paid<q.total).forEach(q=>{P(q.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),f.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900",children:"📱 خطط الأقساط النشطة"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:O.length>0?O.map(j=>{const q=j.paid/j.total*100;return console.log("📊 عرض قسط:",{id:j.id,paid:j.paid,total:j.total,progress:q}),f.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900",children:j.description}),f.jsx("p",{className:"text-sm text-slate-500",children:pd(j.provider,n)})]})]}),f.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:f.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[Ue(j.installmentAmount),"/شهر"]})})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-gray-200 mb-3",children:[f.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:f.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${q}%`}})}),f.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[f.jsxs("span",{className:"font-medium",children:[j.paid," / ",j.total," مدفوع"]}),f.jsxs("span",{className:"font-medium",children:["متبقي: ",j.total-j.paid]})]}),f.jsx("div",{className:"text-center mt-2",children:f.jsxs("span",{className:"text-xs text-slate-500",children:[q.toFixed(1),"% مكتمل"]})})]}),f.jsxs("div",{className:"flex gap-2 mt-3",children:[f.jsx("button",{onClick:()=>P(j.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),f.jsx("button",{onClick:()=>b(j.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),f.jsx("button",{onClick:()=>C(j.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},j.id)}):f.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:f.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),f.jsxs("div",{className:"glass-card p-6 mt-8",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 سجل دفعات الأقساط"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"المصدر"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الإجراءات"})]})}),f.jsx("tbody",{children:G.sort((j,q)=>new Date(q.date).getTime()-new Date(j.date).getTime()).map(j=>f.jsxs("tr",{className:"border-b border-gray-200/50",children:[f.jsx("td",{className:"p-3",children:new Date(j.date).toLocaleDateString("en-GB")}),f.jsx("td",{className:"p-3 text-slate-600",children:j.description}),f.jsx("td",{className:"p-3",children:pd(j.paymentMethod,n)}),f.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:Ue(j.amount)}),f.jsx("td",{className:"p-3",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>T(j.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),f.jsx("button",{onClick:()=>E(j.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},j.id))})]})})]}),o&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:j=>j.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),f.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),f.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(j=>j.paid>=j.total).map(j=>f.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-green-800",children:j.description}),f.jsx("p",{className:"text-sm text-green-600",children:pd(j.provider,n)})]}),f.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:j.total}),f.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:Ue(j.installmentAmount)}),f.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:Ue(j.total*j.installmentAmount)}),f.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},j.id)),Object.values(n.installments).filter(j=>j.paid>=j.total).length===0&&f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),f.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),f.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),f.jsx("div",{className:"flex justify-end mt-6",children:f.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},m4=({state:n,setState:e,setModal:t,openLoanFormModal:i})=>{const[o,l]=he.useState("loans"),[u,d]=he.useState(!1),[g,m]=he.useState(!1),[T,E]=he.useState(!1),b=U=>{switch(U){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},C=U=>{switch(U){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},P=U=>{switch(U){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},O=U=>{switch(U){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},G=U=>{e(N=>({...N,loans:Object.fromEntries(Object.entries(N.loans).filter(([w])=>w!==U))}))},ne=U=>{e(N=>({...N,debtsToMe:Object.fromEntries(Object.entries(N.debtsToMe).filter(([w])=>w!==U))}))},j=U=>{e(N=>({...N,debtsFromMe:Object.fromEntries(Object.entries(N.debtsFromMe).filter(([w])=>w!==U))}))},q=Object.values(n.loans).filter(U=>U.status==="active").length,H=Object.values(n.debtsToMe).filter(U=>U.status!=="paid").length,Z=Object.values(n.debtsFromMe).filter(U=>U.status!=="paid").length;return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"📊 الديون والقروض"})}),f.jsxs("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[f.jsxs("button",{onClick:()=>l("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="loans"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["🏦 القروض (",q,")"]}),f.jsxs("button",{onClick:()=>l("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="debts-to-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💰 الديون لي (",H,")"]}),f.jsxs("button",{onClick:()=>l("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="debts-from-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💸 الديون علي (",Z,")"]})]}),o==="loans"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),f.jsx("button",{onClick:()=>i(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),f.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(U=>f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:b(U.type)})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900",children:U.name}),f.jsxs("p",{className:"text-sm text-slate-500",children:[C(U.type)," - ",U.lender]})]})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>i(U.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${U.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>G(U.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${U.name}`,children:f.jsx(Pa,{})})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Ue(U.totalAmount)})]}),(U.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[f.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),f.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((U.prepaidAmount||0)/U.totalAmount*100),"%"]})]}),f.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:f.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(U.prepaidAmount||0)/U.totalAmount*100}%`}})}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[f.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[f.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((U.prepaidAmount||0)/U.monthlyPayment)}),f.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),f.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[f.jsx("p",{className:"text-blue-700 font-bold text-sm",children:U.totalMonths-Math.floor((U.prepaidAmount||0)/U.monthlyPayment)}),f.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ue(U.monthlyPayment)})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),f.jsxs("p",{className:"font-semibold text-slate-800",children:[U.remainingMonths||0," شهر"]})]})]}),(U.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),f.jsx("p",{className:"text-orange-900 font-bold text-lg",children:Ue(U.prepaidAmount||0)})]}),f.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),f.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(U.status)}`,children:O(U.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(U.startDate).toLocaleDateString("en-GB")]})]})]})]},U.id))})]}),o==="debts-to-me"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),f.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"💰"}),f.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(U=>f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900",children:U.debtor}),f.jsx("p",{className:"text-sm text-slate-500",children:U.description})]}),f.jsx("button",{onClick:()=>ne(U.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${U.debtor}`,children:f.jsx(Pa,{})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),f.jsx("p",{className:"text-xl font-bold text-green-900",children:Ue(U.amount)})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(U.status)}`,children:O(U.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(U.date).toLocaleDateString("ar-SA")]})]})]})]},U.id))})]}),o==="debts-from-me"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),f.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"💸"}),f.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(U=>f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900",children:U.creditor}),f.jsx("p",{className:"text-sm text-slate-500",children:U.description})]}),f.jsx("button",{onClick:()=>j(U.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${U.creditor}`,children:f.jsx(Pa,{})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),f.jsx("p",{className:"text-xl font-bold text-red-900",children:Ue(U.amount)})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(U.status)}`,children:O(U.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(U.date).toLocaleDateString("ar-SA")]})]})]})]},U.id))})]})]})},p4=({state:n,setState:e,setModal:t,setLoading:i,onRestore:o})=>{const[l,u]=he.useState(Ia()),[d,g]=he.useState({connected:!1}),[m,T]=he.useState(!0),[E,b]=he.useState({firebase:l.hasFirebase,gemini:l.hasGemini});he.useEffect(()=>{const ie=Ia();u(ie),b({firebase:ie.hasFirebase,gemini:ie.hasGemini}),ie.hasFirebase?(async()=>{try{T(!0);const xe=await bi.getData("test","connection");g({connected:!0})}catch(xe){g({connected:!1,error:xe instanceof Error?xe.message:"خطأ في الاتصال"})}finally{T(!1)}})():(g({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),T(!1))},[]);const C=({isValid:ie})=>ie?f.jsx(jm,{className:"w-6 h-6 text-green-500"}):f.jsx(Bm,{className:"w-6 h-6 text-red-500"}),P=()=>f.jsx(JU,{className:"w-6 h-6 text-yellow-500"}),[O,G]=he.useState({name:"",icon:""}),[ne,j]=he.useState(null),[q,H]=he.useState({name:"",icon:""}),[Z,U]=he.useState({name:"",icon:""}),N=()=>{if(!O.name.trim()||!O.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة للفئة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`cat-${Date.now()}`,name:O.name.trim(),icon:O.icon.trim()};e(xe=>({...xe,categories:[...xe.categories,ce]})),G({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},[w,R]=he.useState(!1),k=async()=>{const ie=O.name.trim();if(!ie){t({title:"خطأ",body:"<p>الرجاء إدخال اسم الفئة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}R(!0);try{const{suggestCategoryIcon:ce,initializeAi:xe}=await yi(async()=>{const{suggestCategoryIcon:nt,initializeAi:An}=await Promise.resolve().then(()=>kM);return{suggestCategoryIcon:nt,initializeAi:An}},void 0);xe();const Ze=await ce(ie);Ze&&Ze.trim()?G(nt=>({...nt,icon:Ze.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{R(!1)}},V=ie=>{n.transactions.some(ce=>ce.categoryId===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات. يرجى تغيير فئة الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,categories:ce.categories.filter(xe=>xe.id!==ie)})),t({title:"نجح",body:"<p>تم حذف الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},[F,D]=he.useState(!1),ke=async()=>{const ie=q.name.trim();if(!ie){t({title:"خطأ",body:"<p>يرجى إدخال اسم نوع الحركة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{D(!0);const ce=await Zm(ie);ce&&ce.trim()?H(xe=>({...xe,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Transaction type icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{D(!1)}},[fe,$]=he.useState(!1),de=async()=>{const ie=Z.name.trim();if(!ie){t({title:"خطأ",body:"<p>يرجى إدخال اسم وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{$(!0);const ce=await Zm(ie);ce&&ce.trim()?U(xe=>({...xe,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Payment method icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{$(!1)}},_e=()=>{if(!q.name.trim()||!q.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لنوع الحركة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-type-${Date.now()}`,name:q.name.trim(),icon:q.icon.trim(),isCustom:!0};e(xe=>({...xe,customTransactionTypes:[...xe.customTransactionTypes||[],ce]})),H({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},je=ie=>{n.transactions.some(ce=>ce.type===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات. يرجى تغيير نوع الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customTransactionTypes:(ce.customTransactionTypes||[]).filter(xe=>xe.id!==ie)})),t({title:"نجح",body:"<p>تم حذف نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},We=()=>{if(!Z.name.trim()||!Z.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لوسيلة الدفع.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-payment-${Date.now()}`,name:Z.name.trim(),icon:Z.icon.trim(),isCustom:!0};e(xe=>({...xe,customPaymentMethods:[...xe.customPaymentMethods||[],ce]})),U({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},B=ie=>{n.transactions.some(ce=>ce.paymentMethod===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات. يرجى تغيير وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customPaymentMethods:(ce.customPaymentMethods||[]).filter(xe=>xe.id!==ie)})),t({title:"نجح",body:"<p>تم حذف وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},re=()=>{try{const ie=JSON.stringify(n,null,2),ce=new Blob([ie],{type:"application/json"}),xe=URL.createObjectURL(ce),Ze=document.createElement("a");Ze.href=xe,Ze.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ze),Ze.click(),document.body.removeChild(Ze),URL.revokeObjectURL(xe),t({title:"نجح",body:"<p>تم إنشاء النسخة الاحتياطية المحلية بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})}catch{t({title:"خطأ",body:"<p>فشل إنشاء النسخة الاحتياطية.</p>",hideCancel:!0,confirmText:"موافق"})}},ye=async()=>{i(!0,"جاري حفظ النسخة الاحتياطية في السحابة...");try{const ie=await bi.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(ie.success)t({title:"نجح",body:"<p>تم حفظ النسخة الاحتياطية في السحابة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"});else throw new Error(ie.error)}catch{t({title:"خطأ",body:"<p>فشل في حفظ النسخة الاحتياطية في السحابة.</p>",hideCancel:!0,confirmText:"موافق"})}finally{i(!1)}},ve=ie=>{var Ze;const ce=(Ze=ie.target.files)==null?void 0:Ze[0];if(!ce)return;const xe=new FileReader;xe.onload=nt=>{var An;try{const Ct=JSON.parse((An=nt.target)==null?void 0:An.result);if(Ct!=null&&Ct.transactions&&(Ct!=null&&Ct.categories))o?o(Ct):t({show:!0,title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية.</p>",confirmText:"نعم، استعادة",onConfirm:()=>{const bs={transactions:Ct.transactions||[],categories:Ct.categories||[],installments:Ct.installments||[],investments:Ct.investments||{currentValue:0},cards:Ct.cards||{},bankAccounts:Ct.bankAccounts||{}};e(bs),t({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح.</p>",confirmText:"موافق",hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:"خطأ",body:"<p>فشل في استعادة النسخة الاحتياطية. الملف غير صالح.</p>",confirmText:"موافق",hideCancel:!0})}},xe.readAsText(ce),ie.target.value=""};return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"⚙️ إعدادات النظام"})}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"🔑 حالة مفاتيح API"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"text-2xl",children:"🔥"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:"Firebase Configuration"}),f.jsxs("p",{className:"text-sm text-slate-600",children:["Project ID: ",Ot.firebase.projectId]})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:E.firebase?d.connected?f.jsxs(f.Fragment,{children:[f.jsx(jm,{className:"w-6 h-6 text-green-500"}),f.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):f.jsxs(f.Fragment,{children:[f.jsx(P,{}),f.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Bm,{className:"w-6 h-6 text-red-500"}),f.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"text-2xl",children:"🤖"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),f.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",Ot.gemini.model]})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:E.gemini?f.jsxs(f.Fragment,{children:[f.jsx(jm,{className:"w-6 h-6 text-green-500"}),f.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Bm,{className:"w-6 h-6 text-red-500"}),f.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!l.isValid&&f.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[f.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),f.jsx("ul",{className:"space-y-1",children:l.errors.map((ie,ce)=>f.jsxs("li",{className:"text-sm text-red-600",children:["• ",ie]},ce))})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📱 معلومات المشروع"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ot.app.name})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ot.app.version})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ot.app.environment})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(C,{isValid:l.isValid&&d.connected}),f.jsx("span",{className:`text-sm font-semibold ${l.isValid&&d.connected?"text-green-600":"text-red-600"}`,children:l.isValid&&d.connected?"جاهز":"يحتاج إعداد"})]})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),f.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!l.isValid||!d.connected)&&f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📝 تعليمات الإعداد"}),f.jsxs("div",{className:"space-y-4",children:[!E.gemini&&f.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),f.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[f.jsxs("li",{children:["اذهب إلى ",f.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),f.jsx("li",{children:"أنشئ مفتاح API جديد"}),f.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",f.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),f.jsxs("li",{children:["أو ضعه في ملف ",f.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!E.firebase&&f.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),f.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",f.jsx("br",{}),"• VITE_FIREBASE_API_KEY",f.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",f.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",f.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",f.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",f.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📂 إدارة الفئات"}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم الفئة",value:O.name,onChange:ie=>G(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:O.icon,onChange:ie=>G(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:k,disabled:!O.name.trim()||w,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:w?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),f.jsx("button",{onClick:N,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(ie=>f.jsxs("div",{className:"p-3 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-lg",children:ie.icon}),f.jsx("span",{className:"text-sm font-medium text-slate-800",children:ie.name})]}),f.jsx("button",{onClick:()=>V(ie.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},ie.id))})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:q.name,onChange:ie=>H(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:q.icon,onChange:ie=>H(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:ke,disabled:!q.name.trim()||F,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:F?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),f.jsx("button",{onClick:_e,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),f.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(ie=>f.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm",children:ie.icon}),f.jsx("span",{className:"text-xs font-medium text-slate-800",children:ie.name})]}),f.jsx("button",{onClick:()=>je(ie.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},ie.id))})]}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:Z.name,onChange:ie=>U(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:Z.icon,onChange:ie=>U(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:de,disabled:!Z.name.trim()||fe,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:fe?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),f.jsx("button",{onClick:We,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),f.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(ie=>f.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm",children:ie.icon}),f.jsx("span",{className:"text-xs font-medium text-slate-800",children:ie.name})]}),f.jsx("button",{onClick:()=>B(ie.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},ie.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💰 دخل"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💸 مصاريف"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 سداد قسط"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💹 إيداع استثماري"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💹 سحب استثماري"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),f.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[f.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💵 نقدي"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 تابي"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 تمارا"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💳 سداد البطاقات"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"💾 النسخ الاحتياطي والاستعادة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),f.jsx("button",{onClick:re,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),f.jsx("button",{onClick:ye,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),f.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:ve}),f.jsx("button",{onClick:()=>{var ie;return(ie=document.getElementById("backup-file"))==null?void 0:ie.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors",children:"📥 استعادة البيانات"})]})]})]}),f.jsx("div",{className:"text-center",children:f.jsx("button",{onClick:()=>{u(Ia()),window.location.reload()},disabled:m,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:m?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},g4=({onClose:n,onSave:e,initialData:t,categories:i,cards:o,bankAccounts:l,loans:u,setModalConfig:d})=>{var ke;const[g,m]=he.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((ke=i.find(fe=>fe.name==="أخرى"))==null?void 0:ke.id)||null}),[T,E]=he.useState(!1),[b,C]=he.useState(""),[P,O]=he.useState({isOpen:!1,text:""}),[G,ne]=he.useState(!1),[j,q]=he.useState(!1),[H,Z]=he.useState(4),[U,N]=he.useState(Object.keys(l)[0]||"cash");he.useEffect(()=>{var fe;t?m(t):(fe=navigator.clipboard)!=null&&fe.readText&&(async()=>{try{const $=await navigator.clipboard.readText();$&&$.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==$&&O({isOpen:!0,text:$})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const w=fe=>{const{name:$,value:de}=fe.target;if($==="paymentMethod"){const _e=de.includes("bnpl");q(_e),_e&&m(je=>({...je,type:"expense"}))}m(_e=>({..._e,[$]:$==="amount"?parseFloat(de):de}))},R=fe=>{if(fe.preventDefault(),g.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(de=>de.status==="active").length>0){ne(!0);return}j&&g.paymentMethod.includes("bnpl")?e({...g,bnplData:{installmentsCount:H,initialPaymentSource:U,installmentAmount:g.amount/H}},t==null?void 0:t.id):e(g,t==null?void 0:t.id)},k=async fe=>{if(fe.trim()){E(!0),C("");try{const $=await px(fe,i,o,l),de=JSON.parse($);de.error?C(de.error):m(_e=>({..._e,amount:de.amount||_e.amount,date:de.date||_e.date,description:de.merchant||_e.description,paymentMethod:de.paymentMethod||_e.paymentMethod,categoryId:de.categoryId||_e.categoryId}))}catch($){C($ instanceof Error?$.message:"فشل تحليل النص."),console.error($)}finally{E(!1)}}},V=async()=>{C("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){C("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const fe=await navigator.clipboard.readText();fe&&fe.trim().length>0?k(fe):C("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(fe){console.error("Clipboard operation failed: ",fe),C("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},F=he.useMemo(()=>{const fe=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach($=>fe.push({value:$.id,label:`🏦 ${$.name}`})),Object.values(o).forEach($=>fe.push({value:$.id,label:`💳 ${$.name}`})),fe.push({value:"tabby-bnpl",label:"📱 تابي"}),fe.push({value:"tamara-bnpl",label:"📱 تمارا"}),fe},[l,o]),D=he.useMemo(()=>{const fe=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(o).forEach($=>fe.push({value:`${$.id}-payment`,label:`💳 سداد ${$.name}`})),fe},[o]);return f.jsxs(f.Fragment,{children:[P.isOpen&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>O({isOpen:!1,text:""}),children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:fe=>fe.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),f.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:P.text}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",P.text),O({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),f.jsx("button",{onClick:()=>{O({isOpen:!1,text:""}),k(P.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:fe=>fe.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(bf,{})})]}),f.jsxs("button",{type:"button",onClick:V,disabled:T,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[f.jsx(BU,{}),f.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),T&&f.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),f.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),b&&f.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:b}),f.jsxs("form",{onSubmit:R,className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),f.jsx("input",{type:"number",name:"amount",value:g.amount,onChange:w,className:"w-full",required:!0,step:"0.01"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),f.jsx("input",{type:"date",name:"date",value:g.date,onChange:w,className:"w-full",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),f.jsx("input",{type:"text",name:"description",value:g.description,onChange:w,className:"w-full",required:!0})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),f.jsx("select",{name:"type",value:g.type,onChange:w,className:"w-full",children:D.map(fe=>f.jsx("option",{value:fe.value,children:fe.label},fe.value))})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),f.jsx("select",{name:"paymentMethod",value:g.paymentMethod,onChange:w,className:"w-full",children:F.map(fe=>f.jsx("option",{value:fe.value,children:fe.label},fe.value))})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),f.jsxs("select",{name:"categoryId",value:g.categoryId||"",onChange:w,className:"w-full",children:[f.jsx("option",{value:"",children:"-- اختر فئة --"}),i.map(fe=>f.jsxs("option",{value:fe.id,children:[fe.icon," ",fe.name]},fe.id))]})]}),j&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[f.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),f.jsxs("select",{value:H,onChange:fe=>Z(parseInt(fe.target.value)),className:"w-full",children:[f.jsx("option",{value:2,children:"قسطين (2)"}),f.jsx("option",{value:3,children:"3 أقساط"}),f.jsx("option",{value:4,children:"4 أقساط"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),f.jsx("select",{value:U,onChange:fe=>N(fe.target.value),className:"w-full",children:F.filter(fe=>!fe.value.includes("bnpl")).map(fe=>f.jsx("option",{value:fe.value,children:fe.label},fe.value))})]})]}),f.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:f.jsxs("p",{className:"text-sm text-blue-700",children:[f.jsx("strong",{children:"الدفعة الأولى:"})," ",(g.amount/H).toFixed(2)," ريال",f.jsx("br",{}),f.jsx("strong",{children:"المبلغ المتبقي:"})," ",(g.amount*(H-1)/H).toFixed(2)," ريال"]})})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),G&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:fe=>fe.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),f.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(fe=>fe.status==="active").map(fe=>f.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:f.jsx("div",{className:"flex justify-between items-center",children:f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-blue-800",children:fe.name}),f.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",fe.monthlyPayment.toLocaleString()," ريال"]})]})})},fe.id))}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>{ne(!1),e(g,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),f.jsx("button",{onClick:()=>{ne(!1);const fe=Object.values(u).filter(_e=>_e.status==="active"),$=fe.reduce((_e,je)=>_e+je.monthlyPayment,0),de={...g};fe.map(_e=>({id:`trans-${Date.now()}-loan-${_e.id}`,amount:_e.monthlyPayment,date:g.date,description:`قسط شهري - ${_e.name}`,paymentMethod:g.paymentMethod,type:"expense",categoryId:null})),e(de,t==null?void 0:t.id),d({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${$.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},y4=({onClose:n,onSave:e,initialData:t})=>{var d;const[i,o]=he.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});he.useEffect(()=>{t&&o(t)},[t]);const l=g=>{const{name:m,value:T,type:E}=g.target;o(m==="smsSamples"?b=>({...b,smsSamples:T.split(",").map(C=>C.trim()).filter(Boolean)}):b=>({...b,[m]:E==="number"?parseFloat(T)||0:T}))},u=g=>{g.preventDefault(),e(i,t==null?void 0:t.id)};return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:g=>g.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(bf,{})})]}),f.jsxs("form",{onSubmit:u,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),f.jsx("input",{type:"text",name:"name",value:i.name,onChange:l,className:"w-full p-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),f.jsx("input",{type:"number",name:"limit",value:i.limit,onChange:l,className:"w-full p-2",required:!0,step:"100"})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),f.jsx("input",{type:"number",name:"statementDay",value:i.statementDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),f.jsx("input",{type:"number",name:"dueDay",value:i.dueDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),f.jsx("input",{type:"text",name:"smsSamples",value:((d=i.smsSamples)==null?void 0:d.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},_4=({onClose:n,onSave:e,initialData:t})=>{var d;const[i,o]=he.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});he.useEffect(()=>{t&&o(t)},[t]);const l=g=>{const{name:m,value:T,type:E}=g.target;o(m==="smsSamples"?b=>({...b,smsSamples:T.split(",").map(C=>C.trim()).filter(Boolean)}):b=>({...b,[m]:E==="number"?parseFloat(T)||0:T}))},u=g=>{g.preventDefault(),e(i,t==null?void 0:t.id)};return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:g=>g.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(bf,{})})]}),f.jsxs("form",{onSubmit:u,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),f.jsx("input",{type:"text",name:"name",value:i.name,onChange:l,className:"w-full p-2",required:!0})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),f.jsx("input",{type:"number",name:"balance",value:i.balance,onChange:l,className:"w-full p-2",required:!0,step:"10"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),f.jsxs("select",{name:"currency",value:i.currency||"SAR",onChange:l,className:"w-full p-2",required:!0,children:[f.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),f.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),f.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),f.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),f.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),f.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),f.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),f.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),f.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),f.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),f.jsx("input",{type:"text",name:"smsSamples",value:((d=i.smsSamples)==null?void 0:d.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},v4=({onClose:n,onSave:e,initialData:t,bankAccounts:i})=>{const[o,l]=he.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[u,d]=he.useState({});he.useEffect(()=>{t&&l(t)},[t]),he.useEffect(()=>{if(o.totalAmount>0&&o.downPayment>=0&&o.finalPayment>=0&&o.monthlyPayment>0){const C=o.totalAmount-o.downPayment-o.finalPayment-(o.prepaidAmount||0);if(C>0){const P=Math.ceil(C/o.monthlyPayment),O=new Date(o.startDate),G=new Date(O);G.setMonth(G.getMonth()+P),l(ne=>({...ne,totalMonths:P,endDate:G.toISOString().split("T")[0],remainingMonths:P}))}}},[o.totalAmount,o.downPayment,o.finalPayment,o.monthlyPayment,o.startDate,o.prepaidAmount]),he.useEffect(()=>{if(o.prepaidAmount&&o.monthlyPayment>0){const C=Math.floor(o.prepaidAmount/o.monthlyPayment);l(P=>({...P,prepaidInstallments:C}))}else l(C=>({...C,prepaidInstallments:0}))},[o.prepaidAmount,o.monthlyPayment]);const g=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],m=C=>{const{name:P,value:O}=C.target;l(G=>({...G,[P]:P.includes("Amount")||P.includes("Payment")||P.includes("Months")?parseFloat(O)||0:O})),u[P]&&d(G=>({...G,[P]:""}))},T=()=>{const C={};return o.name.trim()||(C.name="اسم القرض مطلوب"),o.totalAmount<=0&&(C.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),o.downPayment<0&&(C.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),o.finalPayment<0&&(C.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),o.monthlyPayment<=0&&(C.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),o.lender.trim()||(C.lender="اسم البنك أو المؤسسة مطلوب"),o.startDate||(C.startDate="تاريخ بداية القرض مطلوب"),o.downPayment+o.finalPayment>=o.totalAmount&&(C.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),d(C),Object.keys(C).length===0},E=C=>{if(C.preventDefault(),!T())return;const P={...o,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(P)},b=Object.values(i).map(C=>({value:C.id,label:`${C.name} (${C.currency})`}));return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:C=>C.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(bf,{})})]}),f.jsxs("form",{onSubmit:E,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),f.jsx("select",{id:"type",name:"type",value:o.type,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:g.map(C=>f.jsxs("option",{value:C.value,children:[C.icon," ",C.label]},C.value))})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),f.jsx("input",{type:"text",id:"name",name:"name",value:o.name,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),u.name&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),f.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:o.totalAmount,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.totalAmount&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.totalAmount})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),f.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:o.downPayment,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.downPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.downPayment})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),f.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:o.finalPayment,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.finalPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.finalPayment})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),f.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:o.monthlyPayment,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.monthlyPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.monthlyPayment})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),f.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:o.prepaidAmount||0,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),f.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(o.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[f.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",o.prepaidInstallments||0," قسط"]}),f.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(o.totalAmount-o.downPayment-o.finalPayment-(o.prepaidAmount||0))," ريال"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),f.jsx("input",{type:"date",id:"startDate",name:"startDate",value:o.startDate,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),u.startDate&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.startDate})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),f.jsx("input",{type:"date",id:"endDate",name:"endDate",value:o.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),f.jsx("input",{type:"text",id:"lender",name:"lender",value:o.lender,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),u.lender&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.lender})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),f.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:o.linkedAccount,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:"اختر حساب بنكي"}),b.map(C=>f.jsx("option",{value:C.value,children:C.label},C.value))]})]})]}),o.totalMonths>0&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),f.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",o.totalMonths," شهر"]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),f.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",o.remainingMonths," شهر"]})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},T4=()=>{var Or,Zt,As,Oi,qi;const[n,e]=he.useState(!1),[t,i]=he.useState(od),[o,l]=he.useState(new Date().getFullYear()),[u,d]=he.useState(new Date().getMonth()+1),[g,m]=he.useState("summary"),[T,E]=he.useState({isLoading:!1,text:""}),[b,C]=he.useState(null),[P,O]=he.useState({isOpen:!1}),[G,ne]=he.useState({isOpen:!1}),[j,q]=he.useState({isOpen:!1}),[H,Z]=he.useState({isOpen:!1}),[U,N]=he.useState({isOpen:!1}),[w,R]=he.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[k,V]=he.useState(!1),[F,D]=he.useState(""),[ke,fe]=he.useState(null),[$,de]=he.useState(!1),[_e,je]=he.useState(!0);he.useEffect(()=>{(async()=>{hx();const me=await bi.onAuthStateChanged(async pe=>{try{pe?(console.log("✅ تم تسجيل دخول المستخدم:",pe.email),fe(pe),await We(pe.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),fe(null),await B())}catch(Se){console.error("خطأ في تحميل بيانات المستخدم:",Se),await B()}finally{je(!1),e(!0)}});return()=>{typeof me=="function"&&me()}})()},[]),he.useEffect(()=>(P.isOpen||G.isOpen||j.isOpen||H.isOpen||U.isOpen||b||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[P.isOpen,G.isOpen,j.isOpen,H.isOpen,U.isOpen,b,T.isLoading]),he.useEffect(()=>{var K,me;U.isOpen&&w.fromAccount&&w.toAccount&&((K=t.bankAccounts[w.fromAccount])==null?void 0:K.currency)!==((me=t.bankAccounts[w.toAccount])==null?void 0:me.currency)&&rs()},[w.fromAccount,w.toAccount,U.isOpen]);const We=async K=>{var me;try{const pe=await bi.getData("users",K);if(pe.success&&pe.data){const Se=od(),Ve={...Se,...pe.data,cards:{...Se.cards,...pe.data.cards||{}},bankAccounts:{...Se.bankAccounts,...pe.data.bankAccounts||{}},investments:{...Se.investments,...pe.data.investments||{}}};i(Ve),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else pe.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",pe.error),(me=pe.error)!=null&&me.includes("الأذونات")&&C({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(pe){console.error("خطأ في تحميل بيانات المستخدم:",pe)}},B=async()=>{try{const K=localStorage.getItem("financial_dashboard_state");if(K){const me=JSON.parse(K),pe=od(),Se={...pe,...me,cards:{...pe.cards,...me.cards||{}},bankAccounts:{...pe.bankAccounts,...me.bankAccounts||{}},investments:{...pe.investments,...me.investments||{}}};i(Se),console.log("✅ تم تحميل البيانات من localStorage")}}catch(K){console.error("خطأ في تحميل البيانات المحلية:",K)}};he.useEffect(()=>{if(n&&!_e&&(localStorage.setItem("financial_dashboard_state",JSON.stringify(t)),ke)){const me=setTimeout(async()=>{try{const pe=await bi.saveData("users",ke.uid,t);pe.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",pe.error)}catch(pe){console.error("❌ خطأ في حفظ البيانات في Firebase:",pe)}},2e3);return()=>clearTimeout(me)}},[t,n,ke,_e]);const re=(K,me="")=>E({isLoading:K,text:me}),ye=he.useCallback(()=>t.transactions?t.transactions.filter(K=>{const me=new Date(K.date),pe=me.getFullYear()===o,Se=u==="all"||me.getMonth()+1===u;return pe&&Se}):[],[t.transactions,o,u]),ve=he.useMemo(()=>ye(),[ye]),ie=he.useMemo(()=>{const K={},me={},pe={},Se={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(Te=>{Te&&Te.id&&(pe[Te.id]={...Te,balance:0,available:Te.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(Te=>{Te&&Te.id&&(Se[Te.id]={...Te,deposits:0,withdrawals:0})});let Ve=0,et=0,qt=0,Tn=0;ve.forEach(Te=>{if(Te.type==="income")Ve+=Te.amount;else if(Te.type==="expense")et+=Te.amount,Te.categoryId&&(K[Te.categoryId]=(K[Te.categoryId]||0)+Te.amount);else if(Te.type==="bnpl-payment")et+=Te.amount,Te.categoryId&&(K[Te.categoryId]=(K[Te.categoryId]||0)+Te.amount);else if(Te.type==="investment-deposit")qt+=Te.amount,et+=Te.amount;else if(Te.type==="investment-withdrawal")Tn+=Te.amount,Ve+=Te.amount;else if(Te.type.endsWith("-payment")){const vt=Te.type.replace("-payment","");me[vt]?me[vt]+=Te.amount:me[vt]=Te.amount}}),Object.keys(t.cards).forEach(Te=>{const vt=t.cards[Te];let ut=0;t.transactions.forEach(Pt=>{Pt.paymentMethod===Te&&Pt.type==="expense"&&(ut+=Pt.amount),Pt.type===`${Te}-payment`&&(ut-=Pt.amount)}),pe[Te].balance=ut,pe[Te].available=vt.limit-ut,pe[Te].usagePercentage=vt.limit>0?ut/vt.limit*100:0}),Object.keys(t.bankAccounts).forEach(Te=>{const vt=t.bankAccounts[Te];let ut=0,Pt=0,hn=vt.balance;t.transactions.forEach(ze=>{ze.paymentMethod===Te&&(["income","investment-withdrawal"].includes(ze.type)?hn+=ze.amount:["expense","investment-deposit"].includes(ze.type)&&(hn-=ze.amount)),ze.type.endsWith("-payment")&&ze.paymentMethod===Te&&(hn-=ze.amount),ze.type==="expense"&&ze.isInstallmentPayment&&ze.paymentMethod===Te&&(hn-=ze.amount)}),ve.forEach(ze=>{ze.paymentMethod===Te&&(["income","investment-withdrawal"].includes(ze.type)?ut+=ze.amount:["expense","investment-deposit"].includes(ze.type)&&(Pt+=ze.amount)),ze.type.endsWith("-payment")&&ze.paymentMethod===Te&&(Pt+=ze.amount),ze.type==="expense"&&ze.isInstallmentPayment&&ze.paymentMethod===Te&&(Pt+=ze.amount)}),Se[Te].balance=hn,Se[Te].deposits=ut,Se[Te].withdrawals=Pt});const wt=Object.values(pe).reduce((Te,vt)=>Te+vt.balance,0),Ro=Object.values(pe).reduce((Te,vt)=>Te+vt.available,0),Fi=Object.values(pe).reduce((Te,vt)=>Te+vt.limit,0),Mo=Object.values(Se).reduce((Te,vt)=>Te+vt.balance,0);return{totalIncome:Ve,totalExpenses:et,cardDetails:pe,cardPayments:me,bankAccountDetails:Se,totalDebt:wt,totalAvailable:Ro,totalLimits:Fi,totalBankBalance:Mo,totalInvestmentDeposits:qt,totalInvestmentWithdrawals:Tn,expensesByCategory:K}},[ve,t.transactions,t.cards,t.bankAccounts]),ce=(K,me)=>{i(pe=>{if(me){const Se=pe.transactions.map(Ve=>Ve.id===me?{...Ve,...K}:Ve);return{...pe,transactions:Se}}else if(K.bnplData&&K.paymentMethod.includes("bnpl")){const Se={id:`installment-${Date.now()}`,provider:K.paymentMethod,description:K.description,totalAmount:K.amount,installmentAmount:K.bnplData.installmentAmount,total:K.bnplData.installmentsCount,paid:1,createdAt:K.date},Ve={id:`trans-${Date.now()}-1`,amount:K.bnplData.installmentAmount,date:K.date,description:`الدفعة الأولى لـ: ${K.description}`,paymentMethod:K.bnplData.initialPaymentSource,type:"expense",categoryId:K.categoryId,isInstallmentPayment:!0,installmentId:Se.id};return{...pe,transactions:[...pe.transactions,Ve],installments:[...pe.installments,Se]}}else{const Se={id:`trans-${Date.now()}`,...K};return{...pe,transactions:[...pe.transactions,Se]}}}),O({isOpen:!1})},xe=K=>{C({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const pe=me.transactions.find(et=>et.id===K);if(!pe)return me;const Se=me.transactions.filter(et=>et.id!==K);let Ve=me.installments;return pe.isInstallmentPayment&&pe.installmentId&&(Ve=me.installments.map(et=>et.id===pe.installmentId?{...et,paid:Math.max(0,et.paid-1)}:et)),{...me,transactions:Se,installments:Ve}}),C(null)}})},Ze=K=>{const me=t.transactions.find(pe=>pe.id===K);me&&O({isOpen:!0,initialData:me})},nt=async K=>{fe(K),de(!1),await We(K.uid)},An=async()=>{try{const K=await bi.signOut();K.success?(console.log("✅ تم تسجيل الخروج بنجاح"),fe(null),await B()):console.error("❌ خطأ في تسجيل الخروج:",K.error)}catch(K){console.error("❌ خطأ في تسجيل الخروج:",K)}},Ct=(K,me)=>{i(pe=>{const Se={...pe.cards};if(me)Se[me]={...Se[me],...K,id:me};else{const Ve=`card-${Date.now()}`;Se[Ve]={...K,id:Ve}}return{...pe,cards:Se}}),ne({isOpen:!1})},bs=K=>{var me;t.transactions.some(pe=>pe.paymentMethod===K||pe.type===`${K}-payment`)?C({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):C({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(me=t.cards[K])==null?void 0:me.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(pe=>{const Se={...pe.cards};return delete Se[K],{...pe,cards:Se}}),C(null)}})},Ui=(K,me)=>{i(pe=>{const Se={...pe.bankAccounts};if(me)Se[me]={...Se[me],...K,id:me};else{const Ve=`bank-${Date.now()}`;Se[Ve]={...K,id:Ve}}return{...pe,bankAccounts:Se}}),q({isOpen:!1})},zn=K=>{var me;t.transactions.some(pe=>pe.paymentMethod===K)?C({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):C({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(me=t.bankAccounts[K])==null?void 0:me.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(pe=>{const Se={...pe.bankAccounts};return delete Se[K],{...pe,bankAccounts:Se}}),C(null)}})},Vr=K=>{C({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const me=od();if(K.creditCards&&!K.cards){const Se={};Object.entries(K.creditCards).forEach(([Ve,et])=>{Se[Ve]={id:Ve,name:Ve.toUpperCase(),limit:et.creditLimit||0,balance:et.currentBalance||0,dueDay:et.dueDay||1,smsSamples:[],keywords:[]}}),K.cards=Se}if(K.cards&&typeof K.cards=="object"&&(K.cards.snb||K.cards.enbd)){const Se={};K.cards.snb&&(Se["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:K.cards.snb.limit||0,dueDay:K.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),K.cards.enbd&&(Se["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:K.cards.enbd.limit||0,dueDay:K.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),K.cards=Se}K.bank&&!K.bankAccounts&&(K.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:K.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),K.transactions&&Array.isArray(K.transactions)&&(K.transactions=K.transactions.map(Se=>Se.paymentMethod==="mada-bank"?{...Se,paymentMethod:"bank-default"}:Se));const pe={...me,...K};i(pe),ke&&(async()=>{try{const Ve=await bi.saveData("users",ke.uid,pe);Ve.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",Ve.error)}catch(Ve){console.error("❌ خطأ في حفظ البيانات في Firebase:",Ve)}})(),C({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{C({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},Xs=K=>ne({isOpen:!0,initialData:K?t.cards[K]:null}),Lr=K=>q({isOpen:!0,initialData:K?t.bankAccounts[K]:null}),Ur=K=>Z({isOpen:!0,initialData:K?t.loans[K]:null}),Nt=()=>{if(!w.fromAccount||!w.toAccount||w.amount<=0){C({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(w.fromAccount===w.toAccount){C({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const K=t.bankAccounts[w.fromAccount],me=t.bankAccounts[w.toAccount],pe=w.amount*w.exchangeRate,Se={id:`trans-${Date.now()}-withdrawal`,amount:w.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(me==null?void 0:me.name)||"حساب آخر"}: ${w.description}${w.exchangeRate!==1?` (معدل: ${w.exchangeRate})`:""}`,paymentMethod:w.fromAccount,type:"expense",categoryId:null},Ve={id:`trans-${Date.now()}-deposit`,amount:pe,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(K==null?void 0:K.name)||"حساب آخر"}: ${w.description}${w.exchangeRate!==1?` (معدل: ${w.exchangeRate})`:""}`,paymentMethod:w.toAccount,type:"income",categoryId:null};i(et=>({...et,transactions:[...et.transactions,Se,Ve]})),N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D(""),C({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Dt=K=>{if(i(me=>({...me,loans:{...me.loans,[K.id]:K}})),!K.id.includes("edit")){const me=[];K.downPayment>0&&me.push({id:`trans-${Date.now()}-down-payment`,amount:K.downPayment,date:K.startDate,description:`دفعة أولى - ${K.name}`,paymentMethod:K.linkedAccount||"cash",type:"expense",categoryId:null}),me.push({id:`trans-${Date.now()}-loan-deposit`,amount:K.totalAmount,date:K.startDate,description:`إيداع قرض - ${K.name} من ${K.lender}`,paymentMethod:K.linkedAccount||"cash",type:"income",categoryId:null}),K.finalPayment>0&&K.endDate&&me.push({id:`trans-${Date.now()}-final-payment`,amount:K.finalPayment,date:K.endDate,description:`دفعة أخيرة - ${K.name}`,paymentMethod:K.linkedAccount||"cash",type:"expense",categoryId:null}),i(pe=>({...pe,transactions:[...pe.transactions,...me]}))}Z({isOpen:!1}),C({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},rs=async()=>{if(!w.fromAccount||!w.toAccount)return;const K=t.bankAccounts[w.fromAccount],me=t.bankAccounts[w.toAccount];if(!K||!me)return;const pe=K.currency||"SAR",Se=me.currency||"SAR";if(pe===Se){R(Ve=>({...Ve,exchangeRate:1})),D("");return}V(!0),D("");try{const Ve=await _x(pe,Se);R(et=>({...et,exchangeRate:Ve.rate}))}catch(Ve){D(Ve instanceof Error?Ve.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",Ve)}finally{V(!1)}};if(!n||_e)return f.jsx(WU,{});if(!ke)return f.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:f.jsxs("div",{className:"w-full max-w-md px-4",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),f.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),f.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),f.jsx(UE,{onSuccess:nt,onClose:()=>{},hideCloseButton:!0})]})});`${o}${u==="all"?"كل الشهور":new Date(o,u-1).toLocaleString("ar-SA",{month:"long"})}`;const tl=()=>{switch(g){case"summary":return f.jsx(t4,{calculations:ie,categories:t.categories});case"transactions":return f.jsx(n4,{transactions:ve,allTransactions:t.transactions,categories:t.categories,deleteTransaction:xe,editTransaction:Ze,state:t});case"ai-assistant":return f.jsx(i4,{calculations:ie,filteredTransactions:ve});case"analysis":return f.jsx(r4,{calculations:ie,categories:t.categories,allTransactions:t.transactions});case"budget":return f.jsx(o4,{state:t,setLoading:re,setModal:C});case"investment":return f.jsx(a4,{state:t,setState:i,calculations:ie,setModal:C});case"cards":return f.jsx(u4,{state:t,openCardFormModal:Xs,deleteCard:bs});case"bank":return f.jsx(f4,{state:t,setState:i,calculations:ie,filteredTransactions:ve,categories:t.categories,setModal:C,openBankAccountFormModal:Lr,deleteBankAccount:zn,openTransferModal:()=>N({isOpen:!0})});case"installments":return f.jsx(h4,{state:t,setState:i,filteredTransactions:ve,setModal:C});case"debts-loans":return f.jsx(m4,{state:t,setState:i,setModal:C,openLoanFormModal:Ur});case"settings":return f.jsx(p4,{state:t,setState:i,setModal:C,setLoading:re,onRestore:Vr});default:return f.jsx("div",{children:"Tab not found"})}};return f.jsxs("div",{className:"bg-slate-100 min-h-screen font-sans",children:[f.jsx(KU,{selectedYear:o,selectedMonth:u,onYearChange:l,onMonthChange:K=>d(K),onAddTransaction:()=>O({isOpen:!0}),currentUser:ke,onSignOut:An}),f.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[f.jsx(QU,{activeTab:g,setActiveTab:m}),tl()]}),f.jsx("button",{onClick:()=>O({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),P.isOpen&&f.jsx(g4,{onClose:()=>O({isOpen:!1}),onSave:ce,initialData:P.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,loans:t.loans,setModalConfig:C}),G.isOpen&&f.jsx(y4,{onClose:()=>ne({isOpen:!1}),onSave:Ct,initialData:G.initialData}),j.isOpen&&f.jsx(_4,{onClose:()=>q({isOpen:!1}),onSave:Ui,initialData:j.initialData}),H.isOpen&&f.jsx(v4,{onClose:()=>Z({isOpen:!1}),onSave:Dt,initialData:H.initialData,bankAccounts:t.bankAccounts}),U.isOpen&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},children:f.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:K=>K.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"💸 تحويل بين الحسابات"}),f.jsx("button",{onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),f.jsxs("select",{id:"fromAccount",name:"fromAccount",value:w.fromAccount,onChange:K=>R(me=>({...me,fromAccount:K.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[f.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([K,me])=>f.jsx("option",{value:K,children:me.name},K))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),f.jsxs("select",{id:"toAccount",name:"toAccount",value:w.toAccount,onChange:K=>R(me=>({...me,toAccount:K.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[f.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([K])=>K!==w.fromAccount).map(([K,me])=>f.jsx("option",{value:K,children:me.name},K))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),f.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:w.amount,onChange:K=>R(me=>({...me,amount:parseFloat(K.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),w.fromAccount&&w.toAccount&&((Or=t.bankAccounts[w.fromAccount])==null?void 0:Or.currency)!==((Zt=t.bankAccounts[w.toAccount])==null?void 0:Zt.currency)&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(As=t.bankAccounts[w.fromAccount])==null?void 0:As.currency," → ",(Oi=t.bankAccounts[w.toAccount])==null?void 0:Oi.currency,")"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"number",step:"0.0001",value:w.exchangeRate,onChange:K=>R(me=>({...me,exchangeRate:parseFloat(K.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),f.jsxs("button",{type:"button",onClick:rs,disabled:k,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[k?f.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",f.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),F&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:F}),f.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(w.amount*w.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(qi=t.bankAccounts[w.toAccount])==null?void 0:qi.currency]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),f.jsx("input",{type:"text",id:"description",name:"description",value:w.description,onChange:K=>R(me=>({...me,description:K.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{type:"button",onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"button",onClick:Nt,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),b&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>C(null),children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:K=>K.stopPropagation(),children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:b.title}),f.jsx("div",{className:"text-slate-600",dangerouslySetInnerHTML:{__html:b.body}}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!b.hideCancel&&f.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),f.jsx("button",{onClick:()=>{(!b.onConfirm||b.onConfirm()!==!1)&&C(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:b.confirmText||"موافق"})]})]})}),T.isLoading&&f.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),f.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),$&&ke&&f.jsx(UE,{onSuccess:nt,onClose:()=>de(!1)})]})},aS=document.getElementById("root");if(!aS)throw new Error("Could not find root element");const E4=JC.createRoot(aS);E4.render(f.jsx(FE.StrictMode,{children:f.jsx(T4,{})}));
