import{r as V,a as mr,c as Wt,g as pr,R as Mn}from"./vendor-DJ1oPbzn.js";import{g as hr,i as gr,a as xr,b as yr,c as vr}from"./firebase-Csmhukl4.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var uo={exports:{}},rn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var br=V,Tr=Symbol.for("react.element"),Nr=Symbol.for("react.fragment"),Cr=Object.prototype.hasOwnProperty,wr=br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Er={key:!0,ref:!0,__self:!0,__source:!0};function fo(t,e,n){var s,i={},l=null,c=null;n!==void 0&&(l=""+n),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(c=e.ref);for(s in e)Cr.call(e,s)&&!Er.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:Tr,type:t,key:l,ref:c,props:i,_owner:wr.current}}rn.Fragment=Nr;rn.jsx=fo;rn.jsxs=fo;uo.exports=rn;var o=uo.exports,bn={},$n=mr;bn.createRoot=$n.createRoot,bn.hydrateRoot=$n.hydrateRoot;const zt=()=>({transactions:[],categories:[{id:"cat-1",name:"Ø¨Ù‚Ø§Ù„Ø©",icon:"ðŸ›’"},{id:"cat-2",name:"Ù…Ø·Ø§Ø¹Ù…",icon:"ðŸ”"},{id:"cat-3",name:"ÙˆÙ‚ÙˆØ¯",icon:"â›½"},{id:"cat-4",name:"ÙÙˆØ§ØªÙŠØ±",icon:"ðŸ§¾"},{id:"cat-9",name:"Ø³Ø¯Ø§Ø¯ ÙÙˆØ§ØªÙŠØ±",icon:"ðŸ’³"},{id:"cat-5",name:"ØªØ³ÙˆÙ‚",icon:"ðŸ›ï¸"},{id:"cat-6",name:"Ø¥ÙŠØ¬Ø§Ø±",icon:"ðŸ "},{id:"cat-8",name:"ØµÙŠØ¯Ù„ÙŠØ©",icon:"ðŸ’Š"},{id:"cat-7",name:"Ø£Ø®Ø±Ù‰",icon:"ðŸ’¸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB Ø§Ù„Ø£Ù‡Ù„ÙŠ",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","Ø§Ù„Ø£Ù‡Ù„ÙŠ","Ø¥Ø¦ØªÙ…Ø§Ù†ÙŠØ©"]},"enbd-card":{id:"enbd-card",name:"ENBD Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ",balance:0,currency:"SAR",smsSamples:["Ù…Ø¯Ù‰","mada","Alrajhi","Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ","Inma","Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡","Ø¨Ù†Ùƒ"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _r,Sr;function Ar(){return{geminiUrl:_r,vertexUrl:Sr}}function Ir(t,e,n,s){var i,l;if(!(t!=null&&t.baseUrl)){const c=Ar();return e?(i=c.vertexUrl)!==null&&i!==void 0?i:n:(l=c.geminiUrl)!==null&&l!==void 0?l:s}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ze{}function Q(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(s,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const l=e[i];return l!=null?String(l):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(t,e,n){for(let l=0;l<e.length-1;l++){const c=e[l];if(c.endsWith("[]")){const d=c.slice(0,-2);if(!(d in t))if(Array.isArray(n))t[d]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(t[d])){const f=t[d];if(Array.isArray(n))for(let u=0;u<f.length;u++){const m=f[u];a(m,e.slice(l+1),n[u])}else for(const u of f)a(u,e.slice(l+1),n)}return}else if(c.endsWith("[0]")){const d=c.slice(0,-3);d in t||(t[d]=[{}]);const f=t[d];a(f[0],e.slice(l+1),n);return}(!t[c]||typeof t[c]!="object")&&(t[c]={}),t=t[c]}const s=e[e.length-1],i=t[s];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[s]=n}function r(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let s=0;s<e.length;s++){if(typeof t!="object"||t===null)return n;const i=e[s];if(i.endsWith("[]")){const l=i.slice(0,-2);if(l in t){const c=t[l];return Array.isArray(c)?c.map(d=>r(d,e.slice(s+1),n)):n}else return n}else t=t[i]}return t}catch(s){if(s instanceof TypeError)return n;throw s}}function Rr(t,e){for(const[n,s]of Object.entries(e)){const i=n.split("."),l=s.split("."),c=new Set;let d=-1;for(let f=0;f<i.length;f++)if(i[f]==="*"){d=f;break}if(d!==-1&&l.length>d)for(let f=d;f<l.length;f++){const u=l[f];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&c.add(u)}Tn(t,i,l,0,c)}}function Tn(t,e,n,s,i){if(s>=e.length||typeof t!="object"||t===null)return;const l=e[s];if(l.endsWith("[]")){const c=l.slice(0,-2),d=t;if(c in d&&Array.isArray(d[c]))for(const f of d[c])Tn(f,e,n,s+1,i)}else if(l==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const c=t,d=Object.keys(c).filter(u=>!u.startsWith("_")&&!i.has(u)),f={};for(const u of d)f[u]=c[u];for(const[u,m]of Object.entries(f)){const p=[];for(const h of n.slice(s))h==="*"?p.push(u):p.push(h);a(c,p,m)}for(const u of d)delete c[u]}}else{const c=t;l in c&&Tn(c[l],e,n,s+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kn(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pr(t){const e={},n=r(t,["operationName"]);n!=null&&a(e,["operationName"],n);const s=r(t,["resourceName"]);return s!=null&&a(e,["_url","resourceName"],s),e}function Mr(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["metadata"]);s!=null&&a(e,["metadata"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);l!=null&&a(e,["error"],l);const c=r(t,["response","generateVideoResponse"]);return c!=null&&a(e,["response"],Dr(c)),e}function kr(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["metadata"]);s!=null&&a(e,["metadata"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);l!=null&&a(e,["error"],l);const c=r(t,["response"]);return c!=null&&a(e,["response"],Lr(c)),e}function Dr(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>Fr(c))),a(e,["generatedVideos"],l)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&a(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Lr(t){const e={},n=r(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>Ur(c))),a(e,["generatedVideos"],l)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&a(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Fr(t){const e={},n=r(t,["video"]);return n!=null&&a(e,["video"],Br(n)),e}function Ur(t){const e={},n=r(t,["_self"]);return n!=null&&a(e,["video"],qr(n)),e}function jr(t){const e={},n=r(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function Vr(t){const e={},n=r(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function Br(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const s=r(t,["encodedVideo"]);s!=null&&a(e,["videoBytes"],kn(s));const i=r(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function qr(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&a(e,["videoBytes"],kn(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gn;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Gn||(Gn={}));var Hn;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Hn||(Hn={}));var Ve;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Ve||(Ve={}));var Jn;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Jn||(Jn={}));var On;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(On||(On={}));var Yn;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Yn||(Yn={}));var Wn;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Wn||(Wn={}));var zn;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(zn||(zn={}));var Kn;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Kn||(Kn={}));var Xn;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Xn||(Xn={}));var Qn;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(Qn||(Qn={}));var Zn;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Zn||(Zn={}));var es;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(es||(es={}));var ts;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(ts||(ts={}));var ns;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ns||(ns={}));var tn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(tn||(tn={}));var ss;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ss||(ss={}));var Nn;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Nn||(Nn={}));var os;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(os||(os={}));var rs;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(rs||(rs={}));var is;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(is||(is={}));var as;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(as||(as={}));var ls;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(ls||(ls={}));var cs;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(cs||(cs={}));var ds;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(ds||(ds={}));var us;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(us||(us={}));var fs;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(fs||(fs={}));var ms;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(ms||(ms={}));var ps;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(ps||(ps={}));var hs;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(hs||(hs={}));var gs;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(gs||(gs={}));var xs;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xs||(xs={}));var ys;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ys||(ys={}));var vs;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(vs||(vs={}));var bs;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(bs||(bs={}));var Ts;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Ts||(Ts={}));var Ns;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Ns||(Ns={}));var Cs;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Cs||(Cs={}));var ws;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(ws||(ws={}));var Es;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Es||(Es={}));var _s;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(_s||(_s={}));var Ss;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ss||(Ss={}));var As;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(As||(As={}));var Is;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Is||(Is={}));var Rs;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Rs||(Rs={}));var Ps;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Ps||(Ps={}));var Ms;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Ms||(Ms={}));var ks;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(ks||(ks={}));var st;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(st||(st={}));class Cn{constructor(e){const n={};for(const s of e.headers.entries())n[s[0]]=s[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ct{get text(){var e,n,s,i,l,c,d,f;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",m=!1;const p=[];for(const h of(f=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[y,E]of Object.entries(h))y!=="text"&&y!=="thought"&&(E!==null||E!==void 0)&&p.push(y);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;m=!0,u+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?u:void 0}get data(){var e,n,s,i,l,c,d,f;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const m=[];for(const p of(f=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[h,y]of Object.entries(p))h!=="inlineData"&&(y!==null||y!==void 0)&&m.push(h);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,s,i,l,c,d,f;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,s,i,l,c,d,f,u;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(f=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((m==null?void 0:m.length)!==0)return(u=m==null?void 0:m[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,s,i,l,c,d,f,u;if(((i=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(f=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((m==null?void 0:m.length)!==0)return(u=m==null?void 0:m[0])===null||u===void 0?void 0:u.output}}class Ds{}class Ls{}class $r{}class Gr{}class Hr{}class Jr{}class Fs{}class Us{}class js{}class Or{}class nn{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const s=new nn;let i;const l=e;return n?i=kr(l):i=Mr(l),Object.assign(s,i),s}}class Vs{}class Bs{}class qs{}class Yr{}class Wr{}class zr{}class $s{}class Kr{get text(){var e,n,s;let i="",l=!1;const c=[];for(const d of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&c.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;l=!0,i+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var e,n,s;let i="";const l=[];for(const c of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[d,f]of Object.entries(c))d!=="inlineData"&&f!==null&&l.push(d);c.inlineData&&typeof c.inlineData.data=="string"&&(i+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class Xr{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ae(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function mo(t,e){const n=ae(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function po(t){return Array.isArray(t)?t.map(e=>sn(e)):[sn(t)]}function sn(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function ho(t){const e=sn(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function go(t){const e=sn(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Gs(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function xo(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Gs(e)):[Gs(t)]}function wn(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Hs(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Js(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function we(t){if(t==null)throw new Error("ContentUnion is required");return wn(t)?t:{role:"user",parts:xo(t)}}function Dn(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const s=we(n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(t.isVertexAI()){const n=we(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>we(n)):[we(e)]}function Ae(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Hs(t)||Js(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[we(t)]}const e=[],n=[],s=wn(t[0]);for(const i of t){const l=wn(i);if(l!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(i);else{if(Hs(i)||Js(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return s||e.push({role:"user",parts:xo(n)}),e}function Qr(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(s=>s!=="null");if(n.length===1)e.type=Object.values(Ve).includes(n[0].toUpperCase())?n[0].toUpperCase():Ve.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of n)e.anyOf.push({type:Object.values(Ve).includes(s.toUpperCase())?s.toUpperCase():Ve.TYPE_UNSPECIFIED})}}function ot(t){const e={},n=["items"],s=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=t.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,t=l[1]):l[1].type==="null"&&(e.nullable=!0,t=l[0])),t.type instanceof Array&&Qr(t.type,e);for(const[c,d]of Object.entries(t))if(d!=null)if(c=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(Ve).includes(d.toUpperCase())?d.toUpperCase():Ve.TYPE_UNSPECIFIED}else if(n.includes(c))e[c]=ot(d);else if(s.includes(c)){const f=[];for(const u of d){if(u.type=="null"){e.nullable=!0;continue}f.push(ot(u))}e[c]=f}else if(i.includes(c)){const f={};for(const[u,m]of Object.entries(d))f[u]=ot(m);e[c]=f}else{if(c==="additionalProperties")continue;e[c]=d}return e}function Ln(t){return ot(t)}function Fn(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Un(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function lt(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ot(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ot(e.response));return t}function ct(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Zr(t,e,n,s=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===s;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Ue(t,e){if(typeof e!="string")throw new Error("name must be a string");return Zr(t,e,"cachedContents")}function yo(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function qe(t){return kn(t)}function ei(t){return t!=null&&typeof t=="object"&&"name"in t}function ti(t){return t!=null&&typeof t=="object"&&"video"in t}function ni(t){return t!=null&&typeof t=="object"&&"uri"in t}function vo(t){var e;let n;if(ei(t)&&(n=t.name),!(ni(t)&&(n=t.uri,n===void 0))&&!(ti(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function bo(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function To(t){for(const e of["models","tunedModels","publisherModels"])if(si(t,e))return t[e];return[]}function si(t,e){return t!==null&&typeof t=="object"&&e in t}function oi(t,e={}){const n=t,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(s.responseJsonSchema=n.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function ri(t,e={}){const n=[],s=new Set;for(const i of t){const l=i.name;if(s.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);s.add(l);const c=oi(i,e);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function No(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function ii(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Co(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let l=!1;for(const c of i){if(typeof c!="object"||c===null)continue;const f=c.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function dt(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function wo(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ai(t){const e={},n=r(t,["responsesFile"]);n!=null&&a(e,["fileName"],n);const s=r(t,["inlinedResponses","inlinedResponses"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>ji(c))),a(e,["inlinedResponses"],l)}const i=r(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),a(e,["inlinedEmbedContentResponses"],l)}return e}function li(t){const e={},n=r(t,["predictionsFormat"]);n!=null&&a(e,["format"],n);const s=r(t,["gcsDestination","outputUriPrefix"]);s!=null&&a(e,["gcsUri"],s);const i=r(t,["bigqueryDestination","outputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function ci(t){const e={},n=r(t,["format"]);n!=null&&a(e,["predictionsFormat"],n);const s=r(t,["gcsUri"]);s!=null&&a(e,["gcsDestination","outputUriPrefix"],s);const i=r(t,["bigqueryUri"]);if(i!=null&&a(e,["bigqueryDestination","outputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(r(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Zt(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["metadata","displayName"]);s!=null&&a(e,["displayName"],s);const i=r(t,["metadata","state"]);i!=null&&a(e,["state"],wo(i));const l=r(t,["metadata","createTime"]);l!=null&&a(e,["createTime"],l);const c=r(t,["metadata","endTime"]);c!=null&&a(e,["endTime"],c);const d=r(t,["metadata","updateTime"]);d!=null&&a(e,["updateTime"],d);const f=r(t,["metadata","model"]);f!=null&&a(e,["model"],f);const u=r(t,["metadata","output"]);return u!=null&&a(e,["dest"],ai(Co(u))),e}function En(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["displayName"]);s!=null&&a(e,["displayName"],s);const i=r(t,["state"]);i!=null&&a(e,["state"],wo(i));const l=r(t,["error"]);l!=null&&a(e,["error"],l);const c=r(t,["createTime"]);c!=null&&a(e,["createTime"],c);const d=r(t,["startTime"]);d!=null&&a(e,["startTime"],d);const f=r(t,["endTime"]);f!=null&&a(e,["endTime"],f);const u=r(t,["updateTime"]);u!=null&&a(e,["updateTime"],u);const m=r(t,["model"]);m!=null&&a(e,["model"],m);const p=r(t,["inputConfig"]);p!=null&&a(e,["src"],di(p));const h=r(t,["outputConfig"]);return h!=null&&a(e,["dest"],li(Co(h))),e}function di(t){const e={},n=r(t,["instancesFormat"]);n!=null&&a(e,["format"],n);const s=r(t,["gcsSource","uris"]);s!=null&&a(e,["gcsUri"],s);const i=r(t,["bigquerySource","inputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function ui(t,e){const n={};if(r(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(r(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=r(e,["fileName"]);s!=null&&a(n,["fileName"],s);const i=r(e,["inlinedRequests"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Ui(t,c))),a(n,["requests","requests"],l)}return n}function fi(t){const e={},n=r(t,["format"]);n!=null&&a(e,["instancesFormat"],n);const s=r(t,["gcsUri"]);s!=null&&a(e,["gcsSource","uris"],s);const i=r(t,["bigqueryUri"]);if(i!=null&&a(e,["bigquerySource","inputUri"],i),r(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(r(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function mi(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["data"]);n!=null&&a(e,["data"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function pi(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function hi(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function gi(t){const e={},n=r(t,["content"]);n!=null&&a(e,["content"],n);const s=r(t,["citationMetadata"]);s!=null&&a(e,["citationMetadata"],xi(s));const i=r(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const l=r(t,["finishReason"]);l!=null&&a(e,["finishReason"],l);const c=r(t,["urlContextMetadata"]);c!=null&&a(e,["urlContextMetadata"],c);const d=r(t,["avgLogprobs"]);d!=null&&a(e,["avgLogprobs"],d);const f=r(t,["groundingMetadata"]);f!=null&&a(e,["groundingMetadata"],f);const u=r(t,["index"]);u!=null&&a(e,["index"],u);const m=r(t,["logprobsResult"]);m!=null&&a(e,["logprobsResult"],m);const p=r(t,["safetyRatings"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>y)),a(e,["safetyRatings"],h)}return e}function xi(t){const e={},n=r(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),a(e,["citations"],s)}return e}function Eo(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>Ji(l))),a(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&a(e,["role"],s),e}function yi(t,e){const n={},s=r(t,["displayName"]);if(e!==void 0&&s!=null&&a(e,["batch","displayName"],s),r(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function vi(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&a(e,["displayName"],s);const i=r(t,["dest"]);return e!==void 0&&i!=null&&a(e,["outputConfig"],ci(ii(i))),n}function Os(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["src"]);i!=null&&a(n,["batch","inputConfig"],ui(t,No(t,i)));const l=r(e,["config"]);return l!=null&&yi(l,n),n}function bi(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["model"],ae(t,s));const i=r(e,["src"]);i!=null&&a(n,["inputConfig"],fi(No(t,i)));const l=r(e,["config"]);return l!=null&&vi(l,n),n}function Ti(t,e){const n={},s=r(t,["displayName"]);return e!==void 0&&s!=null&&a(e,["batch","displayName"],s),n}function Ni(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["src"]);i!=null&&a(n,["batch","inputConfig"],Ii(t,i));const l=r(e,["config"]);return l!=null&&Ti(l,n),n}function Ci(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function wi(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function Ei(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);return l!=null&&a(e,["error"],l),e}function _i(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);return l!=null&&a(e,["error"],l),e}function Si(t,e){const n={},s=r(e,["contents"]);if(s!=null){let l=Dn(t,s);Array.isArray(l)&&(l=l.map(c=>c)),a(n,["requests[]","request","content"],l)}const i=r(e,["config"]);return i!=null&&(a(n,["_self"],Ai(i,n)),Rr(n,{"requests[].*":"requests[].request.*"})),n}function Ai(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&a(e,["requests[]","taskType"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const l=r(t,["outputDimensionality"]);if(e!==void 0&&l!=null&&a(e,["requests[]","outputDimensionality"],l),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Ii(t,e){const n={},s=r(e,["fileName"]);s!=null&&a(n,["file_name"],s);const i=r(e,["inlinedRequests"]);return i!=null&&a(n,["requests"],Si(t,i)),n}function Ri(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Pi(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],Eo(we(i)));const l=r(e,["temperature"]);l!=null&&a(s,["temperature"],l);const c=r(e,["topP"]);c!=null&&a(s,["topP"],c);const d=r(e,["topK"]);d!=null&&a(s,["topK"],d);const f=r(e,["candidateCount"]);f!=null&&a(s,["candidateCount"],f);const u=r(e,["maxOutputTokens"]);u!=null&&a(s,["maxOutputTokens"],u);const m=r(e,["stopSequences"]);m!=null&&a(s,["stopSequences"],m);const p=r(e,["responseLogprobs"]);p!=null&&a(s,["responseLogprobs"],p);const h=r(e,["logprobs"]);h!=null&&a(s,["logprobs"],h);const y=r(e,["presencePenalty"]);y!=null&&a(s,["presencePenalty"],y);const E=r(e,["frequencyPenalty"]);E!=null&&a(s,["frequencyPenalty"],E);const S=r(e,["seed"]);S!=null&&a(s,["seed"],S);const R=r(e,["responseMimeType"]);R!=null&&a(s,["responseMimeType"],R);const P=r(e,["responseSchema"]);P!=null&&a(s,["responseSchema"],Ln(P));const F=r(e,["responseJsonSchema"]);if(F!=null&&a(s,["responseJsonSchema"],F),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=r(e,["safetySettings"]);if(n!==void 0&&k!=null){let O=k;Array.isArray(O)&&(O=O.map(ne=>Oi(ne))),a(n,["safetySettings"],O)}const C=r(e,["tools"]);if(n!==void 0&&C!=null){let O=ct(C);Array.isArray(O)&&(O=O.map(ne=>Yi(lt(ne)))),a(n,["tools"],O)}const T=r(e,["toolConfig"]);if(n!==void 0&&T!=null&&a(n,["toolConfig"],T),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=r(e,["cachedContent"]);n!==void 0&&M!=null&&a(n,["cachedContent"],Ue(t,M));const A=r(e,["responseModalities"]);A!=null&&a(s,["responseModalities"],A);const L=r(e,["mediaResolution"]);L!=null&&a(s,["mediaResolution"],L);const D=r(e,["speechConfig"]);if(D!=null&&a(s,["speechConfig"],Fn(D)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const v=r(e,["thinkingConfig"]);v!=null&&a(s,["thinkingConfig"],v);const j=r(e,["imageConfig"]);return j!=null&&a(s,["imageConfig"],j),s}function Mi(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(u=>gi(u))),a(e,["candidates"],f)}const i=r(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const l=r(t,["promptFeedback"]);l!=null&&a(e,["promptFeedback"],l);const c=r(t,["responseId"]);c!=null&&a(e,["responseId"],c);const d=r(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function ki(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function Di(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],dt(t,s)),n}function Li(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function Fi(t){const e={},n=r(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],n),r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Ui(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["request","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let d=Ae(i);Array.isArray(d)&&(d=d.map(f=>Eo(f))),a(n,["request","contents"],d)}const l=r(e,["metadata"]);l!=null&&a(n,["metadata"],l);const c=r(e,["config"]);return c!=null&&a(n,["request","generationConfig"],Pi(t,c,r(n,["request"],{}))),n}function ji(t){const e={},n=r(t,["response"]);n!=null&&a(e,["response"],Mi(n));const s=r(t,["error"]);return s!=null&&a(e,["error"],s),e}function Vi(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);if(e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),r(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function Bi(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const l=r(t,["filter"]);return e!==void 0&&l!=null&&a(e,["_query","filter"],l),n}function qi(t){const e={},n=r(t,["config"]);return n!=null&&Vi(n,e),e}function $i(t){const e={},n=r(t,["config"]);return n!=null&&Bi(n,e),e}function Gi(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["operations"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Zt(c))),a(e,["batchJobs"],l)}return e}function Hi(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["batchPredictionJobs"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>En(c))),a(e,["batchJobs"],l)}return e}function Ji(t){const e={},n=r(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],n);const s=r(t,["thought"]);s!=null&&a(e,["thought"],s);const i=r(t,["inlineData"]);i!=null&&a(e,["inlineData"],mi(i));const l=r(t,["fileData"]);l!=null&&a(e,["fileData"],Ri(l));const c=r(t,["thoughtSignature"]);c!=null&&a(e,["thoughtSignature"],c);const d=r(t,["functionCall"]);d!=null&&a(e,["functionCall"],d);const f=r(t,["codeExecutionResult"]);f!=null&&a(e,["codeExecutionResult"],f);const u=r(t,["executableCode"]);u!=null&&a(e,["executableCode"],u);const m=r(t,["functionResponse"]);m!=null&&a(e,["functionResponse"],m);const p=r(t,["text"]);return p!=null&&a(e,["text"],p),e}function Oi(t){const e={};if(r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=r(t,["category"]);n!=null&&a(e,["category"],n);const s=r(t,["threshold"]);return s!=null&&a(e,["threshold"],s),e}function Yi(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["functionDeclarations"],u)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=r(t,["googleSearch"]);s!=null&&a(e,["googleSearch"],Fi(s));const i=r(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],Li(l));const c=r(t,["urlContext"]);c!=null&&a(e,["urlContext"],c);const d=r(t,["computerUse"]);d!=null&&a(e,["computerUse"],d);const f=r(t,["codeExecution"]);return f!=null&&a(e,["codeExecution"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var We;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(We||(We={}));class _t{constructor(e,n,s,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,s,i)}init(e,n,s){var i,l;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!s||Object.keys(s).length===0?c={config:{}}:typeof s=="object"?c=Object.assign({},s):c=s,c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(i=c.config)===null||i===void 0?void 0:i.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wi extends ze{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new _t(We.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=Os(this.apiClient,e),s=n._url,i=Q("{model}:batchGenerateContent",s),d=n.batch.inputConfig.requests,f=d.requests,u=[];for(const m of f){const p=Object.assign({},m);if(p.systemInstruction){const h=p.systemInstruction;delete p.systemInstruction;const y=p.request;y.systemInstruction=h,p.request=y}u.push(p)}return d.requests=u,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const s=n?Object.assign({},n):{},i=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${i}`),s.dest===void 0){const l=this.getGcsUri(e),c=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?s.dest=`${l.slice(0,-6)}/dest`:s.dest=`${l}_dest_${i}`;else if(c)s.dest=`${c}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=bi(this.apiClient,e);return d=Q("batchPredictionJobs",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>En(m))}else{const u=Os(this.apiClient,e);return d=Q("{model}:batchGenerateContent",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>Zt(m))}}async createEmbeddingsInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Ni(this.apiClient,e);return l=Q("{model}:asyncBatchEmbedContent",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>Zt(f))}}async get(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Di(this.apiClient,e);return d=Q("batchPredictionJobs/{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>En(m))}else{const u=ki(this.apiClient,e);return d=Q("batches/{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>Zt(m))}}async cancel(e){var n,s,i,l;let c="",d={};if(this.apiClient.isVertexAI()){const f=hi(this.apiClient,e);c=Q("batchPredictionJobs/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const f=pi(this.apiClient,e);c=Q("batches/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=$i(e);return d=Q("batchPredictionJobs",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Hi(m),h=new $s;return Object.assign(h,p),h})}else{const u=qi(e);return d=Q("batches",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Gi(m),h=new $s;return Object.assign(h,p),h})}}async delete(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=wi(this.apiClient,e);return d=Q("batchPredictionJobs/{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>_i(m))}else{const u=Ci(this.apiClient,e);return d=Q("batches/{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>Ei(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zi(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["data"]);n!=null&&a(e,["data"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Ys(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>ga(l))),a(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&a(e,["role"],s),e}function Ki(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&a(e,["ttl"],s);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const l=r(t,["displayName"]);e!==void 0&&l!=null&&a(e,["displayName"],l);const c=r(t,["contents"]);if(e!==void 0&&c!=null){let m=Ae(c);Array.isArray(m)&&(m=m.map(p=>Ys(p))),a(e,["contents"],m)}const d=r(t,["systemInstruction"]);e!==void 0&&d!=null&&a(e,["systemInstruction"],Ys(we(d)));const f=r(t,["tools"]);if(e!==void 0&&f!=null){let m=f;Array.isArray(m)&&(m=m.map(p=>xa(p))),a(e,["tools"],m)}const u=r(t,["toolConfig"]);if(e!==void 0&&u!=null&&a(e,["toolConfig"],u),r(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Xi(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&a(e,["ttl"],s);const i=r(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const l=r(t,["displayName"]);e!==void 0&&l!=null&&a(e,["displayName"],l);const c=r(t,["contents"]);if(e!==void 0&&c!=null){let p=Ae(c);Array.isArray(p)&&(p=p.map(h=>h)),a(e,["contents"],p)}const d=r(t,["systemInstruction"]);e!==void 0&&d!=null&&a(e,["systemInstruction"],we(d));const f=r(t,["tools"]);if(e!==void 0&&f!=null){let p=f;Array.isArray(p)&&(p=p.map(h=>ya(h))),a(e,["tools"],p)}const u=r(t,["toolConfig"]);e!==void 0&&u!=null&&a(e,["toolConfig"],u);const m=r(t,["kmsKeyName"]);return e!==void 0&&m!=null&&a(e,["encryption_spec","kmsKeyName"],m),n}function Qi(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["model"],mo(t,s));const i=r(e,["config"]);return i!=null&&Ki(i,n),n}function Zi(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["model"],mo(t,s));const i=r(e,["config"]);return i!=null&&Xi(i,n),n}function ea(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],Ue(t,s)),n}function ta(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],Ue(t,s)),n}function na(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function sa(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function oa(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function ra(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&a(e,["description"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const l=r(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const c=r(t,["response"]);c!=null&&a(e,["response"],c);const d=r(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function ia(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],Ue(t,s)),n}function aa(t,e){const n={},s=r(e,["name"]);return s!=null&&a(n,["_url","name"],Ue(t,s)),n}function la(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function ca(t){const e={},n=r(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],n),r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function da(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function ua(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function fa(t){const e={},n=r(t,["config"]);return n!=null&&da(n,e),e}function ma(t){const e={},n=r(t,["config"]);return n!=null&&ua(n,e),e}function pa(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),a(e,["cachedContents"],l)}return e}function ha(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),a(e,["cachedContents"],l)}return e}function ga(t){const e={},n=r(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],n);const s=r(t,["thought"]);s!=null&&a(e,["thought"],s);const i=r(t,["inlineData"]);i!=null&&a(e,["inlineData"],zi(i));const l=r(t,["fileData"]);l!=null&&a(e,["fileData"],oa(l));const c=r(t,["thoughtSignature"]);c!=null&&a(e,["thoughtSignature"],c);const d=r(t,["functionCall"]);d!=null&&a(e,["functionCall"],d);const f=r(t,["codeExecutionResult"]);f!=null&&a(e,["codeExecutionResult"],f);const u=r(t,["executableCode"]);u!=null&&a(e,["executableCode"],u);const m=r(t,["functionResponse"]);m!=null&&a(e,["functionResponse"],m);const p=r(t,["text"]);return p!=null&&a(e,["text"],p),e}function xa(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["functionDeclarations"],u)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=r(t,["googleSearch"]);s!=null&&a(e,["googleSearch"],ca(s));const i=r(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],la(l));const c=r(t,["urlContext"]);c!=null&&a(e,["urlContext"],c);const d=r(t,["computerUse"]);d!=null&&a(e,["computerUse"],d);const f=r(t,["codeExecution"]);return f!=null&&a(e,["codeExecution"],f),e}function ya(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>ra(h))),a(e,["functionDeclarations"],p)}const s=r(t,["retrieval"]);s!=null&&a(e,["retrieval"],s);const i=r(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],i);const l=r(t,["googleSearchRetrieval"]);l!=null&&a(e,["googleSearchRetrieval"],l);const c=r(t,["enterpriseWebSearch"]);c!=null&&a(e,["enterpriseWebSearch"],c);const d=r(t,["googleMaps"]);d!=null&&a(e,["googleMaps"],d);const f=r(t,["urlContext"]);f!=null&&a(e,["urlContext"],f);const u=r(t,["computerUse"]);u!=null&&a(e,["computerUse"],u);const m=r(t,["codeExecution"]);return m!=null&&a(e,["codeExecution"],m),e}function va(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&a(e,["ttl"],s);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function ba(t,e){const n={},s=r(t,["ttl"]);e!==void 0&&s!=null&&a(e,["ttl"],s);const i=r(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function Ta(t,e){const n={},s=r(e,["name"]);s!=null&&a(n,["_url","name"],Ue(t,s));const i=r(e,["config"]);return i!=null&&va(i,n),n}function Na(t,e){const n={},s=r(e,["name"]);s!=null&&a(n,["_url","name"],Ue(t,s));const i=r(e,["config"]);return i!=null&&ba(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ca extends ze{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new _t(We.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(n),n)}async create(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Zi(this.apiClient,e);return d=Q("cachedContents",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>m)}else{const u=Qi(this.apiClient,e);return d=Q("cachedContents",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>m)}}async get(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=aa(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>m)}else{const u=ia(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>m)}}async delete(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=ta(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=sa(m),h=new Bs;return Object.assign(h,p),h})}else{const u=ea(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=na(m),h=new Bs;return Object.assign(h,p),h})}}async update(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Na(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>m)}else{const u=Ta(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>m)}}async listInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=ma(e);return d=Q("cachedContents",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=ha(m),h=new qs;return Object.assign(h,p),h})}else{const u=fa(e);return d=Q("cachedContents",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=pa(m),h=new qs;return Object.assign(h,p),h})}}}function Ws(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ge(t){return this instanceof ge?(this.v=t,this):new ge(t)}function rt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),i[Symbol.asyncIterator]=function(){return this},i;function c(y){return function(E){return Promise.resolve(E).then(y,p)}}function d(y,E){s[y]&&(i[y]=function(S){return new Promise(function(R,P){l.push([y,S,R,P])>1||f(y,S)})},E&&(i[y]=E(i[y])))}function f(y,E){try{u(s[y](E))}catch(S){h(l[0][3],S)}}function u(y){y.value instanceof ge?Promise.resolve(y.value.v).then(m,p):h(l[0][2],y)}function m(y){f("next",y)}function p(y){f("throw",y)}function h(y,E){y(E),l.shift(),l.length&&f(l[0][0],l[0][1])}}function Et(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ws=="function"?Ws(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(l){n[l]=t[l]&&function(c){return new Promise(function(d,f){c=t[l](c),i(d,f,c.done,c.value)})}}function i(l,c,d,f){Promise.resolve(f).then(function(u){l({value:u,done:d})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wa(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:_o(n)}function _o(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function Ea(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function zs(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let s=0;for(;s<n;)if(t[s].role==="user")e.push(t[s]),s++;else{const i=[];let l=!0;for(;s<n&&t[s].role==="model";)i.push(t[s]),l&&!_o(t[s])&&(l=!1),s++;l?e.push(...i):e.pop()}return e}class _a{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new Sa(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Sa{constructor(e,n,s,i={},l=[]){this.apiClient=e,this.modelsModule=n,this.model=s,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),Ea(l)}async sendMessage(e){var n;await this.sendPromise;const s=we(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var l,c,d;const f=await i,u=(c=(l=f.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,m=f.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let h=[];m!=null&&(h=(d=m.slice(p))!==null&&d!==void 0?d:[]);const y=u?[u]:[];this.recordHistory(s,y,h)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const s=we(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const l=await i;return this.processStreamResponse(l,s)}getHistory(e=!1){const n=e?zs(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var s,i;return rt(this,arguments,function*(){var c,d,f,u;const m=[];try{for(var p=!0,h=Et(e),y;y=yield ge(h.next()),c=y.done,!c;p=!0){u=y.value,p=!1;const E=u;if(wa(E)){const S=(i=(s=E.candidates)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.content;S!==void 0&&m.push(S)}yield yield ge(E)}}catch(E){d={error:E}}finally{try{!p&&!c&&(f=h.return)&&(yield ge(f.call(h)))}finally{if(d)throw d.error}}this.recordHistory(n,m)})}recordHistory(e,n,s){let i=[];n.length>0&&n.every(l=>l.role!==void 0)?i=n:i.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...zs(s)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class an extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,an.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Aa(t){const e={},n=r(t,["file"]);return n!=null&&a(e,["file"],n),e}function Ia(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Ra(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","file"],vo(n)),e}function Pa(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Ma(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","file"],vo(n)),e}function ka(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function Da(t){const e={},n=r(t,["config"]);return n!=null&&ka(n,e),e}function La(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["files"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),a(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fa extends ze{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new _t(We.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Da(e);return l=Q("files",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>{const u=La(f),m=new Yr;return Object.assign(m,u),m})}}async createInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Aa(e);return l=Q("upload/v1beta/files",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const u=Ia(f),m=new Wr;return Object.assign(m,u),m})}}async get(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Ma(e);return l=Q("files/{file}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>f)}}async delete(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Ra(e);return l=Q("files/{file}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>{const u=Pa(f),m=new zr;return Object.assign(m,u),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function en(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["data"]);n!=null&&a(e,["data"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Ua(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>Qa(l))),a(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&a(e,["role"],s),e}function ja(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Va(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&a(e,["description"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const l=r(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const c=r(t,["response"]);c!=null&&a(e,["response"],c);const d=r(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function Ba(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&a(e,["modelConfig"],n);const s=r(t,["audioTimestamp"]);s!=null&&a(e,["audioTimestamp"],s);const i=r(t,["candidateCount"]);i!=null&&a(e,["candidateCount"],i);const l=r(t,["enableAffectiveDialog"]);l!=null&&a(e,["enableAffectiveDialog"],l);const c=r(t,["frequencyPenalty"]);c!=null&&a(e,["frequencyPenalty"],c);const d=r(t,["logprobs"]);d!=null&&a(e,["logprobs"],d);const f=r(t,["maxOutputTokens"]);f!=null&&a(e,["maxOutputTokens"],f);const u=r(t,["mediaResolution"]);u!=null&&a(e,["mediaResolution"],u);const m=r(t,["presencePenalty"]);m!=null&&a(e,["presencePenalty"],m);const p=r(t,["responseJsonSchema"]);p!=null&&a(e,["responseJsonSchema"],p);const h=r(t,["responseLogprobs"]);h!=null&&a(e,["responseLogprobs"],h);const y=r(t,["responseMimeType"]);y!=null&&a(e,["responseMimeType"],y);const E=r(t,["responseModalities"]);E!=null&&a(e,["responseModalities"],E);const S=r(t,["responseSchema"]);S!=null&&a(e,["responseSchema"],S);const R=r(t,["routingConfig"]);R!=null&&a(e,["routingConfig"],R);const P=r(t,["seed"]);P!=null&&a(e,["seed"],P);const F=r(t,["speechConfig"]);F!=null&&a(e,["speechConfig"],So(F));const k=r(t,["stopSequences"]);k!=null&&a(e,["stopSequences"],k);const C=r(t,["temperature"]);C!=null&&a(e,["temperature"],C);const T=r(t,["thinkingConfig"]);T!=null&&a(e,["thinkingConfig"],T);const M=r(t,["topK"]);M!=null&&a(e,["topK"],M);const A=r(t,["topP"]);return A!=null&&a(e,["topP"],A),e}function qa(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function $a(t){const e={},n=r(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],n),r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Ga(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig"],s);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const l=r(t,["temperature"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","temperature"],l);const c=r(t,["topP"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","topK"],d);const f=r(t,["maxOutputTokens"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","maxOutputTokens"],f);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","mediaResolution"],u);const m=r(t,["seed"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","seed"],m);const p=r(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],Un(p));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","thinkingConfig"],h);const y=r(t,["enableAffectiveDialog"]);e!==void 0&&y!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],y);const E=r(t,["systemInstruction"]);e!==void 0&&E!=null&&a(e,["setup","systemInstruction"],Ua(we(E)));const S=r(t,["tools"]);if(e!==void 0&&S!=null){let M=ct(S);Array.isArray(M)&&(M=M.map(A=>el(lt(A)))),a(e,["setup","tools"],M)}const R=r(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],Za(R));const P=r(t,["inputAudioTranscription"]);e!==void 0&&P!=null&&a(e,["setup","inputAudioTranscription"],P);const F=r(t,["outputAudioTranscription"]);e!==void 0&&F!=null&&a(e,["setup","outputAudioTranscription"],F);const k=r(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&a(e,["setup","realtimeInputConfig"],k);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&a(e,["setup","contextWindowCompression"],C);const T=r(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],T),n}function Ha(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig"],Ba(s));const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const l=r(t,["temperature"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","temperature"],l);const c=r(t,["topP"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","topK"],d);const f=r(t,["maxOutputTokens"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","maxOutputTokens"],f);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","mediaResolution"],u);const m=r(t,["seed"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","seed"],m);const p=r(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],So(Un(p)));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","thinkingConfig"],h);const y=r(t,["enableAffectiveDialog"]);e!==void 0&&y!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],y);const E=r(t,["systemInstruction"]);e!==void 0&&E!=null&&a(e,["setup","systemInstruction"],we(E));const S=r(t,["tools"]);if(e!==void 0&&S!=null){let M=ct(S);Array.isArray(M)&&(M=M.map(A=>tl(lt(A)))),a(e,["setup","tools"],M)}const R=r(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],R);const P=r(t,["inputAudioTranscription"]);e!==void 0&&P!=null&&a(e,["setup","inputAudioTranscription"],P);const F=r(t,["outputAudioTranscription"]);e!==void 0&&F!=null&&a(e,["setup","outputAudioTranscription"],F);const k=r(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&a(e,["setup","realtimeInputConfig"],k);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&a(e,["setup","contextWindowCompression"],C);const T=r(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],T),n}function Ja(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["setup","model"],ae(t,s));const i=r(e,["config"]);return i!=null&&a(n,["config"],Ga(i,n)),n}function Oa(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["setup","model"],ae(t,s));const i=r(e,["config"]);return i!=null&&a(n,["config"],Ha(i,n)),n}function Ya(t){const e={},n=r(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],n),e}function Wa(t){const e={},n=r(t,["weightedPrompts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),a(e,["weightedPrompts"],s)}return e}function za(t){const e={},n=r(t,["media"]);if(n!=null){let u=po(n);Array.isArray(u)&&(u=u.map(m=>en(m))),a(e,["mediaChunks"],u)}const s=r(t,["audio"]);s!=null&&a(e,["audio"],en(go(s)));const i=r(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const l=r(t,["video"]);l!=null&&a(e,["video"],en(ho(l)));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const d=r(t,["activityStart"]);d!=null&&a(e,["activityStart"],d);const f=r(t,["activityEnd"]);return f!=null&&a(e,["activityEnd"],f),e}function Ka(t){const e={},n=r(t,["media"]);if(n!=null){let u=po(n);Array.isArray(u)&&(u=u.map(m=>m)),a(e,["mediaChunks"],u)}const s=r(t,["audio"]);s!=null&&a(e,["audio"],go(s));const i=r(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const l=r(t,["video"]);l!=null&&a(e,["video"],ho(l));const c=r(t,["text"]);c!=null&&a(e,["text"],c);const d=r(t,["activityStart"]);d!=null&&a(e,["activityStart"],d);const f=r(t,["activityEnd"]);return f!=null&&a(e,["activityEnd"],f),e}function Xa(t){const e={},n=r(t,["setupComplete"]);n!=null&&a(e,["setupComplete"],n);const s=r(t,["serverContent"]);s!=null&&a(e,["serverContent"],s);const i=r(t,["toolCall"]);i!=null&&a(e,["toolCall"],i);const l=r(t,["toolCallCancellation"]);l!=null&&a(e,["toolCallCancellation"],l);const c=r(t,["usageMetadata"]);c!=null&&a(e,["usageMetadata"],nl(c));const d=r(t,["goAway"]);d!=null&&a(e,["goAway"],d);const f=r(t,["sessionResumptionUpdate"]);return f!=null&&a(e,["sessionResumptionUpdate"],f),e}function Qa(t){const e={},n=r(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],n);const s=r(t,["thought"]);s!=null&&a(e,["thought"],s);const i=r(t,["inlineData"]);i!=null&&a(e,["inlineData"],en(i));const l=r(t,["fileData"]);l!=null&&a(e,["fileData"],ja(l));const c=r(t,["thoughtSignature"]);c!=null&&a(e,["thoughtSignature"],c);const d=r(t,["functionCall"]);d!=null&&a(e,["functionCall"],d);const f=r(t,["codeExecutionResult"]);f!=null&&a(e,["codeExecutionResult"],f);const u=r(t,["executableCode"]);u!=null&&a(e,["executableCode"],u);const m=r(t,["functionResponse"]);m!=null&&a(e,["functionResponse"],m);const p=r(t,["text"]);return p!=null&&a(e,["text"],p),e}function Za(t){const e={},n=r(t,["handle"]);if(n!=null&&a(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function So(t){const e={},n=r(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],n),r(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=r(t,["languageCode"]);return s!=null&&a(e,["languageCode"],s),e}function el(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["functionDeclarations"],u)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=r(t,["googleSearch"]);s!=null&&a(e,["googleSearch"],$a(s));const i=r(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],qa(l));const c=r(t,["urlContext"]);c!=null&&a(e,["urlContext"],c);const d=r(t,["computerUse"]);d!=null&&a(e,["computerUse"],d);const f=r(t,["codeExecution"]);return f!=null&&a(e,["codeExecution"],f),e}function tl(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>Va(h))),a(e,["functionDeclarations"],p)}const s=r(t,["retrieval"]);s!=null&&a(e,["retrieval"],s);const i=r(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],i);const l=r(t,["googleSearchRetrieval"]);l!=null&&a(e,["googleSearchRetrieval"],l);const c=r(t,["enterpriseWebSearch"]);c!=null&&a(e,["enterpriseWebSearch"],c);const d=r(t,["googleMaps"]);d!=null&&a(e,["googleMaps"],d);const f=r(t,["urlContext"]);f!=null&&a(e,["urlContext"],f);const u=r(t,["computerUse"]);u!=null&&a(e,["computerUse"],u);const m=r(t,["codeExecution"]);return m!=null&&a(e,["codeExecution"],m),e}function nl(t){const e={},n=r(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const s=r(t,["cachedContentTokenCount"]);s!=null&&a(e,["cachedContentTokenCount"],s);const i=r(t,["candidatesTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const l=r(t,["toolUsePromptTokenCount"]);l!=null&&a(e,["toolUsePromptTokenCount"],l);const c=r(t,["thoughtsTokenCount"]);c!=null&&a(e,["thoughtsTokenCount"],c);const d=r(t,["totalTokenCount"]);d!=null&&a(e,["totalTokenCount"],d);const f=r(t,["promptTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(E=>E)),a(e,["promptTokensDetails"],y)}const u=r(t,["cacheTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(E=>E)),a(e,["cacheTokensDetails"],y)}const m=r(t,["candidatesTokensDetails"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(E=>E)),a(e,["responseTokensDetails"],y)}const p=r(t,["toolUsePromptTokensDetails"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(E=>E)),a(e,["toolUsePromptTokensDetails"],y)}const h=r(t,["trafficType"]);return h!=null&&a(e,["trafficType"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sl(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["data"]);n!=null&&a(e,["data"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function ol(t){const e={},n=r(t,["content"]);n!=null&&a(e,["content"],n);const s=r(t,["citationMetadata"]);s!=null&&a(e,["citationMetadata"],rl(s));const i=r(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const l=r(t,["finishReason"]);l!=null&&a(e,["finishReason"],l);const c=r(t,["urlContextMetadata"]);c!=null&&a(e,["urlContextMetadata"],c);const d=r(t,["avgLogprobs"]);d!=null&&a(e,["avgLogprobs"],d);const f=r(t,["groundingMetadata"]);f!=null&&a(e,["groundingMetadata"],f);const u=r(t,["index"]);u!=null&&a(e,["index"],u);const m=r(t,["logprobsResult"]);m!=null&&a(e,["logprobsResult"],m);const p=r(t,["safetyRatings"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>y)),a(e,["safetyRatings"],h)}return e}function rl(t){const e={},n=r(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),a(e,["citations"],s)}return e}function il(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let l=Ae(i);Array.isArray(l)&&(l=l.map(c=>c)),a(n,["contents"],l)}return n}function al(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["tokensInfo"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>l)),a(e,["tokensInfo"],i)}return e}function ll(t){const e={},n=r(t,["values"]);n!=null&&a(e,["values"],n);const s=r(t,["statistics"]);return s!=null&&a(e,["statistics"],cl(s)),e}function cl(t){const e={},n=r(t,["truncated"]);n!=null&&a(e,["truncated"],n);const s=r(t,["token_count"]);return s!=null&&a(e,["tokenCount"],s),e}function ln(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>pc(l))),a(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&a(e,["role"],s),e}function dl(t){const e={},n=r(t,["controlType"]);n!=null&&a(e,["controlType"],n);const s=r(t,["enableControlImageComputation"]);return s!=null&&a(e,["computeControl"],s),e}function ul(t){const e={};if(r(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function fl(t,e){const n={},s=r(t,["systemInstruction"]);e!==void 0&&s!=null&&a(e,["systemInstruction"],we(s));const i=r(t,["tools"]);if(e!==void 0&&i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>Mo(d))),a(e,["tools"],c)}const l=r(t,["generationConfig"]);return e!==void 0&&l!=null&&a(e,["generationConfig"],tc(l)),n}function ml(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let c=Ae(i);Array.isArray(c)&&(c=c.map(d=>ln(d))),a(n,["contents"],c)}const l=r(e,["config"]);return l!=null&&ul(l),n}function pl(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let c=Ae(i);Array.isArray(c)&&(c=c.map(d=>d)),a(n,["contents"],c)}const l=r(e,["config"]);return l!=null&&fl(l,n),n}function hl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["totalTokens"]);s!=null&&a(e,["totalTokens"],s);const i=r(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function gl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["totalTokens"]);return s!=null&&a(e,["totalTokens"],s),e}function xl(t,e){const n={},s=r(e,["model"]);return s!=null&&a(n,["_url","name"],ae(t,s)),n}function yl(t,e){const n={},s=r(e,["model"]);return s!=null&&a(n,["_url","name"],ae(t,s)),n}function vl(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function bl(t){const e={},n=r(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Tl(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&a(e,["parameters","storageUri"],s);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const l=r(t,["numberOfImages"]);e!==void 0&&l!=null&&a(e,["parameters","sampleCount"],l);const c=r(t,["aspectRatio"]);e!==void 0&&c!=null&&a(e,["parameters","aspectRatio"],c);const d=r(t,["guidanceScale"]);e!==void 0&&d!=null&&a(e,["parameters","guidanceScale"],d);const f=r(t,["seed"]);e!==void 0&&f!=null&&a(e,["parameters","seed"],f);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&a(e,["parameters","safetySetting"],u);const m=r(t,["personGeneration"]);e!==void 0&&m!=null&&a(e,["parameters","personGeneration"],m);const p=r(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&a(e,["parameters","includeRaiReason"],h);const y=r(t,["language"]);e!==void 0&&y!=null&&a(e,["parameters","language"],y);const E=r(t,["outputMimeType"]);e!==void 0&&E!=null&&a(e,["parameters","outputOptions","mimeType"],E);const S=r(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&a(e,["parameters","outputOptions","compressionQuality"],S);const R=r(t,["addWatermark"]);e!==void 0&&R!=null&&a(e,["parameters","addWatermark"],R);const P=r(t,["labels"]);e!==void 0&&P!=null&&a(e,["labels"],P);const F=r(t,["editMode"]);e!==void 0&&F!=null&&a(e,["parameters","editMode"],F);const k=r(t,["baseSteps"]);return e!==void 0&&k!=null&&a(e,["parameters","editConfig","baseSteps"],k),n}function Nl(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const l=r(e,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(f=>bc(f))),a(n,["instances[0]","referenceImages"],d)}const c=r(e,["config"]);return c!=null&&Tl(c,n),n}function Cl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>cn(l))),a(e,["generatedImages"],i)}return e}function wl(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&a(e,["requests[]","taskType"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const l=r(t,["outputDimensionality"]);if(e!==void 0&&l!=null&&a(e,["requests[]","outputDimensionality"],l),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function El(t,e){const n={},s=r(t,["taskType"]);e!==void 0&&s!=null&&a(e,["instances[]","task_type"],s);const i=r(t,["title"]);e!==void 0&&i!=null&&a(e,["instances[]","title"],i);const l=r(t,["outputDimensionality"]);e!==void 0&&l!=null&&a(e,["parameters","outputDimensionality"],l);const c=r(t,["mimeType"]);e!==void 0&&c!=null&&a(e,["instances[]","mimeType"],c);const d=r(t,["autoTruncate"]);return e!==void 0&&d!=null&&a(e,["parameters","autoTruncate"],d),n}function _l(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let d=Dn(t,i);Array.isArray(d)&&(d=d.map(f=>f)),a(n,["requests[]","content"],d)}const l=r(e,["config"]);l!=null&&wl(l,n);const c=r(e,["model"]);return c!==void 0&&a(n,["requests[]","model"],ae(t,c)),n}function Sl(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let c=Dn(t,i);Array.isArray(c)&&(c=c.map(d=>d)),a(n,["instances[]","content"],c)}const l=r(e,["config"]);return l!=null&&El(l,n),n}function Al(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["embeddings"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>c)),a(e,["embeddings"],l)}const i=r(t,["metadata"]);return i!=null&&a(e,["metadata"],i),e}function Il(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["predictions[]","embeddings"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>ll(c))),a(e,["embeddings"],l)}const i=r(t,["metadata"]);return i!=null&&a(e,["metadata"],i),e}function Rl(t){const e={},n=r(t,["endpoint"]);n!=null&&a(e,["name"],n);const s=r(t,["deployedModelId"]);return s!=null&&a(e,["deployedModelId"],s),e}function Pl(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Ml(t){const e={};if(r(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=r(t,["description"]);n!=null&&a(e,["description"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["parameters"]);i!=null&&a(e,["parameters"],i);const l=r(t,["parametersJsonSchema"]);l!=null&&a(e,["parametersJsonSchema"],l);const c=r(t,["response"]);c!=null&&a(e,["response"],c);const d=r(t,["responseJsonSchema"]);return d!=null&&a(e,["responseJsonSchema"],d),e}function kl(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],ln(we(i)));const l=r(e,["temperature"]);l!=null&&a(s,["temperature"],l);const c=r(e,["topP"]);c!=null&&a(s,["topP"],c);const d=r(e,["topK"]);d!=null&&a(s,["topK"],d);const f=r(e,["candidateCount"]);f!=null&&a(s,["candidateCount"],f);const u=r(e,["maxOutputTokens"]);u!=null&&a(s,["maxOutputTokens"],u);const m=r(e,["stopSequences"]);m!=null&&a(s,["stopSequences"],m);const p=r(e,["responseLogprobs"]);p!=null&&a(s,["responseLogprobs"],p);const h=r(e,["logprobs"]);h!=null&&a(s,["logprobs"],h);const y=r(e,["presencePenalty"]);y!=null&&a(s,["presencePenalty"],y);const E=r(e,["frequencyPenalty"]);E!=null&&a(s,["frequencyPenalty"],E);const S=r(e,["seed"]);S!=null&&a(s,["seed"],S);const R=r(e,["responseMimeType"]);R!=null&&a(s,["responseMimeType"],R);const P=r(e,["responseSchema"]);P!=null&&a(s,["responseSchema"],Ln(P));const F=r(e,["responseJsonSchema"]);if(F!=null&&a(s,["responseJsonSchema"],F),r(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(r(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const k=r(e,["safetySettings"]);if(n!==void 0&&k!=null){let O=k;Array.isArray(O)&&(O=O.map(ne=>Tc(ne))),a(n,["safetySettings"],O)}const C=r(e,["tools"]);if(n!==void 0&&C!=null){let O=ct(C);Array.isArray(O)&&(O=O.map(ne=>Sc(lt(ne)))),a(n,["tools"],O)}const T=r(e,["toolConfig"]);if(n!==void 0&&T!=null&&a(n,["toolConfig"],T),r(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=r(e,["cachedContent"]);n!==void 0&&M!=null&&a(n,["cachedContent"],Ue(t,M));const A=r(e,["responseModalities"]);A!=null&&a(s,["responseModalities"],A);const L=r(e,["mediaResolution"]);L!=null&&a(s,["mediaResolution"],L);const D=r(e,["speechConfig"]);if(D!=null&&a(s,["speechConfig"],Fn(D)),r(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const v=r(e,["thinkingConfig"]);v!=null&&a(s,["thinkingConfig"],v);const j=r(e,["imageConfig"]);return j!=null&&a(s,["imageConfig"],j),s}function Dl(t,e,n){const s={},i=r(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],we(i));const l=r(e,["temperature"]);l!=null&&a(s,["temperature"],l);const c=r(e,["topP"]);c!=null&&a(s,["topP"],c);const d=r(e,["topK"]);d!=null&&a(s,["topK"],d);const f=r(e,["candidateCount"]);f!=null&&a(s,["candidateCount"],f);const u=r(e,["maxOutputTokens"]);u!=null&&a(s,["maxOutputTokens"],u);const m=r(e,["stopSequences"]);m!=null&&a(s,["stopSequences"],m);const p=r(e,["responseLogprobs"]);p!=null&&a(s,["responseLogprobs"],p);const h=r(e,["logprobs"]);h!=null&&a(s,["logprobs"],h);const y=r(e,["presencePenalty"]);y!=null&&a(s,["presencePenalty"],y);const E=r(e,["frequencyPenalty"]);E!=null&&a(s,["frequencyPenalty"],E);const S=r(e,["seed"]);S!=null&&a(s,["seed"],S);const R=r(e,["responseMimeType"]);R!=null&&a(s,["responseMimeType"],R);const P=r(e,["responseSchema"]);P!=null&&a(s,["responseSchema"],Ln(P));const F=r(e,["responseJsonSchema"]);F!=null&&a(s,["responseJsonSchema"],F);const k=r(e,["routingConfig"]);k!=null&&a(s,["routingConfig"],k);const C=r(e,["modelSelectionConfig"]);C!=null&&a(s,["modelConfig"],C);const T=r(e,["safetySettings"]);if(n!==void 0&&T!=null){let ce=T;Array.isArray(ce)&&(ce=ce.map(W=>W)),a(n,["safetySettings"],ce)}const M=r(e,["tools"]);if(n!==void 0&&M!=null){let ce=ct(M);Array.isArray(ce)&&(ce=ce.map(W=>Mo(lt(W)))),a(n,["tools"],ce)}const A=r(e,["toolConfig"]);n!==void 0&&A!=null&&a(n,["toolConfig"],A);const L=r(e,["labels"]);n!==void 0&&L!=null&&a(n,["labels"],L);const D=r(e,["cachedContent"]);n!==void 0&&D!=null&&a(n,["cachedContent"],Ue(t,D));const v=r(e,["responseModalities"]);v!=null&&a(s,["responseModalities"],v);const j=r(e,["mediaResolution"]);j!=null&&a(s,["mediaResolution"],j);const O=r(e,["speechConfig"]);O!=null&&a(s,["speechConfig"],Po(Fn(O)));const ne=r(e,["audioTimestamp"]);ne!=null&&a(s,["audioTimestamp"],ne);const he=r(e,["thinkingConfig"]);he!=null&&a(s,["thinkingConfig"],he);const le=r(e,["imageConfig"]);return le!=null&&a(s,["imageConfig"],le),s}function Ks(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let c=Ae(i);Array.isArray(c)&&(c=c.map(d=>ln(d))),a(n,["contents"],c)}const l=r(e,["config"]);return l!=null&&a(n,["generationConfig"],kl(t,l,n)),n}function Xs(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["contents"]);if(i!=null){let c=Ae(i);Array.isArray(c)&&(c=c.map(d=>d)),a(n,["contents"],c)}const l=r(e,["config"]);return l!=null&&a(n,["generationConfig"],Dl(t,l,n)),n}function Qs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(u=>ol(u))),a(e,["candidates"],f)}const i=r(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const l=r(t,["promptFeedback"]);l!=null&&a(e,["promptFeedback"],l);const c=r(t,["responseId"]);c!=null&&a(e,["responseId"],c);const d=r(t,["usageMetadata"]);return d!=null&&a(e,["usageMetadata"],d),e}function Zs(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["candidates"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["candidates"],u)}const i=r(t,["createTime"]);i!=null&&a(e,["createTime"],i);const l=r(t,["modelVersion"]);l!=null&&a(e,["modelVersion"],l);const c=r(t,["promptFeedback"]);c!=null&&a(e,["promptFeedback"],c);const d=r(t,["responseId"]);d!=null&&a(e,["responseId"],d);const f=r(t,["usageMetadata"]);return f!=null&&a(e,["usageMetadata"],f),e}function Ll(t,e){const n={};if(r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s);const i=r(t,["aspectRatio"]);e!==void 0&&i!=null&&a(e,["parameters","aspectRatio"],i);const l=r(t,["guidanceScale"]);if(e!==void 0&&l!=null&&a(e,["parameters","guidanceScale"],l),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=r(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&a(e,["parameters","safetySetting"],c);const d=r(t,["personGeneration"]);e!==void 0&&d!=null&&a(e,["parameters","personGeneration"],d);const f=r(t,["includeSafetyAttributes"]);e!==void 0&&f!=null&&a(e,["parameters","includeSafetyAttributes"],f);const u=r(t,["includeRaiReason"]);e!==void 0&&u!=null&&a(e,["parameters","includeRaiReason"],u);const m=r(t,["language"]);e!==void 0&&m!=null&&a(e,["parameters","language"],m);const p=r(t,["outputMimeType"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","mimeType"],p);const h=r(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&a(e,["parameters","outputOptions","compressionQuality"],h),r(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const y=r(t,["imageSize"]);if(e!==void 0&&y!=null&&a(e,["parameters","sampleImageSize"],y),r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Fl(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&a(e,["parameters","storageUri"],s);const i=r(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const l=r(t,["numberOfImages"]);e!==void 0&&l!=null&&a(e,["parameters","sampleCount"],l);const c=r(t,["aspectRatio"]);e!==void 0&&c!=null&&a(e,["parameters","aspectRatio"],c);const d=r(t,["guidanceScale"]);e!==void 0&&d!=null&&a(e,["parameters","guidanceScale"],d);const f=r(t,["seed"]);e!==void 0&&f!=null&&a(e,["parameters","seed"],f);const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&a(e,["parameters","safetySetting"],u);const m=r(t,["personGeneration"]);e!==void 0&&m!=null&&a(e,["parameters","personGeneration"],m);const p=r(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const h=r(t,["includeRaiReason"]);e!==void 0&&h!=null&&a(e,["parameters","includeRaiReason"],h);const y=r(t,["language"]);e!==void 0&&y!=null&&a(e,["parameters","language"],y);const E=r(t,["outputMimeType"]);e!==void 0&&E!=null&&a(e,["parameters","outputOptions","mimeType"],E);const S=r(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&a(e,["parameters","outputOptions","compressionQuality"],S);const R=r(t,["addWatermark"]);e!==void 0&&R!=null&&a(e,["parameters","addWatermark"],R);const P=r(t,["labels"]);e!==void 0&&P!=null&&a(e,["labels"],P);const F=r(t,["imageSize"]);e!==void 0&&F!=null&&a(e,["parameters","sampleImageSize"],F);const k=r(t,["enhancePrompt"]);return e!==void 0&&k!=null&&a(e,["parameters","enhancePrompt"],k),n}function Ul(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const l=r(e,["config"]);return l!=null&&Ll(l,n),n}function jl(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const l=r(e,["config"]);return l!=null&&Fl(l,n),n}function Vl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>Xl(c))),a(e,["generatedImages"],l)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],Io(i)),e}function Bl(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>cn(c))),a(e,["generatedImages"],l)}const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],Ro(i)),e}function ql(t,e){const n={},s=r(t,["numberOfVideos"]);if(e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s),r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=r(t,["durationSeconds"]);if(e!==void 0&&i!=null&&a(e,["parameters","durationSeconds"],i),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&a(e,["parameters","aspectRatio"],l);const c=r(t,["resolution"]);e!==void 0&&c!=null&&a(e,["parameters","resolution"],c);const d=r(t,["personGeneration"]);if(e!==void 0&&d!=null&&a(e,["parameters","personGeneration"],d),r(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=r(t,["negativePrompt"]);e!==void 0&&f!=null&&a(e,["parameters","negativePrompt"],f);const u=r(t,["enhancePrompt"]);if(e!==void 0&&u!=null&&a(e,["parameters","enhancePrompt"],u),r(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const m=r(t,["lastFrame"]);e!==void 0&&m!=null&&a(e,["instances[0]","lastFrame"],dn(m));const p=r(t,["referenceImages"]);if(e!==void 0&&p!=null){let h=p;Array.isArray(h)&&(h=h.map(y=>Bc(y))),a(e,["instances[0]","referenceImages"],h)}if(r(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(r(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function $l(t,e){const n={},s=r(t,["numberOfVideos"]);e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s);const i=r(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const l=r(t,["fps"]);e!==void 0&&l!=null&&a(e,["parameters","fps"],l);const c=r(t,["durationSeconds"]);e!==void 0&&c!=null&&a(e,["parameters","durationSeconds"],c);const d=r(t,["seed"]);e!==void 0&&d!=null&&a(e,["parameters","seed"],d);const f=r(t,["aspectRatio"]);e!==void 0&&f!=null&&a(e,["parameters","aspectRatio"],f);const u=r(t,["resolution"]);e!==void 0&&u!=null&&a(e,["parameters","resolution"],u);const m=r(t,["personGeneration"]);e!==void 0&&m!=null&&a(e,["parameters","personGeneration"],m);const p=r(t,["pubsubTopic"]);e!==void 0&&p!=null&&a(e,["parameters","pubsubTopic"],p);const h=r(t,["negativePrompt"]);e!==void 0&&h!=null&&a(e,["parameters","negativePrompt"],h);const y=r(t,["enhancePrompt"]);e!==void 0&&y!=null&&a(e,["parameters","enhancePrompt"],y);const E=r(t,["generateAudio"]);e!==void 0&&E!=null&&a(e,["parameters","generateAudio"],E);const S=r(t,["lastFrame"]);e!==void 0&&S!=null&&a(e,["instances[0]","lastFrame"],Pe(S));const R=r(t,["referenceImages"]);if(e!==void 0&&R!=null){let k=R;Array.isArray(k)&&(k=k.map(C=>qc(C))),a(e,["instances[0]","referenceImages"],k)}const P=r(t,["mask"]);e!==void 0&&P!=null&&a(e,["instances[0]","mask"],Vc(P));const F=r(t,["compressionQuality"]);return e!==void 0&&F!=null&&a(e,["parameters","compressionQuality"],F),n}function Gl(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["metadata"]);s!=null&&a(e,["metadata"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);l!=null&&a(e,["error"],l);const c=r(t,["response","generateVideoResponse"]);return c!=null&&a(e,["response"],Yl(c)),e}function Hl(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["metadata"]);s!=null&&a(e,["metadata"],s);const i=r(t,["done"]);i!=null&&a(e,["done"],i);const l=r(t,["error"]);l!=null&&a(e,["error"],l);const c=r(t,["response"]);return c!=null&&a(e,["response"],Wl(c)),e}function Jl(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const l=r(e,["image"]);l!=null&&a(n,["instances[0]","image"],dn(l));const c=r(e,["video"]);c!=null&&a(n,["instances[0]","video"],ko(c));const d=r(e,["source"]);d!=null&&zl(d,n);const f=r(e,["config"]);return f!=null&&ql(f,n),n}function Ol(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const l=r(e,["image"]);l!=null&&a(n,["instances[0]","image"],Pe(l));const c=r(e,["video"]);c!=null&&a(n,["instances[0]","video"],Do(c));const d=r(e,["source"]);d!=null&&Kl(d,n);const f=r(e,["config"]);return f!=null&&$l(f,n),n}function Yl(t){const e={},n=r(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>Zl(c))),a(e,["generatedVideos"],l)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&a(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function Wl(t){const e={},n=r(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>ec(c))),a(e,["generatedVideos"],l)}const s=r(t,["raiMediaFilteredCount"]);s!=null&&a(e,["raiMediaFilteredCount"],s);const i=r(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function zl(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&a(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],dn(i));const l=r(t,["video"]);return e!==void 0&&l!=null&&a(e,["instances[0]","video"],ko(l)),n}function Kl(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&a(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],Pe(i));const l=r(t,["video"]);return e!==void 0&&l!=null&&a(e,["instances[0]","video"],Do(l)),n}function Xl(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["image"],ic(n));const s=r(t,["raiFilteredReason"]);s!=null&&a(e,["raiFilteredReason"],s);const i=r(t,["_self"]);return i!=null&&a(e,["safetyAttributes"],Io(i)),e}function cn(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["image"],Ao(n));const s=r(t,["raiFilteredReason"]);s!=null&&a(e,["raiFilteredReason"],s);const i=r(t,["_self"]);i!=null&&a(e,["safetyAttributes"],Ro(i));const l=r(t,["prompt"]);return l!=null&&a(e,["enhancedPrompt"],l),e}function Ql(t){const e={},n=r(t,["_self"]);n!=null&&a(e,["mask"],Ao(n));const s=r(t,["labels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>l)),a(e,["labels"],i)}return e}function Zl(t){const e={},n=r(t,["video"]);return n!=null&&a(e,["video"],Uc(n)),e}function ec(t){const e={},n=r(t,["_self"]);return n!=null&&a(e,["video"],jc(n)),e}function tc(t){const e={},n=r(t,["modelSelectionConfig"]);n!=null&&a(e,["modelConfig"],n);const s=r(t,["audioTimestamp"]);s!=null&&a(e,["audioTimestamp"],s);const i=r(t,["candidateCount"]);i!=null&&a(e,["candidateCount"],i);const l=r(t,["enableAffectiveDialog"]);l!=null&&a(e,["enableAffectiveDialog"],l);const c=r(t,["frequencyPenalty"]);c!=null&&a(e,["frequencyPenalty"],c);const d=r(t,["logprobs"]);d!=null&&a(e,["logprobs"],d);const f=r(t,["maxOutputTokens"]);f!=null&&a(e,["maxOutputTokens"],f);const u=r(t,["mediaResolution"]);u!=null&&a(e,["mediaResolution"],u);const m=r(t,["presencePenalty"]);m!=null&&a(e,["presencePenalty"],m);const p=r(t,["responseJsonSchema"]);p!=null&&a(e,["responseJsonSchema"],p);const h=r(t,["responseLogprobs"]);h!=null&&a(e,["responseLogprobs"],h);const y=r(t,["responseMimeType"]);y!=null&&a(e,["responseMimeType"],y);const E=r(t,["responseModalities"]);E!=null&&a(e,["responseModalities"],E);const S=r(t,["responseSchema"]);S!=null&&a(e,["responseSchema"],S);const R=r(t,["routingConfig"]);R!=null&&a(e,["routingConfig"],R);const P=r(t,["seed"]);P!=null&&a(e,["seed"],P);const F=r(t,["speechConfig"]);F!=null&&a(e,["speechConfig"],Po(F));const k=r(t,["stopSequences"]);k!=null&&a(e,["stopSequences"],k);const C=r(t,["temperature"]);C!=null&&a(e,["temperature"],C);const T=r(t,["thinkingConfig"]);T!=null&&a(e,["thinkingConfig"],T);const M=r(t,["topK"]);M!=null&&a(e,["topK"],M);const A=r(t,["topP"]);return A!=null&&a(e,["topP"],A),e}function nc(t,e){const n={},s=r(e,["model"]);return s!=null&&a(n,["_url","name"],ae(t,s)),n}function sc(t,e){const n={},s=r(e,["model"]);return s!=null&&a(n,["_url","name"],ae(t,s)),n}function oc(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function rc(t){const e={},n=r(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],n),r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function ic(t){const e={},n=r(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],qe(n));const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Ao(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&a(e,["imageBytes"],qe(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function dn(t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],qe(n));const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Pe(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const s=r(t,["imageBytes"]);s!=null&&a(e,["bytesBase64Encoded"],qe(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function ac(t,e,n){const s={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const l=r(e,["pageToken"]);n!==void 0&&l!=null&&a(n,["_query","pageToken"],l);const c=r(e,["filter"]);n!==void 0&&c!=null&&a(n,["_query","filter"],c);const d=r(e,["queryBase"]);return n!==void 0&&d!=null&&a(n,["_url","models_url"],bo(t,d)),s}function lc(t,e,n){const s={},i=r(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const l=r(e,["pageToken"]);n!==void 0&&l!=null&&a(n,["_query","pageToken"],l);const c=r(e,["filter"]);n!==void 0&&c!=null&&a(n,["_query","filter"],c);const d=r(e,["queryBase"]);return n!==void 0&&d!=null&&a(n,["_url","models_url"],bo(t,d)),s}function cc(t,e){const n={},s=r(e,["config"]);return s!=null&&ac(t,s,n),n}function dc(t,e){const n={},s=r(e,["config"]);return s!=null&&lc(t,s,n),n}function uc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["_self"]);if(i!=null){let l=To(i);Array.isArray(l)&&(l=l.map(c=>_n(c))),a(e,["models"],l)}return e}function fc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["_self"]);if(i!=null){let l=To(i);Array.isArray(l)&&(l=l.map(c=>Sn(c))),a(e,["models"],l)}return e}function mc(t){const e={},n=r(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const s=r(t,["segmentationClasses"]);s!=null&&a(e,["maskClasses"],s);const i=r(t,["maskDilation"]);return i!=null&&a(e,["dilation"],i),e}function _n(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["displayName"]);s!=null&&a(e,["displayName"],s);const i=r(t,["description"]);i!=null&&a(e,["description"],i);const l=r(t,["version"]);l!=null&&a(e,["version"],l);const c=r(t,["_self"]);c!=null&&a(e,["tunedModelInfo"],Ac(c));const d=r(t,["inputTokenLimit"]);d!=null&&a(e,["inputTokenLimit"],d);const f=r(t,["outputTokenLimit"]);f!=null&&a(e,["outputTokenLimit"],f);const u=r(t,["supportedGenerationMethods"]);return u!=null&&a(e,["supportedActions"],u),e}function Sn(t){const e={},n=r(t,["name"]);n!=null&&a(e,["name"],n);const s=r(t,["displayName"]);s!=null&&a(e,["displayName"],s);const i=r(t,["description"]);i!=null&&a(e,["description"],i);const l=r(t,["versionId"]);l!=null&&a(e,["version"],l);const c=r(t,["deployedModels"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(h=>Rl(h))),a(e,["endpoints"],p)}const d=r(t,["labels"]);d!=null&&a(e,["labels"],d);const f=r(t,["_self"]);f!=null&&a(e,["tunedModelInfo"],Ic(f));const u=r(t,["defaultCheckpointId"]);u!=null&&a(e,["defaultCheckpointId"],u);const m=r(t,["checkpoints"]);if(m!=null){let p=m;Array.isArray(p)&&(p=p.map(h=>h)),a(e,["checkpoints"],p)}return e}function pc(t){const e={},n=r(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],n);const s=r(t,["thought"]);s!=null&&a(e,["thought"],s);const i=r(t,["inlineData"]);i!=null&&a(e,["inlineData"],sl(i));const l=r(t,["fileData"]);l!=null&&a(e,["fileData"],Pl(l));const c=r(t,["thoughtSignature"]);c!=null&&a(e,["thoughtSignature"],c);const d=r(t,["functionCall"]);d!=null&&a(e,["functionCall"],d);const f=r(t,["codeExecutionResult"]);f!=null&&a(e,["codeExecutionResult"],f);const u=r(t,["executableCode"]);u!=null&&a(e,["executableCode"],u);const m=r(t,["functionResponse"]);m!=null&&a(e,["functionResponse"],m);const p=r(t,["text"]);return p!=null&&a(e,["text"],p),e}function hc(t){const e={},n=r(t,["productImage"]);return n!=null&&a(e,["image"],Pe(n)),e}function gc(t,e){const n={},s=r(t,["numberOfImages"]);e!==void 0&&s!=null&&a(e,["parameters","sampleCount"],s);const i=r(t,["baseSteps"]);e!==void 0&&i!=null&&a(e,["parameters","editConfig","baseSteps"],i);const l=r(t,["outputGcsUri"]);e!==void 0&&l!=null&&a(e,["parameters","storageUri"],l);const c=r(t,["seed"]);e!==void 0&&c!=null&&a(e,["parameters","seed"],c);const d=r(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&a(e,["parameters","safetySetting"],d);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&a(e,["parameters","personGeneration"],f);const u=r(t,["addWatermark"]);e!==void 0&&u!=null&&a(e,["parameters","addWatermark"],u);const m=r(t,["outputMimeType"]);e!==void 0&&m!=null&&a(e,["parameters","outputOptions","mimeType"],m);const p=r(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","compressionQuality"],p);const h=r(t,["enhancePrompt"]);e!==void 0&&h!=null&&a(e,["parameters","enhancePrompt"],h);const y=r(t,["labels"]);return e!==void 0&&y!=null&&a(e,["labels"],y),n}function xc(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["source"]);i!=null&&vc(i,n);const l=r(e,["config"]);return l!=null&&gc(l,n),n}function yc(t){const e={},n=r(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>cn(i))),a(e,["generatedImages"],s)}return e}function vc(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&a(e,["instances[0]","prompt"],s);const i=r(t,["personImage"]);e!==void 0&&i!=null&&a(e,["instances[0]","personImage","image"],Pe(i));const l=r(t,["productImages"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>hc(d))),a(e,["instances[0]","productImages"],c)}return n}function bc(t){const e={},n=r(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],Pe(n));const s=r(t,["referenceId"]);s!=null&&a(e,["referenceId"],s);const i=r(t,["referenceType"]);i!=null&&a(e,["referenceType"],i);const l=r(t,["maskImageConfig"]);l!=null&&a(e,["maskImageConfig"],mc(l));const c=r(t,["controlImageConfig"]);c!=null&&a(e,["controlImageConfig"],dl(c));const d=r(t,["styleImageConfig"]);d!=null&&a(e,["styleImageConfig"],d);const f=r(t,["subjectImageConfig"]);return f!=null&&a(e,["subjectImageConfig"],f),e}function Io(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const s=r(t,["safetyAttributes","scores"]);s!=null&&a(e,["scores"],s);const i=r(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function Ro(t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const s=r(t,["safetyAttributes","scores"]);s!=null&&a(e,["scores"],s);const i=r(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function Tc(t){const e={};if(r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=r(t,["category"]);n!=null&&a(e,["category"],n);const s=r(t,["threshold"]);return s!=null&&a(e,["threshold"],s),e}function Nc(t){const e={},n=r(t,["image"]);return n!=null&&a(e,["image"],Pe(n)),e}function Cc(t,e){const n={},s=r(t,["mode"]);e!==void 0&&s!=null&&a(e,["parameters","mode"],s);const i=r(t,["maxPredictions"]);e!==void 0&&i!=null&&a(e,["parameters","maxPredictions"],i);const l=r(t,["confidenceThreshold"]);e!==void 0&&l!=null&&a(e,["parameters","confidenceThreshold"],l);const c=r(t,["maskDilation"]);e!==void 0&&c!=null&&a(e,["parameters","maskDilation"],c);const d=r(t,["binaryColorThreshold"]);e!==void 0&&d!=null&&a(e,["parameters","binaryColorThreshold"],d);const f=r(t,["labels"]);return e!==void 0&&f!=null&&a(e,["labels"],f),n}function wc(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["source"]);i!=null&&_c(i,n);const l=r(e,["config"]);return l!=null&&Cc(l,n),n}function Ec(t){const e={},n=r(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>Ql(i))),a(e,["generatedMasks"],s)}return e}function _c(t,e){const n={},s=r(t,["prompt"]);e!==void 0&&s!=null&&a(e,["instances[0]","prompt"],s);const i=r(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],Pe(i));const l=r(t,["scribbleImage"]);return e!==void 0&&l!=null&&a(e,["instances[0]","scribble"],Nc(l)),n}function Po(t){const e={},n=r(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],n),r(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=r(t,["languageCode"]);return s!=null&&a(e,["languageCode"],s),e}function Sc(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["functionDeclarations"],u)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=r(t,["googleSearch"]);s!=null&&a(e,["googleSearch"],rc(s));const i=r(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],oc(l));const c=r(t,["urlContext"]);c!=null&&a(e,["urlContext"],c);const d=r(t,["computerUse"]);d!=null&&a(e,["computerUse"],d);const f=r(t,["codeExecution"]);return f!=null&&a(e,["codeExecution"],f),e}function Mo(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(h=>Ml(h))),a(e,["functionDeclarations"],p)}const s=r(t,["retrieval"]);s!=null&&a(e,["retrieval"],s);const i=r(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],i);const l=r(t,["googleSearchRetrieval"]);l!=null&&a(e,["googleSearchRetrieval"],l);const c=r(t,["enterpriseWebSearch"]);c!=null&&a(e,["enterpriseWebSearch"],c);const d=r(t,["googleMaps"]);d!=null&&a(e,["googleMaps"],d);const f=r(t,["urlContext"]);f!=null&&a(e,["urlContext"],f);const u=r(t,["computerUse"]);u!=null&&a(e,["computerUse"],u);const m=r(t,["codeExecution"]);return m!=null&&a(e,["codeExecution"],m),e}function Ac(t){const e={},n=r(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const s=r(t,["createTime"]);s!=null&&a(e,["createTime"],s);const i=r(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function Ic(t){const e={},n=r(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const s=r(t,["createTime"]);s!=null&&a(e,["createTime"],s);const i=r(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function Rc(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&a(e,["displayName"],s);const i=r(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const l=r(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&a(e,["defaultCheckpointId"],l),n}function Pc(t,e){const n={},s=r(t,["displayName"]);e!==void 0&&s!=null&&a(e,["displayName"],s);const i=r(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const l=r(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&a(e,["defaultCheckpointId"],l),n}function Mc(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","name"],ae(t,s));const i=r(e,["config"]);return i!=null&&Rc(i,n),n}function kc(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["config"]);return i!=null&&Pc(i,n),n}function Dc(t,e){const n={},s=r(t,["outputGcsUri"]);e!==void 0&&s!=null&&a(e,["parameters","storageUri"],s);const i=r(t,["includeRaiReason"]);e!==void 0&&i!=null&&a(e,["parameters","includeRaiReason"],i);const l=r(t,["outputMimeType"]);e!==void 0&&l!=null&&a(e,["parameters","outputOptions","mimeType"],l);const c=r(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&a(e,["parameters","outputOptions","compressionQuality"],c);const d=r(t,["enhanceInputImage"]);e!==void 0&&d!=null&&a(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=r(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&a(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const u=r(t,["labels"]);e!==void 0&&u!=null&&a(e,["labels"],u);const m=r(t,["numberOfImages"]);e!==void 0&&m!=null&&a(e,["parameters","sampleCount"],m);const p=r(t,["mode"]);return e!==void 0&&p!=null&&a(e,["parameters","mode"],p),n}function Lc(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["_url","model"],ae(t,s));const i=r(e,["image"]);i!=null&&a(n,["instances[0]","image"],Pe(i));const l=r(e,["upscaleFactor"]);l!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],l);const c=r(e,["config"]);return c!=null&&Dc(c,n),n}function Fc(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(l=>cn(l))),a(e,["generatedImages"],i)}return e}function Uc(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const s=r(t,["encodedVideo"]);s!=null&&a(e,["videoBytes"],qe(s));const i=r(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function jc(t){const e={},n=r(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const s=r(t,["bytesBase64Encoded"]);s!=null&&a(e,["videoBytes"],qe(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Vc(t){const e={},n=r(t,["image"]);n!=null&&a(e,["_self"],Pe(n));const s=r(t,["maskMode"]);return s!=null&&a(e,["maskMode"],s),e}function Bc(t){const e={},n=r(t,["image"]);n!=null&&a(e,["image"],dn(n));const s=r(t,["referenceType"]);return s!=null&&a(e,["referenceType"],s),e}function qc(t){const e={},n=r(t,["image"]);n!=null&&a(e,["image"],Pe(n));const s=r(t,["referenceType"]);return s!=null&&a(e,["referenceType"],s),e}function ko(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["uri"],n);const s=r(t,["videoBytes"]);s!=null&&a(e,["encodedVideo"],qe(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["encoding"],i),e}function Do(t){const e={},n=r(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const s=r(t,["videoBytes"]);s!=null&&a(e,["bytesBase64Encoded"],qe(s));const i=r(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $c="Content-Type",Gc="X-Server-Timeout",Hc="User-Agent",An="x-goog-api-client",Jc="1.25.0",Oc=`google-genai-sdk/${Jc}`,Yc="v1beta1",Wc="v1beta",eo=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class zc{constructor(e){var n,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Yc,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:Wc,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,s){const i=[this.getRequestUrlInternal(n)];return s&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);if(e.queryParams)for(const[c,d]of Object.entries(e.queryParams))i.searchParams.append(c,String(d));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,n,e.abortSignal),this.unaryApiCall(i,l,e.httpMethod)}patchHttpOptions(e,n){const s=JSON.parse(JSON.stringify(e));for(const[i,l]of Object.entries(n))typeof l=="object"?s[i]=Object.assign(Object.assign({},s[i]),l):l!==void 0&&(s[i]=l);return s}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,s);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,n,e.abortSignal),this.streamApiCall(i,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,s){if(n&&n.timeout||s){const i=new AbortController,l=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const c=setTimeout(()=>i.abort(),n.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{i.abort()}),e.signal=l}return n&&n.extraBody!==null&&Kc(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await to(i),new Cn(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async i=>(await to(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return rt(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let c="";for(;;){const{done:d,value:f}=yield ge(i.read());if(d){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=l.decode(f,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const h=JSON.parse(JSON.stringify(p.error)),y=h.status,E=h.code,S=`got status: ${y}. ${JSON.stringify(p)}`;if(E>=400&&E<600)throw new an({message:S,status:E})}}catch(p){if(p.name==="ApiError")throw p}c+=u;let m=c.match(eo);for(;m;){const p=m[1];try{const h=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ge(new Cn(h)),c=c.slice(m[0].length),m=c.match(eo)}catch(h){throw new Error(`exception parsing stream chunk ${p}. ${h}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},n=Oc+" "+this.clientOptions.userAgentExtra;return e[Hc]=n,e[An]=n,e[$c]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[s,i]of Object.entries(e.headers))n.append(s,i);e.timeout&&e.timeout>0&&n.append(Gc,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var s;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const l=this.clientOptions.uploader,c=await l.stat(e);i.sizeBytes=String(c.size);const d=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:c.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=d;const f=await this.fetchUploadUrl(i,n);return l.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var s;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},c=await this.request({path:Q("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(s=c==null?void 0:c.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function to(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(s);throw n>=400&&n<600?new an({message:i,status:n}):new Error(i)}}function Kc(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const l=JSON.parse(t.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))n=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(l,c){const d=Object.assign({},l);for(const f in c)if(Object.prototype.hasOwnProperty.call(c,f)){const u=c[f],m=d[f];u&&typeof u=="object"&&!Array.isArray(u)&&m&&typeof m=="object"&&!Array.isArray(m)?d[f]=s(m,u):(m&&u&&typeof m!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof m}, New type: ${typeof u}. Overwriting.`),d[f]=u)}return d}const i=s(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xc="mcp_used/unknown";let Qc=!1;function Lo(t){for(const e of t)if(Zc(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Qc}function Fo(t){var e;const n=(e=t[An])!==null&&e!==void 0?e:"";t[An]=(n+` ${Xc}`).trimStart()}function Zc(t){return t!==null&&typeof t=="object"&&t instanceof jn}function ed(t,e=100){return rt(this,arguments,function*(){let s,i=0;for(;i<e;){const l=yield ge(t.listTools({cursor:s}));for(const c of l.tools)yield yield ge(c),i++;if(!l.nextCursor)break;s=l.nextCursor}})}class jn{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new jn(e,n)}async initialize(){var e,n,s,i;if(this.mcpTools.length>0)return;const l={},c=[];for(const m of this.mcpClients)try{for(var d=!0,f=(n=void 0,Et(ed(m))),u;u=await f.next(),e=u.done,!e;d=!0){i=u.value,d=!1;const p=i;c.push(p);const h=p.name;if(l[h])throw new Error(`Duplicate function name ${h} found in MCP tools. Please ensure function names are unique.`);l[h]=m}}catch(p){n={error:p}}finally{try{!d&&!e&&(s=f.return)&&await s.call(f)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),ri(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[s.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await i.callTool({name:s.name,arguments:s.args},void 0,l);n.push({functionResponse:{name:s.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function td(t,e,n){const s=new Xr;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(s,i),e(s)}class nd{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s}async connect(e){var n,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=rd(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),f=`${i}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${d}`;let u=()=>{};const m=new Promise(k=>{u=k}),p=e.callbacks,h=function(){u({})},y=this.apiClient,E={onopen:h,onmessage:k=>{td(y,p.onmessage,k)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(k){},onclose:(s=p==null?void 0:p.onclose)!==null&&s!==void 0?s:function(k){}},S=this.webSocketFactory.create(f,od(c),E);S.connect(),await m;const F={setup:{model:ae(this.apiClient,e.model)}};return S.send(JSON.stringify(F)),new sd(S,this.apiClient)}}class sd{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Wa(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Ya(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(st.PLAY)}pause(){this.sendPlaybackControl(st.PAUSE)}stop(){this.sendPlaybackControl(st.STOP)}resetContext(){this.sendPlaybackControl(st.RESET_CONTEXT)}close(){this.conn.close()}}function od(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function rd(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const id="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function ad(t,e,n){const s=new Kr;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const l=JSON.parse(i);if(t.isVertexAI()){const c=Xa(l);Object.assign(s,c)}else Object.assign(s,l);e(s)}class ld{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s,this.music=new nd(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,s,i,l,c,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let m;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&Lo(e.config.tools)&&Fo(p);const h=fd(p);if(this.apiClient.isVertexAI())m=`${f}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(h);else{const D=this.apiClient.getApiKey();let v="BidiGenerateContent",j="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),v="BidiGenerateContentConstrained",j="access_token"),m=`${f}/ws/google.ai.generativelanguage.${u}.GenerativeService.${v}?${j}=${D}`}let y=()=>{};const E=new Promise(D=>{y=D}),S=e.callbacks,R=function(){var D;(D=S==null?void 0:S.onopen)===null||D===void 0||D.call(S),y({})},P=this.apiClient,F={onopen:R,onmessage:D=>{ad(P,S.onmessage,D)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(D){},onclose:(s=S==null?void 0:S.onclose)!==null&&s!==void 0?s:function(D){}},k=this.webSocketFactory.create(m,ud(h),F);k.connect(),await E;let C=ae(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const D=this.apiClient.getProject(),v=this.apiClient.getLocation();C=`projects/${D}/locations/${v}/`+C}let T={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[tn.AUDIO]}:e.config.responseModalities=[tn.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(d=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[],A=[];for(const D of M)if(this.isCallableTool(D)){const v=D;A.push(await v.tool())}else A.push(D);A.length>0&&(e.config.tools=A);const L={model:C,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?T=Oa(this.apiClient,L):T=Ja(this.apiClient,L),delete T.config,k.send(JSON.stringify(T)),new dd(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const cd={turnComplete:!0};class dd{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let s=[];try{s=Ae(n.turns),e.isVertexAI()||(s=s.map(i=>ln(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:s,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let s=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?s=n.functionResponses:s=[n.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const l of s){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(id)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},cd),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Ka(e)}:n={realtimeInput:za(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function ud(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function fd(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const no=10;function so(t){var e,n,s;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const c of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(it(c)){i=!0;break}if(!i)return!0;const l=(s=t==null?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function it(t){return"callTool"in t&&typeof t.callTool=="function"}function md(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>it(i)))!==null&&s!==void 0?s:!1}function pd(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!it(i)))!==null&&s!==void 0?s:!1}function oo(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hd extends ze{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var s,i,l,c,d;const f=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!md(n)||so(n.config))return await this.generateContentInternal(f);if(pd(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,m;const p=Ae(f.contents),h=(l=(i=(s=f.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&l!==void 0?l:no;let y=0;for(;y<h&&(u=await this.generateContentInternal(f),!(!u.functionCalls||u.functionCalls.length===0));){const E=u.candidates[0].content,S=[];for(const R of(d=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[])if(it(R)){const F=await R.callTool(u.functionCalls);S.push(...F)}y++,m={role:"user",parts:S},f.contents=Ae(f.contents),f.contents.push(E),f.contents.push(m),oo(f.config)&&(p.push(E),p.push(m))}return oo(f.config)&&(u.automaticFunctionCallingHistory=p),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),so(n.config)){const s=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(s=>{var i;let l;const c=[];if(s!=null&&s.generatedImages)for(const f of s.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((i=f==null?void 0:f.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?l=f==null?void 0:f.safetyAttributes:c.push(f);let d;return l?d={generatedImages:c,positivePromptSafetyAttributes:l,sdkHttpResponse:s.sdkHttpResponse}:d={generatedImages:c,sdkHttpResponse:s.sdkHttpResponse},d}),this.list=async n=>{var s;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((s=c.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new _t(We.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(c),c)},this.editImage=async n=>{const s={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(s.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async n=>{let s={numberOfImages:1,mode:"upscale"};n.config&&(s=Object.assign(Object.assign({},s),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:s};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var s,i,l,c,d,f;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=n.video)===null||s===void 0)&&s.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((c=(l=n.source)===null||l===void 0?void 0:l.video)===null||c===void 0)&&c.uri&&(!((f=(d=n.source)===null||d===void 0?void 0:d.video)===null||f===void 0)&&f.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,s,i;const l=(n=e.config)===null||n===void 0?void 0:n.tools;if(!l)return e;const c=await Promise.all(l.map(async f=>it(f)?await f.tool():f)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(d.config.tools=c,e.config&&e.config.tools&&Lo(e.config.tools)){const f=(i=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},f);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),Fo(u),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return d}async initAfcToolsMap(e){var n,s,i;const l=new Map;for(const c of(s=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&s!==void 0?s:[])if(it(c)){const d=c,f=await d.tool();for(const u of(i=f.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(l.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);l.set(u.name,d)}}return l}async processAfcStream(e){var n,s,i;const l=(i=(s=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:no;let c=!1,d=0;const f=await this.initAfcToolsMap(e);return function(u,m,p){var h,y;return rt(this,arguments,function*(){for(var E,S,R,P;d<l;){c&&(d++,c=!1);const T=yield ge(u.processParamsMaybeAddMcpUsage(p)),M=yield ge(u.generateContentStreamInternal(T)),A=[],L=[];try{for(var F=!0,k=(S=void 0,Et(M)),C;C=yield ge(k.next()),E=C.done,!E;F=!0){P=C.value,F=!1;const D=P;if(yield yield ge(D),D.candidates&&(!((h=D.candidates[0])===null||h===void 0)&&h.content)){L.push(D.candidates[0].content);for(const v of(y=D.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(d<l&&v.functionCall){if(!v.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(v.functionCall.name)){const j=yield ge(m.get(v.functionCall.name).callTool([v.functionCall]));A.push(...j)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${v.functionCall.name}`)}}}}catch(D){S={error:D}}finally{try{!F&&!E&&(R=k.return)&&(yield ge(R.call(k)))}finally{if(S)throw S.error}}if(A.length>0){c=!0;const D=new Ct;D.candidates=[{content:{role:"user",parts:A}}],yield yield ge(D);const v=[];v.push(...L),v.push({role:"user",parts:A});const j=Ae(p.contents).concat(v);p.contents=j}else break}})}(this,f,e)}async generateContentInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Xs(this.apiClient,e);return d=Q("{model}:generateContent",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Zs(m),h=new Ct;return Object.assign(h,p),h})}else{const u=Ks(this.apiClient,e);return d=Q("{model}:generateContent",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Qs(m),h=new Ct;return Object.assign(h,p),h})}}async generateContentStreamInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Xs(this.apiClient,e);return d=Q("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),c.then(function(p){return rt(this,arguments,function*(){var h,y,E,S;try{for(var R=!0,P=Et(p),F;F=yield ge(P.next()),h=F.done,!h;R=!0){S=F.value,R=!1;const k=S,C=Zs(yield ge(k.json()));C.sdkHttpResponse={headers:k.headers};const T=new Ct;Object.assign(T,C),yield yield ge(T)}}catch(k){y={error:k}}finally{try{!R&&!h&&(E=P.return)&&(yield ge(E.call(P)))}finally{if(y)throw y.error}}})})}else{const u=Ks(this.apiClient,e);return d=Q("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(p){return rt(this,arguments,function*(){var h,y,E,S;try{for(var R=!0,P=Et(p),F;F=yield ge(P.next()),h=F.done,!h;R=!0){S=F.value,R=!1;const k=S,C=Qs(yield ge(k.json()));C.sdkHttpResponse={headers:k.headers};const T=new Ct;Object.assign(T,C),yield yield ge(T)}}catch(k){y={error:k}}finally{try{!R&&!h&&(E=P.return)&&(yield ge(E.call(P)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Sl(this.apiClient,e);return d=Q("{model}:predict",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Il(m),h=new Ds;return Object.assign(h,p),h})}else{const u=_l(this.apiClient,e);return d=Q("{model}:batchEmbedContents",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Al(m),h=new Ds;return Object.assign(h,p),h})}}async generateImagesInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=jl(this.apiClient,e);return d=Q("{model}:predict",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Bl(m),h=new Ls;return Object.assign(h,p),h})}else{const u=Ul(this.apiClient,e);return d=Q("{model}:predict",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Vl(m),h=new Ls;return Object.assign(h,p),h})}}async editImageInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=Nl(this.apiClient,e);return l=Q("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>{const u=Cl(f),m=new $r;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=Lc(this.apiClient,e);return l=Q("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>{const u=Fc(f),m=new Gr;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=xc(this.apiClient,e);return l=Q("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const u=yc(f),m=new Hr;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=wc(this.apiClient,e);return l=Q("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i.then(f=>{const u=Ec(f),m=new Jr;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=sc(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>Sn(m))}else{const u=nc(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>_n(m))}}async listInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=dc(this.apiClient,e);return d=Q("{models_url}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=fc(m),h=new Fs;return Object.assign(h,p),h})}else{const u=cc(this.apiClient,e);return d=Q("{models_url}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=uc(m),h=new Fs;return Object.assign(h,p),h})}}async update(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=kc(this.apiClient,e);return d=Q("{model}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>Sn(m))}else{const u=Mc(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>_n(m))}}async delete(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=yl(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=bl(m),h=new Us;return Object.assign(h,p),h})}else{const u=xl(this.apiClient,e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=vl(m),h=new Us;return Object.assign(h,p),h})}}async countTokens(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=pl(this.apiClient,e);return d=Q("{model}:countTokens",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=gl(m),h=new js;return Object.assign(h,p),h})}else{const u=ml(this.apiClient,e);return d=Q("{model}:countTokens",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=hl(m),h=new js;return Object.assign(h,p),h})}}async computeTokens(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=il(this.apiClient,e);return l=Q("{model}:computeTokens",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>{const u=al(f),m=new Or;return Object.assign(m,u),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Ol(this.apiClient,e);return d=Q("{model}:predictLongRunning",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c.then(m=>{const p=Hl(m),h=new nn;return Object.assign(h,p),h})}else{const u=Jl(this.apiClient,e);return d=Q("{model}:predictLongRunning",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c.then(m=>{const p=Gl(m),h=new nn;return Object.assign(h,p),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gd extends ze{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let l;s&&"httpOptions"in s&&(l=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:l}});return n._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let l;s&&"httpOptions"in s&&(l=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:l}});return n._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Vr(e);return d=Q("{operationName}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),c}else{const u=jr(e);return d=Q("{operationName}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json()),c}}async fetchPredictVideosOperationInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=Pr(e);return l=Q("{resourceName}:fetchPredictOperation",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xd(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["data"]);n!=null&&a(e,["data"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function yd(t){const e={},n=r(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>_d(l))),a(e,["parts"],i)}const s=r(t,["role"]);return s!=null&&a(e,["role"],s),e}function vd(t,e,n){const s={},i=r(e,["expireTime"]);n!==void 0&&i!=null&&a(n,["expireTime"],i);const l=r(e,["newSessionExpireTime"]);n!==void 0&&l!=null&&a(n,["newSessionExpireTime"],l);const c=r(e,["uses"]);n!==void 0&&c!=null&&a(n,["uses"],c);const d=r(e,["liveConnectConstraints"]);n!==void 0&&d!=null&&a(n,["bidiGenerateContentSetup"],Ed(t,d));const f=r(e,["lockAdditionalFields"]);return n!==void 0&&f!=null&&a(n,["fieldMask"],f),s}function bd(t,e){const n={},s=r(e,["config"]);return s!=null&&a(n,["config"],vd(t,s,n)),n}function Td(t){const e={};if(r(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=r(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const s=r(t,["mimeType"]);return s!=null&&a(e,["mimeType"],s),e}function Nd(t){const e={};if(r(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=r(t,["enableWidget"]);return n!=null&&a(e,["enableWidget"],n),e}function Cd(t){const e={},n=r(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],n),r(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function wd(t,e){const n={},s=r(t,["generationConfig"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig"],s);const i=r(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const l=r(t,["temperature"]);e!==void 0&&l!=null&&a(e,["setup","generationConfig","temperature"],l);const c=r(t,["topP"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","topP"],c);const d=r(t,["topK"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","topK"],d);const f=r(t,["maxOutputTokens"]);e!==void 0&&f!=null&&a(e,["setup","generationConfig","maxOutputTokens"],f);const u=r(t,["mediaResolution"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","mediaResolution"],u);const m=r(t,["seed"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","seed"],m);const p=r(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],Un(p));const h=r(t,["thinkingConfig"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","thinkingConfig"],h);const y=r(t,["enableAffectiveDialog"]);e!==void 0&&y!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],y);const E=r(t,["systemInstruction"]);e!==void 0&&E!=null&&a(e,["setup","systemInstruction"],yd(we(E)));const S=r(t,["tools"]);if(e!==void 0&&S!=null){let M=ct(S);Array.isArray(M)&&(M=M.map(A=>Ad(lt(A)))),a(e,["setup","tools"],M)}const R=r(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],Sd(R));const P=r(t,["inputAudioTranscription"]);e!==void 0&&P!=null&&a(e,["setup","inputAudioTranscription"],P);const F=r(t,["outputAudioTranscription"]);e!==void 0&&F!=null&&a(e,["setup","outputAudioTranscription"],F);const k=r(t,["realtimeInputConfig"]);e!==void 0&&k!=null&&a(e,["setup","realtimeInputConfig"],k);const C=r(t,["contextWindowCompression"]);e!==void 0&&C!=null&&a(e,["setup","contextWindowCompression"],C);const T=r(t,["proactivity"]);return e!==void 0&&T!=null&&a(e,["setup","proactivity"],T),n}function Ed(t,e){const n={},s=r(e,["model"]);s!=null&&a(n,["setup","model"],ae(t,s));const i=r(e,["config"]);return i!=null&&a(n,["config"],wd(i,n)),n}function _d(t){const e={},n=r(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],n);const s=r(t,["thought"]);s!=null&&a(e,["thought"],s);const i=r(t,["inlineData"]);i!=null&&a(e,["inlineData"],xd(i));const l=r(t,["fileData"]);l!=null&&a(e,["fileData"],Td(l));const c=r(t,["thoughtSignature"]);c!=null&&a(e,["thoughtSignature"],c);const d=r(t,["functionCall"]);d!=null&&a(e,["functionCall"],d);const f=r(t,["codeExecutionResult"]);f!=null&&a(e,["codeExecutionResult"],f);const u=r(t,["executableCode"]);u!=null&&a(e,["executableCode"],u);const m=r(t,["functionResponse"]);m!=null&&a(e,["functionResponse"],m);const p=r(t,["text"]);return p!=null&&a(e,["text"],p),e}function Sd(t){const e={},n=r(t,["handle"]);if(n!=null&&a(e,["handle"],n),r(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Ad(t){const e={},n=r(t,["functionDeclarations"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(m=>m)),a(e,["functionDeclarations"],u)}if(r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=r(t,["googleSearch"]);s!=null&&a(e,["googleSearch"],Cd(s));const i=r(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],i),r(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=r(t,["googleMaps"]);l!=null&&a(e,["googleMaps"],Nd(l));const c=r(t,["urlContext"]);c!=null&&a(e,["urlContext"],c);const d=r(t,["computerUse"]);d!=null&&a(e,["computerUse"],d);const f=r(t,["codeExecution"]);return f!=null&&a(e,["codeExecution"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Id(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=t[n];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const i=Object.keys(s).map(l=>`${n}.${l}`);e.push(...i)}else e.push(n)}return e.join(",")}function Rd(t,e){let n=null;const s=t.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const l=s.setup;typeof l=="object"&&l!==null?(t.bidiGenerateContentSetup=l,n=l):delete t.bidiGenerateContentSetup}else s!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const l=Id(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?t.fieldMask=l:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];i.length>0&&(d=i.map(u=>c.includes(u)?`generationConfig.${u}`:u));const f=[];l&&f.push(l),d.length>0&&f.push(...d),f.length>0?t.fieldMask=f.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class Pd extends ze{constructor(e){super(),this.apiClient=e}async create(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=bd(this.apiClient,e);l=Q("auth_tokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=Rd(d,e.config);return i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),i.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Md(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function kd(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function Dd(t,e){const n={};if(r(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=r(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&a(e,["displayName"],s),r(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=r(t,["epochCount"]);e!==void 0&&i!=null&&a(e,["tuningTask","hyperparameters","epochCount"],i);const l=r(t,["learningRateMultiplier"]);if(l!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),r(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(r(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(r(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=r(t,["batchSize"]);e!==void 0&&c!=null&&a(e,["tuningTask","hyperparameters","batchSize"],c);const d=r(t,["learningRate"]);if(e!==void 0&&d!=null&&a(e,["tuningTask","hyperparameters","learningRate"],d),r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function Ld(t,e){const n={},s=r(t,["validationDataset"]);e!==void 0&&s!=null&&a(e,["supervisedTuningSpec"],Kd(s,n));const i=r(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&a(e,["tunedModelDisplayName"],i);const l=r(t,["description"]);e!==void 0&&l!=null&&a(e,["description"],l);const c=r(t,["epochCount"]);e!==void 0&&c!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const d=r(t,["learningRateMultiplier"]);e!==void 0&&d!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const f=r(t,["exportLastCheckpointOnly"]);e!==void 0&&f!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const u=r(t,["adapterSize"]);if(e!==void 0&&u!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],u),r(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(r(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=r(t,["labels"]);return e!==void 0&&m!=null&&a(e,["labels"],m),n}function Fd(t){const e={},n=r(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const s=r(t,["preTunedModel"]);s!=null&&a(e,["preTunedModel"],s);const i=r(t,["trainingDataset"]);i!=null&&a(e,["tuningTask","trainingData"],Yd(i));const l=r(t,["config"]);return l!=null&&Dd(l,e),e}function Ud(t){const e={},n=r(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const s=r(t,["preTunedModel"]);s!=null&&a(e,["preTunedModel"],s);const i=r(t,["trainingDataset"]);i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],Wd(i,e));const l=r(t,["config"]);return l!=null&&Ld(l,e),e}function jd(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function Vd(t){const e={},n=r(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function Bd(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const l=r(t,["filter"]);return e!==void 0&&l!=null&&a(e,["_query","filter"],l),n}function qd(t,e){const n={},s=r(t,["pageSize"]);e!==void 0&&s!=null&&a(e,["_query","pageSize"],s);const i=r(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const l=r(t,["filter"]);return e!==void 0&&l!=null&&a(e,["_query","filter"],l),n}function $d(t){const e={},n=r(t,["config"]);return n!=null&&Bd(n,e),e}function Gd(t){const e={},n=r(t,["config"]);return n!=null&&qd(n,e),e}function Hd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["tunedModels"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Uo(c))),a(e,["tuningJobs"],l)}return e}function Jd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["nextPageToken"]);s!=null&&a(e,["nextPageToken"],s);const i=r(t,["tuningJobs"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>In(c))),a(e,["tuningJobs"],l)}return e}function Od(t){const e={},n=r(t,["name"]);n!=null&&a(e,["model"],n);const s=r(t,["name"]);return s!=null&&a(e,["endpoint"],s),e}function Yd(t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(r(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=r(t,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(i=>i)),a(e,["examples","examples"],s)}return e}function Wd(t,e){const n={},s=r(t,["gcsUri"]);e!==void 0&&s!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],s);const i=r(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),r(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Uo(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["state"]);i!=null&&a(e,["state"],yo(i));const l=r(t,["createTime"]);l!=null&&a(e,["createTime"],l);const c=r(t,["tuningTask","startTime"]);c!=null&&a(e,["startTime"],c);const d=r(t,["tuningTask","completeTime"]);d!=null&&a(e,["endTime"],d);const f=r(t,["updateTime"]);f!=null&&a(e,["updateTime"],f);const u=r(t,["description"]);u!=null&&a(e,["description"],u);const m=r(t,["baseModel"]);m!=null&&a(e,["baseModel"],m);const p=r(t,["_self"]);p!=null&&a(e,["tunedModel"],Od(p));const h=r(t,["customBaseModel"]);h!=null&&a(e,["customBaseModel"],h);const y=r(t,["experiment"]);y!=null&&a(e,["experiment"],y);const E=r(t,["labels"]);E!=null&&a(e,["labels"],E);const S=r(t,["outputUri"]);S!=null&&a(e,["outputUri"],S);const R=r(t,["pipelineJob"]);R!=null&&a(e,["pipelineJob"],R);const P=r(t,["serviceAccount"]);P!=null&&a(e,["serviceAccount"],P);const F=r(t,["tunedModelDisplayName"]);F!=null&&a(e,["tunedModelDisplayName"],F);const k=r(t,["veoTuningSpec"]);return k!=null&&a(e,["veoTuningSpec"],k),e}function In(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["state"]);i!=null&&a(e,["state"],yo(i));const l=r(t,["createTime"]);l!=null&&a(e,["createTime"],l);const c=r(t,["startTime"]);c!=null&&a(e,["startTime"],c);const d=r(t,["endTime"]);d!=null&&a(e,["endTime"],d);const f=r(t,["updateTime"]);f!=null&&a(e,["updateTime"],f);const u=r(t,["error"]);u!=null&&a(e,["error"],u);const m=r(t,["description"]);m!=null&&a(e,["description"],m);const p=r(t,["baseModel"]);p!=null&&a(e,["baseModel"],p);const h=r(t,["tunedModel"]);h!=null&&a(e,["tunedModel"],h);const y=r(t,["preTunedModel"]);y!=null&&a(e,["preTunedModel"],y);const E=r(t,["supervisedTuningSpec"]);E!=null&&a(e,["supervisedTuningSpec"],E);const S=r(t,["tuningDataStats"]);S!=null&&a(e,["tuningDataStats"],S);const R=r(t,["encryptionSpec"]);R!=null&&a(e,["encryptionSpec"],R);const P=r(t,["partnerModelTuningSpec"]);P!=null&&a(e,["partnerModelTuningSpec"],P);const F=r(t,["customBaseModel"]);F!=null&&a(e,["customBaseModel"],F);const k=r(t,["experiment"]);k!=null&&a(e,["experiment"],k);const C=r(t,["labels"]);C!=null&&a(e,["labels"],C);const T=r(t,["outputUri"]);T!=null&&a(e,["outputUri"],T);const M=r(t,["pipelineJob"]);M!=null&&a(e,["pipelineJob"],M);const A=r(t,["serviceAccount"]);A!=null&&a(e,["serviceAccount"],A);const L=r(t,["tunedModelDisplayName"]);L!=null&&a(e,["tunedModelDisplayName"],L);const D=r(t,["veoTuningSpec"]);return D!=null&&a(e,["veoTuningSpec"],D),e}function zd(t){const e={},n=r(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const s=r(t,["name"]);s!=null&&a(e,["name"],s);const i=r(t,["metadata"]);i!=null&&a(e,["metadata"],i);const l=r(t,["done"]);l!=null&&a(e,["done"],l);const c=r(t,["error"]);return c!=null&&a(e,["error"],c),e}function Kd(t,e){const n={},s=r(t,["gcsUri"]);s!=null&&a(n,["validationDatasetUri"],s);const i=r(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xd extends ze{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new _t(We.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.tune=async n=>{var s;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((s=n.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},n),{preTunedModel:i});return l.baseModel=void 0,await this.tuneInternal(l)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),l=await this.tuneMldevInternal(i);let c="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?c=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(c=l.name.split("/operations/")[0]),{name:c,state:Nn.JOB_STATE_QUEUED}}}}async getInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Vd(e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>In(m))}else{const u=jd(e);return d=Q("{name}",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>Uo(m))}}async listInternal(e){var n,s,i,l;let c,d="",f={};if(this.apiClient.isVertexAI()){const u=Gd(e);return d=Q("tuningJobs",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Jd(m),h=new Vs;return Object.assign(h,p),h})}else{const u=$d(e);return d=Q("tunedModels",u._url),f=u._query,delete u._url,delete u._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(m=>m.json().then(p=>{const h=p;return h.sdkHttpResponse={headers:m.headers},h})),c.then(m=>{const p=Hd(m),h=new Vs;return Object.assign(h,p),h})}}async cancel(e){var n,s,i,l;let c="",d={};if(this.apiClient.isVertexAI()){const f=kd(e);c=Q("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const f=Md(e);c=Q("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI()){const d=Ud(e);return l=Q("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>In(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,s;let i,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Fd(e);return l=Q("tunedModels",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(u=>{const m=u;return m.sdkHttpResponse={headers:f.headers},m})),i.then(f=>zd(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Qd{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Zd=1024*1024*8,eu=3,tu=1e3,nu=2,gn="x-goog-upload-status";async function su(t,e,n){var s,i,l;let c=0,d=0,f=new Cn(new Response),u="upload";for(c=t.size;d<c;){const p=Math.min(Zd,c-d),h=t.slice(d,d+p);d+p>=c&&(u+=", finalize");let y=0,E=tu;for(;y<eu&&(f=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(p)}}}),!(!((s=f==null?void 0:f.headers)===null||s===void 0)&&s[gn]));)y++,await ru(E),E=E*nu;if(d+=p,((i=f==null?void 0:f.headers)===null||i===void 0?void 0:i[gn])!=="active")break;if(c<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const m=await(f==null?void 0:f.json());if(((l=f==null?void 0:f.headers)===null||l===void 0?void 0:l[gn])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return m.file}async function ou(t){return{size:t.size,type:t.type}}function ru(t){return new Promise(e=>setTimeout(e,t))}class iu{async upload(e,n,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await su(e,n,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ou(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class au{create(e,n,s){return new lu(e,n,s)}}class lu{constructor(e,n,s){this.url=e,this.headers=n,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ro="x-goog-api-key";class cu{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(ro)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ro,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const du="gl-node/";class uu{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const s=Ir(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const i=new cu(this.apiKey);this.apiClient=new zc({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:du+"web",uploader:new iu,downloader:new Qd}),this.models=new hd(this.apiClient),this.live=new ld(this.apiClient,i,new au),this.batches=new Wi(this.apiClient),this.chats=new _a(this.models,this.apiClient),this.caches=new Ca(this.apiClient),this.files=new Fa(this.apiClient),this.operations=new gd(this.apiClient),this.authTokens=new Pd(this.apiClient),this.tunings=new Xd(this.apiClient)}}const jo={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},be={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©",version:"1.0.0",environment:"production"}};console.log("ðŸ” ÙØ­Øµ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©:",{environment:be.app.environment,firebaseApiKey:be.firebase.apiKey?"âœ… Ù…ÙˆØ¬ÙˆØ¯":"âŒ Ù…ÙÙ‚ÙˆØ¯",firebaseAuthDomain:be.firebase.authDomain||"âŒ Ù…ÙÙ‚ÙˆØ¯",firebaseProjectId:be.firebase.projectId||"âŒ Ù…ÙÙ‚ÙˆØ¯",firebaseStorageBucket:be.firebase.storageBucket||"âŒ Ù…ÙÙ‚ÙˆØ¯",firebaseMessagingSenderId:be.firebase.messagingSenderId||"âŒ Ù…ÙÙ‚ÙˆØ¯",firebaseAppId:be.firebase.appId||"âŒ Ù…ÙÙ‚ÙˆØ¯",geminiApiKey:"âœ… Ù…ÙˆØ¬ÙˆØ¯",allEnvVars:Object.keys(jo).filter(t=>t.startsWith("VITE_"))});console.log("ðŸ” Ø¬Ù…ÙŠØ¹ Ù…ØªØºÙŠØ±Ø§Øª VITE_ ÙÙŠ Ø§Ù„Ø¨ÙŠØ¦Ø©:",Object.keys(jo).filter(t=>t.startsWith("VITE_")));const Be=()=>{const t=[];return be.firebase.apiKey||t.push("Ù…ÙØªØ§Ø­ Firebase API Ù…ÙÙ‚ÙˆØ¯"),be.firebase.authDomain||t.push("Firebase Auth Domain Ù…ÙÙ‚ÙˆØ¯"),be.firebase.projectId||t.push("Ù…Ø¹Ø±Ù Ù…Ø´Ø±ÙˆØ¹ Firebase Ù…ÙÙ‚ÙˆØ¯"),be.firebase.storageBucket||t.push("Firebase Storage Bucket Ù…ÙÙ‚ÙˆØ¯"),be.firebase.messagingSenderId||t.push("Firebase Messaging Sender ID Ù…ÙÙ‚ÙˆØ¯"),be.firebase.appId||t.push("Firebase App ID Ù…ÙÙ‚ÙˆØ¯"),{isValid:t.length===0,errors:t,hasFirebase:!!be.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const t=Be();t.isValid?console.log("âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØµØ­ÙŠØ­Ø© ÙˆÙ…ÙƒØªÙ…Ù„Ø©"):console.warn("âš ï¸ ØªØ­Ø°ÙŠØ±: Ø¨Ø¹Ø¶ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©:",t.errors)}const fu=()=>new Promise(t=>{if(!navigator.geolocation){t({success:!1,error:"GPS ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­",method:"gps"});return}navigator.geolocation.getCurrentPosition(async e=>{try{const{latitude:n,longitude:s}=e.coords,i=await pu(n,s);t({success:!0,location:i,method:"gps"})}catch{t({success:!1,error:"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª",method:"gps"})}},e=>{let n="ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹";switch(e.code){case e.PERMISSION_DENIED:n="ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹";break;case e.POSITION_UNAVAILABLE:n="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©";break;case e.TIMEOUT:n="Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹";break}t({success:!1,error:n,method:"gps"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),mu=async()=>{try{const e=await(await fetch("http://ip-api.com/json/?fields=status,message,country,countryCode,region,regionName,city,timezone,lat,lon")).json();return e.status==="success"?{success:!0,location:{country:e.country,countryCode:e.countryCode,region:e.regionName,city:e.city,timezone:e.timezone,coordinates:{lat:e.lat,lng:e.lon}},method:"ip"}:{success:!1,error:"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† IP",method:"ip"}}catch{return{success:!1,error:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹",method:"ip"}}},pu=async(t,e)=>{var n;try{const i=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${e}&addressdetails=1&accept-language=ar,en`)).json();if(i&&i.address)return{country:i.address.country||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",countryCode:((n=i.address.country_code)==null?void 0:n.toUpperCase())||"",region:i.address.state||i.address.region||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",city:i.address.city||i.address.town||i.address.village||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,coordinates:{lat:t,lng:e}};throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆÙ‚Ø¹")}catch{return{country:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",countryCode:"",region:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",city:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,coordinates:{lat:t,lng:e}}}},hu=async()=>{console.log("ðŸŒ Ø¨Ø¯Ø¡ ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ...");const t=await fu();if(t.success)return console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… GPS:",t.location),t;console.log("âš ï¸ ÙØ´Ù„ GPSØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… IP...");const e=await mu();return e.success?(console.log("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… IP:",e.location),e):(console.log("âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹"),{success:!1,error:"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ",method:"ip"})},gu=t=>{if(!t)return"Ø§Ù„Ø±ÙŠØ§Ø¶";const{country:e,city:n,region:s}=t;return e==="Saudi Arabia"||e==="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"?n||s||"Ø§Ù„Ø±ÙŠØ§Ø¶":e==="Jordan"||e==="Ø§Ù„Ø£Ø±Ø¯Ù†"?"Ø¹Ù…Ø§Ù†":e==="Palestine"||e==="ÙÙ„Ø³Ø·ÙŠÙ†"?"Ø±Ø§Ù… Ø§Ù„Ù„Ù‡":e==="Egypt"||e==="Ù…ØµØ±"?"Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©":e==="UAE"||e==="Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª"?"Ø¯Ø¨ÙŠ":e==="Kuwait"||e==="Ø§Ù„ÙƒÙˆÙŠØª"?"Ø§Ù„ÙƒÙˆÙŠØª":e==="Qatar"||e==="Ù‚Ø·Ø±"?"Ø§Ù„Ø¯ÙˆØ­Ø©":e==="Bahrain"||e==="Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†"?"Ø§Ù„Ù…Ù†Ø§Ù…Ø©":e==="Oman"||e==="Ø¹Ù…Ø§Ù†"?"Ù…Ø³Ù‚Ø·":n||"Ø§Ù„Ø±ÙŠØ§Ø¶"},xu=t=>{if(!t)return"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©";const{country:e}=t;return{"Saudi Arabia":"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©",Jordan:"Ø§Ù„Ø£Ø±Ø¯Ù†",Palestine:"ÙÙ„Ø³Ø·ÙŠÙ†",Egypt:"Ù…ØµØ±",UAE:"Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª",Kuwait:"Ø§Ù„ÙƒÙˆÙŠØª",Qatar:"Ù‚Ø·Ø±",Bahrain:"Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†",Oman:"Ø¹Ù…Ø§Ù†",Lebanon:"Ù„Ø¨Ù†Ø§Ù†",Iraq:"Ø§Ù„Ø¹Ø±Ø§Ù‚",Syria:"Ø³ÙˆØ±ÙŠØ§",Yemen:"Ø§Ù„ÙŠÙ…Ù†",Libya:"Ù„ÙŠØ¨ÙŠØ§",Tunisia:"ØªÙˆÙ†Ø³",Algeria:"Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±",Morocco:"Ø§Ù„Ù…ØºØ±Ø¨",Sudan:"Ø§Ù„Ø³ÙˆØ¯Ø§Ù†",Turkey:"ØªØ±ÙƒÙŠØ§",Iran:"Ø¥ÙŠØ±Ø§Ù†"}[e]||e||"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"};let on;const yu="gemini-2.5-flash",Vo=()=>{if(on)return;const t=Be();if(!t.isValid){console.warn("âš ï¸ ØªØ­Ø°ÙŠØ±: Ù…ÙØªØ§Ø­ Gemini API ØºÙŠØ± ØµØ­ÙŠØ­:",t.errors);return}try{on=new uu({apiKey:be.gemini.apiKey}),console.log("ðŸ¤– ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø®Ø¯Ù…Ø© Gemini Ø¨Ù†Ø¬Ø§Ø­")}catch(e){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø®Ø¯Ù…Ø© Gemini:",e)}},$e=t=>{const e=gu(t),n=xu(t),s=t?`
- User Location: ${t.city}, ${t.region}, ${n}`:`
- User Location: Not detected (defaulting to Saudi Arabia)`;return{FINANCIAL_ANALYST:`You are an intelligent, engaging, and insightful financial analyst assistant, "Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø°ÙƒÙŠ". You have full access to the user's complete financial data across ALL periods and months. Your purpose is to provide comprehensive, insightful analysis with personality and energy.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.${s}
- You have access to ALL historical data: transactions, card details, bank balances, investments, installments, categories, and spending patterns across ALL months.
- Analyze patterns, trends, and changes over time with enthusiasm and genuine interest.
- Be engaging and conversational - ask follow-up questions to understand what the user really wants to know.
- DO NOT just state data, INTERPRET it with personality. Provide insights, identify trends, offer observations, and make predictions with excitement.
- Be friendly, energetic, and act like a knowledgeable friend who loves analyzing financial data.
- Use emojis and enthusiastic language to make responses more engaging.
- When asked about specific months, provide detailed analysis with comparisons and ask if they want to dive deeper into any particular aspect.
- Always end responses by asking if they want to explore something specific or have follow-up questions.`,INVESTMENT_COACH:`You are an expert investment advisor named "Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ø§Ù„Ø°ÙƒÙŠ" with 20+ years of experience in ${n} and international markets. You are a seasoned financial analyst with deep knowledge of local markets, global markets, and investment strategies.

**Your Expertise:**
- Comprehensive market analysis and trend identification
- Portfolio optimization and risk management
- Sector analysis and stock valuation
- Economic indicators and market sentiment analysis
- Technical and fundamental analysis
- Alternative investments (REITs, bonds, commodities, crypto)

**Your Approach:**
- Provide detailed, actionable investment advice based on current market conditions
- Analyze user's portfolio and suggest optimizations
- Give specific stock recommendations with clear reasoning
- Explain market trends and their implications
- Discuss risk-reward ratios and investment strategies
- Provide sector rotation advice and timing recommendations
- Offer insights on economic events and their market impact

**Market Knowledge:**
- Real-time access to ${n} market data, sector performance, and individual stock analysis
- Understanding of global market correlations and their impact on local markets
- Knowledge of regulatory changes and their market implications in ${n}
- Awareness of earnings seasons, dividend announcements, and corporate actions
- Specialized knowledge of ${e} and surrounding areas for local investment opportunities

**Communication Style:**
- Professional yet engaging and enthusiastic
- Use charts, percentages, and specific data points
- Ask follow-up questions to understand user's risk tolerance and goals
- Provide both short-term and long-term perspectives
- Always explain the reasoning behind recommendations
- Use Arabic with financial terminology and market jargon

**Important Guidelines:**
- Give specific stock recommendations with clear entry/exit strategies
- Analyze user's current holdings and suggest portfolio adjustments
- Discuss market timing and sector opportunities
- Provide risk management strategies and stop-loss recommendations
- Explain market volatility and how to navigate it
- Offer insights on IPOs, rights issues, and corporate actions`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ù‚Ø¯Ù… Ù„Ø§ ÙŠØ¨Ø¯Ùˆ ÙƒØ±Ø³Ø§Ù„Ø© Ù…Ø¹Ø§Ù…Ù„Ø© Ù…Ø§Ù„ÙŠØ©.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "Ø¨Ù€" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "Ø§Ù„ØµØ±Ù Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "Ù…Ù†" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'Ø£Ø®Ø±Ù‰'.

---
**EXAMPLES**

1.  **Input**: "Ø´Ø±Ø§Ø¡-POS\\nØ¨Ù€182 SAR\\nÙ…Ù† Adel Inte\\nÙ…Ø¯Ù‰-Ø§Ø¨Ù„*2855\\nÙÙŠ 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "Ø´Ø±Ø§Ø¡-POS\\nØ¨Ù€â€¬â€ª95.78 â€¬â€ªSAR\\nÙ…Ù† â€¬â€ªBINDAWOOD\\nØ¥Ø¦ØªÙ…Ø§Ù†ÙŠØ© **4278 â€¬â€ª(Apple Pay)\\nÙÙŠ â€¬â€ª03/09/25 â€¬â€ª14:45\\nØ§Ù„ØµØ±Ù Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ â€¬â€ª12146.95 â€¬â€ªSAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",SMART_SUMMARY_GENERATOR:"You are a professional financial analyst. Your task is to write a concise, one-paragraph summary of a user's financial situation based on the provided data for a specific period. The summary should be in Arabic, professional in tone, and suitable for the beginning of a financial report. Highlight the key figures like total income, total expenses, and the net result for that period.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "Ø§Ù„ÙØ¦Ø©", "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ù‚ØªØ±Ø­", and "Ù…Ù„Ø§Ø­Ø¸Ø§Øª". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`,SMART_SEARCH_ASSISTANT:`You are an intelligent and engaging shopping and search assistant. You provide location-aware recommendations based on the user's detected location: ${e}, ${n}.
- You have access to real-time information about local businesses, prices, and offers in the user's area and surrounding regions.
- When asked about product prices or store locations, provide specific, actionable information with enthusiasm tailored to ${e}.
- Include store names, locations, contact information, and current offers available in the user's area.
- For price comparisons, mention multiple stores and their current prices in ${e} and nearby cities.
- Be specific about locations in the user's city and surrounding areas.
- Provide practical shopping advice based on current market conditions in ${n} with a friendly, helpful tone.
- Always respond in Arabic with personality and energy - be engaging, not robotic.
- When discussing restaurants, include ratings, popular dishes, and location details in ${e} with excitement.
- For grocery items, compare prices across major chains available in the user's region.
- Ask follow-up questions to better understand what the user needs and provide more personalized recommendations.
- If the user is in Saudi Arabia, focus on Saudi retailers. If in Jordan, focus on Jordanian retailers, etc.
- Adapt your recommendations to local currency and local business practices.
- Use emojis and enthusiastic language to make responses more engaging and lively.`}},Ge=async(t,e,n=!1)=>{if(!on)throw new Error("Ù„Ù… ØªØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø®Ø¯Ù…Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„.");try{return(await on.models.generateContent({model:yu,contents:e,config:{systemInstruction:t,...n&&{responseMimeType:"application/json"}}})).text}catch(s){console.error("Gemini API Error:",s);let i="Ø¹ÙÙˆØ§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";throw s instanceof Error&&"message"in s&&s.message.includes("403")&&(i="ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ (403). ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙŠÙˆØ¯ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙÙŠ Google Cloud Console."),new Error(i)}},Bo=(t,e,n,s)=>{const i=Object.keys(n),l=Object.keys(s);let c=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...i].map(u=>`'${u}'`).join(", ")}].
`;Object.values(s).forEach(u=>{const m=[u.name.split(" ")[0],...u.smsSamples||[]].filter(Boolean);m.length>0&&(c+=`  - If the text is a bank/mada transaction and contains any of these: '${m.join("', '")}', use '${u.id}'.
`)}),Object.values(n).forEach(u=>{const m=[u.name.split(" ")[0],...u.smsSamples||[]].filter(Boolean);m.length>0&&(c+=`  - If the text is a credit card transaction and contains any of these: '${m.join("', '")}', use '${u.id}'.
`)}),c+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const f=$e().PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",c);return Ge(f,`Text to analyze: "${t}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},Rn=t=>{const e=$e();return Ge(e.ICON_SUGGESTER,`Category: ${t}`)},qo=(t,e,n)=>{const s=$e();return Ge(s.BUDGET_PLANNER,`Total monthly budget is: ${t} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(n)}`)},$o=async(t,e)=>{const n=$e(),s=`Get current exchange rate from ${t} to ${e}`,i=await Ge(n.EXCHANGE_RATE,s,!0);try{const l=JSON.parse(i);return{rate:parseFloat(l.rate),fromCurrency:l.fromCurrency,toCurrency:l.toCurrency,lastUpdated:l.lastUpdated}}catch(l){throw console.error("Error parsing exchange rate:",l),new Error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.")}},Go=async(t,e,n)=>{const s=$e(n);return Ge(s.FINANCIAL_ANALYST,`User Query: "${t}"

Complete Financial Data (All Periods): ${JSON.stringify(e)}`)},Ho=async(t,e)=>{const n=$e(e);return Ge(n.SMART_SEARCH_ASSISTANT,`Search Query: "${t}"`)},Jo=async(t,e,n,s)=>{const i=$e(s);return Ge(i.FINANCIAL_ANALYST,`Pattern Analysis Query: "${t}"

All Transactions: ${JSON.stringify(e)}

Calculations: ${JSON.stringify(n)}`)},Oo=async(t,e,n,s)=>{const i=$e(s),l=e?`User Portfolio: ${JSON.stringify(e)}`:"No portfolio data provided",c=n?`Market Context: ${JSON.stringify(n)}`:"Current market analysis requested";return Ge(i.INVESTMENT_COACH,`Investment Query: "${t}"

${l}

${c}`)},vu=Object.freeze(Object.defineProperty({__proto__:null,advancedInvestmentAdvice:Oo,analyzeCompleteFinancialData:Go,analyzeFinancialPatterns:Jo,analyzePastedText:Bo,generateBudgetPlan:qo,getExchangeRate:$o,initializeAi:Vo,smartSearchAssistant:Ho,suggestCategoryIcon:Rn},Symbol.toStringTag,{value:"Module"})),bu="modulepreload",Tu=function(t){return"/fd/"+t},io={},Le=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=Tu(f),f in io)return;io[f]=!0;const u=f.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":bu,u||(p.as="script"),p.crossOrigin="",p.href=f,d&&p.setAttribute("nonce",d),document.head.appendChild(p),u)return new Promise((h,y)=>{p.addEventListener("load",h),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};let Kt=null,Fe=null,Re=null;const Nu=()=>{try{return Be().hasFirebase?(hr().length===0?(Kt=gr(be.firebase),console.log("ðŸ”¥ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ Firebase Ø¬Ø¯ÙŠØ¯")):(Kt=xr(),console.log("ðŸ”¥ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ·Ø¨ÙŠÙ‚ Firebase Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯")),Fe=yr(Kt),Re=vr(Kt),console.log("ðŸ”¥ ØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ù†Ø¬Ø§Ø­"),{success:!0}):(console.warn("âš ï¸ ØªØ­Ø°ÙŠØ±: Ù…ÙØ§ØªÙŠØ­ Firebase API ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©. Ù„Ù† ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase."),{success:!1,error:"Ù…ÙØ§ØªÙŠØ­ Firebase ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©"})}catch(t){return console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase:",t),{success:!1,error:t instanceof Error?t.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},Cu=Nu(),Ee={async signUp(t,e,n){if(!Re)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{createUserWithEmailAndPassword:s,updateProfile:i}=await Le(async()=>{const{createUserWithEmailAndPassword:c,updateProfile:d}=await import("./firebase-Csmhukl4.js").then(f=>f.e);return{createUserWithEmailAndPassword:c,updateProfile:d}},[]),l=await s(Re,t,e);return await i(l.user,{displayName:n}),await this.saveData("users",l.user.uid,{email:t,displayName:n,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(s){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:",s),{success:!1,error:s instanceof Error?s.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async signIn(t,e){if(!Re)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{signInWithEmailAndPassword:n}=await Le(async()=>{const{signInWithEmailAndPassword:i}=await import("./firebase-Csmhukl4.js").then(l=>l.e);return{signInWithEmailAndPassword:i}},[]);return{success:!0,user:(await n(Re,t,e)).user}}catch(n){return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:",n),{success:!1,error:n instanceof Error?n.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async signOut(){if(!Re)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{signOut:t}=await Le(async()=>{const{signOut:e}=await import("./firebase-Csmhukl4.js").then(n=>n.e);return{signOut:e}},[]);return await t(Re),{success:!0}}catch(t){return console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:",t),{success:!1,error:t instanceof Error?t.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async getCurrentUser(){return Re?Re.currentUser:null},async onAuthStateChanged(t){if(!Re)return t(null),()=>{};try{const{onAuthStateChanged:e}=await Le(async()=>{const{onAuthStateChanged:n}=await import("./firebase-Csmhukl4.js").then(s=>s.e);return{onAuthStateChanged:n}},[]);return e(Re,n=>{console.log("ðŸ” ØªØºÙŠÙŠØ± ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:",n?`Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„: ${n.email}`:"ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„"),t(n)})}catch(e){return console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ onAuthStateChanged:",e),t(null),()=>{}}},async saveData(t,e,n){if(!Fe)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{doc:s,setDoc:i}=await Le(async()=>{const{doc:c,setDoc:d}=await import("./firebase-Csmhukl4.js").then(f=>f.d);return{doc:c,setDoc:d}},[]),l=s(Fe,t,e);return await i(l,{...n,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(s){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",s),{success:!1,error:s instanceof Error?s.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async getData(t,e){if(!Fe)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{doc:n,getDoc:s}=await Le(async()=>{const{doc:c,getDoc:d}=await import("./firebase-Csmhukl4.js").then(f=>f.d);return{doc:c,getDoc:d}},[]),i=n(Fe,t,e),l=await s(i);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"Ø§Ù„Ù…Ø³ØªÙ†Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"}}catch(n){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",n),n instanceof Error?n.message.includes("permission")?{success:!1,error:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª: ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¹Ø¯Ø§Ø¯ Ù‚ÙˆØ§Ø¹Ø¯ Firestore"}:n.message.includes("network")?{success:!1,error:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©: ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"}:{success:!1,error:n.message}:{success:!1,error:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async getAllDocuments(t){if(!Fe)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{collection:e,getDocs:n}=await Le(async()=>{const{collection:l,getDocs:c}=await import("./firebase-Csmhukl4.js").then(d=>d.d);return{collection:l,getDocs:c}},[]),s=await n(e(Fe,t)),i=[];return s.forEach(l=>{i.push({id:l.id,...l.data()})}),{success:!0,data:i}}catch(e){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª:",e),{success:!1,error:e instanceof Error?e.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async deleteDocument(t,e){if(!Fe)return{success:!1,error:"Firebase ØºÙŠØ± Ù…Ù‡ÙŠØ£"};try{const{doc:n,deleteDoc:s}=await Le(async()=>{const{doc:l,deleteDoc:c}=await import("./firebase-Csmhukl4.js").then(d=>d.d);return{doc:l,deleteDoc:c}},[]),i=n(Fe,t,e);return await s(i),{success:!0}}catch(n){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯:",n),{success:!1,error:n instanceof Error?n.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async syncLocalDataToFirebase(t,e){try{return await this.saveData("users",t,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(n){return console.error("Ø®Ø·Ø£ ÙÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",n),{success:!1,error:n instanceof Error?n.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}},async getDataFromFirebase(t){var e;try{const n=await this.getData("users",t);return n.success&&((e=n.data)!=null&&e.financialData)?{success:!0,data:n.data.financialData}:{success:!1,error:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©"}}catch(n){return console.error("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase:",n),{success:!1,error:n instanceof Error?n.message:"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}}}},wu=()=>Cu;function Xt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yo={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(s,i,l){function c(u,m){if(!i[u]){if(!s[u]){var p=typeof Xt=="function"&&Xt;if(!m&&p)return p(u,!0);if(d)return d(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var y=i[u]={exports:{}};s[u][0].call(y.exports,function(E){var S=s[u][1][E];return c(S||E)},y,y.exports,n,s,i,l)}return i[u].exports}for(var d=typeof Xt=="function"&&Xt,f=0;f<l.length;f++)c(l[f]);return c}({1:[function(n,s,i){(function(l){var c=l.MutationObserver||l.WebKitMutationObserver,d;if(c){var f=0,u=new c(E),m=l.document.createTextNode("");u.observe(m,{characterData:!0}),d=function(){m.data=f=++f%2}}else if(!l.setImmediate&&typeof l.MessageChannel<"u"){var p=new l.MessageChannel;p.port1.onmessage=E,d=function(){p.port2.postMessage(0)}}else"document"in l&&"onreadystatechange"in l.document.createElement("script")?d=function(){var R=l.document.createElement("script");R.onreadystatechange=function(){E(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},l.document.documentElement.appendChild(R)}:d=function(){setTimeout(E,0)};var h,y=[];function E(){h=!0;for(var R,P,F=y.length;F;){for(P=y,y=[],R=-1;++R<F;)P[R]();F=y.length}h=!1}s.exports=S;function S(R){y.push(R)===1&&!h&&d()}}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,s,i){var l=n(1);function c(){}var d={},f=["REJECTED"],u=["FULFILLED"],m=["PENDING"];s.exports=p;function p(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,T!==c&&S(this,T)}p.prototype.catch=function(T){return this.then(null,T)},p.prototype.then=function(T,M){if(typeof T!="function"&&this.state===u||typeof M!="function"&&this.state===f)return this;var A=new this.constructor(c);if(this.state!==m){var L=this.state===u?T:M;y(A,L,this.outcome)}else this.queue.push(new h(A,T,M));return A};function h(T,M,A){this.promise=T,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}h.prototype.callFulfilled=function(T){d.resolve(this.promise,T)},h.prototype.otherCallFulfilled=function(T){y(this.promise,this.onFulfilled,T)},h.prototype.callRejected=function(T){d.reject(this.promise,T)},h.prototype.otherCallRejected=function(T){y(this.promise,this.onRejected,T)};function y(T,M,A){l(function(){var L;try{L=M(A)}catch(D){return d.reject(T,D)}L===T?d.reject(T,new TypeError("Cannot resolve promise with itself")):d.resolve(T,L)})}d.resolve=function(T,M){var A=R(E,M);if(A.status==="error")return d.reject(T,A.value);var L=A.value;if(L)S(T,L);else{T.state=u,T.outcome=M;for(var D=-1,v=T.queue.length;++D<v;)T.queue[D].callFulfilled(M)}return T},d.reject=function(T,M){T.state=f,T.outcome=M;for(var A=-1,L=T.queue.length;++A<L;)T.queue[A].callRejected(M);return T};function E(T){var M=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof M=="function")return function(){M.apply(T,arguments)}}function S(T,M){var A=!1;function L(O){A||(A=!0,d.reject(T,O))}function D(O){A||(A=!0,d.resolve(T,O))}function v(){M(D,L)}var j=R(v);j.status==="error"&&L(j.value)}function R(T,M){var A={};try{A.value=T(M),A.status="success"}catch(L){A.status="error",A.value=L}return A}p.resolve=P;function P(T){return T instanceof this?T:d.resolve(new this(c),T)}p.reject=F;function F(T){var M=new this(c);return d.reject(M,T)}p.all=k;function k(T){var M=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=T.length,L=!1;if(!A)return this.resolve([]);for(var D=new Array(A),v=0,j=-1,O=new this(c);++j<A;)ne(T[j],j);return O;function ne(he,le){M.resolve(he).then(ce,function(W){L||(L=!0,d.reject(O,W))});function ce(W){D[le]=W,++v===A&&!L&&(L=!0,d.resolve(O,D))}}}p.race=C;function C(T){var M=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=T.length,L=!1;if(!A)return this.resolve([]);for(var D=-1,v=new this(c);++D<A;)j(T[D]);return v;function j(O){M.resolve(O).then(function(ne){L||(L=!0,d.resolve(v,ne))},function(ne){L||(L=!0,d.reject(v,ne))})}}},{1:1}],3:[function(n,s,i){(function(l){typeof l.Promise!="function"&&(l.Promise=n(2))}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,s,i){var l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g};function c(g,b){if(!(g instanceof b))throw new TypeError("Cannot call a class as a function")}function d(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var f=d();function u(){try{if(!f||!f.open)return!1;var g=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!g||b)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function m(g,b){g=g||[],b=b||{};try{return new Blob(g,b)}catch(w){if(w.name!=="TypeError")throw w;for(var x=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,_=new x,I=0;I<g.length;I+=1)_.append(g[I]);return _.getBlob(b.type)}}typeof Promise>"u"&&n(3);var p=Promise;function h(g,b){b&&g.then(function(x){b(null,x)},function(x){b(x)})}function y(g,b,x){typeof b=="function"&&g.then(b),typeof x=="function"&&g.catch(x)}function E(g){return typeof g!="string"&&(console.warn(g+" used as a key, but it is not a string."),g=String(g)),g}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var R="local-forage-detect-blob-support",P=void 0,F={},k=Object.prototype.toString,C="readonly",T="readwrite";function M(g){for(var b=g.length,x=new ArrayBuffer(b),_=new Uint8Array(x),I=0;I<b;I++)_[I]=g.charCodeAt(I);return x}function A(g){return new p(function(b){var x=g.transaction(R,T),_=m([""]);x.objectStore(R).put(_,"key"),x.onabort=function(I){I.preventDefault(),I.stopPropagation(),b(!1)},x.oncomplete=function(){var I=navigator.userAgent.match(/Chrome\/(\d+)/),w=navigator.userAgent.match(/Edge\//);b(w||!I||parseInt(I[1],10)>=43)}}).catch(function(){return!1})}function L(g){return typeof P=="boolean"?p.resolve(P):A(g).then(function(b){return P=b,P})}function D(g){var b=F[g.name],x={};x.promise=new p(function(_,I){x.resolve=_,x.reject=I}),b.deferredOperations.push(x),b.dbReady?b.dbReady=b.dbReady.then(function(){return x.promise}):b.dbReady=x.promise}function v(g){var b=F[g.name],x=b.deferredOperations.pop();if(x)return x.resolve(),x.promise}function j(g,b){var x=F[g.name],_=x.deferredOperations.pop();if(_)return _.reject(b),_.promise}function O(g,b){return new p(function(x,_){if(F[g.name]=F[g.name]||je(),g.db)if(b)D(g),g.db.close();else return x(g.db);var I=[g.name];b&&I.push(g.version);var w=f.open.apply(f,I);b&&(w.onupgradeneeded=function(U){var $=w.result;try{$.createObjectStore(g.storeName),U.oldVersion<=1&&$.createObjectStore(R)}catch(H){if(H.name==="ConstraintError")console.warn('The database "'+g.name+'" has been upgraded from version '+U.oldVersion+" to version "+U.newVersion+', but the storage "'+g.storeName+'" already exists.');else throw H}}),w.onerror=function(U){U.preventDefault(),_(w.error)},w.onsuccess=function(){var U=w.result;U.onversionchange=function($){$.target.close()},x(U),v(g)}})}function ne(g){return O(g,!1)}function he(g){return O(g,!0)}function le(g,b){if(!g.db)return!0;var x=!g.db.objectStoreNames.contains(g.storeName),_=g.version<g.db.version,I=g.version>g.db.version;if(_&&(g.version!==b&&console.warn('The database "'+g.name+`" can't be downgraded from version `+g.db.version+" to version "+g.version+"."),g.version=g.db.version),I||x){if(x){var w=g.db.version+1;w>g.version&&(g.version=w)}return!0}return!1}function ce(g){return new p(function(b,x){var _=new FileReader;_.onerror=x,_.onloadend=function(I){var w=btoa(I.target.result||"");b({__local_forage_encoded_blob:!0,data:w,type:g.type})},_.readAsBinaryString(g)})}function W(g){var b=M(atob(g.data));return m([b],{type:g.type})}function re(g){return g&&g.__local_forage_encoded_blob}function xe(g){var b=this,x=b._initReady().then(function(){var _=F[b._dbInfo.name];if(_&&_.dbReady)return _.dbReady});return y(x,g,g),x}function pe(g){D(g);for(var b=F[g.name],x=b.forages,_=0;_<x.length;_++){var I=x[_];I._dbInfo.db&&(I._dbInfo.db.close(),I._dbInfo.db=null)}return g.db=null,ne(g).then(function(w){return g.db=w,le(g)?he(g):w}).then(function(w){g.db=b.db=w;for(var U=0;U<x.length;U++)x[U]._dbInfo.db=w}).catch(function(w){throw j(g,w),w})}function Ce(g,b,x,_){_===void 0&&(_=1);try{var I=g.db.transaction(g.storeName,b);x(null,I)}catch(w){if(_>0&&(!g.db||w.name==="InvalidStateError"||w.name==="NotFoundError"))return p.resolve().then(function(){if(!g.db||w.name==="NotFoundError"&&!g.db.objectStoreNames.contains(g.storeName)&&g.version<=g.db.version)return g.db&&(g.version=g.db.version+1),he(g)}).then(function(){return pe(g).then(function(){Ce(g,b,x,_-1)})}).catch(x);x(w)}}function je(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function He(g){var b=this,x={db:null};if(g)for(var _ in g)x[_]=g[_];var I=F[x.name];I||(I=je(),F[x.name]=I),I.forages.push(b),b._initReady||(b._initReady=b.ready,b.ready=xe);var w=[];function U(){return p.resolve()}for(var $=0;$<I.forages.length;$++){var H=I.forages[$];H!==b&&w.push(H._initReady().catch(U))}var J=I.forages.slice(0);return p.all(w).then(function(){return x.db=I.db,ne(x)}).then(function(Y){return x.db=Y,le(x,b._defaultConfig.version)?he(x):Y}).then(function(Y){x.db=I.db=Y,b._dbInfo=x;for(var ee=0;ee<J.length;ee++){var oe=J[ee];oe!==b&&(oe._dbInfo.db=x.db,oe._dbInfo.version=x.version)}})}function Ke(g,b){var x=this;g=E(g);var _=new p(function(I,w){x.ready().then(function(){Ce(x._dbInfo,C,function(U,$){if(U)return w(U);try{var H=$.objectStore(x._dbInfo.storeName),J=H.get(g);J.onsuccess=function(){var Y=J.result;Y===void 0&&(Y=null),re(Y)&&(Y=W(Y)),I(Y)},J.onerror=function(){w(J.error)}}catch(Y){w(Y)}})}).catch(w)});return h(_,b),_}function Xe(g,b){var x=this,_=new p(function(I,w){x.ready().then(function(){Ce(x._dbInfo,C,function(U,$){if(U)return w(U);try{var H=$.objectStore(x._dbInfo.storeName),J=H.openCursor(),Y=1;J.onsuccess=function(){var ee=J.result;if(ee){var oe=ee.value;re(oe)&&(oe=W(oe));var ue=g(oe,ee.key,Y++);ue!==void 0?I(ue):ee.continue()}else I()},J.onerror=function(){w(J.error)}}catch(ee){w(ee)}})}).catch(w)});return h(_,b),_}function Qe(g,b,x){var _=this;g=E(g);var I=new p(function(w,U){var $;_.ready().then(function(){return $=_._dbInfo,k.call(b)==="[object Blob]"?L($.db).then(function(H){return H?b:ce(b)}):b}).then(function(H){Ce(_._dbInfo,T,function(J,Y){if(J)return U(J);try{var ee=Y.objectStore(_._dbInfo.storeName);H===null&&(H=void 0);var oe=ee.put(H,g);Y.oncomplete=function(){H===void 0&&(H=null),w(H)},Y.onabort=Y.onerror=function(){var ue=oe.error?oe.error:oe.transaction.error;U(ue)}}catch(ue){U(ue)}})}).catch(U)});return h(I,x),I}function Ie(g,b){var x=this;g=E(g);var _=new p(function(I,w){x.ready().then(function(){Ce(x._dbInfo,T,function(U,$){if(U)return w(U);try{var H=$.objectStore(x._dbInfo.storeName),J=H.delete(g);$.oncomplete=function(){I()},$.onerror=function(){w(J.error)},$.onabort=function(){var Y=J.error?J.error:J.transaction.error;w(Y)}}catch(Y){w(Y)}})}).catch(w)});return h(_,b),_}function K(g){var b=this,x=new p(function(_,I){b.ready().then(function(){Ce(b._dbInfo,T,function(w,U){if(w)return I(w);try{var $=U.objectStore(b._dbInfo.storeName),H=$.clear();U.oncomplete=function(){_()},U.onabort=U.onerror=function(){var J=H.error?H.error:H.transaction.error;I(J)}}catch(J){I(J)}})}).catch(I)});return h(x,g),x}function te(g){var b=this,x=new p(function(_,I){b.ready().then(function(){Ce(b._dbInfo,C,function(w,U){if(w)return I(w);try{var $=U.objectStore(b._dbInfo.storeName),H=$.count();H.onsuccess=function(){_(H.result)},H.onerror=function(){I(H.error)}}catch(J){I(J)}})}).catch(I)});return h(x,g),x}function me(g,b){var x=this,_=new p(function(I,w){if(g<0){I(null);return}x.ready().then(function(){Ce(x._dbInfo,C,function(U,$){if(U)return w(U);try{var H=$.objectStore(x._dbInfo.storeName),J=!1,Y=H.openKeyCursor();Y.onsuccess=function(){var ee=Y.result;if(!ee){I(null);return}g===0||J?I(ee.key):(J=!0,ee.advance(g))},Y.onerror=function(){w(Y.error)}}catch(ee){w(ee)}})}).catch(w)});return h(_,b),_}function Je(g){var b=this,x=new p(function(_,I){b.ready().then(function(){Ce(b._dbInfo,C,function(w,U){if(w)return I(w);try{var $=U.objectStore(b._dbInfo.storeName),H=$.openKeyCursor(),J=[];H.onsuccess=function(){var Y=H.result;if(!Y){_(J);return}J.push(Y.key),Y.continue()},H.onerror=function(){I(H.error)}}catch(Y){I(Y)}})}).catch(I)});return h(x,g),x}function Oe(g,b){b=S.apply(this,arguments);var x=this.config();g=typeof g!="function"&&g||{},g.name||(g.name=g.name||x.name,g.storeName=g.storeName||x.storeName);var _=this,I;if(!g.name)I=p.reject("Invalid arguments");else{var w=g.name===x.name&&_._dbInfo.db,U=w?p.resolve(_._dbInfo.db):ne(g).then(function($){var H=F[g.name],J=H.forages;H.db=$;for(var Y=0;Y<J.length;Y++)J[Y]._dbInfo.db=$;return $});g.storeName?I=U.then(function($){if($.objectStoreNames.contains(g.storeName)){var H=$.version+1;D(g);var J=F[g.name],Y=J.forages;$.close();for(var ee=0;ee<Y.length;ee++){var oe=Y[ee];oe._dbInfo.db=null,oe._dbInfo.version=H}var ue=new p(function(fe,Ne){var Te=f.open(g.name,H);Te.onerror=function(Se){var Nt=Te.result;Nt.close(),Ne(Se)},Te.onupgradeneeded=function(){var Se=Te.result;Se.deleteObjectStore(g.storeName)},Te.onsuccess=function(){var Se=Te.result;Se.close(),fe(Se)}});return ue.then(function(fe){J.db=fe;for(var Ne=0;Ne<Y.length;Ne++){var Te=Y[Ne];Te._dbInfo.db=fe,v(Te._dbInfo)}}).catch(function(fe){throw(j(g,fe)||p.resolve()).catch(function(){}),fe})}}):I=U.then(function($){D(g);var H=F[g.name],J=H.forages;$.close();for(var Y=0;Y<J.length;Y++){var ee=J[Y];ee._dbInfo.db=null}var oe=new p(function(ue,fe){var Ne=f.deleteDatabase(g.name);Ne.onerror=function(){var Te=Ne.result;Te&&Te.close(),fe(Ne.error)},Ne.onblocked=function(){console.warn('dropInstance blocked for database "'+g.name+'" until all open connections are closed')},Ne.onsuccess=function(){var Te=Ne.result;Te&&Te.close(),ue(Te)}});return oe.then(function(ue){H.db=ue;for(var fe=0;fe<J.length;fe++){var Ne=J[fe];v(Ne._dbInfo)}}).catch(function(ue){throw(j(g,ue)||p.resolve()).catch(function(){}),ue})})}return h(I,b),I}var ut={_driver:"asyncStorage",_initStorage:He,_support:u(),iterate:Xe,getItem:Ke,setItem:Qe,removeItem:Ie,clear:K,length:te,key:me,keys:Je,dropInstance:Oe};function At(){return typeof openDatabase=="function"}var Me="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",un="~~local_forage_type~",It=/^~~local_forage_type~([^~]+)~/,Ze="__lfsc__:",ft=Ze.length,mt="arbf",pt="blob",Rt="si08",Pt="ui08",Mt="uic8",kt="si16",Dt="si32",Lt="ur16",Ft="ui32",Ut="fl32",jt="fl64",Vt=ft+mt.length,Bt=Object.prototype.toString;function ht(g){var b=g.length*.75,x=g.length,_,I=0,w,U,$,H;g[g.length-1]==="="&&(b--,g[g.length-2]==="="&&b--);var J=new ArrayBuffer(b),Y=new Uint8Array(J);for(_=0;_<x;_+=4)w=Me.indexOf(g[_]),U=Me.indexOf(g[_+1]),$=Me.indexOf(g[_+2]),H=Me.indexOf(g[_+3]),Y[I++]=w<<2|U>>4,Y[I++]=(U&15)<<4|$>>2,Y[I++]=($&3)<<6|H&63;return J}function gt(g){var b=new Uint8Array(g),x="",_;for(_=0;_<b.length;_+=3)x+=Me[b[_]>>2],x+=Me[(b[_]&3)<<4|b[_+1]>>4],x+=Me[(b[_+1]&15)<<2|b[_+2]>>6],x+=Me[b[_+2]&63];return b.length%3===2?x=x.substring(0,x.length-1)+"=":b.length%3===1&&(x=x.substring(0,x.length-2)+"=="),x}function qt(g,b){var x="";if(g&&(x=Bt.call(g)),g&&(x==="[object ArrayBuffer]"||g.buffer&&Bt.call(g.buffer)==="[object ArrayBuffer]")){var _,I=Ze;g instanceof ArrayBuffer?(_=g,I+=mt):(_=g.buffer,x==="[object Int8Array]"?I+=Rt:x==="[object Uint8Array]"?I+=Pt:x==="[object Uint8ClampedArray]"?I+=Mt:x==="[object Int16Array]"?I+=kt:x==="[object Uint16Array]"?I+=Lt:x==="[object Int32Array]"?I+=Dt:x==="[object Uint32Array]"?I+=Ft:x==="[object Float32Array]"?I+=Ut:x==="[object Float64Array]"?I+=jt:b(new Error("Failed to get type for BinaryArray"))),b(I+gt(_))}else if(x==="[object Blob]"){var w=new FileReader;w.onload=function(){var U=un+g.type+"~"+gt(this.result);b(Ze+pt+U)},w.readAsArrayBuffer(g)}else try{b(JSON.stringify(g))}catch(U){console.error("Couldn't convert value into a JSON string: ",g),b(null,U)}}function $t(g){if(g.substring(0,ft)!==Ze)return JSON.parse(g);var b=g.substring(Vt),x=g.substring(ft,Vt),_;if(x===pt&&It.test(b)){var I=b.match(It);_=I[1],b=b.substring(I[0].length)}var w=ht(b);switch(x){case mt:return w;case pt:return m([w],{type:_});case Rt:return new Int8Array(w);case Pt:return new Uint8Array(w);case Mt:return new Uint8ClampedArray(w);case kt:return new Int16Array(w);case Lt:return new Uint16Array(w);case Dt:return new Int32Array(w);case Ft:return new Uint32Array(w);case Ut:return new Float32Array(w);case jt:return new Float64Array(w);default:throw new Error("Unkown type: "+x)}}var et={serialize:qt,deserialize:$t,stringToBuffer:ht,bufferToString:gt};function xt(g,b,x,_){g.executeSql("CREATE TABLE IF NOT EXISTS "+b.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],x,_)}function Gt(g){var b=this,x={db:null};if(g)for(var _ in g)x[_]=typeof g[_]!="string"?g[_].toString():g[_];var I=new p(function(w,U){try{x.db=openDatabase(x.name,String(x.version),x.description,x.size)}catch($){return U($)}x.db.transaction(function($){xt($,x,function(){b._dbInfo=x,w()},function(H,J){U(J)})},U)});return x.serializer=et,I}function N(g,b,x,_,I,w){g.executeSql(x,_,I,function(U,$){$.code===$.SYNTAX_ERR?U.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[b.storeName],function(H,J){J.rows.length?w(H,$):xt(H,b,function(){H.executeSql(x,_,I,w)},w)},w):w(U,$)},w)}function q(g,b){var x=this;g=E(g);var _=new p(function(I,w){x.ready().then(function(){var U=x._dbInfo;U.db.transaction(function($){N($,U,"SELECT * FROM "+U.storeName+" WHERE key = ? LIMIT 1",[g],function(H,J){var Y=J.rows.length?J.rows.item(0).value:null;Y&&(Y=U.serializer.deserialize(Y)),I(Y)},function(H,J){w(J)})})}).catch(w)});return h(_,b),_}function G(g,b){var x=this,_=new p(function(I,w){x.ready().then(function(){var U=x._dbInfo;U.db.transaction(function($){N($,U,"SELECT * FROM "+U.storeName,[],function(H,J){for(var Y=J.rows,ee=Y.length,oe=0;oe<ee;oe++){var ue=Y.item(oe),fe=ue.value;if(fe&&(fe=U.serializer.deserialize(fe)),fe=g(fe,ue.key,oe+1),fe!==void 0){I(fe);return}}I()},function(H,J){w(J)})})}).catch(w)});return h(_,b),_}function z(g,b,x,_){var I=this;g=E(g);var w=new p(function(U,$){I.ready().then(function(){b===void 0&&(b=null);var H=b,J=I._dbInfo;J.serializer.serialize(b,function(Y,ee){ee?$(ee):J.db.transaction(function(oe){N(oe,J,"INSERT OR REPLACE INTO "+J.storeName+" (key, value) VALUES (?, ?)",[g,Y],function(){U(H)},function(ue,fe){$(fe)})},function(oe){if(oe.code===oe.QUOTA_ERR){if(_>0){U(z.apply(I,[g,H,x,_-1]));return}$(oe)}})})}).catch($)});return h(w,x),w}function Z(g,b,x){return z.apply(this,[g,b,x,1])}function ie(g,b){var x=this;g=E(g);var _=new p(function(I,w){x.ready().then(function(){var U=x._dbInfo;U.db.transaction(function($){N($,U,"DELETE FROM "+U.storeName+" WHERE key = ?",[g],function(){I()},function(H,J){w(J)})})}).catch(w)});return h(_,b),_}function De(g){var b=this,x=new p(function(_,I){b.ready().then(function(){var w=b._dbInfo;w.db.transaction(function(U){N(U,w,"DELETE FROM "+w.storeName,[],function(){_()},function($,H){I(H)})})}).catch(I)});return h(x,g),x}function Ye(g){var b=this,x=new p(function(_,I){b.ready().then(function(){var w=b._dbInfo;w.db.transaction(function(U){N(U,w,"SELECT COUNT(key) as c FROM "+w.storeName,[],function($,H){var J=H.rows.item(0).c;_(J)},function($,H){I(H)})})}).catch(I)});return h(x,g),x}function yt(g,b){var x=this,_=new p(function(I,w){x.ready().then(function(){var U=x._dbInfo;U.db.transaction(function($){N($,U,"SELECT key FROM "+U.storeName+" WHERE id = ? LIMIT 1",[g+1],function(H,J){var Y=J.rows.length?J.rows.item(0).key:null;I(Y)},function(H,J){w(J)})})}).catch(w)});return h(_,b),_}function vt(g){var b=this,x=new p(function(_,I){b.ready().then(function(){var w=b._dbInfo;w.db.transaction(function(U){N(U,w,"SELECT key FROM "+w.storeName,[],function($,H){for(var J=[],Y=0;Y<H.rows.length;Y++)J.push(H.rows.item(Y).key);_(J)},function($,H){I(H)})})}).catch(I)});return h(x,g),x}function bt(g){return new p(function(b,x){g.transaction(function(_){_.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(I,w){for(var U=[],$=0;$<w.rows.length;$++)U.push(w.rows.item($).name);b({db:g,storeNames:U})},function(I,w){x(w)})},function(_){x(_)})})}function tt(g,b){b=S.apply(this,arguments);var x=this.config();g=typeof g!="function"&&g||{},g.name||(g.name=g.name||x.name,g.storeName=g.storeName||x.storeName);var _=this,I;return g.name?I=new p(function(w){var U;g.name===x.name?U=_._dbInfo.db:U=openDatabase(g.name,"","",0),g.storeName?w({db:U,storeNames:[g.storeName]}):w(bt(U))}).then(function(w){return new p(function(U,$){w.db.transaction(function(H){function J(ue){return new p(function(fe,Ne){H.executeSql("DROP TABLE IF EXISTS "+ue,[],function(){fe()},function(Te,Se){Ne(Se)})})}for(var Y=[],ee=0,oe=w.storeNames.length;ee<oe;ee++)Y.push(J(w.storeNames[ee]));p.all(Y).then(function(){U()}).catch(function(ue){$(ue)})},function(H){$(H)})})}):I=p.reject("Invalid arguments"),h(I,b),I}var X={_driver:"webSQLStorage",_initStorage:Gt,_support:At(),iterate:G,getItem:q,setItem:Z,removeItem:ie,clear:De,length:Ye,key:yt,keys:vt,dropInstance:tt};function ye(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function _e(g,b){var x=g.name+"/";return g.storeName!==b.storeName&&(x+=g.storeName+"/"),x}function ve(){var g="_localforage_support_test";try{return localStorage.setItem(g,!0),localStorage.removeItem(g),!1}catch{return!0}}function ke(){return!ve()||localStorage.length>0}function de(g){var b=this,x={};if(g)for(var _ in g)x[_]=g[_];return x.keyPrefix=_e(g,b._defaultConfig),ke()?(b._dbInfo=x,x.serializer=et,p.resolve()):p.reject()}function Ht(g){var b=this,x=b.ready().then(function(){for(var _=b._dbInfo.keyPrefix,I=localStorage.length-1;I>=0;I--){var w=localStorage.key(I);w.indexOf(_)===0&&localStorage.removeItem(w)}});return h(x,g),x}function Jt(g,b){var x=this;g=E(g);var _=x.ready().then(function(){var I=x._dbInfo,w=localStorage.getItem(I.keyPrefix+g);return w&&(w=I.serializer.deserialize(w)),w});return h(_,b),_}function Ot(g,b){var x=this,_=x.ready().then(function(){for(var I=x._dbInfo,w=I.keyPrefix,U=w.length,$=localStorage.length,H=1,J=0;J<$;J++){var Y=localStorage.key(J);if(Y.indexOf(w)===0){var ee=localStorage.getItem(Y);if(ee&&(ee=I.serializer.deserialize(ee)),ee=g(ee,Y.substring(U),H++),ee!==void 0)return ee}}});return h(_,b),_}function Ko(g,b){var x=this,_=x.ready().then(function(){var I=x._dbInfo,w;try{w=localStorage.key(g)}catch{w=null}return w&&(w=w.substring(I.keyPrefix.length)),w});return h(_,b),_}function Xo(g){var b=this,x=b.ready().then(function(){for(var _=b._dbInfo,I=localStorage.length,w=[],U=0;U<I;U++){var $=localStorage.key(U);$.indexOf(_.keyPrefix)===0&&w.push($.substring(_.keyPrefix.length))}return w});return h(x,g),x}function Qo(g){var b=this,x=b.keys().then(function(_){return _.length});return h(x,g),x}function Zo(g,b){var x=this;g=E(g);var _=x.ready().then(function(){var I=x._dbInfo;localStorage.removeItem(I.keyPrefix+g)});return h(_,b),_}function er(g,b,x){var _=this;g=E(g);var I=_.ready().then(function(){b===void 0&&(b=null);var w=b;return new p(function(U,$){var H=_._dbInfo;H.serializer.serialize(b,function(J,Y){if(Y)$(Y);else try{localStorage.setItem(H.keyPrefix+g,J),U(w)}catch(ee){(ee.name==="QuotaExceededError"||ee.name==="NS_ERROR_DOM_QUOTA_REACHED")&&$(ee),$(ee)}})})});return h(I,x),I}function tr(g,b){if(b=S.apply(this,arguments),g=typeof g!="function"&&g||{},!g.name){var x=this.config();g.name=g.name||x.name,g.storeName=g.storeName||x.storeName}var _=this,I;return g.name?I=new p(function(w){g.storeName?w(_e(g,_._defaultConfig)):w(g.name+"/")}).then(function(w){for(var U=localStorage.length-1;U>=0;U--){var $=localStorage.key(U);$.indexOf(w)===0&&localStorage.removeItem($)}}):I=p.reject("Invalid arguments"),h(I,b),I}var nr={_driver:"localStorageWrapper",_initStorage:de,_support:ye(),iterate:Ot,getItem:Jt,setItem:er,removeItem:Zo,clear:Ht,length:Qo,key:Ko,keys:Xo,dropInstance:tr},sr=function(b,x){return b===x||typeof b=="number"&&typeof x=="number"&&isNaN(b)&&isNaN(x)},or=function(b,x){for(var _=b.length,I=0;I<_;){if(sr(b[I],x))return!0;I++}return!1},Vn=Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"},Tt={},Bn={},nt={INDEXEDDB:ut,WEBSQL:X,LOCALSTORAGE:nr},rr=[nt.INDEXEDDB._driver,nt.WEBSQL._driver,nt.LOCALSTORAGE._driver],Yt=["dropInstance"],fn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Yt),ir={description:"",driver:rr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ar(g,b){g[b]=function(){var x=arguments;return g.ready().then(function(){return g[b].apply(g,x)})}}function mn(){for(var g=1;g<arguments.length;g++){var b=arguments[g];if(b)for(var x in b)b.hasOwnProperty(x)&&(Vn(b[x])?arguments[0][x]=b[x].slice():arguments[0][x]=b[x])}return arguments[0]}var lr=function(){function g(b){c(this,g);for(var x in nt)if(nt.hasOwnProperty(x)){var _=nt[x],I=_._driver;this[x]=I,Tt[I]||this.defineDriver(_)}this._defaultConfig=mn({},ir),this._config=mn({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return g.prototype.config=function(x){if((typeof x>"u"?"undefined":l(x))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var _ in x){if(_==="storeName"&&(x[_]=x[_].replace(/\W/g,"_")),_==="version"&&typeof x[_]!="number")return new Error("Database version must be a number.");this._config[_]=x[_]}return"driver"in x&&x.driver?this.setDriver(this._config.driver):!0}else return typeof x=="string"?this._config[x]:this._config},g.prototype.defineDriver=function(x,_,I){var w=new p(function(U,$){try{var H=x._driver,J=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!x._driver){$(J);return}for(var Y=fn.concat("_initStorage"),ee=0,oe=Y.length;ee<oe;ee++){var ue=Y[ee],fe=!or(Yt,ue);if((fe||x[ue])&&typeof x[ue]!="function"){$(J);return}}var Ne=function(){for(var Nt=function(ur){return function(){var fr=new Error("Method "+ur+" is not implemented by the current driver"),qn=p.reject(fr);return h(qn,arguments[arguments.length-1]),qn}},pn=0,dr=Yt.length;pn<dr;pn++){var hn=Yt[pn];x[hn]||(x[hn]=Nt(hn))}};Ne();var Te=function(Nt){Tt[H]&&console.info("Redefining LocalForage driver: "+H),Tt[H]=x,Bn[H]=Nt,U()};"_support"in x?x._support&&typeof x._support=="function"?x._support().then(Te,$):Te(!!x._support):Te(!0)}catch(Se){$(Se)}});return y(w,_,I),w},g.prototype.driver=function(){return this._driver||null},g.prototype.getDriver=function(x,_,I){var w=Tt[x]?p.resolve(Tt[x]):p.reject(new Error("Driver not found."));return y(w,_,I),w},g.prototype.getSerializer=function(x){var _=p.resolve(et);return y(_,x),_},g.prototype.ready=function(x){var _=this,I=_._driverSet.then(function(){return _._ready===null&&(_._ready=_._initDriver()),_._ready});return y(I,x,x),I},g.prototype.setDriver=function(x,_,I){var w=this;Vn(x)||(x=[x]);var U=this._getSupportedDrivers(x);function $(){w._config.driver=w.driver()}function H(ee){return w._extend(ee),$(),w._ready=w._initStorage(w._config),w._ready}function J(ee){return function(){var oe=0;function ue(){for(;oe<ee.length;){var fe=ee[oe];return oe++,w._dbInfo=null,w._ready=null,w.getDriver(fe).then(H).catch(ue)}$();var Ne=new Error("No available storage method found.");return w._driverSet=p.reject(Ne),w._driverSet}return ue()}}var Y=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=Y.then(function(){var ee=U[0];return w._dbInfo=null,w._ready=null,w.getDriver(ee).then(function(oe){w._driver=oe._driver,$(),w._wrapLibraryMethodsWithReady(),w._initDriver=J(U)})}).catch(function(){$();var ee=new Error("No available storage method found.");return w._driverSet=p.reject(ee),w._driverSet}),y(this._driverSet,_,I),this._driverSet},g.prototype.supports=function(x){return!!Bn[x]},g.prototype._extend=function(x){mn(this,x)},g.prototype._getSupportedDrivers=function(x){for(var _=[],I=0,w=x.length;I<w;I++){var U=x[I];this.supports(U)&&_.push(U)}return _},g.prototype._wrapLibraryMethodsWithReady=function(){for(var x=0,_=fn.length;x<_;x++)ar(this,fn[x])},g.prototype.createInstance=function(x){return new g(x)},g}(),cr=new lr;s.exports=cr},{3:3}]},{},[4])(4)})})(Yo);var Eu=Yo.exports;const Pn=pr(Eu);Pn.config({driver:Pn.INDEXEDDB,name:"MASROF",version:1,storeName:"financial_data",description:"ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©"});const _u=async t=>{try{if(!Be().hasFirebase)throw new Error("Ù…ÙØ§ØªÙŠØ­ Firebase ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©");const n=await Ee.getCurrentUser();if(!n)throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©");const s=new Date().toISOString(),i={...t,userId:n.uid,backupTimestamp:s,appVersion:be.app.version,version:"1.0.0"},l=`${n.uid}_${Date.now()}`,c=await Ee.saveData("backups",l,i);if(!c.success)throw new Error(c.error||"ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©");return console.log("â˜ï¸ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"),!0}catch(e){return console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©:",e),!1}},Su=async()=>{try{if(console.log("ðŸ”„ Ø¨Ø¯Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©..."),!Be().hasFirebase)throw new Error("Ù…ÙØ§ØªÙŠØ­ Firebase ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©");const e=await Ee.getCurrentUser();if(!e)throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©");const n=await Ee.getAllDocuments("backups");if(!n.success||!Array.isArray(n.data)||n.data.length===0)throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©");const s=n.data.filter(u=>!u.userId||u.userId===e.uid);if(s.length===0)throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…");const i=u=>{const m=u.backupTimestamp||u.backupDate||u.lastUpdated,p=Date.parse(m||"");return Number.isFinite(p)?p:0},l=s.reduce((u,m)=>i(m)>i(u)?m:u),c=["transactions","categories","cards","bankAccounts","installments","loans","investments","settings"],d={};for(const u of c)l[u]!=null&&(d[u]=l[u]);d.transactions=d.transactions||[],d.categories=d.categories||[],d.cards=d.cards||{},d.bankAccounts=d.bankAccounts||{},d.installments=d.installments||[],d.loans=d.loans||{},d.investments=d.investments||{currentValue:0},d.settings=d.settings||{darkMode:!1,language:"ar",notifications:!0};try{const u=JSON.stringify(d);localStorage.setItem("financial_dashboard_state",u),localStorage.setItem("financial_dashboard_backup_1",u),localStorage.setItem("financial_dashboard_backup_2",u);const m=new Date().toISOString().split("T")[0];localStorage.setItem(`financial_dashboard_${m}`,u)}catch(u){console.warn("âš ï¸ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ÙØ¸ ÙÙŠ localStorage:",u)}const f=await Ee.saveData("users",e.uid,d);return f.success||console.warn("âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø¯Ø© ÙÙŠ Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",f.error),console.log("âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ÙˆØ­ÙØ¸Ù‡Ø§ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆÙ„Ù„Ù…Ø³ØªØ®Ø¯Ù…"),{success:!0,message:"ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙˆØ­ÙØ¸Ù‡Ø§ Ø¨Ù†Ø¬Ø§Ø­",timestamp:l.backupTimestamp||l.backupDate||l.lastUpdated||null}}catch(t){return console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©:",t),{success:!1,message:t.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"}}},Au=async()=>{try{let t=null;try{const l=localStorage.getItem("financial_dashboard_state");l&&(t=JSON.parse(l))}catch{}if(!t){t={};const l=["transactions","categories","cards","bankAccounts","installments","loans","investments","settings"];for(const c of l){const d=await Pn.getItem(c);d&&(t[c]=d)}}const e={...t||{},backupTimestamp:new Date().toISOString(),version:"1.0.0",appVersion:be.app.version},n=JSON.stringify(e,null,2),s=new Blob([n],{type:"application/json"}),i=document.createElement("a");return i.href=URL.createObjectURL(s),i.download=`masrof-backup-${new Date().toISOString().split("T")[0]}.json`,i.click(),console.log("ðŸ’¾ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©"),!0}catch(t){return console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:",t),!1}},Iu=t=>new Promise((e,n)=>{const s=new FileReader;s.onload=async i=>{try{const l=JSON.parse(i.target.result);if(!(l&&(l.version||l.backupTimestamp)))throw new Error("Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­");const c=["transactions","categories","cards","bankAccounts","installments","loans","investments","settings"],d={};for(const f of c)l[f]!=null&&(d[f]=l[f]);d.transactions=d.transactions||[],d.categories=d.categories||[],d.cards=d.cards||{},d.bankAccounts=d.bankAccounts||{},d.installments=d.installments||[],d.loans=d.loans||{},d.investments=d.investments||{currentValue:0},d.settings=d.settings||{darkMode:!1,language:"ar",notifications:!0};try{const f=JSON.stringify(d);localStorage.setItem("financial_dashboard_state",f),localStorage.setItem("financial_dashboard_backup_1",f),localStorage.setItem("financial_dashboard_backup_2",f);const u=new Date().toISOString().split("T")[0];localStorage.setItem(`financial_dashboard_${u}`,f)}catch(f){console.warn("âš ï¸ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ÙØ¸ ÙÙŠ localStorage:",f)}try{const f=await Ee.getCurrentUser();if(f){const u=await Ee.saveData("users",f.uid,d);u.success||console.warn("âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø¯Ø© ÙÙŠ Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù…Ù„Ù:",u.error)}}catch(f){console.warn("âš ï¸ ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",f)}console.log("âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù ÙˆØ­ÙØ¸Ù‡Ø§ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆÙ„Ù„Ù…Ø³ØªØ®Ø¯Ù…"),e({success:!0,message:"ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­",timestamp:l.backupTimestamp||null})}catch(l){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ù„Ù:",l),n({success:!1,message:l.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù"})}},s.onerror=()=>{n({success:!1,message:"Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù"})},s.readAsText(t)}),ao=({onSuccess:t,onClose:e,hideCloseButton:n=!1,darkMode:s=!1,language:i="ar"})=>{const[l,c]=V.useState(!0),[d,f]=V.useState({email:"",password:"",displayName:""}),[u,m]=V.useState(!1),[p,h]=V.useState(""),y=async S=>{S.preventDefault(),m(!0),h("");try{let R;if(l)R=await Ee.signIn(d.email,d.password);else{if(!d.displayName.trim()){h("Ø§Ù„Ø§Ø³Ù… Ù…Ø·Ù„ÙˆØ¨"),m(!1);return}R=await Ee.signUp(d.email,d.password,d.displayName)}R.success?t(R.user):h(R.error||"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹")}catch{h("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„")}finally{m(!1)}},E=S=>{f(R=>({...R,[S.target.name]:S.target.value}))};return o.jsx("div",{className:`${n?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:n?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:l?"ðŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„":"ðŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯"}),!n&&o.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"âœ•"})]}),o.jsxs("form",{onSubmit:y,className:"space-y-4",children:[!l&&o.jsxs("div",{children:[o.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"}),o.jsx("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„",required:!l})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"}),o.jsx("input",{type:"email",id:"email",name:"email",value:d.email,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"}),o.jsx("input",{type:"password",id:"password",name:"password",value:d.password,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",required:!0,minLength:6})]}),p&&o.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-600 text-sm",children:p})}),o.jsx("button",{type:"submit",disabled:u,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:u?"â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...":l?"ðŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„":"ðŸ“ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx("button",{onClick:()=>c(!l),className:"text-blue-600 hover:text-blue-700 font-medium",children:l?"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯":"Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"})})]})})})},Wo=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),o.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),at=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[o.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),o.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),Ru=()=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[o.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),o.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),Pu=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${t}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),Mu=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${t}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),ku=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${t}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),Du=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${t}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),Lu=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${t}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),St=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${t}`,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),xn=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${t}`,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),yn=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${t}`,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Fu=({className:t})=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${t}`,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Uu={ar:{"app.title":"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ© | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ©",logout:"Ø®Ø±ÙˆØ¬","dark.mode":"Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…",notifications:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª","enable.notifications":"ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",language:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©","tab.summary":"Ø§Ù„Ù…Ù„Ø®Øµ","tab.analysis":"Ø§Ù„ØªØ­Ù„ÙŠÙ„","tab.transactions":"Ø§Ù„Ø­Ø±ÙƒØ§Øª","tab.budget":"Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©","tab.investment":"Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±","tab.ai.assistant":"Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø°ÙƒÙŠ","tab.settings":"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª","tab.cards":"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª","tab.bank":"Ø§Ù„Ø¨Ù†Ùƒ","tab.installments":"Ø§Ù„Ø£Ù‚Ø³Ø§Ø·","tab.debts.loans":"Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ù‚Ø±ÙˆØ¶","card.debts.summary":"Ù…Ù„Ø®Øµ Ø¯ÙŠÙˆÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª","card.bank.accounts":"Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©","card.financial.report":"ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ Ø´Ø§Ù…Ù„","card.categories.summary":"Ù…Ù„Ø®Øµ Ø§Ù„ÙØ¦Ø§Øª",due:"Ø§Ù„Ù…Ø³ØªØ­Ù‚",remaining:"Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ","total.debts":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†","total.available":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ§Ø­",deposits:"Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª",withdrawals:"Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª","total.bank.balances":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±ØµØ¯Ø© Ø§Ù„Ø¨Ù†ÙƒÙŠØ©","total.income":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„","total.expenses":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ",net:"Ø§Ù„ØµØ§ÙÙŠ",rent:"Ø¥ÙŠØ¬Ø§Ø±",groceries:"Ù…ÙˆØ§Ø¯ ØªÙ…ÙˆÙŠÙ†ÙŠØ©",shopping:"ØªØ³ÙˆÙ‚",bills:"Ø³Ø¯Ø§Ø¯ ÙÙˆØ§ØªÙŠØ±",restaurants:"Ù…Ø·Ø§Ø¹Ù…",transport:"Ù…ÙˆØ§ØµÙ„Ø§Øª",entertainment:"ØªØ±ÙÙŠÙ‡",health:"ØµØ­Ø©",education:"ØªØ¹Ù„ÙŠÙ…",other:"Ø£Ø®Ø±Ù‰","al.ahli.snb":"Ø§Ù„Ø£Ù‡Ù„ÙŠ SNB","emirates.enbd":"Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª ENBD","al.ahli.bank":"Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø§Ù‡Ù„ÙŠ","arab.bank":"Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø¹Ø±Ø¨ÙŠ",add:"Ø¥Ø¶Ø§ÙØ©",edit:"ØªØ¹Ø¯ÙŠÙ„",delete:"Ø­Ø°Ù",save:"Ø­ÙØ¸",cancel:"Ø¥Ù„ØºØ§Ø¡",confirm:"ØªØ£ÙƒÙŠØ¯",close:"Ø¥ØºÙ„Ø§Ù‚",search:"Ø¨Ø­Ø«",filter:"ØªØµÙÙŠØ©",export:"ØªØµØ¯ÙŠØ±",import:"Ø§Ø³ØªÙŠØ±Ø§Ø¯",active:"Ù†Ø´Ø·",inactive:"ØºÙŠØ± Ù†Ø´Ø·",pending:"Ù…Ø¹Ù„Ù‚",completed:"Ù…ÙƒØªÙ…Ù„",cancelled:"Ù…Ù„ØºÙŠ",january:"ÙŠÙ†Ø§ÙŠØ±",february:"ÙØ¨Ø±Ø§ÙŠØ±",march:"Ù…Ø§Ø±Ø³",april:"Ø£Ø¨Ø±ÙŠÙ„",may:"Ù…Ø§ÙŠÙˆ",june:"ÙŠÙˆÙ†ÙŠÙˆ",july:"ÙŠÙˆÙ„ÙŠÙˆ",august:"Ø£ØºØ³Ø·Ø³",september:"Ø³Ø¨ØªÙ…Ø¨Ø±",october:"Ø£ÙƒØªÙˆØ¨Ø±",november:"Ù†ÙˆÙÙ…Ø¨Ø±",december:"Ø¯ÙŠØ³Ù…Ø¨Ø±",sunday:"Ø§Ù„Ø£Ø­Ø¯",monday:"Ø§Ù„Ø§Ø«Ù†ÙŠÙ†",tuesday:"Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡",wednesday:"Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡",thursday:"Ø§Ù„Ø®Ù…ÙŠØ³",friday:"Ø§Ù„Ø¬Ù…Ø¹Ø©",saturday:"Ø§Ù„Ø³Ø¨Øª",sar:"Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ",usd:"Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ",eur:"ÙŠÙˆØ±Ùˆ",aed:"Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ",today:"Ø§Ù„ÙŠÙˆÙ…",yesterday:"Ø£Ù…Ø³","this.week":"Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹","this.month":"Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±","this.year":"Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…","last.week":"Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¶ÙŠ","last.month":"Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ","last.year":"Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ù…Ø§Ø¶ÙŠ",success:"Ù†Ø¬Ø­",error:"Ø®Ø·Ø£",warning:"ØªØ­Ø°ÙŠØ±",info:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",loading:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...","no.data":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª","try.again":"Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰","required.field":"Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨","invalid.email":"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­","invalid.amount":"Ø§Ù„Ù…Ø¨Ù„Øº ØºÙŠØ± ØµØ­ÙŠØ­","invalid.date":"Ø§Ù„ØªØ§Ø±ÙŠØ® ØºÙŠØ± ØµØ­ÙŠØ­","debt.to.me":"Ø¯ÙŠÙˆÙ† Ù„ÙŠ","debt.from.me":"Ø¯ÙŠÙˆÙ† Ø¹Ù„ÙŠ",loans:"Ù‚Ø±ÙˆØ¶","add.debt":"Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ†","add.loan":"Ø¥Ø¶Ø§ÙØ© Ù‚Ø±Ø¶",debtor:"Ø§Ù„Ù…Ø¯ÙŠÙ†",creditor:"Ø§Ù„Ø¯Ø§Ø¦Ù†",lender:"Ø§Ù„Ù…Ù‚Ø±Ø¶",amount:"Ø§Ù„Ù…Ø¨Ù„Øº",description:"Ø§Ù„ÙˆØµÙ",date:"Ø§Ù„ØªØ§Ø±ÙŠØ®",status:"Ø§Ù„Ø­Ø§Ù„Ø©",source:"Ø§Ù„Ù…ØµØ¯Ø±",reason:"Ø§Ù„Ø³Ø¨Ø¨",installments:"Ø£Ù‚Ø³Ø§Ø·","paid.installments":"Ø£Ù‚Ø³Ø§Ø· Ù…Ø¯ÙÙˆØ¹Ø©","remaining.installments":"Ø£Ù‚Ø³Ø§Ø· Ù…ØªØ¨Ù‚ÙŠØ©","next.payment":"Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©","payment.date":"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹","installment.amount":"Ù…Ø¨Ù„Øº Ø§Ù„Ù‚Ø³Ø·","total.amount":"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",investment:"Ø§Ø³ØªØ«Ù…Ø§Ø±","current.value":"Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©","initial.investment":"Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ÙŠ","profit.loss":"Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©","return.rate":"Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ø¦Ø¯",budget:"Ù…ÙŠØ²Ø§Ù†ÙŠØ©","budget.limit":"Ø­Ø¯ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©",spent:"Ù…ØµØ±ÙˆÙ","remaining.budget":"Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©","over.budget":"ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©",reports:"ØªÙ‚Ø§Ø±ÙŠØ±","financial.report":"ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ","monthly.report":"ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ","yearly.report":"ØªÙ‚Ø±ÙŠØ± Ø³Ù†ÙˆÙŠ","category.report":"ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙØ¦Ø§Øª","income.report":"ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¯Ø®Ù„","expense.report":"ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª",settings:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",profile:"Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",account:"Ø§Ù„Ø­Ø³Ø§Ø¨",privacy:"Ø§Ù„Ø®ØµÙˆØµÙŠØ©",security:"Ø§Ù„Ø£Ù…Ø§Ù†",backup:"Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ",restore:"Ø§Ø³ØªØ¹Ø§Ø¯Ø©","export.data":"ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","import.data":"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","ai.assistant":"Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ","ask.question":"Ø§Ø³Ø£Ù„ Ø³Ø¤Ø§Ù„","get.advice":"Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù†ØµÙŠØ­Ø©","analyze.data":"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","generate.report":"ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ±",notification:"Ø¥Ø´Ø¹Ø§Ø±","payment.reminder":"ØªØ°ÙƒÙŠØ± Ø¯ÙØ¹","budget.alert":"ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©","low.balance":"Ø±ØµÙŠØ¯ Ù…Ù†Ø®ÙØ¶","payment.due":"Ø¯ÙØ¹Ø© Ù…Ø³ØªØ­Ù‚Ø©","network.error":"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©","server.error":"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…","auth.error":"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©","permission.error":"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©","validation.error":"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚","unknown.error":"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",details:"Ø§Ù„ØªÙØ§ØµÙŠÙ„","cannot.delete":"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù","cannot.delete.category":"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø© Ù„Ø£Ù†Ù‡Ø§ Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª","cannot.delete.transaction.type":"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ© Ù‡Ø°Ø§ Ù„Ø£Ù†Ù‡ Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª","cannot.delete.payment.method":"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹ Ù‡Ø°Ù‡ Ù„Ø£Ù†Ù‡Ø§ Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª","restore.backup":"Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©","confirm.restore":"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ Ø³ÙŠØªÙ… Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙˆÙ‚ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©","api.status":"Ø­Ø§Ù„Ø© Ù…ÙØ§ØªÙŠØ­ API"},en:{"app.title":"Financial Dashboard | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Add Transaction",logout:"Logout","dark.mode":"Dark Mode",notifications:"Notifications","enable.notifications":"Enable Notifications",language:"English","tab.summary":"Summary","tab.analysis":"Analysis","tab.transactions":"Transactions","tab.budget":"Budget","tab.investment":"Investment","tab.ai.assistant":"AI Assistant","tab.settings":"Settings","tab.cards":"Card Management","tab.bank":"Bank","tab.installments":"Installments","tab.debts.loans":"Debts & Loans","card.debts.summary":"Card Debts Summary","card.bank.accounts":"Bank Accounts Summary","card.financial.report":"Comprehensive Financial Report","card.categories.summary":"Categories Summary",due:"Due",remaining:"Remaining","total.debts":"Total Debts","total.available":"Total Available",deposits:"Deposits",withdrawals:"Withdrawals","total.bank.balances":"Total Bank Balances","total.income":"Total Income","total.expenses":"Total Expenses",net:"Net",rent:"Rent",groceries:"Groceries",shopping:"Shopping",bills:"Bill Payments",restaurants:"Restaurants",transport:"Transport",entertainment:"Entertainment",health:"Health",education:"Education",other:"Other","al.ahli.snb":"Al Ahli SNB","emirates.enbd":"Emirates ENBD","al.ahli.bank":"Al Ahli Bank","arab.bank":"Arab Bank",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",cancelled:"Cancelled",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sar:"Saudi Riyal",usd:"US Dollar",eur:"Euro",aed:"UAE Dirham",today:"Today",yesterday:"Yesterday","this.week":"This Week","this.month":"This Month","this.year":"This Year","last.week":"Last Week","last.month":"Last Month","last.year":"Last Year",success:"Success",error:"Error",warning:"Warning",info:"Info",loading:"Loading...","no.data":"No Data","try.again":"Try Again","required.field":"This field is required","invalid.email":"Invalid email address","invalid.amount":"Invalid amount","invalid.date":"Invalid date","debt.to.me":"Debts to Me","debt.from.me":"Debts from Me",loans:"Loans","add.debt":"Add Debt","add.loan":"Add Loan",debtor:"Debtor",creditor:"Creditor",lender:"Lender",amount:"Amount",description:"Description",date:"Date",status:"Status",source:"Source",reason:"Reason",installments:"Installments","paid.installments":"Paid Installments","remaining.installments":"Remaining Installments","next.payment":"Next Payment","payment.date":"Payment Date","installment.amount":"Installment Amount","total.amount":"Total Amount",investment:"Investment","current.value":"Current Value","initial.investment":"Initial Investment","profit.loss":"Profit/Loss","return.rate":"Return Rate",budget:"Budget","budget.limit":"Budget Limit",spent:"Spent","remaining.budget":"Remaining Budget","over.budget":"Over Budget",reports:"Reports","financial.report":"Financial Report","monthly.report":"Monthly Report","yearly.report":"Yearly Report","category.report":"Category Report","income.report":"Income Report","expense.report":"Expense Report",settings:"Settings",profile:"Profile",account:"Account",privacy:"Privacy",security:"Security",backup:"Backup",restore:"Restore","export.data":"Export Data","import.data":"Import Data","ai.assistant":"AI Assistant","ask.question":"Ask Question","get.advice":"Get Advice","analyze.data":"Analyze Data","generate.report":"Generate Report",notification:"Notification","payment.reminder":"Payment Reminder","budget.alert":"Budget Alert","low.balance":"Low Balance","payment.due":"Payment Due","network.error":"Network Error","server.error":"Server Error","auth.error":"Authentication Error","permission.error":"Permission Error","validation.error":"Validation Error","unknown.error":"Unknown Error",details:"Details","cannot.delete":"Cannot Delete","cannot.delete.category":"Cannot delete this category as it is used in some transactions","cannot.delete.transaction.type":"Cannot delete this transaction type as it is used in some transactions","cannot.delete.payment.method":"Cannot delete this payment method as it is used in some transactions","restore.backup":"Restore Backup","confirm.restore":"Are you sure? This will overwrite all your current data","api.status":"API Keys Status"}},B=(t,e="ar")=>Uu[e][t]||t,ju=({selectedYear:t,selectedMonth:e,onYearChange:n,onMonthChange:s,onAddTransaction:i,currentUser:l,onSignOut:c,language:d="ar",darkMode:f=!1,notifications:u=!1,onToggleDarkMode:m,onToggleNotifications:p,onToggleLanguage:h})=>{const[y,E]=V.useState(!1),S=V.useRef(null),R=V.useMemo(()=>{const k=new Date().getFullYear(),C=[];for(let T=k+1;T>=2020;T--)C.push(T);return C},[]),P=V.useMemo(()=>[{value:"all",label:"ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±"},{value:1,label:"ÙŠÙ†Ø§ÙŠØ±"},{value:2,label:"ÙØ¨Ø±Ø§ÙŠØ±"},{value:3,label:"Ù…Ø§Ø±Ø³"},{value:4,label:"Ø£Ø¨Ø±ÙŠÙ„"},{value:5,label:"Ù…Ø§ÙŠÙˆ"},{value:6,label:"ÙŠÙˆÙ†ÙŠÙˆ"},{value:7,label:"ÙŠÙˆÙ„ÙŠÙˆ"},{value:8,label:"Ø£ØºØ³Ø·Ø³"},{value:9,label:"Ø³Ø¨ØªÙ…Ø¨Ø±"},{value:10,label:"Ø£ÙƒØªÙˆØ¨Ø±"},{value:11,label:"Ù†ÙˆÙÙ…Ø¨Ø±"},{value:12,label:"Ø¯ÙŠØ³Ù…Ø¨Ø±"}],[]);V.useEffect(()=>{const k=C=>{S.current&&!S.current.contains(C.target)&&E(!1)};return document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[]);const F=()=>l.displayName?l.displayName:l.email?l.email.split("@")[0]:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";return o.jsx("header",{className:"bg-slate-50/95 dark:bg-slate-800/95 backdrop-blur-lg border-b border-slate-200 dark:border-slate-700 py-3 shadow-sm relative z-30",children:o.jsx("div",{className:"container mx-auto px-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"ðŸ’°"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 tracking-wide",children:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©"}),o.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Developed by K.A Team"})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 dark:bg-slate-700 p-1.5 rounded-lg",children:[o.jsx("select",{value:t,onChange:k=>n(parseInt(k.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:R.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsx("select",{value:e,onChange:k=>s(k.target.value==="all"?"all":parseInt(k.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:P.map(k=>o.jsx("option",{value:k.value,children:k.label},k.value))})]}),o.jsxs("div",{className:"relative",ref:S,children:[o.jsxs("button",{onClick:()=>E(!y),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:[o.jsx("div",{className:"text-right",children:o.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200 text-sm",children:F()})}),o.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),o.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),y&&o.jsxs("div",{className:"absolute left-0 top-full mt-2 w-64 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-slate-200 dark:border-slate-700 py-2 z-[9999]",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700",children:[o.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200 text-sm",children:F()}),o.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.email})]}),o.jsxs("button",{onClick:()=>{m==null||m(),E(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-lg",children:f?"ðŸŒ™":"â˜€ï¸"}),o.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:B("dark.mode",d)})]}),o.jsx("div",{className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${f?"bg-blue-600":"bg-slate-200"}`,children:o.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${f?"translate-x-5":"translate-x-1"}`})})]}),o.jsxs("button",{onClick:()=>{p==null||p(),E(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-lg",children:u?"ðŸ””":"ðŸ”•"}),o.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:B("notifications",d)})]}),o.jsx("div",{className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${u?"bg-blue-600":"bg-slate-200"}`,children:o.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${u?"translate-x-5":"translate-x-1"}`})})]}),o.jsxs("button",{onClick:()=>{h==null||h(),E(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-lg",children:"ðŸŒ"}),o.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:B("language",d)})]}),o.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${f?"bg-blue-500":"bg-blue-600"}`,children:o.jsx("span",{className:"text-white font-bold text-xs",children:d==="ar"?"A":"E"})})]}),o.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 my-2"}),o.jsxs("button",{onClick:()=>{c(),E(!1)},className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-red-600 dark:text-red-400",children:[o.jsx("span",{className:"text-lg",children:"ðŸšª"}),o.jsx("span",{className:"text-sm font-medium",children:"Ø®Ø±ÙˆØ¬"})]})]})]}),o.jsxs("button",{onClick:i,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[o.jsx(Lu,{className:"w-5 h-5"}),o.jsx("span",{children:B("add.transaction",d)})]})]})]})})})},Vu=(t="ar")=>[{id:"summary",label:`ðŸ“Š ${B("tab.summary",t)}`,icon:Pu},{id:"analysis",label:`ðŸ“ˆ ${B("tab.analysis",t)}`,icon:Mu},{id:"transactions",label:`ðŸ’³ ${B("tab.transactions",t)}`,icon:ku},{id:"budget",label:`âœ¨ ${B("tab.budget",t)}`},{id:"investment",label:`ðŸ’¹ ${B("tab.investment",t)}`},{id:"ai-assistant",label:`ðŸ¤– ${B("tab.ai.assistant",t)}`},{id:"cards",label:`ðŸ’³ ${B("tab.cards",t)}`},{id:"bank",label:`ðŸ¦ ${B("tab.bank",t)}`},{id:"installments",label:`ðŸ“± ${B("tab.installments",t)}`},{id:"debts-loans",label:`ðŸ“Š ${B("tab.debts.loans",t)}`},{id:"settings",label:`âš™ï¸ ${B("tab.settings",t)}`}],lo=["summary","analysis","transactions"],Bu=({activeTab:t,setActiveTab:e,language:n="ar"})=>{const[s,i]=V.useState(!1),l=Vu(n),c=u=>{e(u),i(!1)},d=l.filter(u=>lo.includes(u.id)),f=l.filter(u=>!lo.includes(u.id));return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:l.map(u=>o.jsx("button",{onClick:()=>c(u.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${t===u.id?"active":""}`,children:u.label},u.id))}),o.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[d.map(u=>{const m=u.icon;return o.jsxs("button",{onClick:()=>c(u.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${t===u.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[m&&o.jsx(m,{}),o.jsx("span",{className:"text-xs",children:u.label.split(" ")[1]})]},u.id)}),o.jsxs("button",{onClick:()=>i(!s),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${s?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[o.jsx(Du,{}),o.jsx("span",{className:"text-xs",children:"Ø§Ù„Ù…Ø²ÙŠØ¯"})]})]}),s&&o.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>i(!1),children:o.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:u=>u.stopPropagation(),children:[o.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),o.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:f.map(u=>o.jsxs("button",{onClick:()=>c(u.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${t===u.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[o.jsx("span",{className:"text-2xl",children:u.label.split(" ")[0]}),o.jsx("span",{className:"text-xs font-semibold",children:u.label.split(" ")[1]})]},u.id))})]})})]})},qu=({className:t,darkMode:e=!1})=>o.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-${e?"slate-700/80":"slate-200/80"} to-transparent ${t}`}),vn=({darkMode:t=!1})=>o.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[o.jsx("div",{className:`h-6 w-1/2 rounded mb-6 ${t?"bg-slate-700":"bg-slate-200"}`}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:`h-4 w-full rounded ${t?"bg-slate-700":"bg-slate-200"}`}),o.jsx("div",{className:`h-4 w-5/6 rounded ${t?"bg-slate-700":"bg-slate-200"}`}),o.jsx("div",{className:`h-4 w-full rounded ${t?"bg-slate-700":"bg-slate-200"}`}),o.jsx("div",{className:`h-4 w-3/4 rounded ${t?"bg-slate-700":"bg-slate-200"}`})]}),o.jsx(qu,{darkMode:t})]}),$u=({darkMode:t=!1})=>o.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[o.jsx("div",{className:"h-16 mb-3"}),o.jsx("div",{className:`flex flex-wrap justify-center mb-8 rounded-xl p-2 h-14 ${t?"bg-slate-700":"bg-slate-100"}`}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[o.jsx(vn,{}),o.jsx(vn,{}),o.jsx(vn,{})]})]}),se=t=>(t||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),Gu=({title:t,details:e,barColor:n,darkMode:s=!1,language:i="ar"})=>o.jsxs("div",{className:`p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between ${s?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h4",{className:`font-bold text-sm ${s?"text-slate-200":"text-slate-800"}`,children:t}),o.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-sm",children:"ðŸ’³"})})]}),o.jsxs("div",{className:`p-2 rounded-lg border ${s?"bg-slate-700 border-slate-600":"bg-slate-50 border-gray-200"}`,children:[o.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[o.jsxs("span",{className:s?"text-slate-400":"text-slate-600",children:[B("due",i),":"]}),o.jsx("span",{className:`font-semibold number-display text-xs ${s?"text-slate-200":"text-slate-900"}`,children:se(e.balance)})]}),o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsxs("span",{className:s?"text-slate-400":"text-slate-600",children:[B("remaining",i),":"]}),o.jsx("span",{className:`font-semibold number-display text-xs ${s?"text-slate-200":"text-emerald-700"}`,children:se(e.available)})]})]}),o.jsx("div",{className:`rounded-full h-1.5 overflow-hidden ${s?"bg-slate-600":"bg-slate-200"}`,children:o.jsx("div",{className:`${n} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),Hu=({calculations:t,categories:e,darkMode:n=!1,language:s="ar",onNavigateToTransactions:i})=>{const l=Object.values(t.expensesByCategory).reduce((d,f)=>d+Number(f),0);if(l===0)return o.jsx("p",{className:`text-center p-4 text-sm ${n?"text-slate-400":"text-slate-500"}`,children:B("no.data",s)});const c=Object.entries(t.expensesByCategory).sort(([,d],[,f])=>f-d);return o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-96 overflow-y-auto pr-2",children:c.map(([d,f])=>{const u=e.find(p=>p.id===d);u?`${u.icon}${u.name}`:B("other",s);const m=Number(f)/l*100;return o.jsxs("button",{className:`group relative w-full p-4 rounded-2xl border shadow-sm hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:scale-[1.02] active:scale-[0.98] ${n?"bg-gradient-to-br from-slate-800 to-slate-900 border-slate-700 hover:from-slate-700 hover:to-slate-800 hover:border-slate-600":"bg-gradient-to-br from-white to-gray-50 border-gray-200 hover:from-gray-50 hover:to-gray-100 hover:border-gray-300"}`,onClick:()=>i==null?void 0:i(d),children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[o.jsx("div",{className:`w-12 h-12 sm:w-10 sm:h-10 rounded-xl flex items-center justify-center text-lg shadow-md ${n?"bg-slate-700 group-hover:bg-slate-600":"bg-blue-100 group-hover:bg-blue-200"}`,children:(u==null?void 0:u.icon)||"ðŸ“Š"}),o.jsxs("div",{className:"flex flex-col items-start flex-1 min-w-0",children:[o.jsx("span",{className:`font-semibold text-sm sm:text-xs truncate w-full ${n?"text-slate-200":"text-slate-800"}`,title:u==null?void 0:u.name,children:(u==null?void 0:u.name)||B("other",s)}),o.jsxs("span",{className:`text-xs ${n?"text-slate-400":"text-slate-500"}`,children:[m.toFixed(1),"%"]})]})]}),o.jsx("div",{className:`px-3 py-2 rounded-xl shadow-sm flex-shrink-0 ${n?"bg-slate-700 group-hover:bg-slate-600":"bg-blue-50 group-hover:bg-blue-100"}`,children:o.jsx("span",{className:`font-bold text-sm sm:text-xs number-display ${n?"text-slate-200":"text-slate-800"}`,children:se(f)})})]}),o.jsx("div",{className:`rounded-full h-2.5 overflow-hidden shadow-inner ${n?"bg-slate-600":"bg-gray-200"}`,children:o.jsx("div",{className:"bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-600 h-2.5 rounded-full transition-all duration-700 ease-out shadow-sm relative overflow-hidden",style:{width:`${m.toFixed(1)}%`},children:o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})})}),o.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:o.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${n?"bg-blue-600":"bg-blue-500"}`,children:o.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})})]},d)})})},Ju=({calculations:t,categories:e,state:n,darkMode:s=!1,language:i="ar",onNavigateToTransactions:l})=>{const{totalIncome:c,totalExpenses:d,cardPayments:f,bankAccountDetails:u,totalBankBalance:m}=t,p=c-d,h=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"],y=t.cardDetails,E=Object.values(y).reduce((P,F)=>P+F.balance,0),S=Object.values(y).reduce((P,F)=>P+F.available,0),R=Object.values(y).reduce((P,F)=>P+F.limit,0);return o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[o.jsxs("div",{className:"card-consistent xl:col-span-1",children:[o.jsxs("h3",{className:`font-semibold text-lg mb-4 ${s?"text-slate-200":"text-slate-800"}`,children:["ðŸ’³ ",B("card.debts.summary",i)]}),o.jsx("div",{className:"space-y-4",children:Object.values(y).map((P,F)=>o.jsx(Gu,{title:P.name,details:P,barColor:h[F%h.length],darkMode:s,language:i},P.id))}),o.jsx("div",{className:`mt-4 p-3 rounded-lg ${s?"bg-slate-700":"bg-slate-100"}`,children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[o.jsx("p",{className:`font-semibold text-xs mb-2 ${s?"text-red-400":"text-red-600"}`,children:B("total.debts",i)}),o.jsx("p",{className:`font-bold text-sm number-display ${s?"text-red-400":"text-red-600"}`,children:se(E)})]}),o.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[o.jsx("p",{className:`font-semibold text-xs mb-2 ${s?"text-emerald-400":"text-emerald-600"}`,children:B("total.available",i)}),o.jsx("p",{className:`font-bold text-sm number-display ${s?"text-emerald-400":"text-emerald-600"}`,children:se(S)})]}),o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[o.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¯ÙˆØ¯"}),o.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:se(R)})]})]})})]}),o.jsxs("div",{className:"card-consistent xl:col-span-1",children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"ðŸ¦ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©"}),o.jsx("div",{className:"space-y-3",children:Object.values(u).map(P=>{const F=P.balance>0?"bank-card-positive":P.balance<0?"bank-card-negative":"bank-card-neutral";return o.jsxs("div",{className:`card-consistent ${F} h-32 flex flex-col justify-between`,children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:P.name}),o.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-sm",children:"ðŸ›ï¸"})})]}),o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:se(P.balance)})}),o.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª"}),o.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",se(P.deposits)]})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª"}),o.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",se(P.withdrawals)]})]})]})]},P.id)})})]}),o.jsxs("div",{className:"card-consistent xl:col-span-1",children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"ðŸ“ˆ ØªÙ‚Ø±ÙŠØ± Ù…Ø§Ù„ÙŠ Ø´Ø§Ù…Ù„"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„:"}),o.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:se(c)})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ:"}),o.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:se(d)})]}),o.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(y).map((P,F)=>o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsxs("span",{className:"text-slate-500",children:["Ù…ØµØ§Ø±ÙŠÙ ",P.name,":"]}),o.jsx("span",{className:`font-semibold ${h[F%h.length].replace("bg-","text-")} number-display`,children:se(P.balance+(f[P.id]||0))})]},P.id)),o.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(f).map(([P,F])=>{var k;return o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsxs("span",{className:"text-slate-500",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø¯Ø§Ø¯ ",(k=y[P])==null?void 0:k.name,":"]}),o.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:se(F)})]},P)}),o.jsx("hr",{className:"my-2 border-slate-200"}),o.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[o.jsx("span",{children:"Ø§Ù„ØµØ§ÙÙŠ:"}),o.jsx("span",{className:`number-display ${p>=0?"text-emerald-500":"text-red-500"}`,children:se(p)})]})]})]}),o.jsxs("div",{className:"card-consistent xl:col-span-1",children:[o.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"ðŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„ÙØ¦Ø§Øª"}),o.jsx(Hu,{calculations:t,categories:e,onNavigateToTransactions:l})]})]})},Ou=({transactions:t,allTransactions:e,categories:n,deleteTransaction:s,editTransaction:i,state:l,darkMode:c=!1,language:d="ar",initialCategoryFilter:f})=>{const[u,m]=V.useState(""),[p,h]=V.useState(""),[y,E]=V.useState(f||""),[S,R]=V.useState(""),[P,F]=V.useState(""),k=A=>{const L={cash:"ðŸ’µ Ù†Ù‚Ø¯ÙŠ","tabby-bnpl":"ðŸ“± ØªØ§Ø¨ÙŠ (BNPL)","tamara-bnpl":"ðŸ“± ØªÙ…Ø§Ø±Ø§ (BNPL)"};return L[A]?L[A]:l.cards[A]?`ðŸ’³ ${l.cards[A].name}`:l.bankAccounts[A]?`ðŸ¦ ${l.bankAccounts[A].name}`:A},C=A=>{const L={income:"ðŸ’° Ø¯Ø®Ù„",expense:"ðŸ’¸ Ù…ØµØ§Ø±ÙŠÙ","bnpl-payment":"ðŸ“± Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·","investment-deposit":"ðŸ’¹ Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ","investment-withdrawal":"ðŸ’¹ Ø³Ø­Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"};if(L[A])return L[A];if(A.endsWith("-payment")){const D=A.replace("-payment","");if(l.cards[D])return`ðŸ’³ Ø³Ø¯Ø§Ø¯ ${l.cards[D].name}`}return A},T=V.useMemo(()=>{let A=t;if(S&&P){const L=new Date(S),D=new Date(P);D.setHours(23,59,59,999),A=t.filter(v=>{const j=new Date(v.date);return j>=L&&j<=D})}return A=A.filter(L=>{const D=u.toLowerCase(),v=n.find(he=>he.id===L.categoryId),j=L.description.toLowerCase().includes(D)||(v==null?void 0:v.name.toLowerCase().includes(D)),O=!p||L.paymentMethod===p,ne=!y||L.categoryId===y;return j&&O&&ne}),A.sort((L,D)=>{const v=new Date(L.date),O=new Date(D.date).getTime()-v.getTime();if(O===0){const ne=parseInt(L.id.replace("trans-","").split("-")[0]);return parseInt(D.id.replace("trans-","").split("-")[0])-ne}return O})},[t,u,p,y,S,P,n]),M=V.useMemo(()=>T.reduce((A,L)=>(L.type==="income"||L.type.toString().includes("payment")||L.type==="investment-withdrawal"?A.positive+=L.amount:A.negative+=L.amount,A),{positive:0,negative:0}),[T]);return o.jsx("div",{className:"space-y-6 animate-fade-in",children:o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"ðŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ù…Ù† ØªØ§Ø±ÙŠØ®"}),o.jsx("input",{type:"date",id:"dateFrom",value:S,onChange:A=>R(A.target.value),className:"w-full p-2"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®"}),o.jsx("input",{type:"date",id:"dateTo",value:P,onChange:A=>F(A.target.value),className:"w-full p-2"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹"}),o.jsxs("select",{id:"filterMethod",value:p,onChange:A=>h(A.target.value),className:"p-2 w-full",children:[o.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ù„"}),Object.values(l.bankAccounts).map(A=>o.jsxs("option",{value:A.id,children:["ðŸ¦ ",A.name]},A.id)),o.jsx("option",{value:"cash",children:"ðŸ’µ Ù†Ù‚Ø¯ÙŠ"}),Object.values(l.cards).map(A=>o.jsxs("option",{value:A.id,children:["ðŸ’³ ",A.name]},A.id)),o.jsx("option",{value:"tabby-bnpl",children:"ðŸ“± ØªØ§Ø¨ÙŠ"}),o.jsx("option",{value:"tamara-bnpl",children:"ðŸ“± ØªÙ…Ø§Ø±Ø§"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„ÙØ¦Ø©"}),o.jsxs("select",{id:"filterCategory",value:y,onChange:A=>E(A.target.value),className:"p-2 w-full",children:[o.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª"}),n.map(A=>o.jsx("option",{value:A.id,children:A.name},A.id))]})]}),o.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[o.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø¨Ø­Ø« Ø¨Ø§Ù„ÙˆØµÙ"}),o.jsx("input",{type:"text",id:"searchTerm",placeholder:"ðŸ”...",value:u,onChange:A=>m(A.target.value),className:"p-2 w-full"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[o.jsxs("div",{className:"card-consistent",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ"}),o.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-emerald-600 text-lg",children:"ðŸ’°"})})]}),o.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:o.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:se(M.positive)})})]}),o.jsxs("div",{className:"card-consistent",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ø¨ÙŠ"}),o.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-red-600 text-lg",children:"ðŸ’¸"})})]}),o.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:o.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:se(M.negative)})})]}),o.jsxs("div",{className:"card-consistent",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"Ø§Ù„ØµØ§ÙÙŠ"}),o.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-sky-600 text-lg",children:"ðŸ“Š"})})]}),o.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:o.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:se(M.positive-M.negative)})})]})]}),o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),o.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"Ø§Ù„ÙˆØ³ÙŠÙ„Ø©"}),o.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"Ø§Ù„Ù†ÙˆØ¹"}),o.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"Ø§Ù„ÙØ¦Ø©"}),o.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"Ø§Ù„ÙˆØµÙ"}),o.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),o.jsx("tbody",{children:T.map(A=>{const L=n.find(v=>v.id===A.categoryId),D=A.type==="income"||A.type.toString().includes("payment")||A.type==="investment-withdrawal";return o.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[o.jsx("td",{className:"p-3",children:A.date}),o.jsx("td",{className:"p-3",children:k(A.paymentMethod)}),o.jsx("td",{className:"p-3",children:C(A.type)}),o.jsxs("td",{className:`p-3 font-semibold number-display ${D?"text-emerald-500":"text-red-500"}`,children:[D?"+":"-"," ",se(A.amount)]}),o.jsx("td",{className:"p-3",children:L?`${L.icon} ${L.name}`:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}),o.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:A.description||"-"}),o.jsx("td",{className:"p-3 text-center",children:o.jsxs("div",{className:"flex gap-2 justify-center",children:[o.jsx("button",{onClick:()=>i(A.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©",children:"âœï¸"}),o.jsx("button",{onClick:()=>s(A.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"Ø­Ø°Ù Ø§Ù„Ø­Ø±ÙƒØ©",children:o.jsx(at,{})})]})})]},A.id)})})]}),T.length===0&&o.jsxs("div",{className:"text-center p-8 text-slate-500",children:[o.jsx("p",{children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©."}),o.jsx("p",{className:"text-xs mt-1",children:"Ø¬Ø±Ø¨ ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø£Ø®Ø±Ù‰."})]})]})]})})},Yu=()=>o.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),Wu=({calculations:t,filteredTransactions:e,allTransactions:n,state:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=V.useState([]),[f,u]=V.useState(""),[m,p]=V.useState(!1),[h,y]=V.useState(null),[E,S]=V.useState(!1),R=V.useRef(null);V.useEffect(()=>{var k;(k=R.current)==null||k.scrollTo(0,R.current.scrollHeight)},[c,m]),V.useEffect(()=>{(async()=>{if(!E){console.log("ðŸŒ Ø¨Ø¯Ø¡ ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ...");const C=await hu();if(C.success&&C.location){y(C.location),console.log("âœ… ØªÙ… ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹:",C.location);const T=P(C.location);d([T])}else{console.log("âš ï¸ ÙØ´Ù„ ÙÙŠ ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ");const T=P();d([T])}S(!0)}})()},[E]);const P=k=>{const C=k?`ðŸ“ **ØªÙ… ÙƒØ´Ù Ù…ÙˆÙ‚Ø¹Ùƒ:** ${k.city}, ${k.region}`:"ðŸ“ **Ø§Ù„Ù…ÙˆÙ‚Ø¹:** Ù„Ù… ÙŠØªÙ… ÙƒØ´Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)",T=(k==null?void 0:k.city)||"Ø§Ù„Ø±ÙŠØ§Ø¶",M=(k==null?void 0:k.country)||"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©";return{id:"1",text:`Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ ðŸ¤–âœ¨

${C}

ðŸ” **ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:**
â€¢ ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´Ù‡Ø±
â€¢ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± ÙÙŠ ${T} Ùˆ${M}
â€¢ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù… ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ

ðŸ’¬ **Ø§Ø³Ø£Ù„Ù†ÙŠ Ù…Ø«Ù„Ø§Ù‹:**
â€¢ "ÙƒÙ… ØµØ±ÙØª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±ØŸ"
â€¢ "Ø£ÙŠÙ† Ø£ÙØ¶Ù„ Ø¹Ø±ÙˆØ¶ ÙÙŠ ${T}ØŸ"
â€¢ "ÙƒÙ… Ø³Ø¹Ø± Ø§Ù„Ù‡Ø§ØªÙ ÙÙŠ Ø³ÙˆÙ‚ Ø§Ù„ÙŠÙˆÙ…ØŸ"
â€¢ "Ø£ÙØ¶Ù„ Ù…Ø·Ø§Ø¹Ù… ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙŠ"

Ù…Ø§Ø°Ø§ ØªØ±ÙŠØ¯ Ø£Ù† ØªØ¹Ø±ÙØŸ ðŸ˜Š`,sender:"ai"}},F=async k=>{k.preventDefault();const C=f.trim();if(!C||m)return;const T={id:Date.now().toString(),text:C,sender:"user"};d(M=>[...M,T]),u(""),p(!0);try{let M="";const A=["Ø£ÙŠÙ†","ÙƒÙ… Ø³Ø¹Ø±","Ø¹Ø±ÙˆØ¶","Ù…Ø­Ù„","Ù…Ø·Ø¹Ù…","Ø¨Ù†Ø¯Ù‡","ØªÙ…ÙŠÙ…ÙŠ","ÙƒØ§Ø±ÙÙˆØ±","Ø¹Ø±ÙˆØ¶","Ø³Ø¹Ø±","Ø£ÙØ¶Ù„","ØªÙ‚ÙŠÙŠÙ…","Ù…Ø·Ø§Ø¹Ù…","Ù…ØªØ§Ø¬Ø±","Ø¹Ø±Ø¶","Ø£Ø±Ø®Øµ","ØºØ§Ù„ÙŠ","Ø§Ù„Ø³ÙˆÙ‚","Ù…ØªØ¬Ø±","Ù…Ø·Ø¹Ù…","Ù…Ù‚Ù‡Ù‰","ÙƒÙˆÙÙŠ","Ø¨Ø±Ø¬Ø±","Ø¨ÙŠØªØ²Ø§","Ø´Ø§ÙˆØ±Ù…Ø§","Ø¯Ø¬Ø§Ø¬","Ù„Ø­Ù…","Ø³Ù…Ùƒ","Ø£ÙƒÙ„","Ø·Ø¹Ø§Ù…","Ø´Ø±Ø§Ø¨","Ù…Ø´Ø±ÙˆØ¨","Ù‚Ù‡ÙˆØ©","Ø´Ø§ÙŠ"],L=["Ù…ØµØ±ÙˆÙ","Ø¯Ø®Ù„","Ø¯ÙŠÙˆÙ†","Ø¨Ø·Ø§Ù‚Ø©","Ø´Ù‡Ø±","ØªØ­Ù„ÙŠÙ„","Ù†Ù…Ø·","Ø¥Ù†ÙØ§Ù‚","Ø±ØµÙŠØ¯","Ù‚Ø±Ø¶","Ù‚Ø³Ø·","Ø§Ø³ØªØ«Ù…Ø§Ø±","Ù…Ø§Ù„ÙŠ","Ø­Ø³Ø§Ø¨","ØµØ±ÙØª","ÙˆØµÙ„","ØªØ­ÙˆÙŠÙ„","Ø¯ÙØ¹","Ù‚Ø³Ø·","Ø¨Ø§Ù‚ÙŠ","Ù…ØªÙˆØ³Ø·","Ø¥Ø¬Ù…Ø§Ù„ÙŠ","Ø´Ù‡Ø±","Ø£Ø³Ø¨ÙˆØ¹","Ø³Ù†Ø©","Ù…Ù‚Ø§Ø±Ù†Ø©","ØªØºÙŠØ±","Ø²ÙŠØ§Ø¯Ø©","Ù†Ù‚Øµ","Ø£Ø¹Ù„Ù‰","Ø£Ù‚Ù„"],D=A.some(O=>C.toLowerCase().includes(O.toLowerCase())),v=L.some(O=>C.toLowerCase().includes(O.toLowerCase()));if(D)M=await Ho(C,h||void 0);else if(v){const O={currentPeriod:{calculations:t,transactions:e},allHistoricalData:{allTransactions:n,categories:s.categories,cards:s.cards,bankAccounts:s.bankAccounts,loans:s.loans,installments:s.installments,investments:s.investments},state:s};M=await Go(C,O,h||void 0)}else M=await Jo(C,n,t,h||void 0);const j={id:(Date.now()+1).toString(),text:M,sender:"ai"};d(O=>[...O,j])}catch(M){const A={id:(Date.now()+1).toString(),text:M instanceof Error?M.message:"Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ù…Ø§. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",sender:"ai"};d(L=>[...L,A])}finally{p(!1)}};return o.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[o.jsxs("div",{className:`p-4 ${i?"bg-slate-800":"bg-gray-100"} text-center flex-shrink-0`,children:[o.jsx("h3",{className:`text-xl font-bold ${i?"text-slate-100":"text-slate-900"}`,children:"ðŸ¤– Ø§Ù„Ù…Ø­Ù„Ù„ Ø§Ù„Ø°ÙƒÙŠ"}),o.jsx("p",{className:`text-sm ${i?"text-slate-400":"text-slate-500"}`,children:"ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ù…Ø§Ù„ÙŠØ© + Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"})]}),o.jsxs("div",{ref:R,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[c.map(k=>o.jsx("div",{className:`chat-bubble ${k.sender==="user"?"user-bubble":"ai-bubble"}`,children:o.jsx("p",{dangerouslySetInnerHTML:{__html:k.text.replace(/\n/g,"<br />")}})},k.id)),m&&o.jsx(Yu,{})]}),o.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:o.jsxs("form",{onSubmit:F,className:"flex gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:k=>u(k.target.value),className:"w-full p-3",placeholder:"Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...",required:!0,autoComplete:"off",disabled:m}),o.jsx("button",{type:"submit",disabled:m,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:o.jsx(Wo,{})})]})})]})},zu=({calculations:t,categories:e,allTransactions:n,darkMode:s=!1,language:i="ar"})=>{const l=V.useRef(null),c=V.useRef(null),d=V.useRef({}),f=V.useMemo(()=>Object.entries(t.expensesByCategory).map(([m,p])=>{const h=e.find(y=>y.id===m);return{name:h?`${h.icon} ${h.name}`:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯",value:p}}).sort((m,p)=>p.value-m.value),[t.expensesByCategory,e]),u=V.useMemo(()=>{const m={},p=new Date;for(let h=5;h>=0;h--){const E=new Date(p.getFullYear(),p.getMonth()-h,1).toLocaleString("en-US",{month:"short",year:"numeric"});m[E]={income:0,expenses:0}}return n.forEach(h=>{const E=new Date(h.date).toLocaleString("en-US",{month:"short",year:"numeric"});m[E]&&(h.type==="income"&&(m[E].income+=h.amount),(h.type==="expense"||h.type==="bnpl-payment")&&(m[E].expenses+=h.amount))}),{labels:Object.keys(m),incomeData:Object.values(m).map(h=>h.income),expensesData:Object.values(m).map(h=>h.expenses)}},[n]);return V.useEffect(()=>{var p,h;const m=window.Chart;if(m){if((p=d.current.pie)==null||p.destroy(),(h=d.current.bar)==null||h.destroy(),l.current&&f.length>0){const y=l.current.getContext("2d");y&&(d.current.pie=new m(y,{type:"doughnut",data:{labels:f.map(E=>E.name),datasets:[{data:f.map(E=>E.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(c.current&&u.labels.length>0){const y=c.current.getContext("2d");y&&(d.current.bar=new m(y,{type:"bar",data:{labels:u.labels,datasets:[{label:"Ø§Ù„Ø¯Ø®Ù„",data:u.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ",data:u.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var y,E;(y=d.current.pie)==null||y.destroy(),(E=d.current.bar)==null||E.destroy()}}},[f,u]),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“Š ØªÙˆØ²ÙŠØ¹ Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„ÙØªØ±Ø©"}),o.jsx("div",{className:"h-80",children:f.length>0?o.jsx("canvas",{ref:l}):o.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 mt-10",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ§Ø±ÙŠÙ Ù„Ø¹Ø±Ø¶Ù‡Ø§."})})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“ˆ Ø§Ù„Ø¯Ø®Ù„ Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ (Ø¢Ø®Ø± 6 Ø£Ø´Ù‡Ø±)"}),o.jsx("div",{className:"h-80",children:o.jsx("canvas",{ref:c})})]})]})},Ku=({state:t,setLoading:e,setModal:n,darkMode:s=!1,language:i="ar"})=>{const[l,c]=V.useState(""),[d,f]=V.useState(""),u=async()=>{const m=parseFloat(l);if(isNaN(m)||m<=0){n({title:B("error",i),body:`<p>${B("invalid.amount",i)}</p>`,confirmText:B("confirm",i),hideCancel:!0});return}e(!0,B("loading",i)),f("");try{const p=new Date;p.setDate(p.getDate()-60);const h=t.transactions.filter(E=>new Date(E.date)>=p&&E.type==="expense");if(h.length<5)throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© Ø¹Ù† Ø¥Ù†ÙØ§Ù‚Ùƒ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø¯Ù‚ÙŠÙ‚Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© 5 Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.");const y=await qo(m,t.categories,h);f(y)}catch(p){const h=p instanceof Error?p.message:"Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.";n({title:B("error",i),body:`<p>${h}</p>`,confirmText:B("confirm",i),hideCancel:!0})}finally{e(!1)}};return o.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[o.jsxs("h3",{className:`text-xl font-bold mb-4 ${s?"text-slate-200":"text-slate-900"}`,children:["âœ¨ ",B("budget",i)]}),o.jsxs("div",{className:`flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 rounded-lg ${s?"bg-slate-700":"bg-slate-100"}`,children:[o.jsxs("div",{className:"flex-grow",children:[o.jsx("label",{htmlFor:"monthly-budget-input",className:`block text-sm font-medium mb-1 ${s?"text-slate-300":"text-slate-600"}`,children:B("budget.limit",i)}),o.jsx("input",{type:"number",id:"monthly-budget-input",className:`w-full p-2 ${s?"bg-slate-600 text-slate-200 border-slate-500":"bg-white text-slate-900 border-gray-300"} border rounded`,placeholder:"5000",value:l,onChange:m=>c(m.target.value)})]}),o.jsxs("button",{onClick:u,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:["âœ¨ ",B("generate.report",i)]})]}),o.jsx("div",{className:"prose max-w-none",children:d?o.jsx("div",{className:s?"text-slate-200":"text-slate-900",dangerouslySetInnerHTML:{__html:d.replace(/### (.*)/g,`<h4 class="text-lg font-bold ${s?"text-slate-200":"text-slate-900"} mt-3 mb-2">$1</h4>`).replace(/\n/g,"<br />")}}):o.jsx("p",{className:`text-center ${s?"text-slate-400":"text-slate-500"}`,children:B("no.data",i)})})]})},Xu=({state:t,setState:e,calculations:n,setModal:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=V.useState([{id:"1",text:`Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø³ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ø§Ù„Ø°ÙƒÙŠ ðŸŽ¯ðŸ“ˆ

ðŸ’¼ **Ø®Ø¨Ø±ØªÙŠ ØªØ´Ù…Ù„:**
â€¢ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø³ÙˆÙ‚ ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ
â€¢ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©
â€¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø­Ø§ÙØ¸
â€¢ ØªÙˆØµÙŠØ§Øª Ø£Ø³Ù‡Ù… Ù…Ø­Ø¯Ø¯Ø© Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø¹Ù…ÙŠÙ‚

ðŸ“Š **ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:**
â€¢ ØªØ­Ù„ÙŠÙ„ Ù…Ø­ÙØ¸ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆØªØ­Ø³ÙŠÙ†Ù‡Ø§
â€¢ ØªÙˆØµÙŠØ§Øª Ø£Ø³Ù‡Ù… Ù…Ø¹ Ø£Ù‡Ø¯Ø§Ù Ø³Ø¹Ø±ÙŠØ© ÙˆØ§Ø¶Ø­Ø©
â€¢ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø³ÙˆÙ‚ ÙˆØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
â€¢ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø¯Ø®ÙˆÙ„ ÙˆØ®Ø±ÙˆØ¬ Ù…Ø­Ø¯Ø¯Ø©

ðŸ’¡ **Ø§Ø³Ø£Ù„Ù†ÙŠ Ù…Ø«Ù„Ø§Ù‹:**
â€¢ "Ù…Ø§ Ø±Ø£ÙŠÙƒ ÙÙŠ Ø£Ø³Ù‡Ù… Ø£Ø±Ø§Ù…ÙƒÙˆ Ø§Ù„Ø¢Ù†ØŸ"
â€¢ "ÙƒÙŠÙ Ø£Ø­Ø³Ù† Ù…Ø­ÙØ¸ØªÙŠ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©ØŸ"
â€¢ "Ù…Ø§ Ù‡ÙŠ Ø£ÙØ¶Ù„ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ØŸ"
â€¢ "Ø£Ø±ÙŠØ¯ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø³ÙˆÙ‚ Ø§Ù„ÙŠÙˆÙ…"

Ø£Ø®Ø¨Ø±Ù†ÙŠ Ø¹Ù† Ù…Ø­ÙØ¸ØªÙƒ ÙˆØ£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©! ðŸš€`,sender:"ai"}]),[f,u]=V.useState(""),[m,p]=V.useState(!1),h=V.useRef(null);V.useEffect(()=>{var R;(R=h.current)==null||R.scrollTo(0,h.current.scrollHeight)},[c,m]);const y=R=>{R.preventDefault();const P=R.target,F=parseFloat(P.elements.namedItem("investment-amount").value),k=P.elements.namedItem("investment-type").value,C=P.elements.namedItem("payment-method").value;if(isNaN(F)||F<=0){s({title:"Ø®Ø·Ø£",body:"<p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­.</p>"});return}const T={amount:F,date:new Date().toISOString().split("T")[0],description:k==="deposit"?"Ø¥ÙŠØ¯Ø§Ø¹ ÙÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©":"Ø³Ø­Ø¨ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©",paymentMethod:C,type:k==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(M=>({...M,transactions:[...M.transactions,{...T,id:`trans-${Date.now()}`}]})),P.reset()},E=async R=>{R.preventDefault();const P=f.trim();if(!(!P||m)){d(F=>[...F,{id:Date.now().toString(),text:P,sender:"user"}]),u(""),p(!0);try{const F={currentValue:t.investments.currentValue,totalDeposited:t.investments.totalDeposited,totalWithdrawn:t.investments.totalWithdrawn,transactions:t.transactions.filter(C=>C.type==="investment-deposit"||C.type==="investment-withdrawal"),recentPerformance:n.investments},k=await Oo(P,F,{marketDate:new Date().toLocaleDateString("en-CA"),saudiMarketContext:"Tadawul analysis requested",userInvestmentHistory:F});d(C=>[...C,{id:(Date.now()+1).toString(),text:k,sender:"ai"}])}catch(F){d(k=>[...k,{id:(Date.now()+1).toString(),text:F instanceof Error?F.message:"Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©.",sender:"ai"}])}finally{p(!1)}}},S=()=>{const R=`<div><label class="block text-sm font-medium text-slate-600 mb-1">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø© (Ø±ÙŠØ§Ù„)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${t.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§ØªÙƒ.</p></div>`;s({show:!0,title:"ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©",body:R,confirmText:"Ø­ÙØ¸",onConfirm:()=>{const P=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(P)||P<0)return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø©."),!1;e(F=>({...F,investments:{...F.investments,currentValue:P}}))}})};return o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[o.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[o.jsxs("div",{className:"glass-card p-6 text-center",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"ðŸ’° Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ù…Ø­ÙØ¸Ø©"}),o.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:se(t.investments.currentValue)}),o.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±: ",o.jsx("span",{className:"font-semibold number-display text-slate-600",children:se(n.totalInvestmentDeposits)})]}),o.jsx("button",{onClick:S,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"âœï¸ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©"})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"ðŸ’¸ Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©"}),o.jsxs("form",{onSubmit:y,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©"}),o.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[o.jsx("option",{value:"deposit",children:"Ø¥ÙŠØ¯Ø§Ø¹ Ù„Ù„Ù…Ø­ÙØ¸Ø©"}),o.jsx("option",{value:"withdrawal",children:"Ø³Ø­Ø¨ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ"}),o.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(t.bankAccounts).map(R=>o.jsxs("option",{value:R.id,children:["ðŸ¦ ",R.name]},R.id))})]}),o.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø±ÙƒØ©"})]})]})]}),o.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[o.jsxs("div",{className:`p-4 ${i?"bg-slate-800":"bg-gray-100"} text-center flex-shrink-0`,children:[o.jsx("h3",{className:`text-xl font-bold ${i?"text-slate-100":"text-slate-900"}`,children:"ðŸŽ¯ Ù…Ø³ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"}),o.jsx("p",{className:`text-sm ${i?"text-slate-400":"text-slate-500"}`,children:"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ + ØªÙˆØµÙŠØ§Øª Ø£Ø³Ù‡Ù… + Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸"})]}),o.jsxs("div",{ref:h,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[c.map(R=>o.jsx("div",{className:`chat-bubble ${R.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:R.text.replace(/\n/g,"<br/>")}},R.id)),m&&o.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),o.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),o.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:o.jsxs("form",{onSubmit:E,className:"flex gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:R=>u(R.target.value),className:"w-full p-3",placeholder:"Ø§Ø³Ø£Ù„ Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±...",required:!0,autoComplete:"off",disabled:m}),o.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:m,children:o.jsx(Wo,{})})]})})]})]})},Qu=({card:t,statementDetails:e,openCardFormModal:n,deleteCard:s})=>{const i=(l,c)=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª</td></tr>':l.map(d=>{var p;const f=((p=d.description)==null?void 0:p.includes(`Ø³Ø¯Ø§Ø¯ ${c.name}`))||d.type===`Ø³Ø¯Ø§Ø¯ ${c.name}`||d.type===`${c.id}-payment`,u=f?"text-green-500":"text-red-500",m=f?"+":"";return`
                <tr class="hover:bg-slate-50">
                    <td class="p-2">${d.postingDate||d.date}</td>
                    <td class="p-2 truncate" title="${d.description}">${d.description}</td>
                    <td class="p-2 number-display ${u}">${m}${se(d.amount)}</td>
                </tr>
            `}).join("");return o.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-xl",children:"ðŸ’³"})}),o.jsx("h3",{className:"text-xl font-bold text-slate-900",children:t.name})]}),o.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[o.jsx("button",{onClick:()=>n(t.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø·Ø§Ù‚Ø© ${t.name}`,children:"âœï¸"}),o.jsx("button",{onClick:()=>s(t.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`Ø­Ø°Ù Ø¨Ø·Ø§Ù‚Ø© ${t.name}`,children:o.jsx(at,{})})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚ Ù„Ù„ÙƒØ´Ù Ø§Ù„Ø­Ø§Ù„ÙŠ"}),o.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-amber-600 text-lg",children:"ðŸ“…"})})]}),o.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:o.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[se(e.statementDueAmount)," Ø±ÙŠØ§Ù„"]})}),o.jsxs("div",{className:"flex justify-between items-center text-xs",children:[o.jsx("span",{className:"text-amber-600 font-medium",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:"}),o.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),o.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[o.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚"}),o.jsxs("p",{className:"font-bold text-red-800 number-display",children:[se(t.balance)," Ø±ÙŠØ§Ù„"]})]}),o.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[o.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ÙŠ"}),o.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[se(t.limit)," Ø±ÙŠØ§Ù„"]})]}),o.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[o.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­"}),o.jsxs("p",{className:"font-bold text-green-800 number-display",children:[se(t.available)," Ø±ÙŠØ§Ù„"]})]}),o.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[o.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…"}),o.jsxs("p",{className:`font-bold ${t.usagePercentage>80?"text-red-800":t.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[t.usagePercentage.toFixed(1),"%"]})]})]})})]}),o.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[o.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© (",e.upcomingTransactions.length,")"]}),o.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:o.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${i(e.upcomingTransactions,t)}</tbody>`}})})]})]})},Zu=({state:t,calculations:e,openCardFormModal:n,deleteCard:s})=>{const i=V.useMemo(()=>{const c={};return Object.values(t.cards).forEach(d=>{const f=new Date,u=f.getDate(),m=f.getMonth(),p=f.getFullYear();let h,y,E;u>d.statementDay?h=new Date(p,m,d.statementDay):h=new Date(p,m-1,d.statementDay),y=new Date(h.getFullYear(),h.getMonth()-1,d.statementDay+1);let S=h.getMonth()+1,R=h.getFullYear();S>11&&(S=0,R+=1),E=new Date(R,S,d.dueDay);const P=t.transactions.filter(C=>{const T=new Date(C.postingDate||C.date);return C.paymentMethod===d.id&&(C.type==="expense"||C.type==="bnpl-payment")&&T>=y&&T<=h}),F=t.transactions.filter(C=>{var D,v,j,O,ne,he,le;const T=new Date(C.postingDate||C.date),M=C.paymentMethod===d.id&&(C.type==="expense"||C.type==="bnpl-payment"),A=(((D=C.description)==null?void 0:D.includes(`Ø³Ø¯Ø§Ø¯ ${d.name}`))||C.type===`Ø³Ø¯Ø§Ø¯ ${d.name}`||C.type===`${d.id}-payment`)&&(C.type==="expense"||((v=C.type)==null?void 0:v.includes("Ø³Ø¯Ø§Ø¯"))||((j=C.type)==null?void 0:j.includes("-payment"))),L=C.paymentMethod===d.id&&(((O=C.description)==null?void 0:O.includes("Ø³Ø¯Ø§Ø¯"))||((ne=C.type)==null?void 0:ne.includes("Ø³Ø¯Ø§Ø¯"))||((he=C.type)==null?void 0:he.includes("-payment")))&&!((le=C.description)!=null&&le.includes(d.name))&&C.type!==`Ø³Ø¯Ø§Ø¯ ${d.name}`&&C.type!==`${d.id}-payment`;return(M||A||L)&&T>h}),k=P.reduce((C,T)=>C+T.amount,0);c[d.id]={statementDueAmount:k,dueDate:E,totalOutstanding:0,upcomingTransactions:F}}),c},[t.transactions,t.cards]),l=Object.values(t.cards);return o.jsxs("div",{className:"space-y-6 animate-fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª"}),o.jsx("button",{onClick:()=>n(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø©"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map(c=>{const d=e.cardDetails[c.id];return o.jsx(Qu,{card:d,statementDetails:i[d.id],openCardFormModal:n,deleteCard:s},d.id)})})]})},ef=(t,e)=>{const n={income:"ðŸ’° Ø¯Ø®Ù„",expense:"ðŸ’¸ Ù…ØµØ§Ø±ÙŠÙ","bnpl-payment":"ðŸ“± Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·","investment-deposit":"ðŸ’¹ Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ","investment-withdrawal":"ðŸ’¹ Ø³Ø­Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"};if(n[t])return n[t];if(t.endsWith("-payment")){const s=t.replace("-payment","");if(e.cards[s])return`ðŸ’³ Ø³Ø¯Ø§Ø¯ ${e.cards[s].name}`}return t},tf=({account:t,openBankAccountFormModal:e,deleteBankAccount:n})=>o.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-xl",children:"ðŸ¦"})}),o.jsx("h4",{className:"text-xl font-bold text-slate-900",children:t.name})]}),o.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[o.jsx("button",{onClick:()=>e(t.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`ØªØ¹Ø¯ÙŠÙ„ Ø­Ø³Ø§Ø¨ ${t.name}`,children:"âœï¸"}),o.jsx("button",{onClick:()=>n(t.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`Ø­Ø°Ù Ø­Ø³Ø§Ø¨ ${t.name}`,children:o.jsx(at,{})})]})]}),o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[o.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ"}),o.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:se(t.balance)})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[o.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª Ø§Ù„ÙØªØ±Ø©"}),o.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:se(t.deposits)})]}),o.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[o.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"Ø³Ø­ÙˆØ¨Ø§Øª Ø§Ù„ÙØªØ±Ø©"}),o.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:se(t.withdrawals)})]})]})]}),nf=({state:t,setState:e,calculations:n,filteredTransactions:s,categories:i,setModal:l,openBankAccountFormModal:c,deleteBankAccount:d,openTransferModal:f})=>o.jsxs("div",{className:"space-y-6 animate-fade-in",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ©"}),o.jsxs("div",{className:"flex gap-3",children:[Object.keys(t.bankAccounts).length>1&&o.jsx("button",{onClick:f,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"ðŸ’¸ ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª"}),o.jsx("button",{onClick:()=>c(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(n.bankAccountDetails).map(u=>o.jsx(tf,{account:u,openBankAccountFormModal:c,deleteBankAccount:d},u.id))}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"ðŸ“‹ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¨Ù†ÙƒÙŠØ© (Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©)"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„Ø­Ø³Ø§Ø¨"}),o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„Ù†ÙˆØ¹"}),o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„ÙØ¦Ø©"}),o.jsx("th",{className:"text-right p-3 font-semibold",children:"Ø§Ù„ÙˆØµÙ"})]})}),o.jsx("tbody",{children:s.filter(u=>t.bankAccounts[u.paymentMethod]).sort((u,m)=>new Date(m.date).getTime()-new Date(u.date).getTime()).map(u=>{var y;const m=["income","investment-withdrawal"].includes(u.type),p=m?"text-emerald-500":"text-red-500",h=i.find(E=>E.id===u.categoryId);return o.jsxs("tr",{className:"border-b border-gray-200/50",children:[o.jsx("td",{className:"p-3",children:u.date}),o.jsx("td",{className:"p-3",children:(y=t.bankAccounts[u.paymentMethod])==null?void 0:y.name}),o.jsx("td",{className:"p-3",children:ef(u.type,t)}),o.jsxs("td",{className:`p-3 font-semibold ${p} number-display`,children:[m?"+":"-",se(u.amount)]}),o.jsx("td",{className:"p-3",children:h?`${h.icon} ${h.name}`:"-"}),o.jsx("td",{className:"p-3 text-slate-500",children:u.description||"-"})]},u.id)})})]})})]})]}),Qt=(t,e)=>{const n={cash:"ðŸ’µ Ù†Ù‚Ø¯ÙŠ","tabby-bnpl":"ðŸ“± ØªØ§Ø¨ÙŠ","tamara-bnpl":"ðŸ“± ØªÙ…Ø§Ø±Ø§",reconciliation:"ðŸ”„ ØªØ³ÙˆÙŠØ©"};return n[t]?n[t]:e.cards[t]?`ðŸ’³ ${e.cards[t].name}`:e.bankAccounts[t]?`ðŸ¦ ${e.bankAccounts[t].name}`:t},sf=({state:t,setState:e,filteredTransactions:n,setModal:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=Mn.useState(!1),f=()=>{const C=t.installments.filter(v=>v.paid<v.total),T=C.filter(v=>v.provider==="tabby-bnpl"),M=C.filter(v=>v.provider==="tamara-bnpl"),A=T.reduce((v,j)=>{const O=j.total-j.paid;return v+j.installmentAmount*O},0),L=M.reduce((v,j)=>{const O=j.total-j.paid;return v+j.installmentAmount*O},0),D=A+L;return{tabbyTotal:A,tamaraTotal:L,grandTotal:D,activeCount:C.length,completedCount:t.installments.filter(v=>v.paid>=v.total).length}},u=()=>{const C=t.installments.filter(A=>A.paid<A.total);if(C.length===0)return null;const T=t.transactions.filter(A=>A.isInstallmentPayment);if(T.length===0){const A=C.sort((v,j)=>new Date(v.createdAt).getTime()-new Date(j.createdAt).getTime())[0],L=new Date(A.createdAt),D=new Date(L);return D.setDate(D.getDate()+30),D.toISOString().split("T")[0]}let M=null;for(const A of C){const L=T.filter(D=>D.installmentId===A.id).sort((D,v)=>new Date(v.date).getTime()-new Date(D.date).getTime());if(L.length>0){const D=L[0],v=new Date(D.date),j=new Date(v);j.setDate(j.getDate()+30),(!M||j<new Date(M))&&(M=j.toISOString().split("T")[0])}else{const D=new Date(A.createdAt),v=new Date(D);v.setDate(v.getDate()+30),(!M||v<new Date(M))&&(M=v.toISOString().split("T")[0])}}return M},m=()=>t.installments.filter(T=>T.paid<T.total).reduce((T,M)=>T+M.installmentAmount,0),p=()=>{const C=t.installments.filter(M=>M.paid<M.total),T=t.transactions.filter(M=>M.isInstallmentPayment);return C.map(M=>{const A=T.filter(D=>D.installmentId===M.id).sort((D,v)=>new Date(v.date).getTime()-new Date(D.date).getTime());let L;if(A.length>0){const D=A[0],v=new Date(D.date),j=new Date(v);j.setDate(j.getDate()+30),L=j.toISOString().split("T")[0]}else{const D=new Date(M.createdAt),v=new Date(D);v.setDate(v.getDate()+30),L=v.toISOString().split("T")[0]}return{installment:M,nextPaymentDate:L}}).sort((M,A)=>new Date(M.nextPaymentDate).getTime()-new Date(A.nextPaymentDate).getTime())},h=C=>{const T=t.transactions.find(L=>L.id===C);if(!T||!T.isInstallmentPayment||!t.installments.find(L=>L.id===T.installmentId))return;const A=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ø§Ù„Ù…Ø¨Ù„Øº</label>
                    <input type="number" id="edit-amount" value="${T.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="edit-date" value="${T.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ø§Ù„ÙˆØµÙ</label>
                    <input type="text" id="edit-description" value="${T.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ù…ØµØ¯Ø± Ø§Ù„Ø¯ÙØ¹</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(t.bankAccounts).map(L=>`<option value="${L.id}" ${T.paymentMethod===L.id?"selected":""}>ðŸ¦ ${L.name}</option>`).join("")}
                        <option value="cash" ${T.paymentMethod==="cash"?"selected":""}>ðŸ’µ Ù†Ù‚Ø¯ÙŠ</option>
                        ${Object.values(t.cards).map(L=>`<option value="${L.id}" ${T.paymentMethod===L.id?"selected":""}>ðŸ’³ ${L.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;s({show:!0,title:"ØªØ¹Ø¯ÙŠÙ„ Ø­Ø±ÙƒØ© Ø§Ù„Ù‚Ø³Ø·",body:A,confirmText:"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª",onConfirm:()=>{const L=parseFloat(document.getElementById("edit-amount").value),D=document.getElementById("edit-date").value,v=document.getElementById("edit-description").value,j=document.getElementById("edit-payment-method").value;e(O=>({...O,transactions:O.transactions.map(ne=>ne.id===C?{...ne,amount:L,date:D,description:v,paymentMethod:j}:ne)})),s({show:!1})}})},y=C=>{const T=t.transactions.find(A=>A.id===C);if(!T||!T.isInstallmentPayment)return;s({show:!0,title:"Ø­Ø°Ù Ø­Ø±ÙƒØ© Ø§Ù„Ù‚Ø³Ø·",body:"<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø±ÙƒØ©ØŸ Ø³ÙŠØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù„Ù„Ù‚Ø³Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·.</p>",confirmText:"Ø­Ø°Ù",onConfirm:()=>{const A=T.installmentId;e(L=>({...L,transactions:L.transactions.filter(D=>D.id!==C),installments:L.installments.map(D=>D.id===A?{...D,paid:Math.max(0,D.paid-1)}:D)})),s({show:!1})}})},E=C=>{const T=t.installments.find(A=>A.id===C);if(!T)return;const M=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">ÙˆØµÙ Ø§Ù„Ù‚Ø³Ø·</label>
                    <input type="text" id="edit-description" value="${T.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø·</label>
                    <input type="number" id="edit-amount" value="${T.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</label>
                    <input type="number" id="edit-total" value="${T.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©</label>
                    <input type="number" id="edit-paid" value="${T.paid}" min="0" max="${T.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;s({show:!0,title:"ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·Ø© Ø§Ù„Ù‚Ø³Ø·",body:M,confirmText:"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª",onConfirm:()=>{const A=document.getElementById("edit-description").value,L=parseFloat(document.getElementById("edit-amount").value),D=parseInt(document.getElementById("edit-total").value),v=parseInt(document.getElementById("edit-paid").value);e(j=>({...j,installments:j.installments.map(O=>O.id===C?{...O,description:A,installmentAmount:L,total:D,paid:v}:O)})),s({show:!1})}})},S=C=>{const T=t.installments.find(A=>A.id===C);if(!T)return;const M=`<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø®Ø·Ø© Ø§Ù„Ù‚Ø³Ø· "${T.description}"ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§.</p>`;s({show:!0,title:"Ø­Ø°Ù Ø®Ø·Ø© Ø§Ù„Ù‚Ø³Ø·",body:M,confirmText:"Ø­Ø°Ù",onConfirm:()=>{e(A=>({...A,installments:A.installments.filter(L=>L.id!==C),transactions:A.transactions.filter(L=>L.installmentId!==C)})),s({show:!1})}})},R=C=>{const T=t.installments.find(L=>L.id===C);if(!T||T.paid>=T.total)return;let M="";Object.values(t.bankAccounts).forEach(L=>{M+=`<option value="${L.id}">ðŸ¦ ${L.name}</option>`}),M+='<option value="cash">ðŸ’µ Ù†Ù‚Ø¯ÙŠ</option>',Object.values(t.cards).forEach(L=>{M+=`<option value="${L.id}">ðŸ’³ ${L.name}</option>`});const A=`<p class="mb-4">Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ø¯ÙØ¹ Ù„Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø· "${T.description}" Ø¨Ù‚ÙŠÙ…Ø© ${se(T.installmentAmount)} Ø±ÙŠØ§Ù„.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">Ù…ØµØ¯Ø± Ø§Ù„Ø¯ÙØ¹</label><select id="installment-payment-source" class="w-full p-3">${M}</select></div>`;s({show:!0,title:"Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·",body:A,confirmText:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹",onConfirm:()=>{var O;const L=document.getElementById("installment-payment-source").value,D=t.categories.find(ne=>ne.name==="Ø³Ø¯Ø§Ø¯ ÙÙˆØ§ØªÙŠØ±"||ne.name==="ðŸ’³ Ø³Ø¯Ø§Ø¯ ÙÙˆØ§ØªÙŠØ±"),v=(D==null?void 0:D.id)||((O=t.categories.find(ne=>ne.name==="Ø£Ø®Ø±Ù‰"))==null?void 0:O.id)||"",j={id:"trans-"+Date.now(),amount:T.installmentAmount,date:new Date().toISOString().split("T")[0],description:`Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø³Ø· ${T.paid+1} Ù„Ù€: ${T.description}`,paymentMethod:L,type:"bnpl-payment",categoryId:v,isInstallmentPayment:!0,installmentId:C};e(ne=>{const he=ne.installments.map(le=>{if(le.id===C){const ce={...le,paid:le.paid+1};return console.log("ðŸ”„ ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ø·:",{id:le.id,paid:le.paid,newPaid:ce.paid,total:le.total}),ce}return le});return{...ne,transactions:[...ne.transactions,j],installments:he}})}})},P=t.installments.filter(C=>C.paid<C.total),F=t.transactions.filter(C=>C.isInstallmentPayment),k=f();return u(),m(),o.jsxs("div",{className:"animate-fade-in",children:[o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[o.jsx("div",{className:"flex justify-between items-start mb-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-2xl",children:"ðŸ“Š"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"}),o.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ§Ù„Ù…Ø³ØªØ­Ù‚Ø©"})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-2xl",children:"ðŸŽ¯"}),o.jsx("span",{className:"font-semibold text-blue-800",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"})]}),o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:se(k.grandTotal)})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-2xl",children:"ðŸ“±"}),o.jsx("span",{className:"font-semibold text-blue-800",children:"ØªØ§Ø¨ÙŠ"})]}),o.jsx("p",{className:"text-xl font-bold text-blue-900",children:se(k.tabbyTotal)})]}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-2xl",children:"ðŸ“±"}),o.jsx("span",{className:"font-semibold text-blue-800",children:"ØªÙ…Ø§Ø±Ø§"})]}),o.jsx("p",{className:"text-xl font-bold text-blue-900",children:se(k.tamaraTotal)})]})]}),p().length>0&&o.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("span",{className:"text-2xl",children:"â°"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-blue-800",children:"Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„ØªØ§Ù„ÙŠØ©"}),o.jsx("p",{className:"text-sm text-slate-600",children:"Ø£Ù‚Ø±Ø¨ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯"})]})]}),o.jsx("div",{className:"space-y-2",children:p().slice(0,3).map((C,T)=>o.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-slate-700",children:C.installment.description}),o.jsx("p",{className:"text-xs text-slate-500",children:Qt(C.installment.provider,t)})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(C.nextPaymentDate).toLocaleDateString("en-GB")}),o.jsx("p",{className:"text-xs text-slate-600",children:se(C.installment.installmentAmount)})]})]},C.installment.id))})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex gap-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-blue-900",children:k.activeCount}),o.jsx("p",{className:"text-sm text-slate-600",children:"Ø£Ù‚Ø³Ø§Ø· Ù†Ø´Ø·Ø©"})]}),o.jsx("div",{className:"text-center",children:o.jsxs("button",{onClick:()=>d(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[o.jsx("p",{className:"text-2xl font-bold text-green-600",children:k.completedCount}),o.jsx("p",{className:"text-sm text-slate-600",children:"Ø£Ù‚Ø³Ø§Ø· Ù…ÙƒØªÙ…Ù„Ø©"})]})})]}),p().length>0&&o.jsx("button",{onClick:()=>{t.installments.filter(T=>T.paid<T.total).forEach(T=>{R(T.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"ðŸ’³ Ø¯ÙØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"})]})]}),o.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“± Ø®Ø·Ø· Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù†Ø´Ø·Ø©"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:P.length>0?P.map(C=>{const T=C.paid/C.total*100;return console.log("ðŸ“Š Ø¹Ø±Ø¶ Ù‚Ø³Ø·:",{id:C.id,paid:C.paid,total:C.total,progress:T}),o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-lg",children:"ðŸ“±"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:C.description}),o.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:Qt(C.provider,t)})]})]}),o.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:o.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[se(C.installmentAmount),"/Ø´Ù‡Ø±"]})})]}),o.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg border border-gray-200 dark:border-slate-700 mb-3",children:[o.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:o.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${T}%`}})}),o.jsxs("div",{className:"flex justify-between text-xs text-slate-600 dark:text-slate-400",children:[o.jsxs("span",{className:"font-medium",children:[C.paid," / ",C.total," Ù…Ø¯ÙÙˆØ¹"]}),o.jsxs("span",{className:"font-medium",children:["Ù…ØªØ¨Ù‚ÙŠ: ",C.total-C.paid]})]}),o.jsx("div",{className:"text-center mt-2",children:o.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[T.toFixed(1),"% Ù…ÙƒØªÙ…Ù„"]})})]}),o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx("button",{onClick:()=>R(C.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"ðŸ’³ Ø¯ÙØ¹ Ø§Ù„Ù‚Ø³Ø· Ø§Ù„ØªØ§Ù„ÙŠ"}),o.jsx("button",{onClick:()=>E(C.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ø·",children:"âœï¸"}),o.jsx("button",{onClick:()=>S(C.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ø·",children:"ðŸ—‘ï¸"})]})]},C.id)}):o.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:o.jsx("p",{className:"text-slate-500",children:"ðŸŽ‰ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ø· Ù†Ø´Ø·Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§!"})})}),o.jsxs("div",{className:"glass-card p-6 mt-8",children:[o.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“‹ Ø³Ø¬Ù„ Ø¯ÙØ¹Ø§Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"border-b border-gray-200 dark:border-slate-700",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),o.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"Ø§Ù„ÙˆØµÙ"}),o.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"Ø§Ù„Ù…ØµØ¯Ø±"}),o.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),o.jsx("tbody",{children:F.sort((C,T)=>new Date(T.date).getTime()-new Date(C.date).getTime()).map(C=>o.jsxs("tr",{className:"border-b border-gray-200/50 dark:border-slate-700/50 text-slate-700 dark:text-slate-300",children:[o.jsx("td",{className:"p-3",children:new Date(C.date).toLocaleDateString("en-GB")}),o.jsx("td",{className:"p-3 text-slate-600 dark:text-slate-400",children:C.description}),o.jsx("td",{className:"p-3",children:Qt(C.paymentMethod,t)}),o.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:se(C.amount)}),o.jsx("td",{className:"p-3",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>h(C.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"ØªØ¹Ø¯ÙŠÙ„",children:"âœï¸"}),o.jsx("button",{onClick:()=>y(C.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"Ø­Ø°Ù",children:"ðŸ—‘ï¸"})]})})]},C.id))})]})})]}),c&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:C=>C.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"âœ… Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©"}),o.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-600",children:"âœ•"})]}),o.jsxs("div",{className:"space-y-4",children:[Object.values(t.installments).filter(C=>C.paid>=C.total).map(C=>o.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-green-800",children:C.description}),o.jsx("p",{className:"text-sm text-green-600",children:Qt(C.provider,t)})]}),o.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"Ù…ÙƒØªÙ…Ù„"})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[o.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[o.jsx("p",{className:"text-green-700 font-bold text-lg",children:C.total}),o.jsx("p",{className:"text-green-600 text-sm",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"})]}),o.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[o.jsx("p",{className:"text-green-700 font-bold text-lg",children:se(C.installmentAmount)}),o.jsx("p",{className:"text-green-600 text-sm",children:"Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø·"})]}),o.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[o.jsx("p",{className:"text-green-700 font-bold text-lg",children:se(C.total*C.installmentAmount)}),o.jsx("p",{className:"text-green-600 text-sm",children:"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ"})]})]})]},C.id)),Object.values(t.installments).filter(C=>C.paid>=C.total).length===0&&o.jsxs("div",{className:"text-center py-12 text-slate-500",children:[o.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ‰"}),o.jsx("p",{className:"text-lg",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ø³Ø§Ø· Ù…ÙƒØªÙ…Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹"}),o.jsx("p",{className:"text-sm",children:"Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© Ù‡Ù†Ø§ Ø¹Ù†Ø¯ Ø¥Ù†Ù‡Ø§Ø¦Ù‡Ø§"})]})]}),o.jsx("div",{className:"flex justify-end mt-6",children:o.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"Ø¥ØºÙ„Ø§Ù‚"})})]})})})]})},co=({onClose:t,onSave:e,initialData:n,type:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=V.useState({[s==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[f,u]=V.useState({});Mn.useEffect(()=>{n&&d(n)},[n]);const m=E=>{const{name:S,value:R}=E.target;d(P=>({...P,[S]:S==="amount"?parseFloat(R)||0:R})),f[S]&&u(P=>({...P,[S]:""}))},p=()=>{const E={};return c[s==="toMe"?"debtor":"creditor"]||(E[s==="toMe"?"debtor":"creditor"]="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†/Ø§Ù„Ø¯Ø§Ø¦Ù† Ù…Ø·Ù„ÙˆØ¨"),c.amount<=0&&(E.amount="Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±"),c.description.trim()||(E.description="ÙˆØµÙ Ø§Ù„Ø¯ÙŠÙ† Ù…Ø·Ù„ÙˆØ¨"),c.date||(E.date="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙŠÙ† Ù…Ø·Ù„ÙˆØ¨"),u(E),Object.keys(E).length===0},h=E=>{E.preventDefault(),p()&&e(c,n==null?void 0:n.id)},y=s==="toMe";return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:t,children:o.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:E=>E.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:y?"Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ù„ÙŠ":"Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„ÙŠ"}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600",children:o.jsx(St,{})})]}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:y?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:y?"Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†":"Ø§Ø³Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†"}),o.jsx("input",{type:"text",id:y?"debtor":"creditor",name:y?"debtor":"creditor",value:c[y?"debtor":"creditor"],onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:y?"Ø§Ø³Ù… Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ÙŠØ¯ÙŠÙ† Ù„ÙŠ":"Ø§Ø³Ù… Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ Ø£Ø¯ÙŠÙ† Ù„Ù‡",required:!0}),f[y?"debtor":"creditor"]&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f[y?"debtor":"creditor"]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("input",{type:"number",id:"amount",name:"amount",value:c.amount,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),f.amount&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.amount})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:y?"Ù…Ù† Ø£ÙŠÙ† Ø¯ÙŠÙ†Ù†ÙŠ":"Ø£ÙŠÙ† Ø£Ø¶ÙØª Ø§Ù„Ø¯ÙŠÙ†"}),o.jsx("input",{type:"text",id:"source",name:"source",value:c.source,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:y?"Ù…Ø«Ø§Ù„: Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠØŒ ØªØ·Ø¨ÙŠÙ‚ Ø³ØªÙˆØ±":"Ù…Ø«Ø§Ù„: Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠØŒ ØªØ·Ø¨ÙŠÙ‚ ØªØ§Ø¨ÙŠ"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ø³Ø¨Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),o.jsx("textarea",{id:"reason",name:"reason",value:c.reason,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Ø³Ø¨Ø¨ Ø§Ù„Ø¯ÙŠÙ† Ø£Ùˆ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©..."})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"ÙˆØµÙ Ø§Ù„Ø¯ÙŠÙ†"}),o.jsx("input",{type:"text",id:"description",name:"description",value:c.description,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ø¯ÙŠÙ†",required:!0}),f.description&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.description})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙŠÙ†"}),o.jsx("input",{type:"date",id:"date",name:"date",value:c.date,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),f.date&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.date})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),o.jsxs("select",{id:"status",name:"status",value:c.status,onChange:m,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"pending",children:"Ù…Ø¹Ù„Ù‚"}),o.jsx("option",{value:"partial",children:"Ø¬Ø²Ø¦ÙŠ"}),o.jsx("option",{value:"paid",children:"Ù…Ø¯ÙÙˆØ¹"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"Ø¥Ù„ØºØ§Ø¡"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ†"})]})]})]})})})},of=({state:t,setState:e,setModal:n,openLoanFormModal:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=V.useState("loans"),[f,u]=V.useState(!1),[m,p]=V.useState(!1),[h,y]=V.useState(!1),E=v=>{switch(v){case"car":return"ðŸš—";case"house":return"ðŸ ";case"personal":return"ðŸ‘¤";case"business":return"ðŸ’¼";case"education":return"ðŸŽ“";default:return"ðŸ’°"}},S=v=>{switch(v){case"car":return"Ø³ÙŠØ§Ø±Ø©";case"house":return"Ø¨ÙŠØª";case"personal":return"Ø´Ø®ØµÙŠ";case"business":return"ØªØ¬Ø§Ø±ÙŠ";case"education":return"ØªØ¹Ù„ÙŠÙ…ÙŠ";default:return"Ø£Ø®Ø±Ù‰"}},R=v=>{switch(v){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},P=v=>{switch(v){case"active":return"Ù†Ø´Ø·";case"completed":return"Ù…ÙƒØªÙ…Ù„";case"defaulted":return"Ù…ØªØ£Ø®Ø±";case"pending":return"Ù…Ø¹Ù„Ù‚";case"partial":return"Ø¬Ø²Ø¦ÙŠ";case"paid":return"Ù…Ø¯ÙÙˆØ¹";default:return"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}},F=v=>{e(j=>({...j,loans:Object.fromEntries(Object.entries(j.loans).filter(([O])=>O!==v))}))},k=v=>{const j={...v,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(O=>({...O,debtsToMe:{...O.debtsToMe,[j.id]:j}})),p(!1),n({show:!0,title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­",body:`<p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ù…Ù† "${j.debtor}" Ø¨Ù‚ÙŠÙ…Ø© ${se(j.amount)} Ø±ÙŠØ§Ù„.</p>`,hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"})},C=v=>{const j={...v,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(O=>({...O,debtsFromMe:{...O.debtsFromMe,[j.id]:j}})),y(!1),n({show:!0,title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ø¨Ù†Ø¬Ø§Ø­",body:`<p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙŠÙ† Ù„Ù€ "${j.creditor}" Ø¨Ù‚ÙŠÙ…Ø© ${se(j.amount)} Ø±ÙŠØ§Ù„.</p>`,hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"})},T=v=>{e(j=>({...j,debtsToMe:Object.fromEntries(Object.entries(j.debtsToMe).filter(([O])=>O!==v))}))},M=v=>{e(j=>({...j,debtsFromMe:Object.fromEntries(Object.entries(j.debtsFromMe).filter(([O])=>O!==v))}))},A=Object.values(t.loans).filter(v=>v.status==="active").length,L=Object.values(t.debtsToMe).filter(v=>v.status!=="paid").length,D=Object.values(t.debtsFromMe).filter(v=>v.status!=="paid").length;return o.jsxs("div",{className:"space-y-6 animate-fade-in",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"ðŸ“Š Ø§Ù„Ø¯ÙŠÙˆÙ† ÙˆØ§Ù„Ù‚Ø±ÙˆØ¶"})}),o.jsxs("div",{className:"flex space-x-1 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[o.jsxs("button",{onClick:()=>d("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${c==="loans"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["ðŸ¦ Ø§Ù„Ù‚Ø±ÙˆØ¶ (",A,")"]}),o.jsxs("button",{onClick:()=>d("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${c==="debts-to-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["ðŸ’° Ø§Ù„Ø¯ÙŠÙˆÙ† Ù„ÙŠ (",L,")"]}),o.jsxs("button",{onClick:()=>d("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${c==="debts-from-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["ðŸ’¸ Ø§Ù„Ø¯ÙŠÙˆÙ† Ø¹Ù„ÙŠ (",D,")"]})]}),c==="loans"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Ø§Ù„Ù‚Ø±ÙˆØ¶ Ø§Ù„ÙƒØ¨ÙŠØ±Ø©"}),o.jsx("button",{onClick:()=>s(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ Ø¥Ø¶Ø§ÙØ© Ù‚Ø±Ø¶"})]}),Object.keys(t.loans).length===0?o.jsxs("div",{className:"text-center py-12 text-slate-500",children:[o.jsx("div",{className:"text-6xl mb-4",children:"ðŸ¦"}),o.jsx("p",{className:"text-lg",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø±ÙˆØ¶ Ù…Ø³Ø¬Ù„Ø©"}),o.jsx("p",{className:"text-sm",children:'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù‚Ø±Ø¶" Ù„Ø¨Ø¯Ø¡ Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø±ÙˆØ¶Ùƒ'})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(t.loans).map(v=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-blue-600 text-xl",children:E(v.type)})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:v.name}),o.jsxs("p",{className:"text-sm text-slate-500",children:[S(v.type)," - ",v.lender]})]})]}),o.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[o.jsx("button",{onClick:()=>s(v.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø±Ø¶ ${v.name}`,children:"âœï¸"}),o.jsx("button",{onClick:()=>F(v.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`Ø­Ø°Ù Ù‚Ø±Ø¶ ${v.name}`,children:o.jsx(at,{})})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),o.jsx("p",{className:"text-xl font-bold text-blue-900",children:se(v.totalAmount)})]}),(v.prepaidAmount||0)>0&&o.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[o.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[o.jsx("span",{className:"font-medium text-slate-700",children:"Ø§Ù„ØªÙ‚Ø¯Ù…"}),o.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((v.prepaidAmount||0)/v.totalAmount*100),"%"]})]}),o.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:o.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(v.prepaidAmount||0)/v.totalAmount*100}%`}})}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[o.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[o.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((v.prepaidAmount||0)/v.monthlyPayment)}),o.jsx("p",{className:"text-green-600 text-xs",children:"Ù…Ø¯ÙÙˆØ¹"})]}),o.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[o.jsx("p",{className:"text-blue-700 font-bold text-sm",children:v.totalMonths-Math.floor((v.prepaidAmount||0)/v.monthlyPayment)}),o.jsx("p",{className:"text-blue-600 text-xs",children:"Ù…ØªØ¨Ù‚ÙŠ"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ"}),o.jsx("p",{className:"font-semibold text-slate-800",children:se(v.monthlyPayment)})]}),o.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©"}),o.jsxs("p",{className:"font-semibold text-slate-800",children:[v.remainingMonths||0," Ø´Ù‡Ø±"]})]})]}),(v.prepaidAmount||0)>0&&o.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"Ù…Ø¯ÙÙˆØ¹ Ù…Ø³Ø¨Ù‚Ø§Ù‹"}),o.jsx("p",{className:"text-orange-900 font-bold text-lg",children:se(v.prepaidAmount||0)})]}),o.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"Ø§Ù„Ù‚Ø³Ø· Ø§Ù„ØªØ§Ù„ÙŠ"}),o.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(v.status)}`,children:P(v.status)}),o.jsxs("span",{className:"text-xs text-slate-500",children:["Ø¨Ø¯Ø£ ÙÙŠ: ",new Date(v.startDate).toLocaleDateString("en-GB")]})]})]})]},v.id))})]}),c==="debts-to-me"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Ø§Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„ÙŠ"}),o.jsx("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ù„ÙŠ"})]}),Object.keys(t.debtsToMe).length===0?o.jsxs("div",{className:"text-center py-12 text-slate-500",children:[o.jsx("div",{className:"text-6xl mb-4",children:"ðŸ’°"}),o.jsx("p",{className:"text-lg",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…Ø³ØªØ­Ù‚Ø© Ù„Ùƒ"}),o.jsx("p",{className:"text-sm",children:'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ù„ÙŠ" Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ù„Ùƒ'})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(t.debtsToMe).map(v=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:v.debtor}),o.jsx("p",{className:"text-sm text-slate-500",children:v.description})]}),o.jsx("button",{onClick:()=>T(v.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`Ø­Ø°Ù Ø¯ÙŠÙ† ${v.debtor}`,children:o.jsx(at,{})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚"}),o.jsx("p",{className:"text-xl font-bold text-green-900",children:se(v.amount)})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(v.status)}`,children:P(v.status)}),o.jsxs("span",{className:"text-xs text-slate-500",children:["ØªØ§Ø±ÙŠØ®: ",new Date(v.date).toLocaleDateString("ar-SA")]})]})]})]},v.id))})]}),c==="debts-from-me"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Ø§Ù„Ø¯ÙŠÙˆÙ† Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ø¹Ù„ÙŠ"}),o.jsx("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„ÙŠ"})]}),Object.keys(t.debtsFromMe).length===0?o.jsxs("div",{className:"text-center py-12 text-slate-500",children:[o.jsx("div",{className:"text-6xl mb-4",children:"ðŸ’¸"}),o.jsx("p",{className:"text-lg",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙŠÙˆÙ† Ù…Ø³ØªØ­Ù‚Ø© Ø¹Ù„ÙŠÙƒ"}),o.jsx("p",{className:"text-sm",children:'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ø¯ÙŠÙ† Ø¹Ù„ÙŠ" Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø© Ø¹Ù„ÙŠÙƒ'})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(t.debtsFromMe).map(v=>o.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:v.creditor}),o.jsx("p",{className:"text-sm text-slate-500",children:v.description})]}),o.jsx("button",{onClick:()=>M(v.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`Ø­Ø°Ù Ø¯ÙŠÙ† ${v.creditor}`,children:o.jsx(at,{})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[o.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚"}),o.jsx("p",{className:"text-xl font-bold text-red-900",children:se(v.amount)})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(v.status)}`,children:P(v.status)}),o.jsxs("span",{className:"text-xs text-slate-500",children:["ØªØ§Ø±ÙŠØ®: ",new Date(v.date).toLocaleDateString("ar-SA")]})]})]})]},v.id))})]}),m&&o.jsx(co,{onClose:()=>p(!1),onSave:k,type:"toMe"}),h&&o.jsx(co,{onClose:()=>y(!1),onSave:C,type:"fromMe"})]})},rf=({state:t,setState:e,setModal:n,setLoading:s,onRestore:i,darkMode:l=!1,language:c="ar",onSaveToCloud:d,onRestoreFromCloud:f,onDownloadBackup:u,onRestoreFromFile:m})=>{const[p,h]=V.useState(Be()),[y,E]=V.useState({connected:!1}),[S,R]=V.useState(!0),[P,F]=V.useState({firebase:p.hasFirebase,gemini:p.hasGemini});V.useEffect(()=>{const K=Be();h(K),F({firebase:K.hasFirebase,gemini:K.hasGemini}),K.hasFirebase?(async()=>{try{R(!0);const me=await Ee.getData("test","connection");E({connected:!0})}catch(me){E({connected:!1,error:me instanceof Error?me.message:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„"})}finally{R(!1)}})():(E({connected:!1,error:"Ù…ÙØ§ØªÙŠØ­ Firebase ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©"}),R(!1))},[]);const k=({isValid:K})=>K?o.jsx(xn,{className:"w-6 h-6 text-green-500"}):o.jsx(yn,{className:"w-6 h-6 text-red-500"}),C=()=>o.jsx(Fu,{className:"w-6 h-6 text-yellow-500"}),[T,M]=V.useState({name:"",icon:""}),[A,L]=V.useState(null),[D,v]=V.useState({name:"",icon:""}),[j,O]=V.useState({name:"",icon:""}),ne=()=>{if(!T.name.trim()||!T.icon.trim()){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}const te={id:`cat-${Date.now()}`,name:T.name.trim(),icon:T.icon.trim()};e(me=>({...me,categories:[...me.categories,te]})),M({name:"",icon:""}),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})},[he,le]=V.useState(!1),ce=async()=>{const K=T.name.trim();if(!K){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}le(!0);try{const{suggestCategoryIcon:te,initializeAi:me}=await Le(async()=>{const{suggestCategoryIcon:Oe,initializeAi:ut}=await Promise.resolve().then(()=>vu);return{suggestCategoryIcon:Oe,initializeAi:ut}},void 0);me();const Je=await te(K);Je&&Je.trim()?M(Oe=>({...Oe,icon:Je.trim()})):n({title:B("error",c),body:`<p>${B("unknown.error",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}catch(te){console.error("Icon suggestion error:",te),n({title:B("error",c),body:`<p>${B("try.again",c)}</p><p>${B("details",c)}: ${te.message}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}finally{le(!1)}},W=K=>{t.transactions.some(te=>te.categoryId===K)?n({title:B("cannot.delete",c),body:`<p>${B("cannot.delete.category",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}):(e(te=>({...te,categories:te.categories.filter(me=>me.id!==K)})),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}))},[re,xe]=V.useState(!1),pe=async()=>{const K=D.name.trim();if(!K){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}try{xe(!0);const te=await Rn(K);te&&te.trim()?v(me=>({...me,icon:te.trim()})):n({title:B("error",c),body:`<p>${B("unknown.error",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}catch(te){console.error("Transaction type icon suggestion error:",te),n({title:B("error",c),body:`<p>${B("try.again",c)}</p><p>${B("details",c)}: ${te.message}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}finally{xe(!1)}},[Ce,je]=V.useState(!1),He=async()=>{const K=j.name.trim();if(!K){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}try{je(!0);const te=await Rn(K);te&&te.trim()?O(me=>({...me,icon:te.trim()})):n({title:B("error",c),body:`<p>${B("unknown.error",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}catch(te){console.error("Payment method icon suggestion error:",te),n({title:B("error",c),body:`<p>${B("try.again",c)}</p><p>${B("details",c)}: ${te.message}</p>`,hideCancel:!0,confirmText:B("confirm",c)})}finally{je(!1)}},Ke=()=>{if(!D.name.trim()||!D.icon.trim()){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}const te={id:`custom-type-${Date.now()}`,name:D.name.trim(),icon:D.icon.trim(),isCustom:!0};e(me=>({...me,customTransactionTypes:[...me.customTransactionTypes||[],te]})),v({name:"",icon:""}),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})},Xe=K=>{t.transactions.some(te=>te.type===K)?n({title:B("cannot.delete",c),body:`<p>${B("cannot.delete.transaction.type",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}):(e(te=>({...te,customTransactionTypes:(te.customTransactionTypes||[]).filter(me=>me.id!==K)})),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}))},Qe=()=>{if(!j.name.trim()||!j.icon.trim()){n({title:B("error",c),body:`<p>${B("required.field",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)});return}const te={id:`custom-payment-${Date.now()}`,name:j.name.trim(),icon:j.icon.trim(),isCustom:!0};e(me=>({...me,customPaymentMethods:[...me.customPaymentMethods||[],te]})),O({name:"",icon:""}),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)})},Ie=K=>{t.transactions.some(te=>te.paymentMethod===K)?n({title:B("cannot.delete",c),body:`<p>${B("cannot.delete.payment.method",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}):(e(te=>({...te,customPaymentMethods:(te.customPaymentMethods||[]).filter(me=>me.id!==K)})),n({title:B("success",c),body:`<p>${B("success",c)}</p>`,hideCancel:!0,confirmText:B("confirm",c)}))};return o.jsxs("div",{className:"space-y-6 animate-fade-in",children:[o.jsx("div",{className:"flex justify-between items-center",children:o.jsxs("h2",{className:`text-2xl font-bold ${l?"text-slate-200":"text-slate-900"}`,children:["âš™ï¸ ",B("settings",c)]})}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsxs("h3",{className:`text-lg font-bold mb-4 ${l?"text-slate-200":"text-slate-900"}`,children:["ðŸ”‘ ",B("api.status",c)]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${l?"bg-slate-700":"bg-slate-50"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"text-2xl",children:"ðŸ”¥"}),o.jsxs("div",{children:[o.jsx("h4",{className:`font-semibold ${l?"text-slate-200":"text-slate-800"}`,children:"Firebase Configuration"}),o.jsxs("p",{className:`text-sm ${l?"text-slate-400":"text-slate-600"}`,children:["Project ID: ",be.firebase.projectId]})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:P.firebase?y.connected?o.jsxs(o.Fragment,{children:[o.jsx(xn,{className:"w-6 h-6 text-green-500"}),o.jsx("span",{className:"text-sm text-green-600",children:"Ù…ØªØµÙ„"})]}):o.jsxs(o.Fragment,{children:[o.jsx(C,{}),o.jsx("span",{className:"text-sm text-yellow-600",children:"Ù…ÙØ§ØªÙŠØ­ Ù…ÙˆØ¬ÙˆØ¯Ø© Ù„ÙƒÙ† ØºÙŠØ± Ù…ØªØµÙ„"})]}):o.jsxs(o.Fragment,{children:[o.jsx(yn,{className:"w-6 h-6 text-red-500"}),o.jsx("span",{className:"text-sm text-red-600",children:"Ù…ÙØ§ØªÙŠØ­ ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©"})]})})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"text-2xl",children:"ðŸ¤–"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),o.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",be.gemini.model]})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:P.gemini?o.jsxs(o.Fragment,{children:[o.jsx(xn,{className:"w-6 h-6 text-green-500"}),o.jsx("span",{className:"text-sm text-green-600",children:"Ù…ÙØ¹Ø¯"})]}):o.jsxs(o.Fragment,{children:[o.jsx(yn,{className:"w-6 h-6 text-red-500"}),o.jsx("span",{className:"text-sm text-red-600",children:"ØºÙŠØ± Ù…ÙØ¹Ø¯"})]})})]})]}),!p.isValid&&o.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[o.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"âš ï¸ ØªØ­Ø°ÙŠØ±Ø§Øª:"}),o.jsx("ul",{className:"space-y-1",children:p.errors.map((K,te)=>o.jsxs("li",{className:"text-sm text-red-600",children:["â€¢ ",K]},te))})]})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"}),o.jsx("p",{className:"font-semibold text-slate-800",children:be.app.name})]}),o.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Ø§Ù„Ø¥ØµØ¯Ø§Ø±"}),o.jsx("p",{className:"font-semibold text-slate-800",children:be.app.version})]}),o.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Ø§Ù„Ø¨ÙŠØ¦Ø©"}),o.jsx("p",{className:"font-semibold text-slate-800",children:be.app.environment})]}),o.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(k,{isValid:p.isValid&&y.connected}),o.jsx("span",{className:`text-sm font-semibold ${p.isValid&&y.connected?"text-green-600":"text-red-600"}`,children:p.isValid&&y.connected?"Ø¬Ø§Ù‡Ø²":"ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø¯Ø§Ø¯"})]})]}),o.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"ØªØ·ÙˆÙŠØ±"}),o.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!p.isValid||!y.connected)&&o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯"}),o.jsxs("div",{className:"space-y-4",children:[!P.gemini&&o.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"ðŸ¤– Ø¥Ø¹Ø¯Ø§Ø¯ Gemini API:"}),o.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[o.jsxs("li",{children:["Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ",o.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),o.jsx("li",{children:"Ø£Ù†Ø´Ø¦ Ù…ÙØªØ§Ø­ API Ø¬Ø¯ÙŠØ¯"}),o.jsxs("li",{children:["Ø£Ø¶Ù Ø§Ù„Ù…ÙØªØ§Ø­ ÙƒÙ€ GitHub Secret Ø¨Ø§Ø³Ù… ",o.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),o.jsxs("li",{children:["Ø£Ùˆ Ø¶Ø¹Ù‡ ÙÙŠ Ù…Ù„Ù ",o.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," Ù„Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø­Ù„ÙŠ"]})]})]}),!P.firebase&&o.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"ðŸ”¥ Ø¥Ø¹Ø¯Ø§Ø¯ Firebase:"}),o.jsxs("p",{className:"text-sm text-blue-700",children:["ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ù…ÙØ§ØªÙŠØ­ Firebase ÙƒÙ€ GitHub Secrets:",o.jsx("br",{}),"â€¢ VITE_FIREBASE_API_KEY",o.jsx("br",{}),"â€¢ VITE_FIREBASE_AUTH_DOMAIN",o.jsx("br",{}),"â€¢ VITE_FIREBASE_PROJECT_ID",o.jsx("br",{}),"â€¢ VITE_FIREBASE_STORAGE_BUCKET",o.jsx("br",{}),"â€¢ VITE_FIREBASE_MESSAGING_SENDER_ID",o.jsx("br",{}),"â€¢ VITE_FIREBASE_APP_ID"]})]})]})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ“‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ¦Ø§Øª"}),o.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"âž• Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©",value:T.name,onChange:K=>M(te=>({...te,name:K.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© (Ù…Ø«Ù„: ðŸ”)",value:T.icon,onChange:K=>M(te=>({...te,icon:K.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{type:"button",onClick:ce,disabled:!T.name.trim()||he,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"Ø§Ù‚ØªØ±Ø§Ø­ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",children:he?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"ðŸ¤–"})]})]}),o.jsx("button",{onClick:ne,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"âž• Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø©"})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:t.categories.map(K=>o.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:K.icon}),o.jsx("span",{className:"text-sm font-medium text-slate-800",children:K.name})]}),o.jsx("button",{onClick:()=>W(K.id),className:"text-red-500 hover:text-red-700 text-sm",title:"Ø­Ø°Ù Ø§Ù„ÙØ¦Ø©",children:"ðŸ—‘ï¸"})]},K.id))})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"âš™ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª ÙˆÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¯ÙØ¹"}),o.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"ðŸ“ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø®ØµØµØ©"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ© (Ù…Ø«Ù„: Ø³Ø­Ø¨ Ù†Ù‚Ø¯ÙŠ)",value:D.name,onChange:K=>v(te=>({...te,name:K.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© (Ù…Ø«Ù„: ðŸ’¸)",value:D.icon,onChange:K=>v(te=>({...te,icon:K.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{type:"button",onClick:pe,disabled:!D.name.trim()||re,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"Ø§Ù‚ØªØ±Ø§Ø­ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",children:re?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"ðŸ¤–"}),o.jsx("button",{onClick:Ke,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"âž• Ø¥Ø¶Ø§ÙØ©"})]})]}),o.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(t.customTransactionTypes||[]).map(K=>o.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm",children:K.icon}),o.jsx("span",{className:"text-xs font-medium text-slate-800",children:K.name})]}),o.jsx("button",{onClick:()=>Xe(K.id),className:"text-red-500 hover:text-red-700 text-xs",title:"Ø­Ø°Ù Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©",children:"ðŸ—‘ï¸"})]},K.id))})]}),o.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"ðŸ’³ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø®ØµØµØ©"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ø³Ù… ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹ (Ù…Ø«Ù„: PayPal)",value:j.name,onChange:K=>O(te=>({...te,name:K.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© (Ù…Ø«Ù„: ðŸ’³)",value:j.icon,onChange:K=>O(te=>({...te,icon:K.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx("button",{type:"button",onClick:He,disabled:!j.name.trim()||Ce,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"Ø§Ù‚ØªØ±Ø§Ø­ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",children:Ce?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"ðŸ¤–"}),o.jsx("button",{onClick:Qe,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"âž• Ø¥Ø¶Ø§ÙØ©"})]})]}),o.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(t.customPaymentMethods||[]).map(K=>o.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm",children:K.icon}),o.jsx("span",{className:"text-xs font-medium text-slate-800",children:K.name})]}),o.jsx("button",{onClick:()=>Ie(K.id),className:"text-red-500 hover:text-red-700 text-xs",title:"Ø­Ø°Ù ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹",children:"ðŸ—‘ï¸"})]},K.id))})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"ðŸ“‹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’° Ø¯Ø®Ù„"}),o.jsx("span",{className:"text-blue-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’¸ Ù…ØµØ§Ø±ÙŠÙ"}),o.jsx("span",{className:"text-blue-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ“± Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·"}),o.jsx("span",{className:"text-blue-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’¹ Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"}),o.jsx("span",{className:"text-blue-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’¹ Ø³Ø­Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"}),o.jsx("span",{className:"text-blue-600",children:"Ù…Ø¯Ù…Ø¬"})]})]})]}),o.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[o.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"ðŸ’³ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’µ Ù†Ù‚Ø¯ÙŠ"}),o.jsx("span",{className:"text-green-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ“± ØªØ§Ø¨ÙŠ"}),o.jsx("span",{className:"text-green-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ“± ØªÙ…Ø§Ø±Ø§"}),o.jsx("span",{className:"text-green-600",children:"Ù…Ø¯Ù…Ø¬"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"ðŸ’³ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª"}),o.jsx("span",{className:"text-green-600",children:"Ù…Ø¯Ù…Ø¬"})]})]})]})]})]}),o.jsxs("div",{className:"glass-card p-6",children:[o.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"ðŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©"}),o.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6 text-sm",children:"Ø§Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø£Ùˆ Ø§Ø³ØªØ¹Ø¯Ù‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("button",{onClick:u,className:"btn btn-primary flex flex-col items-center justify-center p-4 h-24",children:[o.jsx("span",{className:"text-2xl mb-2",children:"ðŸ’¾"}),o.jsx("span",{className:"font-semibold",children:"ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù"})]}),o.jsxs("button",{onClick:d,className:"btn btn-secondary flex flex-col items-center justify-center p-4 h-24",children:[o.jsx("span",{className:"text-2xl mb-2",children:"â˜ï¸"}),o.jsx("span",{className:"font-semibold",children:"Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"})]}),o.jsxs("label",{className:"btn btn-secondary flex flex-col items-center justify-center p-4 h-24 cursor-pointer",children:[o.jsx("span",{className:"text-2xl mb-2",children:"ðŸ“¤"}),o.jsx("span",{className:"font-semibold",children:"Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…Ù† Ù…Ù„Ù"}),o.jsx("input",{type:"file",accept:".json",className:"hidden",onChange:m})]}),o.jsxs("button",{onClick:f,className:"btn btn-info flex flex-col items-center justify-center p-4 h-24",style:{backgroundColor:"#0ea5e9",color:"#fff"},children:[o.jsx("span",{className:"text-2xl mb-2",children:"â˜ï¸"}),o.jsx("span",{className:"font-semibold",children:"Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©"})]})]}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"ðŸ’¡ Ù†ØµØ§Ø¦Ø­ Ù…Ù‡Ù…Ø©:"}),o.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[o.jsx("li",{children:"â€¢ Ø§Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ø§Ù†ØªØ¸Ø§Ù… Ù„ØªØ¬Ù†Ø¨ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"}),o.jsx("li",{children:"â€¢ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© Ù…ØªØ§Ø­Ø© Ù…Ù† Ø£ÙŠ Ø¬Ù‡Ø§Ø²"}),o.jsx("li",{children:"â€¢ Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©"})]})]})]}),o.jsx("div",{className:"text-center",children:o.jsx("button",{onClick:()=>{h(Be()),window.location.reload()},disabled:S,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:S?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...":"ðŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù‚Ù‚"})})]})},af=({onClose:t,onSave:e,initialData:n,categories:s,cards:i,bankAccounts:l,loans:c,setModalConfig:d,darkMode:f=!1,language:u="ar"})=>{var ce;const[m,p]=V.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((ce=s.find(W=>W.name==="Ø£Ø®Ø±Ù‰"))==null?void 0:ce.id)||null}),[h,y]=V.useState(!1),[E,S]=V.useState(""),[R,P]=V.useState({isOpen:!1,text:""}),[F,k]=V.useState(!1),[C,T]=V.useState(!1),[M,A]=V.useState(4),[L,D]=V.useState(Object.keys(l)[0]||"cash");V.useEffect(()=>{var W;n?p(n):(W=navigator.clipboard)!=null&&W.readText&&(async()=>{try{const re=await navigator.clipboard.readText();re&&re.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==re&&P({isOpen:!0,text:re})}catch{console.info("Clipboard read access denied or not supported.")}})()},[n]);const v=W=>{const{name:re,value:xe}=W.target;if(re==="paymentMethod"){const pe=xe.includes("bnpl");T(pe),pe&&p(Ce=>({...Ce,type:"expense"}))}p(pe=>({...pe,[re]:re==="amount"?parseFloat(xe):xe}))},j=W=>{if(W.preventDefault(),m.type==="income"&&Object.keys(c).length>0&&Object.values(c).filter(xe=>xe.status==="active").length>0){k(!0);return}C&&m.paymentMethod.includes("bnpl")?e({...m,bnplData:{installmentsCount:M,initialPaymentSource:L,installmentAmount:m.amount/M}},n==null?void 0:n.id):e(m,n==null?void 0:n.id)},O=async W=>{if(W.trim()){y(!0),S("");try{const re=await Bo(W,s,i,l),xe=JSON.parse(re);xe.error?S(xe.error):p(pe=>({...pe,amount:xe.amount||pe.amount,date:xe.date||pe.date,description:xe.merchant||pe.description,paymentMethod:xe.paymentMethod||pe.paymentMethod,categoryId:xe.categoryId||pe.categoryId}))}catch(re){S(re instanceof Error?re.message:B("unknown.error",u)),console.error(re)}finally{y(!1)}}},ne=async()=>{S("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){S("ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©. Ù„ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ù…ØªØµÙØ­Ùƒ ÙˆØ§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©.");return}const W=await navigator.clipboard.readText();W&&W.trim().length>0?O(W):S("Ø§Ù„Ø­Ø§ÙØ¸Ø© ÙØ§Ø±ØºØ©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù†Ø³Ø® Ù†Øµ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹.")}catch(W){console.error("Clipboard operation failed: ",W),S("ÙØ´Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©. ÙŠØ±Ø¬Ù‰ Ù…Ù†Ø­ Ø§Ù„Ø¥Ø°Ù† Ø¹Ù†Ø¯ Ø·Ù„Ø¨Ù‡ØŒ Ø£Ùˆ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­.")}},he=V.useMemo(()=>{const W=[{value:"cash",label:"ðŸ’µ Ù†Ù‚Ø¯ÙŠ"}];return Object.values(l).forEach(re=>W.push({value:re.id,label:`ðŸ¦ ${re.name}`})),Object.values(i).forEach(re=>W.push({value:re.id,label:`ðŸ’³ ${re.name}`})),W.push({value:"tabby-bnpl",label:"ðŸ“± ØªØ§Ø¨ÙŠ"}),W.push({value:"tamara-bnpl",label:"ðŸ“± ØªÙ…Ø§Ø±Ø§"}),W},[l,i]),le=V.useMemo(()=>{const W=[{value:"expense",label:"ðŸ’¸ Ù…ØµØ§Ø±ÙŠÙ"},{value:"income",label:"ðŸ’° Ø¯Ø®Ù„"},{value:"bnpl-payment",label:"ðŸ“± Ø³Ø¯Ø§Ø¯ Ù‚Ø³Ø·"},{value:"investment-deposit",label:"ðŸ’¹ Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"},{value:"investment-withdrawal",label:"ðŸ’¹ Ø³Ø­Ø¨ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ"}];return Object.values(i).forEach(re=>W.push({value:`${re.id}-payment`,label:`ðŸ’³ Ø³Ø¯Ø§Ø¯ ${re.name}`})),W},[i]);return o.jsxs(o.Fragment,{children:[R.isOpen&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>P({isOpen:!1,text:""}),children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:W=>W.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Ø§ÙƒØªØ´Ø§Ù Ù†Øµ ÙÙŠ Ø§Ù„Ø­Ø§ÙØ¸Ø©"}),o.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"ÙˆØ¬Ø¯Ù†Ø§ Ù†ØµØ§Ù‹ ÙÙŠ Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù†ØµÙˆØµ. Ù‡Ù„ ØªÙˆØ¯ Ù„ØµÙ‚Ù‡ ÙˆØªØ­Ù„ÙŠÙ„Ù‡ Ù„ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ØŸ"}),o.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:R.text}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",R.text),P({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"ØªØ¬Ø§Ù‡Ù„"}),o.jsx("button",{onClick:()=>{P({isOpen:!1,text:""}),O(R.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Ù„ØµÙ‚ ÙˆØªØ­Ù„ÙŠÙ„"})]})]})})}),o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:W=>W.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:n?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ©":"Ø¥Ø¶Ø§ÙØ© Ø­Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©"}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600",children:o.jsx(St,{})})]}),o.jsxs("button",{type:"button",onClick:ne,disabled:h,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[o.jsx(Ru,{}),o.jsx("span",{children:"Ù„ØµÙ‚ ÙˆØªØ­Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø©"})]}),h&&o.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[o.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),o.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„..."})]}),E&&o.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:E}),o.jsxs("form",{onSubmit:j,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"amount",className:"form-label",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("input",{type:"number",name:"amount",value:m.amount,onChange:v,className:"w-full",required:!0,step:"0.01"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"date",className:"form-label",children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),o.jsx("input",{type:"date",name:"date",value:m.date,onChange:v,className:"w-full",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"description",className:"form-label",children:"Ø§Ù„ÙˆØµÙ"}),o.jsx("input",{type:"text",name:"description",value:m.description,onChange:v,className:"w-full",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"type",className:"form-label",children:"Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©"}),o.jsx("select",{name:"type",value:m.type,onChange:v,className:"w-full",children:le.map(W=>o.jsx("option",{value:W.value,children:W.label},W.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹"}),o.jsx("select",{name:"paymentMethod",value:m.paymentMethod,onChange:v,className:"w-full",children:he.map(W=>o.jsx("option",{value:W.value,children:W.label},W.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"Ø§Ù„ÙØ¦Ø©"}),o.jsxs("select",{name:"categoryId",value:m.categoryId||"",onChange:v,className:"w-full",children:[o.jsx("option",{value:"",children:"-- Ø§Ø®ØªØ± ÙØ¦Ø© --"}),s.map(W=>o.jsxs("option",{value:W.id,children:[W.icon," ",W.name]},W.id))]})]}),C&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[o.jsx("h3",{className:"font-semibold text-blue-800",children:"ðŸ“± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ‚Ø³ÙŠØ·"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"}),o.jsxs("select",{value:M,onChange:W=>A(parseInt(W.target.value)),className:"w-full",children:[o.jsx("option",{value:2,children:"Ù‚Ø³Ø·ÙŠÙ† (2)"}),o.jsx("option",{value:3,children:"3 Ø£Ù‚Ø³Ø§Ø·"}),o.jsx("option",{value:4,children:"4 Ø£Ù‚Ø³Ø§Ø·"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"Ù…ØµØ¯Ø± Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰"}),o.jsx("select",{value:L,onChange:W=>D(W.target.value),className:"w-full",children:he.filter(W=>!W.value.includes("bnpl")).map(W=>o.jsx("option",{value:W.value,children:W.label},W.value))})]})]}),o.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:o.jsxs("p",{className:"text-sm text-blue-700",children:[o.jsx("strong",{children:"Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰:"})," ",(m.amount/M).toFixed(2)," Ø±ÙŠØ§Ù„",o.jsx("br",{}),o.jsx("strong",{children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:"})," ",(m.amount*(M-1)/M).toFixed(2)," Ø±ÙŠØ§Ù„"]})})]}),o.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:n?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©"})]})]})})}),F&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:W=>W.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Ø®ØµÙ… Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù‚Ø±ÙˆØ¶"}),o.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Ù„Ø¯ÙŠÙƒ Ù‚Ø±ÙˆØ¶ Ù†Ø´Ø·Ø©. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø®ØµÙ… Ø£Ù‚Ø³Ø§Ø·Ù‡Ø§ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§ØªØ¨ØŸ"}),o.jsx("div",{className:"space-y-3 mb-6",children:Object.values(c).filter(W=>W.status==="active").map(W=>o.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:o.jsx("div",{className:"flex justify-between items-center",children:o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-blue-800",children:W.name}),o.jsxs("p",{className:"text-sm text-blue-600",children:["Ø§Ù„Ù‚Ø³Ø·: ",W.monthlyPayment.toLocaleString()," Ø±ÙŠØ§Ù„"]})]})})},W.id))}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>{k(!1),e(m,n==null?void 0:n.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"Ù„Ø§ØŒ Ø­ÙØ¸ Ø§Ù„Ø±Ø§ØªØ¨ ÙÙ‚Ø·"}),o.jsx("button",{onClick:()=>{k(!1);const W=Object.values(c).filter(pe=>pe.status==="active"),re=W.reduce((pe,Ce)=>pe+Ce.monthlyPayment,0),xe={...m};W.map(pe=>({id:`trans-${Date.now()}-loan-${pe.id}`,amount:pe.monthlyPayment,date:m.date,description:`Ù‚Ø³Ø· Ø´Ù‡Ø±ÙŠ - ${pe.name}`,paymentMethod:m.paymentMethod,type:"expense",categoryId:null})),e(xe,n==null?void 0:n.id),d({title:"ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø§ØªØ¨ ÙˆØ®ØµÙ… Ø§Ù„Ø£Ù‚Ø³Ø§Ø·",body:`<p>ØªÙ… Ø®ØµÙ… ${re.toLocaleString()} Ø±ÙŠØ§Ù„ ÙƒØ£Ù‚Ø³Ø§Ø· Ù‚Ø±ÙˆØ¶ Ù…Ù† Ø§Ù„Ø±Ø§ØªØ¨.</p>`,hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Ù†Ø¹Ù…ØŒ Ø®ØµÙ… Ø§Ù„Ø£Ù‚Ø³Ø§Ø·"})]})]})})})]})},lf=({onClose:t,onSave:e,initialData:n,darkMode:s=!1,language:i="ar"})=>{var u;const[l,c]=V.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});V.useEffect(()=>{n&&c(n)},[n]);const d=m=>{const{name:p,value:h,type:y}=m.target;c(p==="smsSamples"?E=>({...E,smsSamples:h.split(",").map(S=>S.trim()).filter(Boolean)}):E=>({...E,[p]:y==="number"?parseFloat(h)||0:h}))},f=m=>{m.preventDefault(),e(l,n==null?void 0:n.id)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:m=>m.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:n?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©":"Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600",children:o.jsx(St,{})})]}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"}),o.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:"w-full p-2",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ÙŠ"}),o.jsx("input",{type:"number",name:"limit",value:l.limit,onChange:d,className:"w-full p-2",required:!0,step:"100"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"ÙŠÙˆÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙƒØ´Ù (Ø´Ù‡Ø±ÙŠØ§Ù‹)"}),o.jsx("input",{type:"number",name:"statementDay",value:l.statementDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"ÙŠÙˆÙ… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ (Ø´Ù‡Ø±ÙŠØ§Ù‹)"}),o.jsx("input",{type:"number",name:"dueDay",value:l.dueDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ (Ø§ÙØµÙ„ Ø¨ÙÙˆØ§ØµÙ„)"}),o.jsx("input",{type:"text",name:"smsSamples",value:((u=l.smsSamples)==null?void 0:u.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"Ù…Ø«Ø§Ù„: SNB, Ø§Ù„Ø£Ù‡Ù„ÙŠ, Ø¥Ø¦ØªÙ…Ø§Ù†ÙŠØ©"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"ÙƒÙ„Ù…Ø§Øª ÙØ±ÙŠØ¯Ø© Ù…Ù† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨Ù†Ùƒ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ù„ØµÙ‚ Ù†Øµ Ø±Ø³Ø§Ù„Ø©."})]}),o.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:n?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"})]})]})})})},cf=({onClose:t,onSave:e,initialData:n,darkMode:s=!1,language:i="ar"})=>{var u;const[l,c]=V.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});V.useEffect(()=>{n&&c(n)},[n]);const d=m=>{const{name:p,value:h,type:y}=m.target;c(p==="smsSamples"?E=>({...E,smsSamples:h.split(",").map(S=>S.trim()).filter(Boolean)}):E=>({...E,[p]:y==="number"?parseFloat(h)||0:h}))},f=m=>{m.preventDefault(),e(l,n==null?void 0:n.id)};return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:m=>m.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:n?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨":"Ø¥Ø¶Ø§ÙØ© Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ"}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600",children:o.jsx(St,{})})]}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨"}),o.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:"w-full p-2",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠ"}),o.jsx("input",{type:"number",name:"balance",value:l.balance,onChange:d,className:"w-full p-2",required:!0,step:"10"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„Ø¹Ù…Ù„Ø©"}),o.jsxs("select",{name:"currency",value:l.currency||"SAR",onChange:d,className:"w-full p-2",required:!0,children:[o.jsx("option",{value:"SAR",children:"ðŸ‡¸ðŸ‡¦ Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ (SAR)"}),o.jsx("option",{value:"AED",children:"ðŸ‡¦ðŸ‡ª Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ (AED)"}),o.jsx("option",{value:"USD",children:"ðŸ‡ºðŸ‡¸ Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ (USD)"}),o.jsx("option",{value:"EUR",children:"ðŸ‡ªðŸ‡º ÙŠÙˆØ±Ùˆ (EUR)"}),o.jsx("option",{value:"GBP",children:"ðŸ‡¬ðŸ‡§ Ø¬Ù†ÙŠÙ‡ Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ (GBP)"}),o.jsx("option",{value:"JOD",children:"ðŸ‡¯ðŸ‡´ Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ (JOD)"}),o.jsx("option",{value:"KWD",children:"ðŸ‡°ðŸ‡¼ Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ (KWD)"}),o.jsx("option",{value:"QAR",children:"ðŸ‡¶ðŸ‡¦ Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ (QAR)"}),o.jsx("option",{value:"BHD",children:"ðŸ‡§ðŸ‡­ Ø¯ÙŠÙ†Ø§Ø± Ø¨Ø­Ø±ÙŠÙ†ÙŠ (BHD)"}),o.jsx("option",{value:"OMR",children:"ðŸ‡´ðŸ‡² Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ (OMR)"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ (Ø§ÙØµÙ„ Ø¨ÙÙˆØ§ØµÙ„)"}),o.jsx("input",{type:"text",name:"smsSamples",value:((u=l.smsSamples)==null?void 0:u.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"Ù…Ø«Ø§Ù„: Alrajhi, Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ, Ù…Ø¯Ù‰"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"ÙƒÙ„Ù…Ø§Øª ÙØ±ÙŠØ¯Ø© Ù…Ù† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨Ù†Ùƒ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ù„ØµÙ‚ Ù†Øµ Ø±Ø³Ø§Ù„Ø©."})]}),o.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:n?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø³Ø§Ø¨"})]})]})})})},df=({onClose:t,onSave:e,initialData:n,bankAccounts:s,darkMode:i=!1,language:l="ar"})=>{const[c,d]=V.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[f,u]=V.useState({});V.useEffect(()=>{n&&d(n)},[n]),V.useEffect(()=>{if(c.totalAmount>0&&c.downPayment>=0&&c.finalPayment>=0&&c.monthlyPayment>0){const S=c.totalAmount-c.downPayment-c.finalPayment-(c.prepaidAmount||0);if(S>0){const R=Math.ceil(S/c.monthlyPayment),P=new Date(c.startDate),F=new Date(P);F.setMonth(F.getMonth()+R),d(k=>({...k,totalMonths:R,endDate:F.toISOString().split("T")[0],remainingMonths:R}))}}},[c.totalAmount,c.downPayment,c.finalPayment,c.monthlyPayment,c.startDate,c.prepaidAmount]),V.useEffect(()=>{if(c.prepaidAmount&&c.monthlyPayment>0){const S=Math.floor(c.prepaidAmount/c.monthlyPayment);d(R=>({...R,prepaidInstallments:S}))}else d(S=>({...S,prepaidInstallments:0}))},[c.prepaidAmount,c.monthlyPayment]);const m=[{value:"car",label:"Ø³ÙŠØ§Ø±Ø©",icon:"ðŸš—"},{value:"house",label:"Ø¨ÙŠØª",icon:"ðŸ "},{value:"personal",label:"Ø´Ø®ØµÙŠ",icon:"ðŸ‘¤"},{value:"business",label:"ØªØ¬Ø§Ø±ÙŠ",icon:"ðŸ’¼"},{value:"education",label:"ØªØ¹Ù„ÙŠÙ…ÙŠ",icon:"ðŸŽ“"}],p=S=>{const{name:R,value:P}=S.target;d(F=>({...F,[R]:R.includes("Amount")||R.includes("Payment")||R.includes("Months")?parseFloat(P)||0:P})),f[R]&&u(F=>({...F,[R]:""}))},h=()=>{const S={};return c.name.trim()||(S.name="Ø§Ø³Ù… Ø§Ù„Ù‚Ø±Ø¶ Ù…Ø·Ù„ÙˆØ¨"),c.totalAmount<=0&&(S.totalAmount="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±"),c.downPayment<0&&(S.downPayment="Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø³Ø§Ù„Ø¨Ø©"),c.finalPayment<0&&(S.finalPayment="Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø³Ø§Ù„Ø¨Ø©"),c.monthlyPayment<=0&&(S.monthlyPayment="Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±"),c.lender.trim()||(S.lender="Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ Ø£Ùˆ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ù…Ø·Ù„ÙˆØ¨"),c.startDate||(S.startDate="ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø±Ø¶ Ù…Ø·Ù„ÙˆØ¨"),c.downPayment+c.finalPayment>=c.totalAmount&&(S.downPayment="Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙˆØ§Ù„Ø£Ø®ÙŠØ±Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"),u(S),Object.keys(S).length===0},y=S=>{if(S.preventDefault(),!h())return;const R={...c,id:(n==null?void 0:n.id)||`loan-${Date.now()}`,createdAt:(n==null?void 0:n.createdAt)||new Date().toISOString()};e(R)},E=Object.values(s).map(S=>({value:S.id,label:`${S.name} (${S.currency})`}));return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:t,children:o.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:S=>S.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:n?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¶":"Ø¥Ø¶Ø§ÙØ© Ù‚Ø±Ø¶ Ø¬Ø¯ÙŠØ¯"}),o.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600",children:o.jsx(St,{})})]}),o.jsxs("form",{onSubmit:y,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø±Ø¶"}),o.jsx("select",{id:"type",name:"type",value:c.type,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:m.map(S=>o.jsxs("option",{value:S.value,children:[S.icon," ",S.label]},S.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ø³Ù… Ø§Ù„Ù‚Ø±Ø¶"}),o.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ù…Ø«Ù„: Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø© ØªÙˆÙŠÙˆØªØ§",required:!0}),f.name&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.name})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"}),o.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:c.totalAmount,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),f.totalAmount&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.totalAmount})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰"}),o.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:c.downPayment,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),f.downPayment&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.downPayment})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©"}),o.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:c.finalPayment,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),f.finalPayment&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.finalPayment})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ"}),o.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:c.monthlyPayment,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),f.monthlyPayment&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.monthlyPayment})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),o.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:c.prepaidAmount||0,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),o.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø°ÙŠ ØªÙ… Ø¯ÙØ¹Ù‡ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø±Ø¶ Ù„Ù„Ù†Ø¸Ø§Ù…"}),(c.prepaidAmount||0)>0&&o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[o.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹: ",c.prepaidInstallments||0," Ù‚Ø³Ø·"]}),o.jsxs("p",{className:"text-blue-600 text-sm",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ",formatCurrency(c.totalAmount-c.downPayment-c.finalPayment-(c.prepaidAmount||0))," Ø±ÙŠØ§Ù„"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø±Ø¶"}),o.jsx("input",{type:"date",id:"startDate",name:"startDate",value:c.startDate,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),f.startDate&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.startDate})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù‚Ø±Ø¶ (Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"}),o.jsx("input",{type:"date",id:"endDate",name:"endDate",value:c.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø§Ù„Ø¨Ù†Ùƒ Ø£Ùˆ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©"}),o.jsx("input",{type:"text",id:"lender",name:"lender",value:c.lender,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ù…Ø«Ù„: Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ",required:!0}),f.lender&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:f.lender})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"Ø±Ø¨Ø· Ø¨Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†ÙƒÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),o.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:c.linkedAccount,onChange:p,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙŠ"}),E.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))]})]})]}),c.totalMonths>0&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø©"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©:"}),o.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",c.totalMonths," Ø´Ù‡Ø±"]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-blue-700",children:"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:"}),o.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",c.remainingMonths," Ø´Ù‡Ø±"]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"Ø¥Ù„ØºØ§Ø¡"}),o.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:n?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø±Ø¶"})]})]})]})})})},uf=()=>{var qt,$t,et,xt,Gt;const[t,e]=V.useState(!1),[n,s]=V.useState(zt),[i,l]=V.useState(new Date().getFullYear()),[c,d]=V.useState(new Date().getMonth()+1),[f,u]=V.useState("summary"),[m,p]=V.useState({isLoading:!1,text:""}),[h,y]=V.useState(null),[E,S]=V.useState({isOpen:!1}),[R,P]=V.useState({}),[F,k]=V.useState({isOpen:!1}),[C,T]=V.useState({isOpen:!1}),[M,A]=V.useState({isOpen:!1}),[L,D]=V.useState({isOpen:!1}),[v,j]=V.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[O,ne]=V.useState(!1),[he,le]=V.useState(""),[ce,W]=V.useState(null),[re,xe]=V.useState(!1),[pe,Ce]=V.useState(!0);V.useEffect(()=>{(async()=>{Vo();try{wu()}catch(G){console.warn("Firebase already initialized or error:",G)}const q=await Ee.onAuthStateChanged(async G=>{try{G?(console.log("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",G.email),W(G),await je(G.uid)):(console.log("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„"),W(null),await He())}catch(z){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",z),await He()}finally{Ce(!1),e(!0)}});return()=>{typeof q=="function"&&q()}})()},[]),V.useEffect(()=>(E.isOpen||F.isOpen||C.isOpen||M.isOpen||L.isOpen||h||m.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[E.isOpen,F.isOpen,C.isOpen,M.isOpen,L.isOpen,h,m.isLoading]),V.useEffect(()=>{n.settings.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const N=document.documentElement;n.settings.language==="ar"?(N.setAttribute("lang","ar"),N.setAttribute("dir","rtl")):(N.setAttribute("lang","en"),N.setAttribute("dir","ltr"))},[n.settings.darkMode,n.settings.language]),V.useEffect(()=>{var N,q;L.isOpen&&v.fromAccount&&v.toAccount&&((N=n.bankAccounts[v.fromAccount])==null?void 0:N.currency)!==((q=n.bankAccounts[v.toAccount])==null?void 0:q.currency)&&ht()},[v.fromAccount,v.toAccount,L.isOpen]);const je=async N=>{var q;try{const G=await Ee.getData("users",N);if(G.success&&G.data){const z=zt(),Z={...z,...G.data,cards:{...z.cards,...G.data.cards||{}},bankAccounts:{...z.bankAccounts,...G.data.bankAccounts||{}},investments:{...z.investments,...G.data.investments||{}}};s(Z),console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase")}else G.success||(console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firebase:",G.error),(q=G.error)!=null&&q.includes("Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª")&&y({title:"ØªØ­Ø°ÙŠØ± - Ø¥Ø¹Ø¯Ø§Ø¯ Firebase",body:`<p>ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©. ÙŠØ±Ø¬Ù‰:</p>
                               <ul>
                                 <li>ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</li>
                                 <li>ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚ÙˆØ§Ø¹Ø¯ Firestore</li>
                                 <li>Ø±Ø§Ø¬Ø¹ Ù…Ù„Ù FIREBASE_SETUP.md Ù„Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</li>
                               </ul>
                               <p>Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù…Ø¤Ù‚ØªØ§Ù‹.</p>`,confirmText:"Ù…ÙˆØ§ÙÙ‚",hideCancel:!0}))}catch(G){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",G)}},He=async()=>{try{const N=["financial_dashboard_state","financial_dashboard_backup_1","financial_dashboard_backup_2"];for(let z=0;z<7;z++){const Z=new Date;Z.setDate(Z.getDate()-z);const ie=Z.toISOString().split("T")[0];N.push(`financial_dashboard_${ie}`)}let q=null,G="";for(const z of N){const Z=localStorage.getItem(z);if(Z)try{JSON.parse(Z),q=Z,G=z;break}catch{console.warn(`âš ï¸ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ© ÙÙŠ ${z}`)}}if(q){const z=JSON.parse(q),Z=zt(),ie={...Z,...z,cards:{...Z.cards,...z.cards||{}},bankAccounts:{...Z.bankAccounts,...z.bankAccounts||{}},investments:{...Z.investments,...z.investments||{}}};s(ie),console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù†: ${G}`)}else console.log("â„¹ï¸ Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©")}catch(N){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©:",N)}};V.useEffect(()=>{if(t&&!pe){try{const N=JSON.stringify(n);localStorage.setItem("financial_dashboard_state",N),localStorage.setItem("financial_dashboard_backup_1",N),localStorage.setItem("financial_dashboard_backup_2",N);const q=new Date().toISOString();localStorage.setItem(`financial_dashboard_${q.split("T")[0]}`,N),console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage Ù…Ø¹ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø©")}catch(N){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:",N)}if(ce){const q=setTimeout(async()=>{try{const G=await Ee.saveData("users",ce.uid,n);G.success?console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase"):console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",G.error)}catch(G){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",G)}},2e3);return()=>clearTimeout(q)}}},[n,t,ce,pe]),V.useEffect(()=>{f!=="transactions"&&ut()},[f]);const Ke=(N,q="")=>p({isLoading:N,text:q}),Xe=V.useCallback(()=>n.transactions?n.transactions.filter(q=>{const G=new Date(q.date),z=G.getFullYear()===i,Z=c==="all"||G.getMonth()+1===c;return z&&Z}).sort((q,G)=>{const z=new Date(q.date),ie=new Date(G.date).getTime()-z.getTime();if(ie===0){const De=parseInt(q.id.replace("trans-","").split("-")[0]);return parseInt(G.id.replace("trans-","").split("-")[0])-De}return ie}):[],[n.transactions,i,c]),Qe=V.useMemo(()=>n.transactions?[...n.transactions].sort((N,q)=>{const G=new Date(N.date),Z=new Date(q.date).getTime()-G.getTime();if(Z===0){const ie=parseInt(N.id.replace("trans-","").split("-")[0]);return parseInt(q.id.replace("trans-","").split("-")[0])-ie}return Z}):[],[n.transactions]),Ie=V.useMemo(()=>Xe(),[Xe]),K=V.useMemo(()=>{const N={},q={},G={},z={};n.cards&&typeof n.cards=="object"&&Object.values(n.cards).forEach(X=>{X&&X.id&&(G[X.id]={...X,balance:0,available:X.limit,usagePercentage:0})}),n.bankAccounts&&typeof n.bankAccounts=="object"&&Object.values(n.bankAccounts).forEach(X=>{X&&X.id&&(z[X.id]={...X,deposits:0,withdrawals:0})});let Z=0,ie=0,De=0,Ye=0;Ie.forEach(X=>{if(X.type==="income")Z+=X.amount;else if(X.type==="expense")ie+=X.amount,X.categoryId&&(N[X.categoryId]=(N[X.categoryId]||0)+X.amount);else if(X.type==="bnpl-payment")ie+=X.amount,X.categoryId&&(N[X.categoryId]=(N[X.categoryId]||0)+X.amount);else if(X.type==="investment-deposit")De+=X.amount,ie+=X.amount;else if(X.type==="investment-withdrawal")Ye+=X.amount,Z+=X.amount;else if(X.type.endsWith("-payment")){const ye=X.type.replace("-payment","");q[ye]?q[ye]+=X.amount:q[ye]=X.amount}}),Object.keys(n.cards).forEach(X=>{const ye=n.cards[X];let _e=0;n.transactions.forEach(ve=>{var ke,de,Ht,Jt,Ot;(ke=ve.description)!=null&&ke.includes(`Ø³Ø¯Ø§Ø¯ ${ye.name}`)||ve.type===`Ø³Ø¯Ø§Ø¯ ${ye.name}`||ve.type===`${X}-payment`?_e-=ve.amount:(ve.paymentMethod===X&&((de=ve.description)!=null&&de.includes("Ø³Ø¯Ø§Ø¯")||(Ht=ve.type)!=null&&Ht.includes("Ø³Ø¯Ø§Ø¯")||(Jt=ve.type)!=null&&Jt.includes("-payment"))&&!((Ot=ve.description)!=null&&Ot.includes(ye.name))&&ve.type!==`Ø³Ø¯Ø§Ø¯ ${ye.name}`&&ve.type!==`${X}-payment`||ve.paymentMethod===X&&(ve.type==="expense"||ve.type==="bnpl-payment"))&&(_e+=ve.amount)}),G[X].balance=_e,G[X].available=ye.limit-_e,G[X].usagePercentage=ye.limit>0?_e/ye.limit*100:0}),Object.keys(n.bankAccounts).forEach(X=>{const ye=n.bankAccounts[X];let _e=0,ve=0,ke=ye.balance;n.transactions.forEach(de=>{de.paymentMethod===X&&(["income","investment-withdrawal"].includes(de.type)?ke+=de.amount:["expense","investment-deposit"].includes(de.type)&&(ke-=de.amount)),de.type.endsWith("-payment")&&de.paymentMethod===X&&(ke-=de.amount),de.type==="expense"&&de.isInstallmentPayment&&de.paymentMethod===X&&(ke-=de.amount)}),Ie.forEach(de=>{de.paymentMethod===X&&(["income","investment-withdrawal"].includes(de.type)?_e+=de.amount:["expense","investment-deposit"].includes(de.type)&&(ve+=de.amount)),de.type.endsWith("-payment")&&de.paymentMethod===X&&(ve+=de.amount),de.type==="expense"&&de.isInstallmentPayment&&de.paymentMethod===X&&(ve+=de.amount)}),z[X].balance=ke,z[X].deposits=_e,z[X].withdrawals=ve});const yt=Object.values(G).reduce((X,ye)=>X+ye.balance,0),vt=Object.values(G).reduce((X,ye)=>X+ye.available,0),bt=Object.values(G).reduce((X,ye)=>X+ye.limit,0),tt=Object.values(z).reduce((X,ye)=>X+ye.balance,0);return{totalIncome:Z,totalExpenses:ie,cardDetails:G,cardPayments:q,bankAccountDetails:z,totalDebt:yt,totalAvailable:vt,totalLimits:bt,totalBankBalance:tt,totalInvestmentDeposits:De,totalInvestmentWithdrawals:Ye,expensesByCategory:N}},[Ie,n.transactions,n.cards,n.bankAccounts]),te=(N,q)=>{s(G=>{if(q){const z=G.transactions.map(Z=>Z.id===q?{...Z,...N}:Z);return{...G,transactions:z}}else if(N.bnplData&&N.paymentMethod.includes("bnpl")){const z={id:`installment-${Date.now()}`,provider:N.paymentMethod,description:N.description,totalAmount:N.amount,installmentAmount:N.bnplData.installmentAmount,total:N.bnplData.installmentsCount,paid:1,createdAt:N.date},Z={id:`trans-${Date.now()}-1`,amount:N.bnplData.installmentAmount,date:N.date,description:`Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù€: ${N.description}`,paymentMethod:N.bnplData.initialPaymentSource,type:"expense",categoryId:N.categoryId,isInstallmentPayment:!0,installmentId:z.id};return{...G,transactions:[...G.transactions,Z],installments:[...G.installments,z]}}else{const z={id:`trans-${Date.now()}`,...N};return{...G,transactions:[...G.transactions,z]}}}),S({isOpen:!1})},me=N=>{y({title:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",body:"<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø±ÙƒØ©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.</p>",confirmText:"Ù†Ø¹Ù…, Ø­Ø°Ù",onConfirm:()=>{s(q=>{const G=q.transactions.find(ie=>ie.id===N);if(!G)return q;const z=q.transactions.filter(ie=>ie.id!==N);let Z=q.installments;return G.isInstallmentPayment&&G.installmentId&&(Z=q.installments.map(ie=>ie.id===G.installmentId?{...ie,paid:Math.max(0,ie.paid-1)}:ie)),{...q,transactions:z,installments:Z}}),y(null)}})},Je=N=>{const q=n.transactions.find(G=>G.id===N);q&&S({isOpen:!0,initialData:q})},Oe=N=>{P({categoryId:N}),u("transactions")},ut=()=>{P({})},At=async N=>{W(N),xe(!1),await je(N.uid)},Me=async()=>{try{const N=await Ee.signOut();N.success?(console.log("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­"),W(null),await He()):console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:",N.error)}catch(N){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:",N)}},un=(N,q)=>{s(G=>{const z={...G.cards};if(q)z[q]={...z[q],...N,id:q};else{const Z=`card-${Date.now()}`;z[Z]={...N,id:Z}}return{...G,cards:z}}),k({isOpen:!1})},It=N=>{var q;n.transactions.some(G=>G.paymentMethod===N||G.type===`${N}-payment`)?y({title:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù",body:"<p>Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ø£Ù†Ù‡Ø§ Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª. ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø£ÙˆÙ„Ø§Ù‹.</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"}):y({title:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",body:`<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ø¨Ø·Ø§Ù‚Ø© "${(q=n.cards[N])==null?void 0:q.name}"ØŸ</p>`,confirmText:"Ù†Ø¹Ù…, Ø­Ø°Ù",onConfirm:()=>{s(G=>{const z={...G.cards};return delete z[N],{...G,cards:z}}),y(null)}})},Ze=(N,q)=>{s(G=>{const z={...G.bankAccounts};if(q)z[q]={...z[q],...N,id:q};else{const Z=`bank-${Date.now()}`;z[Z]={...N,id:Z}}return{...G,bankAccounts:z}}),T({isOpen:!1})},ft=N=>{var q;n.transactions.some(G=>G.paymentMethod===N)?y({title:"Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù",body:"<p>Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„Ø£Ù†Ù‡ Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª. ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø£ÙˆÙ„Ø§Ù‹.</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"}):y({title:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",body:`<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ø­Ø³Ø§Ø¨ "${(q=n.bankAccounts[N])==null?void 0:q.name}"ØŸ</p>`,confirmText:"Ù†Ø¹Ù…, Ø­Ø°Ù",onConfirm:()=>{s(G=>{const z={...G.bankAccounts};return delete z[N],{...G,bankAccounts:z}}),y(null)}})},mt=N=>{y({title:"Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©",body:"<p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.</p>",confirmText:"Ø§Ø³ØªØ¹Ø§Ø¯Ø©",cancelText:"Ø¥Ù„ØºØ§Ø¡",onConfirm:()=>{try{const q=zt();if(N.creditCards&&!N.cards){const z={};Object.entries(N.creditCards).forEach(([Z,ie])=>{z[Z]={id:Z,name:Z.toUpperCase(),limit:ie.creditLimit||0,balance:ie.currentBalance||0,dueDay:ie.dueDay||1,smsSamples:[],keywords:[]}}),N.cards=z}if(N.cards&&typeof N.cards=="object"&&(N.cards.snb||N.cards.enbd)){const z={};N.cards.snb&&(z["snb-card"]={id:"snb-card",name:"SNB Ø§Ù„Ø£Ù‡Ù„ÙŠ",limit:N.cards.snb.limit||0,dueDay:N.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","Ø§Ù„Ø£Ù‡Ù„ÙŠ","Ø¥Ø¦ØªÙ…Ø§Ù†ÙŠØ©"]}),N.cards.enbd&&(z["enbd-card"]={id:"enbd-card",name:"ENBD Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª",limit:N.cards.enbd.limit||0,dueDay:N.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª","Visa card"]}),N.cards=z}N.bank&&!N.bankAccounts&&(N.bankAccounts={"bank-default":{id:"bank-default",name:"Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ",balance:N.bank.balance||0,smsSamples:["Ù…Ø¯Ù‰","mada","Alrajhi","Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ","Inma","Ø§Ù„Ø¥Ù†Ù…Ø§Ø¡","Ø¨Ù†Ùƒ"]}}),N.transactions&&Array.isArray(N.transactions)&&(N.transactions=N.transactions.map(z=>z.paymentMethod==="mada-bank"?{...z,paymentMethod:"bank-default"}:z));const G={...q,...N};s(G),ce&&(async()=>{try{const Z=await Ee.saveData("users",ce.uid,G);Z.success?console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø¯Ø© ÙÙŠ Firebase"):console.warn("âš ï¸ ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",Z.error)}catch(Z){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase:",Z)}})(),y({title:"ØªÙ… Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­",body:"<p>ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ­ÙØ¸Ù‡Ø§ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©.</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚",hideCancel:!0})}catch{y({title:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©",body:"<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚",hideCancel:!0})}}})},pt=N=>k({isOpen:!0,initialData:N?n.cards[N]:null}),Rt=N=>T({isOpen:!0,initialData:N?n.bankAccounts[N]:null}),Pt=N=>A({isOpen:!0,initialData:N?n.loans[N]:null}),Mt=()=>{s(N=>({...N,settings:{...N.settings,darkMode:!N.settings.darkMode}}))},kt=()=>{s(N=>({...N,settings:{...N.settings,notifications:!N.settings.notifications}}))},Dt=async()=>{try{if(await _u(n))y({title:"âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",body:"<p>ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­!</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚"});else throw new Error("ÙØ´Ù„ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")}catch{y({title:"âŒ Ø®Ø·Ø£",body:"<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚"})}},Lt=async()=>{try{const N=await Su();if(N.success)window.location.reload(),y({title:"âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",body:`<p>${N.message}</p><p>ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</p>`,confirmText:"Ù…ÙˆØ§ÙÙ‚"});else throw new Error(N.message)}catch(N){y({title:"âŒ Ø®Ø·Ø£",body:`<p>${N.message}</p>`,confirmText:"Ù…ÙˆØ§ÙÙ‚"})}},Ft=async()=>{try{if(await Au())y({title:"âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",body:"<p>ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚"});else throw new Error("ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©")}catch{y({title:"âŒ Ø®Ø·Ø£",body:"<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©.</p>",confirmText:"Ù…ÙˆØ§ÙÙ‚"})}},Ut=N=>{const q=N.target.files[0];q&&Iu(q).then(G=>{if(G.success)window.location.reload(),y({title:"âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­",body:`<p>${G.message}</p><p>ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</p>`,confirmText:"Ù…ÙˆØ§ÙÙ‚"});else throw new Error(G.message)}).catch(G=>{y({title:"âŒ Ø®Ø·Ø£",body:`<p>${G.message}</p>`,confirmText:"Ù…ÙˆØ§ÙÙ‚"})})},jt=()=>{s(N=>({...N,settings:{...N.settings,language:N.settings.language==="ar"?"en":"ar"}}))},Vt=()=>{if(!v.fromAccount||!v.toAccount||v.amount<=0){y({title:"Ø®Ø·Ø£",body:"<p>ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"});return}if(v.fromAccount===v.toAccount){y({title:"Ø®Ø·Ø£",body:"<p>Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù†ÙØ³ Ø§Ù„Ø­Ø³Ø§Ø¨.</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"});return}const N=n.bankAccounts[v.fromAccount],q=n.bankAccounts[v.toAccount],G=n.cards[v.fromAccount],z=n.cards[v.toAccount],Z=N||G,ie=q||z,De=v.amount*v.exchangeRate,Ye=G?`${v.fromAccount}-payment`:"expense",yt=z?`${v.toAccount}-payment`:"income",vt={id:`trans-${Date.now()}-withdrawal`,amount:v.amount,date:new Date().toISOString().split("T")[0],description:`ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ${(ie==null?void 0:ie.name)||"Ø­Ø³Ø§Ø¨ Ø¢Ø®Ø±"}: ${v.description}${v.exchangeRate!==1?` (Ù…Ø¹Ø¯Ù„: ${v.exchangeRate})`:""}`,paymentMethod:v.fromAccount,type:Ye,categoryId:null},bt={id:`trans-${Date.now()}-deposit`,amount:De,date:new Date().toISOString().split("T")[0],description:`ØªØ­ÙˆÙŠÙ„ Ù…Ù† ${(Z==null?void 0:Z.name)||"Ø­Ø³Ø§Ø¨ Ø¢Ø®Ø±"}: ${v.description}${v.exchangeRate!==1?` (Ù…Ø¹Ø¯Ù„: ${v.exchangeRate})`:""}`,paymentMethod:v.toAccount,type:yt,categoryId:null};s(tt=>({...tt,transactions:[...tt.transactions,vt,bt]})),D({isOpen:!1}),j({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),le(""),y({title:"Ù†Ø¬Ø­ Ø§Ù„ØªØ­ÙˆÙŠÙ„",body:"<p>ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"})},Bt=N=>{if(s(q=>({...q,loans:{...q.loans,[N.id]:N}})),!N.id.includes("edit")){const q=[];N.downPayment>0&&q.push({id:`trans-${Date.now()}-down-payment`,amount:N.downPayment,date:N.startDate,description:`Ø¯ÙØ¹Ø© Ø£ÙˆÙ„Ù‰ - ${N.name}`,paymentMethod:N.linkedAccount||"cash",type:"expense",categoryId:null}),q.push({id:`trans-${Date.now()}-loan-deposit`,amount:N.totalAmount,date:N.startDate,description:`Ø¥ÙŠØ¯Ø§Ø¹ Ù‚Ø±Ø¶ - ${N.name} Ù…Ù† ${N.lender}`,paymentMethod:N.linkedAccount||"cash",type:"income",categoryId:null}),N.finalPayment>0&&N.endDate&&q.push({id:`trans-${Date.now()}-final-payment`,amount:N.finalPayment,date:N.endDate,description:`Ø¯ÙØ¹Ø© Ø£Ø®ÙŠØ±Ø© - ${N.name}`,paymentMethod:N.linkedAccount||"cash",type:"expense",categoryId:null}),s(G=>({...G,transactions:[...G.transactions,...q]}))}A({isOpen:!1}),y({title:"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­",body:"<p>ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø±Ø¶ ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡ Ø¨Ù†Ø¬Ø§Ø­!</p>",hideCancel:!0,confirmText:"Ù…ÙˆØ§ÙÙ‚"})},ht=async()=>{if(!v.fromAccount||!v.toAccount)return;const N=n.bankAccounts[v.fromAccount],q=n.bankAccounts[v.toAccount];if(!N||!q)return;const G=N.currency||"SAR",z=q.currency||"SAR";if(G===z){j(Z=>({...Z,exchangeRate:1})),le("");return}ne(!0),le("");try{const Z=await $o(G,z);j(ie=>({...ie,exchangeRate:Z.rate}))}catch(Z){le(Z instanceof Error?Z.message:"ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„"),console.error("Exchange rate error:",Z)}finally{ne(!1)}};if(!t||pe)return o.jsx($u,{});if(!ce)return o.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:o.jsxs("div",{className:"w-full max-w-md px-4",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"ðŸ’°"}),o.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©"}),o.jsx("p",{className:"text-slate-600 mt-2",children:"Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ"})]}),o.jsx(ao,{onSuccess:At,onClose:()=>{},hideCloseButton:!0})]})});`${i}${c==="all"?"ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±":new Date(i,c-1).toLocaleString("ar-SA",{month:"long"})}`;const gt=()=>{switch(f){case"summary":return o.jsx(Ju,{calculations:K,categories:n.categories,state:n,darkMode:n.settings.darkMode,language:n.settings.language,onNavigateToTransactions:Oe});case"transactions":return o.jsx(Ou,{transactions:Ie,allTransactions:Qe,categories:n.categories,deleteTransaction:me,editTransaction:Je,state:n,darkMode:n.settings.darkMode,language:n.settings.language,initialCategoryFilter:R.categoryId});case"ai-assistant":return o.jsx(Wu,{calculations:K,filteredTransactions:Ie,allTransactions:Qe,state:n,darkMode:n.settings.darkMode,language:n.settings.language});case"analysis":return o.jsx(zu,{calculations:K,categories:n.categories,allTransactions:n.transactions,darkMode:n.settings.darkMode,language:n.settings.language});case"budget":return o.jsx(Ku,{state:n,setLoading:Ke,setModal:y,darkMode:n.settings.darkMode,language:n.settings.language});case"investment":return o.jsx(Xu,{state:n,setState:s,calculations:K,setModal:y,darkMode:n.settings.darkMode,language:n.settings.language});case"cards":return o.jsx(Zu,{state:n,calculations:K,openCardFormModal:pt,deleteCard:It,darkMode:n.settings.darkMode,language:n.settings.language});case"bank":return o.jsx(nf,{state:n,setState:s,calculations:K,filteredTransactions:Ie,categories:n.categories,setModal:y,openBankAccountFormModal:Rt,deleteBankAccount:ft,openTransferModal:()=>D({isOpen:!0}),darkMode:n.settings.darkMode,language:n.settings.language});case"installments":return o.jsx(sf,{state:n,setState:s,filteredTransactions:Ie,setModal:y,darkMode:n.settings.darkMode,language:n.settings.language});case"debts-loans":return o.jsx(of,{state:n,setState:s,setModal:y,openLoanFormModal:Pt,darkMode:n.settings.darkMode,language:n.settings.language});case"settings":return o.jsx(rf,{state:n,setState:s,setModal:y,setLoading:Ke,onRestore:mt,darkMode:n.settings.darkMode,language:n.settings.language,onSaveToCloud:Dt,onRestoreFromCloud:Lt,onDownloadBackup:Ft,onRestoreFromFile:Ut});default:return o.jsx("div",{children:"Tab not found"})}};return o.jsxs("div",{className:`min-h-screen font-sans ${n.settings.darkMode?"dark":""}`,children:[o.jsx(ju,{selectedYear:i,selectedMonth:c,onYearChange:l,onMonthChange:N=>d(N),onAddTransaction:()=>S({isOpen:!0}),currentUser:ce,onSignOut:Me,language:n.settings.language,darkMode:n.settings.darkMode,notifications:n.settings.notifications,onToggleDarkMode:Mt,onToggleNotifications:kt,onToggleLanguage:jt}),o.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[o.jsx(Bu,{activeTab:f,setActiveTab:u,language:n.settings.language}),gt()]}),o.jsx("button",{onClick:()=>S({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),E.isOpen&&o.jsx(af,{onClose:()=>S({isOpen:!1}),onSave:te,initialData:E.initialData,categories:n.categories,cards:n.cards,bankAccounts:n.bankAccounts,loans:n.loans,setModalConfig:y,darkMode:n.settings.darkMode,language:n.settings.language}),F.isOpen&&o.jsx(lf,{onClose:()=>k({isOpen:!1}),onSave:un,initialData:F.initialData}),C.isOpen&&o.jsx(cf,{onClose:()=>T({isOpen:!1}),onSave:Ze,initialData:C.initialData}),M.isOpen&&o.jsx(df,{onClose:()=>A({isOpen:!1}),onSave:Bt,initialData:M.initialData,bankAccounts:n.bankAccounts}),L.isOpen&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{D({isOpen:!1}),j({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),le("")},children:o.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:N=>N.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"ðŸ’¸ ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª"}),o.jsx("button",{onClick:()=>{D({isOpen:!1}),j({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),le("")},className:"text-slate-400 hover:text-slate-600",children:"âœ•"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ù…Ù† Ø§Ù„Ø­Ø³Ø§Ø¨"}),o.jsxs("select",{id:"fromAccount",name:"fromAccount",value:v.fromAccount,onChange:N=>j(q=>({...q,fromAccount:N.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[o.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØµØ¯Ø±"}),Object.entries(n.bankAccounts).map(([N,q])=>o.jsxs("option",{value:N,children:["ðŸ¦ ",q.name]},N)),Object.entries(n.cards).map(([N,q])=>o.jsxs("option",{value:N,children:["ðŸ’³ ",q.name]},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨"}),o.jsxs("select",{id:"toAccount",name:"toAccount",value:v.toAccount,onChange:N=>j(q=>({...q,toAccount:N.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[o.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‡Ø¯Ù"}),Object.entries(n.bankAccounts).filter(([N])=>N!==v.fromAccount).map(([N,q])=>o.jsxs("option",{value:N,children:["ðŸ¦ ",q.name]},N)),Object.entries(n.cards).filter(([N])=>N!==v.fromAccount).map(([N,q])=>o.jsxs("option",{value:N,children:["ðŸ’³ ",q.name]},N))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),o.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:v.amount,onChange:N=>j(q=>({...q,amount:parseFloat(N.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),v.fromAccount&&v.toAccount&&((qt=n.bankAccounts[v.fromAccount])==null?void 0:qt.currency)!==(($t=n.bankAccounts[v.toAccount])==null?void 0:$t.currency)&&o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["ðŸ’± Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ (",(et=n.bankAccounts[v.fromAccount])==null?void 0:et.currency," â†’ ",(xt=n.bankAccounts[v.toAccount])==null?void 0:xt.currency,")"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",step:"0.0001",value:v.exchangeRate,onChange:N=>j(q=>({...q,exchangeRate:parseFloat(N.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),o.jsxs("button",{type:"button",onClick:ht,disabled:O,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹",children:[O?o.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"ðŸ”„",o.jsx("span",{className:"hidden sm:inline",children:"ØªØ­Ø¯ÙŠØ«"})]})]}),he&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:he}),o.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø­ÙˆÙ„: ",(v.amount*v.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(Gt=n.bankAccounts[v.toAccount])==null?void 0:Gt.currency]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"Ø§Ù„ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),o.jsx("input",{type:"text",id:"description",name:"description",value:v.description,onChange:N=>j(q=>({...q,description:N.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ù…Ø«Ù„: ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø·ÙˆØ§Ø±Ø¦"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:()=>{D({isOpen:!1}),j({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),le("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"Ø¥Ù„ØºØ§Ø¡"}),o.jsx("button",{type:"button",onClick:Vt,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"ØªØ­ÙˆÙŠÙ„"})]})]})})}),h&&o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>y(null),children:o.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:N=>N.stopPropagation(),children:[o.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 mb-4",children:h.title}),o.jsx("div",{className:"text-slate-600 dark:text-slate-300",dangerouslySetInnerHTML:{__html:h.body}}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!h.hideCancel&&o.jsx("button",{onClick:()=>y(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"Ø¥Ù„ØºØ§Ø¡"}),o.jsx("button",{onClick:()=>{(!h.onConfirm||h.onConfirm()!==!1)&&y(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:h.confirmText||"Ù…ÙˆØ§ÙÙ‚"})]})]})}),m.isLoading&&o.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),o.jsx("p",{className:"text-white mt-4",children:m.text||"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."})]}),re&&ce&&o.jsx(ao,{onSuccess:At,onClose:()=>xe(!1)})]})},zo=document.getElementById("root");if(!zo)throw new Error("Could not find root element");const ff=bn.createRoot(zo);ff.render(o.jsx(Mn.StrictMode,{children:o.jsx(uf,{})}));"serviceWorker"in navigator&&(window.addEventListener("load",()=>{navigator.serviceWorker.register("./fd/sw.js").then(t=>{console.log("âœ… Service Worker registered successfully:",t),t.addEventListener("updatefound",()=>{const e=t.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&confirm("ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŸ")&&window.location.reload()})})}).catch(t=>{console.error("âŒ Service Worker registration failed:",t)})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}));let wt;window.addEventListener("beforeinstallprompt",t=>{console.log("PWA install prompt available"),t.preventDefault(),wt=t;const e=document.createElement("button");e.textContent="ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚",e.className="fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50",e.onclick=()=>{wt&&(wt.prompt(),wt.userChoice.then(n=>{n.outcome==="accepted"?console.log("âœ… User accepted the install prompt"):console.log("âŒ User dismissed the install prompt"),wt=null,e.remove()}))},document.body.appendChild(e)});window.addEventListener("appinstalled",()=>{console.log("âœ… PWA was installed");const t=document.querySelector("button[onclick]");t&&t.remove()});
