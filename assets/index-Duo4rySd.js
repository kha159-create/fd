(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function qx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xm={exports:{}},ru={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function qC(){if(jv)return ru;jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:n,type:i,key:u,ref:a!==void 0?a:null,props:l}}return ru.Fragment=e,ru.jsx=t,ru.jsxs=t,ru}var Fv;function BC(){return Fv||(Fv=1,xm.exports=qC()),xm.exports}var d=BC(),Em={exports:{}},Fe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function zC(){if(qv)return Fe;qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function w(q){return q===null||typeof q!="object"?null:(q=b&&q[b]||q["@@iterator"],typeof q=="function"?q:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,L={};function G(q,ae,Te){this.props=q,this.context=ae,this.refs=L,this.updater=Te||V}G.prototype.isReactComponent={},G.prototype.setState=function(q,ae){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,ae,"setState")},G.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function W(){}W.prototype=G.prototype;function ee(q,ae,Te){this.props=q,this.context=ae,this.refs=L,this.updater=Te||V}var F=ee.prototype=new W;F.constructor=ee,U(F,G.prototype),F.isPureReactComponent=!0;var Q=Array.isArray;function H(){}var R={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function D(q,ae,Te){var Ee=Te.ref;return{$$typeof:n,type:q,key:ae,ref:Ee!==void 0?Ee:null,props:Te}}function N(q,ae){return D(q.type,ae,q.props)}function P(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function O(q){var ae={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(Te){return ae[Te]})}var k=/\/+/g;function Ue(q,ae){return typeof q=="object"&&q!==null&&q.key!=null?O(""+q.key):ae.toString(36)}function Be(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(H,H):(q.status="pending",q.then(function(ae){q.status==="pending"&&(q.status="fulfilled",q.value=ae)},function(ae){q.status==="pending"&&(q.status="rejected",q.reason=ae)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function te(q,ae,Te,Ee,Ie){var ke=typeof q;(ke==="undefined"||ke==="boolean")&&(q=null);var Ye=!1;if(q===null)Ye=!0;else switch(ke){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(q.$$typeof){case n:case e:Ye=!0;break;case T:return Ye=q._init,te(Ye(q._payload),ae,Te,Ee,Ie)}}if(Ye)return Ie=Ie(q),Ye=Ee===""?"."+Ue(q,0):Ee,Q(Ie)?(Te="",Ye!=null&&(Te=Ye.replace(k,"$&/")+"/"),te(Ie,ae,Te,"",function(Ge){return Ge})):Ie!=null&&(P(Ie)&&(Ie=N(Ie,Te+(Ie.key==null||q&&q.key===Ie.key?"":(""+Ie.key).replace(k,"$&/")+"/")+Ye)),ae.push(Ie)),1;Ye=0;var me=Ee===""?".":Ee+":";if(Q(q))for(var ge=0;ge<q.length;ge++)Ee=q[ge],ke=me+Ue(Ee,ge),Ye+=te(Ee,ae,Te,ke,Ie);else if(ge=w(q),typeof ge=="function")for(q=ge.call(q),ge=0;!(Ee=q.next()).done;)Ee=Ee.value,ke=me+Ue(Ee,ge++),Ye+=te(Ee,ae,Te,ke,Ie);else if(ke==="object"){if(typeof q.then=="function")return te(Be(q),ae,Te,Ee,Ie);throw ae=String(q),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function Z(q,ae,Te){if(q==null)return q;var Ee=[],Ie=0;return te(q,Ee,"","",function(ke){return ae.call(Te,ke,Ie++)}),Ee}function pe(q){if(q._status===-1){var ae=q._result;ae=ae(),ae.then(function(Te){(q._status===0||q._status===-1)&&(q._status=1,q._result=Te)},function(Te){(q._status===0||q._status===-1)&&(q._status=2,q._result=Te)}),q._status===-1&&(q._status=0,q._result=ae)}if(q._status===1)return q._result.default;throw q._result}var Me=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Re={map:Z,forEach:function(q,ae,Te){Z(q,function(){ae.apply(this,arguments)},Te)},count:function(q){var ae=0;return Z(q,function(){ae++}),ae},toArray:function(q){return Z(q,function(ae){return ae})||[]},only:function(q){if(!P(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Fe.Activity=x,Fe.Children=Re,Fe.Component=G,Fe.Fragment=t,Fe.Profiler=a,Fe.PureComponent=ee,Fe.StrictMode=i,Fe.Suspense=g,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Fe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return R.H.useMemoCache(q)}},Fe.cache=function(q){return function(){return q.apply(null,arguments)}},Fe.cacheSignal=function(){return null},Fe.cloneElement=function(q,ae,Te){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var Ee=U({},q.props),Ie=q.key;if(ae!=null)for(ke in ae.key!==void 0&&(Ie=""+ae.key),ae)!C.call(ae,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&ae.ref===void 0||(Ee[ke]=ae[ke]);var ke=arguments.length-2;if(ke===1)Ee.children=Te;else if(1<ke){for(var Ye=Array(ke),me=0;me<ke;me++)Ye[me]=arguments[me+2];Ee.children=Ye}return D(q.type,Ie,Ee)},Fe.createContext=function(q){return q={$$typeof:u,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},Fe.createElement=function(q,ae,Te){var Ee,Ie={},ke=null;if(ae!=null)for(Ee in ae.key!==void 0&&(ke=""+ae.key),ae)C.call(ae,Ee)&&Ee!=="key"&&Ee!=="__self"&&Ee!=="__source"&&(Ie[Ee]=ae[Ee]);var Ye=arguments.length-2;if(Ye===1)Ie.children=Te;else if(1<Ye){for(var me=Array(Ye),ge=0;ge<Ye;ge++)me[ge]=arguments[ge+2];Ie.children=me}if(q&&q.defaultProps)for(Ee in Ye=q.defaultProps,Ye)Ie[Ee]===void 0&&(Ie[Ee]=Ye[Ee]);return D(q,ke,Ie)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(q){return{$$typeof:f,render:q}},Fe.isValidElement=P,Fe.lazy=function(q){return{$$typeof:T,_payload:{_status:-1,_result:q},_init:pe}},Fe.memo=function(q,ae){return{$$typeof:m,type:q,compare:ae===void 0?null:ae}},Fe.startTransition=function(q){var ae=R.T,Te={};R.T=Te;try{var Ee=q(),Ie=R.S;Ie!==null&&Ie(Te,Ee),typeof Ee=="object"&&Ee!==null&&typeof Ee.then=="function"&&Ee.then(H,Me)}catch(ke){Me(ke)}finally{ae!==null&&Te.types!==null&&(ae.types=Te.types),R.T=ae}},Fe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Fe.use=function(q){return R.H.use(q)},Fe.useActionState=function(q,ae,Te){return R.H.useActionState(q,ae,Te)},Fe.useCallback=function(q,ae){return R.H.useCallback(q,ae)},Fe.useContext=function(q){return R.H.useContext(q)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(q,ae){return R.H.useDeferredValue(q,ae)},Fe.useEffect=function(q,ae){return R.H.useEffect(q,ae)},Fe.useEffectEvent=function(q){return R.H.useEffectEvent(q)},Fe.useId=function(){return R.H.useId()},Fe.useImperativeHandle=function(q,ae,Te){return R.H.useImperativeHandle(q,ae,Te)},Fe.useInsertionEffect=function(q,ae){return R.H.useInsertionEffect(q,ae)},Fe.useLayoutEffect=function(q,ae){return R.H.useLayoutEffect(q,ae)},Fe.useMemo=function(q,ae){return R.H.useMemo(q,ae)},Fe.useOptimistic=function(q,ae){return R.H.useOptimistic(q,ae)},Fe.useReducer=function(q,ae,Te){return R.H.useReducer(q,ae,Te)},Fe.useRef=function(q){return R.H.useRef(q)},Fe.useState=function(q){return R.H.useState(q)},Fe.useSyncExternalStore=function(q,ae,Te){return R.H.useSyncExternalStore(q,ae,Te)},Fe.useTransition=function(){return R.H.useTransition()},Fe.version="19.2.0",Fe}var Bv;function Cp(){return Bv||(Bv=1,Em.exports=zC()),Em.exports}var he=Cp();const wp=qx(he);var bm={exports:{}},au={},Am={exports:{}},Sm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function HC(){return zv||(zv=1,(function(n){function e(te,Z){var pe=te.length;te.push(Z);e:for(;0<pe;){var Me=pe-1>>>1,Re=te[Me];if(0<a(Re,Z))te[Me]=Z,te[pe]=Re,pe=Me;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var Z=te[0],pe=te.pop();if(pe!==Z){te[0]=pe;e:for(var Me=0,Re=te.length,q=Re>>>1;Me<q;){var ae=2*(Me+1)-1,Te=te[ae],Ee=ae+1,Ie=te[Ee];if(0>a(Te,pe))Ee<Re&&0>a(Ie,Te)?(te[Me]=Ie,te[Ee]=pe,Me=Ee):(te[Me]=Te,te[ae]=pe,Me=ae);else if(Ee<Re&&0>a(Ie,pe))te[Me]=Ie,te[Ee]=pe,Me=Ee;else break e}}return Z}function a(te,Z){var pe=te.sortIndex-Z.sortIndex;return pe!==0?pe:te.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var g=[],m=[],T=1,x=null,b=3,w=!1,V=!1,U=!1,L=!1,G=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function F(te){for(var Z=t(m);Z!==null;){if(Z.callback===null)i(m);else if(Z.startTime<=te)i(m),Z.sortIndex=Z.expirationTime,e(g,Z);else break;Z=t(m)}}function Q(te){if(U=!1,F(te),!V)if(t(g)!==null)V=!0,H||(H=!0,O());else{var Z=t(m);Z!==null&&Be(Q,Z.startTime-te)}}var H=!1,R=-1,C=5,D=-1;function N(){return L?!0:!(n.unstable_now()-D<C)}function P(){if(L=!1,H){var te=n.unstable_now();D=te;var Z=!0;try{e:{V=!1,U&&(U=!1,W(R),R=-1),w=!0;var pe=b;try{t:{for(F(te),x=t(g);x!==null&&!(x.expirationTime>te&&N());){var Me=x.callback;if(typeof Me=="function"){x.callback=null,b=x.priorityLevel;var Re=Me(x.expirationTime<=te);if(te=n.unstable_now(),typeof Re=="function"){x.callback=Re,F(te),Z=!0;break t}x===t(g)&&i(g),F(te)}else i(g);x=t(g)}if(x!==null)Z=!0;else{var q=t(m);q!==null&&Be(Q,q.startTime-te),Z=!1}}break e}finally{x=null,b=pe,w=!1}Z=void 0}}finally{Z?O():H=!1}}}var O;if(typeof ee=="function")O=function(){ee(P)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Ue=k.port2;k.port1.onmessage=P,O=function(){Ue.postMessage(null)}}else O=function(){G(P,0)};function Be(te,Z){R=G(function(){te(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(te){switch(b){case 1:case 2:case 3:var Z=3;break;default:Z=b}var pe=b;b=Z;try{return te()}finally{b=pe}},n.unstable_requestPaint=function(){L=!0},n.unstable_runWithPriority=function(te,Z){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var pe=b;b=te;try{return Z()}finally{b=pe}},n.unstable_scheduleCallback=function(te,Z,pe){var Me=n.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Me+pe:Me):pe=Me,te){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=pe+Re,te={id:T++,callback:Z,priorityLevel:te,startTime:pe,expirationTime:Re,sortIndex:-1},pe>Me?(te.sortIndex=pe,e(m,te),t(g)===null&&te===t(m)&&(U?(W(R),R=-1):U=!0,Be(Q,pe-Me))):(te.sortIndex=Re,e(g,te),V||w||(V=!0,H||(H=!0,O()))),te},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(te){var Z=b;return function(){var pe=b;b=Z;try{return te.apply(this,arguments)}finally{b=pe}}}})(Sm)),Sm}var Hv;function GC(){return Hv||(Hv=1,Am.exports=HC()),Am.exports}var Cm={exports:{}},pn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function $C(){if(Gv)return pn;Gv=1;var n=Cp();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,m,T){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:g,containerInfo:m,implementation:T}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pn.createPortal=function(g,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,T)},pn.flushSync=function(g){var m=u.T,T=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=T,i.d.f()}},pn.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},pn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},pn.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var T=m.as,x=f(T,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;T==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:w}):T==="script"&&i.d.X(g,{crossOrigin:x,integrity:b,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},pn.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var T=f(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},pn.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var T=m.as,x=f(T,m.crossOrigin);i.d.L(g,T,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},pn.preloadModule=function(g,m){if(typeof g=="string")if(m){var T=f(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},pn.requestFormReset=function(g){i.d.r(g)},pn.unstable_batchedUpdates=function(g,m){return g(m)},pn.useFormState=function(g,m,T){return u.H.useFormState(g,m,T)},pn.useFormStatus=function(){return u.H.useHostTransitionStatus()},pn.version="19.2.0",pn}var $v;function YC(){if($v)return Cm.exports;$v=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cm.exports=$C(),Cm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function JC(){if(Yv)return au;Yv=1;var n=GC(),e=Cp(),t=YC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,o=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(o=r.return),s=r.return;while(s)}return r.tag===3?o:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var o=s,c=r;;){var v=o.return;if(v===null)break;var _=v.alternate;if(_===null){if(c=v.return,c!==null){o=c;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===o)return g(v),s;if(_===c)return g(v),r;_=_.sibling}throw Error(i(188))}if(o.return!==c.return)o=v,c=_;else{for(var A=!1,I=v.child;I;){if(I===o){A=!0,o=v,c=_;break}if(I===c){A=!0,c=v,o=_;break}I=I.sibling}if(!A){for(I=_.child;I;){if(I===o){A=!0,o=_,c=v;break}if(I===c){A=!0,c=_,o=v;break}I=I.sibling}if(!A)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:r}function T(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=T(s),r!==null)return r;s=s.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function O(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function Ue(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case U:return"Fragment";case G:return"Profiler";case L:return"StrictMode";case Q:return"Suspense";case H:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case V:return"Portal";case ee:return s.displayName||"Context";case W:return(s._context.displayName||"Context")+".Consumer";case F:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:Ue(s.type)||"Memo";case C:r=s._payload,s=s._init;try{return Ue(s(r))}catch{}}return null}var Be=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Me=[],Re=-1;function q(s){return{current:s}}function ae(s){0>Re||(s.current=Me[Re],Me[Re]=null,Re--)}function Te(s,r){Re++,Me[Re]=s.current,s.current=r}var Ee=q(null),Ie=q(null),ke=q(null),Ye=q(null);function me(s,r){switch(Te(ke,r),Te(Ie,s),Te(Ee,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?lv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=lv(r),s=uv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ae(Ee),Te(Ee,s)}function ge(){ae(Ee),ae(Ie),ae(ke)}function Ge(s){s.memoizedState!==null&&Te(Ye,s);var r=Ee.current,o=uv(r,s.type);r!==o&&(Te(Ie,s),Te(Ee,o))}function kt(s){Ie.current===s&&(ae(Ee),ae(Ie)),Ye.current===s&&(ae(Ye),tu._currentValue=pe)}var Sn,Ln;function _t(s){if(Sn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Sn=r&&r[1]||"",Ln=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sn+s+Ln}var si=!1;function ii(s,r){if(!s||si)return"";si=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(se){var X=se}Reflect.construct(s,[],le)}else{try{le.call()}catch(se){X=se}s.call(le.prototype)}}else{try{throw Error()}catch(se){X=se}(le=s())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(se){if(se&&X&&typeof se.stack=="string")return[se.stack,X.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=c.DetermineComponentFrameRoot(),A=_[0],I=_[1];if(A&&I){var j=A.split(`
`),K=I.split(`
`);for(v=c=0;c<j.length&&!j[c].includes("DetermineComponentFrameRoot");)c++;for(;v<K.length&&!K[v].includes("DetermineComponentFrameRoot");)v++;if(c===j.length||v===K.length)for(c=j.length-1,v=K.length-1;1<=c&&0<=v&&j[c]!==K[v];)v--;for(;1<=c&&0<=v;c--,v--)if(j[c]!==K[v]){if(c!==1||v!==1)do if(c--,v--,0>v||j[c]!==K[v]){var re=`
`+j[c].replace(" at new "," at ");return s.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",s.displayName)),re}while(1<=c&&0<=v);break}}}finally{si=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?_t(o):""}function Br(s,r){switch(s.tag){case 26:case 27:case 5:return _t(s.type);case 16:return _t("Lazy");case 13:return s.child!==r&&r!==null?_t("Suspense Fallback"):_t("Suspense");case 19:return _t("SuspenseList");case 0:case 15:return ii(s.type,!1);case 11:return ii(s.type.render,!1);case 1:return ii(s.type,!0);case 31:return _t("Activity");default:return""}}function zr(s){try{var r="",o=null;do r+=Br(s,o),o=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Dt=Object.prototype.hasOwnProperty,Vt=n.unstable_scheduleCallback,Is=n.unstable_cancelCallback,al=n.unstable_shouldYield,Va=n.unstable_requestPaint,ln=n.unstable_now,Ns=n.unstable_getCurrentPriorityLevel,Hr=n.unstable_ImmediatePriority,Hi=n.unstable_UserBlockingPriority,us=n.unstable_NormalPriority,La=n.unstable_LowPriority,Gr=n.unstable_IdlePriority,$r=n.log,z=n.unstable_setDisableYieldValue,ce=null,fe=null;function ye(s){if(typeof $r=="function"&&z(s),fe&&typeof fe.setStrictMode=="function")try{fe.setStrictMode(ce,s)}catch{}}var _e=Math.clz32?Math.clz32:Rs,Je=Math.log,Cn=Math.LN2;function Rs(s){return s>>>=0,s===0?32:31-(Je(s)/Cn|0)|0}var wn=256,cs=262144,wt=4194304;function xn(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function xe(s,r,o){var c=s.pendingLanes;if(c===0)return 0;var v=0,_=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var I=c&134217727;return I!==0?(c=I&~_,c!==0?v=xn(c):(A&=I,A!==0?v=xn(A):o||(o=I&~s,o!==0&&(v=xn(o))))):(I=c&~_,I!==0?v=xn(I):A!==0?v=xn(A):o||(o=c&~s,o!==0&&(v=xn(o)))),v===0?0:r!==0&&r!==v&&(r&_)===0&&(_=v&-v,o=r&-r,_>=o||_===32&&(o&4194048)!==0)?r:v}function rt(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Un(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xt(){var s=wt;return wt<<=1,(wt&62914560)===0&&(wt=4194304),s}function Xt(s){for(var r=[],o=0;31>o;o++)r.push(s);return r}function Xe(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ua(s,r,o,c,v,_){var A=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var I=s.entanglements,j=s.expirationTimes,K=s.hiddenUpdates;for(o=A&~o;0<o;){var re=31-_e(o),le=1<<re;I[re]=0,j[re]=-1;var X=K[re];if(X!==null)for(K[re]=null,re=0;re<X.length;re++){var se=X[re];se!==null&&(se.lane&=-536870913)}o&=~le}c!==0&&Ds(s,c,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(A&~r))}function Ds(s,r,o){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-_e(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Gi(s,r){var o=s.entangledLanes|=r;for(s=s.entanglements;o;){var c=31-_e(o),v=1<<c;v&r|s[c]&r&&(s[c]|=r),o&=~v}}function ol(s,r){var o=r&-r;return o=(o&42)!==0?1:Yr(o),(o&(s.suspendedLanes|r))!==0?0:o}function Yr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ri(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Bu(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:Mv(s.type))}function ds(s,r){var o=Z.p;try{return Z.p=s,r()}finally{Z.p=o}}var fs=Math.random().toString(36).slice(2),qt="__reactFiber$"+fs,tn="__reactProps$"+fs,Ms="__reactContainer$"+fs,Oa="__reactEvents$"+fs,wf="__reactListeners$"+fs,zu="__reactHandles$"+fs,Hu="__reactResources$"+fs,Ps="__reactMarker$"+fs;function ja(s){delete s[qt],delete s[tn],delete s[Oa],delete s[wf],delete s[zu]}function ks(s){var r=s[qt];if(r)return r;for(var o=s.parentNode;o;){if(r=o[Ms]||o[qt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(s=gv(s);s!==null;){if(o=s[qt])return o;s=gv(s)}return r}s=o,o=s.parentNode}return null}function Jn(s){if(s=s[qt]||s[Ms]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function On(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Vs(s){var r=s[Hu];return r||(r=s[Hu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Bt(s){s[Ps]=!0}var ll=new Set,ul={};function Ls(s,r){Us(s,r),Us(s+"Capture",r)}function Us(s,r){for(ul[s]=r,s=0;s<r.length;s++)ll.add(r[s])}var cl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dl={},fl={};function Gu(s){return Dt.call(fl,s)?!0:Dt.call(dl,s)?!1:cl.test(s)?fl[s]=!0:(dl[s]=!0,!1)}function Fa(s,r,o){if(Gu(r))if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+o)}}function jn(s,r,o){if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+o)}}function zt(s,r,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(r,o,""+c)}}function nn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $i(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function hl(s,r,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,_=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return v.call(this)},set:function(A){o=""+A,_.call(this,A)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(A){o=""+A},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function ft(s){if(!s._valueTracker){var r=$i(s)?"checked":"value";s._valueTracker=hl(s,r,""+s[r])}}function Jr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return s&&(c=$i(s)?s.checked?"true":"false":s.value),s=c,s!==o?(r.setValue(s),!0):!1}function Os(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Kr=/[\n"\\]/g;function In(s){return s.replace(Kr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function qa(s,r,o,c,v,_,A,I){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),r!=null?A==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+nn(r)):s.value!==""+nn(r)&&(s.value=""+nn(r)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),r!=null?ml(s,A,nn(r)):o!=null?ml(s,A,nn(o)):c!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+nn(I):s.removeAttribute("name")}function $u(s,r,o,c,v,_,A,I){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),r!=null||o!=null){if(!(_!=="submit"&&_!=="reset"||r!=null)){ft(s);return}o=o!=null?""+nn(o):"",r=r!=null?""+nn(r):o,I||r===s.value||(s.value=r),s.defaultValue=r}c=c??v,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=I?s.checked:!!c,s.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),ft(s)}function ml(s,r,o){r==="number"&&Os(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Yi(s,r,o,c){if(s=s.options,r){r={};for(var v=0;v<o.length;v++)r["$"+o[v]]=!0;for(o=0;o<s.length;o++)v=r.hasOwnProperty("$"+s[o].value),s[o].selected!==v&&(s[o].selected=v),v&&c&&(s[o].defaultSelected=!0)}else{for(o=""+nn(o),r=null,v=0;v<s.length;v++){if(s[v].value===o){s[v].selected=!0,c&&(s[v].defaultSelected=!0);return}r!==null||s[v].disabled||(r=s[v])}r!==null&&(r.selected=!0)}}function Yu(s,r,o){if(r!=null&&(r=""+nn(r),r!==s.value&&(s.value=r),o==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=o!=null?""+nn(o):""}function Ji(s,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Be(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=nn(r),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ft(s)}function Nn(s,r){if(r){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=r;return}}s.textContent=r}var Ju=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pl(s,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,o):typeof o!="number"||o===0||Ju.has(r)?r==="float"?s.cssFloat=o:s[r]=(""+o).trim():s[r]=o+"px"}function gl(s,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var v in r)c=r[v],r.hasOwnProperty(v)&&o[v]!==c&&pl(s,v,c)}else for(var _ in r)r.hasOwnProperty(_)&&pl(s,_,r[_])}function Ba(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ki=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function za(s){return Ki.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function hs(){}var yl=null;function Kn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Qi=null,js=null;function Qr(s){var r=Jn(s);if(r&&(s=r.stateNode)){var o=s[tn]||null;e:switch(s=r.stateNode,r.type){case"input":if(qa(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+In(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==s&&c.form===s.form){var v=c[tn]||null;if(!v)throw Error(i(90));qa(c,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===s.form&&Jr(c)}break e;case"textarea":Yu(s,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Yi(s,!!o.multiple,r,!1)}}}var Ha=!1;function Xi(s,r,o){if(Ha)return s(r,o);Ha=!0;try{var c=s(r);return c}finally{if(Ha=!1,(Qi!==null||js!==null)&&(Bc(),Qi&&(r=Qi,s=js,js=Qi=null,Qr(r),s)))for(r=0;r<s.length;r++)Qr(s[r])}}function ms(s,r){var o=s.stateNode;if(o===null)return null;var c=o[tn]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xr=!1;if(Qn)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){Xr=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{Xr=!1}var Fs=null,vl=null,Wr=null;function _l(){if(Wr)return Wr;var s,r=vl,o=r.length,c,v="value"in Fs?Fs.value:Fs.textContent,_=v.length;for(s=0;s<o&&r[s]===v[s];s++);var A=o-s;for(c=1;c<=A&&r[o-c]===v[_-c];c++);return Wr=v.slice(s,1<c?1-c:void 0)}function Zr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function ai(){return!0}function ps(){return!1}function un(s){function r(o,c,v,_,A){this._reactName=o,this._targetInst=v,this.type=c,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(o=s[I],this[I]=o?o(_):_[I]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ai:ps,this.isPropagationStopped=ps,this}return x(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),r}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qs=un(oi),Wi=x({},oi,{view:0,detail:0}),Tl=un(Wi),Zi,Ga,Bs,$a=x({},Wi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:er,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Bs&&(Bs&&s.type==="mousemove"?(Zi=s.screenX-Bs.screenX,Ga=s.screenY-Bs.screenY):Ga=Zi=0,Bs=s),Zi)},movementY:function(s){return"movementY"in s?s.movementY:Ga}}),xl=un($a),ea=x({},$a,{dataTransfer:0}),Qu=un(ea),Xu=x({},Wi,{relatedTarget:0}),ta=un(Xu),El=x({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),Wu=un(El),Ya=x({},oi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Zu=un(Ya),ec=x({},oi,{data:0}),zs=un(ec),tc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ic(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=sc[s])?!!r[s]:!1}function er(){return ic}var En=x({},Wi,{key:function(s){if(s.key){var r=tc[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Zr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?nc[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:er,charCode:function(s){return s.type==="keypress"?Zr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Zr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),rc=un(En),ac=x({},$a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=un(ac),p=x({},Wi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:er}),E=un(p),S=x({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=un(S),Y=x({},$a,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ne=un(Y),ve=x({},oi,{newState:0,oldState:0}),ze=un(ve),Lt=[9,13,27,32],ut=Qn&&"CompositionEvent"in window,It=null;Qn&&"documentMode"in document&&(It=document.documentMode);var Xn=Qn&&"TextEvent"in window&&!It,Hs=Qn&&(!ut||It&&8<It&&11>=It),gs=" ",ys=!1;function na(s,r){switch(s){case"keyup":return Lt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ja(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ka=!1;function dS(s,r){switch(s){case"compositionend":return Ja(r);case"keypress":return r.which!==32?null:(ys=!0,gs);case"textInput":return s=r.data,s===gs&&ys?null:s;default:return null}}function fS(s,r){if(Ka)return s==="compositionend"||!ut&&na(s,r)?(s=_l(),Wr=vl=Fs=null,Ka=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Hs&&r.locale!=="ko"?null:r.data;default:return null}}var hS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!hS[s.type]:r==="textarea"}function Tg(s,r,o,c){Qi?js?js.push(c):js=[c]:Qi=c,r=Kc(r,"onChange"),0<r.length&&(o=new qs("onChange","change",null,o,c),s.push({event:o,listeners:r}))}var bl=null,Al=null;function mS(s){nv(s,0)}function oc(s){var r=On(s);if(Jr(r))return s}function xg(s,r){if(s==="change")return r}var Eg=!1;if(Qn){var If;if(Qn){var Nf="oninput"in document;if(!Nf){var bg=document.createElement("div");bg.setAttribute("oninput","return;"),Nf=typeof bg.oninput=="function"}If=Nf}else If=!1;Eg=If&&(!document.documentMode||9<document.documentMode)}function Ag(){bl&&(bl.detachEvent("onpropertychange",Sg),Al=bl=null)}function Sg(s){if(s.propertyName==="value"&&oc(Al)){var r=[];Tg(r,Al,s,Kn(s)),Xi(mS,r)}}function pS(s,r,o){s==="focusin"?(Ag(),bl=r,Al=o,bl.attachEvent("onpropertychange",Sg)):s==="focusout"&&Ag()}function gS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return oc(Al)}function yS(s,r){if(s==="click")return oc(r)}function vS(s,r){if(s==="input"||s==="change")return oc(r)}function _S(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Fn=typeof Object.is=="function"?Object.is:_S;function Sl(s,r){if(Fn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var o=Object.keys(s),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var v=o[c];if(!Dt.call(r,v)||!Fn(s[v],r[v]))return!1}return!0}function Cg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function wg(s,r){var o=Cg(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=r&&c>=r)return{node:o,offset:r-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Cg(o)}}function Ig(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Ig(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ng(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Os(s.document);r instanceof s.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)s=r.contentWindow;else break;r=Os(s.document)}return r}function Rf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var TS=Qn&&"documentMode"in document&&11>=document.documentMode,Qa=null,Df=null,Cl=null,Mf=!1;function Rg(s,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Mf||Qa==null||Qa!==Os(c)||(c=Qa,"selectionStart"in c&&Rf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Cl&&Sl(Cl,c)||(Cl=c,c=Kc(Df,"onSelect"),0<c.length&&(r=new qs("onSelect","select",null,r,o),s.push({event:r,listeners:c}),r.target=Qa)))}function sa(s,r){var o={};return o[s.toLowerCase()]=r.toLowerCase(),o["Webkit"+s]="webkit"+r,o["Moz"+s]="moz"+r,o}var Xa={animationend:sa("Animation","AnimationEnd"),animationiteration:sa("Animation","AnimationIteration"),animationstart:sa("Animation","AnimationStart"),transitionrun:sa("Transition","TransitionRun"),transitionstart:sa("Transition","TransitionStart"),transitioncancel:sa("Transition","TransitionCancel"),transitionend:sa("Transition","TransitionEnd")},Pf={},Dg={};Qn&&(Dg=document.createElement("div").style,"AnimationEvent"in window||(delete Xa.animationend.animation,delete Xa.animationiteration.animation,delete Xa.animationstart.animation),"TransitionEvent"in window||delete Xa.transitionend.transition);function ia(s){if(Pf[s])return Pf[s];if(!Xa[s])return s;var r=Xa[s],o;for(o in r)if(r.hasOwnProperty(o)&&o in Dg)return Pf[s]=r[o];return s}var Mg=ia("animationend"),Pg=ia("animationiteration"),kg=ia("animationstart"),xS=ia("transitionrun"),ES=ia("transitionstart"),bS=ia("transitioncancel"),Vg=ia("transitionend"),Lg=new Map,kf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kf.push("scrollEnd");function vs(s,r){Lg.set(s,r),Ls(r,[s])}var lc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Wn=[],Wa=0,Vf=0;function uc(){for(var s=Wa,r=Vf=Wa=0;r<s;){var o=Wn[r];Wn[r++]=null;var c=Wn[r];Wn[r++]=null;var v=Wn[r];Wn[r++]=null;var _=Wn[r];if(Wn[r++]=null,c!==null&&v!==null){var A=c.pending;A===null?v.next=v:(v.next=A.next,A.next=v),c.pending=v}_!==0&&Ug(o,v,_)}}function cc(s,r,o,c){Wn[Wa++]=s,Wn[Wa++]=r,Wn[Wa++]=o,Wn[Wa++]=c,Vf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Lf(s,r,o,c){return cc(s,r,o,c),dc(s)}function ra(s,r){return cc(s,null,null,r),dc(s)}function Ug(s,r,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var v=!1,_=s.return;_!==null;)_.childLanes|=o,c=_.alternate,c!==null&&(c.childLanes|=o),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&r!==null&&(v=31-_e(o),s=_.hiddenUpdates,c=s[v],c===null?s[v]=[r]:c.push(r),r.lane=o|536870912),_):null}function dc(s){if(50<Jl)throw Jl=0,Gh=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Za={};function AS(s,r,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(s,r,o,c){return new AS(s,r,o,c)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ui(s,r){var o=s.alternate;return o===null?(o=qn(s.tag,r,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=r,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,r=s.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function Og(s,r){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function fc(s,r,o,c,v,_){var A=0;if(c=s,typeof s=="function")Uf(s)&&(A=1);else if(typeof s=="string")A=NC(s,o,Ee.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=qn(31,o,r,v),s.elementType=D,s.lanes=_,s;case U:return aa(o.children,v,_,r);case L:A=8,v|=24;break;case G:return s=qn(12,o,r,v|2),s.elementType=G,s.lanes=_,s;case Q:return s=qn(13,o,r,v),s.elementType=Q,s.lanes=_,s;case H:return s=qn(19,o,r,v),s.elementType=H,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:A=10;break e;case W:A=9;break e;case F:A=11;break e;case R:A=14;break e;case C:A=16,c=null;break e}A=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=qn(A,o,r,v),r.elementType=s,r.type=c,r.lanes=_,r}function aa(s,r,o,c){return s=qn(7,s,c,r),s.lanes=o,s}function Of(s,r,o){return s=qn(6,s,null,r),s.lanes=o,s}function jg(s){var r=qn(18,null,null,0);return r.stateNode=s,r}function jf(s,r,o){return r=qn(4,s.children!==null?s.children:[],s.key,r),r.lanes=o,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Fg=new WeakMap;function Zn(s,r){if(typeof s=="object"&&s!==null){var o=Fg.get(s);return o!==void 0?o:(r={value:s,source:r,stack:zr(r)},Fg.set(s,r),r)}return{value:s,source:r,stack:zr(r)}}var eo=[],to=0,hc=null,wl=0,es=[],ts=0,tr=null,Gs=1,$s="";function ci(s,r){eo[to++]=wl,eo[to++]=hc,hc=s,wl=r}function qg(s,r,o){es[ts++]=Gs,es[ts++]=$s,es[ts++]=tr,tr=s;var c=Gs;s=$s;var v=32-_e(c)-1;c&=~(1<<v),o+=1;var _=32-_e(r)+v;if(30<_){var A=v-v%5;_=(c&(1<<A)-1).toString(32),c>>=A,v-=A,Gs=1<<32-_e(r)+v|o<<v|c,$s=_+s}else Gs=1<<_|o<<v|c,$s=s}function Ff(s){s.return!==null&&(ci(s,1),qg(s,1,0))}function qf(s){for(;s===hc;)hc=eo[--to],eo[to]=null,wl=eo[--to],eo[to]=null;for(;s===tr;)tr=es[--ts],es[ts]=null,$s=es[--ts],es[ts]=null,Gs=es[--ts],es[ts]=null}function Bg(s,r){es[ts++]=Gs,es[ts++]=$s,es[ts++]=tr,Gs=r.id,$s=r.overflow,tr=s}var cn=null,bt=null,st=!1,nr=null,ns=!1,Bf=Error(i(519));function sr(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Il(Zn(r,s)),Bf}function zg(s){var r=s.stateNode,o=s.type,c=s.memoizedProps;switch(r[qt]=s,r[tn]=c,o){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(o=0;o<Ql.length;o++)Qe(Ql[o],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":Qe("invalid",r),$u(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Qe("invalid",r);break;case"textarea":Qe("invalid",r),Ji(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||av(r.textContent,o)?(c.popover!=null&&(Qe("beforetoggle",r),Qe("toggle",r)),c.onScroll!=null&&Qe("scroll",r),c.onScrollEnd!=null&&Qe("scrollend",r),c.onClick!=null&&(r.onclick=hs),r=!0):r=!1,r||sr(s,!0)}function Hg(s){for(cn=s.return;cn;)switch(cn.tag){case 5:case 31:case 13:ns=!1;return;case 27:case 3:ns=!0;return;default:cn=cn.return}}function no(s){if(s!==cn)return!1;if(!st)return Hg(s),st=!0,!1;var r=s.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||am(s.type,s.memoizedProps)),o=!o),o&&bt&&sr(s),Hg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));bt=pv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));bt=pv(s)}else r===27?(r=bt,yr(s.type)?(s=dm,dm=null,bt=s):bt=r):bt=cn?is(s.stateNode.nextSibling):null;return!0}function oa(){bt=cn=null,st=!1}function zf(){var s=nr;return s!==null&&(Pn===null?Pn=s:Pn.push.apply(Pn,s),nr=null),s}function Il(s){nr===null?nr=[s]:nr.push(s)}var Hf=q(null),la=null,di=null;function ir(s,r,o){Te(Hf,r._currentValue),r._currentValue=o}function fi(s){s._currentValue=Hf.current,ae(Hf)}function Gf(s,r,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===o)break;s=s.return}}function $f(s,r,o,c){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var A=v.child;_=_.firstContext;e:for(;_!==null;){var I=_;_=v;for(var j=0;j<r.length;j++)if(I.context===r[j]){_.lanes|=o,I=_.alternate,I!==null&&(I.lanes|=o),Gf(_.return,o,s),c||(A=null);break e}_=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(i(341));A.lanes|=o,_=A.alternate,_!==null&&(_.lanes|=o),Gf(A,o,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function so(s,r,o,c){s=null;for(var v=r,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var I=v.type;Fn(v.pendingProps.value,A.value)||(s!==null?s.push(I):s=[I])}}else if(v===Ye.current){if(A=v.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(tu):s=[tu])}v=v.return}s!==null&&$f(r,s,o,c),r.flags|=262144}function mc(s){for(s=s.firstContext;s!==null;){if(!Fn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ua(s){la=s,di=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function dn(s){return Gg(la,s)}function pc(s,r){return la===null&&ua(s),Gg(s,r)}function Gg(s,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},di===null){if(s===null)throw Error(i(308));di=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else di=di.next=r;return o}var SS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(o){return o()})}},CS=n.unstable_scheduleCallback,wS=n.unstable_NormalPriority,Ht={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new SS,data:new Map,refCount:0}}function Nl(s){s.refCount--,s.refCount===0&&CS(wS,function(){s.controller.abort()})}var Rl=null,Jf=0,io=0,ro=null;function IS(s,r){if(Rl===null){var o=Rl=[];Jf=0,io=Xh(),ro={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Jf++,r.then($g,$g),r}function $g(){if(--Jf===0&&Rl!==null){ro!==null&&(ro.status="fulfilled");var s=Rl;Rl=null,io=0,ro=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function NS(s,r){var o=[],c={status:"pending",value:null,reason:null,then:function(v){o.push(v)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var v=0;v<o.length;v++)(0,o[v])(r)},function(v){for(c.status="rejected",c.reason=v,v=0;v<o.length;v++)(0,o[v])(void 0)}),c}var Yg=te.S;te.S=function(s,r){R0=ln(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&IS(s,r),Yg!==null&&Yg(s,r)};var ca=q(null);function Kf(){var s=ca.current;return s!==null?s:Tt.pooledCache}function gc(s,r){r===null?Te(ca,ca.current):Te(ca,r.pool)}function Jg(){var s=Kf();return s===null?null:{parent:Ht._currentValue,pool:s}}var ao=Error(i(460)),Qf=Error(i(474)),yc=Error(i(542)),vc={then:function(){}};function Kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Qg(s,r,o){switch(o=s[o],o===void 0?s.push(r):o!==r&&(r.then(hs,hs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s;default:if(typeof r.status=="string")r.then(hs,hs);else{if(s=Tt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var v=r;v.status="fulfilled",v.value=c}},function(c){if(r.status==="pending"){var v=r;v.status="rejected",v.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s}throw fa=r,ao}}function da(s){try{var r=s._init;return r(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(fa=o,ao):o}}var fa=null;function Xg(){if(fa===null)throw Error(i(459));var s=fa;return fa=null,s}function Wg(s){if(s===ao||s===yc)throw Error(i(483))}var oo=null,Dl=0;function _c(s){var r=Dl;return Dl+=1,oo===null&&(oo=[]),Qg(oo,s,r)}function Ml(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function Tc(s,r){throw r.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Zg(s){function r($,B){if(s){var J=$.deletions;J===null?($.deletions=[B],$.flags|=16):J.push(B)}}function o($,B){if(!s)return null;for(;B!==null;)r($,B),B=B.sibling;return null}function c($){for(var B=new Map;$!==null;)$.key!==null?B.set($.key,$):B.set($.index,$),$=$.sibling;return B}function v($,B){return $=ui($,B),$.index=0,$.sibling=null,$}function _($,B,J){return $.index=J,s?(J=$.alternate,J!==null?(J=J.index,J<B?($.flags|=67108866,B):J):($.flags|=67108866,B)):($.flags|=1048576,B)}function A($){return s&&$.alternate===null&&($.flags|=67108866),$}function I($,B,J,oe){return B===null||B.tag!==6?(B=Of(J,$.mode,oe),B.return=$,B):(B=v(B,J),B.return=$,B)}function j($,B,J,oe){var Ne=J.type;return Ne===U?re($,B,J.props.children,oe,J.key):B!==null&&(B.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===C&&da(Ne)===B.type)?(B=v(B,J.props),Ml(B,J),B.return=$,B):(B=fc(J.type,J.key,J.props,null,$.mode,oe),Ml(B,J),B.return=$,B)}function K($,B,J,oe){return B===null||B.tag!==4||B.stateNode.containerInfo!==J.containerInfo||B.stateNode.implementation!==J.implementation?(B=jf(J,$.mode,oe),B.return=$,B):(B=v(B,J.children||[]),B.return=$,B)}function re($,B,J,oe,Ne){return B===null||B.tag!==7?(B=aa(J,$.mode,oe,Ne),B.return=$,B):(B=v(B,J),B.return=$,B)}function le($,B,J){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Of(""+B,$.mode,J),B.return=$,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case w:return J=fc(B.type,B.key,B.props,null,$.mode,J),Ml(J,B),J.return=$,J;case V:return B=jf(B,$.mode,J),B.return=$,B;case C:return B=da(B),le($,B,J)}if(Be(B)||O(B))return B=aa(B,$.mode,J,null),B.return=$,B;if(typeof B.then=="function")return le($,_c(B),J);if(B.$$typeof===ee)return le($,pc($,B),J);Tc($,B)}return null}function X($,B,J,oe){var Ne=B!==null?B.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Ne!==null?null:I($,B,""+J,oe);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case w:return J.key===Ne?j($,B,J,oe):null;case V:return J.key===Ne?K($,B,J,oe):null;case C:return J=da(J),X($,B,J,oe)}if(Be(J)||O(J))return Ne!==null?null:re($,B,J,oe,null);if(typeof J.then=="function")return X($,B,_c(J),oe);if(J.$$typeof===ee)return X($,B,pc($,J),oe);Tc($,J)}return null}function se($,B,J,oe,Ne){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return $=$.get(J)||null,I(B,$,""+oe,Ne);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case w:return $=$.get(oe.key===null?J:oe.key)||null,j(B,$,oe,Ne);case V:return $=$.get(oe.key===null?J:oe.key)||null,K(B,$,oe,Ne);case C:return oe=da(oe),se($,B,J,oe,Ne)}if(Be(oe)||O(oe))return $=$.get(J)||null,re(B,$,oe,Ne,null);if(typeof oe.then=="function")return se($,B,J,_c(oe),Ne);if(oe.$$typeof===ee)return se($,B,J,pc(B,oe),Ne);Tc(B,oe)}return null}function Ae($,B,J,oe){for(var Ne=null,at=null,we=B,$e=B=0,Ze=null;we!==null&&$e<J.length;$e++){we.index>$e?(Ze=we,we=null):Ze=we.sibling;var ot=X($,we,J[$e],oe);if(ot===null){we===null&&(we=Ze);break}s&&we&&ot.alternate===null&&r($,we),B=_(ot,B,$e),at===null?Ne=ot:at.sibling=ot,at=ot,we=Ze}if($e===J.length)return o($,we),st&&ci($,$e),Ne;if(we===null){for(;$e<J.length;$e++)we=le($,J[$e],oe),we!==null&&(B=_(we,B,$e),at===null?Ne=we:at.sibling=we,at=we);return st&&ci($,$e),Ne}for(we=c(we);$e<J.length;$e++)Ze=se(we,$,$e,J[$e],oe),Ze!==null&&(s&&Ze.alternate!==null&&we.delete(Ze.key===null?$e:Ze.key),B=_(Ze,B,$e),at===null?Ne=Ze:at.sibling=Ze,at=Ze);return s&&we.forEach(function(Er){return r($,Er)}),st&&ci($,$e),Ne}function Pe($,B,J,oe){if(J==null)throw Error(i(151));for(var Ne=null,at=null,we=B,$e=B=0,Ze=null,ot=J.next();we!==null&&!ot.done;$e++,ot=J.next()){we.index>$e?(Ze=we,we=null):Ze=we.sibling;var Er=X($,we,ot.value,oe);if(Er===null){we===null&&(we=Ze);break}s&&we&&Er.alternate===null&&r($,we),B=_(Er,B,$e),at===null?Ne=Er:at.sibling=Er,at=Er,we=Ze}if(ot.done)return o($,we),st&&ci($,$e),Ne;if(we===null){for(;!ot.done;$e++,ot=J.next())ot=le($,ot.value,oe),ot!==null&&(B=_(ot,B,$e),at===null?Ne=ot:at.sibling=ot,at=ot);return st&&ci($,$e),Ne}for(we=c(we);!ot.done;$e++,ot=J.next())ot=se(we,$,$e,ot.value,oe),ot!==null&&(s&&ot.alternate!==null&&we.delete(ot.key===null?$e:ot.key),B=_(ot,B,$e),at===null?Ne=ot:at.sibling=ot,at=ot);return s&&we.forEach(function(FC){return r($,FC)}),st&&ci($,$e),Ne}function vt($,B,J,oe){if(typeof J=="object"&&J!==null&&J.type===U&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case w:e:{for(var Ne=J.key;B!==null;){if(B.key===Ne){if(Ne=J.type,Ne===U){if(B.tag===7){o($,B.sibling),oe=v(B,J.props.children),oe.return=$,$=oe;break e}}else if(B.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===C&&da(Ne)===B.type){o($,B.sibling),oe=v(B,J.props),Ml(oe,J),oe.return=$,$=oe;break e}o($,B);break}else r($,B);B=B.sibling}J.type===U?(oe=aa(J.props.children,$.mode,oe,J.key),oe.return=$,$=oe):(oe=fc(J.type,J.key,J.props,null,$.mode,oe),Ml(oe,J),oe.return=$,$=oe)}return A($);case V:e:{for(Ne=J.key;B!==null;){if(B.key===Ne)if(B.tag===4&&B.stateNode.containerInfo===J.containerInfo&&B.stateNode.implementation===J.implementation){o($,B.sibling),oe=v(B,J.children||[]),oe.return=$,$=oe;break e}else{o($,B);break}else r($,B);B=B.sibling}oe=jf(J,$.mode,oe),oe.return=$,$=oe}return A($);case C:return J=da(J),vt($,B,J,oe)}if(Be(J))return Ae($,B,J,oe);if(O(J)){if(Ne=O(J),typeof Ne!="function")throw Error(i(150));return J=Ne.call(J),Pe($,B,J,oe)}if(typeof J.then=="function")return vt($,B,_c(J),oe);if(J.$$typeof===ee)return vt($,B,pc($,J),oe);Tc($,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,B!==null&&B.tag===6?(o($,B.sibling),oe=v(B,J),oe.return=$,$=oe):(o($,B),oe=Of(J,$.mode,oe),oe.return=$,$=oe),A($)):o($,B)}return function($,B,J,oe){try{Dl=0;var Ne=vt($,B,J,oe);return oo=null,Ne}catch(we){if(we===ao||we===yc)throw we;var at=qn(29,we,null,$.mode);return at.lanes=oe,at.return=$,at}finally{}}}var ha=Zg(!0),ey=Zg(!1),rr=!1;function Xf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ar(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function or(s,r,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(ct&2)!==0){var v=c.pending;return v===null?r.next=r:(r.next=v.next,v.next=r),c.pending=r,r=dc(s),Ug(s,null,o),r}return cc(s,c,r,o),dc(s)}function Pl(s,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,Gi(s,o)}}function Zf(s,r){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var v=null,_=null;if(o=o.firstBaseUpdate,o!==null){do{var A={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};_===null?v=_=A:_=_.next=A,o=o.next}while(o!==null);_===null?v=_=r:_=_.next=r}else v=_=r;o={baseState:c.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=r:s.next=r,o.lastBaseUpdate=r}var eh=!1;function kl(){if(eh){var s=ro;if(s!==null)throw s}}function Vl(s,r,o,c){eh=!1;var v=s.updateQueue;rr=!1;var _=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var j=I,K=j.next;j.next=null,A===null?_=K:A.next=K,A=j;var re=s.alternate;re!==null&&(re=re.updateQueue,I=re.lastBaseUpdate,I!==A&&(I===null?re.firstBaseUpdate=K:I.next=K,re.lastBaseUpdate=j))}if(_!==null){var le=v.baseState;A=0,re=K=j=null,I=_;do{var X=I.lane&-536870913,se=X!==I.lane;if(se?(We&X)===X:(c&X)===X){X!==0&&X===io&&(eh=!0),re!==null&&(re=re.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ae=s,Pe=I;X=r;var vt=o;switch(Pe.tag){case 1:if(Ae=Pe.payload,typeof Ae=="function"){le=Ae.call(vt,le,X);break e}le=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Pe.payload,X=typeof Ae=="function"?Ae.call(vt,le,X):Ae,X==null)break e;le=x({},le,X);break e;case 2:rr=!0}}X=I.callback,X!==null&&(s.flags|=64,se&&(s.flags|=8192),se=v.callbacks,se===null?v.callbacks=[X]:se.push(X))}else se={lane:X,tag:I.tag,payload:I.payload,callback:I.callback,next:null},re===null?(K=re=se,j=le):re=re.next=se,A|=X;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;se=I,I=se.next,se.next=null,v.lastBaseUpdate=se,v.shared.pending=null}}while(!0);re===null&&(j=le),v.baseState=j,v.firstBaseUpdate=K,v.lastBaseUpdate=re,_===null&&(v.shared.lanes=0),fr|=A,s.lanes=A,s.memoizedState=le}}function ty(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function ny(s,r){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)ty(o[s],r)}var lo=q(null),xc=q(0);function sy(s,r){s=xi,Te(xc,s),Te(lo,r),xi=s|r.baseLanes}function th(){Te(xc,xi),Te(lo,lo.current)}function nh(){xi=xc.current,ae(lo),ae(xc)}var Bn=q(null),ss=null;function lr(s){var r=s.alternate;Te(Ut,Ut.current&1),Te(Bn,s),ss===null&&(r===null||lo.current!==null||r.memoizedState!==null)&&(ss=s)}function sh(s){Te(Ut,Ut.current),Te(Bn,s),ss===null&&(ss=s)}function iy(s){s.tag===22?(Te(Ut,Ut.current),Te(Bn,s),ss===null&&(ss=s)):ur()}function ur(){Te(Ut,Ut.current),Te(Bn,Bn.current)}function zn(s){ae(Bn),ss===s&&(ss=null),ae(Ut)}var Ut=q(0);function Ec(s){for(var r=s;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||um(o)||cm(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var hi=0,He=null,gt=null,Gt=null,bc=!1,uo=!1,ma=!1,Ac=0,Ll=0,co=null,RS=0;function Mt(){throw Error(i(321))}function ih(s,r){if(r===null)return!1;for(var o=0;o<r.length&&o<s.length;o++)if(!Fn(s[o],r[o]))return!1;return!0}function rh(s,r,o,c,v,_){return hi=_,He=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,te.H=s===null||s.memoizedState===null?qy:Th,ma=!1,_=o(c,v),ma=!1,uo&&(_=ay(r,o,c,v)),ry(s),_}function ry(s){te.H=jl;var r=gt!==null&&gt.next!==null;if(hi=0,Gt=gt=He=null,bc=!1,Ll=0,co=null,r)throw Error(i(300));s===null||$t||(s=s.dependencies,s!==null&&mc(s)&&($t=!0))}function ay(s,r,o,c){He=s;var v=0;do{if(uo&&(co=null),Ll=0,uo=!1,25<=v)throw Error(i(301));if(v+=1,Gt=gt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}te.H=By,_=r(o,c)}while(uo);return _}function DS(){var s=te.H,r=s.useState()[0];return r=typeof r.then=="function"?Ul(r):r,s=s.useState()[0],(gt!==null?gt.memoizedState:null)!==s&&(He.flags|=1024),r}function ah(){var s=Ac!==0;return Ac=0,s}function oh(s,r,o){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~o}function lh(s){if(bc){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}bc=!1}hi=0,Gt=gt=He=null,uo=!1,Ll=Ac=0,co=null}function bn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?He.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function Ot(){if(gt===null){var s=He.alternate;s=s!==null?s.memoizedState:null}else s=gt.next;var r=Gt===null?He.memoizedState:Gt.next;if(r!==null)Gt=r,gt=s;else{if(s===null)throw He.alternate===null?Error(i(467)):Error(i(310));gt=s,s={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Gt===null?He.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function Sc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ul(s){var r=Ll;return Ll+=1,co===null&&(co=[]),s=Qg(co,s,r),r=He,(Gt===null?r.memoizedState:Gt.next)===null&&(r=r.alternate,te.H=r===null||r.memoizedState===null?qy:Th),s}function Cc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ul(s);if(s.$$typeof===ee)return dn(s)}throw Error(i(438,String(s)))}function uh(s){var r=null,o=He.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(v){return v.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=Sc(),He.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(s),c=0;c<s;c++)o[c]=N;return r.index++,o}function mi(s,r){return typeof r=="function"?r(s):r}function wc(s){var r=Ot();return ch(r,gt,s)}function ch(s,r,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var v=s.baseQueue,_=c.pending;if(_!==null){if(v!==null){var A=v.next;v.next=_.next,_.next=A}r.baseQueue=v=_,c.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{r=v.next;var I=A=null,j=null,K=r,re=!1;do{var le=K.lane&-536870913;if(le!==K.lane?(We&le)===le:(hi&le)===le){var X=K.revertLane;if(X===0)j!==null&&(j=j.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),le===io&&(re=!0);else if((hi&X)===X){K=K.next,X===io&&(re=!0);continue}else le={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},j===null?(I=j=le,A=_):j=j.next=le,He.lanes|=X,fr|=X;le=K.action,ma&&o(_,le),_=K.hasEagerState?K.eagerState:o(_,le)}else X={lane:le,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},j===null?(I=j=X,A=_):j=j.next=X,He.lanes|=le,fr|=le;K=K.next}while(K!==null&&K!==r);if(j===null?A=_:j.next=I,!Fn(_,s.memoizedState)&&($t=!0,re&&(o=ro,o!==null)))throw o;s.memoizedState=_,s.baseState=A,s.baseQueue=j,c.lastRenderedState=_}return v===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function dh(s){var r=Ot(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,v=o.pending,_=r.memoizedState;if(v!==null){o.pending=null;var A=v=v.next;do _=s(_,A.action),A=A.next;while(A!==v);Fn(_,r.memoizedState)||($t=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),o.lastRenderedState=_}return[_,c]}function oy(s,r,o){var c=He,v=Ot(),_=st;if(_){if(o===void 0)throw Error(i(407));o=o()}else o=r();var A=!Fn((gt||v).memoizedState,o);if(A&&(v.memoizedState=o,$t=!0),v=v.queue,mh(cy.bind(null,c,v,s),[s]),v.getSnapshot!==r||A||Gt!==null&&Gt.memoizedState.tag&1){if(c.flags|=2048,fo(9,{destroy:void 0},uy.bind(null,c,v,o,r),null),Tt===null)throw Error(i(349));_||(hi&127)!==0||ly(c,r,o)}return o}function ly(s,r,o){s.flags|=16384,s={getSnapshot:r,value:o},r=He.updateQueue,r===null?(r=Sc(),He.updateQueue=r,r.stores=[s]):(o=r.stores,o===null?r.stores=[s]:o.push(s))}function uy(s,r,o,c){r.value=o,r.getSnapshot=c,dy(r)&&fy(s)}function cy(s,r,o){return o(function(){dy(r)&&fy(s)})}function dy(s){var r=s.getSnapshot;s=s.value;try{var o=r();return!Fn(s,o)}catch{return!0}}function fy(s){var r=ra(s,2);r!==null&&kn(r,s,2)}function fh(s){var r=bn();if(typeof s=="function"){var o=s;if(s=o(),ma){ye(!0);try{o()}finally{ye(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:s},r}function hy(s,r,o,c){return s.baseState=o,ch(s,gt,typeof c=="function"?c:mi)}function MS(s,r,o,c,v){if(Rc(s))throw Error(i(485));if(s=r.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};te.T!==null?o(!0):_.isTransition=!1,c(_),o=r.pending,o===null?(_.next=r.pending=_,my(r,_)):(_.next=o.next,r.pending=o.next=_)}}function my(s,r){var o=r.action,c=r.payload,v=s.state;if(r.isTransition){var _=te.T,A={};te.T=A;try{var I=o(v,c),j=te.S;j!==null&&j(A,I),py(s,r,I)}catch(K){hh(s,r,K)}finally{_!==null&&A.types!==null&&(_.types=A.types),te.T=_}}else try{_=o(v,c),py(s,r,_)}catch(K){hh(s,r,K)}}function py(s,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){gy(s,r,c)},function(c){return hh(s,r,c)}):gy(s,r,o)}function gy(s,r,o){r.status="fulfilled",r.value=o,yy(r),s.state=o,r=s.pending,r!==null&&(o=r.next,o===r?s.pending=null:(o=o.next,r.next=o,my(s,o)))}function hh(s,r,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,yy(r),r=r.next;while(r!==c)}s.action=null}function yy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function vy(s,r){return r}function _y(s,r){if(st){var o=Tt.formState;if(o!==null){e:{var c=He;if(st){if(bt){t:{for(var v=bt,_=ns;v.nodeType!==8;){if(!_){v=null;break t}if(v=is(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){bt=is(v.nextSibling),c=v.data==="F!";break e}}sr(c)}c=!1}c&&(r=o[0])}}return o=bn(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vy,lastRenderedState:r},o.queue=c,o=Oy.bind(null,He,c),c.dispatch=o,c=fh(!1),_=_h.bind(null,He,!1,c.queue),c=bn(),v={state:r,dispatch:null,action:s,pending:null},c.queue=v,o=MS.bind(null,He,v,_,o),v.dispatch=o,c.memoizedState=s,[r,o,!1]}function Ty(s){var r=Ot();return xy(r,gt,s)}function xy(s,r,o){if(r=ch(s,r,vy)[0],s=wc(mi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Ul(r)}catch(A){throw A===ao?yc:A}else c=r;r=Ot();var v=r.queue,_=v.dispatch;return o!==r.memoizedState&&(He.flags|=2048,fo(9,{destroy:void 0},PS.bind(null,v,o),null)),[c,_,s]}function PS(s,r){s.action=r}function Ey(s){var r=Ot(),o=gt;if(o!==null)return xy(r,o,s);Ot(),r=r.memoizedState,o=Ot();var c=o.queue.dispatch;return o.memoizedState=s,[r,c,!1]}function fo(s,r,o,c){return s={tag:s,create:o,deps:c,inst:r,next:null},r=He.updateQueue,r===null&&(r=Sc(),He.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,r.lastEffect=s),s}function by(){return Ot().memoizedState}function Ic(s,r,o,c){var v=bn();He.flags|=s,v.memoizedState=fo(1|r,{destroy:void 0},o,c===void 0?null:c)}function Nc(s,r,o,c){var v=Ot();c=c===void 0?null:c;var _=v.memoizedState.inst;gt!==null&&c!==null&&ih(c,gt.memoizedState.deps)?v.memoizedState=fo(r,_,o,c):(He.flags|=s,v.memoizedState=fo(1|r,_,o,c))}function Ay(s,r){Ic(8390656,8,s,r)}function mh(s,r){Nc(2048,8,s,r)}function kS(s){He.flags|=4;var r=He.updateQueue;if(r===null)r=Sc(),He.updateQueue=r,r.events=[s];else{var o=r.events;o===null?r.events=[s]:o.push(s)}}function Sy(s){var r=Ot().memoizedState;return kS({ref:r,nextImpl:s}),function(){if((ct&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Cy(s,r){return Nc(4,2,s,r)}function wy(s,r){return Nc(4,4,s,r)}function Iy(s,r){if(typeof r=="function"){s=s();var o=r(s);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Ny(s,r,o){o=o!=null?o.concat([s]):null,Nc(4,4,Iy.bind(null,r,s),o)}function ph(){}function Ry(s,r){var o=Ot();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&ih(r,c[1])?c[0]:(o.memoizedState=[s,r],s)}function Dy(s,r){var o=Ot();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&ih(r,c[1]))return c[0];if(c=s(),ma){ye(!0);try{s()}finally{ye(!1)}}return o.memoizedState=[c,r],c}function gh(s,r,o){return o===void 0||(hi&1073741824)!==0&&(We&261930)===0?s.memoizedState=r:(s.memoizedState=o,s=M0(),He.lanes|=s,fr|=s,o)}function My(s,r,o,c){return Fn(o,r)?o:lo.current!==null?(s=gh(s,o,c),Fn(s,r)||($t=!0),s):(hi&42)===0||(hi&1073741824)!==0&&(We&261930)===0?($t=!0,s.memoizedState=o):(s=M0(),He.lanes|=s,fr|=s,r)}function Py(s,r,o,c,v){var _=Z.p;Z.p=_!==0&&8>_?_:8;var A=te.T,I={};te.T=I,_h(s,!1,r,o);try{var j=v(),K=te.S;if(K!==null&&K(I,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var re=NS(j,c);Ol(s,r,re,$n(s))}else Ol(s,r,c,$n(s))}catch(le){Ol(s,r,{then:function(){},status:"rejected",reason:le},$n())}finally{Z.p=_,A!==null&&I.types!==null&&(A.types=I.types),te.T=A}}function VS(){}function yh(s,r,o,c){if(s.tag!==5)throw Error(i(476));var v=ky(s).queue;Py(s,v,r,pe,o===null?VS:function(){return Vy(s),o(c)})}function ky(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:pe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:o},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Vy(s){var r=ky(s);r.next===null&&(r=s.alternate.memoizedState),Ol(s,r.next.queue,{},$n())}function vh(){return dn(tu)}function Ly(){return Ot().memoizedState}function Uy(){return Ot().memoizedState}function LS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var o=$n();s=ar(o);var c=or(r,s,o);c!==null&&(kn(c,r,o),Pl(c,r,o)),r={cache:Yf()},s.payload=r;return}r=r.return}}function US(s,r,o){var c=$n();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Rc(s)?jy(r,o):(o=Lf(s,r,o,c),o!==null&&(kn(o,s,c),Fy(o,r,c)))}function Oy(s,r,o){var c=$n();Ol(s,r,o,c)}function Ol(s,r,o,c){var v={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Rc(s))jy(r,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var A=r.lastRenderedState,I=_(A,o);if(v.hasEagerState=!0,v.eagerState=I,Fn(I,A))return cc(s,r,v,0),Tt===null&&uc(),!1}catch{}finally{}if(o=Lf(s,r,v,c),o!==null)return kn(o,s,c),Fy(o,r,c),!0}return!1}function _h(s,r,o,c){if(c={lane:2,revertLane:Xh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Rc(s)){if(r)throw Error(i(479))}else r=Lf(s,o,c,2),r!==null&&kn(r,s,2)}function Rc(s){var r=s.alternate;return s===He||r!==null&&r===He}function jy(s,r){uo=bc=!0;var o=s.pending;o===null?r.next=r:(r.next=o.next,o.next=r),s.pending=r}function Fy(s,r,o){if((o&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,Gi(s,o)}}var jl={readContext:dn,use:Cc,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt};jl.useEffectEvent=Mt;var qy={readContext:dn,use:Cc,useCallback:function(s,r){return bn().memoizedState=[s,r===void 0?null:r],s},useContext:dn,useEffect:Ay,useImperativeHandle:function(s,r,o){o=o!=null?o.concat([s]):null,Ic(4194308,4,Iy.bind(null,r,s),o)},useLayoutEffect:function(s,r){return Ic(4194308,4,s,r)},useInsertionEffect:function(s,r){Ic(4,2,s,r)},useMemo:function(s,r){var o=bn();r=r===void 0?null:r;var c=s();if(ma){ye(!0);try{s()}finally{ye(!1)}}return o.memoizedState=[c,r],c},useReducer:function(s,r,o){var c=bn();if(o!==void 0){var v=o(r);if(ma){ye(!0);try{o(r)}finally{ye(!1)}}}else v=r;return c.memoizedState=c.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},c.queue=s,s=s.dispatch=US.bind(null,He,s),[c.memoizedState,s]},useRef:function(s){var r=bn();return s={current:s},r.memoizedState=s},useState:function(s){s=fh(s);var r=s.queue,o=Oy.bind(null,He,r);return r.dispatch=o,[s.memoizedState,o]},useDebugValue:ph,useDeferredValue:function(s,r){var o=bn();return gh(o,s,r)},useTransition:function(){var s=fh(!1);return s=Py.bind(null,He,s.queue,!0,!1),bn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,o){var c=He,v=bn();if(st){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Tt===null)throw Error(i(349));(We&127)!==0||ly(c,r,o)}v.memoizedState=o;var _={value:o,getSnapshot:r};return v.queue=_,Ay(cy.bind(null,c,_,s),[s]),c.flags|=2048,fo(9,{destroy:void 0},uy.bind(null,c,_,o,r),null),o},useId:function(){var s=bn(),r=Tt.identifierPrefix;if(st){var o=$s,c=Gs;o=(c&~(1<<32-_e(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=Ac++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=RS++,r="_"+r+"r_"+o.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:vh,useFormState:_y,useActionState:_y,useOptimistic:function(s){var r=bn();r.memoizedState=r.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=_h.bind(null,He,!0,o),o.dispatch=r,[s,r]},useMemoCache:uh,useCacheRefresh:function(){return bn().memoizedState=LS.bind(null,He)},useEffectEvent:function(s){var r=bn(),o={impl:s};return r.memoizedState=o,function(){if((ct&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Th={readContext:dn,use:Cc,useCallback:Ry,useContext:dn,useEffect:mh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:Dy,useReducer:wc,useRef:by,useState:function(){return wc(mi)},useDebugValue:ph,useDeferredValue:function(s,r){var o=Ot();return My(o,gt.memoizedState,s,r)},useTransition:function(){var s=wc(mi)[0],r=Ot().memoizedState;return[typeof s=="boolean"?s:Ul(s),r]},useSyncExternalStore:oy,useId:Ly,useHostTransitionStatus:vh,useFormState:Ty,useActionState:Ty,useOptimistic:function(s,r){var o=Ot();return hy(o,gt,s,r)},useMemoCache:uh,useCacheRefresh:Uy};Th.useEffectEvent=Sy;var By={readContext:dn,use:Cc,useCallback:Ry,useContext:dn,useEffect:mh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:Dy,useReducer:dh,useRef:by,useState:function(){return dh(mi)},useDebugValue:ph,useDeferredValue:function(s,r){var o=Ot();return gt===null?gh(o,s,r):My(o,gt.memoizedState,s,r)},useTransition:function(){var s=dh(mi)[0],r=Ot().memoizedState;return[typeof s=="boolean"?s:Ul(s),r]},useSyncExternalStore:oy,useId:Ly,useHostTransitionStatus:vh,useFormState:Ey,useActionState:Ey,useOptimistic:function(s,r){var o=Ot();return gt!==null?hy(o,gt,s,r):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:uh,useCacheRefresh:Uy};By.useEffectEvent=Sy;function xh(s,r,o,c){r=s.memoizedState,o=o(c,r),o=o==null?r:x({},r,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Eh={enqueueSetState:function(s,r,o){s=s._reactInternals;var c=$n(),v=ar(c);v.payload=r,o!=null&&(v.callback=o),r=or(s,v,c),r!==null&&(kn(r,s,c),Pl(r,s,c))},enqueueReplaceState:function(s,r,o){s=s._reactInternals;var c=$n(),v=ar(c);v.tag=1,v.payload=r,o!=null&&(v.callback=o),r=or(s,v,c),r!==null&&(kn(r,s,c),Pl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var o=$n(),c=ar(o);c.tag=2,r!=null&&(c.callback=r),r=or(s,c,o),r!==null&&(kn(r,s,o),Pl(r,s,o))}};function zy(s,r,o,c,v,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,_,A):r.prototype&&r.prototype.isPureReactComponent?!Sl(o,c)||!Sl(v,_):!0}function Hy(s,r,o,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==s&&Eh.enqueueReplaceState(r,r.state,null)}function pa(s,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(s=s.defaultProps){o===r&&(o=x({},o));for(var v in s)o[v]===void 0&&(o[v]=s[v])}return o}function Gy(s){lc(s)}function $y(s){console.error(s)}function Yy(s){lc(s)}function Dc(s,r){try{var o=s.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jy(s,r,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function bh(s,r,o){return o=ar(o),o.tag=3,o.payload={element:null},o.callback=function(){Dc(s,r)},o}function Ky(s){return s=ar(s),s.tag=3,s}function Qy(s,r,o,c){var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var _=c.value;s.payload=function(){return v(_)},s.callback=function(){Jy(r,o,c)}}var A=o.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){Jy(r,o,c),typeof v!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function OS(s,r,o,c,v){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&so(r,o,v,!0),o=Bn.current,o!==null){switch(o.tag){case 31:case 13:return ss===null?zc():o.alternate===null&&Pt===0&&(Pt=3),o.flags&=-257,o.flags|=65536,o.lanes=v,c===vc?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Jh(s,c,v)),!1;case 22:return o.flags|=65536,c===vc?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Jh(s,c,v)),!1}throw Error(i(435,o.tag))}return Jh(s,c,v),zc(),!1}if(st)return r=Bn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=v,c!==Bf&&(s=Error(i(422),{cause:c}),Il(Zn(s,o)))):(c!==Bf&&(r=Error(i(423),{cause:c}),Il(Zn(r,o))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,c=Zn(c,o),v=bh(s.stateNode,c,v),Zf(s,v),Pt!==4&&(Pt=2)),!1;var _=Error(i(520),{cause:c});if(_=Zn(_,o),Yl===null?Yl=[_]:Yl.push(_),Pt!==4&&(Pt=2),r===null)return!0;c=Zn(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,s=v&-v,o.lanes|=s,s=bh(o.stateNode,c,s),Zf(o,s),!1;case 1:if(r=o.type,_=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(hr===null||!hr.has(_))))return o.flags|=65536,v&=-v,o.lanes|=v,v=Ky(v),Qy(v,s,o,c),Zf(o,v),!1}o=o.return}while(o!==null);return!1}var Ah=Error(i(461)),$t=!1;function fn(s,r,o,c){r.child=s===null?ey(r,null,o,c):ha(r,s.child,o,c)}function Xy(s,r,o,c,v){o=o.render;var _=r.ref;if("ref"in c){var A={};for(var I in c)I!=="ref"&&(A[I]=c[I])}else A=c;return ua(r),c=rh(s,r,o,A,_,v),I=ah(),s!==null&&!$t?(oh(s,r,v),pi(s,r,v)):(st&&I&&Ff(r),r.flags|=1,fn(s,r,c,v),r.child)}function Wy(s,r,o,c,v){if(s===null){var _=o.type;return typeof _=="function"&&!Uf(_)&&_.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=_,Zy(s,r,_,c,v)):(s=fc(o.type,null,c,r,r.mode,v),s.ref=r.ref,s.return=r,r.child=s)}if(_=s.child,!Mh(s,v)){var A=_.memoizedProps;if(o=o.compare,o=o!==null?o:Sl,o(A,c)&&s.ref===r.ref)return pi(s,r,v)}return r.flags|=1,s=ui(_,c),s.ref=r.ref,s.return=r,r.child=s}function Zy(s,r,o,c,v){if(s!==null){var _=s.memoizedProps;if(Sl(_,c)&&s.ref===r.ref)if($t=!1,r.pendingProps=c=_,Mh(s,v))(s.flags&131072)!==0&&($t=!0);else return r.lanes=s.lanes,pi(s,r,v)}return Sh(s,r,o,c,v)}function e0(s,r,o,c){var v=c.children,_=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(_=_!==null?_.baseLanes|o:o,s!==null){for(c=r.child=s.child,v=0;c!==null;)v=v|c.lanes|c.childLanes,c=c.sibling;c=v&~_}else c=0,r.child=null;return t0(s,r,_,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&gc(r,_!==null?_.cachePool:null),_!==null?sy(r,_):th(),iy(r);else return c=r.lanes=536870912,t0(s,r,_!==null?_.baseLanes|o:o,o,c)}else _!==null?(gc(r,_.cachePool),sy(r,_),ur(),r.memoizedState=null):(s!==null&&gc(r,null),th(),ur());return fn(s,r,v,o),r.child}function Fl(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function t0(s,r,o,c,v){var _=Kf();return _=_===null?null:{parent:Ht._currentValue,pool:_},r.memoizedState={baseLanes:o,cachePool:_},s!==null&&gc(r,null),th(),iy(r),s!==null&&so(s,r,c,!0),r.childLanes=v,null}function Mc(s,r){return r=kc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function n0(s,r,o){return ha(r,s.child,null,o),s=Mc(r,r.pendingProps),s.flags|=2,zn(r),r.memoizedState=null,s}function jS(s,r,o){var c=r.pendingProps,v=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(st){if(c.mode==="hidden")return s=Mc(r,c),r.lanes=536870912,Fl(null,s);if(sh(r),(s=bt)?(s=mv(s,ns),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:tr!==null?{id:Gs,overflow:$s}:null,retryLane:536870912,hydrationErrors:null},o=jg(s),o.return=r,r.child=o,cn=r,bt=null)):s=null,s===null)throw sr(r);return r.lanes=536870912,null}return Mc(r,c)}var _=s.memoizedState;if(_!==null){var A=_.dehydrated;if(sh(r),v)if(r.flags&256)r.flags&=-257,r=n0(s,r,o);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if($t||so(s,r,o,!1),v=(o&s.childLanes)!==0,$t||v){if(c=Tt,c!==null&&(A=ol(c,o),A!==0&&A!==_.retryLane))throw _.retryLane=A,ra(s,A),kn(c,s,A),Ah;zc(),r=n0(s,r,o)}else s=_.treeContext,bt=is(A.nextSibling),cn=r,st=!0,nr=null,ns=!1,s!==null&&Bg(r,s),r=Mc(r,c),r.flags|=4096;return r}return s=ui(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Pc(s,r){var o=r.ref;if(o===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(r.flags|=4194816)}}function Sh(s,r,o,c,v){return ua(r),o=rh(s,r,o,c,void 0,v),c=ah(),s!==null&&!$t?(oh(s,r,v),pi(s,r,v)):(st&&c&&Ff(r),r.flags|=1,fn(s,r,o,v),r.child)}function s0(s,r,o,c,v,_){return ua(r),r.updateQueue=null,o=ay(r,c,o,v),ry(s),c=ah(),s!==null&&!$t?(oh(s,r,_),pi(s,r,_)):(st&&c&&Ff(r),r.flags|=1,fn(s,r,o,_),r.child)}function i0(s,r,o,c,v){if(ua(r),r.stateNode===null){var _=Za,A=o.contextType;typeof A=="object"&&A!==null&&(_=dn(A)),_=new o(c,_),r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Eh,r.stateNode=_,_._reactInternals=r,_=r.stateNode,_.props=c,_.state=r.memoizedState,_.refs={},Xf(r),A=o.contextType,_.context=typeof A=="object"&&A!==null?dn(A):Za,_.state=r.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(xh(r,o,A,c),_.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&Eh.enqueueReplaceState(_,_.state,null),Vl(r,c,_,v),kl(),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){_=r.stateNode;var I=r.memoizedProps,j=pa(o,I);_.props=j;var K=_.context,re=o.contextType;A=Za,typeof re=="object"&&re!==null&&(A=dn(re));var le=o.getDerivedStateFromProps;re=typeof le=="function"||typeof _.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,re||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I||K!==A)&&Hy(r,_,c,A),rr=!1;var X=r.memoizedState;_.state=X,Vl(r,c,_,v),kl(),K=r.memoizedState,I||X!==K||rr?(typeof le=="function"&&(xh(r,o,le,c),K=r.memoizedState),(j=rr||zy(r,o,j,c,X,K,A))?(re||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(r.flags|=4194308)):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=K),_.props=c,_.state=K,_.context=A,c=j):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{_=r.stateNode,Wf(s,r),A=r.memoizedProps,re=pa(o,A),_.props=re,le=r.pendingProps,X=_.context,K=o.contextType,j=Za,typeof K=="object"&&K!==null&&(j=dn(K)),I=o.getDerivedStateFromProps,(K=typeof I=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==le||X!==j)&&Hy(r,_,c,j),rr=!1,X=r.memoizedState,_.state=X,Vl(r,c,_,v),kl();var se=r.memoizedState;A!==le||X!==se||rr||s!==null&&s.dependencies!==null&&mc(s.dependencies)?(typeof I=="function"&&(xh(r,o,I,c),se=r.memoizedState),(re=rr||zy(r,o,re,c,X,se,j)||s!==null&&s.dependencies!==null&&mc(s.dependencies))?(K||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,se,j),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,se,j)),typeof _.componentDidUpdate=="function"&&(r.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=se),_.props=c,_.state=se,_.context=j,c=re):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),c=!1)}return _=c,Pc(s,r),c=(r.flags&128)!==0,_||c?(_=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:_.render(),r.flags|=1,s!==null&&c?(r.child=ha(r,s.child,null,v),r.child=ha(r,null,o,v)):fn(s,r,o,v),r.memoizedState=_.state,s=r.child):s=pi(s,r,v),s}function r0(s,r,o,c){return oa(),r.flags|=256,fn(s,r,o,c),r.child}var Ch={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wh(s){return{baseLanes:s,cachePool:Jg()}}function Ih(s,r,o){return s=s!==null?s.childLanes&~o:0,r&&(s|=Gn),s}function a0(s,r,o){var c=r.pendingProps,v=!1,_=(r.flags&128)!==0,A;if((A=_)||(A=s!==null&&s.memoizedState===null?!1:(Ut.current&2)!==0),A&&(v=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,s===null){if(st){if(v?lr(r):ur(),(s=bt)?(s=mv(s,ns),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:tr!==null?{id:Gs,overflow:$s}:null,retryLane:536870912,hydrationErrors:null},o=jg(s),o.return=r,r.child=o,cn=r,bt=null)):s=null,s===null)throw sr(r);return cm(s)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,v?(ur(),v=r.mode,I=kc({mode:"hidden",children:I},v),c=aa(c,v,o,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=wh(o),c.childLanes=Ih(s,A,o),r.memoizedState=Ch,Fl(null,c)):(lr(r),Nh(r,I))}var j=s.memoizedState;if(j!==null&&(I=j.dehydrated,I!==null)){if(_)r.flags&256?(lr(r),r.flags&=-257,r=Rh(s,r,o)):r.memoizedState!==null?(ur(),r.child=s.child,r.flags|=128,r=null):(ur(),I=c.fallback,v=r.mode,c=kc({mode:"visible",children:c.children},v),I=aa(I,v,o,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,ha(r,s.child,null,o),c=r.child,c.memoizedState=wh(o),c.childLanes=Ih(s,A,o),r.memoizedState=Ch,r=Fl(null,c));else if(lr(r),cm(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var K=A.dgst;A=K,c=Error(i(419)),c.stack="",c.digest=A,Il({value:c,source:null,stack:null}),r=Rh(s,r,o)}else if($t||so(s,r,o,!1),A=(o&s.childLanes)!==0,$t||A){if(A=Tt,A!==null&&(c=ol(A,o),c!==0&&c!==j.retryLane))throw j.retryLane=c,ra(s,c),kn(A,s,c),Ah;um(I)||zc(),r=Rh(s,r,o)}else um(I)?(r.flags|=192,r.child=s.child,r=null):(s=j.treeContext,bt=is(I.nextSibling),cn=r,st=!0,nr=null,ns=!1,s!==null&&Bg(r,s),r=Nh(r,c.children),r.flags|=4096);return r}return v?(ur(),I=c.fallback,v=r.mode,j=s.child,K=j.sibling,c=ui(j,{mode:"hidden",children:c.children}),c.subtreeFlags=j.subtreeFlags&65011712,K!==null?I=ui(K,I):(I=aa(I,v,o,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,Fl(null,c),c=r.child,I=s.child.memoizedState,I===null?I=wh(o):(v=I.cachePool,v!==null?(j=Ht._currentValue,v=v.parent!==j?{parent:j,pool:j}:v):v=Jg(),I={baseLanes:I.baseLanes|o,cachePool:v}),c.memoizedState=I,c.childLanes=Ih(s,A,o),r.memoizedState=Ch,Fl(s.child,c)):(lr(r),o=s.child,s=o.sibling,o=ui(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,s!==null&&(A=r.deletions,A===null?(r.deletions=[s],r.flags|=16):A.push(s)),r.child=o,r.memoizedState=null,o)}function Nh(s,r){return r=kc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function kc(s,r){return s=qn(22,s,null,r),s.lanes=0,s}function Rh(s,r,o){return ha(r,s.child,null,o),s=Nh(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function o0(s,r,o){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Gf(s.return,r,o)}function Dh(s,r,o,c,v,_){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:v,treeForkCount:_}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=o,A.tailMode=v,A.treeForkCount=_)}function l0(s,r,o){var c=r.pendingProps,v=c.revealOrder,_=c.tail;c=c.children;var A=Ut.current,I=(A&2)!==0;if(I?(A=A&1|2,r.flags|=128):A&=1,Te(Ut,A),fn(s,r,c,o),c=st?wl:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&o0(s,o,r);else if(s.tag===19)o0(s,o,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(o=r.child,v=null;o!==null;)s=o.alternate,s!==null&&Ec(s)===null&&(v=o),o=o.sibling;o=v,o===null?(v=r.child,r.child=null):(v=o.sibling,o.sibling=null),Dh(r,!1,v,o,_,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,v=r.child,r.child=null;v!==null;){if(s=v.alternate,s!==null&&Ec(s)===null){r.child=v;break}s=v.sibling,v.sibling=o,o=v,v=s}Dh(r,!0,o,null,_,c);break;case"together":Dh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function pi(s,r,o){if(s!==null&&(r.dependencies=s.dependencies),fr|=r.lanes,(o&r.childLanes)===0)if(s!==null){if(so(s,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,o=ui(s,s.pendingProps),r.child=o,o.return=r;s.sibling!==null;)s=s.sibling,o=o.sibling=ui(s,s.pendingProps),o.return=r;o.sibling=null}return r.child}function Mh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&mc(s)))}function FS(s,r,o){switch(r.tag){case 3:me(r,r.stateNode.containerInfo),ir(r,Ht,s.memoizedState.cache),oa();break;case 27:case 5:Ge(r);break;case 4:me(r,r.stateNode.containerInfo);break;case 10:ir(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,sh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(lr(r),r.flags|=128,null):(o&r.child.childLanes)!==0?a0(s,r,o):(lr(r),s=pi(s,r,o),s!==null?s.sibling:null);lr(r);break;case 19:var v=(s.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(so(s,r,o,!1),c=(o&r.childLanes)!==0),v){if(c)return l0(s,r,o);r.flags|=128}if(v=r.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Te(Ut,Ut.current),c)break;return null;case 22:return r.lanes=0,e0(s,r,o,r.pendingProps);case 24:ir(r,Ht,s.memoizedState.cache)}return pi(s,r,o)}function u0(s,r,o){if(s!==null)if(s.memoizedProps!==r.pendingProps)$t=!0;else{if(!Mh(s,o)&&(r.flags&128)===0)return $t=!1,FS(s,r,o);$t=(s.flags&131072)!==0}else $t=!1,st&&(r.flags&1048576)!==0&&qg(r,wl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=da(r.elementType),r.type=s,typeof s=="function")Uf(s)?(c=pa(s,c),r.tag=1,r=i0(null,r,s,c,o)):(r.tag=0,r=Sh(null,r,s,c,o));else{if(s!=null){var v=s.$$typeof;if(v===F){r.tag=11,r=Xy(null,r,s,c,o);break e}else if(v===R){r.tag=14,r=Wy(null,r,s,c,o);break e}}throw r=Ue(s)||s,Error(i(306,r,""))}}return r;case 0:return Sh(s,r,r.type,r.pendingProps,o);case 1:return c=r.type,v=pa(c,r.pendingProps),i0(s,r,c,v,o);case 3:e:{if(me(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var _=r.memoizedState;v=_.element,Wf(s,r),Vl(r,c,null,o);var A=r.memoizedState;if(c=A.cache,ir(r,Ht,c),c!==_.cache&&$f(r,[Ht],o,!0),kl(),c=A.element,_.isDehydrated)if(_={element:c,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){r=r0(s,r,c,o);break e}else if(c!==v){v=Zn(Error(i(424)),r),Il(v),r=r0(s,r,c,o);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(bt=is(s.firstChild),cn=r,st=!0,nr=null,ns=!0,o=ey(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(oa(),c===v){r=pi(s,r,o);break e}fn(s,r,c,o)}r=r.child}return r;case 26:return Pc(s,r),s===null?(o=Tv(r.type,null,r.pendingProps,null))?r.memoizedState=o:st||(o=r.type,s=r.pendingProps,c=Qc(ke.current).createElement(o),c[qt]=r,c[tn]=s,hn(c,o,s),Bt(c),r.stateNode=c):r.memoizedState=Tv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Ge(r),s===null&&st&&(c=r.stateNode=yv(r.type,r.pendingProps,ke.current),cn=r,ns=!0,v=bt,yr(r.type)?(dm=v,bt=is(c.firstChild)):bt=v),fn(s,r,r.pendingProps.children,o),Pc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&st&&((v=c=bt)&&(c=gC(c,r.type,r.pendingProps,ns),c!==null?(r.stateNode=c,cn=r,bt=is(c.firstChild),ns=!1,v=!0):v=!1),v||sr(r)),Ge(r),v=r.type,_=r.pendingProps,A=s!==null?s.memoizedProps:null,c=_.children,am(v,_)?c=null:A!==null&&am(v,A)&&(r.flags|=32),r.memoizedState!==null&&(v=rh(s,r,DS,null,null,o),tu._currentValue=v),Pc(s,r),fn(s,r,c,o),r.child;case 6:return s===null&&st&&((s=o=bt)&&(o=yC(o,r.pendingProps,ns),o!==null?(r.stateNode=o,cn=r,bt=null,s=!0):s=!1),s||sr(r)),null;case 13:return a0(s,r,o);case 4:return me(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=ha(r,null,c,o):fn(s,r,c,o),r.child;case 11:return Xy(s,r,r.type,r.pendingProps,o);case 7:return fn(s,r,r.pendingProps,o),r.child;case 8:return fn(s,r,r.pendingProps.children,o),r.child;case 12:return fn(s,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,ir(r,r.type,c.value),fn(s,r,c.children,o),r.child;case 9:return v=r.type._context,c=r.pendingProps.children,ua(r),v=dn(v),c=c(v),r.flags|=1,fn(s,r,c,o),r.child;case 14:return Wy(s,r,r.type,r.pendingProps,o);case 15:return Zy(s,r,r.type,r.pendingProps,o);case 19:return l0(s,r,o);case 31:return jS(s,r,o);case 22:return e0(s,r,o,r.pendingProps);case 24:return ua(r),c=dn(Ht),s===null?(v=Kf(),v===null&&(v=Tt,_=Yf(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=o),v=_),r.memoizedState={parent:c,cache:v},Xf(r),ir(r,Ht,v)):((s.lanes&o)!==0&&(Wf(s,r),Vl(r,null,null,o),kl()),v=s.memoizedState,_=r.memoizedState,v.parent!==c?(v={parent:c,cache:c},r.memoizedState=v,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=v),ir(r,Ht,c)):(c=_.cache,ir(r,Ht,c),c!==v.cache&&$f(r,[Ht],o,!0))),fn(s,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function gi(s){s.flags|=4}function Ph(s,r,o,c,v){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(L0())s.flags|=8192;else throw fa=vc,Qf}else s.flags&=-16777217}function c0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Sv(r))if(L0())s.flags|=8192;else throw fa=vc,Qf}function Vc(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?xt():536870912,s.lanes|=r,go|=r)}function ql(s,r){if(!st)switch(s.tailMode){case"hidden":r=s.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function At(s){var r=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(r)for(var v=s.child;v!==null;)o|=v.lanes|v.childLanes,c|=v.subtreeFlags&65011712,c|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)o|=v.lanes|v.childLanes,c|=v.subtreeFlags,c|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=c,s.childLanes=o,r}function qS(s,r,o){var c=r.pendingProps;switch(qf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(r),null;case 1:return At(r),null;case 3:return o=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),fi(Ht),ge(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(no(r)?gi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,zf())),At(r),null;case 26:var v=r.type,_=r.memoizedState;return s===null?(gi(r),_!==null?(At(r),c0(r,_)):(At(r),Ph(r,v,null,c,o))):_?_!==s.memoizedState?(gi(r),At(r),c0(r,_)):(At(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&gi(r),At(r),Ph(r,v,s,c,o)),null;case 27:if(kt(r),o=ke.current,v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return At(r),null}s=Ee.current,no(r)?zg(r):(s=yv(v,c,o),r.stateNode=s,gi(r))}return At(r),null;case 5:if(kt(r),v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return At(r),null}if(_=Ee.current,no(r))zg(r);else{var A=Qc(ke.current);switch(_){case 1:_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=A.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?_.multiple=!0:c.size&&(_.size=c.size);break;default:_=typeof c.is=="string"?A.createElement(v,{is:c.is}):A.createElement(v)}}_[qt]=r,_[tn]=c;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=_;e:switch(hn(_,v,c),v){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&gi(r)}}return At(r),Ph(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,o),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=ke.current,no(r)){if(s=r.stateNode,o=r.memoizedProps,c=null,v=cn,v!==null)switch(v.tag){case 27:case 5:c=v.memoizedProps}s[qt]=r,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||av(s.nodeValue,o)),s||sr(r,!0)}else s=Qc(s).createTextNode(c),s[qt]=r,r.stateNode=s}return At(r),null;case 31:if(o=r.memoizedState,s===null||s.memoizedState!==null){if(c=no(r),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[qt]=r}else oa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;At(r),s=!1}else o=zf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return r.flags&256?(zn(r),r):(zn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return At(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=no(r),c!==null&&c.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[qt]=r}else oa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;At(r),v=!1}else v=zf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return r.flags&256?(zn(r),r):(zn(r),null)}return zn(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=r.child,v=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(v=c.alternate.memoizedState.cachePool.pool),_=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(_=c.memoizedState.cachePool.pool),_!==v&&(c.flags|=2048)),o!==s&&o&&(r.child.flags|=8192),Vc(r,r.updateQueue),At(r),null);case 4:return ge(),s===null&&tm(r.stateNode.containerInfo),At(r),null;case 10:return fi(r.type),At(r),null;case 19:if(ae(Ut),c=r.memoizedState,c===null)return At(r),null;if(v=(r.flags&128)!==0,_=c.rendering,_===null)if(v)ql(c,!1);else{if(Pt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(_=Ec(s),_!==null){for(r.flags|=128,ql(c,!1),s=_.updateQueue,r.updateQueue=s,Vc(r,s),r.subtreeFlags=0,s=o,o=r.child;o!==null;)Og(o,s),o=o.sibling;return Te(Ut,Ut.current&1|2),st&&ci(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&ln()>Fc&&(r.flags|=128,v=!0,ql(c,!1),r.lanes=4194304)}else{if(!v)if(s=Ec(_),s!==null){if(r.flags|=128,v=!0,s=s.updateQueue,r.updateQueue=s,Vc(r,s),ql(c,!0),c.tail===null&&c.tailMode==="hidden"&&!_.alternate&&!st)return At(r),null}else 2*ln()-c.renderingStartTime>Fc&&o!==536870912&&(r.flags|=128,v=!0,ql(c,!1),r.lanes=4194304);c.isBackwards?(_.sibling=r.child,r.child=_):(s=c.last,s!==null?s.sibling=_:r.child=_,c.last=_)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=ln(),s.sibling=null,o=Ut.current,Te(Ut,v?o&1|2:o&1),st&&ci(r,c.treeForkCount),s):(At(r),null);case 22:case 23:return zn(r),nh(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(At(r),r.subtreeFlags&6&&(r.flags|=8192)):At(r),o=r.updateQueue,o!==null&&Vc(r,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),s!==null&&ae(ca),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),fi(Ht),At(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function BS(s,r){switch(qf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return fi(Ht),ge(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return kt(r),null;case 31:if(r.memoizedState!==null){if(zn(r),r.alternate===null)throw Error(i(340));oa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(zn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));oa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return ae(Ut),null;case 4:return ge(),null;case 10:return fi(r.type),null;case 22:case 23:return zn(r),nh(),s!==null&&ae(ca),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return fi(Ht),null;case 25:return null;default:return null}}function d0(s,r){switch(qf(r),r.tag){case 3:fi(Ht),ge();break;case 26:case 27:case 5:kt(r);break;case 4:ge();break;case 31:r.memoizedState!==null&&zn(r);break;case 13:zn(r);break;case 19:ae(Ut);break;case 10:fi(r.type);break;case 22:case 23:zn(r),nh(),s!==null&&ae(ca);break;case 24:fi(Ht)}}function Bl(s,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var v=c.next;o=v;do{if((o.tag&s)===s){c=void 0;var _=o.create,A=o.inst;c=_(),A.destroy=c}o=o.next}while(o!==v)}}catch(I){mt(r,r.return,I)}}function cr(s,r,o){try{var c=r.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var _=v.next;c=_;do{if((c.tag&s)===s){var A=c.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=r;var j=o,K=I;try{K()}catch(re){mt(v,j,re)}}}c=c.next}while(c!==_)}}catch(re){mt(r,r.return,re)}}function f0(s){var r=s.updateQueue;if(r!==null){var o=s.stateNode;try{ny(r,o)}catch(c){mt(s,s.return,c)}}}function h0(s,r,o){o.props=pa(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){mt(s,r,c)}}function zl(s,r){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(v){mt(s,r,v)}}function Ys(s,r){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(v){mt(s,r,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(v){mt(s,r,v)}else o.current=null}function m0(s){var r=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(v){mt(s,s.return,v)}}function kh(s,r,o){try{var c=s.stateNode;cC(c,s.type,o,r),c[tn]=r}catch(v){mt(s,s.return,v)}}function p0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&yr(s.type)||s.tag===4}function Vh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||p0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&yr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lh(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(s),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=hs));else if(c!==4&&(c===27&&yr(s.type)&&(o=s.stateNode,r=null),s=s.child,s!==null))for(Lh(s,r,o),s=s.sibling;s!==null;)Lh(s,r,o),s=s.sibling}function Lc(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?o.insertBefore(s,r):o.appendChild(s);else if(c!==4&&(c===27&&yr(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Lc(s,r,o),s=s.sibling;s!==null;)Lc(s,r,o),s=s.sibling}function g0(s){var r=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,v=r.attributes;v.length;)r.removeAttributeNode(v[0]);hn(r,c,o),r[qt]=s,r[tn]=o}catch(_){mt(s,s.return,_)}}var yi=!1,Yt=!1,Uh=!1,y0=typeof WeakSet=="function"?WeakSet:Set,sn=null;function zS(s,r){if(s=s.containerInfo,im=sd,s=Ng(s),Rf(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var v=c.anchorOffset,_=c.focusNode;c=c.focusOffset;try{o.nodeType,_.nodeType}catch{o=null;break e}var A=0,I=-1,j=-1,K=0,re=0,le=s,X=null;t:for(;;){for(var se;le!==o||v!==0&&le.nodeType!==3||(I=A+v),le!==_||c!==0&&le.nodeType!==3||(j=A+c),le.nodeType===3&&(A+=le.nodeValue.length),(se=le.firstChild)!==null;)X=le,le=se;for(;;){if(le===s)break t;if(X===o&&++K===v&&(I=A),X===_&&++re===c&&(j=A),(se=le.nextSibling)!==null)break;le=X,X=le.parentNode}le=se}o=I===-1||j===-1?null:{start:I,end:j}}else o=null}o=o||{start:0,end:0}}else o=null;for(rm={focusedElem:s,selectionRange:o},sd=!1,sn=r;sn!==null;)if(r=sn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,sn=s;else for(;sn!==null;){switch(r=sn,_=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)v=s[o],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,o=r,v=_.memoizedProps,_=_.memoizedState,c=o.stateNode;try{var Ae=pa(o.type,v);s=c.getSnapshotBeforeUpdate(Ae,_),c.__reactInternalSnapshotBeforeUpdate=s}catch(Pe){mt(o,o.return,Pe)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,o=s.nodeType,o===9)lm(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,sn=s;break}sn=r.return}}function v0(s,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:_i(s,o),c&4&&Bl(5,o);break;case 1:if(_i(s,o),c&4)if(s=o.stateNode,r===null)try{s.componentDidMount()}catch(A){mt(o,o.return,A)}else{var v=pa(o.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(v,r,s.__reactInternalSnapshotBeforeUpdate)}catch(A){mt(o,o.return,A)}}c&64&&f0(o),c&512&&zl(o,o.return);break;case 3:if(_i(s,o),c&64&&(s=o.updateQueue,s!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{ny(s,r)}catch(A){mt(o,o.return,A)}}break;case 27:r===null&&c&4&&g0(o);case 26:case 5:_i(s,o),r===null&&c&4&&m0(o),c&512&&zl(o,o.return);break;case 12:_i(s,o);break;case 31:_i(s,o),c&4&&x0(s,o);break;case 13:_i(s,o),c&4&&E0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=WS.bind(null,o),vC(s,o))));break;case 22:if(c=o.memoizedState!==null||yi,!c){r=r!==null&&r.memoizedState!==null||Yt,v=yi;var _=Yt;yi=c,(Yt=r)&&!_?Ti(s,o,(o.subtreeFlags&8772)!==0):_i(s,o),yi=v,Yt=_}break;case 30:break;default:_i(s,o)}}function _0(s){var r=s.alternate;r!==null&&(s.alternate=null,_0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&ja(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Nt=null,Rn=!1;function vi(s,r,o){for(o=o.child;o!==null;)T0(s,r,o),o=o.sibling}function T0(s,r,o){if(fe&&typeof fe.onCommitFiberUnmount=="function")try{fe.onCommitFiberUnmount(ce,o)}catch{}switch(o.tag){case 26:Yt||Ys(o,r),vi(s,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Yt||Ys(o,r);var c=Nt,v=Rn;yr(o.type)&&(Nt=o.stateNode,Rn=!1),vi(s,r,o),Wl(o.stateNode),Nt=c,Rn=v;break;case 5:Yt||Ys(o,r);case 6:if(c=Nt,v=Rn,Nt=null,vi(s,r,o),Nt=c,Rn=v,Nt!==null)if(Rn)try{(Nt.nodeType===9?Nt.body:Nt.nodeName==="HTML"?Nt.ownerDocument.body:Nt).removeChild(o.stateNode)}catch(_){mt(o,r,_)}else try{Nt.removeChild(o.stateNode)}catch(_){mt(o,r,_)}break;case 18:Nt!==null&&(Rn?(s=Nt,fv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Ao(s)):fv(Nt,o.stateNode));break;case 4:c=Nt,v=Rn,Nt=o.stateNode.containerInfo,Rn=!0,vi(s,r,o),Nt=c,Rn=v;break;case 0:case 11:case 14:case 15:cr(2,o,r),Yt||cr(4,o,r),vi(s,r,o);break;case 1:Yt||(Ys(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&h0(o,r,c)),vi(s,r,o);break;case 21:vi(s,r,o);break;case 22:Yt=(c=Yt)||o.memoizedState!==null,vi(s,r,o),Yt=c;break;default:vi(s,r,o)}}function x0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ao(s)}catch(o){mt(r,r.return,o)}}}function E0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ao(s)}catch(o){mt(r,r.return,o)}}function HS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new y0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new y0),r;default:throw Error(i(435,s.tag))}}function Uc(s,r){var o=HS(s);r.forEach(function(c){if(!o.has(c)){o.add(c);var v=ZS.bind(null,s,c);c.then(v,v)}})}function Dn(s,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var v=o[c],_=s,A=r,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(yr(I.type)){Nt=I.stateNode,Rn=!1;break e}break;case 5:Nt=I.stateNode,Rn=!1;break e;case 3:case 4:Nt=I.stateNode.containerInfo,Rn=!0;break e}I=I.return}if(Nt===null)throw Error(i(160));T0(_,A,v),Nt=null,Rn=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)b0(r,s),r=r.sibling}var _s=null;function b0(s,r){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Dn(r,s),Mn(s),c&4&&(cr(3,s,s.return),Bl(3,s),cr(5,s,s.return));break;case 1:Dn(r,s),Mn(s),c&512&&(Yt||o===null||Ys(o,o.return)),c&64&&yi&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var v=_s;if(Dn(r,s),Mn(s),c&512&&(Yt||o===null||Ys(o,o.return)),c&4){var _=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,v=v.ownerDocument||v;t:switch(c){case"title":_=v.getElementsByTagName("title")[0],(!_||_[Ps]||_[qt]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(c),v.head.insertBefore(_,v.querySelector("head > title"))),hn(_,c,o),_[qt]=s,Bt(_),c=_;break e;case"link":var A=bv("link","href",v).get(c+(o.href||""));if(A){for(var I=0;I<A.length;I++)if(_=A[I],_.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&_.getAttribute("rel")===(o.rel==null?null:o.rel)&&_.getAttribute("title")===(o.title==null?null:o.title)&&_.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){A.splice(I,1);break t}}_=v.createElement(c),hn(_,c,o),v.head.appendChild(_);break;case"meta":if(A=bv("meta","content",v).get(c+(o.content||""))){for(I=0;I<A.length;I++)if(_=A[I],_.getAttribute("content")===(o.content==null?null:""+o.content)&&_.getAttribute("name")===(o.name==null?null:o.name)&&_.getAttribute("property")===(o.property==null?null:o.property)&&_.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&_.getAttribute("charset")===(o.charSet==null?null:o.charSet)){A.splice(I,1);break t}}_=v.createElement(c),hn(_,c,o),v.head.appendChild(_);break;default:throw Error(i(468,c))}_[qt]=s,Bt(_),c=_}s.stateNode=c}else Av(v,s.type,s.stateNode);else s.stateNode=Ev(v,c,s.memoizedProps);else _!==c?(_===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):_.count--,c===null?Av(v,s.type,s.stateNode):Ev(v,c,s.memoizedProps)):c===null&&s.stateNode!==null&&kh(s,s.memoizedProps,o.memoizedProps)}break;case 27:Dn(r,s),Mn(s),c&512&&(Yt||o===null||Ys(o,o.return)),o!==null&&c&4&&kh(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Dn(r,s),Mn(s),c&512&&(Yt||o===null||Ys(o,o.return)),s.flags&32){v=s.stateNode;try{Nn(v,"")}catch(Ae){mt(s,s.return,Ae)}}c&4&&s.stateNode!=null&&(v=s.memoizedProps,kh(s,v,o!==null?o.memoizedProps:v)),c&1024&&(Uh=!0);break;case 6:if(Dn(r,s),Mn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(Ae){mt(s,s.return,Ae)}}break;case 3:if(Zc=null,v=_s,_s=Xc(r.containerInfo),Dn(r,s),_s=v,Mn(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ao(r.containerInfo)}catch(Ae){mt(s,s.return,Ae)}Uh&&(Uh=!1,A0(s));break;case 4:c=_s,_s=Xc(s.stateNode.containerInfo),Dn(r,s),Mn(s),_s=c;break;case 12:Dn(r,s),Mn(s);break;case 31:Dn(r,s),Mn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Uc(s,c)));break;case 13:Dn(r,s),Mn(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(jc=ln()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Uc(s,c)));break;case 22:v=s.memoizedState!==null;var j=o!==null&&o.memoizedState!==null,K=yi,re=Yt;if(yi=K||v,Yt=re||j,Dn(r,s),Yt=re,yi=K,Mn(s),c&8192)e:for(r=s.stateNode,r._visibility=v?r._visibility&-2:r._visibility|1,v&&(o===null||j||yi||Yt||ga(s)),o=null,r=s;;){if(r.tag===5||r.tag===26){if(o===null){j=o=r;try{if(_=j.stateNode,v)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=j.stateNode;var le=j.memoizedProps.style,X=le!=null&&le.hasOwnProperty("display")?le.display:null;I.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(Ae){mt(j,j.return,Ae)}}}else if(r.tag===6){if(o===null){j=r;try{j.stateNode.nodeValue=v?"":j.memoizedProps}catch(Ae){mt(j,j.return,Ae)}}}else if(r.tag===18){if(o===null){j=r;try{var se=j.stateNode;v?hv(se,!0):hv(j.stateNode,!1)}catch(Ae){mt(j,j.return,Ae)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Uc(s,o))));break;case 19:Dn(r,s),Mn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Uc(s,c)));break;case 30:break;case 21:break;default:Dn(r,s),Mn(s)}}function Mn(s){var r=s.flags;if(r&2){try{for(var o,c=s.return;c!==null;){if(p0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var v=o.stateNode,_=Vh(s);Lc(s,_,v);break;case 5:var A=o.stateNode;o.flags&32&&(Nn(A,""),o.flags&=-33);var I=Vh(s);Lc(s,I,A);break;case 3:case 4:var j=o.stateNode.containerInfo,K=Vh(s);Lh(s,K,j);break;default:throw Error(i(161))}}catch(re){mt(s,s.return,re)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function A0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;A0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function _i(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)v0(s,r.alternate,r),r=r.sibling}function ga(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:cr(4,r,r.return),ga(r);break;case 1:Ys(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&h0(r,r.return,o),ga(r);break;case 27:Wl(r.stateNode);case 26:case 5:Ys(r,r.return),ga(r);break;case 22:r.memoizedState===null&&ga(r);break;case 30:ga(r);break;default:ga(r)}s=s.sibling}}function Ti(s,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,v=s,_=r,A=_.flags;switch(_.tag){case 0:case 11:case 15:Ti(v,_,o),Bl(4,_);break;case 1:if(Ti(v,_,o),c=_,v=c.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(K){mt(c,c.return,K)}if(c=_,v=c.updateQueue,v!==null){var I=c.stateNode;try{var j=v.shared.hiddenCallbacks;if(j!==null)for(v.shared.hiddenCallbacks=null,v=0;v<j.length;v++)ty(j[v],I)}catch(K){mt(c,c.return,K)}}o&&A&64&&f0(_),zl(_,_.return);break;case 27:g0(_);case 26:case 5:Ti(v,_,o),o&&c===null&&A&4&&m0(_),zl(_,_.return);break;case 12:Ti(v,_,o);break;case 31:Ti(v,_,o),o&&A&4&&x0(v,_);break;case 13:Ti(v,_,o),o&&A&4&&E0(v,_);break;case 22:_.memoizedState===null&&Ti(v,_,o),zl(_,_.return);break;case 30:break;default:Ti(v,_,o)}r=r.sibling}}function Oh(s,r){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Nl(o))}function jh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Nl(s))}function Ts(s,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)S0(s,r,o,c),r=r.sibling}function S0(s,r,o,c){var v=r.flags;switch(r.tag){case 0:case 11:case 15:Ts(s,r,o,c),v&2048&&Bl(9,r);break;case 1:Ts(s,r,o,c);break;case 3:Ts(s,r,o,c),v&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Nl(s)));break;case 12:if(v&2048){Ts(s,r,o,c),s=r.stateNode;try{var _=r.memoizedProps,A=_.id,I=_.onPostCommit;typeof I=="function"&&I(A,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(j){mt(r,r.return,j)}}else Ts(s,r,o,c);break;case 31:Ts(s,r,o,c);break;case 13:Ts(s,r,o,c);break;case 23:break;case 22:_=r.stateNode,A=r.alternate,r.memoizedState!==null?_._visibility&2?Ts(s,r,o,c):Hl(s,r):_._visibility&2?Ts(s,r,o,c):(_._visibility|=2,ho(s,r,o,c,(r.subtreeFlags&10256)!==0||!1)),v&2048&&Oh(A,r);break;case 24:Ts(s,r,o,c),v&2048&&jh(r.alternate,r);break;default:Ts(s,r,o,c)}}function ho(s,r,o,c,v){for(v=v&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var _=s,A=r,I=o,j=c,K=A.flags;switch(A.tag){case 0:case 11:case 15:ho(_,A,I,j,v),Bl(8,A);break;case 23:break;case 22:var re=A.stateNode;A.memoizedState!==null?re._visibility&2?ho(_,A,I,j,v):Hl(_,A):(re._visibility|=2,ho(_,A,I,j,v)),v&&K&2048&&Oh(A.alternate,A);break;case 24:ho(_,A,I,j,v),v&&K&2048&&jh(A.alternate,A);break;default:ho(_,A,I,j,v)}r=r.sibling}}function Hl(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=s,c=r,v=c.flags;switch(c.tag){case 22:Hl(o,c),v&2048&&Oh(c.alternate,c);break;case 24:Hl(o,c),v&2048&&jh(c.alternate,c);break;default:Hl(o,c)}r=r.sibling}}var Gl=8192;function mo(s,r,o){if(s.subtreeFlags&Gl)for(s=s.child;s!==null;)C0(s,r,o),s=s.sibling}function C0(s,r,o){switch(s.tag){case 26:mo(s,r,o),s.flags&Gl&&s.memoizedState!==null&&RC(o,_s,s.memoizedState,s.memoizedProps);break;case 5:mo(s,r,o);break;case 3:case 4:var c=_s;_s=Xc(s.stateNode.containerInfo),mo(s,r,o),_s=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Gl,Gl=16777216,mo(s,r,o),Gl=c):mo(s,r,o));break;default:mo(s,r,o)}}function w0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function $l(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];sn=c,N0(c,s)}w0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)I0(s),s=s.sibling}function I0(s){switch(s.tag){case 0:case 11:case 15:$l(s),s.flags&2048&&cr(9,s,s.return);break;case 3:$l(s);break;case 12:$l(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Oc(s)):$l(s);break;default:$l(s)}}function Oc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];sn=c,N0(c,s)}w0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:cr(8,r,r.return),Oc(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Oc(r));break;default:Oc(r)}s=s.sibling}}function N0(s,r){for(;sn!==null;){var o=sn;switch(o.tag){case 0:case 11:case 15:cr(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Nl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,sn=c;else e:for(o=s;sn!==null;){c=sn;var v=c.sibling,_=c.return;if(_0(c),c===o){sn=null;break e}if(v!==null){v.return=_,sn=v;break e}sn=_}}}var GS={getCacheForType:function(s){var r=dn(Ht),o=r.data.get(s);return o===void 0&&(o=s(),r.data.set(s,o)),o},cacheSignal:function(){return dn(Ht).controller.signal}},$S=typeof WeakMap=="function"?WeakMap:Map,ct=0,Tt=null,Ke=null,We=0,ht=0,Hn=null,dr=!1,po=!1,Fh=!1,xi=0,Pt=0,fr=0,ya=0,qh=0,Gn=0,go=0,Yl=null,Pn=null,Bh=!1,jc=0,R0=0,Fc=1/0,qc=null,hr=null,Wt=0,mr=null,yo=null,Ei=0,zh=0,Hh=null,D0=null,Jl=0,Gh=null;function $n(){return(ct&2)!==0&&We!==0?We&-We:te.T!==null?Xh():Bu()}function M0(){if(Gn===0)if((We&536870912)===0||st){var s=cs;cs<<=1,(cs&3932160)===0&&(cs=262144),Gn=s}else Gn=536870912;return s=Bn.current,s!==null&&(s.flags|=32),Gn}function kn(s,r,o){(s===Tt&&(ht===2||ht===9)||s.cancelPendingCommit!==null)&&(vo(s,0),pr(s,We,Gn,!1)),Xe(s,o),((ct&2)===0||s!==Tt)&&(s===Tt&&((ct&2)===0&&(ya|=o),Pt===4&&pr(s,We,Gn,!1)),Js(s))}function P0(s,r,o){if((ct&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&s.expiredLanes)===0||rt(s,r),v=c?KS(s,r):Yh(s,r,!0),_=c;do{if(v===0){po&&!c&&pr(s,r,0,!1);break}else{if(o=s.current.alternate,_&&!YS(o)){v=Yh(s,r,!1),_=!1;continue}if(v===2){if(_=r,s.errorRecoveryDisabledLanes&_)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var I=s;v=Yl;var j=I.current.memoizedState.isDehydrated;if(j&&(vo(I,A).flags|=256),A=Yh(I,A,!1),A!==2){if(Fh&&!j){I.errorRecoveryDisabledLanes|=_,ya|=_,v=4;break e}_=Pn,Pn=v,_!==null&&(Pn===null?Pn=_:Pn.push.apply(Pn,_))}v=A}if(_=!1,v!==2)continue}}if(v===1){vo(s,0),pr(s,r,0,!0);break}e:{switch(c=s,_=v,_){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:pr(c,r,Gn,!dr);break e;case 2:Pn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(v=jc+300-ln(),10<v)){if(pr(c,r,Gn,!dr),xe(c,0,!0)!==0)break e;Ei=r,c.timeoutHandle=cv(k0.bind(null,c,o,Pn,qc,Bh,r,Gn,ya,go,dr,_,"Throttled",-0,0),v);break e}k0(c,o,Pn,qc,Bh,r,Gn,ya,go,dr,_,null,-0,0)}}break}while(!0);Js(s)}function k0(s,r,o,c,v,_,A,I,j,K,re,le,X,se){if(s.timeoutHandle=-1,le=r.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hs},C0(r,_,le);var Ae=(_&62914560)===_?jc-ln():(_&4194048)===_?R0-ln():0;if(Ae=DC(le,Ae),Ae!==null){Ei=_,s.cancelPendingCommit=Ae(B0.bind(null,s,r,_,o,c,v,A,I,j,re,le,null,X,se)),pr(s,_,A,!K);return}}B0(s,r,_,o,c,v,A,I,j)}function YS(s){for(var r=s;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var v=o[c],_=v.getSnapshot;v=v.value;try{if(!Fn(_(),v))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function pr(s,r,o,c){r&=~qh,r&=~ya,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var v=r;0<v;){var _=31-_e(v),A=1<<_;c[_]=-1,v&=~A}o!==0&&Ds(s,o,r)}function Bc(){return(ct&6)===0?(Kl(0),!1):!0}function $h(){if(Ke!==null){if(ht===0)var s=Ke.return;else s=Ke,di=la=null,lh(s),oo=null,Dl=0,s=Ke;for(;s!==null;)d0(s.alternate,s),s=s.return;Ke=null}}function vo(s,r){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,hC(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),Ei=0,$h(),Tt=s,Ke=o=ui(s.current,null),We=r,ht=0,Hn=null,dr=!1,po=rt(s,r),Fh=!1,go=Gn=qh=ya=fr=Pt=0,Pn=Yl=null,Bh=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var v=31-_e(c),_=1<<v;r|=s[v],c&=~_}return xi=r,uc(),o}function V0(s,r){He=null,te.H=jl,r===ao||r===yc?(r=Xg(),ht=3):r===Qf?(r=Xg(),ht=4):ht=r===Ah?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Hn=r,Ke===null&&(Pt=1,Dc(s,Zn(r,s.current)))}function L0(){var s=Bn.current;return s===null?!0:(We&4194048)===We?ss===null:(We&62914560)===We||(We&536870912)!==0?s===ss:!1}function U0(){var s=te.H;return te.H=jl,s===null?jl:s}function O0(){var s=te.A;return te.A=GS,s}function zc(){Pt=4,dr||(We&4194048)!==We&&Bn.current!==null||(po=!0),(fr&134217727)===0&&(ya&134217727)===0||Tt===null||pr(Tt,We,Gn,!1)}function Yh(s,r,o){var c=ct;ct|=2;var v=U0(),_=O0();(Tt!==s||We!==r)&&(qc=null,vo(s,r)),r=!1;var A=Pt;e:do try{if(ht!==0&&Ke!==null){var I=Ke,j=Hn;switch(ht){case 8:$h(),A=6;break e;case 3:case 2:case 9:case 6:Bn.current===null&&(r=!0);var K=ht;if(ht=0,Hn=null,_o(s,I,j,K),o&&po){A=0;break e}break;default:K=ht,ht=0,Hn=null,_o(s,I,j,K)}}JS(),A=Pt;break}catch(re){V0(s,re)}while(!0);return r&&s.shellSuspendCounter++,di=la=null,ct=c,te.H=v,te.A=_,Ke===null&&(Tt=null,We=0,uc()),A}function JS(){for(;Ke!==null;)j0(Ke)}function KS(s,r){var o=ct;ct|=2;var c=U0(),v=O0();Tt!==s||We!==r?(qc=null,Fc=ln()+500,vo(s,r)):po=rt(s,r);e:do try{if(ht!==0&&Ke!==null){r=Ke;var _=Hn;t:switch(ht){case 1:ht=0,Hn=null,_o(s,r,_,1);break;case 2:case 9:if(Kg(_)){ht=0,Hn=null,F0(r);break}r=function(){ht!==2&&ht!==9||Tt!==s||(ht=7),Js(s)},_.then(r,r);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Kg(_)?(ht=0,Hn=null,F0(r)):(ht=0,Hn=null,_o(s,r,_,7));break;case 5:var A=null;switch(Ke.tag){case 26:A=Ke.memoizedState;case 5:case 27:var I=Ke;if(A?Sv(A):I.stateNode.complete){ht=0,Hn=null;var j=I.sibling;if(j!==null)Ke=j;else{var K=I.return;K!==null?(Ke=K,Hc(K)):Ke=null}break t}}ht=0,Hn=null,_o(s,r,_,5);break;case 6:ht=0,Hn=null,_o(s,r,_,6);break;case 8:$h(),Pt=6;break e;default:throw Error(i(462))}}QS();break}catch(re){V0(s,re)}while(!0);return di=la=null,te.H=c,te.A=v,ct=o,Ke!==null?0:(Tt=null,We=0,uc(),Pt)}function QS(){for(;Ke!==null&&!al();)j0(Ke)}function j0(s){var r=u0(s.alternate,s,xi);s.memoizedProps=s.pendingProps,r===null?Hc(s):Ke=r}function F0(s){var r=s,o=r.alternate;switch(r.tag){case 15:case 0:r=s0(o,r,r.pendingProps,r.type,void 0,We);break;case 11:r=s0(o,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:lh(r);default:d0(o,r),r=Ke=Og(r,xi),r=u0(o,r,xi)}s.memoizedProps=s.pendingProps,r===null?Hc(s):Ke=r}function _o(s,r,o,c){di=la=null,lh(r),oo=null,Dl=0;var v=r.return;try{if(OS(s,v,r,o,We)){Pt=1,Dc(s,Zn(o,s.current)),Ke=null;return}}catch(_){if(v!==null)throw Ke=v,_;Pt=1,Dc(s,Zn(o,s.current)),Ke=null;return}r.flags&32768?(st||c===1?s=!0:po||(We&536870912)!==0?s=!1:(dr=s=!0,(c===2||c===9||c===3||c===6)&&(c=Bn.current,c!==null&&c.tag===13&&(c.flags|=16384))),q0(r,s)):Hc(r)}function Hc(s){var r=s;do{if((r.flags&32768)!==0){q0(r,dr);return}s=r.return;var o=qS(r.alternate,r,xi);if(o!==null){Ke=o;return}if(r=r.sibling,r!==null){Ke=r;return}Ke=r=s}while(r!==null);Pt===0&&(Pt=5)}function q0(s,r){do{var o=BS(s.alternate,s);if(o!==null){o.flags&=32767,Ke=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(s=s.sibling,s!==null)){Ke=s;return}Ke=s=o}while(s!==null);Pt=6,Ke=null}function B0(s,r,o,c,v,_,A,I,j){s.cancelPendingCommit=null;do Gc();while(Wt!==0);if((ct&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(_=r.lanes|r.childLanes,_|=Vf,Ua(s,o,_,A,I,j),s===Tt&&(Ke=Tt=null,We=0),yo=r,mr=s,Ei=o,zh=_,Hh=v,D0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,eC(us,function(){return Y0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=te.T,te.T=null,v=Z.p,Z.p=2,A=ct,ct|=4;try{zS(s,r,o)}finally{ct=A,Z.p=v,te.T=c}}Wt=1,z0(),H0(),G0()}}function z0(){if(Wt===1){Wt=0;var s=mr,r=yo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=te.T,te.T=null;var c=Z.p;Z.p=2;var v=ct;ct|=4;try{b0(r,s);var _=rm,A=Ng(s.containerInfo),I=_.focusedElem,j=_.selectionRange;if(A!==I&&I&&I.ownerDocument&&Ig(I.ownerDocument.documentElement,I)){if(j!==null&&Rf(I)){var K=j.start,re=j.end;if(re===void 0&&(re=K),"selectionStart"in I)I.selectionStart=K,I.selectionEnd=Math.min(re,I.value.length);else{var le=I.ownerDocument||document,X=le&&le.defaultView||window;if(X.getSelection){var se=X.getSelection(),Ae=I.textContent.length,Pe=Math.min(j.start,Ae),vt=j.end===void 0?Pe:Math.min(j.end,Ae);!se.extend&&Pe>vt&&(A=vt,vt=Pe,Pe=A);var $=wg(I,Pe),B=wg(I,vt);if($&&B&&(se.rangeCount!==1||se.anchorNode!==$.node||se.anchorOffset!==$.offset||se.focusNode!==B.node||se.focusOffset!==B.offset)){var J=le.createRange();J.setStart($.node,$.offset),se.removeAllRanges(),Pe>vt?(se.addRange(J),se.extend(B.node,B.offset)):(J.setEnd(B.node,B.offset),se.addRange(J))}}}}for(le=[],se=I;se=se.parentNode;)se.nodeType===1&&le.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<le.length;I++){var oe=le[I];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}sd=!!im,rm=im=null}finally{ct=v,Z.p=c,te.T=o}}s.current=r,Wt=2}}function H0(){if(Wt===2){Wt=0;var s=mr,r=yo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=te.T,te.T=null;var c=Z.p;Z.p=2;var v=ct;ct|=4;try{v0(s,r.alternate,r)}finally{ct=v,Z.p=c,te.T=o}}Wt=3}}function G0(){if(Wt===4||Wt===3){Wt=0,Va();var s=mr,r=yo,o=Ei,c=D0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Wt=5:(Wt=0,yo=mr=null,$0(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(hr=null),ri(o),r=r.stateNode,fe&&typeof fe.onCommitFiberRoot=="function")try{fe.onCommitFiberRoot(ce,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=te.T,v=Z.p,Z.p=2,te.T=null;try{for(var _=s.onRecoverableError,A=0;A<c.length;A++){var I=c[A];_(I.value,{componentStack:I.stack})}}finally{te.T=r,Z.p=v}}(Ei&3)!==0&&Gc(),Js(s),v=s.pendingLanes,(o&261930)!==0&&(v&42)!==0?s===Gh?Jl++:(Jl=0,Gh=s):Jl=0,Kl(0)}}function $0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Nl(r)))}function Gc(){return z0(),H0(),G0(),Y0()}function Y0(){if(Wt!==5)return!1;var s=mr,r=zh;zh=0;var o=ri(Ei),c=te.T,v=Z.p;try{Z.p=32>o?32:o,te.T=null,o=Hh,Hh=null;var _=mr,A=Ei;if(Wt=0,yo=mr=null,Ei=0,(ct&6)!==0)throw Error(i(331));var I=ct;if(ct|=4,I0(_.current),S0(_,_.current,A,o),ct=I,Kl(0,!1),fe&&typeof fe.onPostCommitFiberRoot=="function")try{fe.onPostCommitFiberRoot(ce,_)}catch{}return!0}finally{Z.p=v,te.T=c,$0(s,r)}}function J0(s,r,o){r=Zn(o,r),r=bh(s.stateNode,r,2),s=or(s,r,2),s!==null&&(Xe(s,2),Js(s))}function mt(s,r,o){if(s.tag===3)J0(s,s,o);else for(;r!==null;){if(r.tag===3){J0(r,s,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(hr===null||!hr.has(c))){s=Zn(o,s),o=Ky(2),c=or(r,o,2),c!==null&&(Qy(o,c,r,s),Xe(c,2),Js(c));break}}r=r.return}}function Jh(s,r,o){var c=s.pingCache;if(c===null){c=s.pingCache=new $S;var v=new Set;c.set(r,v)}else v=c.get(r),v===void 0&&(v=new Set,c.set(r,v));v.has(o)||(Fh=!0,v.add(o),s=XS.bind(null,s,r,o),r.then(s,s))}function XS(s,r,o){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Tt===s&&(We&o)===o&&(Pt===4||Pt===3&&(We&62914560)===We&&300>ln()-jc?(ct&2)===0&&vo(s,0):qh|=o,go===We&&(go=0)),Js(s)}function K0(s,r){r===0&&(r=xt()),s=ra(s,r),s!==null&&(Xe(s,r),Js(s))}function WS(s){var r=s.memoizedState,o=0;r!==null&&(o=r.retryLane),K0(s,o)}function ZS(s,r){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,v=s.memoizedState;v!==null&&(o=v.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),K0(s,o)}function eC(s,r){return Vt(s,r)}var $c=null,To=null,Kh=!1,Yc=!1,Qh=!1,gr=0;function Js(s){s!==To&&s.next===null&&(To===null?$c=To=s:To=To.next=s),Yc=!0,Kh||(Kh=!0,nC())}function Kl(s,r){if(!Qh&&Yc){Qh=!0;do for(var o=!1,c=$c;c!==null;){if(s!==0){var v=c.pendingLanes;if(v===0)var _=0;else{var A=c.suspendedLanes,I=c.pingedLanes;_=(1<<31-_e(42|s)+1)-1,_&=v&~(A&~I),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(o=!0,Z0(c,_))}else _=We,_=xe(c,c===Tt?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(_&3)===0||rt(c,_)||(o=!0,Z0(c,_));c=c.next}while(o);Qh=!1}}function tC(){Q0()}function Q0(){Yc=Kh=!1;var s=0;gr!==0&&fC()&&(s=gr);for(var r=ln(),o=null,c=$c;c!==null;){var v=c.next,_=X0(c,r);_===0?(c.next=null,o===null?$c=v:o.next=v,v===null&&(To=o)):(o=c,(s!==0||(_&3)!==0)&&(Yc=!0)),c=v}Wt!==0&&Wt!==5||Kl(s),gr!==0&&(gr=0)}function X0(s,r){for(var o=s.suspendedLanes,c=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var A=31-_e(_),I=1<<A,j=v[A];j===-1?((I&o)===0||(I&c)!==0)&&(v[A]=Un(I,r)):j<=r&&(s.expiredLanes|=I),_&=~I}if(r=Tt,o=We,o=xe(s,s===r?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===r&&(ht===2||ht===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Is(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||rt(s,o)){if(r=o&-o,r===s.callbackPriority)return r;switch(c!==null&&Is(c),ri(o)){case 2:case 8:o=Hi;break;case 32:o=us;break;case 268435456:o=Gr;break;default:o=us}return c=W0.bind(null,s),o=Vt(o,c),s.callbackPriority=r,s.callbackNode=o,r}return c!==null&&c!==null&&Is(c),s.callbackPriority=2,s.callbackNode=null,2}function W0(s,r){if(Wt!==0&&Wt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Gc()&&s.callbackNode!==o)return null;var c=We;return c=xe(s,s===Tt?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(P0(s,c,r),X0(s,ln()),s.callbackNode!=null&&s.callbackNode===o?W0.bind(null,s):null)}function Z0(s,r){if(Gc())return null;P0(s,r,!0)}function nC(){mC(function(){(ct&6)!==0?Vt(Hr,tC):Q0()})}function Xh(){if(gr===0){var s=io;s===0&&(s=wn,wn<<=1,(wn&261888)===0&&(wn=256)),gr=s}return gr}function ev(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:za(""+s)}function tv(s,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,s.id&&o.setAttribute("form",s.id),r.parentNode.insertBefore(o,r),s=new FormData(s),o.parentNode.removeChild(o),s}function sC(s,r,o,c,v){if(r==="submit"&&o&&o.stateNode===v){var _=ev((v[tn]||null).action),A=c.submitter;A&&(r=(r=A[tn]||null)?ev(r.formAction):A.getAttribute("formAction"),r!==null&&(_=r,A=null));var I=new qs("action","action",null,c,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(gr!==0){var j=A?tv(v,A):new FormData(v);yh(o,{pending:!0,data:j,method:v.method,action:_},null,j)}}else typeof _=="function"&&(I.preventDefault(),j=A?tv(v,A):new FormData(v),yh(o,{pending:!0,data:j,method:v.method,action:_},_,j))},currentTarget:v}]})}}for(var Wh=0;Wh<kf.length;Wh++){var Zh=kf[Wh],iC=Zh.toLowerCase(),rC=Zh[0].toUpperCase()+Zh.slice(1);vs(iC,"on"+rC)}vs(Mg,"onAnimationEnd"),vs(Pg,"onAnimationIteration"),vs(kg,"onAnimationStart"),vs("dblclick","onDoubleClick"),vs("focusin","onFocus"),vs("focusout","onBlur"),vs(xS,"onTransitionRun"),vs(ES,"onTransitionStart"),vs(bS,"onTransitionCancel"),vs(Vg,"onTransitionEnd"),Us("onMouseEnter",["mouseout","mouseover"]),Us("onMouseLeave",["mouseout","mouseover"]),Us("onPointerEnter",["pointerout","pointerover"]),Us("onPointerLeave",["pointerout","pointerover"]),Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ql));function nv(s,r){r=(r&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],v=c.event;c=c.listeners;e:{var _=void 0;if(r)for(var A=c.length-1;0<=A;A--){var I=c[A],j=I.instance,K=I.currentTarget;if(I=I.listener,j!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=K;try{_(v)}catch(re){lc(re)}v.currentTarget=null,_=j}else for(A=0;A<c.length;A++){if(I=c[A],j=I.instance,K=I.currentTarget,I=I.listener,j!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=K;try{_(v)}catch(re){lc(re)}v.currentTarget=null,_=j}}}}function Qe(s,r){var o=r[Oa];o===void 0&&(o=r[Oa]=new Set);var c=s+"__bubble";o.has(c)||(sv(r,s,2,!1),o.add(c))}function em(s,r,o){var c=0;r&&(c|=4),sv(o,s,c,r)}var Jc="_reactListening"+Math.random().toString(36).slice(2);function tm(s){if(!s[Jc]){s[Jc]=!0,ll.forEach(function(o){o!=="selectionchange"&&(aC.has(o)||em(o,!1,s),em(o,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Jc]||(r[Jc]=!0,em("selectionchange",!1,r))}}function sv(s,r,o,c){switch(Mv(r)){case 2:var v=kC;break;case 8:v=VC;break;default:v=gm}o=v.bind(null,r,o,s),v=void 0,!Xr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(v=!0),c?v!==void 0?s.addEventListener(r,o,{capture:!0,passive:v}):s.addEventListener(r,o,!0):v!==void 0?s.addEventListener(r,o,{passive:v}):s.addEventListener(r,o,!1)}function nm(s,r,o,c,v){var _=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var I=c.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=c.return;A!==null;){var j=A.tag;if((j===3||j===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=ks(I),A===null)return;if(j=A.tag,j===5||j===6||j===26||j===27){c=_=A;continue e}I=I.parentNode}}c=c.return}Xi(function(){var K=_,re=Kn(o),le=[];e:{var X=Lg.get(s);if(X!==void 0){var se=qs,Ae=s;switch(s){case"keypress":if(Zr(o)===0)break e;case"keydown":case"keyup":se=rc;break;case"focusin":Ae="focus",se=ta;break;case"focusout":Ae="blur",se=ta;break;case"beforeblur":case"afterblur":se=ta;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=xl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=Qu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=E;break;case Mg:case Pg:case kg:se=Wu;break;case Vg:se=M;break;case"scroll":case"scrollend":se=Tl;break;case"wheel":se=ne;break;case"copy":case"cut":case"paste":se=Zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=li;break;case"toggle":case"beforetoggle":se=ze}var Pe=(r&4)!==0,vt=!Pe&&(s==="scroll"||s==="scrollend"),$=Pe?X!==null?X+"Capture":null:X;Pe=[];for(var B=K,J;B!==null;){var oe=B;if(J=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||J===null||$===null||(oe=ms(B,$),oe!=null&&Pe.push(Xl(B,oe,J))),vt)break;B=B.return}0<Pe.length&&(X=new se(X,Ae,null,o,re),le.push({event:X,listeners:Pe}))}}if((r&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",se=s==="mouseout"||s==="pointerout",X&&o!==yl&&(Ae=o.relatedTarget||o.fromElement)&&(ks(Ae)||Ae[Ms]))break e;if((se||X)&&(X=re.window===re?re:(X=re.ownerDocument)?X.defaultView||X.parentWindow:window,se?(Ae=o.relatedTarget||o.toElement,se=K,Ae=Ae?ks(Ae):null,Ae!==null&&(vt=l(Ae),Pe=Ae.tag,Ae!==vt||Pe!==5&&Pe!==27&&Pe!==6)&&(Ae=null)):(se=null,Ae=K),se!==Ae)){if(Pe=xl,oe="onMouseLeave",$="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Pe=li,oe="onPointerLeave",$="onPointerEnter",B="pointer"),vt=se==null?X:On(se),J=Ae==null?X:On(Ae),X=new Pe(oe,B+"leave",se,o,re),X.target=vt,X.relatedTarget=J,oe=null,ks(re)===K&&(Pe=new Pe($,B+"enter",Ae,o,re),Pe.target=J,Pe.relatedTarget=vt,oe=Pe),vt=oe,se&&Ae)t:{for(Pe=oC,$=se,B=Ae,J=0,oe=$;oe;oe=Pe(oe))J++;oe=0;for(var Ne=B;Ne;Ne=Pe(Ne))oe++;for(;0<J-oe;)$=Pe($),J--;for(;0<oe-J;)B=Pe(B),oe--;for(;J--;){if($===B||B!==null&&$===B.alternate){Pe=$;break t}$=Pe($),B=Pe(B)}Pe=null}else Pe=null;se!==null&&iv(le,X,se,Pe,!1),Ae!==null&&vt!==null&&iv(le,vt,Ae,Pe,!0)}}e:{if(X=K?On(K):window,se=X.nodeName&&X.nodeName.toLowerCase(),se==="select"||se==="input"&&X.type==="file")var at=xg;else if(_g(X))if(Eg)at=vS;else{at=gS;var we=pS}else se=X.nodeName,!se||se.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?K&&Ba(K.elementType)&&(at=xg):at=yS;if(at&&(at=at(s,K))){Tg(le,at,o,re);break e}we&&we(s,X,K),s==="focusout"&&K&&X.type==="number"&&K.memoizedProps.value!=null&&ml(X,"number",X.value)}switch(we=K?On(K):window,s){case"focusin":(_g(we)||we.contentEditable==="true")&&(Qa=we,Df=K,Cl=null);break;case"focusout":Cl=Df=Qa=null;break;case"mousedown":Mf=!0;break;case"contextmenu":case"mouseup":case"dragend":Mf=!1,Rg(le,o,re);break;case"selectionchange":if(TS)break;case"keydown":case"keyup":Rg(le,o,re)}var $e;if(ut)e:{switch(s){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Ka?na(s,o)&&(Ze="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ze="onCompositionStart");Ze&&(Hs&&o.locale!=="ko"&&(Ka||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Ka&&($e=_l()):(Fs=re,vl="value"in Fs?Fs.value:Fs.textContent,Ka=!0)),we=Kc(K,Ze),0<we.length&&(Ze=new zs(Ze,s,null,o,re),le.push({event:Ze,listeners:we}),$e?Ze.data=$e:($e=Ja(o),$e!==null&&(Ze.data=$e)))),($e=Xn?dS(s,o):fS(s,o))&&(Ze=Kc(K,"onBeforeInput"),0<Ze.length&&(we=new zs("onBeforeInput","beforeinput",null,o,re),le.push({event:we,listeners:Ze}),we.data=$e)),sC(le,s,K,o,re)}nv(le,r)})}function Xl(s,r,o){return{instance:s,listener:r,currentTarget:o}}function Kc(s,r){for(var o=r+"Capture",c=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=ms(s,o),v!=null&&c.unshift(Xl(s,v,_)),v=ms(s,r),v!=null&&c.push(Xl(s,v,_))),s.tag===3)return c;s=s.return}return[]}function oC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function iv(s,r,o,c,v){for(var _=r._reactName,A=[];o!==null&&o!==c;){var I=o,j=I.alternate,K=I.stateNode;if(I=I.tag,j!==null&&j===c)break;I!==5&&I!==26&&I!==27||K===null||(j=K,v?(K=ms(o,_),K!=null&&A.unshift(Xl(o,K,j))):v||(K=ms(o,_),K!=null&&A.push(Xl(o,K,j)))),o=o.return}A.length!==0&&s.push({event:r,listeners:A})}var lC=/\r\n?/g,uC=/\u0000|\uFFFD/g;function rv(s){return(typeof s=="string"?s:""+s).replace(lC,`
`).replace(uC,"")}function av(s,r){return r=rv(r),rv(s)===r}function yt(s,r,o,c,v,_){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Nn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Nn(s,""+c);break;case"className":jn(s,"class",c);break;case"tabIndex":jn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":jn(s,o,c);break;case"style":gl(s,c,_);break;case"data":if(r!=="object"){jn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=za(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(o==="formAction"?(r!=="input"&&yt(s,r,"name",v.name,v,null),yt(s,r,"formEncType",v.formEncType,v,null),yt(s,r,"formMethod",v.formMethod,v,null),yt(s,r,"formTarget",v.formTarget,v,null)):(yt(s,r,"encType",v.encType,v,null),yt(s,r,"method",v.method,v,null),yt(s,r,"target",v.target,v,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=za(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=hs);break;case"onScroll":c!=null&&Qe("scroll",s);break;case"onScrollEnd":c!=null&&Qe("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=za(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":Qe("beforetoggle",s),Qe("toggle",s),Fa(s,"popover",c);break;case"xlinkActuate":zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":zt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":zt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":zt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":zt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Fa(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ku.get(o)||o,Fa(s,o,c))}}function sm(s,r,o,c,v,_){switch(o){case"style":gl(s,c,_);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Nn(s,c):(typeof c=="number"||typeof c=="bigint")&&Nn(s,""+c);break;case"onScroll":c!=null&&Qe("scroll",s);break;case"onScrollEnd":c!=null&&Qe("scrollend",s);break;case"onClick":c!=null&&(s.onclick=hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ul.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(v=o.endsWith("Capture"),r=o.slice(2,v?o.length-7:void 0),_=s[tn]||null,_=_!=null?_[o]:null,typeof _=="function"&&s.removeEventListener(r,_,v),typeof c=="function")){typeof _!="function"&&_!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(r,c,v);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):Fa(s,o,c)}}}function hn(s,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",s),Qe("load",s);var c=!1,v=!1,_;for(_ in o)if(o.hasOwnProperty(_)){var A=o[_];if(A!=null)switch(_){case"src":c=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,_,A,o,null)}}v&&yt(s,r,"srcSet",o.srcSet,o,null),c&&yt(s,r,"src",o.src,o,null);return;case"input":Qe("invalid",s);var I=_=A=v=null,j=null,K=null;for(c in o)if(o.hasOwnProperty(c)){var re=o[c];if(re!=null)switch(c){case"name":v=re;break;case"type":A=re;break;case"checked":j=re;break;case"defaultChecked":K=re;break;case"value":_=re;break;case"defaultValue":I=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,r));break;default:yt(s,r,c,re,o,null)}}$u(s,_,I,j,K,A,v,!1);return;case"select":Qe("invalid",s),c=A=_=null;for(v in o)if(o.hasOwnProperty(v)&&(I=o[v],I!=null))switch(v){case"value":_=I;break;case"defaultValue":A=I;break;case"multiple":c=I;default:yt(s,r,v,I,o,null)}r=_,o=A,s.multiple=!!c,r!=null?Yi(s,!!c,r,!1):o!=null&&Yi(s,!!c,o,!0);return;case"textarea":Qe("invalid",s),_=v=c=null;for(A in o)if(o.hasOwnProperty(A)&&(I=o[A],I!=null))switch(A){case"value":c=I;break;case"defaultValue":v=I;break;case"children":_=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:yt(s,r,A,I,o,null)}Ji(s,c,v,_);return;case"option":for(j in o)if(o.hasOwnProperty(j)&&(c=o[j],c!=null))switch(j){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:yt(s,r,j,c,o,null)}return;case"dialog":Qe("beforetoggle",s),Qe("toggle",s),Qe("cancel",s),Qe("close",s);break;case"iframe":case"object":Qe("load",s);break;case"video":case"audio":for(c=0;c<Ql.length;c++)Qe(Ql[c],s);break;case"image":Qe("error",s),Qe("load",s);break;case"details":Qe("toggle",s);break;case"embed":case"source":case"link":Qe("error",s),Qe("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in o)if(o.hasOwnProperty(K)&&(c=o[K],c!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,K,c,o,null)}return;default:if(Ba(r)){for(re in o)o.hasOwnProperty(re)&&(c=o[re],c!==void 0&&sm(s,r,re,c,o,void 0));return}}for(I in o)o.hasOwnProperty(I)&&(c=o[I],c!=null&&yt(s,r,I,c,o,null))}function cC(s,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,A=null,I=null,j=null,K=null,re=null;for(se in o){var le=o[se];if(o.hasOwnProperty(se)&&le!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":j=le;default:c.hasOwnProperty(se)||yt(s,r,se,null,c,le)}}for(var X in c){var se=c[X];if(le=o[X],c.hasOwnProperty(X)&&(se!=null||le!=null))switch(X){case"type":_=se;break;case"name":v=se;break;case"checked":K=se;break;case"defaultChecked":re=se;break;case"value":A=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:se!==le&&yt(s,r,X,se,c,le)}}qa(s,A,I,j,K,re,_,v);return;case"select":se=A=I=X=null;for(_ in o)if(j=o[_],o.hasOwnProperty(_)&&j!=null)switch(_){case"value":break;case"multiple":se=j;default:c.hasOwnProperty(_)||yt(s,r,_,null,c,j)}for(v in c)if(_=c[v],j=o[v],c.hasOwnProperty(v)&&(_!=null||j!=null))switch(v){case"value":X=_;break;case"defaultValue":I=_;break;case"multiple":A=_;default:_!==j&&yt(s,r,v,_,c,j)}r=I,o=A,c=se,X!=null?Yi(s,!!o,X,!1):!!c!=!!o&&(r!=null?Yi(s,!!o,r,!0):Yi(s,!!o,o?[]:"",!1));return;case"textarea":se=X=null;for(I in o)if(v=o[I],o.hasOwnProperty(I)&&v!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:yt(s,r,I,null,c,v)}for(A in c)if(v=c[A],_=o[A],c.hasOwnProperty(A)&&(v!=null||_!=null))switch(A){case"value":X=v;break;case"defaultValue":se=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==_&&yt(s,r,A,v,c,_)}Yu(s,X,se);return;case"option":for(var Ae in o)if(X=o[Ae],o.hasOwnProperty(Ae)&&X!=null&&!c.hasOwnProperty(Ae))switch(Ae){case"selected":s.selected=!1;break;default:yt(s,r,Ae,null,c,X)}for(j in c)if(X=c[j],se=o[j],c.hasOwnProperty(j)&&X!==se&&(X!=null||se!=null))switch(j){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:yt(s,r,j,X,c,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)X=o[Pe],o.hasOwnProperty(Pe)&&X!=null&&!c.hasOwnProperty(Pe)&&yt(s,r,Pe,null,c,X);for(K in c)if(X=c[K],se=o[K],c.hasOwnProperty(K)&&X!==se&&(X!=null||se!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,r));break;default:yt(s,r,K,X,c,se)}return;default:if(Ba(r)){for(var vt in o)X=o[vt],o.hasOwnProperty(vt)&&X!==void 0&&!c.hasOwnProperty(vt)&&sm(s,r,vt,void 0,c,X);for(re in c)X=c[re],se=o[re],!c.hasOwnProperty(re)||X===se||X===void 0&&se===void 0||sm(s,r,re,X,c,se);return}}for(var $ in o)X=o[$],o.hasOwnProperty($)&&X!=null&&!c.hasOwnProperty($)&&yt(s,r,$,null,c,X);for(le in c)X=c[le],se=o[le],!c.hasOwnProperty(le)||X===se||X==null&&se==null||yt(s,r,le,X,c,se)}function ov(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var v=o[c],_=v.transferSize,A=v.initiatorType,I=v.duration;if(_&&I&&ov(A)){for(A=0,I=v.responseEnd,c+=1;c<o.length;c++){var j=o[c],K=j.startTime;if(K>I)break;var re=j.transferSize,le=j.initiatorType;re&&ov(le)&&(j=j.responseEnd,A+=re*(j<I?1:(I-K)/(j-K)))}if(--c,r+=8*(_+A)/(v.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var im=null,rm=null;function Qc(s){return s.nodeType===9?s:s.ownerDocument}function lv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function am(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var om=null;function fC(){var s=window.event;return s&&s.type==="popstate"?s===om?!1:(om=s,!0):(om=null,!1)}var cv=typeof setTimeout=="function"?setTimeout:void 0,hC=typeof clearTimeout=="function"?clearTimeout:void 0,dv=typeof Promise=="function"?Promise:void 0,mC=typeof queueMicrotask=="function"?queueMicrotask:typeof dv<"u"?function(s){return dv.resolve(null).then(s).catch(pC)}:cv;function pC(s){setTimeout(function(){throw s})}function yr(s){return s==="head"}function fv(s,r){var o=r,c=0;do{var v=o.nextSibling;if(s.removeChild(o),v&&v.nodeType===8)if(o=v.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(v),Ao(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Wl(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Wl(o);for(var _=o.firstChild;_;){var A=_.nextSibling,I=_.nodeName;_[Ps]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&_.rel.toLowerCase()==="stylesheet"||o.removeChild(_),_=A}}else o==="body"&&Wl(s.ownerDocument.body);o=v}while(o);Ao(r)}function hv(s,r){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function lm(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":lm(o),ja(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function gC(s,r,o,c){for(;s.nodeType===1;){var v=o;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[Ps])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=is(s.nextSibling),s===null)break}return null}function yC(s,r,o){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=is(s.nextSibling),s===null))return null;return s}function mv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=is(s.nextSibling),s===null))return null;return s}function um(s){return s.data==="$?"||s.data==="$~"}function cm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function vC(s,r){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function is(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var dm=null;function pv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(r===0)return is(s.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}s=s.nextSibling}return null}function gv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return s;r--}else o!=="/$"&&o!=="/&"||r++}s=s.previousSibling}return null}function yv(s,r,o){switch(r=Qc(o),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Wl(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);ja(s)}var rs=new Map,vv=new Set;function Xc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var bi=Z.d;Z.d={f:_C,r:TC,D:xC,C:EC,L:bC,m:AC,X:CC,S:SC,M:wC};function _C(){var s=bi.f(),r=Bc();return s||r}function TC(s){var r=Jn(s);r!==null&&r.tag===5&&r.type==="form"?Vy(r):bi.r(s)}var xo=typeof document>"u"?null:document;function _v(s,r,o){var c=xo;if(c&&typeof r=="string"&&r){var v=In(r);v='link[rel="'+s+'"][href="'+v+'"]',typeof o=="string"&&(v+='[crossorigin="'+o+'"]'),vv.has(v)||(vv.add(v),s={rel:s,crossOrigin:o,href:r},c.querySelector(v)===null&&(r=c.createElement("link"),hn(r,"link",s),Bt(r),c.head.appendChild(r)))}}function xC(s){bi.D(s),_v("dns-prefetch",s,null)}function EC(s,r){bi.C(s,r),_v("preconnect",s,r)}function bC(s,r,o){bi.L(s,r,o);var c=xo;if(c&&s&&r){var v='link[rel="preload"][as="'+In(r)+'"]';r==="image"&&o&&o.imageSrcSet?(v+='[imagesrcset="'+In(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(v+='[imagesizes="'+In(o.imageSizes)+'"]')):v+='[href="'+In(s)+'"]';var _=v;switch(r){case"style":_=Eo(s);break;case"script":_=bo(s)}rs.has(_)||(s=x({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:s,as:r},o),rs.set(_,s),c.querySelector(v)!==null||r==="style"&&c.querySelector(Zl(_))||r==="script"&&c.querySelector(eu(_))||(r=c.createElement("link"),hn(r,"link",s),Bt(r),c.head.appendChild(r)))}}function AC(s,r){bi.m(s,r);var o=xo;if(o&&s){var c=r&&typeof r.as=="string"?r.as:"script",v='link[rel="modulepreload"][as="'+In(c)+'"][href="'+In(s)+'"]',_=v;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=bo(s)}if(!rs.has(_)&&(s=x({rel:"modulepreload",href:s},r),rs.set(_,s),o.querySelector(v)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(eu(_)))return}c=o.createElement("link"),hn(c,"link",s),Bt(c),o.head.appendChild(c)}}}function SC(s,r,o){bi.S(s,r,o);var c=xo;if(c&&s){var v=Vs(c).hoistableStyles,_=Eo(s);r=r||"default";var A=v.get(_);if(!A){var I={loading:0,preload:null};if(A=c.querySelector(Zl(_)))I.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":r},o),(o=rs.get(_))&&fm(s,o);var j=A=c.createElement("link");Bt(j),hn(j,"link",s),j._p=new Promise(function(K,re){j.onload=K,j.onerror=re}),j.addEventListener("load",function(){I.loading|=1}),j.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Wc(A,r,c)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(_,A)}}}function CC(s,r){bi.X(s,r);var o=xo;if(o&&s){var c=Vs(o).hoistableScripts,v=bo(s),_=c.get(v);_||(_=o.querySelector(eu(v)),_||(s=x({src:s,async:!0},r),(r=rs.get(v))&&hm(s,r),_=o.createElement("script"),Bt(_),hn(_,"link",s),o.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function wC(s,r){bi.M(s,r);var o=xo;if(o&&s){var c=Vs(o).hoistableScripts,v=bo(s),_=c.get(v);_||(_=o.querySelector(eu(v)),_||(s=x({src:s,async:!0,type:"module"},r),(r=rs.get(v))&&hm(s,r),_=o.createElement("script"),Bt(_),hn(_,"link",s),o.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function Tv(s,r,o,c){var v=(v=ke.current)?Xc(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Eo(o.href),o=Vs(v).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Eo(o.href);var _=Vs(v).hoistableStyles,A=_.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,A),(_=v.querySelector(Zl(s)))&&!_._p&&(A.instance=_,A.state.loading=5),rs.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},rs.set(s,o),_||IC(v,s,o,A.state))),r&&c===null)throw Error(i(528,""));return A}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=bo(o),o=Vs(v).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Eo(s){return'href="'+In(s)+'"'}function Zl(s){return'link[rel="stylesheet"]['+s+"]"}function xv(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function IC(s,r,o,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),hn(r,"link",o),Bt(r),s.head.appendChild(r))}function bo(s){return'[src="'+In(s)+'"]'}function eu(s){return"script[async]"+s}function Ev(s,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+In(o.href)+'"]');if(c)return r.instance=c,Bt(c),c;var v=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),Bt(c),hn(c,"style",v),Wc(c,o.precedence,s),r.instance=c;case"stylesheet":v=Eo(o.href);var _=s.querySelector(Zl(v));if(_)return r.state.loading|=4,r.instance=_,Bt(_),_;c=xv(o),(v=rs.get(v))&&fm(c,v),_=(s.ownerDocument||s).createElement("link"),Bt(_);var A=_;return A._p=new Promise(function(I,j){A.onload=I,A.onerror=j}),hn(_,"link",c),r.state.loading|=4,Wc(_,o.precedence,s),r.instance=_;case"script":return _=bo(o.src),(v=s.querySelector(eu(_)))?(r.instance=v,Bt(v),v):(c=o,(v=rs.get(_))&&(c=x({},o),hm(c,v)),s=s.ownerDocument||s,v=s.createElement("script"),Bt(v),hn(v,"link",c),s.head.appendChild(v),r.instance=v);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Wc(c,o.precedence,s));return r.instance}function Wc(s,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=c.length?c[c.length-1]:null,_=v,A=0;A<c.length;A++){var I=c[A];if(I.dataset.precedence===r)_=I;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(s,r.firstChild))}function fm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function hm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Zc=null;function bv(s,r,o){if(Zc===null){var c=new Map,v=Zc=new Map;v.set(o,c)}else v=Zc,c=v.get(o),c||(c=new Map,v.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),v=0;v<o.length;v++){var _=o[v];if(!(_[Ps]||_[qt]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(r)||"";A=s+A;var I=c.get(A);I?I.push(_):c.set(A,[_])}}return c}function Av(s,r,o){s=s.ownerDocument||s,s.head.insertBefore(o,r==="title"?s.querySelector("head > title"):null)}function NC(s,r,o){if(o===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Sv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function RC(s,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var v=Eo(c.href),_=r.querySelector(Zl(v));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=ed.bind(s),r.then(s,s)),o.state.loading|=4,o.instance=_,Bt(_);return}_=r.ownerDocument||r,c=xv(c),(v=rs.get(v))&&fm(c,v),_=_.createElement("link"),Bt(_);var A=_;A._p=new Promise(function(I,j){A.onload=I,A.onerror=j}),hn(_,"link",c),o.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=ed.bind(s),r.addEventListener("load",o),r.addEventListener("error",o))}}var mm=0;function DC(s,r){return s.stylesheets&&s.count===0&&nd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&nd(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+r);0<s.imgBytes&&mm===0&&(mm=62500*dC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&nd(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>mm?50:800)+r);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(v)}}:null}function ed(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)nd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var td=null;function nd(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,td=new Map,r.forEach(MC,s),td=null,ed.call(s))}function MC(s,r){if(!(r.state.loading&4)){var o=td.get(s);if(o)var c=o.get(null);else{o=new Map,td.set(s,o);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var A=v[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(o.set(A.dataset.precedence,A),c=A)}c&&o.set(null,c)}v=r.instance,A=v.getAttribute("data-precedence"),_=o.get(A)||c,_===c&&o.set(null,v),o.set(A,v),this.count++,c=ed.bind(this),v.addEventListener("load",c),v.addEventListener("error",c),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),r.state.loading|=4}}var tu={$$typeof:ee,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function PC(s,r,o,c,v,_,A,I,j){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xt(0),this.hiddenUpdates=Xt(null),this.identifierPrefix=c,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function Cv(s,r,o,c,v,_,A,I,j,K,re,le){return s=new PC(s,r,o,A,j,K,re,le,I),r=1,_===!0&&(r|=24),_=qn(3,null,null,r),s.current=_,_.stateNode=s,r=Yf(),r.refCount++,s.pooledCache=r,r.refCount++,_.memoizedState={element:c,isDehydrated:o,cache:r},Xf(_),s}function wv(s){return s?(s=Za,s):Za}function Iv(s,r,o,c,v,_){v=wv(v),c.context===null?c.context=v:c.pendingContext=v,c=ar(r),c.payload={element:o},_=_===void 0?null:_,_!==null&&(c.callback=_),o=or(s,c,r),o!==null&&(kn(o,s,r),Pl(o,s,r))}function Nv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<r?o:r}}function pm(s,r){Nv(s,r),(s=s.alternate)&&Nv(s,r)}function Rv(s){if(s.tag===13||s.tag===31){var r=ra(s,67108864);r!==null&&kn(r,s,67108864),pm(s,67108864)}}function Dv(s){if(s.tag===13||s.tag===31){var r=$n();r=Yr(r);var o=ra(s,r);o!==null&&kn(o,s,r),pm(s,r)}}var sd=!0;function kC(s,r,o,c){var v=te.T;te.T=null;var _=Z.p;try{Z.p=2,gm(s,r,o,c)}finally{Z.p=_,te.T=v}}function VC(s,r,o,c){var v=te.T;te.T=null;var _=Z.p;try{Z.p=8,gm(s,r,o,c)}finally{Z.p=_,te.T=v}}function gm(s,r,o,c){if(sd){var v=ym(c);if(v===null)nm(s,r,c,id,o),Pv(s,c);else if(UC(v,s,r,o,c))c.stopPropagation();else if(Pv(s,c),r&4&&-1<LC.indexOf(s)){for(;v!==null;){var _=Jn(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=xn(_.pendingLanes);if(A!==0){var I=_;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var j=1<<31-_e(A);I.entanglements[1]|=j,A&=~j}Js(_),(ct&6)===0&&(Fc=ln()+500,Kl(0))}}break;case 31:case 13:I=ra(_,2),I!==null&&kn(I,_,2),Bc(),pm(_,2)}if(_=ym(c),_===null&&nm(s,r,c,id,o),_===v)break;v=_}v!==null&&c.stopPropagation()}else nm(s,r,c,null,o)}}function ym(s){return s=Kn(s),vm(s)}var id=null;function vm(s){if(id=null,s=ks(s),s!==null){var r=l(s);if(r===null)s=null;else{var o=r.tag;if(o===13){if(s=u(r),s!==null)return s;s=null}else if(o===31){if(s=f(r),s!==null)return s;s=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return id=s,null}function Mv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ns()){case Hr:return 2;case Hi:return 8;case us:case La:return 32;case Gr:return 268435456;default:return 32}default:return 32}}var _m=!1,vr=null,_r=null,Tr=null,nu=new Map,su=new Map,xr=[],LC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pv(s,r){switch(s){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":_r=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":nu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":su.delete(r.pointerId)}}function iu(s,r,o,c,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:_,targetContainers:[v]},r!==null&&(r=Jn(r),r!==null&&Rv(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,v!==null&&r.indexOf(v)===-1&&r.push(v),s)}function UC(s,r,o,c,v){switch(r){case"focusin":return vr=iu(vr,s,r,o,c,v),!0;case"dragenter":return _r=iu(_r,s,r,o,c,v),!0;case"mouseover":return Tr=iu(Tr,s,r,o,c,v),!0;case"pointerover":var _=v.pointerId;return nu.set(_,iu(nu.get(_)||null,s,r,o,c,v)),!0;case"gotpointercapture":return _=v.pointerId,su.set(_,iu(su.get(_)||null,s,r,o,c,v)),!0}return!1}function kv(s){var r=ks(s.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=u(o),r!==null){s.blockedOn=r,ds(s.priority,function(){Dv(o)});return}}else if(r===31){if(r=f(o),r!==null){s.blockedOn=r,ds(s.priority,function(){Dv(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function rd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var o=ym(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);yl=c,o.target.dispatchEvent(c),yl=null}else return r=Jn(o),r!==null&&Rv(r),s.blockedOn=o,!1;r.shift()}return!0}function Vv(s,r,o){rd(s)&&o.delete(r)}function OC(){_m=!1,vr!==null&&rd(vr)&&(vr=null),_r!==null&&rd(_r)&&(_r=null),Tr!==null&&rd(Tr)&&(Tr=null),nu.forEach(Vv),su.forEach(Vv)}function ad(s,r){s.blockedOn===r&&(s.blockedOn=null,_m||(_m=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,OC)))}var od=null;function Lv(s){od!==s&&(od=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){od===s&&(od=null);for(var r=0;r<s.length;r+=3){var o=s[r],c=s[r+1],v=s[r+2];if(typeof c!="function"){if(vm(c||o)===null)continue;break}var _=Jn(o);_!==null&&(s.splice(r,3),r-=3,yh(_,{pending:!0,data:v,method:o.method,action:c},c,v))}}))}function Ao(s){function r(j){return ad(j,s)}vr!==null&&ad(vr,s),_r!==null&&ad(_r,s),Tr!==null&&ad(Tr,s),nu.forEach(r),su.forEach(r);for(var o=0;o<xr.length;o++){var c=xr[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<xr.length&&(o=xr[0],o.blockedOn===null);)kv(o),o.blockedOn===null&&xr.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var v=o[c],_=o[c+1],A=v[tn]||null;if(typeof _=="function")A||Lv(o);else if(A){var I=null;if(_&&_.hasAttribute("formAction")){if(v=_,A=_[tn]||null)I=A.formAction;else if(vm(v)!==null)continue}else I=A.action;typeof I=="function"?o[c+1]=I:(o.splice(c,3),c-=3),Lv(o)}}}function Uv(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function r(){v!==null&&(v(),v=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),v!==null&&(v(),v=null)}}}function Tm(s){this._internalRoot=s}ld.prototype.render=Tm.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=$n();Iv(o,c,s,r,null,null)},ld.prototype.unmount=Tm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Iv(s.current,2,null,s,null,null),Bc(),r[Ms]=null}};function ld(s){this._internalRoot=s}ld.prototype.unstable_scheduleHydration=function(s){if(s){var r=Bu();s={blockedOn:null,target:s,priority:r};for(var o=0;o<xr.length&&r!==0&&r<xr[o].priority;o++);xr.splice(o,0,s),o===0&&kv(s)}};var Ov=e.version;if(Ov!=="19.2.0")throw Error(i(527,Ov,"19.2.0"));Z.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?T(s):null,s=s===null?null:s.stateNode,s};var jC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ud.isDisabled&&ud.supportsFiber)try{ce=ud.inject(jC),fe=ud}catch{}}return au.createRoot=function(s,r){if(!a(s))throw Error(i(299));var o=!1,c="",v=Gy,_=$y,A=Yy;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(v=r.onUncaughtError),r.onCaughtError!==void 0&&(_=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=Cv(s,1,!1,null,null,o,c,null,v,_,A,Uv),s[Ms]=r.current,tm(s),new Tm(r)},au.hydrateRoot=function(s,r,o){if(!a(s))throw Error(i(299));var c=!1,v="",_=Gy,A=$y,I=Yy,j=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(_=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError),o.formState!==void 0&&(j=o.formState)),r=Cv(s,1,!0,r,o??null,c,v,j,_,A,I,Uv),r.context=wv(null),o=r.current,c=$n(),c=Yr(c),v=ar(c),v.callback=null,or(o,v,c),o=c,r.current.lanes=o,Xe(r,o),Js(r),s[Ms]=r.current,tm(s),new ld(r)},au.version="19.2.0",au}var Jv;function KC(){if(Jv)return bm.exports;Jv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bm.exports=JC(),bm.exports}var QC=KC();const XC=qx(QC),WC=({darkMode:n,onToggle:e})=>d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🌙":"☀️"})]}),ZC={ar:{"app.title":"لوحة التحكم المالية | MASROF","developed.by":"Developed by K.A Team","add.transaction":"إضافة حركة",logout:"خروج","dark.mode":"الوضع المظلم",notifications:"الإشعارات","enable.notifications":"تفعيل الإشعارات",language:"العربية","tab.summary":"الملخص","tab.analysis":"التحليل","tab.transactions":"الحركات","tab.budget":"الميزانية","tab.investment":"الاستثمار","tab.ai.assistant":"المحلل الذكي","tab.settings":"الإعدادات","tab.cards":"إدارة البطاقات","tab.bank":"البنك","tab.installments":"الأقساط","tab.debts.loans":"الديون والقروض","card.debts.summary":"ملخص ديون البطاقات","card.bank.accounts":"ملخص الحسابات البنكية","card.financial.report":"تقرير مالي شامل","card.categories.summary":"ملخص الفئات",due:"المستحق",remaining:"المتبقي","total.debts":"إجمالي الديون","total.available":"إجمالي المتاح",deposits:"الإيداعات",withdrawals:"السحوبات","total.bank.balances":"إجمالي الأرصدة البنكية","total.income":"إجمالي الدخل","total.expenses":"إجمالي المصاريف",net:"الصافي",rent:"إيجار",groceries:"مواد تموينية",shopping:"تسوق",bills:"سداد فواتير",restaurants:"مطاعم",transport:"مواصلات",entertainment:"ترفيه",health:"صحة",education:"تعليم",other:"أخرى","al.ahli.snb":"الأهلي SNB","emirates.enbd":"الإمارات ENBD","al.ahli.bank":"البنك الاهلي","arab.bank":"البنك العربي",add:"إضافة",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",confirm:"تأكيد",close:"إغلاق",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",active:"نشط",inactive:"غير نشط",pending:"معلق",completed:"مكتمل",cancelled:"ملغي",january:"يناير",february:"فبراير",march:"مارس",april:"أبريل",may:"مايو",june:"يونيو",july:"يوليو",august:"أغسطس",september:"سبتمبر",october:"أكتوبر",november:"نوفمبر",december:"ديسمبر",sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت",sar:"ريال سعودي",usd:"دولار أمريكي",eur:"يورو",aed:"درهم إماراتي",today:"اليوم",yesterday:"أمس","this.week":"هذا الأسبوع","this.month":"هذا الشهر","this.year":"هذا العام","last.week":"الأسبوع الماضي","last.month":"الشهر الماضي","last.year":"العام الماضي",success:"نجح",error:"خطأ",warning:"تحذير",info:"معلومات",loading:"جاري التحميل...","no.data":"لا توجد بيانات","try.again":"حاول مرة أخرى","required.field":"هذا الحقل مطلوب","invalid.email":"البريد الإلكتروني غير صحيح","invalid.amount":"المبلغ غير صحيح","invalid.date":"التاريخ غير صحيح","debt.to.me":"ديون لي","debt.from.me":"ديون علي",loans:"قروض","add.debt":"إضافة دين","add.loan":"إضافة قرض",debtor:"المدين",creditor:"الدائن",lender:"المقرض",amount:"المبلغ",description:"الوصف",date:"التاريخ",status:"الحالة",source:"المصدر",reason:"السبب",installments:"أقساط","paid.installments":"أقساط مدفوعة","remaining.installments":"أقساط متبقية","next.payment":"الدفعة التالية","payment.date":"تاريخ الدفع","installment.amount":"مبلغ القسط","total.amount":"المبلغ الإجمالي",investment:"استثمار","current.value":"القيمة الحالية","initial.investment":"الاستثمار الأولي","profit.loss":"الربح/الخسارة","return.rate":"معدل العائد",budget:"ميزانية","budget.limit":"حد الميزانية",spent:"مصروف","remaining.budget":"الميزانية المتبقية","over.budget":"تجاوز الميزانية",reports:"تقارير","financial.report":"تقرير مالي","monthly.report":"تقرير شهري","yearly.report":"تقرير سنوي","category.report":"تقرير الفئات","income.report":"تقرير الدخل","expense.report":"تقرير المصروفات",settings:"الإعدادات",profile:"الملف الشخصي",account:"الحساب",privacy:"الخصوصية",security:"الأمان",backup:"نسخ احتياطي",restore:"استعادة","export.data":"تصدير البيانات","import.data":"استيراد البيانات","ai.assistant":"المساعد الذكي","ask.question":"اسأل سؤال","get.advice":"احصل على نصيحة","analyze.data":"تحليل البيانات","generate.report":"توليد تقرير",notification:"إشعار","payment.reminder":"تذكير دفع","budget.alert":"تنبيه الميزانية","low.balance":"رصيد منخفض","payment.due":"دفعة مستحقة","network.error":"خطأ في الشبكة","server.error":"خطأ في الخادم","auth.error":"خطأ في المصادقة","permission.error":"خطأ في الصلاحية","validation.error":"خطأ في التحقق","unknown.error":"خطأ غير معروف",details:"التفاصيل","cannot.delete":"لا يمكن الحذف","cannot.delete.category":"لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات","cannot.delete.transaction.type":"لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات","cannot.delete.payment.method":"لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات","restore.backup":"استعادة نسخة احتياطية","confirm.restore":"هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية","api.status":"حالة مفاتيح API"},en:{"app.title":"Financial Dashboard | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Add Transaction",logout:"Logout","dark.mode":"Dark Mode",notifications:"Notifications","enable.notifications":"Enable Notifications",language:"English","tab.summary":"Summary","tab.analysis":"Analysis","tab.transactions":"Transactions","tab.budget":"Budget","tab.investment":"Investment","tab.ai.assistant":"AI Assistant","tab.settings":"Settings","tab.cards":"Card Management","tab.bank":"Bank","tab.installments":"Installments","tab.debts.loans":"Debts & Loans","card.debts.summary":"Card Debts Summary","card.bank.accounts":"Bank Accounts Summary","card.financial.report":"Comprehensive Financial Report","card.categories.summary":"Categories Summary",due:"Due",remaining:"Remaining","total.debts":"Total Debts","total.available":"Total Available",deposits:"Deposits",withdrawals:"Withdrawals","total.bank.balances":"Total Bank Balances","total.income":"Total Income","total.expenses":"Total Expenses",net:"Net",rent:"Rent",groceries:"Groceries",shopping:"Shopping",bills:"Bill Payments",restaurants:"Restaurants",transport:"Transport",entertainment:"Entertainment",health:"Health",education:"Education",other:"Other","al.ahli.snb":"Al Ahli SNB","emirates.enbd":"Emirates ENBD","al.ahli.bank":"Al Ahli Bank","arab.bank":"Arab Bank",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",cancelled:"Cancelled",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sar:"Saudi Riyal",usd:"US Dollar",eur:"Euro",aed:"UAE Dirham",today:"Today",yesterday:"Yesterday","this.week":"This Week","this.month":"This Month","this.year":"This Year","last.week":"Last Week","last.month":"Last Month","last.year":"Last Year",success:"Success",error:"Error",warning:"Warning",info:"Info",loading:"Loading...","no.data":"No Data","try.again":"Try Again","required.field":"This field is required","invalid.email":"Invalid email address","invalid.amount":"Invalid amount","invalid.date":"Invalid date","debt.to.me":"Debts to Me","debt.from.me":"Debts from Me",loans:"Loans","add.debt":"Add Debt","add.loan":"Add Loan",debtor:"Debtor",creditor:"Creditor",lender:"Lender",amount:"Amount",description:"Description",date:"Date",status:"Status",source:"Source",reason:"Reason",installments:"Installments","paid.installments":"Paid Installments","remaining.installments":"Remaining Installments","next.payment":"Next Payment","payment.date":"Payment Date","installment.amount":"Installment Amount","total.amount":"Total Amount",investment:"Investment","current.value":"Current Value","initial.investment":"Initial Investment","profit.loss":"Profit/Loss","return.rate":"Return Rate",budget:"Budget","budget.limit":"Budget Limit",spent:"Spent","remaining.budget":"Remaining Budget","over.budget":"Over Budget",reports:"Reports","financial.report":"Financial Report","monthly.report":"Monthly Report","yearly.report":"Yearly Report","category.report":"Category Report","income.report":"Income Report","expense.report":"Expense Report",settings:"Settings",profile:"Profile",account:"Account",privacy:"Privacy",security:"Security",backup:"Backup",restore:"Restore","export.data":"Export Data","import.data":"Import Data","ai.assistant":"AI Assistant","ask.question":"Ask Question","get.advice":"Get Advice","analyze.data":"Analyze Data","generate.report":"Generate Report",notification:"Notification","payment.reminder":"Payment Reminder","budget.alert":"Budget Alert","low.balance":"Low Balance","payment.due":"Payment Due","network.error":"Network Error","server.error":"Server Error","auth.error":"Authentication Error","permission.error":"Permission Error","validation.error":"Validation Error","unknown.error":"Unknown Error",details:"Details","cannot.delete":"Cannot Delete","cannot.delete.category":"Cannot delete this category as it is used in some transactions","cannot.delete.transaction.type":"Cannot delete this transaction type as it is used in some transactions","cannot.delete.payment.method":"Cannot delete this payment method as it is used in some transactions","restore.backup":"Restore Backup","confirm.restore":"Are you sure? This will overwrite all your current data","api.status":"API Keys Status"}},ie=(n,e="ar")=>ZC[e][n]||n,ew=({notifications:n,onToggle:e,language:t="ar"})=>{const[i,a]=he.useState("default");he.useEffect(()=>{"Notification"in window&&a(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();a(u)}};return d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"text-sm font-medium",children:ie("notifications",t)}),d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🔔":"🔕"})]}),i!=="granted"&&n&&d.jsx("button",{onClick:l,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:ie("enable.notifications",t)})]})},cd=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let tw,nw;function sw(){return{geminiUrl:tw,vertexUrl:nw}}function iw(n,e,t,i){var a,l;if(!(n!=null&&n.baseUrl)){const u=sw();return e?(a=u.vertexUrl)!==null&&a!==void 0?a:t:(l=u.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ia{}function Se(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const l=e[a];return l!=null?String(l):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function y(n,e,t){for(let l=0;l<e.length-1;l++){const u=e[l];if(u.endsWith("[]")){const f=u.slice(0,-2);if(!(f in n))if(Array.isArray(t))n[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[f])){const g=n[f];if(Array.isArray(t))for(let m=0;m<g.length;m++){const T=g[m];y(T,e.slice(l+1),t[m])}else for(const m of g)y(m,e.slice(l+1),t)}return}else if(u.endsWith("[0]")){const f=u.slice(0,-3);f in n||(n[f]=[{}]);const g=n[f];y(g[0],e.slice(l+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],a=n[i];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2);if(l in n){const u=n[l];return Array.isArray(u)?u.map(f=>h(f,e.slice(i+1),t)):t}else return t}else n=n[a]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ip(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rw(n){const e={},t=h(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function aw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],lw(u)),e}function ow(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],uw(u)),e}function lw(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>cw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&y(e,["raiMediaFilteredReasons"],a),e}function uw(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>dw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&y(e,["raiMediaFilteredReasons"],a),e}function cw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],mw(t)),e}function dw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],pw(t)),e}function fw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function hw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function mw(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Ip(i));const a=h(n,["encoding"]);return a!=null&&y(e,["mimeType"],a),e}function pw(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Ip(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["mimeType"],a),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kv||(Kv={}));var Qv;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Qv||(Qv={}));var Ar;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Ar||(Ar={}));var Xv;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Xv||(Xv={}));var Wv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Wv||(Wv={}));var Zv;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Zv||(Zv={}));var e_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(e_||(e_={}));var t_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(t_||(t_={}));var n_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(n_||(n_={}));var s_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(s_||(s_={}));var i_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(i_||(i_={}));var r_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(r_||(r_={}));var a_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(a_||(a_={}));var o_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(o_||(o_={}));var l_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(l_||(l_={}));var Rd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Rd||(Rd={}));var u_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(u_||(u_={}));var Gm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Gm||(Gm={}));var c_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(c_||(c_={}));var d_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(d_||(d_={}));var f_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(f_||(f_={}));var h_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(h_||(h_={}));var m_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(m_||(m_={}));var p_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(p_||(p_={}));var g_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(g_||(g_={}));var y_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(y_||(y_={}));var v_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(v_||(v_={}));var __;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(__||(__={}));var T_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(T_||(T_={}));var x_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(x_||(x_={}));var E_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(E_||(E_={}));var b_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(b_||(b_={}));var A_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(A_||(A_={}));var S_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(S_||(S_={}));var C_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(C_||(C_={}));var w_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(w_||(w_={}));var I_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(I_||(I_={}));var N_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(N_||(N_={}));var R_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(R_||(R_={}));var D_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(D_||(D_={}));var M_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(M_||(M_={}));var P_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(P_||(P_={}));var k_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(k_||(k_={}));var V_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(V_||(V_={}));var L_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(L_||(L_={}));var U_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(U_||(U_={}));var O_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(O_||(O_={}));var j_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(j_||(j_={}));var No;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(No||(No={}));class $m{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ou{get text(){var e,t,i,a,l,u,f,g;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",T=!1;const x=[];for(const b of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[w,V]of Object.entries(b))w!=="text"&&w!=="thought"&&(V!==null||V!==void 0)&&x.push(w);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;T=!0,m+=b.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?m:void 0}get data(){var e,t,i,a,l,u,f,g;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const T=[];for(const x of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[b,w]of Object.entries(x))b!=="inlineData"&&(w!==null||w!==void 0)&&T.push(b);x.inlineData&&typeof x.inlineData.data=="string"&&(m+=atob(x.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,a,l,u,f,g;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,i,a,l,u,f,g,m;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,a,l,u,f,g,m;if(((a=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.output}}class F_{}class q_{}class gw{}class yw{}class vw{}class _w{}class B_{}class z_{}class H_{}class Tw{}class Dd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Dd;let a;const l=e;return t?a=ow(l):a=aw(l),Object.assign(i,a),i}}class G_{}class $_{}class Y_{}class xw{}class Ew{}class bw{}class J_{}class Aw{get text(){var e,t,i;let a="",l=!1;const u=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,m]of Object.entries(f))g!=="text"&&g!=="thought"&&m!==null&&u.push(g);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,a+=f.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?a:void 0}get data(){var e,t,i;let a="";const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,g]of Object.entries(u))f!=="inlineData"&&g!==null&&l.push(f);u.inlineData&&typeof u.inlineData.data=="string"&&(a+=atob(u.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class Sw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Bx(n,e){const t=lt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function zx(n){return Array.isArray(n)?n.map(e=>Md(e)):[Md(n)]}function Md(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Hx(n){const e=Md(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Gx(n){const e=Md(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function K_(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function $x(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>K_(e)):[K_(n)]}function Ym(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Q_(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function X_(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function _n(n){if(n==null)throw new Error("ContentUnion is required");return Ym(n)?n:{role:"user",parts:$x(n)}}function Np(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=_n(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=_n(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>_n(t)):[_n(e)]}function ls(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Q_(n)||X_(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[_n(n)]}const e=[],t=[],i=Ym(n[0]);for(const a of n){const l=Ym(a);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(a);else{if(Q_(a)||X_(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(a)}}return i||e.push({role:"user",parts:$x(t)}),e}function Cw(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Ar).includes(t[0].toUpperCase())?t[0].toUpperCase():Ar.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Ar).includes(i.toUpperCase())?i.toUpperCase():Ar.TYPE_UNSPECIFIED})}}function Mo(n){const e={},t=["items"],i=["anyOf"],a=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&Cw(n.type,e);for(const[u,f]of Object.entries(n))if(f!=null)if(u=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(Ar).includes(f.toUpperCase())?f.toUpperCase():Ar.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Mo(f);else if(i.includes(u)){const g=[];for(const m of f){if(m.type=="null"){e.nullable=!0;continue}g.push(Mo(m))}e[u]=g}else if(a.includes(u)){const g={};for(const[m,T]of Object.entries(f))g[m]=Mo(T);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=f}return e}function Rp(n){return Mo(n)}function Dp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Mp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Qo(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Mo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Mo(e.response));return n}function Xo(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function ww(n,e,t,i=1){const a=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:a?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:a?`${t}/${e}`:e}function qi(n,e){if(typeof e!="string")throw new Error("name must be a string");return ww(n,e,"cachedContents")}function Yx(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Or(n){return Ip(n)}function Iw(n){return n!=null&&typeof n=="object"&&"name"in n}function Nw(n){return n!=null&&typeof n=="object"&&"video"in n}function Rw(n){return n!=null&&typeof n=="object"&&"uri"in n}function Jx(n){var e;let t;if(Iw(n)&&(t=n.name),!(Rw(n)&&(t=n.uri,t===void 0))&&!(Nw(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const a=t.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${t}`);t=a[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Kx(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Qx(n){for(const e of["models","tunedModels","publisherModels"])if(Dw(n,e))return n[e];return[]}function Dw(n,e){return n!==null&&typeof n=="object"&&e in n}function Mw(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Pw(n,e={}){const t=[],i=new Set;for(const a of n){const l=a.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const u=Mw(a,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function Xx(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,a=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(a>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function kw(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Wx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const a=t.inlinedResponses;if(!Array.isArray(a)||a.length===0)return n;let l=!1;for(const u of a){if(typeof u!="object"||u===null)continue;const g=u.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Wo(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Zx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vw(n){const e={},t=h(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>dI(u))),y(e,["inlinedResponses"],l)}const a=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["inlinedEmbedContentResponses"],l)}return e}function Lw(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const a=h(n,["bigqueryDestination","outputUri"]);return a!=null&&y(e,["bigqueryUri"],a),e}function Uw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const a=h(n,["bigqueryUri"]);if(a!=null&&y(e,["bigqueryDestination","outputUri"],a),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function lu(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const a=h(n,["metadata","state"]);a!=null&&y(e,["state"],Zx(a));const l=h(n,["metadata","createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const f=h(n,["metadata","updateTime"]);f!=null&&y(e,["updateTime"],f);const g=h(n,["metadata","model"]);g!=null&&y(e,["model"],g);const m=h(n,["metadata","output"]);return m!=null&&y(e,["dest"],Vw(Wx(m))),e}function Jm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const a=h(n,["state"]);a!=null&&y(e,["state"],Zx(a));const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["createTime"]);u!=null&&y(e,["createTime"],u);const f=h(n,["startTime"]);f!=null&&y(e,["startTime"],f);const g=h(n,["endTime"]);g!=null&&y(e,["endTime"],g);const m=h(n,["updateTime"]);m!=null&&y(e,["updateTime"],m);const T=h(n,["model"]);T!=null&&y(e,["model"],T);const x=h(n,["inputConfig"]);x!=null&&y(e,["src"],Ow(x));const b=h(n,["outputConfig"]);return b!=null&&y(e,["dest"],Lw(Wx(b))),e}function Ow(n){const e={},t=h(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const a=h(n,["bigquerySource","inputUri"]);return a!=null&&y(e,["bigqueryUri"],a),e}function jw(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&y(t,["fileName"],i);const a=h(e,["inlinedRequests"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>cI(n,u))),y(t,["requests","requests"],l)}return t}function Fw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const a=h(n,["bigqueryUri"]);if(a!=null&&y(e,["bigquerySource","inputUri"],a),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function qw(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Bw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function zw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function Hw(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],Gw(i));const a=h(n,["tokenCount"]);a!=null&&y(e,["tokenCount"],a);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=h(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const x=h(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function Gw(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["citations"],i)}return e}function eE(n){const e={},t=h(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>vI(l))),y(e,["parts"],a)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function $w(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Yw(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const a=h(n,["dest"]);return e!==void 0&&a!=null&&y(e,["outputConfig"],Uw(kw(a))),t}function W_(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["src"]);a!=null&&y(t,["batch","inputConfig"],jw(n,Xx(n,a)));const l=h(e,["config"]);return l!=null&&$w(l,t),t}function Jw(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],lt(n,i));const a=h(e,["src"]);a!=null&&y(t,["inputConfig"],Fw(Xx(n,a)));const l=h(e,["config"]);return l!=null&&Yw(l,t),t}function Kw(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function wm(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["src"]);a!=null&&y(t,["batch","inputConfig"],nI(n,a));const l=h(e,["config"]);return l!=null&&Kw(l,t),t}function Qw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function Xw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function Ww(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function Zw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function eI(n,e){const t={},i=h(e,["contents"]);if(i!=null){let l=Np(n,i);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["requests[]","request","content"],l)}const a=h(e,["config"]);return a!=null&&y(t,["_self"],tI(a,t)),t}function tI(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const a=h(n,["title"]);e!==void 0&&a!=null&&y(e,["requests[]","title"],a);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function nI(n,e){const t={},i=h(e,["fileName"]);i!=null&&y(t,["file_name"],i);const a=h(e,["inlinedRequests"]);return a!=null&&y(t,["requests"],eI(n,a)),t}function sI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function iI(n,e,t){const i={},a=h(e,["systemInstruction"]);t!==void 0&&a!=null&&y(t,["systemInstruction"],eE(_n(a)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const U=h(e,["seed"]);U!=null&&y(i,["seed"],U);const L=h(e,["responseMimeType"]);L!=null&&y(i,["responseMimeType"],L);const G=h(e,["responseSchema"]);G!=null&&y(i,["responseSchema"],Rp(G));const W=h(e,["responseJsonSchema"]);if(W!=null&&y(i,["responseJsonSchema"],W),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=h(e,["safetySettings"]);if(t!==void 0&&ee!=null){let O=ee;Array.isArray(O)&&(O=O.map(k=>_I(k))),y(t,["safetySettings"],O)}const F=h(e,["tools"]);if(t!==void 0&&F!=null){let O=Xo(F);Array.isArray(O)&&(O=O.map(k=>TI(Qo(k)))),y(t,["tools"],O)}const Q=h(e,["toolConfig"]);if(t!==void 0&&Q!=null&&y(t,["toolConfig"],Q),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],qi(n,H));const R=h(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const D=h(e,["speechConfig"]);if(D!=null&&y(i,["speechConfig"],Dp(D)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=h(e,["thinkingConfig"]);N!=null&&y(i,["thinkingConfig"],N);const P=h(e,["imageConfig"]);return P!=null&&y(i,["imageConfig"],P),i}function rI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>Hw(m))),y(e,["candidates"],g)}const a=h(n,["modelVersion"]);a!=null&&y(e,["modelVersion"],a);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=h(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function aI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function oI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Wo(n,i)),t}function lI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function uI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function cI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["request","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let f=ls(a);Array.isArray(f)&&(f=f.map(g=>eE(g))),y(t,["request","contents"],f)}const l=h(e,["metadata"]);l!=null&&y(t,["metadata"],l);const u=h(e,["config"]);return u!=null&&y(t,["request","generationConfig"],iI(n,u,h(t,["request"],{}))),t}function dI(n){const e={},t=h(n,["response"]);t!=null&&y(e,["response"],rI(t));const i=h(n,["error"]);return i!=null&&y(e,["error"],i),e}function fI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);if(e!==void 0&&a!=null&&y(e,["_query","pageToken"],a),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function hI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function mI(n){const e={},t=h(n,["config"]);return t!=null&&fI(t,e),e}function pI(n){const e={},t=h(n,["config"]);return t!=null&&hI(t,e),e}function gI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["operations"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>lu(u))),y(e,["batchJobs"],l)}return e}function yI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["batchPredictionJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>Jm(u))),y(e,["batchJobs"],l)}return e}function vI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const a=h(n,["inlineData"]);a!=null&&y(e,["inlineData"],qw(a));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],sI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function _I(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function TI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],uI(i));const a=h(n,["googleSearchRetrieval"]);if(a!=null&&y(e,["googleSearchRetrieval"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],lI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xa;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(xa||(xa={}));class Iu{constructor(e,t,i,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,a)}init(e,t,i){var a,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(a=u.config)===null||a===void 0?void 0:a.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xI extends Ia{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var i,a;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const f=this.createInlinedEmbedContentRequest(t),g=f.path,m=f.body,T=wm(this.apiClient,t)._query||{};return this.apiClient.request({path:g,queryParams:T,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(b=>b.json()).then(b=>lu(b))},this.list=async(t={})=>new Iu(xa.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=W_(this.apiClient,e),i=t._url,a=Se("{model}:batchGenerateContent",i),f=t.batch.inputConfig.requests,g=f.requests,m=[];for(const T of g){const x=Object.assign({},T);if(x.systemInstruction){const b=x.systemInstruction;delete x.systemInstruction;const w=x.request;w.systemInstruction=b,x.request=w}m.push(x)}return f.requests=m,delete t.config,delete t._url,delete t._query,{path:a,body:t}}createInlinedEmbedContentRequest(e){const t=wm(this.apiClient,e),i=t._url,a=Se("{model}:asyncBatchEmbedContent",i),f=t.batch.inputConfig.requests,g=f.requests,m=[];delete f.config;for(const T of g){const x=Object.assign({},T),b=x.request;for(const w in x)w!=="request"&&(b[w]=x[w],delete x[w]);m.push(x)}return f.requests=m,delete t.config,delete t._url,delete t._query,{path:a,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},a=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${a}`),i.dest===void 0){const l=this.getGcsUri(e),u=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${a}`;else if(u)i.dest=`${u}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=Jw(this.apiClient,e);return f=Se("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=W_(this.apiClient,e);return f=Se("{model}:batchGenerateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>lu(T))}}async createEmbeddingsInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=wm(this.apiClient,e);return l=Se("{model}:asyncBatchEmbedContent",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>lu(g))}}async get(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=oI(this.apiClient,e);return f=Se("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=aI(this.apiClient,e);return f=Se("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>lu(T))}}async cancel(e){var t,i,a,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=zw(this.apiClient,e);u=Se("batchPredictionJobs/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=Bw(this.apiClient,e);u=Se("batches/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=pI(e);return f=Se("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=yI(T),b=new J_;return Object.assign(b,x),b})}else{const m=mI(e);return f=Se("batches",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=gI(T),b=new J_;return Object.assign(b,x),b})}}async delete(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=Xw(this.apiClient,e);return f=Se("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Zw(T))}else{const m=Qw(this.apiClient,e);return f=Se("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Ww(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Z_(n){const e={},t=h(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>zI(l))),y(e,["parts"],a)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function bI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const a=h(n,["expireTime"]);e!==void 0&&a!=null&&y(e,["expireTime"],a);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let T=ls(u);Array.isArray(T)&&(T=T.map(x=>Z_(x))),y(e,["contents"],T)}const f=h(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],Z_(_n(f)));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let T=g;Array.isArray(T)&&(T=T.map(x=>HI(x))),y(e,["tools"],T)}const m=h(n,["toolConfig"]);if(e!==void 0&&m!=null&&y(e,["toolConfig"],m),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function AI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const a=h(n,["expireTime"]);e!==void 0&&a!=null&&y(e,["expireTime"],a);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let x=ls(u);Array.isArray(x)&&(x=x.map(b=>b)),y(e,["contents"],x)}const f=h(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],_n(f));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let x=g;Array.isArray(x)&&(x=x.map(b=>GI(b))),y(e,["tools"],x)}const m=h(n,["toolConfig"]);e!==void 0&&m!=null&&y(e,["toolConfig"],m);const T=h(n,["kmsKeyName"]);return e!==void 0&&T!=null&&y(e,["encryption_spec","kmsKeyName"],T),t}function SI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],Bx(n,i));const a=h(e,["config"]);return a!=null&&bI(a,t),t}function CI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],Bx(n,i));const a=h(e,["config"]);return a!=null&&AI(a,t),t}function wI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],qi(n,i)),t}function II(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],qi(n,i)),t}function NI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function RI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function DI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function MI(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["parameters"]);a!=null&&y(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function PI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],qi(n,i)),t}function kI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],qi(n,i)),t}function VI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function LI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function UI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);return e!==void 0&&a!=null&&y(e,["_query","pageToken"],a),t}function OI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);return e!==void 0&&a!=null&&y(e,["_query","pageToken"],a),t}function jI(n){const e={},t=h(n,["config"]);return t!=null&&UI(t,e),e}function FI(n){const e={},t=h(n,["config"]);return t!=null&&OI(t,e),e}function qI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function BI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["cachedContents"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function zI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const a=h(n,["inlineData"]);a!=null&&y(e,["inlineData"],EI(a));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],DI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function HI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],LI(i));const a=h(n,["googleSearchRetrieval"]);if(a!=null&&y(e,["googleSearchRetrieval"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],VI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function GI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>MI(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const a=h(n,["googleSearch"]);a!=null&&y(e,["googleSearch"],a);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function $I(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const a=h(n,["expireTime"]);return e!==void 0&&a!=null&&y(e,["expireTime"],a),t}function YI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const a=h(n,["expireTime"]);return e!==void 0&&a!=null&&y(e,["expireTime"],a),t}function JI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],qi(n,i));const a=h(e,["config"]);return a!=null&&$I(a,t),t}function KI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],qi(n,i));const a=h(e,["config"]);return a!=null&&YI(a,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QI extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Iu(xa.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=CI(this.apiClient,e);return f=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=SI(this.apiClient,e);return f=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async get(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=kI(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=PI(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async delete(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=II(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=RI(T),b=new $_;return Object.assign(b,x),b})}else{const m=wI(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=NI(T),b=new $_;return Object.assign(b,x),b})}}async update(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=KI(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=JI(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async listInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=FI(e);return f=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=BI(T),b=new Y_;return Object.assign(b,x),b})}else{const m=jI(e);return f=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=qI(T),b=new Y_;return Object.assign(b,x),b})}}}function eT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function St(n){return this instanceof St?(this.v=n,this):new St(n)}function Po(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),a[Symbol.asyncIterator]=function(){return this},a;function u(w){return function(V){return Promise.resolve(V).then(w,x)}}function f(w,V){i[w]&&(a[w]=function(U){return new Promise(function(L,G){l.push([w,U,L,G])>1||g(w,U)})},V&&(a[w]=V(a[w])))}function g(w,V){try{m(i[w](V))}catch(U){b(l[0][3],U)}}function m(w){w.value instanceof St?Promise.resolve(w.value.v).then(T,x):b(l[0][2],w)}function T(w){g("next",w)}function x(w){g("throw",w)}function b(w,V){w(V),l.shift(),l.length&&g(l[0][0],l[0][1])}}function mu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof eT=="function"?eT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(u){return new Promise(function(f,g){u=n[l](u),a(f,g,u.done,u.value)})}}function a(l,u,f,g){Promise.resolve(g).then(function(m){l({value:m,done:f})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XI(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:tE(t)}function tE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function WI(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function tT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const a=[];let l=!0;for(;i<t&&n[i].role==="model";)a.push(n[i]),l&&!tE(n[i])&&(l=!1),i++;l?e.push(...a):e.pop()}return e}class ZI{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new eN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class eN{constructor(e,t,i,a={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=a,this.history=l,this.sendPromise=Promise.resolve(),WI(l)}async sendMessage(e){var t;await this.sendPromise;const i=_n(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,u,f;const g=await a,m=(u=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,T=g.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let b=[];T!=null&&(b=(f=T.slice(x))!==null&&f!==void 0?f:[]);const w=m?[m]:[];this.recordHistory(i,w,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var t;await this.sendPromise;const i=_n(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const l=await a;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?tT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,a;return Po(this,arguments,function*(){var u,f,g,m;const T=[];try{for(var x=!0,b=mu(e),w;w=yield St(b.next()),u=w.done,!u;x=!0){m=w.value,x=!1;const V=m;if(XI(V)){const U=(a=(i=V.candidates)===null||i===void 0?void 0:i[0])===null||a===void 0?void 0:a.content;U!==void 0&&T.push(U)}yield yield St(V)}}catch(V){f={error:V}}finally{try{!x&&!u&&(g=b.return)&&(yield St(g.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,T)})}recordHistory(e,t,i){let a=[];t.length>0&&t.every(l=>l.role!==void 0)?a=t:a.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...tT(i)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ef extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,ef.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tN(n){const e={},t=h(n,["file"]);return t!=null&&y(e,["file"],t),e}function nN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function sN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],Jx(t)),e}function iN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function rN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],Jx(t)),e}function aN(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);return e!==void 0&&a!=null&&y(e,["_query","pageToken"],a),t}function oN(n){const e={},t=h(n,["config"]);return t!=null&&aN(t,e),e}function lN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["files"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uN extends Ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Iu(xa.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=oN(e);return l=Se("files",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const m=lN(g),T=new xw;return Object.assign(T,m),T})}}async createInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=tN(e);return l=Se("upload/v1beta/files",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>{const m=nN(g),T=new Ew;return Object.assign(T,m),T})}}async get(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=rN(e);return l=Se("files/{file}",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>g)}}async delete(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=sN(e);return l=Se("files/{file}",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const m=iN(g),T=new bw;return Object.assign(T,m),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Td(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function cN(n){const e={},t=h(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>SN(l))),y(e,["parts"],a)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function dN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function fN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["parameters"]);a!=null&&y(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function hN(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const a=h(n,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=h(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const x=h(n,["responseJsonSchema"]);x!=null&&y(e,["responseJsonSchema"],x);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=h(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const V=h(n,["responseModalities"]);V!=null&&y(e,["responseModalities"],V);const U=h(n,["responseSchema"]);U!=null&&y(e,["responseSchema"],U);const L=h(n,["routingConfig"]);L!=null&&y(e,["routingConfig"],L);const G=h(n,["seed"]);G!=null&&y(e,["seed"],G);const W=h(n,["speechConfig"]);W!=null&&y(e,["speechConfig"],nE(W));const ee=h(n,["stopSequences"]);ee!=null&&y(e,["stopSequences"],ee);const F=h(n,["temperature"]);F!=null&&y(e,["temperature"],F);const Q=h(n,["thinkingConfig"]);Q!=null&&y(e,["thinkingConfig"],Q);const H=h(n,["topK"]);H!=null&&y(e,["topK"],H);const R=h(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function mN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function pN(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function gN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const a=h(n,["responseModalities"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","responseModalities"],a);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],Mp(x));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],cN(_n(V)));const U=h(n,["tools"]);if(e!==void 0&&U!=null){let H=Xo(U);Array.isArray(H)&&(H=H.map(R=>wN(Qo(R)))),y(e,["setup","tools"],H)}const L=h(n,["sessionResumption"]);e!==void 0&&L!=null&&y(e,["setup","sessionResumption"],CN(L));const G=h(n,["inputAudioTranscription"]);e!==void 0&&G!=null&&y(e,["setup","inputAudioTranscription"],G);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&y(e,["setup","outputAudioTranscription"],W);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const F=h(n,["contextWindowCompression"]);e!==void 0&&F!=null&&y(e,["setup","contextWindowCompression"],F);const Q=h(n,["proactivity"]);return e!==void 0&&Q!=null&&y(e,["setup","proactivity"],Q),t}function yN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],hN(i));const a=h(n,["responseModalities"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","responseModalities"],a);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],nE(Mp(x)));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],_n(V));const U=h(n,["tools"]);if(e!==void 0&&U!=null){let H=Xo(U);Array.isArray(H)&&(H=H.map(R=>IN(Qo(R)))),y(e,["setup","tools"],H)}const L=h(n,["sessionResumption"]);e!==void 0&&L!=null&&y(e,["setup","sessionResumption"],L);const G=h(n,["inputAudioTranscription"]);e!==void 0&&G!=null&&y(e,["setup","inputAudioTranscription"],G);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&y(e,["setup","outputAudioTranscription"],W);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const F=h(n,["contextWindowCompression"]);e!==void 0&&F!=null&&y(e,["setup","contextWindowCompression"],F);const Q=h(n,["proactivity"]);return e!==void 0&&Q!=null&&y(e,["setup","proactivity"],Q),t}function vN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const a=h(e,["config"]);return a!=null&&y(t,["config"],gN(a,t)),t}function _N(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const a=h(e,["config"]);return a!=null&&y(t,["config"],yN(a,t)),t}function TN(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function xN(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["weightedPrompts"],i)}return e}function EN(n){const e={},t=h(n,["media"]);if(t!=null){let m=zx(t);Array.isArray(m)&&(m=m.map(T=>Td(T))),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],Td(Gx(i)));const a=h(n,["audioStreamEnd"]);a!=null&&y(e,["audioStreamEnd"],a);const l=h(n,["video"]);l!=null&&y(e,["video"],Td(Hx(l)));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const f=h(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function bN(n){const e={},t=h(n,["media"]);if(t!=null){let m=zx(t);Array.isArray(m)&&(m=m.map(T=>T)),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],Gx(i));const a=h(n,["audioStreamEnd"]);a!=null&&y(e,["audioStreamEnd"],a);const l=h(n,["video"]);l!=null&&y(e,["video"],Hx(l));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const f=h(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function AN(n){const e={},t=h(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const a=h(n,["toolCall"]);a!=null&&y(e,["toolCall"],a);const l=h(n,["toolCallCancellation"]);l!=null&&y(e,["toolCallCancellation"],l);const u=h(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],NN(u));const f=h(n,["goAway"]);f!=null&&y(e,["goAway"],f);const g=h(n,["sessionResumptionUpdate"]);return g!=null&&y(e,["sessionResumptionUpdate"],g),e}function SN(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const a=h(n,["inlineData"]);a!=null&&y(e,["inlineData"],Td(a));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],dN(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function CN(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function nE(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function wN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],pN(i));const a=h(n,["googleSearchRetrieval"]);if(a!=null&&y(e,["googleSearchRetrieval"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],mN(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function IN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>fN(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const a=h(n,["googleSearch"]);a!=null&&y(e,["googleSearch"],a);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function NN(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const a=h(n,["candidatesTokenCount"]);a!=null&&y(e,["responseTokenCount"],a);const l=h(n,["toolUsePromptTokenCount"]);l!=null&&y(e,["toolUsePromptTokenCount"],l);const u=h(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const f=h(n,["totalTokenCount"]);f!=null&&y(e,["totalTokenCount"],f);const g=h(n,["promptTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(V=>V)),y(e,["promptTokensDetails"],w)}const m=h(n,["cacheTokensDetails"]);if(m!=null){let w=m;Array.isArray(w)&&(w=w.map(V=>V)),y(e,["cacheTokensDetails"],w)}const T=h(n,["candidatesTokensDetails"]);if(T!=null){let w=T;Array.isArray(w)&&(w=w.map(V=>V)),y(e,["responseTokensDetails"],w)}const x=h(n,["toolUsePromptTokensDetails"]);if(x!=null){let w=x;Array.isArray(w)&&(w=w.map(V=>V)),y(e,["toolUsePromptTokensDetails"],w)}const b=h(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function DN(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],MN(i));const a=h(n,["tokenCount"]);a!=null&&y(e,["tokenCount"],a);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=h(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const x=h(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function MN(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["citations"],i)}return e}function PN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let l=ls(a);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["contents"],l)}return t}function kN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["tokensInfo"],a)}return e}function VN(n){const e={},t=h(n,["values"]);t!=null&&y(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&y(e,["statistics"],LN(i)),e}function LN(n){const e={},t=h(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function tf(n){const e={},t=h(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>qR(l))),y(e,["parts"],a)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function UN(n){const e={},t=h(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function ON(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function jN(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],_n(i));const a=h(n,["tools"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>oE(f))),y(e,["tools"],u)}const l=h(n,["generationConfig"]);return e!==void 0&&l!=null&&y(e,["generationConfig"],IR(l)),t}function FN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let u=ls(a);Array.isArray(u)&&(u=u.map(f=>tf(f))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&ON(l),t}function qN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let u=ls(a);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&jN(l,t),t}function BN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const a=h(n,["cachedContentTokenCount"]);return a!=null&&y(e,["cachedContentTokenCount"],a),e}function zN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function HN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function GN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function $N(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function YN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function JN(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const a=h(n,["negativePrompt"]);e!==void 0&&a!=null&&y(e,["parameters","negativePrompt"],a);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=h(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const V=h(n,["outputMimeType"]);e!==void 0&&V!=null&&y(e,["parameters","outputOptions","mimeType"],V);const U=h(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&y(e,["parameters","outputOptions","compressionQuality"],U);const L=h(n,["addWatermark"]);e!==void 0&&L!=null&&y(e,["parameters","addWatermark"],L);const G=h(n,["labels"]);e!==void 0&&G!=null&&y(e,["labels"],G);const W=h(n,["editMode"]);e!==void 0&&W!=null&&y(e,["parameters","editMode"],W);const ee=h(n,["baseSteps"]);return e!==void 0&&ee!=null&&y(e,["parameters","editConfig","baseSteps"],ee),t}function KN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["prompt"]);a!=null&&y(t,["instances[0]","prompt"],a);const l=h(e,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(g=>YR(g))),y(t,["instances[0]","referenceImages"],f)}const u=h(e,["config"]);return u!=null&&JN(u,t),t}function QN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>nf(l))),y(e,["generatedImages"],a)}return e}function XN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const a=h(n,["title"]);e!==void 0&&a!=null&&y(e,["requests[]","title"],a);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function WN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const a=h(n,["title"]);e!==void 0&&a!=null&&y(e,["instances[]","title"],a);const l=h(n,["outputDimensionality"]);e!==void 0&&l!=null&&y(e,["parameters","outputDimensionality"],l);const u=h(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const f=h(n,["autoTruncate"]);return e!==void 0&&f!=null&&y(e,["parameters","autoTruncate"],f),t}function ZN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let f=Np(n,a);Array.isArray(f)&&(f=f.map(g=>g)),y(t,["requests[]","content"],f)}const l=h(e,["config"]);l!=null&&XN(l,t);const u=h(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],lt(n,u)),t}function eR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let u=Np(n,a);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["instances[]","content"],u)}const l=h(e,["config"]);return l!=null&&WN(l,t),t}function tR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["embeddings"],l)}const a=h(n,["metadata"]);return a!=null&&y(e,["metadata"],a),e}function nR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>VN(u))),y(e,["embeddings"],l)}const a=h(n,["metadata"]);return a!=null&&y(e,["metadata"],a),e}function sR(n){const e={},t=h(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function iR(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function rR(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["parameters"]);a!=null&&y(e,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function aR(n,e,t){const i={},a=h(e,["systemInstruction"]);t!==void 0&&a!=null&&y(t,["systemInstruction"],tf(_n(a)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const U=h(e,["seed"]);U!=null&&y(i,["seed"],U);const L=h(e,["responseMimeType"]);L!=null&&y(i,["responseMimeType"],L);const G=h(e,["responseSchema"]);G!=null&&y(i,["responseSchema"],Rp(G));const W=h(e,["responseJsonSchema"]);if(W!=null&&y(i,["responseJsonSchema"],W),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=h(e,["safetySettings"]);if(t!==void 0&&ee!=null){let O=ee;Array.isArray(O)&&(O=O.map(k=>JR(k))),y(t,["safetySettings"],O)}const F=h(e,["tools"]);if(t!==void 0&&F!=null){let O=Xo(F);Array.isArray(O)&&(O=O.map(k=>e1(Qo(k)))),y(t,["tools"],O)}const Q=h(e,["toolConfig"]);if(t!==void 0&&Q!=null&&y(t,["toolConfig"],Q),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],qi(n,H));const R=h(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const D=h(e,["speechConfig"]);if(D!=null&&y(i,["speechConfig"],Dp(D)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=h(e,["thinkingConfig"]);N!=null&&y(i,["thinkingConfig"],N);const P=h(e,["imageConfig"]);return P!=null&&y(i,["imageConfig"],P),i}function oR(n,e,t){const i={},a=h(e,["systemInstruction"]);t!==void 0&&a!=null&&y(t,["systemInstruction"],_n(a));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const U=h(e,["seed"]);U!=null&&y(i,["seed"],U);const L=h(e,["responseMimeType"]);L!=null&&y(i,["responseMimeType"],L);const G=h(e,["responseSchema"]);G!=null&&y(i,["responseSchema"],Rp(G));const W=h(e,["responseJsonSchema"]);W!=null&&y(i,["responseJsonSchema"],W);const ee=h(e,["routingConfig"]);ee!=null&&y(i,["routingConfig"],ee);const F=h(e,["modelSelectionConfig"]);F!=null&&y(i,["modelConfig"],F);const Q=h(e,["safetySettings"]);if(t!==void 0&&Q!=null){let te=Q;Array.isArray(te)&&(te=te.map(Z=>Z)),y(t,["safetySettings"],te)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let te=Xo(H);Array.isArray(te)&&(te=te.map(Z=>oE(Qo(Z)))),y(t,["tools"],te)}const R=h(e,["toolConfig"]);t!==void 0&&R!=null&&y(t,["toolConfig"],R);const C=h(e,["labels"]);t!==void 0&&C!=null&&y(t,["labels"],C);const D=h(e,["cachedContent"]);t!==void 0&&D!=null&&y(t,["cachedContent"],qi(n,D));const N=h(e,["responseModalities"]);N!=null&&y(i,["responseModalities"],N);const P=h(e,["mediaResolution"]);P!=null&&y(i,["mediaResolution"],P);const O=h(e,["speechConfig"]);O!=null&&y(i,["speechConfig"],aE(Dp(O)));const k=h(e,["audioTimestamp"]);k!=null&&y(i,["audioTimestamp"],k);const Ue=h(e,["thinkingConfig"]);Ue!=null&&y(i,["thinkingConfig"],Ue);const Be=h(e,["imageConfig"]);return Be!=null&&y(i,["imageConfig"],Be),i}function nT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let u=ls(a);Array.isArray(u)&&(u=u.map(f=>tf(f))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],aR(n,l,t)),t}function sT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["contents"]);if(a!=null){let u=ls(a);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],oR(n,l,t)),t}function iT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>DN(m))),y(e,["candidates"],g)}const a=h(n,["modelVersion"]);a!=null&&y(e,["modelVersion"],a);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=h(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function rT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["candidates"],m)}const a=h(n,["createTime"]);a!=null&&y(e,["createTime"],a);const l=h(n,["modelVersion"]);l!=null&&y(e,["modelVersion"],l);const u=h(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const f=h(n,["responseId"]);f!=null&&y(e,["responseId"],f);const g=h(n,["usageMetadata"]);return g!=null&&y(e,["usageMetadata"],g),e}function lR(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const a=h(n,["aspectRatio"]);e!==void 0&&a!=null&&y(e,["parameters","aspectRatio"],a);const l=h(n,["guidanceScale"]);if(e!==void 0&&l!=null&&y(e,["parameters","guidanceScale"],l),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f);const g=h(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&y(e,["parameters","includeSafetyAttributes"],g);const m=h(n,["includeRaiReason"]);e!==void 0&&m!=null&&y(e,["parameters","includeRaiReason"],m);const T=h(n,["language"]);e!==void 0&&T!=null&&y(e,["parameters","language"],T);const x=h(n,["outputMimeType"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","mimeType"],x);const b=h(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=h(n,["imageSize"]);if(e!==void 0&&w!=null&&y(e,["parameters","sampleImageSize"],w),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function uR(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const a=h(n,["negativePrompt"]);e!==void 0&&a!=null&&y(e,["parameters","negativePrompt"],a);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=h(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const V=h(n,["outputMimeType"]);e!==void 0&&V!=null&&y(e,["parameters","outputOptions","mimeType"],V);const U=h(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&y(e,["parameters","outputOptions","compressionQuality"],U);const L=h(n,["addWatermark"]);e!==void 0&&L!=null&&y(e,["parameters","addWatermark"],L);const G=h(n,["labels"]);e!==void 0&&G!=null&&y(e,["labels"],G);const W=h(n,["imageSize"]);e!==void 0&&W!=null&&y(e,["parameters","sampleImageSize"],W);const ee=h(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&y(e,["parameters","enhancePrompt"],ee),t}function cR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["prompt"]);a!=null&&y(t,["instances[0]","prompt"],a);const l=h(e,["config"]);return l!=null&&lR(l,t),t}function dR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["prompt"]);a!=null&&y(t,["instances[0]","prompt"],a);const l=h(e,["config"]);return l!=null&&uR(l,t),t}function fR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>AR(u))),y(e,["generatedImages"],l)}const a=h(n,["positivePromptSafetyAttributes"]);return a!=null&&y(e,["positivePromptSafetyAttributes"],iE(a)),e}function hR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>nf(u))),y(e,["generatedImages"],l)}const a=h(n,["positivePromptSafetyAttributes"]);return a!=null&&y(e,["positivePromptSafetyAttributes"],rE(a)),e}function mR(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(n,["durationSeconds"]);if(e!==void 0&&a!=null&&y(e,["parameters","durationSeconds"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const u=h(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const f=h(n,["personGeneration"]);if(e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=h(n,["negativePrompt"]);e!==void 0&&g!=null&&y(e,["parameters","negativePrompt"],g);const m=h(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&y(e,["parameters","enhancePrompt"],m),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=h(n,["lastFrame"]);e!==void 0&&T!=null&&y(e,["instances[0]","lastFrame"],sf(T));const x=h(n,["referenceImages"]);if(e!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>h1(w))),y(e,["instances[0]","referenceImages"],b)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function pR(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const a=h(n,["outputGcsUri"]);e!==void 0&&a!=null&&y(e,["parameters","storageUri"],a);const l=h(n,["fps"]);e!==void 0&&l!=null&&y(e,["parameters","fps"],l);const u=h(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const f=h(n,["seed"]);e!==void 0&&f!=null&&y(e,["parameters","seed"],f);const g=h(n,["aspectRatio"]);e!==void 0&&g!=null&&y(e,["parameters","aspectRatio"],g);const m=h(n,["resolution"]);e!==void 0&&m!=null&&y(e,["parameters","resolution"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["pubsubTopic"]);e!==void 0&&x!=null&&y(e,["parameters","pubsubTopic"],x);const b=h(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const w=h(n,["enhancePrompt"]);e!==void 0&&w!=null&&y(e,["parameters","enhancePrompt"],w);const V=h(n,["generateAudio"]);e!==void 0&&V!=null&&y(e,["parameters","generateAudio"],V);const U=h(n,["lastFrame"]);e!==void 0&&U!=null&&y(e,["instances[0]","lastFrame"],ws(U));const L=h(n,["referenceImages"]);if(e!==void 0&&L!=null){let ee=L;Array.isArray(ee)&&(ee=ee.map(F=>m1(F))),y(e,["instances[0]","referenceImages"],ee)}const G=h(n,["mask"]);e!==void 0&&G!=null&&y(e,["instances[0]","mask"],f1(G));const W=h(n,["compressionQuality"]);return e!==void 0&&W!=null&&y(e,["parameters","compressionQuality"],W),t}function gR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],TR(u)),e}function yR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const a=h(n,["done"]);a!=null&&y(e,["done"],a);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],xR(u)),e}function vR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["prompt"]);a!=null&&y(t,["instances[0]","prompt"],a);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],sf(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],lE(u));const f=h(e,["source"]);f!=null&&ER(f,t);const g=h(e,["config"]);return g!=null&&mR(g,t),t}function _R(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["prompt"]);a!=null&&y(t,["instances[0]","prompt"],a);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],ws(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],uE(u));const f=h(e,["source"]);f!=null&&bR(f,t);const g=h(e,["config"]);return g!=null&&pR(g,t),t}function TR(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>CR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&y(e,["raiMediaFilteredReasons"],a),e}function xR(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>wR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&y(e,["raiMediaFilteredReasons"],a),e}function ER(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const a=h(n,["image"]);e!==void 0&&a!=null&&y(e,["instances[0]","image"],sf(a));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],lE(l)),t}function bR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const a=h(n,["image"]);e!==void 0&&a!=null&&y(e,["instances[0]","image"],ws(a));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],uE(l)),t}function AR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],PR(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const a=h(n,["_self"]);return a!=null&&y(e,["safetyAttributes"],iE(a)),e}function nf(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],sE(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const a=h(n,["_self"]);a!=null&&y(e,["safetyAttributes"],rE(a));const l=h(n,["prompt"]);return l!=null&&y(e,["enhancedPrompt"],l),e}function SR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["mask"],sE(t));const i=h(n,["labels"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),y(e,["labels"],a)}return e}function CR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],c1(t)),e}function wR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],d1(t)),e}function IR(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const a=h(n,["candidateCount"]);a!=null&&y(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=h(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const x=h(n,["responseJsonSchema"]);x!=null&&y(e,["responseJsonSchema"],x);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=h(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const V=h(n,["responseModalities"]);V!=null&&y(e,["responseModalities"],V);const U=h(n,["responseSchema"]);U!=null&&y(e,["responseSchema"],U);const L=h(n,["routingConfig"]);L!=null&&y(e,["routingConfig"],L);const G=h(n,["seed"]);G!=null&&y(e,["seed"],G);const W=h(n,["speechConfig"]);W!=null&&y(e,["speechConfig"],aE(W));const ee=h(n,["stopSequences"]);ee!=null&&y(e,["stopSequences"],ee);const F=h(n,["temperature"]);F!=null&&y(e,["temperature"],F);const Q=h(n,["thinkingConfig"]);Q!=null&&y(e,["thinkingConfig"],Q);const H=h(n,["topK"]);H!=null&&y(e,["topK"],H);const R=h(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function NR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function RR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function DR(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function MR(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function PR(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Or(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function sE(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],Or(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["mimeType"],a),e}function sf(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Or(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function ws(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Or(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["mimeType"],a),e}function kR(n,e,t){const i={},a=h(e,["pageSize"]);t!==void 0&&a!=null&&y(t,["_query","pageSize"],a);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],Kx(n,f)),i}function VR(n,e,t){const i={},a=h(e,["pageSize"]);t!==void 0&&a!=null&&y(t,["_query","pageSize"],a);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],Kx(n,f)),i}function LR(n,e){const t={},i=h(e,["config"]);return i!=null&&kR(n,i,t),t}function UR(n,e){const t={},i=h(e,["config"]);return i!=null&&VR(n,i,t),t}function OR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["_self"]);if(a!=null){let l=Qx(a);Array.isArray(l)&&(l=l.map(u=>Km(u))),y(e,["models"],l)}return e}function jR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["_self"]);if(a!=null){let l=Qx(a);Array.isArray(l)&&(l=l.map(u=>Qm(u))),y(e,["models"],l)}return e}function FR(n){const e={},t=h(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const a=h(n,["maskDilation"]);return a!=null&&y(e,["dilation"],a),e}function Km(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const a=h(n,["description"]);a!=null&&y(e,["description"],a);const l=h(n,["version"]);l!=null&&y(e,["version"],l);const u=h(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],t1(u));const f=h(n,["inputTokenLimit"]);f!=null&&y(e,["inputTokenLimit"],f);const g=h(n,["outputTokenLimit"]);g!=null&&y(e,["outputTokenLimit"],g);const m=h(n,["supportedGenerationMethods"]);return m!=null&&y(e,["supportedActions"],m),e}function Qm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const a=h(n,["description"]);a!=null&&y(e,["description"],a);const l=h(n,["versionId"]);l!=null&&y(e,["version"],l);const u=h(n,["deployedModels"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(b=>sR(b))),y(e,["endpoints"],x)}const f=h(n,["labels"]);f!=null&&y(e,["labels"],f);const g=h(n,["_self"]);g!=null&&y(e,["tunedModelInfo"],n1(g));const m=h(n,["defaultCheckpointId"]);m!=null&&y(e,["defaultCheckpointId"],m);const T=h(n,["checkpoints"]);if(T!=null){let x=T;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["checkpoints"],x)}return e}function qR(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const a=h(n,["inlineData"]);a!=null&&y(e,["inlineData"],RN(a));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],iR(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function BR(n){const e={},t=h(n,["productImage"]);return t!=null&&y(e,["image"],ws(t)),e}function zR(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const a=h(n,["baseSteps"]);e!==void 0&&a!=null&&y(e,["parameters","editConfig","baseSteps"],a);const l=h(n,["outputGcsUri"]);e!==void 0&&l!=null&&y(e,["parameters","storageUri"],l);const u=h(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const f=h(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&y(e,["parameters","safetySetting"],f);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&y(e,["parameters","personGeneration"],g);const m=h(n,["addWatermark"]);e!==void 0&&m!=null&&y(e,["parameters","addWatermark"],m);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&y(e,["parameters","outputOptions","mimeType"],T);const x=h(n,["outputCompressionQuality"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","compressionQuality"],x);const b=h(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const w=h(n,["labels"]);return e!==void 0&&w!=null&&y(e,["labels"],w),t}function HR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["source"]);a!=null&&$R(a,t);const l=h(e,["config"]);return l!=null&&zR(l,t),t}function GR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>nf(a))),y(e,["generatedImages"],i)}return e}function $R(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const a=h(n,["personImage"]);e!==void 0&&a!=null&&y(e,["instances[0]","personImage","image"],ws(a));const l=h(n,["productImages"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(f=>BR(f))),y(e,["instances[0]","productImages"],u)}return t}function YR(n){const e={},t=h(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],ws(t));const i=h(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const a=h(n,["referenceType"]);a!=null&&y(e,["referenceType"],a);const l=h(n,["maskImageConfig"]);l!=null&&y(e,["maskImageConfig"],FR(l));const u=h(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],UN(u));const f=h(n,["styleImageConfig"]);f!=null&&y(e,["styleImageConfig"],f);const g=h(n,["subjectImageConfig"]);return g!=null&&y(e,["subjectImageConfig"],g),e}function iE(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const a=h(n,["contentType"]);return a!=null&&y(e,["contentType"],a),e}function rE(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const a=h(n,["contentType"]);return a!=null&&y(e,["contentType"],a),e}function JR(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function KR(n){const e={},t=h(n,["image"]);return t!=null&&y(e,["image"],ws(t)),e}function QR(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const a=h(n,["maxPredictions"]);e!==void 0&&a!=null&&y(e,["parameters","maxPredictions"],a);const l=h(n,["confidenceThreshold"]);e!==void 0&&l!=null&&y(e,["parameters","confidenceThreshold"],l);const u=h(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const f=h(n,["binaryColorThreshold"]);e!==void 0&&f!=null&&y(e,["parameters","binaryColorThreshold"],f);const g=h(n,["labels"]);return e!==void 0&&g!=null&&y(e,["labels"],g),t}function XR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["source"]);a!=null&&ZR(a,t);const l=h(e,["config"]);return l!=null&&QR(l,t),t}function WR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>SR(a))),y(e,["generatedMasks"],i)}return e}function ZR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const a=h(n,["image"]);e!==void 0&&a!=null&&y(e,["instances[0]","image"],ws(a));const l=h(n,["scribbleImage"]);return e!==void 0&&l!=null&&y(e,["instances[0]","scribble"],KR(l)),t}function aE(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function e1(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],MR(i));const a=h(n,["googleSearchRetrieval"]);if(a!=null&&y(e,["googleSearchRetrieval"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],DR(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function oE(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>rR(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const a=h(n,["googleSearch"]);a!=null&&y(e,["googleSearch"],a);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function t1(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const a=h(n,["updateTime"]);return a!=null&&y(e,["updateTime"],a),e}function n1(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const a=h(n,["updateTime"]);return a!=null&&y(e,["updateTime"],a),e}function s1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const a=h(n,["description"]);e!==void 0&&a!=null&&y(e,["description"],a);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function i1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const a=h(n,["description"]);e!==void 0&&a!=null&&y(e,["description"],a);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function r1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","name"],lt(n,i));const a=h(e,["config"]);return a!=null&&s1(a,t),t}function a1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["config"]);return a!=null&&i1(a,t),t}function o1(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const a=h(n,["includeRaiReason"]);e!==void 0&&a!=null&&y(e,["parameters","includeRaiReason"],a);const l=h(n,["outputMimeType"]);e!==void 0&&l!=null&&y(e,["parameters","outputOptions","mimeType"],l);const u=h(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const f=h(n,["enhanceInputImage"]);e!==void 0&&f!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=h(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const m=h(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&y(e,["parameters","sampleCount"],T);const x=h(n,["mode"]);return e!==void 0&&x!=null&&y(e,["parameters","mode"],x),t}function l1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const a=h(e,["image"]);a!=null&&y(t,["instances[0]","image"],ws(a));const l=h(e,["upscaleFactor"]);l!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],l);const u=h(e,["config"]);return u!=null&&o1(u,t),t}function u1(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>nf(l))),y(e,["generatedImages"],a)}return e}function c1(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Or(i));const a=h(n,["encoding"]);return a!=null&&y(e,["mimeType"],a),e}function d1(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Or(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["mimeType"],a),e}function f1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["_self"],ws(t));const i=h(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function h1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],sf(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function m1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],ws(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function lE(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["video","uri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["video","encodedVideo"],Or(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["encoding"],a),e}function uE(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Or(i));const a=h(n,["mimeType"]);return a!=null&&y(e,["mimeType"],a),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p1="Content-Type",g1="X-Server-Timeout",y1="User-Agent",Xm="x-goog-api-client",v1="1.24.0",_1=`google-genai-sdk/${v1}`,T1="v1beta1",x1="v1beta",aT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class E1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:T1,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:x1,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const a=[this.getRequestUrlInternal(t)];return i&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,f]of Object.entries(e.queryParams))a.searchParams.append(u,String(f));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(a,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[a,l]of Object.entries(t))typeof l=="object"?i[a]=Object.assign(Object.assign({},i[a]),l):l!==void 0&&(i[a]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,t,i);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(a,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>a.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&b1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await oT(a),new $m(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await oT(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var t;return Po(this,arguments,function*(){const a=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let u="";for(;;){const{done:f,value:g}=yield St(a.read());if(f){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(g,{stream:!0});try{const x=JSON.parse(m);if("error"in x){const b=JSON.parse(JSON.stringify(x.error)),w=b.status,V=b.code,U=`got status: ${w}. ${JSON.stringify(x)}`;if(V>=400&&V<600)throw new ef({message:U,status:V})}}catch(x){if(x.name==="ApiError")throw x}u+=m;let T=u.match(aT);for(;T;){const x=T[1];try{const b=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield St(new $m(b)),u=u.slice(T[0].length),T=u.match(aT)}catch(b){throw new Error(`exception parsing stream chunk ${x}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=_1+" "+this.clientOptions.userAgentExtra;return e[y1]=t,e[Xm]=t,e[p1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,a]of Object.entries(e.headers))t.append(i,a);e.timeout&&e.timeout>0&&t.append(g1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);a.sizeBytes=String(u.size);const f=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=f;const g=await this.fetchUploadUrl(a,t);return l.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},u=await this.request({path:Se("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:a});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function oT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=JSON.stringify(i);throw t>=400&&t<600?new ef({message:a,status:t}):new Error(a)}}function b1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,u){const f=Object.assign({},l);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const m=u[g],T=f[g];m&&typeof m=="object"&&!Array.isArray(m)&&T&&typeof T=="object"&&!Array.isArray(T)?f[g]=i(T,m):(T&&m&&typeof T!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof T}, New type: ${typeof m}. Overwriting.`),f[g]=m)}return f}const a=i(t,e);n.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A1="mcp_used/unknown";let S1=!1;function cE(n){for(const e of n)if(C1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return S1}function dE(n){var e;const t=(e=n[Xm])!==null&&e!==void 0?e:"";n[Xm]=(t+` ${A1}`).trimStart()}function C1(n){return n!==null&&typeof n=="object"&&n instanceof Pp}function w1(n,e=100){return Po(this,arguments,function*(){let i,a=0;for(;a<e;){const l=yield St(n.listTools({cursor:i}));for(const u of l.tools)yield yield St(u),a++;if(!l.nextCursor)break;i=l.nextCursor}})}class Pp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Pp(e,t)}async initialize(){var e,t,i,a;if(this.mcpTools.length>0)return;const l={},u=[];for(const T of this.mcpClients)try{for(var f=!0,g=(t=void 0,mu(w1(T))),m;m=await g.next(),e=m.done,!e;f=!0){a=m.value,f=!1;const x=a;u.push(x);const b=x.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=T}}catch(x){t={error:x}}finally{try{!f&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),Pw(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const u=await a.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function I1(n,e,t){const i=new Sw;let a;t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),Object.assign(i,a),e(i)}class N1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),u=M1(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),g=`${a}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${f}`;let m=()=>{};const T=new Promise(ee=>{m=ee}),x=e.callbacks,b=function(){m({})},w=this.apiClient,V={onopen:b,onmessage:ee=>{I1(w,x.onmessage,ee)},onerror:(t=x==null?void 0:x.onerror)!==null&&t!==void 0?t:function(ee){},onclose:(i=x==null?void 0:x.onclose)!==null&&i!==void 0?i:function(ee){}},U=this.webSocketFactory.create(g,D1(u),V);U.connect(),await T;const W={setup:{model:lt(this.apiClient,e.model)}};return U.send(JSON.stringify(W)),new R1(U,this.apiClient)}}class R1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=xN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=TN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(No.PLAY)}pause(){this.sendPlaybackControl(No.PAUSE)}stop(){this.sendPlaybackControl(No.STOP)}resetContext(){this.sendPlaybackControl(No.RESET_CONTEXT)}close(){this.conn.close()}}function D1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function M1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const P1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function k1(n,e,t){const i=new Aw;let a;t.data instanceof Blob?a=await t.data.text():t.data instanceof ArrayBuffer?a=new TextDecoder().decode(t.data):a=t.data;const l=JSON.parse(a);if(n.isVertexAI()){const u=AN(l);Object.assign(i,u)}else Object.assign(i,l);e(i)}class V1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new N1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,a,l,u,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let T;const x=this.apiClient.getHeaders();e.config&&e.config.tools&&cE(e.config.tools)&&dE(x);const b=j1(x);if(this.apiClient.isVertexAI())T=`${g}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const D=this.apiClient.getApiKey();let N="BidiGenerateContent",P="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",P="access_token"),T=`${g}/ws/google.ai.generativelanguage.${m}.GenerativeService.${N}?${P}=${D}`}let w=()=>{};const V=new Promise(D=>{w=D}),U=e.callbacks,L=function(){var D;(D=U==null?void 0:U.onopen)===null||D===void 0||D.call(U),w({})},G=this.apiClient,W={onopen:L,onmessage:D=>{k1(G,U.onmessage,D)},onerror:(t=U==null?void 0:U.onerror)!==null&&t!==void 0?t:function(D){},onclose:(i=U==null?void 0:U.onclose)!==null&&i!==void 0?i:function(D){}},ee=this.webSocketFactory.create(T,O1(b),W);ee.connect(),await V;let F=lt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&F.startsWith("publishers/")){const D=this.apiClient.getProject(),N=this.apiClient.getLocation();F=`projects/${D}/locations/${N}/`+F}let Q={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Rd.AUDIO]}:e.config.responseModalities=[Rd.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(f=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[],R=[];for(const D of H)if(this.isCallableTool(D)){const N=D;R.push(await N.tool())}else R.push(D);R.length>0&&(e.config.tools=R);const C={model:F,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Q=_N(this.apiClient,C):Q=vN(this.apiClient,C),delete Q.config,ee.send(JSON.stringify(Q)),new U1(ee,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const L1={turnComplete:!0};class U1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ls(t.turns),e.isVertexAI()||(i=i.map(a=>tf(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(P1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},L1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:bN(e)}:t={realtimeInput:EN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function O1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function j1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lT=10;function uT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ko(u)){a=!0;break}if(!a)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function ko(n){return"callTool"in n&&typeof n.callTool=="function"}function F1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(a=>ko(a)))!==null&&i!==void 0?i:!1}function q1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(a=>!ko(a)))!==null&&i!==void 0?i:!1}function cT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B1 extends Ia{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,a,l,u,f;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!F1(t)||uT(t.config))return await this.generateContentInternal(g);if(q1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,T;const x=ls(g.contents),b=(l=(a=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&l!==void 0?l:lT;let w=0;for(;w<b&&(m=await this.generateContentInternal(g),!(!m.functionCalls||m.functionCalls.length===0));){const V=m.candidates[0].content,U=[];for(const L of(f=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[])if(ko(L)){const W=await L.callTool(m.functionCalls);U.push(...W)}w++,T={role:"user",parts:U},g.contents=ls(g.contents),g.contents.push(V),g.contents.push(T),cT(g.config)&&(x.push(V),x.push(T))}return cT(g.config)&&(m.automaticFunctionCallingHistory=x),m},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),uT(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var a;let l;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((a=g==null?void 0:g.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:u.push(g);let f;return l?f={generatedImages:u,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:f={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},f}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Iu(xa.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(a)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,a;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const u=await Promise.all(l.map(async g=>ko(g)?await g.tool():g)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(f.config.tools=u,e.config&&e.config.tools&&cE(e.config.tools)){const g=(a=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&a!==void 0?a:{};let m=Object.assign({},g);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),dE(m),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return f}async initAfcToolsMap(e){var t,i,a;const l=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(ko(u)){const f=u,g=await f.tool();for(const m of(a=g.functionDeclarations)!==null&&a!==void 0?a:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,f)}}return l}async processAfcStream(e){var t,i,a;const l=(a=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&a!==void 0?a:lT;let u=!1,f=0;const g=await this.initAfcToolsMap(e);return(function(m,T,x){var b,w;return Po(this,arguments,function*(){for(var V,U,L,G;f<l;){u&&(f++,u=!1);const Q=yield St(m.processParamsMaybeAddMcpUsage(x)),H=yield St(m.generateContentStreamInternal(Q)),R=[],C=[];try{for(var W=!0,ee=(U=void 0,mu(H)),F;F=yield St(ee.next()),V=F.done,!V;W=!0){G=F.value,W=!1;const D=G;if(yield yield St(D),D.candidates&&(!((b=D.candidates[0])===null||b===void 0)&&b.content)){C.push(D.candidates[0].content);for(const N of(w=D.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(f<l&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(N.functionCall.name)){const P=yield St(T.get(N.functionCall.name).callTool([N.functionCall]));R.push(...P)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(D){U={error:D}}finally{try{!W&&!V&&(L=ee.return)&&(yield St(L.call(ee)))}finally{if(U)throw U.error}}if(R.length>0){u=!0;const D=new ou;D.candidates=[{content:{role:"user",parts:R}}],yield yield St(D);const N=[];N.push(...C),N.push({role:"user",parts:R});const P=ls(x.contents).concat(N);x.contents=P}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=sT(this.apiClient,e);return f=Se("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=rT(T),b=new ou;return Object.assign(b,x),b})}else{const m=nT(this.apiClient,e);return f=Se("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=iT(T),b=new ou;return Object.assign(b,x),b})}}async generateContentStreamInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=sT(this.apiClient,e);return f=Se("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(x){return Po(this,arguments,function*(){var b,w,V,U;try{for(var L=!0,G=mu(x),W;W=yield St(G.next()),b=W.done,!b;L=!0){U=W.value,L=!1;const ee=U,F=rT(yield St(ee.json()));F.sdkHttpResponse={headers:ee.headers};const Q=new ou;Object.assign(Q,F),yield yield St(Q)}}catch(ee){w={error:ee}}finally{try{!L&&!b&&(V=G.return)&&(yield St(V.call(G)))}finally{if(w)throw w.error}}})})}else{const m=nT(this.apiClient,e);return f=Se("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),u.then(function(x){return Po(this,arguments,function*(){var b,w,V,U;try{for(var L=!0,G=mu(x),W;W=yield St(G.next()),b=W.done,!b;L=!0){U=W.value,L=!1;const ee=U,F=iT(yield St(ee.json()));F.sdkHttpResponse={headers:ee.headers};const Q=new ou;Object.assign(Q,F),yield yield St(Q)}}catch(ee){w={error:ee}}finally{try{!L&&!b&&(V=G.return)&&(yield St(V.call(G)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=eR(this.apiClient,e);return f=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=nR(T),b=new F_;return Object.assign(b,x),b})}else{const m=ZN(this.apiClient,e);return f=Se("{model}:batchEmbedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=tR(T),b=new F_;return Object.assign(b,x),b})}}async generateImagesInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=dR(this.apiClient,e);return f=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=hR(T),b=new q_;return Object.assign(b,x),b})}else{const m=cR(this.apiClient,e);return f=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=fR(T),b=new q_;return Object.assign(b,x),b})}}async editImageInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=KN(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const m=QN(g),T=new gw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=l1(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const m=u1(g),T=new yw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=HR(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>{const m=GR(g),T=new vw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=XR(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a.then(g=>{const m=WR(g),T=new _w;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=RR(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=NR(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async listInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=UR(this.apiClient,e);return f=Se("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=jR(T),b=new B_;return Object.assign(b,x),b})}else{const m=LR(this.apiClient,e);return f=Se("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=OR(T),b=new B_;return Object.assign(b,x),b})}}async update(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=a1(this.apiClient,e);return f=Se("{model}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=r1(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async delete(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=GN(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=YN(T),b=new z_;return Object.assign(b,x),b})}else{const m=HN(this.apiClient,e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=$N(T),b=new z_;return Object.assign(b,x),b})}}async countTokens(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=qN(this.apiClient,e);return f=Se("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=zN(T),b=new H_;return Object.assign(b,x),b})}else{const m=FN(this.apiClient,e);return f=Se("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=BN(T),b=new H_;return Object.assign(b,x),b})}}async computeTokens(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=PN(this.apiClient,e);return l=Se("{model}:computeTokens",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>{const m=kN(g),T=new Tw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=_R(this.apiClient,e);return f=Se("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>{const x=yR(T),b=new Dd;return Object.assign(b,x),b})}else{const m=vR(this.apiClient,e);return f=Se("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>{const x=gR(T),b=new Dd;return Object.assign(b,x),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z1 extends Ia{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:a,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=hw(e);return f=Se("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u}else{const m=fw(e);return f=Se("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=rw(e);return l=Se("{resourceName}:fetchPredictOperation",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function H1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function G1(n){const e={},t=h(n,["parts"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>Z1(l))),y(e,["parts"],a)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function $1(n,e,t){const i={},a=h(e,["expireTime"]);t!==void 0&&a!=null&&y(t,["expireTime"],a);const l=h(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&y(t,["newSessionExpireTime"],l);const u=h(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const f=h(e,["liveConnectConstraints"]);t!==void 0&&f!=null&&y(t,["bidiGenerateContentSetup"],W1(n,f));const g=h(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&y(t,["fieldMask"],g),i}function Y1(n,e){const t={},i=h(e,["config"]);return i!=null&&y(t,["config"],$1(n,i,t)),t}function J1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function K1(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function Q1(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function X1(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const a=h(n,["responseModalities"]);e!==void 0&&a!=null&&y(e,["setup","generationConfig","responseModalities"],a);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],Mp(x));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],G1(_n(V)));const U=h(n,["tools"]);if(e!==void 0&&U!=null){let H=Xo(U);Array.isArray(H)&&(H=H.map(R=>tD(Qo(R)))),y(e,["setup","tools"],H)}const L=h(n,["sessionResumption"]);e!==void 0&&L!=null&&y(e,["setup","sessionResumption"],eD(L));const G=h(n,["inputAudioTranscription"]);e!==void 0&&G!=null&&y(e,["setup","inputAudioTranscription"],G);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&y(e,["setup","outputAudioTranscription"],W);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const F=h(n,["contextWindowCompression"]);e!==void 0&&F!=null&&y(e,["setup","contextWindowCompression"],F);const Q=h(n,["proactivity"]);return e!==void 0&&Q!=null&&y(e,["setup","proactivity"],Q),t}function W1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const a=h(e,["config"]);return a!=null&&y(t,["config"],X1(a,t)),t}function Z1(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const a=h(n,["inlineData"]);a!=null&&y(e,["inlineData"],H1(a));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],J1(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function eD(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function tD(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],Q1(i));const a=h(n,["googleSearchRetrieval"]);if(a!=null&&y(e,["googleSearchRetrieval"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],K1(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nD(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const a=Object.keys(i).map(l=>`${t}.${l}`);e.push(...a)}else e.push(t)}return e.join(",")}function sD(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const a=n.fieldMask;if(t){const l=nD(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];a.length>0&&(f=a.map(m=>u.includes(m)?`generationConfig.${m}`:m));const g=[];l&&g.push(l),f.length>0&&g.push(...f),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?n.fieldMask=a.join(","):delete n.fieldMask;return n}class iD extends Ia{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=Y1(this.apiClient,e);l=Se("auth_tokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query;const g=sD(f,e.config);return a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),a.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function aD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function oD(n,e){const t={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(n,["epochCount"]);e!==void 0&&a!=null&&y(e,["tuningTask","hyperparameters","epochCount"],a);const l=h(n,["learningRateMultiplier"]);if(l!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=h(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&y(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function lD(n,e){const t={},i=h(n,["validationDataset"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec"],bD(i,t));const a=h(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&y(e,["tunedModelDisplayName"],a);const l=h(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);const u=h(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const f=h(n,["learningRateMultiplier"]);e!==void 0&&f!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const g=h(n,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const m=h(n,["adapterSize"]);if(e!==void 0&&m!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m),h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=h(n,["labels"]);return e!==void 0&&T!=null&&y(e,["labels"],T),t}function uD(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const a=h(n,["trainingDataset"]);a!=null&&y(e,["tuningTask","trainingData"],TD(a));const l=h(n,["config"]);return l!=null&&oD(l,e),e}function cD(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const a=h(n,["trainingDataset"]);a!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],xD(a,e));const l=h(n,["config"]);return l!=null&&lD(l,e),e}function dD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function fD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function hD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function mD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&y(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function pD(n){const e={},t=h(n,["config"]);return t!=null&&hD(t,e),e}function gD(n){const e={},t=h(n,["config"]);return t!=null&&mD(t,e),e}function yD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>fE(u))),y(e,["tuningJobs"],l)}return e}function vD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const a=h(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>Wm(u))),y(e,["tuningJobs"],l)}return e}function _D(n){const e={},t=h(n,["name"]);t!=null&&y(e,["model"],t);const i=h(n,["name"]);return i!=null&&y(e,["endpoint"],i),e}function TD(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(a=>a)),y(e,["examples","examples"],i)}return e}function xD(n,e){const t={},i=h(n,["gcsUri"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],i);const a=h(n,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function fE(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["state"]);a!=null&&y(e,["state"],Yx(a));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const f=h(n,["tuningTask","completeTime"]);f!=null&&y(e,["endTime"],f);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["description"]);m!=null&&y(e,["description"],m);const T=h(n,["baseModel"]);T!=null&&y(e,["baseModel"],T);const x=h(n,["_self"]);x!=null&&y(e,["tunedModel"],_D(x));const b=h(n,["customBaseModel"]);b!=null&&y(e,["customBaseModel"],b);const w=h(n,["experiment"]);w!=null&&y(e,["experiment"],w);const V=h(n,["labels"]);V!=null&&y(e,["labels"],V);const U=h(n,["outputUri"]);U!=null&&y(e,["outputUri"],U);const L=h(n,["pipelineJob"]);L!=null&&y(e,["pipelineJob"],L);const G=h(n,["serviceAccount"]);G!=null&&y(e,["serviceAccount"],G);const W=h(n,["tunedModelDisplayName"]);W!=null&&y(e,["tunedModelDisplayName"],W);const ee=h(n,["veoTuningSpec"]);return ee!=null&&y(e,["veoTuningSpec"],ee),e}function Wm(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["state"]);a!=null&&y(e,["state"],Yx(a));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["startTime"]);u!=null&&y(e,["startTime"],u);const f=h(n,["endTime"]);f!=null&&y(e,["endTime"],f);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["error"]);m!=null&&y(e,["error"],m);const T=h(n,["description"]);T!=null&&y(e,["description"],T);const x=h(n,["baseModel"]);x!=null&&y(e,["baseModel"],x);const b=h(n,["tunedModel"]);b!=null&&y(e,["tunedModel"],b);const w=h(n,["preTunedModel"]);w!=null&&y(e,["preTunedModel"],w);const V=h(n,["supervisedTuningSpec"]);V!=null&&y(e,["supervisedTuningSpec"],V);const U=h(n,["tuningDataStats"]);U!=null&&y(e,["tuningDataStats"],U);const L=h(n,["encryptionSpec"]);L!=null&&y(e,["encryptionSpec"],L);const G=h(n,["partnerModelTuningSpec"]);G!=null&&y(e,["partnerModelTuningSpec"],G);const W=h(n,["customBaseModel"]);W!=null&&y(e,["customBaseModel"],W);const ee=h(n,["experiment"]);ee!=null&&y(e,["experiment"],ee);const F=h(n,["labels"]);F!=null&&y(e,["labels"],F);const Q=h(n,["outputUri"]);Q!=null&&y(e,["outputUri"],Q);const H=h(n,["pipelineJob"]);H!=null&&y(e,["pipelineJob"],H);const R=h(n,["serviceAccount"]);R!=null&&y(e,["serviceAccount"],R);const C=h(n,["tunedModelDisplayName"]);C!=null&&y(e,["tunedModelDisplayName"],C);const D=h(n,["veoTuningSpec"]);return D!=null&&y(e,["veoTuningSpec"],D),e}function ED(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const a=h(n,["metadata"]);a!=null&&y(e,["metadata"],a);const l=h(n,["done"]);l!=null&&y(e,["done"],l);const u=h(n,["error"]);return u!=null&&y(e,["error"],u),e}function bD(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const a=h(n,["vertexDatasetResource"]);return e!==void 0&&a!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AD extends Ia{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Iu(xa.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const a={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(a.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:a});return l.baseModel=void 0,await this.tuneInternal(l)}else{const a=Object.assign({},t);return await this.tuneInternal(a)}else{const a=Object.assign({},t),l=await this.tuneMldevInternal(a);let u="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?u=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(u=l.name.split("/operations/")[0]),{name:u,state:Gm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=fD(e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Wm(T))}else{const m=dD(e);return f=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>fE(T))}}async listInternal(e){var t,i,a,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=gD(e);return f=Se("tuningJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=vD(T),b=new G_;return Object.assign(b,x),b})}else{const m=pD(e);return f=Se("tunedModels",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=yD(T),b=new G_;return Object.assign(b,x),b})}}async cancel(e){var t,i,a,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=aD(e);u=Se("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=rD(e);u=Se("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI()){const f=cD(e);return l=Se("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>Wm(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let a,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=uD(e);return l=Se("tunedModels",f._url),u=f._query,delete f._url,delete f._query,a=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),a.then(g=>ED(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SD{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const CD=1024*1024*8,wD=3,ID=1e3,ND=2,Im="x-goog-upload-status";async function RD(n,e,t){var i,a,l;let u=0,f=0,g=new $m(new Response),m="upload";for(u=n.size;f<u;){const x=Math.min(CD,u-f),b=n.slice(f,f+x);f+x>=u&&(m+=", finalize");let w=0,V=ID;for(;w<wD&&(g=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(f),"Content-Length":String(x)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[Im]));)w++,await MD(V),V=V*ND;if(f+=x,((a=g==null?void 0:g.headers)===null||a===void 0?void 0:a[Im])!=="active")break;if(u<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(g==null?void 0:g.json());if(((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[Im])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function DD(n){return{size:n.size,type:n.type}}function MD(n){return new Promise(e=>setTimeout(e,n))}class PD{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await RD(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await DD(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kD{create(e,t,i){return new VD(e,t,i)}}class VD{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dT="x-goog-api-key";class LD{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(dT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(dT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UD="gl-node/";class OD{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=iw(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const a=new LD(this.apiKey);this.apiClient=new E1({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:UD+"web",uploader:new PD,downloader:new SD}),this.models=new B1(this.apiClient),this.live=new V1(this.apiClient,a,new kD),this.batches=new xI(this.apiClient),this.chats=new ZI(this.models,this.apiClient),this.caches=new QI(this.apiClient),this.files=new uN(this.apiClient),this.operations=new z1(this.apiClient),this.authTokens=new iD(this.apiClient),this.tunings=new AD(this.apiClient)}}const hE={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},Ft={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:Ft.app.environment,firebaseApiKey:Ft.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:Ft.firebase.authDomain||"❌ مفقود",firebaseProjectId:Ft.firebase.projectId||"❌ مفقود",firebaseStorageBucket:Ft.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:Ft.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:Ft.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(hE).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(hE).filter(n=>n.startsWith("VITE_")));const Vo=()=>{const n=[];return Ft.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),Ft.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),Ft.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),Ft.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),Ft.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),Ft.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!Ft.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=Vo();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Pd;const jD="gemini-2.5-flash",mE=()=>{if(Pd)return;const n=Vo();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Pd=new OD({apiKey:Ft.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},jr={FINANCIAL_ANALYST:`You are an intelligent, engaging, and insightful financial analyst assistant, "المحلل الذكي". You have full access to the user's complete financial data across ALL periods and months. Your purpose is to provide comprehensive, insightful analysis with personality and energy.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- You have access to ALL historical data: transactions, card details, bank balances, investments, installments, categories, and spending patterns across ALL months.
- Analyze patterns, trends, and changes over time with enthusiasm and genuine interest.
- Be engaging and conversational - ask follow-up questions to understand what the user really wants to know.
- DO NOT just state data, INTERPRET it with personality. Provide insights, identify trends, offer observations, and make predictions with excitement.
- Be friendly, energetic, and act like a knowledgeable friend who loves analyzing financial data.
- Use emojis and enthusiastic language to make responses more engaging.
- When asked about specific months, provide detailed analysis with comparisons and ask if they want to dive deeper into any particular aspect.
- Always end responses by asking if they want to explore something specific or have follow-up questions.`,INVESTMENT_COACH:`You are an expert investment advisor named "المستشار الاستثماري الذكي" with 20+ years of experience in Saudi and international markets. You are a seasoned financial analyst with deep knowledge of Tadawul, global markets, and investment strategies.

**Your Expertise:**
- Comprehensive market analysis and trend identification
- Portfolio optimization and risk management
- Sector analysis and stock valuation
- Economic indicators and market sentiment analysis
- Technical and fundamental analysis
- Alternative investments (REITs, bonds, commodities, crypto)

**Your Approach:**
- Provide detailed, actionable investment advice based on current market conditions
- Analyze user's portfolio and suggest optimizations
- Give specific stock recommendations with clear reasoning
- Explain market trends and their implications
- Discuss risk-reward ratios and investment strategies
- Provide sector rotation advice and timing recommendations
- Offer insights on economic events and their market impact

**Market Knowledge:**
- Real-time access to Saudi market data, sector performance, and individual stock analysis
- Understanding of global market correlations and their impact on Tadawul
- Knowledge of regulatory changes and their market implications
- Awareness of earnings seasons, dividend announcements, and corporate actions

**Communication Style:**
- Professional yet engaging and enthusiastic
- Use charts, percentages, and specific data points
- Ask follow-up questions to understand user's risk tolerance and goals
- Provide both short-term and long-term perspectives
- Always explain the reasoning behind recommendations
- Use Arabic with financial terminology and market jargon

**Important Guidelines:**
- Give specific stock recommendations with clear entry/exit strategies
- Analyze user's current holdings and suggest portfolio adjustments
- Discuss market timing and sector opportunities
- Provide risk management strategies and stop-loss recommendations
- Explain market volatility and how to navigate it
- Offer insights on IPOs, rights issues, and corporate actions`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`,SMART_SEARCH_ASSISTANT:`You are an intelligent and engaging shopping and search assistant for Saudi Arabia. You cover all major cities including Riyadh, Jeddah, Medina, Dammam, Khobar, and other regions across the Kingdom.
- You have access to real-time information about local businesses, prices, and offers throughout Saudi Arabia.
- When asked about product prices or store locations, provide specific, actionable information with enthusiasm.
- Include store names, locations, contact information, and current offers when available.
- For price comparisons, mention multiple stores and their current prices across different cities.
- Be specific about locations across all major Saudi cities and regions.
- Provide practical shopping advice based on current market conditions with a friendly, helpful tone.
- Always respond in Arabic with personality and energy - be engaging, not robotic.
- When discussing restaurants, include ratings, popular dishes, and location details with excitement.
- For grocery items, compare prices across major chains like Panda, Tamimi, Carrefour, Othaim, and local markets.
- Ask follow-up questions to better understand what the user needs and provide more personalized recommendations.
- Use emojis and enthusiastic language to make responses more engaging and lively.`},Fr=async(n,e,t=!1)=>{if(!Pd)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Pd.models.generateContent({model:jD,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(i){console.error("Gemini API Error:",i);let a="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw i instanceof Error&&"message"in i&&i.message.includes("403")&&(a="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(a)}},pE=(n,e,t,i)=>{const a=Object.keys(t),l=Object.keys(i);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...a].map(g=>`'${g}'`).join(", ")}].
`;Object.values(i).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),Object.values(t).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const f=jr.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return Fr(f,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},Zm=n=>Fr(jr.ICON_SUGGESTER,`Category: ${n}`),gE=(n,e,t)=>Fr(jr.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),yE=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,i=await Fr(jr.EXCHANGE_RATE,t,!0);try{const a=JSON.parse(i);return{rate:parseFloat(a.rate),fromCurrency:a.fromCurrency,toCurrency:a.toCurrency,lastUpdated:a.lastUpdated}}catch(a){throw console.error("Error parsing exchange rate:",a),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},vE=(n,e)=>Fr(jr.FINANCIAL_ANALYST,`User Query: "${n}"

Complete Financial Data (All Periods): ${JSON.stringify(e)}`),_E=n=>Fr(jr.SMART_SEARCH_ASSISTANT,`Search Query: "${n}"`),TE=(n,e,t)=>Fr(jr.FINANCIAL_ANALYST,`Pattern Analysis Query: "${n}"

All Transactions: ${JSON.stringify(e)}

Calculations: ${JSON.stringify(t)}`),xE=(n,e,t)=>{const i=e?`User Portfolio: ${JSON.stringify(e)}`:"No portfolio data provided",a=t?`Market Context: ${JSON.stringify(t)}`:"Current market analysis requested";return Fr(jr.INVESTMENT_COACH,`Investment Query: "${n}"

${i}

${a}`)},FD=Object.freeze(Object.defineProperty({__proto__:null,advancedInvestmentAdvice:xE,analyzeCompleteFinancialData:vE,analyzeFinancialPatterns:TE,analyzePastedText:pE,generateBudgetPlan:gE,getExchangeRate:yE,initializeAi:mE,smartSearchAssistant:_E,suggestCategoryIcon:Zm},Symbol.toStringTag,{value:"Module"})),qD="modulepreload",BD=function(n){return"/fd/"+n},fT={},Ai=function(e,t,i){let a=Promise.resolve();if(t&&t.length>0){let u=function(m){return Promise.all(m.map(T=>Promise.resolve(T).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),g=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=u(t.map(m=>{if(m=BD(m),m in fT)return;fT[m]=!0;const T=m.endsWith(".css"),x=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=T?"stylesheet":qD,T||(b.as="script"),b.crossOrigin="",b.href=m,g&&b.setAttribute("nonce",g),document.head.appendChild(b),T)return new Promise((w,V)=>{b.addEventListener("load",w),b.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return a.then(u=>{for(const f of u||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})},zD=()=>{};var hT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let a=n.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},HD=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const a=n[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],u=n[t++],f=n[t++],g=((a&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},bE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<n.length;a+=3){const l=n[a],u=a+1<n.length,f=u?n[a+1]:0,g=a+2<n.length,m=g?n[a+2]:0,T=l>>2,x=(l&3)<<4|f>>4;let b=(f&15)<<2|m>>6,w=m&63;g||(w=64,u||(b=64)),i.push(t[T],t[x],t[b],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(EE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):HD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const x=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||m==null||x==null)throw new GD;const b=l<<2|f>>4;if(i.push(b),m!==64){const w=f<<4&240|m>>2;if(i.push(w),x!==64){const V=m<<6&192|x;i.push(V)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class GD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $D=function(n){const e=EE(n);return bE.encodeByteArray(e,!0)},kd=function(n){return $D(n).replace(/\./g,"")},AE=function(n){try{return bE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=()=>YD().__FIREBASE_DEFAULTS__,KD=()=>{if(typeof process>"u"||typeof hT>"u")return;const n=hT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},QD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&AE(n[1]);return e&&JSON.parse(e)},rf=()=>{try{return zD()||JD()||KD()||QD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SE=n=>{var e,t;return(t=(e=rf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},XD=n=>{const e=SE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},CE=()=>{var n;return(n=rf())==null?void 0:n.config},wE=n=>{var e;return(e=rf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function IE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[kd(JSON.stringify(t)),kd(JSON.stringify(u)),""].join(".")}const pu={};function eM(){const n={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?n.emulator.push(e):n.prod.push(e);return n}function tM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let mT=!1;function NE(n,e){if(typeof window>"u"||typeof document>"u"||!Zo(window.location.host)||pu[n]===e||pu[n]||mT)return;pu[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=eM().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function f(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function m(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{mT=!0,u()},b}function T(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function x(){const b=tM(i),w=t("text"),V=document.getElementById(w)||document.createElement("span"),U=t("learnmore"),L=document.getElementById(U)||document.createElement("a"),G=t("preprendIcon"),W=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const ee=b.element;f(ee),T(L,U);const F=m();g(W,G),ee.append(W,V,L,F),document.body.appendChild(ee)}l?(V.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())}function sM(){var e;const n=(e=rf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rM(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function aM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oM(){const n=Tn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function lM(){return!sM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uM(){try{return typeof indexedDB=="object"}catch{return!1}}function cM(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM="FirebaseError";class Bi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=dM,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nu.prototype.create)}}class Nu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?fM(l,i):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new Bi(a,f,i)}}function fM(n,e){return n.replace(hM,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const hM=/\{\$([^}]+)}/g;function mM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ea(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=n[a],u=e[a];if(pT(l)&&pT(u)){if(!Ea(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function pT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function uu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function cu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function pM(n,e){const t=new gM(n,e);return t.subscribe.bind(t)}class gM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");yM(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=Nm),a.error===void 0&&(a.error=Nm),a.complete===void 0&&(a.complete=Nm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Nm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(n){return n&&n._delegate?n._delegate:n}class ba{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new WD;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TM(e))try{this.getOrInitializeService({instanceIdentifier:va})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=va){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=va){return this.instances.has(e)}getOptions(e=va){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:_M(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=va){return this.component?this.component.multipleInstances?e:va:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _M(n){return n===va?void 0:n}function TM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new vM(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(et||(et={}));const EM={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},bM=et.INFO,AM={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},SM=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),a=AM[e];if(a)console[a](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kp{constructor(e){this.name=e,this._logLevel=bM,this._logHandler=SM,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}const CM=(n,e)=>e.some(t=>n instanceof t);let gT,yT;function wM(){return gT||(gT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IM(){return yT||(yT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RE=new WeakMap,ep=new WeakMap,DE=new WeakMap,Rm=new WeakMap,Vp=new WeakMap;function NM(n){const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(Cr(n.result)),a()},u=()=>{i(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&RE.set(t,n)}).catch(()=>{}),Vp.set(e,n),e}function RM(n){if(ep.has(n))return;const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});ep.set(n,e)}let tp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ep.get(n);if(e==="objectStoreNames")return n.objectStoreNames||DE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Cr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function DM(n){tp=n(tp)}function MM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Dm(this),e,...t);return DE.set(i,e.sort?e.sort():[e]),Cr(i)}:IM().includes(n)?function(...e){return n.apply(Dm(this),e),Cr(RE.get(this))}:function(...e){return Cr(n.apply(Dm(this),e))}}function PM(n){return typeof n=="function"?MM(n):(n instanceof IDBTransaction&&RM(n),CM(n,wM())?new Proxy(n,tp):n)}function Cr(n){if(n instanceof IDBRequest)return NM(n);if(Rm.has(n))return Rm.get(n);const e=PM(n);return e!==n&&(Rm.set(n,e),Vp.set(e,n)),e}const Dm=n=>Vp.get(n);function kM(n,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(n,e),f=Cr(u);return i&&u.addEventListener("upgradeneeded",g=>{i(Cr(u.result),g.oldVersion,g.newVersion,Cr(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),f.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),f}const VM=["get","getKey","getAll","getAllKeys","count"],LM=["put","add","delete","clear"],Mm=new Map;function vT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mm.get(e))return Mm.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=LM.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||VM.includes(t)))return;const l=async function(u,...f){const g=this.transaction(u,a?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(f.shift())),(await Promise.all([m[t](...f),a&&g.done]))[0]};return Mm.set(e,l),l}DM(n=>({...n,get:(e,t,i)=>vT(e,t)||n.get(e,t,i),has:(e,t)=>!!vT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OM(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function OM(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",_T="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new kp("@firebase/app"),jM="@firebase/app-compat",FM="@firebase/analytics-compat",qM="@firebase/analytics",BM="@firebase/app-check-compat",zM="@firebase/app-check",HM="@firebase/auth",GM="@firebase/auth-compat",$M="@firebase/database",YM="@firebase/data-connect",JM="@firebase/database-compat",KM="@firebase/functions",QM="@firebase/functions-compat",XM="@firebase/installations",WM="@firebase/installations-compat",ZM="@firebase/messaging",e2="@firebase/messaging-compat",t2="@firebase/performance",n2="@firebase/performance-compat",s2="@firebase/remote-config",i2="@firebase/remote-config-compat",r2="@firebase/storage",a2="@firebase/storage-compat",o2="@firebase/firestore",l2="@firebase/ai",u2="@firebase/firestore-compat",c2="firebase",d2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",f2={[np]:"fire-core",[jM]:"fire-core-compat",[qM]:"fire-analytics",[FM]:"fire-analytics-compat",[zM]:"fire-app-check",[BM]:"fire-app-check-compat",[HM]:"fire-auth",[GM]:"fire-auth-compat",[$M]:"fire-rtdb",[YM]:"fire-data-connect",[JM]:"fire-rtdb-compat",[KM]:"fire-fn",[QM]:"fire-fn-compat",[XM]:"fire-iid",[WM]:"fire-iid-compat",[ZM]:"fire-fcm",[e2]:"fire-fcm-compat",[t2]:"fire-perf",[n2]:"fire-perf-compat",[s2]:"fire-rc",[i2]:"fire-rc-compat",[r2]:"fire-gcs",[a2]:"fire-gcs-compat",[o2]:"fire-fst",[u2]:"fire-fst-compat",[l2]:"fire-vertex","fire-js":"fire-js",[c2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=new Map,h2=new Map,ip=new Map;function TT(n,e){try{n.container.addComponent(e)}catch(t){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function qo(n){const e=n.name;if(ip.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,n);for(const t of Vd.values())TT(t,n);for(const t of h2.values())TT(t,n);return!0}function Lp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function as(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wr=new Nu("app","Firebase",m2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ba("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el=d2;function ME(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:sp,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw wr.create("bad-app-name",{appName:String(a)});if(t||(t=CE()),!t)throw wr.create("no-options");const l=Vd.get(a);if(l){if(Ea(t,l.options)&&Ea(i,l.config))return l;throw wr.create("duplicate-app",{appName:a})}const u=new xM(a);for(const g of ip.values())u.addComponent(g);const f=new p2(t,i,u);return Vd.set(a,f),f}function PE(n=sp){const e=Vd.get(n);if(!e&&n===sp&&CE())return ME();if(!e)throw wr.create("no-app",{appName:n});return e}function Ir(n,e,t){let i=f2[n]??n;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(u.join(" "));return}qo(new ba(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="firebase-heartbeat-database",y2=1,Eu="firebase-heartbeat-store";let Pm=null;function kE(){return Pm||(Pm=kM(g2,y2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Eu)}catch(t){console.warn(t)}}}}).catch(n=>{throw wr.create("idb-open",{originalErrorMessage:n.message})})),Pm}async function v2(n){try{const t=(await kE()).transaction(Eu),i=await t.objectStore(Eu).get(VE(n));return await t.done,i}catch(e){if(e instanceof Bi)Li.warn(e.message);else{const t=wr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Li.warn(t.message)}}}async function xT(n,e){try{const i=(await kE()).transaction(Eu,"readwrite");await i.objectStore(Eu).put(e,VE(n)),await i.done}catch(t){if(t instanceof Bi)Li.warn(t.message);else{const i=wr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Li.warn(i.message)}}}function VE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=1024,T2=30;class x2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new b2(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=ET();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>T2){const u=A2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Li.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ET(),{heartbeatsToSend:i,unsentEntries:a}=E2(this._heartbeatsCache.heartbeats),l=kd(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Li.warn(t),""}}}function ET(){return new Date().toISOString().substring(0,10)}function E2(n,e=_2){const t=[];let i=n.slice();for(const a of n){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),bT(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),bT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class b2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uM()?cM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await v2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function bT(n){return kd(JSON.stringify({version:2,heartbeats:n})).length}function A2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(n){qo(new ba("platform-logger",e=>new UM(e),"PRIVATE")),qo(new ba("heartbeat",e=>new x2(e),"PRIVATE")),Ir(np,_T,n),Ir(np,_T,"esm2020"),Ir("fire-js","")}S2("");var C2="firebase",w2="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ir(C2,w2,"app");var AT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nr,LE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,C){function D(){}D.prototype=C.prototype,R.F=C.prototype,R.prototype=new D,R.prototype.constructor=R,R.D=function(N,P,O){for(var k=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)k[Ue-2]=arguments[Ue];return C.prototype[P].apply(N,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(R,C,D){D||(D=0);const N=Array(16);if(typeof C=="string")for(var P=0;P<16;++P)N[P]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(P=0;P<16;++P)N[P]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=R.g[0],D=R.g[1],P=R.g[2];let O=R.g[3],k;k=C+(O^D&(P^O))+N[0]+3614090360&4294967295,C=D+(k<<7&4294967295|k>>>25),k=O+(P^C&(D^P))+N[1]+3905402710&4294967295,O=C+(k<<12&4294967295|k>>>20),k=P+(D^O&(C^D))+N[2]+606105819&4294967295,P=O+(k<<17&4294967295|k>>>15),k=D+(C^P&(O^C))+N[3]+3250441966&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(O^D&(P^O))+N[4]+4118548399&4294967295,C=D+(k<<7&4294967295|k>>>25),k=O+(P^C&(D^P))+N[5]+1200080426&4294967295,O=C+(k<<12&4294967295|k>>>20),k=P+(D^O&(C^D))+N[6]+2821735955&4294967295,P=O+(k<<17&4294967295|k>>>15),k=D+(C^P&(O^C))+N[7]+4249261313&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(O^D&(P^O))+N[8]+1770035416&4294967295,C=D+(k<<7&4294967295|k>>>25),k=O+(P^C&(D^P))+N[9]+2336552879&4294967295,O=C+(k<<12&4294967295|k>>>20),k=P+(D^O&(C^D))+N[10]+4294925233&4294967295,P=O+(k<<17&4294967295|k>>>15),k=D+(C^P&(O^C))+N[11]+2304563134&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(O^D&(P^O))+N[12]+1804603682&4294967295,C=D+(k<<7&4294967295|k>>>25),k=O+(P^C&(D^P))+N[13]+4254626195&4294967295,O=C+(k<<12&4294967295|k>>>20),k=P+(D^O&(C^D))+N[14]+2792965006&4294967295,P=O+(k<<17&4294967295|k>>>15),k=D+(C^P&(O^C))+N[15]+1236535329&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(P^O&(D^P))+N[1]+4129170786&4294967295,C=D+(k<<5&4294967295|k>>>27),k=O+(D^P&(C^D))+N[6]+3225465664&4294967295,O=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(O^C))+N[11]+643717713&4294967295,P=O+(k<<14&4294967295|k>>>18),k=D+(O^C&(P^O))+N[0]+3921069994&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^O&(D^P))+N[5]+3593408605&4294967295,C=D+(k<<5&4294967295|k>>>27),k=O+(D^P&(C^D))+N[10]+38016083&4294967295,O=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(O^C))+N[15]+3634488961&4294967295,P=O+(k<<14&4294967295|k>>>18),k=D+(O^C&(P^O))+N[4]+3889429448&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^O&(D^P))+N[9]+568446438&4294967295,C=D+(k<<5&4294967295|k>>>27),k=O+(D^P&(C^D))+N[14]+3275163606&4294967295,O=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(O^C))+N[3]+4107603335&4294967295,P=O+(k<<14&4294967295|k>>>18),k=D+(O^C&(P^O))+N[8]+1163531501&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^O&(D^P))+N[13]+2850285829&4294967295,C=D+(k<<5&4294967295|k>>>27),k=O+(D^P&(C^D))+N[2]+4243563512&4294967295,O=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(O^C))+N[7]+1735328473&4294967295,P=O+(k<<14&4294967295|k>>>18),k=D+(O^C&(P^O))+N[12]+2368359562&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(D^P^O)+N[5]+4294588738&4294967295,C=D+(k<<4&4294967295|k>>>28),k=O+(C^D^P)+N[8]+2272392833&4294967295,O=C+(k<<11&4294967295|k>>>21),k=P+(O^C^D)+N[11]+1839030562&4294967295,P=O+(k<<16&4294967295|k>>>16),k=D+(P^O^C)+N[14]+4259657740&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^O)+N[1]+2763975236&4294967295,C=D+(k<<4&4294967295|k>>>28),k=O+(C^D^P)+N[4]+1272893353&4294967295,O=C+(k<<11&4294967295|k>>>21),k=P+(O^C^D)+N[7]+4139469664&4294967295,P=O+(k<<16&4294967295|k>>>16),k=D+(P^O^C)+N[10]+3200236656&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^O)+N[13]+681279174&4294967295,C=D+(k<<4&4294967295|k>>>28),k=O+(C^D^P)+N[0]+3936430074&4294967295,O=C+(k<<11&4294967295|k>>>21),k=P+(O^C^D)+N[3]+3572445317&4294967295,P=O+(k<<16&4294967295|k>>>16),k=D+(P^O^C)+N[6]+76029189&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^O)+N[9]+3654602809&4294967295,C=D+(k<<4&4294967295|k>>>28),k=O+(C^D^P)+N[12]+3873151461&4294967295,O=C+(k<<11&4294967295|k>>>21),k=P+(O^C^D)+N[15]+530742520&4294967295,P=O+(k<<16&4294967295|k>>>16),k=D+(P^O^C)+N[2]+3299628645&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(P^(D|~O))+N[0]+4096336452&4294967295,C=D+(k<<6&4294967295|k>>>26),k=O+(D^(C|~P))+N[7]+1126891415&4294967295,O=C+(k<<10&4294967295|k>>>22),k=P+(C^(O|~D))+N[14]+2878612391&4294967295,P=O+(k<<15&4294967295|k>>>17),k=D+(O^(P|~C))+N[5]+4237533241&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~O))+N[12]+1700485571&4294967295,C=D+(k<<6&4294967295|k>>>26),k=O+(D^(C|~P))+N[3]+2399980690&4294967295,O=C+(k<<10&4294967295|k>>>22),k=P+(C^(O|~D))+N[10]+4293915773&4294967295,P=O+(k<<15&4294967295|k>>>17),k=D+(O^(P|~C))+N[1]+2240044497&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~O))+N[8]+1873313359&4294967295,C=D+(k<<6&4294967295|k>>>26),k=O+(D^(C|~P))+N[15]+4264355552&4294967295,O=C+(k<<10&4294967295|k>>>22),k=P+(C^(O|~D))+N[6]+2734768916&4294967295,P=O+(k<<15&4294967295|k>>>17),k=D+(O^(P|~C))+N[13]+1309151649&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~O))+N[4]+4149444226&4294967295,C=D+(k<<6&4294967295|k>>>26),k=O+(D^(C|~P))+N[11]+3174756917&4294967295,O=C+(k<<10&4294967295|k>>>22),k=P+(C^(O|~D))+N[2]+718787259&4294967295,P=O+(k<<15&4294967295|k>>>17),k=D+(O^(P|~C))+N[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,R.g[2]=R.g[2]+P&4294967295,R.g[3]=R.g[3]+O&4294967295}i.prototype.v=function(R,C){C===void 0&&(C=R.length);const D=C-this.blockSize,N=this.C;let P=this.h,O=0;for(;O<C;){if(P==0)for(;O<=D;)a(this,R,O),O+=this.blockSize;if(typeof R=="string"){for(;O<C;)if(N[P++]=R.charCodeAt(O++),P==this.blockSize){a(this,N),P=0;break}}else for(;O<C;)if(N[P++]=R[O++],P==this.blockSize){a(this,N),P=0;break}}this.h=P,this.o+=C},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var D=R.length-8;D<R.length;++D)R[D]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,D=0;D<4;++D)for(let N=0;N<32;N+=8)R[C++]=this.g[D]>>>N&255;return R};function l(R,C){var D=f;return Object.prototype.hasOwnProperty.call(D,R)?D[R]:D[R]=C(R)}function u(R,C){this.h=C;const D=[];let N=!0;for(let P=R.length-1;P>=0;P--){const O=R[P]|0;N&&O==C||(D[P]=O,N=!1)}this.g=D}var f={};function g(R){return-128<=R&&R<128?l(R,function(C){return new u([C|0],C<0?-1:0)}):new u([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return x;if(R<0)return L(m(-R));const C=[];let D=1;for(let N=0;R>=D;N++)C[N]=R/D|0,D*=4294967296;return new u(C,0)}function T(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return L(T(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=m(Math.pow(C,8));let N=x;for(let O=0;O<R.length;O+=8){var P=Math.min(8,R.length-O);const k=parseInt(R.substring(O,O+P),C);P<8?(P=m(Math.pow(C,P)),N=N.j(P).add(m(k))):(N=N.j(D),N=N.add(m(k)))}return N}var x=g(0),b=g(1),w=g(16777216);n=u.prototype,n.m=function(){if(U(this))return-L(this).m();let R=0,C=1;for(let D=0;D<this.g.length;D++){const N=this.i(D);R+=(N>=0?N:4294967296+N)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(V(this))return"0";if(U(this))return"-"+L(this).toString(R);const C=m(Math.pow(R,6));var D=this;let N="";for(;;){const P=F(D,C).g;D=G(D,P.j(C));let O=((D.g.length>0?D.g[0]:D.h)>>>0).toString(R);if(D=P,V(D))return O+N;for(;O.length<6;)O="0"+O;N=O+N}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function V(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function U(R){return R.h==-1}n.l=function(R){return R=G(this,R),U(R)?-1:V(R)?0:1};function L(R){const C=R.g.length,D=[];for(let N=0;N<C;N++)D[N]=~R.g[N];return new u(D,~R.h).add(b)}n.abs=function(){return U(this)?L(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),D=[];let N=0;for(let P=0;P<=C;P++){let O=N+(this.i(P)&65535)+(R.i(P)&65535),k=(O>>>16)+(this.i(P)>>>16)+(R.i(P)>>>16);N=k>>>16,O&=65535,k&=65535,D[P]=k<<16|O}return new u(D,D[D.length-1]&-2147483648?-1:0)};function G(R,C){return R.add(L(C))}n.j=function(R){if(V(this)||V(R))return x;if(U(this))return U(R)?L(this).j(L(R)):L(L(this).j(R));if(U(R))return L(this.j(L(R)));if(this.l(w)<0&&R.l(w)<0)return m(this.m()*R.m());const C=this.g.length+R.g.length,D=[];for(var N=0;N<2*C;N++)D[N]=0;for(N=0;N<this.g.length;N++)for(let P=0;P<R.g.length;P++){const O=this.i(N)>>>16,k=this.i(N)&65535,Ue=R.i(P)>>>16,Be=R.i(P)&65535;D[2*N+2*P]+=k*Be,W(D,2*N+2*P),D[2*N+2*P+1]+=O*Be,W(D,2*N+2*P+1),D[2*N+2*P+1]+=k*Ue,W(D,2*N+2*P+1),D[2*N+2*P+2]+=O*Ue,W(D,2*N+2*P+2)}for(R=0;R<C;R++)D[R]=D[2*R+1]<<16|D[2*R];for(R=C;R<2*C;R++)D[R]=0;return new u(D,0)};function W(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function ee(R,C){this.g=R,this.h=C}function F(R,C){if(V(C))throw Error("division by zero");if(V(R))return new ee(x,x);if(U(R))return C=F(L(R),C),new ee(L(C.g),L(C.h));if(U(C))return C=F(R,L(C)),new ee(L(C.g),C.h);if(R.g.length>30){if(U(R)||U(C))throw Error("slowDivide_ only works with positive integers.");for(var D=b,N=C;N.l(R)<=0;)D=Q(D),N=Q(N);var P=H(D,1),O=H(N,1);for(N=H(N,2),D=H(D,2);!V(N);){var k=O.add(N);k.l(R)<=0&&(P=P.add(D),O=k),N=H(N,1),D=H(D,1)}return C=G(R,P.j(C)),new ee(P,C)}for(P=x;R.l(C)>=0;){for(D=Math.max(1,Math.floor(R.m()/C.m())),N=Math.ceil(Math.log(D)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),O=m(D),k=O.j(C);U(k)||k.l(R)>0;)D-=N,O=m(D),k=O.j(C);V(O)&&(O=b),P=P.add(O),R=G(R,k)}return new ee(P,R)}n.B=function(R){return F(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)&R.i(N);return new u(D,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)|R.i(N);return new u(D,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)^R.i(N);return new u(D,this.h^R.h)};function Q(R){const C=R.g.length+1,D=[];for(let N=0;N<C;N++)D[N]=R.i(N)<<1|R.i(N-1)>>>31;return new u(D,R.h)}function H(R,C){const D=C>>5;C%=32;const N=R.g.length-D,P=[];for(let O=0;O<N;O++)P[O]=C>0?R.i(O+D)>>>C|R.i(O+D+1)<<32-C:R.i(O+D);return new u(P,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,LE=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=T,Nr=u}).apply(typeof AT<"u"?AT:typeof self<"u"?self:typeof window<"u"?window:{});var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UE,du,OE,xd,rp,jE,FE,qE;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof dd=="object"&&dd];for(var E=0;E<p.length;++E){var S=p[E];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function a(p,E){if(E)e:{var S=i;p=p.split(".");for(var M=0;M<p.length-1;M++){var Y=p[M];if(!(Y in S))break e;S=S[Y]}p=p[p.length-1],M=S[p],E=E(M),E!=M&&E!=null&&e(S,p,{configurable:!0,writable:!0,value:E})}}a("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(p){return p||function(E){var S=[],M;for(M in E)Object.prototype.hasOwnProperty.call(E,M)&&S.push([M,E[M]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function f(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function g(p,E,S){return p.call.apply(p.bind,arguments)}function m(p,E,S){return m=g,m.apply(null,arguments)}function T(p,E){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function x(p,E){function S(){}S.prototype=E.prototype,p.Z=E.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(M,Y,ne){for(var ve=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ve[ze-2]=arguments[ze];return E.prototype[Y].apply(M,ve)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function w(p){const E=p.length;if(E>0){const S=Array(E);for(let M=0;M<E;M++)S[M]=p[M];return S}return[]}function V(p,E){for(let M=1;M<arguments.length;M++){const Y=arguments[M];var S=typeof Y;if(S=S!="object"?S:Y?Array.isArray(Y)?"array":S:"null",S=="array"||S=="object"&&typeof Y.length=="number"){S=p.length||0;const ne=Y.length||0;p.length=S+ne;for(let ve=0;ve<ne;ve++)p[S+ve]=Y[ve]}else p.push(Y)}}class U{constructor(E,S){this.i=E,this.j=S,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function L(p){u.setTimeout(()=>{throw p},0)}function G(){var p=R;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class W{constructor(){this.h=this.g=null}add(E,S){const M=ee.get();M.set(E,S),this.h?this.h.next=M:this.g=M,this.h=M}}var ee=new U(()=>new F,p=>p.reset());class F{constructor(){this.next=this.g=this.h=null}set(E,S){this.h=E,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Q,H=!1,R=new W,C=()=>{const p=Promise.resolve(void 0);Q=()=>{p.then(D)}};function D(){for(var p;p=G();){try{p.h.call(p.g)}catch(S){L(S)}var E=ee;E.j(p),E.h<100&&(E.h++,p.next=E.g,E.g=p)}H=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};u.addEventListener("test",S,E),u.removeEventListener("test",S,E)}catch{}return p})();function k(p){return/^[\s\xa0]*$/.test(p)}function Ue(p,E){P.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,E)}x(Ue,P),Ue.prototype.init=function(p,E){const S=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget,E||(S=="mouseover"?E=p.fromElement:S=="mouseout"&&(E=p.toElement)),this.relatedTarget=E,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Ue.Z.h.call(this)},Ue.prototype.h=function(){Ue.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Be="closure_listenable_"+(Math.random()*1e6|0),te=0;function Z(p,E,S,M,Y){this.listener=p,this.proxy=null,this.src=E,this.type=S,this.capture=!!M,this.ha=Y,this.key=++te,this.da=this.fa=!1}function pe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Me(p,E,S){for(const M in p)E.call(S,p[M],M,p)}function Re(p,E){for(const S in p)E.call(void 0,p[S],S,p)}function q(p){const E={};for(const S in p)E[S]=p[S];return E}const ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Te(p,E){let S,M;for(let Y=1;Y<arguments.length;Y++){M=arguments[Y];for(S in M)p[S]=M[S];for(let ne=0;ne<ae.length;ne++)S=ae[ne],Object.prototype.hasOwnProperty.call(M,S)&&(p[S]=M[S])}}function Ee(p){this.src=p,this.g={},this.h=0}Ee.prototype.add=function(p,E,S,M,Y){const ne=p.toString();p=this.g[ne],p||(p=this.g[ne]=[],this.h++);const ve=ke(p,E,M,Y);return ve>-1?(E=p[ve],S||(E.fa=!1)):(E=new Z(E,this.src,ne,!!M,Y),E.fa=S,p.push(E)),E};function Ie(p,E){const S=E.type;if(S in p.g){var M=p.g[S],Y=Array.prototype.indexOf.call(M,E,void 0),ne;(ne=Y>=0)&&Array.prototype.splice.call(M,Y,1),ne&&(pe(E),p.g[S].length==0&&(delete p.g[S],p.h--))}}function ke(p,E,S,M){for(let Y=0;Y<p.length;++Y){const ne=p[Y];if(!ne.da&&ne.listener==E&&ne.capture==!!S&&ne.ha==M)return Y}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),me={};function ge(p,E,S,M,Y){if(Array.isArray(E)){for(let ne=0;ne<E.length;ne++)ge(p,E[ne],S,M,Y);return null}return S=zr(S),p&&p[Be]?p.J(E,S,f(M)?!!M.capture:!1,Y):Ge(p,E,S,!1,M,Y)}function Ge(p,E,S,M,Y,ne){if(!E)throw Error("Invalid event type");const ve=f(Y)?!!Y.capture:!!Y;let ze=ii(p);if(ze||(p[Ye]=ze=new Ee(p)),S=ze.add(E,S,M,ve,ne),S.proxy)return S;if(M=kt(),S.proxy=M,M.src=p,M.listener=S,p.addEventListener)O||(Y=ve),Y===void 0&&(Y=!1),p.addEventListener(E.toString(),M,Y);else if(p.attachEvent)p.attachEvent(_t(E.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function kt(){function p(S){return E.call(p.src,p.listener,S)}const E=si;return p}function Sn(p,E,S,M,Y){if(Array.isArray(E))for(var ne=0;ne<E.length;ne++)Sn(p,E[ne],S,M,Y);else M=f(M)?!!M.capture:!!M,S=zr(S),p&&p[Be]?(p=p.i,ne=String(E).toString(),ne in p.g&&(E=p.g[ne],S=ke(E,S,M,Y),S>-1&&(pe(E[S]),Array.prototype.splice.call(E,S,1),E.length==0&&(delete p.g[ne],p.h--)))):p&&(p=ii(p))&&(E=p.g[E.toString()],p=-1,E&&(p=ke(E,S,M,Y)),(S=p>-1?E[p]:null)&&Ln(S))}function Ln(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[Be])Ie(E.i,p);else{var S=p.type,M=p.proxy;E.removeEventListener?E.removeEventListener(S,M,p.capture):E.detachEvent?E.detachEvent(_t(S),M):E.addListener&&E.removeListener&&E.removeListener(M),(S=ii(E))?(Ie(S,p),S.h==0&&(S.src=null,E[Ye]=null)):pe(p)}}}function _t(p){return p in me?me[p]:me[p]="on"+p}function si(p,E){if(p.da)p=!0;else{E=new Ue(E,this);const S=p.listener,M=p.ha||p.src;p.fa&&Ln(p),p=S.call(M,E)}return p}function ii(p){return p=p[Ye],p instanceof Ee?p:null}var Br="__closure_events_fn_"+(Math.random()*1e9>>>0);function zr(p){return typeof p=="function"?p:(p[Br]||(p[Br]=function(E){return p.handleEvent(E)}),p[Br])}function Dt(){N.call(this),this.i=new Ee(this),this.M=this,this.G=null}x(Dt,N),Dt.prototype[Be]=!0,Dt.prototype.removeEventListener=function(p,E,S,M){Sn(this,p,E,S,M)};function Vt(p,E){var S,M=p.G;if(M)for(S=[];M;M=M.G)S.push(M);if(p=p.M,M=E.type||E,typeof E=="string")E=new P(E,p);else if(E instanceof P)E.target=E.target||p;else{var Y=E;E=new P(M,p),Te(E,Y)}Y=!0;let ne,ve;if(S)for(ve=S.length-1;ve>=0;ve--)ne=E.g=S[ve],Y=Is(ne,M,!0,E)&&Y;if(ne=E.g=p,Y=Is(ne,M,!0,E)&&Y,Y=Is(ne,M,!1,E)&&Y,S)for(ve=0;ve<S.length;ve++)ne=E.g=S[ve],Y=Is(ne,M,!1,E)&&Y}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var p=this.i;for(const E in p.g){const S=p.g[E];for(let M=0;M<S.length;M++)pe(S[M]);delete p.g[E],p.h--}}this.G=null},Dt.prototype.J=function(p,E,S,M){return this.i.add(String(p),E,!1,S,M)},Dt.prototype.K=function(p,E,S,M){return this.i.add(String(p),E,!0,S,M)};function Is(p,E,S,M){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();let Y=!0;for(let ne=0;ne<E.length;++ne){const ve=E[ne];if(ve&&!ve.da&&ve.capture==S){const ze=ve.listener,Lt=ve.ha||ve.src;ve.fa&&Ie(p.i,ve),Y=ze.call(Lt,M)!==!1&&Y}}return Y&&!M.defaultPrevented}function al(p,E){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:u.setTimeout(p,E||0)}function Va(p){p.g=al(()=>{p.g=null,p.i&&(p.i=!1,Va(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class ln extends N{constructor(E,S){super(),this.m=E,this.l=S,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Va(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ns(p){N.call(this),this.h=p,this.g={}}x(Ns,N);var Hr=[];function Hi(p){Me(p.g,function(E,S){this.g.hasOwnProperty(S)&&Ln(E)},p),p.g={}}Ns.prototype.N=function(){Ns.Z.N.call(this),Hi(this)},Ns.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var us=u.JSON.stringify,La=u.JSON.parse,Gr=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function $r(){}function z(){}var ce={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fe(){P.call(this,"d")}x(fe,P);function ye(){P.call(this,"c")}x(ye,P);var _e={},Je=null;function Cn(){return Je=Je||new Dt}_e.Ia="serverreachability";function Rs(p){P.call(this,_e.Ia,p)}x(Rs,P);function wn(p){const E=Cn();Vt(E,new Rs(E))}_e.STAT_EVENT="statevent";function cs(p,E){P.call(this,_e.STAT_EVENT,p),this.stat=E}x(cs,P);function wt(p){const E=Cn();Vt(E,new cs(E,p))}_e.Ja="timingevent";function xn(p,E){P.call(this,_e.Ja,p),this.size=E}x(xn,P);function xe(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},E)}function rt(){this.g=!0}rt.prototype.ua=function(){this.g=!1};function Un(p,E,S,M,Y,ne){p.info(function(){if(p.g)if(ne){var ve="",ze=ne.split("&");for(let ut=0;ut<ze.length;ut++){var Lt=ze[ut].split("=");if(Lt.length>1){const It=Lt[0];Lt=Lt[1];const Xn=It.split("_");ve=Xn.length>=2&&Xn[1]=="type"?ve+(It+"="+Lt+"&"):ve+(It+"=redacted&")}}}else ve=null;else ve=ne;return"XMLHTTP REQ ("+M+") [attempt "+Y+"]: "+E+`
`+S+`
`+ve})}function xt(p,E,S,M,Y,ne,ve){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+Y+"]: "+E+`
`+S+`
`+ne+" "+ve})}function Xt(p,E,S,M){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+Ua(p,S)+(M?" "+M:"")})}function Xe(p,E){p.info(function(){return"TIMEOUT: "+E})}rt.prototype.info=function(){};function Ua(p,E){if(!p.g)return E;if(!E)return null;try{const ne=JSON.parse(E);if(ne){for(p=0;p<ne.length;p++)if(Array.isArray(ne[p])){var S=ne[p];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var Y=M[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(let ve=1;ve<M.length;ve++)M[ve]=""}}}}return us(ne)}catch{return E}}var Ds={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Gi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ol;function Yr(){}x(Yr,$r),Yr.prototype.g=function(){return new XMLHttpRequest},ol=new Yr;function ri(p){return encodeURIComponent(String(p))}function Bu(p){var E=1;p=p.split(":");const S=[];for(;E>0&&p.length;)S.push(p.shift()),E--;return p.length&&S.push(p.join(":")),S}function ds(p,E,S,M){this.j=p,this.i=E,this.l=S,this.S=M||1,this.V=new Ns(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fs}function fs(){this.i=null,this.g="",this.h=!1}var qt={},tn={};function Ms(p,E,S){p.M=1,p.A=Jr(zt(E)),p.u=S,p.R=!0,Oa(p,null)}function Oa(p,E){p.F=Date.now(),Ps(p),p.B=zt(p.A);var S=p.B,M=p.S;Array.isArray(M)||(M=[String(M)]),Ba(S.i,"t",M),p.C=0,S=p.j.L,p.h=new fs,p.g=sc(p.j,S?E:null,!p.u),p.P>0&&(p.O=new ln(m(p.Y,p,p.g),p.P)),E=p.V,S=p.g,M=p.ba;var Y="readystatechange";Array.isArray(Y)||(Y&&(Hr[0]=Y.toString()),Y=Hr);for(let ne=0;ne<Y.length;ne++){const ve=ge(S,Y[ne],M||E.handleEvent,!1,E.h||E);if(!ve)break;E.g[ve.key]=ve}E=p.J?q(p.J):{},p.u?(p.v||(p.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,E)):(p.v="GET",p.g.ea(p.B,p.v,null,E)),wn(),Un(p.i,p.v,p.B,p.l,p.S,p.u)}ds.prototype.ba=function(p){p=p.target;const E=this.O;E&&ps(p)==3?E.j():this.Y(p)},ds.prototype.Y=function(p){try{if(p==this.g)e:{const ze=ps(this.g),Lt=this.g.ya(),ut=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||un(this.g)))){this.K||ze!=4||Lt==7||(Lt==8||ut<=0?wn(3):wn(2)),ks(this);var E=this.g.ca();this.X=E;var S=wf(this);if(this.o=E==200,xt(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var M,Y=this.g;if((M=Y.g?Y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(M)){var ne=M;break t}}ne=null}if(p=ne)Xt(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vs(this,p);else{this.o=!1,this.m=3,wt(12),On(this),Jn(this);break e}}if(this.R){p=!0;let It;for(;!this.K&&this.C<S.length;)if(It=Hu(this,S),It==tn){ze==4&&(this.m=4,wt(14),p=!1),Xt(this.i,this.l,null,"[Incomplete Response]");break}else if(It==qt){this.m=4,wt(15),Xt(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Xt(this.i,this.l,It,null),Vs(this,It);if(zu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||S.length!=0||this.h.h||(this.m=1,wt(16),p=!1),this.o=this.o&&p,!p)Xt(this.i,this.l,S,"[Invalid Chunked Response]"),On(this),Jn(this);else if(S.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),El(ve),ve.P=!0,wt(11))}}else Xt(this.i,this.l,S,null),Vs(this,S);ze==4&&On(this),this.o&&!this.K&&(ze==4?Zu(this.j,this):(this.o=!1,Ps(this)))}else oi(this.g),E==400&&S.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),On(this),Jn(this)}}}catch{}finally{}};function wf(p){if(!zu(p))return p.g.la();const E=un(p.g);if(E==="")return"";let S="";const M=E.length,Y=ps(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return On(p),Jn(p),"";p.h.i=new u.TextDecoder}for(let ne=0;ne<M;ne++)p.h.h=!0,S+=p.h.i.decode(E[ne],{stream:!(Y&&ne==M-1)});return E.length=0,p.h.g+=S,p.C=0,p.h.g}function zu(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Hu(p,E){var S=p.C,M=E.indexOf(`
`,S);return M==-1?tn:(S=Number(E.substring(S,M)),isNaN(S)?qt:(M+=1,M+S>E.length?tn:(E=E.slice(M,M+S),p.C=M+S,E)))}ds.prototype.cancel=function(){this.K=!0,On(this)};function Ps(p){p.T=Date.now()+p.H,ja(p,p.H)}function ja(p,E){if(p.D!=null)throw Error("WatchDog timer not null");p.D=xe(m(p.aa,p),E)}function ks(p){p.D&&(u.clearTimeout(p.D),p.D=null)}ds.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Xe(this.i,this.B),this.M!=2&&(wn(),wt(17)),On(this),this.m=2,Jn(this)):ja(this,this.T-p)};function Jn(p){p.j.I==0||p.K||Zu(p.j,p)}function On(p){ks(p);var E=p.O;E&&typeof E.dispose=="function"&&E.dispose(),p.O=null,Hi(p.V),p.g&&(E=p.g,p.g=null,E.abort(),E.dispose())}function Vs(p,E){try{var S=p.j;if(S.I!=0&&(S.g==p||Us(S.h,p))){if(!p.L&&Us(S.h,p)&&S.I==3){try{var M=S.Ba.g.parse(E)}catch{M=null}if(Array.isArray(M)&&M.length==3){var Y=M;if(Y[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)Ya(S),Zi(S);else break e;ta(S),wt(18)}}else S.xa=Y[1],0<S.xa-S.K&&Y[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=xe(m(S.Va,S),6e3));Ls(S.h)<=1&&S.ta&&(S.ta=void 0)}else zs(S,11)}else if((p.L||S.g==p)&&Ya(S),!k(E))for(Y=S.Ba.g.parse(E),E=0;E<Y.length;E++){let ut=Y[E];const It=ut[0];if(!(It<=S.K))if(S.K=It,ut=ut[1],S.I==2)if(ut[0]=="c"){S.M=ut[1],S.ba=ut[2];const Xn=ut[3];Xn!=null&&(S.ka=Xn,S.j.info("VER="+S.ka));const Hs=ut[4];Hs!=null&&(S.za=Hs,S.j.info("SVER="+S.za));const gs=ut[5];gs!=null&&typeof gs=="number"&&gs>0&&(M=1.5*gs,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const ys=p.g;if(ys){const na=ys.g?ys.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(na){var ne=M.h;ne.g||na.indexOf("spdy")==-1&&na.indexOf("quic")==-1&&na.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(cl(ne,ne.h),ne.h=null))}if(M.G){const Ja=ys.g?ys.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(M.wa=Ja,ft(M.J,M.G,Ja))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var ve=p;if(M.na=nc(M,M.L?M.ba:null,M.W),ve.L){dl(M.h,ve);var ze=ve,Lt=M.O;Lt&&(ze.H=Lt),ze.D&&(ks(ze),Ps(ze)),M.g=ve}else Xu(M);S.i.length>0&&Bs(S)}else ut[0]!="stop"&&ut[0]!="close"||zs(S,7);else S.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?zs(S,7):Tl(S):ut[0]!="noop"&&S.l&&S.l.qa(ut),S.A=0)}}wn(4)}catch{}}var Bt=class{constructor(p,E){this.g=p,this.map=E}};function ll(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ul(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ls(p){return p.h?1:p.g?p.g.size:0}function Us(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function cl(p,E){p.g?p.g.add(E):p.h=E}function dl(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}ll.prototype.cancel=function(){if(this.i=fl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function fl(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const S of p.g.values())E=E.concat(S.G);return E}return w(p.i)}var Gu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fa(p,E){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const M=p[S].indexOf("=");let Y,ne=null;M>=0?(Y=p[S].substring(0,M),ne=p[S].substring(M+1)):Y=p[S],E(Y,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function jn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;p instanceof jn?(this.l=p.l,nn(this,p.j),this.o=p.o,this.g=p.g,$i(this,p.u),this.h=p.h,hl(this,Ku(p.i)),this.m=p.m):p&&(E=String(p).match(Gu))?(this.l=!1,nn(this,E[1]||"",!0),this.o=Os(E[2]||""),this.g=Os(E[3]||"",!0),$i(this,E[4]),this.h=Os(E[5]||"",!0),hl(this,E[6]||"",!0),this.m=Os(E[7]||"")):(this.l=!1,this.i=new Ji(null,this.l))}jn.prototype.toString=function(){const p=[];var E=this.j;E&&p.push(Kr(E,qa,!0),":");var S=this.g;return(S||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Kr(E,qa,!0),"@"),p.push(ri(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Kr(S,S.charAt(0)=="/"?ml:$u,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Kr(S,Yu)),p.join("")},jn.prototype.resolve=function(p){const E=zt(this);let S=!!p.j;S?nn(E,p.j):S=!!p.o,S?E.o=p.o:S=!!p.g,S?E.g=p.g:S=p.u!=null;var M=p.h;if(S)$i(E,p.u);else if(S=!!p.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var Y=E.h.lastIndexOf("/");Y!=-1&&(M=E.h.slice(0,Y+1)+M)}if(Y=M,Y==".."||Y==".")M="";else if(Y.indexOf("./")!=-1||Y.indexOf("/.")!=-1){M=Y.lastIndexOf("/",0)==0,Y=Y.split("/");const ne=[];for(let ve=0;ve<Y.length;){const ze=Y[ve++];ze=="."?M&&ve==Y.length&&ne.push(""):ze==".."?((ne.length>1||ne.length==1&&ne[0]!="")&&ne.pop(),M&&ve==Y.length&&ne.push("")):(ne.push(ze),M=!0)}M=ne.join("/")}else M=Y}return S?E.h=M:S=p.i.toString()!=="",S?hl(E,Ku(p.i)):S=!!p.m,S&&(E.m=p.m),E};function zt(p){return new jn(p)}function nn(p,E,S){p.j=S?Os(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function $i(p,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);p.u=E}else p.u=null}function hl(p,E,S){E instanceof Ji?(p.i=E,za(p.i,p.l)):(S||(E=Kr(E,Yi)),p.i=new Ji(E,p.l))}function ft(p,E,S){p.i.set(E,S)}function Jr(p){return ft(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Os(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Kr(p,E,S){return typeof p=="string"?(p=encodeURI(p).replace(E,In),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function In(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var qa=/[#\/\?@]/g,$u=/[#\?:]/g,ml=/[#\?]/g,Yi=/[#\?@]/g,Yu=/#/g;function Ji(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function Nn(p){p.g||(p.g=new Map,p.h=0,p.i&&Fa(p.i,function(E,S){p.add(decodeURIComponent(E.replace(/\+/g," ")),S)}))}n=Ji.prototype,n.add=function(p,E){Nn(this),this.i=null,p=Ki(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(E),this.h+=1,this};function Ju(p,E){Nn(p),E=Ki(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function pl(p,E){return Nn(p),E=Ki(p,E),p.g.has(E)}n.forEach=function(p,E){Nn(this),this.g.forEach(function(S,M){S.forEach(function(Y){p.call(E,Y,M,this)},this)},this)};function gl(p,E){Nn(p);let S=[];if(typeof E=="string")pl(p,E)&&(S=S.concat(p.g.get(Ki(p,E))));else for(p=Array.from(p.g.values()),E=0;E<p.length;E++)S=S.concat(p[E]);return S}n.set=function(p,E){return Nn(this),this.i=null,p=Ki(this,p),pl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},n.get=function(p,E){return p?(p=gl(this,p),p.length>0?String(p[0]):E):E};function Ba(p,E,S){Ju(p,E),S.length>0&&(p.i=null,p.g.set(Ki(p,E),w(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(let M=0;M<E.length;M++){var S=E[M];const Y=ri(S);S=gl(this,S);for(let ne=0;ne<S.length;ne++){let ve=Y;S[ne]!==""&&(ve+="="+ri(S[ne])),p.push(ve)}}return this.i=p.join("&")};function Ku(p){const E=new Ji;return E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),E}function Ki(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function za(p,E){E&&!p.j&&(Nn(p),p.i=null,p.g.forEach(function(S,M){const Y=M.toLowerCase();M!=Y&&(Ju(this,M),Ba(this,Y,S))},p)),p.j=E}function hs(p,E){const S=new rt;if(u.Image){const M=new Image;M.onload=T(Kn,S,"TestLoadImage: loaded",!0,E,M),M.onerror=T(Kn,S,"TestLoadImage: error",!1,E,M),M.onabort=T(Kn,S,"TestLoadImage: abort",!1,E,M),M.ontimeout=T(Kn,S,"TestLoadImage: timeout",!1,E,M),u.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else E(!1)}function yl(p,E){const S=new rt,M=new AbortController,Y=setTimeout(()=>{M.abort(),Kn(S,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:M.signal}).then(ne=>{clearTimeout(Y),ne.ok?Kn(S,"TestPingServer: ok",!0,E):Kn(S,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Y),Kn(S,"TestPingServer: error",!1,E)})}function Kn(p,E,S,M,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),M(S)}catch{}}function Qi(){this.g=new Gr}function js(p){this.i=p.Sb||null,this.h=p.ab||!1}x(js,$r),js.prototype.g=function(){return new Qr(this.i,this.h)};function Qr(p,E){Dt.call(this),this.H=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Qr,Dt),n=Qr.prototype,n.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=E,this.readyState=1,ms(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(E.body=p),(this.H||u).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xi(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ms(this)),this.g&&(this.readyState=3,ms(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ha(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ha(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?Xi(this):ms(this),this.readyState==3&&Ha(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Xi(this))},n.Na=function(p){this.g&&(this.response=p,Xi(this))},n.ga=function(){this.g&&Xi(this)};function Xi(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ms(p)}n.setRequestHeader=function(p,E){this.A.append(p,E)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var S=E.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=E.next();return p.join(`\r
`)};function ms(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Qr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Qn(p){let E="";return Me(p,function(S,M){E+=M,E+=":",E+=S,E+=`\r
`}),E}function Xr(p,E,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=Qn(S),typeof p=="string"?S!=null&&ri(S):ft(p,E,S))}function pt(p){Dt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(pt,Dt);var Fs=/^https?$/i,vl=["POST","PUT"];n=pt.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,E,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ol.g(),this.g.onreadystatechange=b(m(this.Ca,this));try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(ne){Wr(this,ne);return}if(p=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var Y in M)S.set(Y,M[Y]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ne of M.keys())S.set(ne,M.get(ne));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(ne=>ne.toLowerCase()=="content-type"),Y=u.FormData&&p instanceof u.FormData,!(Array.prototype.indexOf.call(vl,E,void 0)>=0)||M||Y||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,ve]of S)this.g.setRequestHeader(ne,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ne){Wr(this,ne)}};function Wr(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.o=5,_l(p),ai(p)}function _l(p){p.A||(p.A=!0,Vt(p,"complete"),Vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Vt(this,"complete"),Vt(this,"abort"),ai(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Zr(this):this.Xa())},n.Xa=function(){Zr(this)};function Zr(p){if(p.h&&typeof l<"u"){if(p.v&&ps(p)==4)setTimeout(p.Ca.bind(p),0);else if(Vt(p,"readystatechange"),ps(p)==4){p.h=!1;try{const ne=p.ca();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var S;if(!(S=E)){var M;if(M=ne===0){let ve=String(p.D).match(Gu)[1]||null;!ve&&u.self&&u.self.location&&(ve=u.self.location.protocol.slice(0,-1)),M=!Fs.test(ve?ve.toLowerCase():"")}S=M}if(S)Vt(p,"complete"),Vt(p,"success");else{p.o=6;try{var Y=ps(p)>2?p.g.statusText:""}catch{Y=""}p.l=Y+" ["+p.ca()+"]",_l(p)}}finally{ai(p)}}}}function ai(p,E){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,E||Vt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ps(p){return p.g?p.g.readyState:0}n.ca=function(){try{return ps(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),La(E)}};function un(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function oi(p){const E={};p=(p.g&&ps(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(k(p[M]))continue;var S=Bu(p[M]);const Y=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ne=E[Y]||[];E[Y]=ne,ne.push(S)}Re(E,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qs(p,E,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||E}function Wi(p){this.za=0,this.i=[],this.j=new rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qs("baseRetryDelayMs",5e3,p),this.Za=qs("retryDelaySeedMs",1e4,p),this.Ta=qs("forwardChannelMaxRetries",2,p),this.va=qs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new ll(p&&p.concurrentRequestLimit),this.Ba=new Qi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wi.prototype,n.ka=8,n.I=1,n.connect=function(p,E,S,M){wt(0),this.W=p,this.H=E||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=nc(this,null,this.W),Bs(this)};function Tl(p){if(Ga(p),p.I==3){var E=p.V++,S=zt(p.J);if(ft(S,"SID",p.M),ft(S,"RID",E),ft(S,"TYPE","terminate"),ea(p,S),E=new ds(p,p.j,E),E.M=2,E.A=Jr(zt(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(E.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=E.A,S=!0),S||(E.g=sc(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Ps(E)}tc(p)}function Zi(p){p.g&&(El(p),p.g.cancel(),p.g=null)}function Ga(p){Zi(p),p.v&&(u.clearTimeout(p.v),p.v=null),Ya(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&u.clearTimeout(p.m),p.m=null)}function Bs(p){if(!ul(p.h)&&!p.m){p.m=!0;var E=p.Ea;Q||C(),H||(Q(),H=!0),R.add(E,p),p.D=0}}function $a(p,E){return Ls(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=E.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=xe(m(p.Ea,p,E),ec(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const Y=new ds(this,this.j,p);let ne=this.o;if(this.U&&(ne?(ne=q(ne),Te(ne,this.U)):ne=this.U),this.u!==null||this.R||(Y.J=ne,ne=null),this.S)e:{for(var E=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(E+=M,E>4096){E=S;break e}if(E===4096||S===this.i.length-1){E=S+1;break e}}E=1e3}else E=1e3;E=Qu(this,Y,E),S=zt(this.J),ft(S,"RID",p),ft(S,"CVER",22),this.G&&ft(S,"X-HTTP-Session-Id",this.G),ea(this,S),ne&&(this.R?E="headers="+ri(Qn(ne))+"&"+E:this.u&&Xr(S,this.u,ne)),cl(this.h,Y),this.Ra&&ft(S,"TYPE","init"),this.S?(ft(S,"$req",E),ft(S,"SID","null"),Y.U=!0,Ms(Y,S,null)):Ms(Y,S,E),this.I=2}}else this.I==3&&(p?xl(this,p):this.i.length==0||ul(this.h)||xl(this))};function xl(p,E){var S;E?S=E.l:S=p.V++;const M=zt(p.J);ft(M,"SID",p.M),ft(M,"RID",S),ft(M,"AID",p.K),ea(p,M),p.u&&p.o&&Xr(M,p.u,p.o),S=new ds(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),E&&(p.i=E.G.concat(p.i)),E=Qu(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),cl(p.h,S),Ms(S,M,E)}function ea(p,E){p.H&&Me(p.H,function(S,M){ft(E,M,S)}),p.l&&Me({},function(S,M){ft(E,M,S)})}function Qu(p,E,S){S=Math.min(p.i.length,S);const M=p.l?m(p.l.Ka,p.l,p):null;e:{var Y=p.i;let ze=-1;for(;;){const Lt=["count="+S];ze==-1?S>0?(ze=Y[0].g,Lt.push("ofs="+ze)):ze=0:Lt.push("ofs="+ze);let ut=!0;for(let It=0;It<S;It++){var ne=Y[It].g;const Xn=Y[It].map;if(ne-=ze,ne<0)ze=Math.max(0,Y[It].g-100),ut=!1;else try{ne="req"+ne+"_"||"";try{var ve=Xn instanceof Map?Xn:Object.entries(Xn);for(const[Hs,gs]of ve){let ys=gs;f(gs)&&(ys=us(gs)),Lt.push(ne+Hs+"="+encodeURIComponent(ys))}}catch(Hs){throw Lt.push(ne+"type="+encodeURIComponent("_badmap")),Hs}}catch{M&&M(Xn)}}if(ut){ve=Lt.join("&");break e}}ve=void 0}return p=p.i.splice(0,S),E.G=p,ve}function Xu(p){if(!p.g&&!p.v){p.Y=1;var E=p.Da;Q||C(),H||(Q(),H=!0),R.add(E,p),p.A=0}}function ta(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=xe(m(p.Da,p),ec(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Wu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=xe(m(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),Zi(this),Wu(this))};function El(p){p.B!=null&&(u.clearTimeout(p.B),p.B=null)}function Wu(p){p.g=new ds(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var E=zt(p.na);ft(E,"RID","rpc"),ft(E,"SID",p.M),ft(E,"AID",p.K),ft(E,"CI",p.F?"0":"1"),!p.F&&p.ia&&ft(E,"TO",p.ia),ft(E,"TYPE","xmlhttp"),ea(p,E),p.u&&p.o&&Xr(E,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Jr(zt(E)),S.u=null,S.R=!0,Oa(S,p)}n.Va=function(){this.C!=null&&(this.C=null,Zi(this),ta(this),wt(19))};function Ya(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Zu(p,E){var S=null;if(p.g==E){Ya(p),El(p),p.g=null;var M=2}else if(Us(p.h,E))S=E.G,dl(p.h,E),M=1;else return;if(p.I!=0){if(E.o)if(M==1){S=E.u?E.u.length:0,E=Date.now()-E.F;var Y=p.D;M=Cn(),Vt(M,new xn(M,S)),Bs(p)}else Xu(p);else if(Y=E.m,Y==3||Y==0&&E.X>0||!(M==1&&$a(p,E)||M==2&&ta(p)))switch(S&&S.length>0&&(E=p.h,E.i=E.i.concat(S)),Y){case 1:zs(p,5);break;case 4:zs(p,10);break;case 3:zs(p,6);break;default:zs(p,2)}}}function ec(p,E){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*E}function zs(p,E){if(p.j.info("Error code "+E),E==2){var S=m(p.bb,p),M=p.Ua;const Y=!M;M=new jn(M||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||nn(M,"https"),Jr(M),Y?hs(M.toString(),S):yl(M.toString(),S)}else wt(2);p.I=0,p.l&&p.l.pa(E),tc(p),Ga(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function tc(p){if(p.I=0,p.ja=[],p.l){const E=fl(p.h);(E.length!=0||p.i.length!=0)&&(V(p.ja,E),V(p.ja,p.i),p.h.i.length=0,w(p.i),p.i.length=0),p.l.oa()}}function nc(p,E,S){var M=S instanceof jn?zt(S):new jn(S);if(M.g!="")E&&(M.g=E+"."+M.g),$i(M,M.u);else{var Y=u.location;M=Y.protocol,E=E?E+"."+Y.hostname:Y.hostname,Y=+Y.port;const ne=new jn(null);M&&nn(ne,M),E&&(ne.g=E),Y&&$i(ne,Y),S&&(ne.h=S),M=ne}return S=p.G,E=p.wa,S&&E&&ft(M,S,E),ft(M,"VER",p.ka),ea(p,M),M}function sc(p,E,S){if(E&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Aa&&!p.ma?new pt(new js({ab:S})):new pt(p.ma),E.Fa(p.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ic(){}n=ic.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function er(){}er.prototype.g=function(p,E){return new En(p,E)};function En(p,E){Dt.call(this),this.g=new Wi(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(p?p["X-WebChannel-Client-Profile"]=E.sa:p={"X-WebChannel-Client-Profile":E.sa}),this.g.U=p,(p=E&&E.Qb)&&!k(p)&&(this.g.u=p),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!k(E)&&(this.g.G=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new li(this)}x(En,Dt),En.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){Tl(this.g)},En.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=us(p),p=S);E.i.push(new Bt(E.Ya++,p)),E.I==3&&Bs(E)},En.prototype.N=function(){this.g.l=null,delete this.j,Tl(this.g),delete this.g,En.Z.N.call(this)};function rc(p){fe.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const S in E){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}x(rc,fe);function ac(){ye.call(this),this.status=1}x(ac,ye);function li(p){this.g=p}x(li,ic),li.prototype.ra=function(){Vt(this.g,"a")},li.prototype.qa=function(p){Vt(this.g,new rc(p))},li.prototype.pa=function(p){Vt(this.g,new ac)},li.prototype.oa=function(){Vt(this.g,"b")},er.prototype.createWebChannel=er.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,qE=function(){return new er},FE=function(){return Cn()},jE=_e,rp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ds.NO_ERROR=0,Ds.TIMEOUT=8,Ds.HTTP_ERROR=6,xd=Ds,Gi.COMPLETE="complete",OE=Gi,z.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,du=z,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,UE=pt}).apply(typeof dd<"u"?dd:typeof self<"u"?self:typeof window<"u"?window:{});const ST="@firebase/firestore",CT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=new kp("@firebase/firestore");function So(){return Aa.logLevel}function be(n,...e){if(Aa.logLevel<=et.DEBUG){const t=e.map(Up);Aa.debug(`Firestore (${tl}): ${n}`,...t)}}function Ui(n,...e){if(Aa.logLevel<=et.ERROR){const t=e.map(Up);Aa.error(`Firestore (${tl}): ${n}`,...t)}}function Sa(n,...e){if(Aa.logLevel<=et.WARN){const t=e.map(Up);Aa.warn(`Firestore (${tl}): ${n}`,...t)}}function Up(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,BE(n,i,t)}function BE(n,e,t){let i=`FIRESTORE (${tl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ui(i),new Error(i)}function dt(n,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,n||BE(e,a,i)}function qe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Bi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yn.UNAUTHENTICATED)))}shutdown(){}}class I2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class N2{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){dt(this.o===void 0,42304);let i=this.i;const a=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Pi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Pi,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},f=g=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>f(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?f(g):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Pi)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(dt(typeof i.accessToken=="string",31837,{l:i}),new zE(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return dt(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class R2{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class D2{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new R2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,as(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){dt(this.o===void 0,3512);const i=l=>{l.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,be("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(dt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=P2(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function tt(n,e){return n<e?-1:n>e?1:0}function ap(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const a=n.charAt(i),l=e.charAt(i);if(a!==l)return km(a)===km(l)?tt(a,l):km(a)?1:-1}return tt(n.length,e.length)}const k2=55296,V2=57343;function km(n){const e=n.charCodeAt(0);return e>=k2&&e<=V2}function Bo(n,e,t){return n.length===e.length&&n.every(((i,a)=>t(i,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="__name__";class Ks{constructor(e,t,i){t===void 0?t=0:t>e.length&&Le(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Le(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ks.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ks?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=Ks.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return tt(e.length,t.length)}static compareSegments(e,t){const i=Ks.isNumericId(e),a=Ks.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?Ks.extractNumericId(e).compare(Ks.extractNumericId(t)):ap(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Nr.fromString(e.substring(4,e.length-2))}}class Ct extends Ks{construct(e,t,i){return new Ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ce(de.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new Ct(t)}static emptyPath(){return new Ct([])}}const L2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Ks{construct(e,t,i){return new an(e,t,i)}static isValidIdentifier(e){return L2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IT}static keyField(){return new an([IT])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new Ce(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Ce(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ce(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(i+=f,a++):(l(),a++)}if(l(),u)throw new Ce(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.path=e}static fromPath(e){return new De(Ct.fromString(e))}static fromName(e){return new De(Ct.fromString(e).popFirst(5))}static empty(){return new De(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new Ct(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(n,e,t){if(!t)throw new Ce(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $E(n,e,t,i){if(e===!0&&i===!0)throw new Ce(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NT(n){if(!De.isDocumentKey(n))throw new Ce(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RT(n){if(De.isDocumentKey(n))throw new Ce(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function YE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Op(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Le(12329,{type:typeof n})}function Oi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Op(n);throw new Ce(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Du(n,e){if(!YE(n))throw new Ce(de.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(a&&typeof u!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Ce(de.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT=-62135596800,MT=1e6;class Et{static now(){return Et.fromMillis(Date.now())}static fromDate(e){return Et.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*MT);return new Et(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<DT)throw new Ce(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MT}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Du(e,Et._jsonSchema))return new Et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-DT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:Kt("string",Et._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new Et(0,0))}static max(){return new je(new Et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=-1;function U2(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,a=je.fromTimestamp(i===1e9?new Et(t+1,0):new Et(t,i));return new Dr(a,De.empty(),e)}function O2(n){return new Dr(n.readTime,n.key,bu)}class Dr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Dr(je.min(),De.empty(),bu)}static max(){return new Dr(je.max(),De.empty(),bu)}}function j2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=De.comparator(n.documentKey,e.documentKey),t!==0?t:tt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class q2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nl(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==F2)throw n;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.reject(t)}static resolve(e){return new ue(((t,i)=>{t(e)}))}static reject(e){return new ue(((t,i)=>{i(e)}))}static waitFor(e){return new ue(((t,i)=>{let a=0,l=0,u=!1;e.forEach((f=>{++a,f.next((()=>{++l,u&&l===a&&t()}),(g=>i(g)))})),u=!0,l===a&&t()}))}static or(e){let t=ue.resolve(!1);for(const i of e)t=t.next((a=>a?ue.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new ue(((i,a)=>{const l=e.length,u=new Array(l);let f=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((T=>{u[m]=T,++f,f===l&&i(u)}),(T=>a(T)))}}))}static doWhile(e,t){return new ue(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}function B2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}of.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=-1;function lf(n){return n==null}function Ld(n){return n===0&&1/n==-1/0}function z2(n){return typeof n=="number"&&Number.isInteger(n)&&!Ld(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="";function H2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PT(e)),e=G2(n.get(t),e);return PT(e)}function G2(n,e){let t=e;const i=n.length;for(let a=0;a<i;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case JE:t+="";break;default:t+=l}}return t}function PT(n){return n+JE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Na(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function KE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,t){this.comparator=e,this.root=t||mn.EMPTY}insert(e,t){return new Rt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new Rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fd(this.root,e,this.comparator,!1)}getReverseIterator(){return new fd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fd(this.root,e,this.comparator,!0)}}class fd{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??mn.RED,this.left=a??mn.EMPTY,this.right=l??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new mn(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return mn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Le(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw Le(57766)}get value(){throw Le(16141)}get color(){throw Le(16727)}get left(){throw Le(29726)}get right(){throw Le(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new mn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.comparator=e,this.data=new Rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VT(this.data.getIterator())}getIteratorFrom(e){return new VT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new en(this.comparator);return t.data=e,t}}class VT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new Es([])}unionWith(e){let t=new en(an.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bo(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new QE("Invalid base64 string: "+l):l}})(e);return new on(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new on(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}on.EMPTY_BYTE_STRING=new on("");const $2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(n){if(dt(!!n,39018),typeof n=="string"){let e=0;const t=$2.exec(n);if(dt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:jt(n.seconds),nanos:jt(n.nanos)}}function jt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Pr(n){return typeof n=="string"?on.fromBase64String(n):on.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE="server_timestamp",WE="__type__",ZE="__previous_value__",eb="__local_write_time__";function Fp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[WE])==null?void 0:i.stringValue)===XE}function uf(n){const e=n.mapValue.fields[ZE];return Fp(e)?uf(e):e}function Au(n){const e=Mr(n.mapValue.fields[eb].timestampValue);return new Et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,t,i,a,l,u,f,g,m,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=T}}const Ud="(default)";class zo{constructor(e,t){this.projectId=e,this.database=t||Ud}static empty(){return new zo("","")}get isDefaultDatabase(){return this.database===Ud}isEqual(e){return e instanceof zo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="__type__",J2="__max__",hd={mapValue:{}},nb="__vector__",Od="value";function kr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fp(n)?4:Q2(n)?9007199254740991:K2(n)?10:11:Le(28295,{value:n})}function ti(n,e){if(n===e)return!0;const t=kr(n);if(t!==kr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Au(n).isEqual(Au(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Mr(a.timestampValue),f=Mr(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Pr(a.bytesValue).isEqual(Pr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return jt(a.geoPointValue.latitude)===jt(l.geoPointValue.latitude)&&jt(a.geoPointValue.longitude)===jt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return jt(a.integerValue)===jt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=jt(a.doubleValue),f=jt(l.doubleValue);return u===f?Ld(u)===Ld(f):isNaN(u)&&isNaN(f)}return!1})(n,e);case 9:return Bo(n.arrayValue.values||[],e.arrayValue.values||[],ti);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},f=l.mapValue.fields||{};if(kT(u)!==kT(f))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(f[g]===void 0||!ti(u[g],f[g])))return!1;return!0})(n,e);default:return Le(52216,{left:n})}}function Su(n,e){return(n.values||[]).find((t=>ti(t,e)))!==void 0}function Ho(n,e){if(n===e)return 0;const t=kr(n),i=kr(e);if(t!==i)return tt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return tt(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=jt(l.integerValue||l.doubleValue),g=jt(u.integerValue||u.doubleValue);return f<g?-1:f>g?1:f===g?0:isNaN(f)?isNaN(g)?0:-1:1})(n,e);case 3:return LT(n.timestampValue,e.timestampValue);case 4:return LT(Au(n),Au(e));case 5:return ap(n.stringValue,e.stringValue);case 6:return(function(l,u){const f=Pr(l),g=Pr(u);return f.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),g=u.split("/");for(let m=0;m<f.length&&m<g.length;m++){const T=tt(f[m],g[m]);if(T!==0)return T}return tt(f.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=tt(jt(l.latitude),jt(u.latitude));return f!==0?f:tt(jt(l.longitude),jt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return UT(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var b,w,V,U;const f=l.fields||{},g=u.fields||{},m=(b=f[Od])==null?void 0:b.arrayValue,T=(w=g[Od])==null?void 0:w.arrayValue,x=tt(((V=m==null?void 0:m.values)==null?void 0:V.length)||0,((U=T==null?void 0:T.values)==null?void 0:U.length)||0);return x!==0?x:UT(m,T)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===hd.mapValue&&u===hd.mapValue)return 0;if(l===hd.mapValue)return 1;if(u===hd.mapValue)return-1;const f=l.fields||{},g=Object.keys(f),m=u.fields||{},T=Object.keys(m);g.sort(),T.sort();for(let x=0;x<g.length&&x<T.length;++x){const b=ap(g[x],T[x]);if(b!==0)return b;const w=Ho(f[g[x]],m[T[x]]);if(w!==0)return w}return tt(g.length,T.length)})(n.mapValue,e.mapValue);default:throw Le(23264,{he:t})}}function LT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tt(n,e);const t=Mr(n),i=Mr(e),a=tt(t.seconds,i.seconds);return a!==0?a:tt(t.nanos,i.nanos)}function UT(n,e){const t=n.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=Ho(t[a],i[a]);if(l)return l}return tt(t.length,i.length)}function Go(n){return op(n)}function op(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Mr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Pr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return De.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=op(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${op(t.fields[u])}`;return a+"}"})(n.mapValue):Le(61005,{value:n})}function Ed(n){switch(kr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=uf(n);return e?16+Ed(e):16;case 5:return 2*n.stringValue.length;case 6:return Pr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+Ed(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let a=0;return Na(i.fields,((l,u)=>{a+=l.length+Ed(u)})),a})(n.mapValue);default:throw Le(13486,{value:n})}}function lp(n){return!!n&&"integerValue"in n}function qp(n){return!!n&&"arrayValue"in n}function OT(n){return!!n&&"nullValue"in n}function jT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bd(n){return!!n&&"mapValue"in n}function K2(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[tb])==null?void 0:i.stringValue)===nb}function gu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Na(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gu(n.arrayValue.values[t]);return e}return{...n}}function Q2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===J2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.value=e}static empty(){return new os({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!bd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gu(t)}setAll(e){let t=an.emptyPath(),i={},a=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const g=this.getFieldsMap(t);this.applyChanges(g,i,a),i={},a=[],t=f.popLast()}u?i[f.lastSegment()]=gu(u):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ti(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];bd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){Na(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new os(gu(this.value))}}function sb(n){const e=[];return Na(n.fields,((t,i)=>{const a=new an([t]);if(bd(i)){const l=sb(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Es(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,t,i,a,l,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new vn(e,0,je.min(),je.min(),je.min(),os.empty(),0)}static newFoundDocument(e,t,i,a){return new vn(e,1,t,je.min(),i,a,0)}static newNoDocument(e,t){return new vn(e,2,t,je.min(),je.min(),os.empty(),0)}static newUnknownDocument(e,t){return new vn(e,3,t,je.min(),je.min(),os.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=os.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=os.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,t){this.position=e,this.inclusive=t}}function FT(n,e,t){let i=0;for(let a=0;a<n.position.length;a++){const l=e[a],u=n.position[a];if(l.field.isKeyField()?i=De.comparator(De.fromName(u.referenceValue),t.key):i=Ho(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function qT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ti(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t="asc"){this.field=e,this.dir=t}}function X2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{}class Zt extends ib{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Z2(e,t,i):t==="array-contains"?new nP(e,i):t==="in"?new sP(e,i):t==="not-in"?new iP(e,i):t==="array-contains-any"?new rP(e,i):new Zt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new eP(e,i):new tP(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ho(t,this.value)):t!==null&&kr(this.value)===kr(t)&&this.matchesComparison(Ho(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ni extends ib{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ni(e,t)}matches(e){return rb(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rb(n){return n.op==="and"}function ab(n){return W2(n)&&rb(n)}function W2(n){for(const e of n.filters)if(e instanceof ni)return!1;return!0}function up(n){if(n instanceof Zt)return n.field.canonicalString()+n.op.toString()+Go(n.value);if(ab(n))return n.filters.map((e=>up(e))).join(",");{const e=n.filters.map((t=>up(t))).join(",");return`${n.op}(${e})`}}function ob(n,e){return n instanceof Zt?(function(i,a){return a instanceof Zt&&i.op===a.op&&i.field.isEqual(a.field)&&ti(i.value,a.value)})(n,e):n instanceof ni?(function(i,a){return a instanceof ni&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,f)=>l&&ob(u,a.filters[f])),!0):!1})(n,e):void Le(19439)}function lb(n){return n instanceof Zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Go(t.value)}`})(n):n instanceof ni?(function(t){return t.op.toString()+" {"+t.getFilters().map(lb).join(" ,")+"}"})(n):"Filter"}class Z2 extends Zt{constructor(e,t,i){super(e,t,i),this.key=De.fromName(i.referenceValue)}matches(e){const t=De.comparator(e.key,this.key);return this.matchesComparison(t)}}class eP extends Zt{constructor(e,t){super(e,"in",t),this.keys=ub("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class tP extends Zt{constructor(e,t){super(e,"not-in",t),this.keys=ub("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ub(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>De.fromName(i.referenceValue)))}class nP extends Zt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qp(t)&&Su(t.arrayValue,this.value)}}class sP extends Zt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Su(this.value.arrayValue,t)}}class iP extends Zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Su(this.value.arrayValue,t)}}class rP extends Zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Su(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,t=null,i=[],a=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function BT(n,e=null,t=[],i=[],a=null,l=null,u=null){return new aP(n,e,t,i,a,l,u)}function Bp(n){const e=qe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>up(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Go(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Go(i))).join(",")),e.Te=t}return e.Te}function zp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!X2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ob(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qT(n.startAt,e.startAt)&&qT(n.endAt,e.endAt)}function cp(n){return De.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t=null,i=[],a=[],l=null,u="F",f=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function oP(n,e,t,i,a,l,u,f){return new cf(n,e,t,i,a,l,u,f)}function Hp(n){return new cf(n)}function zT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lP(n){return n.collectionGroup!==null}function yu(n){const e=qe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new en(an.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(f=f.add(m.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Fd(l,i))})),t.has(an.keyField().canonicalString())||e.Ie.push(new Fd(an.keyField(),i))}return e.Ie}function Qs(n){const e=qe(n);return e.Ee||(e.Ee=uP(e,yu(n))),e.Ee}function uP(n,e){if(n.limitType==="F")return BT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Fd(a.field,l)}));const t=n.endAt?new jd(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new jd(n.startAt.position,n.startAt.inclusive):null;return BT(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function dp(n,e,t){return new cf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function df(n,e){return zp(Qs(n),Qs(e))&&n.limitType===e.limitType}function cb(n){return`${Bp(Qs(n))}|lt:${n.limitType}`}function Co(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>lb(a))).join(", ")}]`),lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>Go(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>Go(a))).join(",")),`Target(${i})`})(Qs(n))}; limitType=${n.limitType})`}function ff(n,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):De.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,a){for(const l of yu(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(i,a){return!(i.startAt&&!(function(u,f,g){const m=FT(u,f,g);return u.inclusive?m<=0:m<0})(i.startAt,yu(i),a)||i.endAt&&!(function(u,f,g){const m=FT(u,f,g);return u.inclusive?m>=0:m>0})(i.endAt,yu(i),a))})(n,e)}function cP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function db(n){return(e,t)=>{let i=!1;for(const a of yu(n)){const l=dP(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function dP(n,e,t){const i=n.field.isKeyField()?De.comparator(e.key,t.key):(function(l,u,f){const g=u.data.field(l),m=f.data.field(l);return g!==null&&m!==null?Ho(g,m):Le(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Le(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Na(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return KE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=new Rt(De.comparator);function ji(){return fP}const fb=new Rt(De.comparator);function fu(...n){let e=fb;for(const t of n)e=e.insert(t.key,t);return e}function hb(n){let e=fb;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function _a(){return vu()}function mb(){return vu()}function vu(){return new Ra((n=>n.toString()),((n,e)=>n.isEqual(e)))}const hP=new Rt(De.comparator),mP=new en(De.comparator);function nt(...n){let e=mP;for(const t of n)e=e.add(t);return e}const pP=new en(tt);function gP(){return pP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ld(e)?"-0":e}}function pb(n){return{integerValue:""+n}}function yP(n,e){return z2(e)?pb(e):Gp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(){this._=void 0}}function vP(n,e,t){return n instanceof qd?(function(a,l){const u={fields:{[WE]:{stringValue:XE},[eb]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Fp(l)&&(l=uf(l)),l&&(u.fields[ZE]=l),{mapValue:u}})(t,e):n instanceof Cu?yb(n,e):n instanceof wu?vb(n,e):(function(a,l){const u=gb(a,l),f=HT(u)+HT(a.Ae);return lp(u)&&lp(a.Ae)?pb(f):Gp(a.serializer,f)})(n,e)}function _P(n,e,t){return n instanceof Cu?yb(n,e):n instanceof wu?vb(n,e):t}function gb(n,e){return n instanceof Bd?(function(i){return lp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class qd extends hf{}class Cu extends hf{constructor(e){super(),this.elements=e}}function yb(n,e){const t=_b(e);for(const i of n.elements)t.some((a=>ti(a,i)))||t.push(i);return{arrayValue:{values:t}}}class wu extends hf{constructor(e){super(),this.elements=e}}function vb(n,e){let t=_b(e);for(const i of n.elements)t=t.filter((a=>!ti(a,i)));return{arrayValue:{values:t}}}class Bd extends hf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function HT(n){return jt(n.integerValue||n.doubleValue)}function _b(n){return qp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function TP(n,e){return n.field.isEqual(e.field)&&(function(i,a){return i instanceof Cu&&a instanceof Cu||i instanceof wu&&a instanceof wu?Bo(i.elements,a.elements,ti):i instanceof Bd&&a instanceof Bd?ti(i.Ae,a.Ae):i instanceof qd&&a instanceof qd})(n.transform,e.transform)}class xP{constructor(e,t){this.version=e,this.transformResults=t}}class Xs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xs}static exists(e){return new Xs(void 0,e)}static updateTime(e){return new Xs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ad(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class mf{}function Tb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $p(n.key,Xs.none()):new Mu(n.key,n.data,Xs.none());{const t=n.data,i=os.empty();let a=new en(an.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new Da(n.key,i,new Es(a.toArray()),Xs.none())}}function EP(n,e,t){n instanceof Mu?(function(a,l,u){const f=a.value.clone(),g=$T(a.fieldTransforms,l,u.transformResults);f.setAll(g),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):n instanceof Da?(function(a,l,u){if(!Ad(a.precondition,l))return void l.convertToUnknownDocument(u.version);const f=$T(a.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(xb(a)),g.setAll(f),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function _u(n,e,t,i){return n instanceof Mu?(function(l,u,f,g){if(!Ad(l.precondition,u))return f;const m=l.value.clone(),T=YT(l.fieldTransforms,g,u);return m.setAll(T),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Da?(function(l,u,f,g){if(!Ad(l.precondition,u))return f;const m=YT(l.fieldTransforms,g,u),T=u.data;return T.setAll(xb(l)),T.setAll(m),u.convertToFoundDocument(u.version,T).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((x=>x.field)))})(n,e,t,i):(function(l,u,f){return Ad(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(n,e,t)}function bP(n,e){let t=null;for(const i of n.fieldTransforms){const a=e.data.field(i.field),l=gb(i.transform,a||null);l!=null&&(t===null&&(t=os.empty()),t.set(i.field,l))}return t||null}function GT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Bo(i,a,((l,u)=>TP(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mu extends mf{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Da extends mf{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function xb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function $T(n,e,t){const i=new Map;dt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let a=0;a<t.length;a++){const l=n[a],u=l.transform,f=e.data.field(l.field);i.set(l.field,_P(u,f,t[a]))}return i}function YT(n,e,t){const i=new Map;for(const a of n){const l=a.transform,u=t.data.field(a.field);i.set(a.field,vP(l,u,e))}return i}class $p extends mf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AP extends mf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&EP(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_u(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_u(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=mb();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=t.has(a.key)?null:f;const g=Tb(u,f);g!==null&&i.set(a.key,g),u.isValidDocument()||u.convertToNoDocument(je.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),nt())}isEqual(e){return this.batchId===e.batchId&&Bo(this.mutations,e.mutations,((t,i)=>GT(t,i)))&&Bo(this.baseMutations,e.baseMutations,((t,i)=>GT(t,i)))}}class Yp{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){dt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return hP})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new Yp(e,t,i,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,it;function IP(n){switch(n){case de.OK:return Le(64938);case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0;default:return Le(15467,{code:n})}}function Eb(n){if(n===void 0)return Ui("GRPC error has no .code"),de.UNKNOWN;switch(n){case Jt.OK:return de.OK;case Jt.CANCELLED:return de.CANCELLED;case Jt.UNKNOWN:return de.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return de.INTERNAL;case Jt.UNAVAILABLE:return de.UNAVAILABLE;case Jt.UNAUTHENTICATED:return de.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case Jt.NOT_FOUND:return de.NOT_FOUND;case Jt.ALREADY_EXISTS:return de.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return de.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case Jt.ABORTED:return de.ABORTED;case Jt.OUT_OF_RANGE:return de.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return de.UNIMPLEMENTED;case Jt.DATA_LOSS:return de.DATA_LOSS;default:return Le(39323,{code:n})}}(it=Jt||(Jt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new Nr([4294967295,4294967295],0);function JT(n){const e=NP().encode(n),t=new LE;return t.update(e),new Uint8Array(t.digest())}function KT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Nr([t,i],0),new Nr([a,l],0)]}class Jp{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new hu(`Invalid padding: ${t}`);if(i<0)throw new hu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new hu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new hu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Nr.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply(Nr.fromNumber(i)));return a.compare(RP)===1&&(a=new Nr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=JT(e),[i,a]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Jp(l,a,t);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const t=JT(e),[i,a]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new pf(je.min(),a,new Rt(tt),ji(),nt())}}class Pu{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Pu(i,t,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,t,i,a){this.be=e,this.removedTargetIds=t,this.key=i,this.De=a}}class bb{constructor(e,t){this.targetId=e,this.Ce=t}}class Ab{constructor(e,t,i=on.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class QT{constructor(){this.ve=0,this.Fe=XT(),this.Me=on.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:Le(38017,{changeType:l})}})),new Pu(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=XT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,dt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class DP{constructor(e){this.Ge=e,this.ze=new Map,this.je=ji(),this.Je=md(),this.He=md(),this.Ye=new Rt(tt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Le(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(cp(l))if(i===0){const u=new De(l.path);this.et(t,u,vn.newNoDocument(u,je.min()))}else dt(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const f=this.ut(e),g=f?this.ct(f,e,u):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let u,f;try{u=Pr(i).toUint8Array()}catch(g){if(g instanceof QE)return Sa("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{f=new Jp(u,a,l)}catch(g){return Sa(g instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&cp(f.target)){const g=new De(f.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,vn.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let i=nt();this.He.forEach(((l,u)=>{let f=!0;u.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new pf(e,t,this.Ye,this.je,i);return this.je=ji(),this.Je=md(),this.He=md(),this.Ye=new Rt(tt),a}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new QT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new en(tt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new en(tt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||be("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new QT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function md(){return new Rt(De.comparator)}function XT(){return new Rt(De.comparator)}const MP={asc:"ASCENDING",desc:"DESCENDING"},PP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kP={and:"AND",or:"OR"};class VP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fp(n,e){return n.useProto3Json||lf(e)?e:{value:e}}function zd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function LP(n,e){return zd(n,e.toTimestamp())}function Ws(n){return dt(!!n,49232),je.fromTimestamp((function(t){const i=Mr(t);return new Et(i.seconds,i.nanos)})(n))}function Kp(n,e){return hp(n,e).canonicalString()}function hp(n,e){const t=(function(a){return new Ct(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Cb(n){const e=Ct.fromString(n);return dt(Db(e),10190,{key:e.toString()}),e}function mp(n,e){return Kp(n.databaseId,e.path)}function Vm(n,e){const t=Cb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new De(Ib(t))}function wb(n,e){return Kp(n.databaseId,e)}function UP(n){const e=Cb(n);return e.length===4?Ct.emptyPath():Ib(e)}function pp(n){return new Ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ib(n){return dt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function WT(n,e,t){return{name:mp(n,e),fields:t.value.mapValue.fields}}function OP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Le(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,T){return m.useProto3Json?(dt(T===void 0||typeof T=="string",58123),on.fromBase64String(T||"")):(dt(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),on.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(m){const T=m.code===void 0?de.UNKNOWN:Eb(m.code);return new Ce(T,m.message||"")})(u);t=new Ab(i,a,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Vm(n,i.document.name),l=Ws(i.document.updateTime),u=i.document.createTime?Ws(i.document.createTime):je.min(),f=new os({mapValue:{fields:i.document.fields}}),g=vn.newFoundDocument(a,l,u,f),m=i.targetIds||[],T=i.removedTargetIds||[];t=new Sd(m,T,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Vm(n,i.document),l=i.readTime?Ws(i.readTime):je.min(),u=vn.newNoDocument(a,l),f=i.removedTargetIds||[];t=new Sd([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Vm(n,i.document),l=i.removedTargetIds||[];t=new Sd([],l,a,null)}else{if(!("filter"in e))return Le(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new wP(a,l),f=i.targetId;t=new bb(f,u)}}return t}function jP(n,e){let t;if(e instanceof Mu)t={update:WT(n,e.key,e.value)};else if(e instanceof $p)t={delete:mp(n,e.key)};else if(e instanceof Da)t={update:WT(n,e.key,e.data),updateMask:JP(e.fieldMask)};else{if(!(e instanceof AP))return Le(16599,{Vt:e.type});t={verify:mp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof qd)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Cu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof wu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Bd)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw Le(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:LP(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Le(27497)})(n,e.precondition)),t}function FP(n,e){return n&&n.length>0?(dt(e!==void 0,14353),n.map((t=>(function(a,l){let u=a.updateTime?Ws(a.updateTime):Ws(l);return u.isEqual(je.min())&&(u=Ws(l)),new xP(u,a.transformResults||[])})(t,e)))):[]}function qP(n,e){return{documents:[wb(n,e.path)]}}function BP(n,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=wb(n,a);const l=(function(m){if(m.length!==0)return Rb(ni.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((T=>(function(b){return{field:wo(b.field),direction:GP(b.dir)}})(T)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=fp(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function zP(n){let e=UP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){dt(i===1,65062);const T=t.from[0];T.allDescendants?a=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(x){const b=Nb(x);return b instanceof ni&&ab(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((b=>(function(V){return new Fd(Io(V.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(b)))})(t.orderBy));let f=null;t.limit&&(f=(function(x){let b;return b=typeof x=="object"?x.value:x,lf(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(x){const b=!!x.before,w=x.values||[];return new jd(w,b)})(t.startAt));let m=null;return t.endAt&&(m=(function(x){const b=!x.before,w=x.values||[];return new jd(w,b)})(t.endAt)),oP(e,a,u,l,f,"F",g,m)}function HP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Nb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Io(t.unaryFilter.field);return Zt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Io(t.unaryFilter.field);return Zt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Io(t.unaryFilter.field);return Zt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Io(t.unaryFilter.field);return Zt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Le(61313);default:return Le(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Zt.create(Io(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Le(58110);default:return Le(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ni.create(t.compositeFilter.filters.map((i=>Nb(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Le(1026)}})(t.compositeFilter.op))})(n):Le(30097,{filter:n})}function GP(n){return MP[n]}function $P(n){return PP[n]}function YP(n){return kP[n]}function wo(n){return{fieldPath:n.canonicalString()}}function Io(n){return an.fromServerFormat(n.fieldPath)}function Rb(n){return n instanceof Zt?(function(t){if(t.op==="=="){if(jT(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NAN"}};if(OT(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jT(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NOT_NAN"}};if(OT(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wo(t.field),op:$P(t.op),value:t.value}}})(n):n instanceof ni?(function(t){const i=t.getFilters().map((a=>Rb(a)));return i.length===1?i[0]:{compositeFilter:{op:YP(t.op),filters:i}}})(n):Le(54877,{filter:n})}function JP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Db(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,t,i,a,l=je.min(),u=je.min(),f=on.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=g}withSequenceNumber(e){return new Sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.yt=e}}function QP(n){const e=zP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.Cn=new WP}addToCollectionParentIndex(e,t){return this.Cn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Dr.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Dr.min())}updateCollectionGroup(e,t,i){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class WP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new en(Ct.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new en(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mb=41943040;class Vn{static withCacheSize(e){return new Vn(e,Vn.DEFAULT_COLLECTION_PERCENTILE,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vn.DEFAULT_COLLECTION_PERCENTILE=10,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vn.DEFAULT=new Vn(Mb,Vn.DEFAULT_COLLECTION_PERCENTILE,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vn.DISABLED=new Vn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $o(0)}static cr(){return new $o(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="LruGarbageCollector",ZP=1048576;function tx([n,e],[t,i]){const a=tt(n,t);return a===0?tt(e,i):a}class ek{constructor(e){this.Ir=e,this.buffer=new en(tx),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class tk{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){be(ex,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sl(t)?be(ex,"Ignoring IndexedDB error during garbage collection: ",t):await nl(t)}await this.Vr(3e5)}))}}class nk{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(of.ce);const i=new ek(t);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(be("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(ZT)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,a,l,u,f,g,m;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,u=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(i=x,f=Date.now(),this.removeTargets(e,i,t)))).next((x=>(l=x,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((x=>(m=Date.now(),So()<=et.DEBUG&&be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-T}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${l} targets in `+(g-f)+`ms
	Removed ${x} documents in `+(m-g)+`ms
Total Duration: ${m-T}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:x}))))}}function sk(n,e){return new nk(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this.changes=new Ra((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,vn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ue.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&_u(i.mutation,a,Es.empty(),Et.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,nt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=nt()){const a=_a();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let u=fu();return l.forEach(((f,g)=>{u=u.insert(f,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=_a();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,nt())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,i,a){let l=ji();const u=vu(),f=(function(){return vu()})();return t.forEach(((g,m)=>{const T=i.get(m.key);a.has(m.key)&&(T===void 0||T.mutation instanceof Da)?l=l.insert(m.key,m):T!==void 0?(u.set(m.key,T.mutation.getFieldMask()),_u(T.mutation,m,T.mutation.getFieldMask(),Et.now())):u.set(m.key,Es.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,T)=>u.set(m,T))),t.forEach(((m,T)=>f.set(m,new rk(T,u.get(m)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=vu();let a=new Rt(((u,f)=>u-f)),l=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let T=i.get(g)||Es.empty();T=f.applyToLocalView(m,T),i.set(g,T);const x=(a.get(f.batchId)||nt()).add(g);a=a.insert(f.batchId,x)}))})).next((()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const g=f.getNext(),m=g.key,T=g.value,x=mb();T.forEach((b=>{if(!l.has(b)){const w=Tb(t.get(b),i.get(b));w!==null&&x.set(b,w),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,x))}return ue.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return(function(u){return De.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):ue.resolve(_a());let f=bu,g=l;return u.next((m=>ue.forEach(m,((T,x)=>(f<x.largestBatchId&&(f=x.largestBatchId),l.get(T)?ue.resolve():this.remoteDocumentCache.getEntry(e,T).next((b=>{g=g.insert(T,b)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,nt()))).next((T=>({batchId:f,changes:hb(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new De(t)).next((i=>{let a=fu();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let u=fu();return this.indexManager.getCollectionParents(e,l).next((f=>ue.forEach(f,(g=>{const m=(function(x,b){return new cf(b,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,a).next((T=>{T.forEach(((x,b)=>{u=u.insert(x,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((u=>{l.forEach(((g,m)=>{const T=m.getKey();u.get(T)===null&&(u=u.insert(T,vn.newInvalidDocument(T)))}));let f=fu();return u.forEach(((g,m)=>{const T=l.get(g);T!==void 0&&_u(T.mutation,m,Es.empty(),Et.now()),ff(t,m)&&(f=f.insert(g,m))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ue.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Ws(a.createTime)}})(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:QP(a.bundledQuery),readTime:Ws(a.readTime)}})(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(){this.overlays=new Rt(De.comparator),this.qr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const i=_a();return ue.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.St(e,t,l)})),ue.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ue.resolve()}getOverlaysForCollection(e,t,i){const a=_a(),l=t.length+1,u=new De(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const g=f.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&a.set(g.getKey(),g)}return ue.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new Rt(((m,T)=>m-T));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let T=l.get(m.largestBatchId);T===null&&(T=_a(),l=l.insert(m.largestBatchId,T)),T.set(m.getKey(),m)}}const f=_a(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,T)=>f.set(m,T))),!(f.size()>=a)););return ue.resolve(f)}St(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new CP(t,i));let l=this.qr.get(t);l===void 0&&(l=nt(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.Qr=new en(rn.$r),this.Ur=new en(rn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new rn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new rn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new De(new Ct([])),i=new rn(t,e),a=new rn(t,e+1),l=[];return this.Ur.forEachInRange([i,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new De(new Ct([])),i=new rn(t,e),a=new rn(t,e+1);let l=nt();return this.Ur.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new rn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class rn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return De.comparator(e.key,t.key)||tt(e.Yr,t.Yr)}static Kr(e,t){return tt(e.Yr,t.Yr)||De.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new en(rn.$r)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new SP(l,t,i,a);this.mutationQueue.push(u);for(const f of a)this.Zr=this.Zr.add(new rn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ue.resolve(u)}lookupMutationBatch(e,t){return ue.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.ei(i),l=a<0?0:a;return ue.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?jp:this.tr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new rn(t,0),a=new rn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(u=>{const f=this.Xr(u.Yr);l.push(f)})),ue.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new en(tt);return t.forEach((a=>{const l=new rn(a,0),u=new rn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(f=>{i=i.add(f.Yr)}))})),ue.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;De.isDocumentKey(l)||(l=l.child(""));const u=new rn(new De(l),0);let f=new en(tt);return this.Zr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===a&&(f=f.add(g.Yr)),!0)}),u),ue.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){dt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ue.forEach(t.mutations,(a=>{const l=new rn(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new rn(t,0),a=this.Zr.firstAfterOrEqual(i);return ue.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.ri=e,this.docs=(function(){return new Rt(De.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ue.resolve(i?i.document.mutableCopy():vn.newInvalidDocument(t))}getEntries(e,t){let i=ji();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():vn.newInvalidDocument(a))})),ue.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=ji();const u=t.path,f=new De(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(f);for(;g.hasNext();){const{key:m,value:{document:T}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||j2(O2(T),i)<=0||(a.has(T.key)||ff(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return ue.resolve(l)}getAllFromCollectionGroup(e,t,i,a){Le(9500)}ii(e,t){return ue.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new fk(this)}getSize(e){return ue.resolve(this.size)}}class fk extends ik{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ue.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e){this.persistence=e,this.si=new Ra((t=>Bp(t)),zp),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.oi=0,this._i=new Qp,this.targetCount=0,this.ai=$o.ur()}forEachTarget(e,t){return this.si.forEach(((i,a)=>t(a))),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),ue.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new $o(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Pr(t),ue.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ue.waitFor(l).next((()=>a))}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return ue.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),ue.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),ue.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return ue.resolve(i)}containsKey(e,t){return ue.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t){this.ui={},this.overlays={},this.ci=new of(0),this.li=!1,this.li=!0,this.hi=new uk,this.referenceDelegate=e(this),this.Pi=new hk(this),this.indexManager=new XP,this.remoteDocumentCache=(function(a){return new dk(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new KP(t),this.Ii=new ok(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new ck(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){be("MemoryPersistence","Starting transaction:",e);const a=new mk(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,t){return ue.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class mk extends q2{constructor(e){super(),this.currentSequenceNumber=e}}class Xp{constructor(e){this.persistence=e,this.Ri=new Qp,this.Vi=null}static mi(e){return new Xp(e)}get fi(){if(this.Vi)return this.Vi;throw Le(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),ue.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.fi,(i=>{const a=De.fromPath(i);return this.gi(e,a).next((l=>{l||t.removeEntry(a,je.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ue.or([()=>ue.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Hd{constructor(e,t){this.persistence=e,this.pi=new Ra((i=>H2(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=sk(this,t)}static mi(e,t){return new Hd(e,t)}Ei(){}di(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return ue.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ue.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,t).next((f=>{f||(i++,l.removeEntry(u,je.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ed(e.data.value)),t}br(e,t,i){return ue.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return ue.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=a}static As(e,t){let i=nt(),a=nt();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Wp(e,t.fromCache,i,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return lM()?8:B2(Tn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new pk;return this.Ss(e,t,u).next((f=>{if(l.result=f,this.Vs)return this.bs(e,t,u,f.size)}))})).next((()=>l.result))}bs(e,t,i,a){return i.documentReadCount<this.fs?(So()<=et.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",Co(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ue.resolve()):(So()<=et.DEBUG&&be("QueryEngine","Query:",Co(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(So()<=et.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",Co(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):ue.resolve())}ys(e,t){if(zT(t))return ue.resolve(null);let i=Qs(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=dp(t,null,"F"),i=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=nt(...l);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.Ds(t,f);return this.Cs(t,m,u,g.readTime)?this.ys(e,dp(t,null,"F")):this.vs(e,m,t,g)}))))})))))}ws(e,t,i,a){return zT(t)||a.isEqual(je.min())?ue.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,i,a)?ue.resolve(null):(So()<=et.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Co(t)),this.vs(e,u,t,U2(a,bu)).next((f=>f)))}))}Ds(e,t){let i=new en(db(e));return t.forEach(((a,l)=>{ff(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,i){return So()<=et.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",Co(t)),this.ps.getDocumentsMatchingQuery(e,t,Dr.min(),i)}vs(e,t,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="LocalStore",yk=3e8;class vk{constructor(e,t,i,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new Rt(tt),this.xs=new Ra((l=>Bp(l)),zp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ak(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function _k(n,e,t,i){return new vk(n,e,t,i)}async function kb(n,e){const t=qe(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let g=nt();for(const m of a){u.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}for(const m of l){f.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ls:m,removedBatchIds:u,addedBatchIds:f})))}))}))}function Tk(n,e){const t=qe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,g,m,T){const x=m.batch,b=x.keys();let w=ue.resolve();return b.forEach((V=>{w=w.next((()=>T.getEntry(g,V))).next((U=>{const L=m.docVersions.get(V);dt(L!==null,48541),U.version.compareTo(L)<0&&(x.applyToRemoteDocument(U,m),U.isValidDocument()&&(U.setReadTime(m.commitVersion),T.addEntry(U)))}))})),w.next((()=>f.mutationQueue.removeMutationBatch(g,x)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let g=nt();for(let m=0;m<f.mutationResults.length;++m)f.mutationResults[m].transformResults.length>0&&(g=g.add(f.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function Vb(n){const e=qe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function xk(n,e){const t=qe(n),i=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const f=[];e.targetChanges.forEach(((T,x)=>{const b=a.get(x);if(!b)return;f.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,x).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,x))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(x)!==null?w=w.withResumeToken(on.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):T.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(T.resumeToken,i)),a=a.insert(x,w),(function(U,L,G){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=yk?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0})(b,w,T)&&f.push(t.Pi.updateTargetData(l,w))}));let g=ji(),m=nt();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),f.push(Ek(l,u,e.documentUpdates).next((T=>{g=T.ks,m=T.qs}))),!i.isEqual(je.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((x=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(T)}return ue.waitFor(f).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.Ms=a,l)))}function Ek(n,e,t){let i=nt(),a=nt();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=ji();return t.forEach(((f,g)=>{const m=l.get(f);g.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(f)),g.isNoDocument()&&g.version.isEqual(je.min())?(e.removeEntry(f,g.readTime),u=u.insert(f,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(f,g)):be(Zp,"Ignoring outdated watch update for ",f,". Current version:",m.version," Watch version:",g.version)})),{ks:u,qs:a}}))}function bk(n,e){const t=qe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=jp),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Ak(n,e){const t=qe(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.Pi.getTargetData(i,e).next((l=>l?(a=l,ue.resolve(a)):t.Pi.allocateTargetId(i).next((u=>(a=new Sr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function gp(n,e,t){const i=qe(n),a=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!sl(u))throw u;be(Zp,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function nx(n,e,t){const i=qe(n);let a=je.min(),l=nt();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,m,T){const x=qe(g),b=x.xs.get(T);return b!==void 0?ue.resolve(x.Ms.get(b)):x.Pi.getTargetData(m,T)})(i,u,Qs(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?a:je.min(),t?l:nt()))).next((f=>(Sk(i,cP(e),f),{documents:f,Qs:l})))))}function Sk(n,e,t){let i=n.Os.get(e)||je.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class sx{constructor(){this.activeTargetIds=gP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ck{constructor(){this.Mo=new sx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new sx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="ConnectivityMonitor";class rx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){be(ix,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){be(ix,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd=null;function yp(){return pd===null?pd=(function(){return 268435456+Math.round(2147483648*Math.random())})():pd++,"0x"+pd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="RestConnection",Ik={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Nk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===Ud?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,t,i,a,l){const u=yp(),f=this.zo(e,t.toUriEncodedString());be(Lm,`Sending RPC '${e}' ${u}:`,f,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,a,l);const{host:m}=new URL(f),T=Zo(m);return this.Jo(e,f,g,i,T).then((x=>(be(Lm,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw Sa(Lm,`RPC '${e}' ${u} failed with error: `,x,"url: ",f,"request:",i),x}))}Ho(e,t,i,a,l,u){return this.Go(e,t,i,a,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+tl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,t){const i=Ik[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="WebChannelConnection";class Dk extends Nk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,a,l){const u=yp();return new Promise(((f,g)=>{const m=new UE;m.setWithCredentials(!0),m.listenOnce(OE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case xd.NO_ERROR:const x=m.getResponseJson();be(gn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),f(x);break;case xd.TIMEOUT:be(gn,`RPC '${e}' ${u} timed out`),g(new Ce(de.DEADLINE_EXCEEDED,"Request time out"));break;case xd.HTTP_ERROR:const b=m.getStatus();if(be(gn,`RPC '${e}' ${u} failed with status:`,b,"response text:",m.getResponseText()),b>0){let w=m.getResponseJson();Array.isArray(w)&&(w=w[0]);const V=w==null?void 0:w.error;if(V&&V.status&&V.message){const U=(function(G){const W=G.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(W)>=0?W:de.UNKNOWN})(V.status);g(new Ce(U,V.message))}else g(new Ce(de.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new Ce(de.UNAVAILABLE,"Connection failed."));break;default:Le(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{be(gn,`RPC '${e}' ${u} completed.`)}}));const T=JSON.stringify(a);be(gn,`RPC '${e}' ${u} sending request:`,a),m.send(t,"POST",T,i,15)}))}T_(e,t,i){const a=yp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=qE(),f=FE(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(g.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const T=l.join("");be(gn,`Creating RPC '${e}' stream ${a}: ${T}`,g);const x=u.createWebChannel(T,g);this.I_(x);let b=!1,w=!1;const V=new Rk({Yo:L=>{w?be(gn,`Not sending because RPC '${e}' stream ${a} is closed:`,L):(b||(be(gn,`Opening RPC '${e}' stream ${a} transport.`),x.open(),b=!0),be(gn,`RPC '${e}' stream ${a} sending:`,L),x.send(L))},Zo:()=>x.close()}),U=(L,G,W)=>{L.listen(G,(ee=>{try{W(ee)}catch(F){setTimeout((()=>{throw F}),0)}}))};return U(x,du.EventType.OPEN,(()=>{w||(be(gn,`RPC '${e}' stream ${a} transport opened.`),V.o_())})),U(x,du.EventType.CLOSE,(()=>{w||(w=!0,be(gn,`RPC '${e}' stream ${a} transport closed`),V.a_(),this.E_(x))})),U(x,du.EventType.ERROR,(L=>{w||(w=!0,Sa(gn,`RPC '${e}' stream ${a} transport errored. Name:`,L.name,"Message:",L.message),V.a_(new Ce(de.UNAVAILABLE,"The operation could not be completed")))})),U(x,du.EventType.MESSAGE,(L=>{var G;if(!w){const W=L.data[0];dt(!!W,16349);const ee=W,F=(ee==null?void 0:ee.error)||((G=ee[0])==null?void 0:G.error);if(F){be(gn,`RPC '${e}' stream ${a} received error:`,F);const Q=F.status;let H=(function(D){const N=Jt[D];if(N!==void 0)return Eb(N)})(Q),R=F.message;H===void 0&&(H=de.INTERNAL,R="Unknown error status: "+Q+" with message "+F.message),w=!0,V.a_(new Ce(H,R)),x.close()}else be(gn,`RPC '${e}' stream ${a} received:`,W),V.u_(W)}})),U(f,jE.STAT_EVENT,(L=>{L.stat===rp.PROXY?be(gn,`RPC '${e}' stream ${a} detected buffering proxy`):L.stat===rp.NOPROXY&&be(gn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{V.__()}),0),V}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Um(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(n){return new VP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&be("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ax="PersistentStream";class Ub{constructor(e,t,i,a,l,u,f,g){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Lb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(Ui(t.toString()),Ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new Ce(de.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return be(ax,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(be(ax,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Mk extends Ub{constructor(e,t,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=OP(this.serializer,e),i=(function(l){if(!("targetChange"in l))return je.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?je.min():u.readTime?Ws(u.readTime):je.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=pp(this.serializer),t.addTarget=(function(l,u){let f;const g=u.target;if(f=cp(g)?{documents:qP(l,g)}:{query:BP(l,g).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=Sb(l,u.resumeToken);const m=fp(l,u.expectedCount);m!==null&&(f.expectedCount=m)}else if(u.snapshotVersion.compareTo(je.min())>0){f.readTime=zd(l,u.snapshotVersion.toTimestamp());const m=fp(l,u.expectedCount);m!==null&&(f.expectedCount=m)}return f})(this.serializer,e);const i=HP(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=pp(this.serializer),t.removeTarget=e,this.q_(t)}}class Pk extends Ub{constructor(e,t,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return dt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,dt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){dt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=FP(e.writeResults,e.commitTime),i=Ws(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=pp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>jP(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{}class Vk extends kk{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Ce(de.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,hp(t,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ce(de.UNKNOWN,l.toString())}))}Ho(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,hp(t,i),a,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(de.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Lk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ui(t),this.aa=!1):be("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca="RemoteStore";class Uk{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Ma(this)&&(be(Ca,"Restarting streams for network reachability change."),await(async function(g){const m=qe(g);m.Ea.add(4),await ku(m),m.Ra.set("Unknown"),m.Ea.delete(4),await yf(m)})(this))}))})),this.Ra=new Lk(i,a)}}async function yf(n){if(Ma(n))for(const e of n.da)await e(!0)}async function ku(n){for(const e of n.da)await e(!1)}function Ob(n,e){const t=qe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sg(t)?ng(t):il(t).O_()&&tg(t,e))}function eg(n,e){const t=qe(n),i=il(t);t.Ia.delete(e),i.O_()&&jb(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ma(t)&&t.Ra.set("Unknown"))}function tg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}il(n).Y_(e)}function jb(n,e){n.Va.Ue(e),il(n).Z_(e)}function ng(n){n.Va=new DP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),il(n).start(),n.Ra.ua()}function sg(n){return Ma(n)&&!il(n).x_()&&n.Ia.size>0}function Ma(n){return qe(n).Ea.size===0}function Fb(n){n.Va=void 0}async function Ok(n){n.Ra.set("Online")}async function jk(n){n.Ia.forEach(((e,t)=>{tg(n,e)}))}async function Fk(n,e){Fb(n),sg(n)?(n.Ra.ha(e),ng(n)):n.Ra.set("Unknown")}async function qk(n,e,t){if(n.Ra.set("Online"),e instanceof Ab&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ia.delete(f),a.Va.removeTarget(f))})(n,e)}catch(i){be(Ca,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Gd(n,i)}else if(e instanceof Sd?n.Va.Ze(e):e instanceof bb?n.Va.st(e):n.Va.tt(e),!t.isEqual(je.min()))try{const i=await Vb(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const f=l.Va.Tt(u);return f.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const T=l.Ia.get(m);T&&l.Ia.set(m,T.withResumeToken(g.resumeToken,u))}})),f.targetMismatches.forEach(((g,m)=>{const T=l.Ia.get(g);if(!T)return;l.Ia.set(g,T.withResumeToken(on.EMPTY_BYTE_STRING,T.snapshotVersion)),jb(l,g);const x=new Sr(T.target,g,m,T.sequenceNumber);tg(l,x)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(i){be(Ca,"Failed to raise snapshot:",i),await Gd(n,i)}}async function Gd(n,e,t){if(!sl(e))throw e;n.Ea.add(1),await ku(n),n.Ra.set("Offline"),t||(t=()=>Vb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{be(Ca,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await yf(n)}))}function qb(n,e){return e().catch((t=>Gd(n,t,e)))}async function vf(n){const e=qe(n),t=Vr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jp;for(;Bk(e);)try{const a=await bk(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,zk(e,a)}catch(a){await Gd(e,a)}Bb(e)&&zb(e)}function Bk(n){return Ma(n)&&n.Ta.length<10}function zk(n,e){n.Ta.push(e);const t=Vr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Bb(n){return Ma(n)&&!Vr(n).x_()&&n.Ta.length>0}function zb(n){Vr(n).start()}async function Hk(n){Vr(n).ra()}async function Gk(n){const e=Vr(n);for(const t of n.Ta)e.ea(t.mutations)}async function $k(n,e,t){const i=n.Ta.shift(),a=Yp.from(i,e,t);await qb(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await vf(n)}async function Yk(n,e){e&&Vr(n).X_&&await(async function(i,a){if((function(u){return IP(u)&&u!==de.ABORTED})(a.code)){const l=i.Ta.shift();Vr(i).B_(),await qb(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await vf(i)}})(n,e),Bb(n)&&zb(n)}async function ox(n,e){const t=qe(n);t.asyncQueue.verifyOperationInProgress(),be(Ca,"RemoteStore received new credentials");const i=Ma(t);t.Ea.add(3),await ku(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await yf(t)}async function Jk(n,e){const t=qe(n);e?(t.Ea.delete(2),await yf(t)):e||(t.Ea.add(2),await ku(t),t.Ra.set("Unknown"))}function il(n){return n.ma||(n.ma=(function(t,i,a){const l=qe(t);return l.sa(),new Mk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:Ok.bind(null,n),t_:jk.bind(null,n),r_:Fk.bind(null,n),H_:qk.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),sg(n)?ng(n):n.Ra.set("Unknown")):(await n.ma.stop(),Fb(n))}))),n.ma}function Vr(n){return n.fa||(n.fa=(function(t,i,a){const l=qe(t);return l.sa(),new Pk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Hk.bind(null,n),r_:Yk.bind(null,n),ta:Gk.bind(null,n),na:$k.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await vf(n)):(await n.fa.stop(),n.Ta.length>0&&(be(Ca,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const u=Date.now()+i,f=new ig(e,t,u,a,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rg(n,e){if(Ui("AsyncQueue",`${e}: ${n}`),sl(n))return new Ce(de.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{static emptySet(e){return new Lo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||De.comparator(t.key,i.key):(t,i)=>De.comparator(t.key,i.key),this.keyedMap=fu(),this.sortedSet=new Rt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Lo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Lo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(){this.ga=new Rt(De.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Le(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Yo{constructor(e,t,i,a,l,u,f,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,a,l){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new Yo(e,t,Lo.emptySet(t),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&df(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Qk{constructor(){this.queries=ux(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=qe(t),l=a.queries;a.queries=ux(),l.forEach(((u,f)=>{for(const g of f.Sa)g.onError(i)}))})(this,new Ce(de.ABORTED,"Firestore shutting down"))}}function ux(){return new Ra((n=>cb(n)),df)}async function Hb(n,e){const t=qe(n);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new Kk,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const f=rg(u,`Initialization of query '${Co(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&ag(t)}async function Gb(n,e){const t=qe(n),i=e.query;let a=3;const l=t.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Xk(n,e){const t=qe(n);let i=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const f of u.Sa)f.Fa(a)&&(i=!0);u.wa=a}}i&&ag(t)}function Wk(n,e,t){const i=qe(n),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);i.queries.delete(e)}function ag(n){n.Ca.forEach((e=>{e.next()}))}var vp,cx;(cx=vp||(vp={})).Ma="default",cx.Cache="cache";class $b{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new Yo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e){this.key=e}}class Jb{constructor(e){this.key=e}}class Zk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=nt(),this.mutatedKeys=nt(),this.eu=db(e),this.tu=new Lo(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new lx,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,f=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((T,x)=>{const b=a.get(T),w=ff(this.query,x)?x:null,V=!!b&&this.mutatedKeys.has(b.key),U=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let L=!1;b&&w?b.data.isEqual(w.data)?V!==U&&(i.track({type:3,doc:w}),L=!0):this.su(b,w)||(i.track({type:2,doc:w}),L=!0,(g&&this.eu(w,g)>0||m&&this.eu(w,m)<0)&&(f=!0)):!b&&w?(i.track({type:0,doc:w}),L=!0):b&&!w&&(i.track({type:1,doc:b}),L=!0,(g||m)&&(f=!0)),L&&(w?(u=u.add(w),l=U?l.add(T):l.delete(T)):(u=u.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const T=this.query.limitType==="F"?u.last():u.first();u=u.delete(T.key),l=l.delete(T.key),i.track({type:1,doc:T})}return{tu:u,iu:i,Cs:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((T,x)=>(function(w,V){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le(20277,{Rt:L})}};return U(w)-U(V)})(T.type,x.type)||this.eu(T.doc,x.doc))),this.ou(i),a=a??!1;const f=t&&!a?this._u():[],g=this.Xa.size===0&&this.current&&!a?1:0,m=g!==this.Za;return this.Za=g,u.length!==0||m?{snapshot:new Yo(this.query,e.tu,l,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=nt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Jb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Yb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=nt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const og="SyncEngine";class eV{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class tV{constructor(e){this.key=e,this.hu=!1}}class nV{constructor(e,t,i,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ra((f=>cb(f)),df),this.Iu=new Map,this.Eu=new Set,this.du=new Rt(De.comparator),this.Au=new Map,this.Ru=new Qp,this.Vu={},this.mu=new Map,this.fu=$o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function sV(n,e,t=!0){const i=eA(n);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Kb(i,e,t,!0),a}async function iV(n,e){const t=eA(n);await Kb(t,e,!0,!1)}async function Kb(n,e,t,i){const a=await Ak(n.localStore,Qs(e)),l=a.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let f;return i&&(f=await rV(n,e,l,u==="current",a.resumeToken)),n.isPrimaryClient&&t&&Ob(n.remoteStore,a),f}async function rV(n,e,t,i,a){n.pu=(x,b,w)=>(async function(U,L,G,W){let ee=L.view.ru(G);ee.Cs&&(ee=await nx(U.localStore,L.query,!1).then((({documents:R})=>L.view.ru(R,ee))));const F=W&&W.targetChanges.get(L.targetId),Q=W&&W.targetMismatches.get(L.targetId)!=null,H=L.view.applyChanges(ee,U.isPrimaryClient,F,Q);return fx(U,L.targetId,H.au),H.snapshot})(n,x,b,w);const l=await nx(n.localStore,e,!0),u=new Zk(e,l.Qs),f=u.ru(l.documents),g=Pu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",a),m=u.applyChanges(f,n.isPrimaryClient,g);fx(n,t,m.au);const T=new eV(e,t,u);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function aV(n,e,t){const i=qe(n),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!df(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await gp(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&eg(i.remoteStore,a.targetId),_p(i,a.targetId)})).catch(nl)):(_p(i,a.targetId),await gp(i.localStore,a.targetId,!0))}async function oV(n,e){const t=qe(n),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),eg(t.remoteStore,i.targetId))}async function lV(n,e,t){const i=pV(n);try{const a=await(function(u,f){const g=qe(u),m=Et.now(),T=f.reduce(((w,V)=>w.add(V.key)),nt());let x,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let V=ji(),U=nt();return g.Ns.getEntries(w,T).next((L=>{V=L,V.forEach(((G,W)=>{W.isValidDocument()||(U=U.add(G))}))})).next((()=>g.localDocuments.getOverlayedDocuments(w,V))).next((L=>{x=L;const G=[];for(const W of f){const ee=bP(W,x.get(W.key).overlayedDocument);ee!=null&&G.push(new Da(W.key,ee,sb(ee.value.mapValue),Xs.exists(!0)))}return g.mutationQueue.addMutationBatch(w,m,G,f)})).next((L=>{b=L;const G=L.applyToLocalDocumentSet(x,U);return g.documentOverlayCache.saveOverlays(w,L.batchId,G)}))})).then((()=>({batchId:b.batchId,changes:hb(x)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,f,g){let m=u.Vu[u.currentUser.toKey()];m||(m=new Rt(tt)),m=m.insert(f,g),u.Vu[u.currentUser.toKey()]=m})(i,a.batchId,t),await Vu(i,a.changes),await vf(i.remoteStore)}catch(a){const l=rg(a,"Failed to persist write");t.reject(l)}}async function Qb(n,e){const t=qe(n);try{const i=await xk(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(dt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?dt(u.hu,14607):a.removedDocuments.size>0&&(dt(u.hu,42227),u.hu=!1))})),await Vu(t,i,e)}catch(i){await nl(i)}}function dx(n,e,t){const i=qe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(u,f){const g=qe(u);g.onlineState=f;let m=!1;g.queries.forEach(((T,x)=>{for(const b of x.Sa)b.va(f)&&(m=!0)})),m&&ag(g)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function uV(n,e,t){const i=qe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new Rt(De.comparator);u=u.insert(l,vn.newNoDocument(l,je.min()));const f=nt().add(l),g=new pf(je.min(),new Map,new Rt(tt),u,f);await Qb(i,g),i.du=i.du.remove(l),i.Au.delete(e),lg(i)}else await gp(i.localStore,e,!1).then((()=>_p(i,e,t))).catch(nl)}async function cV(n,e){const t=qe(n),i=e.batch.batchId;try{const a=await Tk(t.localStore,e);Wb(t,i,null),Xb(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Vu(t,a)}catch(a){await nl(a)}}async function dV(n,e,t){const i=qe(n);try{const a=await(function(u,f){const g=qe(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let T;return g.mutationQueue.lookupMutationBatch(m,f).next((x=>(dt(x!==null,37113),T=x.keys(),g.mutationQueue.removeMutationBatch(m,x)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,T,f))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,T))).next((()=>g.localDocuments.getDocuments(m,T)))}))})(i.localStore,e);Wb(i,e,t),Xb(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Vu(i,a)}catch(a){await nl(a)}}function Xb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Wb(n,e,t){const i=qe(n);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function _p(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Zb(n,i)}))}function Zb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(eg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),lg(n))}function fx(n,e,t){for(const i of t)i instanceof Yb?(n.Ru.addReference(i.key,e),fV(n,i)):i instanceof Jb?(be(og,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Zb(n,i.key)):Le(19791,{wu:i})}function fV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(be(og,"New document in limbo: "+t),n.Eu.add(i),lg(n))}function lg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new De(Ct.fromString(e)),i=n.fu.next();n.Au.set(i,new tV(t)),n.du=n.du.insert(t,i),Ob(n.remoteStore,new Sr(Qs(Hp(t.path)),i,"TargetPurposeLimboResolution",of.ce))}}async function Vu(n,e,t){const i=qe(n),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,g)=>{u.push(i.pu(g,e,t).then((m=>{var T;if((m||t)&&i.isPrimaryClient){const x=m?!m.fromCache:(T=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:T.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(m){a.push(m);const x=Wp.As(g.targetId,m);l.push(x)}})))})),await Promise.all(u),i.Pu.H_(a),await(async function(g,m){const T=qe(g);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>ue.forEach(m,(b=>ue.forEach(b.Es,(w=>T.persistence.referenceDelegate.addReference(x,b.targetId,w))).next((()=>ue.forEach(b.ds,(w=>T.persistence.referenceDelegate.removeReference(x,b.targetId,w)))))))))}catch(x){if(!sl(x))throw x;be(Zp,"Failed to update sequence numbers: "+x)}for(const x of m){const b=x.targetId;if(!x.fromCache){const w=T.Ms.get(b),V=w.snapshotVersion,U=w.withLastLimboFreeSnapshotVersion(V);T.Ms=T.Ms.insert(b,U)}}})(i.localStore,l))}async function hV(n,e){const t=qe(n);if(!t.currentUser.isEqual(e)){be(og,"User change. New user:",e.toKey());const i=await kb(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((g=>{g.reject(new Ce(de.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Vu(t,i.Ls)}}function mV(n,e){const t=qe(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let a=nt();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const f=t.Tu.get(u);a=a.unionWith(f.view.nu)}return a}}function eA(n){const e=qe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Qb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uV.bind(null,e),e.Pu.H_=Xk.bind(null,e.eventManager),e.Pu.yu=Wk.bind(null,e.eventManager),e}function pV(n){const e=qe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dV.bind(null,e),e}class $d{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return _k(this.persistence,new gk,e.initialUser,this.serializer)}Cu(e){return new Pb(Xp.mi,this.serializer)}Du(e){return new Ck}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$d.provider={build:()=>new $d};class gV extends $d{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){dt(this.persistence.referenceDelegate instanceof Hd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new tk(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Vn.withCacheSize(this.cacheSizeBytes):Vn.DEFAULT;return new Pb((i=>Hd.mi(i,t)),this.serializer)}}class Tp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=hV.bind(null,this.syncEngine),await Jk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Qk})()}createDatastore(e){const t=gf(e.databaseInfo.databaseId),i=(function(l){return new Dk(l)})(e.databaseInfo);return(function(l,u,f,g){return new Vk(l,u,f,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,u,f){return new Uk(i,a,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>dx(this.syncEngine,t,0)),(function(){return rx.v()?new rx:new wk})())}createSyncEngine(e,t){return(function(a,l,u,f,g,m,T){const x=new nV(a,l,u,f,g,m);return T&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=qe(a);be(Ca,"RemoteStore shutting down."),l.Ea.add(5),await ku(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr="FirestoreClient";class yV{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=a,this.user=yn.UNAUTHENTICATED,this.clientId=af.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{be(Lr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(be(Lr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=rg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Om(n,e){n.asyncQueue.verifyOperationInProgress(),be(Lr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async a=>{i.isEqual(a)||(await kb(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function hx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await vV(n);be(Lr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>ox(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,a)=>ox(e.remoteStore,a))),n._onlineComponents=e}async function vV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){be(Lr,"Using user provided OfflineComponentProvider");try{await Om(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===de.FAILED_PRECONDITION||a.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Sa("Error using user provided cache. Falling back to memory cache: "+t),await Om(n,new $d)}}else be(Lr,"Using default OfflineComponentProvider"),await Om(n,new gV(void 0));return n._offlineComponents}async function nA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(be(Lr,"Using user provided OnlineComponentProvider"),await hx(n,n._uninitializedComponentsProvider._online)):(be(Lr,"Using default OnlineComponentProvider"),await hx(n,new Tp))),n._onlineComponents}function _V(n){return nA(n).then((e=>e.syncEngine))}async function sA(n){const e=await nA(n),t=e.eventManager;return t.onListen=sV.bind(null,e.syncEngine),t.onUnlisten=aV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=oV.bind(null,e.syncEngine),t}function TV(n,e,t={}){const i=new Pi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,m){const T=new tA({next:b=>{T.Nu(),u.enqueueAndForget((()=>Gb(l,x)));const w=b.docs.has(f);!w&&b.fromCache?m.reject(new Ce(de.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&g&&g.source==="server"?m.reject(new Ce(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(b)},error:b=>m.reject(b)}),x=new $b(Hp(f.path),T,{includeMetadataChanges:!0,qa:!0});return Hb(l,x)})(await sA(n),n.asyncQueue,e,t,i))),i.promise}function xV(n,e,t={}){const i=new Pi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,m){const T=new tA({next:b=>{T.Nu(),u.enqueueAndForget((()=>Gb(l,x))),b.fromCache&&g.source==="server"?m.reject(new Ce(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(b)},error:b=>m.reject(b)}),x=new $b(f,T,{includeMetadataChanges:!0,qa:!0});return Hb(l,x)})(await sA(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="firestore.googleapis.com",px=!0;class gx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rA,this.ssl=px}else this.host=e.host,this.ssl=e.ssl??px;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ZP)throw new Ce(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$E("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(de.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _f{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new HE;switch(i.type){case"firstParty":return new D2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=mx.get(t);i&&(be("ComponentProvider","Removing Datastore"),mx.delete(t),i.terminate())})(this),Promise.resolve()}}function aA(n,e,t,i={}){var m;n=Oi(n,_f);const a=Zo(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;a&&(IE(`https://${f}`),NE("Firestore",!0)),l.host!==rA&&l.host!==f&&Sa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:f,ssl:a,emulatorOptions:i};if(!Ea(g,u)&&(n._setSettings(g),i.mockUserToken)){let T,x;if(typeof i.mockUserToken=="string")T=i.mockUserToken,x=yn.MOCK_USER;else{T=ZD(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Ce(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new yn(b)}n._authCredentials=new I2(new zE(T,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Lu(this.firestore,e,this._query)}}class Qt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}toJSON(){return{type:Qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Du(t,Qt._jsonSchema))return new Qt(e,i||null,new De(Ct.fromString(t.referencePath)))}}Qt._jsonSchemaVersion="firestore/documentReference/1.0",Qt._jsonSchema={type:Kt("string",Qt._jsonSchemaVersion),referencePath:Kt("string")};class ki extends Lu{constructor(e,t,i){super(e,t,Hp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new De(e))}withConverter(e){return new ki(this.firestore,e,this._path)}}function EV(n,e,...t){if(n=An(n),GE("collection","path",e),n instanceof _f){const i=Ct.fromString(e,...t);return RT(i),new ki(n,null,i)}{if(!(n instanceof Qt||n instanceof ki))throw new Ce(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ct.fromString(e,...t));return RT(i),new ki(n.firestore,null,i)}}function bV(n,e,...t){if(n=An(n),arguments.length===1&&(e=af.newId()),GE("doc","path",e),n instanceof _f){const i=Ct.fromString(e,...t);return NT(i),new Qt(n,null,new De(i))}{if(!(n instanceof Qt||n instanceof ki))throw new Ce(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ct.fromString(e,...t));return NT(i),new Qt(n.firestore,n instanceof ki?n.converter:null,new De(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="AsyncQueue";class vx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Lb(this,"async_queue_retry"),this._c=()=>{const i=Um();i&&be(yx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Um();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Um();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Pi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!sl(e))throw e;be(yx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ui("INTERNAL UNHANDLED ERROR: ",_x(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=ig.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Le(47125,{Pc:_x(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _x(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class rl extends _f{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new vx,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vx(e),this._firestoreClient=void 0,await e}}}function oA(n,e){const t=typeof n=="object"?n:PE(),i=typeof n=="string"?n:Ud,a=Lp(t,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=XD("firestore");l&&aA(a,...l)}return a}function Tf(n){if(n._terminated)throw new Ce(de.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||AV(n),n._firestoreClient}function AV(n){var i,a,l;const e=n._freezeSettings(),t=(function(f,g,m,T){return new Y2(f,g,m,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,iA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new yV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const g=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yn(on.fromBase64String(e))}catch(t){throw new Ce(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yn(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Du(e,Yn._jsonSchema))return Yn.fromBase64String(e.bytes)}}Yn._jsonSchemaVersion="firestore/bytes/1.0",Yn._jsonSchema={type:Kt("string",Yn._jsonSchemaVersion),bytes:Kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:As._jsonSchemaVersion}}static fromJSON(e){if(Du(e,As._jsonSchema))return new As(e.latitude,e.longitude)}}As._jsonSchemaVersion="firestore/geoPoint/1.0",As._jsonSchema={type:Kt("string",As._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ss._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Du(e,Ss._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ss(e.vectorValues);throw new Ce(de.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ss._jsonSchemaVersion="firestore/vectorValue/1.0",Ss._jsonSchema={type:Kt("string",Ss._jsonSchemaVersion),vectorValues:Kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV=/^__.*__$/;class CV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Da(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mu(e,this.data,t,this.fieldTransforms)}}function lA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le(40011,{Ac:n})}}class cg{constructor(e,t,i,a,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Yd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(lA(this.Ac)&&SV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gf(e)}Cc(e,t,i,a=!1){return new cg({Ac:e,methodName:t,Dc:i,path:an.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function IV(n){const e=n._freezeSettings(),t=gf(n._databaseId);return new wV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function NV(n,e,t,i,a,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,a);fA("Data must be an object, but it was:",u,i);const f=cA(i,u);let g,m;if(l.merge)g=new Es(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const T=[];for(const x of l.mergeFields){const b=RV(e,x,t);if(!u.contains(b))throw new Ce(de.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);MV(T,b)||T.push(b)}g=new Es(T),m=u.fieldTransforms.filter((x=>g.covers(x.field)))}else g=null,m=u.fieldTransforms;return new CV(new os(f),g,m)}function uA(n,e){if(dA(n=An(n)))return fA("Unsupported field value:",e,n),cA(n,e);if(n instanceof ug)return(function(i,a){if(!lA(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const f of i){let g=uA(f,a.wc(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,a){if((i=An(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return yP(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=Et.fromDate(i);return{timestampValue:zd(a.serializer,l)}}if(i instanceof Et){const l=new Et(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zd(a.serializer,l)}}if(i instanceof As)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Yn)return{bytesValue:Sb(a.serializer,i._byteString)};if(i instanceof Qt){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Kp(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof Ss)return(function(u,f){return{mapValue:{fields:{[tb]:{stringValue:nb},[Od]:{arrayValue:{values:u.toArray().map((m=>{if(typeof m!="number")throw f.Sc("VectorValues must only contain numeric values.");return Gp(f.serializer,m)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Op(i)}`)})(n,e)}function cA(n,e){const t={};return KE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Na(n,((i,a)=>{const l=uA(a,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function dA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Et||n instanceof As||n instanceof Yn||n instanceof Qt||n instanceof ug||n instanceof Ss)}function fA(n,e,t){if(!dA(t)||!YE(t)){const i=Op(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function RV(n,e,t){if((e=An(e))instanceof xf)return e._internalPath;if(typeof e=="string")return hA(n,e);throw Yd("Field path arguments must be of type string or ",n,!1,void 0,t)}const DV=new RegExp("[~\\*/\\[\\]]");function hA(n,e,t){if(e.search(DV)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xf(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yd(n,e,t,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${a}`),g+=")"),new Ce(de.INVALID_ARGUMENT,f+n+g)}function MV(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class PV extends mA{data(){return super.data()}}function pA(n,e){return typeof e=="string"?hA(n,e):e instanceof xf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gA{convertValue(e,t="none"){switch(kr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Pr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Le(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Na(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,a,l;const t=(l=(a=(i=e.fields)==null?void 0:i[Od].arrayValue)==null?void 0:a.values)==null?void 0:l.map((u=>jt(u.doubleValue)));return new Ss(t)}convertGeoPoint(e){return new As(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=uf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Au(e));default:return null}}convertTimestamp(e){const t=Mr(e);return new Et(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ct.fromString(e);dt(Db(i),9688,{name:e});const a=new zo(i.get(1),i.get(3)),l=new De(i.popFirst(5));return a.isEqual(t)||Ui(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Ro{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rr extends mA{constructor(e,t,i,a,l,u){super(e,t,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(pA("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(de.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Rr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Rr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Rr._jsonSchema={type:Kt("string",Rr._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class Tu extends Rr{data(e={}){return super.data(e)}}class Ta{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Ro(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Tu(this._firestore,this._userDataWriter,i.key,i,new Ro(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((f=>{const g=new Tu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ro(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const g=new Tu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ro(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,T=-1;return f.type!==0&&(m=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),T=u.indexOf(f.doc.key)),{type:LV(f.type),doc:g,oldIndex:m,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(de.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ta._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=af.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function LV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(n){n=Oi(n,Qt);const e=Oi(n.firestore,rl);return TV(Tf(e),n._key).then((t=>qV(e,n,t)))}Ta._jsonSchemaVersion="firestore/querySnapshot/1.0",Ta._jsonSchema={type:Kt("string",Ta._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class yA extends gA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,t)}}function OV(n){n=Oi(n,Lu);const e=Oi(n.firestore,rl),t=Tf(e),i=new yA(e);return kV(n._query),xV(t,n._query).then((a=>new Ta(e,i,n,a)))}function jV(n,e,t){n=Oi(n,Qt);const i=Oi(n.firestore,rl),a=VV(n.converter,e,t);return dg(i,[NV(IV(i),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Xs.none())])}function FV(n){return dg(Oi(n.firestore,rl),[new $p(n._key,Xs.none())])}function dg(n,e){return(function(i,a){const l=new Pi;return i.asyncQueue.enqueueAndForget((async()=>lV(await _V(i),a,l))),l.promise})(Tf(n),e)}function qV(n,e,t){const i=t.docs.get(e._key),a=new yA(n);return new Rr(n,a,e._key,i,new Ro(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(a){tl=a})(el),qo(new ba("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new rl(new N2(i.getProvider("auth-internal")),new M2(u,i.getProvider("app-check-internal")),(function(m,T){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ce(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zo(m.options.projectId,T)})(u,a),u);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Ir(ST,CT,e),Ir(ST,CT,"esm2020")})();const gd=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:gA,Bytes:Yn,CollectionReference:ki,DocumentReference:Qt,DocumentSnapshot:Rr,FieldPath:xf,FieldValue:ug,Firestore:rl,FirestoreError:Ce,GeoPoint:As,Query:Lu,QueryDocumentSnapshot:Tu,QuerySnapshot:Ta,SnapshotMetadata:Ro,Timestamp:Et,VectorValue:Ss,_AutoId:af,_ByteString:on,_DatabaseId:zo,_DocumentKey:De,_EmptyAuthCredentialsProvider:HE,_FieldPath:an,_cast:Oi,_logWarn:Sa,_validateIsNotUsedTogether:$E,collection:EV,connectFirestoreEmulator:aA,deleteDoc:FV,doc:bV,ensureFirestoreConfigured:Tf,executeWrite:dg,getDoc:UV,getDocs:OV,getFirestore:oA,setDoc:jV},Symbol.toStringTag,{value:"Module"}));function vA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _A=vA,TA=new Nu("auth","Firebase",vA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new kp("@firebase/auth");function BV(n,...e){Jd.logLevel<=et.WARN&&Jd.warn(`Auth (${el}): ${n}`,...e)}function Cd(n,...e){Jd.logLevel<=et.ERROR&&Jd.error(`Auth (${el}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(n,...e){throw fg(n,...e)}function Zs(n,...e){return fg(n,...e)}function xA(n,e,t){const i={..._A(),[e]:t};return new Nu("auth","Firebase",i).create(e,{appName:n.name})}function Vi(n){return xA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return TA.create(n,...e)}function Ve(n,e,...t){if(!n)throw fg(e,...t)}function Di(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Cd(e),new Error(e)}function Fi(n,e){n||Di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function zV(){return Tx()==="http:"||Tx()==="https:"}function Tx(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zV()||rM()||"connection"in navigator)?navigator.onLine:!0}function GV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fi(t>e,"Short delay should be less than long delay!"),this.isMobile=nM()||aM()}get(){return HV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n,e){Fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JV=new Uu(3e4,6e4);function qr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function zi(n,e,t,i,a={}){return bA(n,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=Ru({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return iM()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Zo(n.emulatorConfig.host)&&(m.credentials="include"),EA.fetch()(await AA(n,n.config.apiHost,t,f),m)})}async function bA(n,e,t){n._canInitEmulator=!1;const i={...$V,...e};try{const a=new QV(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw yd(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[g,m]=f.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw yd(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw yd(n,"user-disabled",u);const T=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw xA(n,T,m);Cs(n,T)}}catch(a){if(a instanceof Bi)throw a;Cs(n,"network-request-failed",{message:String(a)})}}async function Ou(n,e,t,i,a={}){const l=await zi(n,e,t,i,a);return"mfaPendingCredential"in l&&Cs(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function AA(n,e,t,i){const a=`${e}${t}?${i}`,l=n,u=l.config.emulator?hg(n.config,a):`${n.config.apiScheme}://${a}`;return YV.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function KV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class QV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Zs(this.auth,"network-request-failed")),JV.get())})}}function yd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=Zs(n,e,i);return a.customData._tokenResponse=t,a}function xx(n){return n!==void 0&&n.enterprise!==void 0}class XV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function WV(n,e){return zi(n,"GET","/v2/recaptchaConfig",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZV(n,e){return zi(n,"POST","/v1/accounts:delete",e)}async function Kd(n,e){return zi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function SA(n,e=!1){const t=An(n),i=await t.getIdToken(e),a=mg(i);Ve(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:a,token:i,authTime:xu(jm(a.auth_time)),issuedAtTime:xu(jm(a.iat)),expirationTime:xu(jm(a.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function jm(n){return Number(n)*1e3}function mg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Cd("JWT malformed, contained fewer than 3 sections"),null;try{const a=AE(t);return a?JSON.parse(a):(Cd("Failed to decode base64 JWT payload"),null)}catch(a){return Cd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Ex(n){const e=mg(n);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Bi&&eL(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function eL({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=xu(this.lastLoginAt),this.creationTime=xu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qd(n){var x;const e=n.auth,t=await n.getIdToken(),i=await Jo(n,Kd(e,{idToken:t}));Ve(i==null?void 0:i.users.length,e,"internal-error");const a=i.users[0];n._notifyReloadListener(a);const l=(x=a.providerUserInfo)!=null&&x.length?wA(a.providerUserInfo):[],u=nL(n.providerData,l),f=n.isAnonymous,g=!(n.email&&a.passwordHash)&&!(u!=null&&u.length),m=f?g:!1,T={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Ep(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(n,T)}async function CA(n){const e=An(n);await Qd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nL(n,e){return[...n.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function wA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(n,e){const t=await bA(n,{},async()=>{const i=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,u=await AA(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:f,body:i};return n.emulatorConfig&&Zo(n.emulatorConfig.host)&&(g.credentials="include"),EA.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function iL(n,e){return zi(n,"POST","/v2/accounts:revokeToken",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const t=Ex(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await sL(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,u=new Uo;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Ve(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ve(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uo,this.toJSON())}_performRefresh(){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(n,e){Ve(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new tL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Ep(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Jo(this,this.stsTokenManager.getToken(this.auth,e));return Ve(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return SA(this,e)}reload(){return CA(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Qd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(as(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await Jo(this,ZV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,f=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:x,emailVerified:b,isAnonymous:w,providerData:V,stsTokenManager:U}=t;Ve(x&&U,e,"internal-error");const L=Uo.fromJSON(this.name,U);Ve(typeof x=="string",e,"internal-error"),br(i,e.name),br(a,e.name),Ve(typeof b=="boolean",e,"internal-error"),Ve(typeof w=="boolean",e,"internal-error"),br(l,e.name),br(u,e.name),br(f,e.name),br(g,e.name),br(m,e.name),br(T,e.name);const G=new bs({uid:x,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:L,createdAt:m,lastLoginAt:T});return V&&Array.isArray(V)&&(G.providerData=V.map(W=>({...W}))),g&&(G._redirectEventId=g),G}static async _fromIdTokenResponse(e,t,i=!1){const a=new Uo;a.updateFromServerResponse(t);const l=new bs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Qd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Ve(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?wA(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Uo;f.updateFromIdToken(i);const g=new bs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:u}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Ep(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=new Map;function Mi(n){Fi(n instanceof Function,"Expected a class definition");let e=bx.get(n);return e?(Fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,bx.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}IA.type="NONE";const bp=IA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(n,e,t){return`firebase:${n}:${e}:${t}`}class Oo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=wd(this.userKey,a.apiKey,l),this.fullPersistenceKey=wd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Kd(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Oo(Mi(bp),e,i);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||Mi(bp);const u=wd(i,e.config.apiKey,e.name);let f=null;for(const m of t)try{const T=await m._get(u);if(T){let x;if(typeof T=="string"){const b=await Kd(e,{idToken:T}).catch(()=>{});if(!b)break;x=await bs._fromGetAccountInfoResponse(e,b,T)}else x=bs._fromJSON(e,T);m!==l&&(f=x),l=m;break}}catch{}const g=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Oo(l,e,i):(l=g[0],f&&await l._set(u,f.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new Oo(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kA(e))return"Blackberry";if(VA(e))return"Webos";if(RA(e))return"Safari";if((e.includes("chrome/")||DA(e))&&!e.includes("edge/"))return"Chrome";if(PA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function NA(n=Tn()){return/firefox\//i.test(n)}function RA(n=Tn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DA(n=Tn()){return/crios\//i.test(n)}function MA(n=Tn()){return/iemobile/i.test(n)}function PA(n=Tn()){return/android/i.test(n)}function kA(n=Tn()){return/blackberry/i.test(n)}function VA(n=Tn()){return/webos/i.test(n)}function pg(n=Tn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rL(n=Tn()){var e;return pg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function aL(){return oM()&&document.documentMode===10}function LA(n=Tn()){return pg(n)||PA(n)||VA(n)||kA(n)||/windows phone/i.test(n)||MA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(n,e=[]){let t;switch(n){case"Browser":t=Ax(Tn());break;case"Worker":t=`${Ax(Tn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${el}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,f)=>{try{const g=e(l);u(g)}catch(g){f(g)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lL(n,e={}){return zi(n,"GET","/v2/passwordPolicy",qr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL=6;class cL{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??uL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sx(this),this.idTokenSubscription=new Sx(this),this.beforeStateQueue=new oL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=TA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mi(t)),this._initializationPromise=this.queue(async()=>{var i,a,l;if(!this._deleted&&(this.persistenceManager=await Oo.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Kd(this,{idToken:e}),i=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(as(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,f=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===f)&&(g!=null&&g.user)&&(i=g.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Qd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(as(this.app))return Promise.reject(Vi(this));const t=e?An(e):null;return t&&Ve(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return as(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return as(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lL(this),t=new cL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await iL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mi(e)||this._popupRedirectResolver;Ve(t,this,"argument-error"),this.redirectPersistenceManager=await Oo.create(this,[Mi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,a);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=UA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&BV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Pa(n){return An(n)}class Sx{constructor(e){this.auth=e,this.observer=null,this.addObserver=pM(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ef={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fL(n){Ef=n}function OA(n){return Ef.loadJS(n)}function hL(){return Ef.recaptchaEnterpriseScript}function mL(){return Ef.gapiScript}function pL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class gL{constructor(){this.enterprise=new yL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class yL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const vL="recaptcha-enterprise",jA="NO_RECAPTCHA";class _L{constructor(e){this.type=vL,this.auth=Pa(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{WV(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const m=new XV(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(g=>{f(g)})})}function a(l,u,f){const g=window.grecaptcha;xx(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(jA)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gL().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!t&&xx(window.grecaptcha))a(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=hL();g.length!==0&&(g+=f),OA(g).then(()=>{a(f,l,u)}).catch(m=>{u(m)})}}).catch(f=>{u(f)})})}}async function Cx(n,e,t,i=!1,a=!1){const l=new _L(n);let u;if(a)u=jA;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const g=f.phoneEnrollmentInfo.phoneNumber,m=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const g=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Ap(n,e,t,i,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await Cx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Cx(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(n,e){const t=Lp(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ea(l,e??{}))return a;Cs(a,"already-initialized")}return t.initialize({options:e})}function TL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Mi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function qA(n,e,t){const i=Pa(n);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=BA(e),{host:u,port:f}=xL(e),g=f===null?"":`:${f}`,m={url:`${l}//${u}${g}/`},T=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve(Ea(m,i.config.emulator)&&Ea(T,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=T,i.settings.appVerificationDisabledForTesting=!0,Zo(u)?(IE(`${l}//${u}${g}`),NE("Auth",!0)):EL()}function BA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xL(n){const e=BA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:wx(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:wx(u)}}}function wx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function EL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,t){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function bL(n,e){return zi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(n,e){return Ou(n,"POST","/v1/accounts:signInWithPassword",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SL(n,e){return Ou(n,"POST","/v1/accounts:signInWithEmailLink",qr(n,e))}async function CL(n,e){return Ou(n,"POST","/v1/accounts:signInWithEmailLink",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko extends bf{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Ko(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ko(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,t,"signInWithPassword",AL);case"emailLink":return SL(e,{email:this._email,oobCode:this._password});default:Cs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,i,"signUpPassword",bL);case"emailLink":return CL(e,{idToken:t,email:this._email,oobCode:this._password});default:Cs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jo(n,e){return Ou(n,"POST","/v1/accounts:signInWithIdp",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL="http://localhost";class Ur extends bf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ur(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Cs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const u=new Ur(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return jo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,jo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,jo(e,t)}buildRequest(){const e={requestUri:wL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ru(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function NL(n){const e=uu(cu(n)).link,t=e?uu(cu(e)).deep_link_id:null,i=uu(cu(n)).deep_link_id;return(i?uu(cu(i)).link:null)||i||t||e||n}class Af{constructor(e){const t=uu(cu(e)),i=t.apiKey??null,a=t.oobCode??null,l=IL(t.mode??null);Ve(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=NL(e);try{return new Af(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(){this.providerId=ka.PROVIDER_ID}static credential(e,t){return Ko._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Af.parseLink(t);return Ve(i,"argument-error"),Ko._fromEmailAndCode(e,i.code,i.tenantId)}}ka.PROVIDER_ID="password";ka.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ka.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju extends zA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends ju{constructor(){super("facebook.com")}static credential(e){return Ur._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ci.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ur._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return wi.credential(t,i)}catch{return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com";wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends ju{constructor(){super("github.com")}static credential(e){return Ur._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.GITHUB_SIGN_IN_METHOD="github.com";Ii.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends ju{constructor(){super("twitter.com")}static credential(e,t){return Ur._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ni.credential(t,i)}catch{return null}}}Ni.TWITTER_SIGN_IN_METHOD="twitter.com";Ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL(n,e){return Ou(n,"POST","/v1/accounts:signUp",qr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await bs._fromIdTokenResponse(e,i,a),u=Ix(i);return new wa({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=Ix(i);return new wa({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function Ix(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends Bi{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Xd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new Xd(e,t,i,a)}}function HA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Xd._fromErrorAndOperation(n,l,e,i):l})}async function DL(n,e,t=!1){const i=await Jo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wa._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ML(n,e,t=!1){const{auth:i}=n;if(as(i.app))return Promise.reject(Vi(i));const a="reauthenticate";try{const l=await Jo(n,HA(i,a,e,n),t);Ve(l.idToken,i,"internal-error");const u=mg(l.idToken);Ve(u,i,"internal-error");const{sub:f}=u;return Ve(n.uid===f,i,"user-mismatch"),wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Cs(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GA(n,e,t=!1){if(as(n.app))return Promise.reject(Vi(n));const i="signIn",a=await HA(n,i,e),l=await wa._fromIdTokenResponse(n,i,a);return t||await n._updateCurrentUser(l.user),l}async function $A(n,e){return GA(Pa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YA(n){const e=Pa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function PL(n,e,t){if(as(n.app))return Promise.reject(Vi(n));const i=Pa(n),u=await Ap(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",RL).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&YA(n),g}),f=await wa._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(f.user),f}function kL(n,e,t){return as(n.app)?Promise.reject(Vi(n)):$A(An(n),ka.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&YA(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(n,e){return zi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=An(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Jo(i,VL(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const f=i.providerData.find(({providerId:g})=>g==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function JA(n,e,t,i){return An(n).onIdTokenChanged(e,t,i)}function KA(n,e,t){return An(n).beforeAuthStateChanged(e,t)}function UL(n,e,t,i){return An(n).onAuthStateChanged(e,t,i)}function OL(n){return An(n).signOut()}const Wd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wd,"1"),this.storage.removeItem(Wd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=1e3,FL=10;class XA extends QA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=LA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);aL()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,FL):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},jL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}XA.type="LOCAL";const WA=XA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA extends QA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ZA.type="SESSION";const gg=ZA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new Sf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const f=Array.from(u).map(async m=>m(t.origin,l)),g=await qL(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((f,g)=>{const m=yg("",20);a.port1.start();const T=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(x){const b=x;if(b.data.eventId===m)switch(b.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(b.data.response);break;default:clearTimeout(T),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return window}function zL(n){ei().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(){return typeof ei().WorkerGlobalScope<"u"&&typeof ei().importScripts=="function"}async function HL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function $L(){return eS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="firebaseLocalStorageDb",YL=1,Zd="firebaseLocalStorage",nS="fbase_key";class Fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cf(n,e){return n.transaction([Zd],e?"readwrite":"readonly").objectStore(Zd)}function JL(){const n=indexedDB.deleteDatabase(tS);return new Fu(n).toPromise()}function Sp(){const n=indexedDB.open(tS,YL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Zd,{keyPath:nS})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Zd)?e(i):(i.close(),await JL(),e(await Sp()))})})}async function Nx(n,e,t){const i=Cf(n,!0).put({[nS]:e,value:t});return new Fu(i).toPromise()}async function KL(n,e){const t=Cf(n,!1).get(e),i=await new Fu(t).toPromise();return i===void 0?null:i.value}function Rx(n,e){const t=Cf(n,!0).delete(e);return new Fu(t).toPromise()}const QL=800,XL=3;class sS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>XL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sf._getInstance($L()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await HL(),!this.activeServiceWorker)return;this.sender=new BL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await Nx(e,Wd,"1"),await Rx(e,Wd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Nx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>KL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Rx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Cf(a,!1).getAll();return new Fu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sS.type="LOCAL";const iS=sS;new Uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(n,e){return e?Mi(e):(Ve(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg extends bf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return jo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return jo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ZL(n){return GA(n.auth,new vg(n),n.bypassAuthState)}function e4(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),ML(t,new vg(n),n.bypassAuthState)}async function t4(n){const{auth:e,user:t}=n;return Ve(t,e,"internal-error"),DL(t,new vg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ZL;case"linkViaPopup":case"linkViaRedirect":return t4;case"reauthViaPopup":case"reauthViaRedirect":return e4;default:Cs(this.auth,"internal-error")}}resolve(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new Uu(2e3,1e4);class Do extends rS{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Do.currentPopupAction&&Do.currentPopupAction.cancel(),Do.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){Fi(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Zs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Zs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Do.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,n4.get())};e()}}Do.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="pendingRedirect",Id=new Map;class i4 extends rS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Id.get(this.auth._key());if(!e){try{const i=await r4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function r4(n,e){const t=l4(e),i=o4(n);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function a4(n,e){Id.set(n._key(),e)}function o4(n){return Mi(n._redirectPersistence)}function l4(n){return wd(s4,n.config.apiKey,n.name)}async function u4(n,e,t=!1){if(as(n.app))return Promise.reject(Vi(n));const i=Pa(n),a=WL(i,e),u=await new i4(i,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=600*1e3;class d4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!f4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!aS(e)){const a=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Zs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c4&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dx(e))}saveEventToCache(e){this.cachedEventUids.add(Dx(e)),this.lastProcessedEventTime=Date.now()}}function Dx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function aS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function f4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h4(n,e={}){return zi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p4=/^https?/;async function g4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await h4(n);for(const t of e)try{if(y4(t))return}catch{}Cs(n,"unauthorized-domain")}function y4(n){const e=xp(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!p4.test(t))return!1;if(m4.test(n))return i===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4=new Uu(3e4,6e4);function Mx(){const n=ei().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _4(n){return new Promise((e,t)=>{var a,l,u;function i(){Mx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Mx(),t(Zs(n,"network-request-failed"))},timeout:v4.get()})}if((l=(a=ei().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=ei().gapi)!=null&&u.load)i();else{const f=pL("iframefcb");return ei()[f]=()=>{gapi.load?i():t(Zs(n,"network-request-failed"))},OA(`${mL()}?onload=${f}`).catch(g=>t(g))}}).catch(e=>{throw Nd=null,e})}let Nd=null;function T4(n){return Nd=Nd||_4(n),Nd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=new Uu(5e3,15e3),E4="__/auth/iframe",b4="emulator/auth/iframe",A4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},S4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function C4(n){const e=n.config;Ve(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hg(e,b4):`https://${n.config.authDomain}/${E4}`,i={apiKey:e.apiKey,appName:n.name,v:el},a=S4.get(n.config.apiHost);a&&(i.eid=a);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Ru(i).slice(1)}`}async function w4(n){const e=await T4(n),t=ei().gapi;return Ve(t,n,"internal-error"),e.open({where:document.body,url:C4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:A4,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=Zs(n,"network-request-failed"),f=ei().setTimeout(()=>{l(u)},x4.get());function g(){ei().clearTimeout(f),a(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N4=500,R4=600,D4="_blank",M4="http://localhost";class Px{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function P4(n,e,t,i=N4,a=R4){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const g={...I4,width:i.toString(),height:a.toString(),top:l,left:u},m=Tn().toLowerCase();t&&(f=DA(m)?D4:t),NA(m)&&(e=e||M4,g.scrollbars="yes");const T=Object.entries(g).reduce((b,[w,V])=>`${b}${w}=${V},`,"");if(rL(m)&&f!=="_self")return k4(e||"",f),new Px(null);const x=window.open(e||"",f,T);Ve(x,n,"popup-blocked");try{x.focus()}catch{}return new Px(x)}function k4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4="__/auth/handler",L4="emulator/auth/handler",U4=encodeURIComponent("fac");async function kx(n,e,t,i,a,l){Ve(n.config.authDomain,n,"auth-domain-config-required"),Ve(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:el,eventId:a};if(e instanceof zA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",mM(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,x]of Object.entries({}))u[T]=x}if(e instanceof ju){const T=e.getScopes().filter(x=>x!=="");T.length>0&&(u.scopes=T.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const T of Object.keys(f))f[T]===void 0&&delete f[T];const g=await n._getAppCheckToken(),m=g?`#${U4}=${encodeURIComponent(g)}`:"";return`${O4(n)}?${Ru(f).slice(1)}${m}`}function O4({config:n}){return n.emulator?hg(n,L4):`https://${n.authDomain}/${V4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="webStorageSupport";class j4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gg,this._completeRedirectFn=u4,this._overrideRedirectResult=a4}async _openPopup(e,t,i,a){var u;Fi((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await kx(e,t,i,xp(),a);return P4(e,l,yg())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await kx(e,t,i,xp(),a);return zL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Fi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await w4(e),i=new d4(e);return t.register("authEvent",a=>(Ve(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fm,{type:Fm},a=>{var u;const l=(u=a==null?void 0:a[0])==null?void 0:u[Fm];l!==void 0&&t(!!l),Cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=g4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return LA()||RA()||pg()}}const oS=j4;var Vx="@firebase/auth",Lx="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B4(n){qo(new ba("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;Ve(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:UA(n)},m=new dL(i,a,l,g);return TL(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),qo(new ba("auth-internal",e=>{const t=Pa(e.getProvider("auth").getImmediate());return(i=>new F4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ir(Vx,Lx,q4(n)),Ir(Vx,Lx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=300,H4=wE("authIdTokenMaxAge")||z4;let Ux=null;const G4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>H4)return;const a=t==null?void 0:t.token;Ux!==a&&(Ux=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function lS(n=PE()){const e=Lp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=FA(n,{popupRedirectResolver:oS,persistence:[iS,WA,gg]}),i=wE("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=G4(l.toString());KA(t,u,()=>u(t.currentUser)),JA(t,f=>u(f))}}const a=SE("auth");return a&&qA(t,`http://${a}`),t}function $4(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}fL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=a=>{const l=Zs("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",$4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B4("Browser");const vd=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Af,AuthCredential:bf,EmailAuthCredential:Ko,EmailAuthProvider:ka,FacebookAuthProvider:Ci,GithubAuthProvider:Ii,GoogleAuthProvider:wi,OAuthCredential:Ur,TwitterAuthProvider:Ni,beforeAuthStateChanged:KA,browserLocalPersistence:WA,browserPopupRedirectResolver:oS,browserSessionPersistence:gg,connectAuthEmulator:qA,createUserWithEmailAndPassword:PL,getAuth:lS,getIdTokenResult:SA,inMemoryPersistence:bp,indexedDBLocalPersistence:iS,initializeAuth:FA,onAuthStateChanged:UL,onIdTokenChanged:JA,prodErrorMap:_A,reload:CA,signInWithCredential:$A,signInWithEmailAndPassword:kL,signOut:OL,updateProfile:LL},Symbol.toStringTag,{value:"Module"}));let qm=null,Si=null,xs=null;const Y4=()=>{try{return Vo().hasFirebase?(qm=ME(Ft.firebase),Si=oA(qm),xs=lS(qm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};Y4();const Ri={async signUp(n,e,t){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:i,updateProfile:a}=await Ai(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:f}=await Promise.resolve().then(()=>vd);return{createUserWithEmailAndPassword:u,updateProfile:f}},void 0),l=await i(xs,n,e);return await a(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(i){return console.error("خطأ في التسجيل:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async signIn(n,e){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await Ai(async()=>{const{signInWithEmailAndPassword:a}=await Promise.resolve().then(()=>vd);return{signInWithEmailAndPassword:a}},void 0);return{success:!0,user:(await t(xs,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await Ai(async()=>{const{signOut:e}=await Promise.resolve().then(()=>vd);return{signOut:e}},void 0);return await n(xs),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return xs?xs.currentUser:null},async onAuthStateChanged(n){if(!xs)return n(null),()=>{};try{const{onAuthStateChanged:e}=await Ai(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>vd);return{onAuthStateChanged:t}},void 0);return e(xs,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:i,setDoc:a}=await Ai(async()=>{const{doc:u,setDoc:f}=await Promise.resolve().then(()=>gd);return{doc:u,setDoc:f}},void 0),l=i(Si,n,e);return await a(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(i){return console.error("خطأ في حفظ البيانات:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async getData(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:i}=await Ai(async()=>{const{doc:u,getDoc:f}=await Promise.resolve().then(()=>gd);return{doc:u,getDoc:f}},void 0),a=t(Si,n,e),l=await i(a);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await Ai(async()=>{const{collection:l,getDocs:u}=await Promise.resolve().then(()=>gd);return{collection:l,getDocs:u}},void 0),i=await t(e(Si,n)),a=[];return i.forEach(l=>{a.push({id:l.id,...l.data()})}),{success:!0,data:a}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:i}=await Ai(async()=>{const{doc:l,deleteDoc:u}=await Promise.resolve().then(()=>gd);return{doc:l,deleteDoc:u}},void 0),a=t(Si,n,e);return await i(a),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},Ox=({onSuccess:n,onClose:e,hideCloseButton:t=!1,darkMode:i=!1,language:a="ar"})=>{const[l,u]=he.useState(!0),[f,g]=he.useState({email:"",password:"",displayName:""}),[m,T]=he.useState(!1),[x,b]=he.useState(""),w=async U=>{U.preventDefault(),T(!0),b("");try{let L;if(l)L=await Ri.signIn(f.email,f.password);else{if(!f.displayName.trim()){b("الاسم مطلوب"),T(!1);return}L=await Ri.signUp(f.email,f.password,f.displayName)}L.success?n(L.user):b(L.error||"حدث خطأ غير متوقع")}catch{b("حدث خطأ في الاتصال")}finally{T(!1)}},V=U=>{g(L=>({...L,[U.target.name]:U.target.value}))};return d.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:l?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&d.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),d.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!l&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),d.jsx("input",{type:"text",id:"displayName",name:"displayName",value:f.displayName,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!l})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),d.jsx("input",{type:"email",id:"email",name:"email",value:f.email,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),d.jsx("input",{type:"password",id:"password",name:"password",value:f.password,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),x&&d.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:d.jsx("p",{className:"text-red-600 text-sm",children:x})}),d.jsx("button",{type:"submit",disabled:m,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:m?"⏳ جاري المعالجة...":l?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("button",{onClick:()=>u(!l),className:"text-blue-600 hover:text-blue-700 font-medium",children:l?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},uS=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),d.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Fo=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),d.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),J4=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),d.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),K4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),Q4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),X4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),W4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),Z4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),qu=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Bm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),zm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),eU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),tU=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:i,onAddTransaction:a,currentUser:l,onSignOut:u,language:f="ar"})=>{const g=he.useMemo(()=>{const T=new Date().getFullYear(),x=[];for(let b=T+1;b>=2020;b--)x.push(b);return x},[]),m=he.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return d.jsx("header",{className:"bg-slate-50/95 dark:bg-slate-800/95 backdrop-blur-lg border-b border-slate-200 dark:border-slate-700 py-3 shadow-sm",children:d.jsx("div",{className:"container mx-auto px-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 tracking-wide",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Developed by K.A Team"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 dark:bg-slate-700 p-1.5 rounded-lg",children:[d.jsx("select",{value:n,onChange:T=>t(parseInt(T.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:g.map(T=>d.jsx("option",{value:T,children:T},T))}),d.jsx("select",{value:e,onChange:T=>i(T.target.value==="all"?"all":parseInt(T.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:m.map(T=>d.jsx("option",{value:T.value,children:T.label},T.value))})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200 text-sm",children:l.displayName||"المستخدم"}),d.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.email})]}),d.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),d.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),d.jsxs("button",{onClick:a,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[d.jsx(Z4,{className:"w-5 h-5"}),d.jsx("span",{children:ie("add.transaction",f)})]})]})]})})})},nU=(n="ar")=>[{id:"summary",label:`📊 ${ie("tab.summary",n)}`,icon:K4},{id:"analysis",label:`📈 ${ie("tab.analysis",n)}`,icon:Q4},{id:"transactions",label:`💳 ${ie("tab.transactions",n)}`,icon:X4},{id:"budget",label:`✨ ${ie("tab.budget",n)}`},{id:"investment",label:`💹 ${ie("tab.investment",n)}`},{id:"ai-assistant",label:`🤖 ${ie("tab.ai.assistant",n)}`},{id:"cards",label:`💳 ${ie("tab.cards",n)}`},{id:"bank",label:`🏦 ${ie("tab.bank",n)}`},{id:"installments",label:`📱 ${ie("tab.installments",n)}`},{id:"debts-loans",label:`📊 ${ie("tab.debts.loans",n)}`},{id:"settings",label:`⚙️ ${ie("tab.settings",n)}`}],jx=["summary","analysis","transactions"],sU=({activeTab:n,setActiveTab:e,language:t="ar"})=>{const[i,a]=he.useState(!1),l=nU(t),u=m=>{e(m),a(!1)},f=l.filter(m=>jx.includes(m.id)),g=l.filter(m=>!jx.includes(m.id));return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:l.map(m=>d.jsx("button",{onClick:()=>u(m.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===m.id?"active":""}`,children:m.label},m.id))}),d.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[f.map(m=>{const T=m.icon;return d.jsxs("button",{onClick:()=>u(m.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===m.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[T&&d.jsx(T,{}),d.jsx("span",{className:"text-xs",children:m.label.split(" ")[1]})]},m.id)}),d.jsxs("button",{onClick:()=>a(!i),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${i?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[d.jsx(W4,{}),d.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),i&&d.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>a(!1),children:d.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:m=>m.stopPropagation(),children:[d.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),d.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:g.map(m=>d.jsxs("button",{onClick:()=>u(m.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===m.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[d.jsx("span",{className:"text-2xl",children:m.label.split(" ")[0]}),d.jsx("span",{className:"text-xs font-semibold",children:m.label.split(" ")[1]})]},m.id))})]})})]})},iU=({className:n,darkMode:e=!1})=>d.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-${e?"slate-700/80":"slate-200/80"} to-transparent ${n}`}),Hm=({darkMode:n=!1})=>d.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[d.jsx("div",{className:`h-6 w-1/2 rounded mb-6 ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-5/6 rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-3/4 rounded ${n?"bg-slate-700":"bg-slate-200"}`})]}),d.jsx(iU,{darkMode:n})]}),rU=({darkMode:n=!1})=>d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx("div",{className:"h-16 mb-3"}),d.jsx("div",{className:`flex flex-wrap justify-center mb-8 rounded-xl p-2 h-14 ${n?"bg-slate-700":"bg-slate-100"}`}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsx(Hm,{}),d.jsx(Hm,{}),d.jsx(Hm,{})]})]}),Oe=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),aU=({title:n,details:e,barColor:t,darkMode:i=!1,language:a="ar"})=>d.jsxs("div",{className:`p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between ${i?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h4",{className:`font-bold text-sm ${i?"text-slate-200":"text-slate-800"}`,children:n}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),d.jsxs("div",{className:`p-2 rounded-lg border ${i?"bg-slate-700 border-slate-600":"bg-slate-50 border-gray-200"}`,children:[d.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[d.jsxs("span",{className:i?"text-slate-400":"text-slate-600",children:[ie("due",a),":"]}),d.jsx("span",{className:`font-semibold number-display text-xs ${i?"text-slate-200":"text-slate-900"}`,children:Oe(e.balance)})]}),d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:i?"text-slate-400":"text-slate-600",children:[ie("remaining",a),":"]}),d.jsx("span",{className:`font-semibold number-display text-xs ${i?"text-slate-200":"text-emerald-700"}`,children:Oe(e.available)})]})]}),d.jsx("div",{className:`rounded-full h-1.5 overflow-hidden ${i?"bg-slate-600":"bg-slate-200"}`,children:d.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),oU=({calculations:n,categories:e,darkMode:t=!1,language:i="ar"})=>{const a=Object.values(n.expensesByCategory).reduce((u,f)=>u+Number(f),0);if(a===0)return d.jsx("p",{className:`text-center p-4 text-sm ${t?"text-slate-400":"text-slate-500"}`,children:ie("no.data",i)});const l=Object.entries(n.expensesByCategory).sort(([,u],[,f])=>f-u);return d.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:l.map(([u,f])=>{const g=e.find(T=>T.id===u);g?`${g.icon}${g.name}`:ie("other",i);const m=Number(f)/a*100;return d.jsxs("div",{className:`p-3 rounded-lg border shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between ${t?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-base",children:(g==null?void 0:g.icon)||"📊"}),d.jsx("span",{className:`font-medium truncate text-sm ${t?"text-slate-300":"text-slate-700"}`,title:g==null?void 0:g.name,children:(g==null?void 0:g.name)||ie("other",i)})]}),d.jsx("span",{className:`font-semibold number-display text-sm px-2 py-1 rounded border ${t?"text-slate-200 bg-slate-700 border-slate-600":"text-slate-900 bg-slate-50 border-gray-200"}`,children:Oe(f)})]}),d.jsx("div",{className:`mt-2 rounded-full h-1.5 overflow-hidden ${t?"bg-slate-600":"bg-slate-200"}`,children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${m.toFixed(1)}%`}})}),d.jsxs("div",{className:`text-xs mt-1 text-center ${t?"text-slate-400":"text-slate-500"}`,children:[m.toFixed(1),"%"]})]},u)})})},lU=({calculations:n,categories:e,state:t,darkMode:i=!1,language:a="ar"})=>{const{totalIncome:l,totalExpenses:u,cardPayments:f,bankAccountDetails:g,totalBankBalance:m}=n,T=l-u,x=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"],b=n.cardDetails,w=Object.values(b).reduce((L,G)=>L+G.balance,0),V=Object.values(b).reduce((L,G)=>L+G.available,0),U=Object.values(b).reduce((L,G)=>L+G.limit,0);return d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsxs("h3",{className:`font-semibold text-lg mb-4 ${i?"text-slate-200":"text-slate-800"}`,children:["💳 ",ie("card.debts.summary",a)]}),d.jsx("div",{className:"space-y-4",children:Object.values(b).map((L,G)=>d.jsx(aU,{title:L.name,details:L,barColor:x[G%x.length],darkMode:i,language:a},L.id))}),d.jsx("div",{className:`mt-4 p-3 rounded-lg ${i?"bg-slate-700":"bg-slate-100"}`,children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:`font-semibold text-xs mb-2 ${i?"text-red-400":"text-red-600"}`,children:ie("total.debts",a)}),d.jsx("p",{className:`font-bold text-sm number-display ${i?"text-red-400":"text-red-600"}`,children:Oe(w)})]}),d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:`font-semibold text-xs mb-2 ${i?"text-emerald-400":"text-emerald-600"}`,children:ie("total.available",a)}),d.jsx("p",{className:`font-bold text-sm number-display ${i?"text-emerald-400":"text-emerald-600"}`,children:Oe(V)})]}),d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),d.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:Oe(U)})]})]})})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),d.jsx("div",{className:"space-y-3",children:Object.values(g).map(L=>{const G=L.balance>0?"bank-card-positive":L.balance<0?"bank-card-negative":"bank-card-neutral";return d.jsxs("div",{className:`card-consistent ${G} h-32 flex flex-col justify-between`,children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:L.name}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),d.jsx("div",{className:"text-center",children:d.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:Oe(L.balance)})}),d.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),d.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",Oe(L.deposits)]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),d.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",Oe(L.withdrawals)]})]})]})]},L.id)})})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي الدخل:"}),d.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:Oe(l)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي المصاريف:"}),d.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:Oe(u)})]}),d.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(b).map((L,G)=>d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["مصاريف ",L.name,":"]}),d.jsx("span",{className:`font-semibold ${x[G%x.length].replace("bg-","text-")} number-display`,children:Oe(L.balance+(f[L.id]||0))})]},L.id)),d.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(f).map(([L,G])=>{var W;return d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(W=b[L])==null?void 0:W.name,":"]}),d.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:Oe(G)})]},L)}),d.jsx("hr",{className:"my-2 border-slate-200"}),d.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[d.jsx("span",{children:"الصافي:"}),d.jsx("span",{className:`number-display ${T>=0?"text-emerald-500":"text-red-500"}`,children:Oe(T)})]})]})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),d.jsx(oU,{calculations:n,categories:e})]})]})},uU=({transactions:n,allTransactions:e,categories:t,deleteTransaction:i,editTransaction:a,state:l,darkMode:u=!1,language:f="ar"})=>{const[g,m]=he.useState(""),[T,x]=he.useState(""),[b,w]=he.useState(""),[V,U]=he.useState(""),[L,G]=he.useState(""),W=H=>{const R={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return R[H]?R[H]:l.cards[H]?`💳 ${l.cards[H].name}`:l.bankAccounts[H]?`🏦 ${l.bankAccounts[H].name}`:H},ee=H=>{const R={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(R[H])return R[H];if(H.endsWith("-payment")){const C=H.replace("-payment","");if(l.cards[C])return`💳 سداد ${l.cards[C].name}`}return H},F=he.useMemo(()=>{let H=e;if(V&&L){const R=new Date(V),C=new Date(L);C.setHours(23,59,59,999),H=e.filter(D=>{const N=new Date(D.date);return N>=R&&N<=C})}return H=H.filter(R=>{const C=g.toLowerCase(),D=t.find(k=>k.id===R.categoryId),N=R.description.toLowerCase().includes(C)||(D==null?void 0:D.name.toLowerCase().includes(C)),P=!T||R.paymentMethod===T,O=!b||R.categoryId===b;return N&&P&&O}),H.sort((R,C)=>{const D=new Date(R.date),P=new Date(C.date).getTime()-D.getTime();if(P===0){const O=parseInt(R.id.replace("trans-","").split("-")[0]);return parseInt(C.id.replace("trans-","").split("-")[0])-O}return P})},[n,e,g,T,b,V,L,t]),Q=he.useMemo(()=>F.reduce((H,R)=>(R.type==="income"||R.type.toString().includes("payment")||R.type==="investment-withdrawal"?H.positive+=R.amount:H.negative+=R.amount,H),{positive:0,negative:0}),[F]);return d.jsx("div",{className:"space-y-6 animate-fade-in",children:d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),d.jsx("input",{type:"date",id:"dateFrom",value:V,onChange:H=>U(H.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),d.jsx("input",{type:"date",id:"dateTo",value:L,onChange:H=>G(H.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),d.jsxs("select",{id:"filterMethod",value:T,onChange:H=>x(H.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(H=>d.jsxs("option",{value:H.id,children:["🏦 ",H.name]},H.id)),d.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(H=>d.jsxs("option",{value:H.id,children:["💳 ",H.name]},H.id)),d.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),d.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),d.jsxs("select",{id:"filterCategory",value:b,onChange:H=>w(H.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الفئات"}),t.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]})]}),d.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[d.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),d.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:g,onChange:H=>m(H.target.value),className:"p-2 w-full"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),d.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),d.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:d.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:Oe(Q.positive)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),d.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),d.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:d.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:Oe(Q.negative)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),d.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),d.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:d.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:Oe(Q.positive-Q.negative)})})]})]}),d.jsxs("div",{className:"overflow-x-auto",children:[d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),d.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),d.jsx("tbody",{children:F.map(H=>{const R=t.find(D=>D.id===H.categoryId),C=H.type==="income"||H.type.toString().includes("payment")||H.type==="investment-withdrawal";return d.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[d.jsx("td",{className:"p-3",children:H.date}),d.jsx("td",{className:"p-3",children:W(H.paymentMethod)}),d.jsx("td",{className:"p-3",children:ee(H.type)}),d.jsxs("td",{className:`p-3 font-semibold number-display ${C?"text-emerald-500":"text-red-500"}`,children:[C?"+":"-"," ",Oe(H.amount)]}),d.jsx("td",{className:"p-3",children:R?`${R.icon} ${R.name}`:"غير محدد"}),d.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:H.description||"-"}),d.jsx("td",{className:"p-3 text-center",children:d.jsxs("div",{className:"flex gap-2 justify-center",children:[d.jsx("button",{onClick:()=>a(H.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),d.jsx("button",{onClick:()=>i(H.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:d.jsx(Fo,{})})]})})]},H.id)})})]}),F.length===0&&d.jsxs("div",{className:"text-center p-8 text-slate-500",children:[d.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),d.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},cU=()=>d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),dU=({calculations:n,filteredTransactions:e,allTransactions:t,state:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=he.useState([{id:"1",text:`مرحباً! أنا مساعدك الذكي 🤖✨

🔍 **يمكنني مساعدتك في:**
• تحليل بياناتك المالية عبر جميع الأشهر
• البحث عن أفضل العروض والأسعار في السعودية
• مقارنة الأسعار والمطاعم

💬 **اسألني مثلاً:**
• "كم صرفت هذا الشهر؟"
• "أين أفضل عروض في الرياض؟"
• "كم سعر الهاتف في سوق اليوم؟"

ماذا تريد أن تعرف؟ 😊`,sender:"ai"}]),[g,m]=he.useState(""),[T,x]=he.useState(!1),b=he.useRef(null);he.useEffect(()=>{var V;(V=b.current)==null||V.scrollTo(0,b.current.scrollHeight)},[u,T]);const w=async V=>{V.preventDefault();const U=g.trim();if(!U||T)return;const L={id:Date.now().toString(),text:U,sender:"user"};f(G=>[...G,L]),m(""),x(!0);try{let G="";const W=["أين","كم سعر","عروض","محل","مطعم","بنده","تميمي","كارفور","عروض","سعر","أفضل","تقييم","مطاعم","متاجر","عرض","أرخص","غالي","السوق","متجر","مطعم","مقهى","كوفي","برجر","بيتزا","شاورما","دجاج","لحم","سمك","أكل","طعام","شراب","مشروب","قهوة","شاي"],ee=["مصروف","دخل","ديون","بطاقة","شهر","تحليل","نمط","إنفاق","رصيد","قرض","قسط","استثمار","مالي","حساب","صرفت","وصل","تحويل","دفع","قسط","باقي","متوسط","إجمالي","شهر","أسبوع","سنة","مقارنة","تغير","زيادة","نقص","أعلى","أقل"],F=W.some(R=>U.toLowerCase().includes(R.toLowerCase())),Q=ee.some(R=>U.toLowerCase().includes(R.toLowerCase()));if(F)G=await _E(U);else if(Q){const R={currentPeriod:{calculations:n,transactions:e},allHistoricalData:{allTransactions:t,categories:i.categories,cards:i.cards,bankAccounts:i.bankAccounts,loans:i.loans,installments:i.installments,investments:i.investments},state:i};G=await vE(U,R)}else G=await TE(U,t,n);const H={id:(Date.now()+1).toString(),text:G,sender:"ai"};f(R=>[...R,H])}catch(G){const W={id:(Date.now()+1).toString(),text:G instanceof Error?G.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};f(ee=>[...ee,W])}finally{x(!1)}};return d.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[d.jsxs("div",{className:`p-4 ${a?"bg-slate-800":"bg-gray-100"} text-center flex-shrink-0`,children:[d.jsx("h3",{className:`text-xl font-bold ${a?"text-slate-100":"text-slate-900"}`,children:"🤖 المحلل الذكي"}),d.jsx("p",{className:`text-sm ${a?"text-slate-400":"text-slate-500"}`,children:"تحليل بياناتك المالية + البحث عن أفضل العروض في السعودية"})]}),d.jsxs("div",{ref:b,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[u.map(V=>d.jsx("div",{className:`chat-bubble ${V.sender==="user"?"user-bubble":"ai-bubble"}`,children:d.jsx("p",{dangerouslySetInnerHTML:{__html:V.text.replace(/\n/g,"<br />")}})},V.id)),T&&d.jsx(cU,{})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:w,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:g,onChange:V=>m(V.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:T}),d.jsx("button",{type:"submit",disabled:T,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:d.jsx(uS,{})})]})})]})},fU=({calculations:n,categories:e,allTransactions:t,darkMode:i=!1,language:a="ar"})=>{const l=he.useRef(null),u=he.useRef(null),f=he.useRef({}),g=he.useMemo(()=>Object.entries(n.expensesByCategory).map(([T,x])=>{const b=e.find(w=>w.id===T);return{name:b?`${b.icon} ${b.name}`:"غير محدد",value:x}}).sort((T,x)=>x.value-T.value),[n.expensesByCategory,e]),m=he.useMemo(()=>{const T={},x=new Date;for(let b=5;b>=0;b--){const V=new Date(x.getFullYear(),x.getMonth()-b,1).toLocaleString("en-US",{month:"short",year:"numeric"});T[V]={income:0,expenses:0}}return t.forEach(b=>{const V=new Date(b.date).toLocaleString("en-US",{month:"short",year:"numeric"});T[V]&&(b.type==="income"&&(T[V].income+=b.amount),(b.type==="expense"||b.type==="bnpl-payment")&&(T[V].expenses+=b.amount))}),{labels:Object.keys(T),incomeData:Object.values(T).map(b=>b.income),expensesData:Object.values(T).map(b=>b.expenses)}},[t]);return he.useEffect(()=>{var x,b;const T=window.Chart;if(T){if((x=f.current.pie)==null||x.destroy(),(b=f.current.bar)==null||b.destroy(),l.current&&g.length>0){const w=l.current.getContext("2d");w&&(f.current.pie=new T(w,{type:"doughnut",data:{labels:g.map(V=>V.name),datasets:[{data:g.map(V=>V.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(u.current&&m.labels.length>0){const w=u.current.getContext("2d");w&&(f.current.bar=new T(w,{type:"bar",data:{labels:m.labels,datasets:[{label:"الدخل",data:m.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:m.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var w,V;(w=f.current.pie)==null||w.destroy(),(V=f.current.bar)==null||V.destroy()}}},[g,m]),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📊 توزيع مصاريف الفترة"}),d.jsx("div",{className:"h-80",children:g.length>0?d.jsx("canvas",{ref:l}):d.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),d.jsx("div",{className:"h-80",children:d.jsx("canvas",{ref:u})})]})]})},hU=({state:n,setLoading:e,setModal:t,darkMode:i=!1,language:a="ar"})=>{const[l,u]=he.useState(""),[f,g]=he.useState(""),m=async()=>{const T=parseFloat(l);if(isNaN(T)||T<=0){t({title:ie("error",a),body:`<p>${ie("invalid.amount",a)}</p>`,confirmText:ie("confirm",a),hideCancel:!0});return}e(!0,ie("loading",a)),g("");try{const x=new Date;x.setDate(x.getDate()-60);const b=n.transactions.filter(V=>new Date(V.date)>=x&&V.type==="expense");if(b.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const w=await gE(T,n.categories,b);g(w)}catch(x){const b=x instanceof Error?x.message:"حدث خطأ غير متوقع.";t({title:ie("error",a),body:`<p>${b}</p>`,confirmText:ie("confirm",a),hideCancel:!0})}finally{e(!1)}};return d.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[d.jsxs("h3",{className:`text-xl font-bold mb-4 ${i?"text-slate-200":"text-slate-900"}`,children:["✨ ",ie("budget",a)]}),d.jsxs("div",{className:`flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 rounded-lg ${i?"bg-slate-700":"bg-slate-100"}`,children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("label",{htmlFor:"monthly-budget-input",className:`block text-sm font-medium mb-1 ${i?"text-slate-300":"text-slate-600"}`,children:ie("budget.limit",a)}),d.jsx("input",{type:"number",id:"monthly-budget-input",className:`w-full p-2 ${i?"bg-slate-600 text-slate-200 border-slate-500":"bg-white text-slate-900 border-gray-300"} border rounded`,placeholder:"5000",value:l,onChange:T=>u(T.target.value)})]}),d.jsxs("button",{onClick:m,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:["✨ ",ie("generate.report",a)]})]}),d.jsx("div",{className:"prose max-w-none",children:f?d.jsx("div",{className:i?"text-slate-200":"text-slate-900",dangerouslySetInnerHTML:{__html:f.replace(/### (.*)/g,`<h4 class="text-lg font-bold ${i?"text-slate-200":"text-slate-900"} mt-3 mb-2">$1</h4>`).replace(/\n/g,"<br />")}}):d.jsx("p",{className:`text-center ${i?"text-slate-400":"text-slate-500"}`,children:ie("no.data",a)})})]})},mU=({state:n,setState:e,calculations:t,setModal:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=he.useState([{id:"1",text:`مرحباً! أنا مستشارك الاستثماري الذكي 🎯📈

💼 **خبرتي تشمل:**
• تحليل شامل لسوق تداول السعودي
• استراتيجيات استثمارية متقدمة
• إدارة المخاطر وتحسين المحافظ
• توصيات أسهم محددة مع تحليل عميق

📊 **يمكنني مساعدتك في:**
• تحليل محفظتك الحالية وتحسينها
• توصيات أسهم مع أهداف سعرية واضحة
• قراءة السوق وتوقعات الاتجاهات
• استراتيجيات دخول وخروج محددة

💡 **اسألني مثلاً:**
• "ما رأيك في أسهم أرامكو الآن؟"
• "كيف أحسن محفظتي الاستثمارية؟"
• "ما هي أفضل القطاعات للاستثمار؟"
• "أريد تحليل شامل لسوق اليوم"

أخبرني عن محفظتك وأهدافك الاستثمارية! 🚀`,sender:"ai"}]),[g,m]=he.useState(""),[T,x]=he.useState(!1),b=he.useRef(null);he.useEffect(()=>{var L;(L=b.current)==null||L.scrollTo(0,b.current.scrollHeight)},[u,T]);const w=L=>{L.preventDefault();const G=L.target,W=parseFloat(G.elements.namedItem("investment-amount").value),ee=G.elements.namedItem("investment-type").value,F=G.elements.namedItem("payment-method").value;if(isNaN(W)||W<=0){i({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const Q={amount:W,date:new Date().toISOString().split("T")[0],description:ee==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:F,type:ee==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(H=>({...H,transactions:[...H.transactions,{...Q,id:`trans-${Date.now()}`}]})),G.reset()},V=async L=>{L.preventDefault();const G=g.trim();if(!(!G||T)){f(W=>[...W,{id:Date.now().toString(),text:G,sender:"user"}]),m(""),x(!0);try{const W={currentValue:n.investments.currentValue,totalDeposited:n.investments.totalDeposited,totalWithdrawn:n.investments.totalWithdrawn,transactions:n.transactions.filter(F=>F.type==="investment-deposit"||F.type==="investment-withdrawal"),recentPerformance:t.investments},ee=await xE(G,W,{marketDate:new Date().toLocaleDateString("en-CA"),saudiMarketContext:"Tadawul analysis requested",userInvestmentHistory:W});f(F=>[...F,{id:(Date.now()+1).toString(),text:ee,sender:"ai"}])}catch(W){f(ee=>[...ee,{id:(Date.now()+1).toString(),text:W instanceof Error?W.message:"عذراً، حدث خطأ في الاستشارة الاستثمارية.",sender:"ai"}])}finally{x(!1)}}},U=()=>{const L=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;i({show:!0,title:"تحديث قيمة المحفظة",body:L,confirmText:"حفظ",onConfirm:()=>{const G=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(G)||G<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(W=>({...W,investments:{...W.investments,currentValue:G}}))}})};return d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[d.jsxs("div",{className:"glass-card p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),d.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:Oe(n.investments.currentValue)}),d.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",d.jsx("span",{className:"font-semibold number-display text-slate-600",children:Oe(t.totalInvestmentDeposits)})]}),d.jsx("button",{onClick:U,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),d.jsxs("form",{onSubmit:w,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),d.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),d.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[d.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),d.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),d.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(L=>d.jsxs("option",{value:L.id,children:["🏦 ",L.name]},L.id))})]}),d.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),d.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[d.jsxs("div",{className:`p-4 ${a?"bg-slate-800":"bg-gray-100"} text-center flex-shrink-0`,children:[d.jsx("h3",{className:`text-xl font-bold ${a?"text-slate-100":"text-slate-900"}`,children:"🎯 مستشارك الاستثماري المتقدم"}),d.jsx("p",{className:`text-sm ${a?"text-slate-400":"text-slate-500"}`,children:"تحليل السوق + توصيات أسهم + إدارة المحافظ"})]}),d.jsxs("div",{ref:b,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[u.map(L=>d.jsx("div",{className:`chat-bubble ${L.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:L.text.replace(/\n/g,"<br/>")}},L.id)),T&&d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:V,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:g,onChange:L=>m(L.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:T}),d.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:T,children:d.jsx(uS,{})})]})})]})]})},pU=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:i})=>{const a=(l,u)=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(f=>{var x;const g=((x=f.description)==null?void 0:x.includes(`سداد ${u.name}`))||f.type===`سداد ${u.name}`||f.type===`${u.id}-payment`,m=g?"text-green-500":"text-red-500",T=g?"+":"";return`
                <tr class="hover:bg-slate-50">
                    <td class="p-2">${f.postingDate||f.date}</td>
                    <td class="p-2 truncate" title="${f.description}">${f.description}</td>
                    <td class="p-2 number-display ${m}">${T}${Oe(f.amount)}</td>
                </tr>
            `}).join("");return d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>i(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:d.jsx(Fo,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),d.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),d.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:d.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[Oe(e.statementDueAmount)," ريال"]})}),d.jsxs("div",{className:"flex justify-between items-center text-xs",children:[d.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),d.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),d.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:d.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),d.jsxs("p",{className:"font-bold text-red-800 number-display",children:[Oe(n.balance)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),d.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[Oe(n.limit)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[d.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),d.jsxs("p",{className:"font-bold text-green-800 number-display",children:[Oe(n.available)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[d.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),d.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),d.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[d.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),d.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:d.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${a(e.upcomingTransactions,n)}</tbody>`}})})]})]})},gU=({state:n,calculations:e,openCardFormModal:t,deleteCard:i})=>{const a=he.useMemo(()=>{const u={};return Object.values(n.cards).forEach(f=>{const g=new Date,m=g.getDate(),T=g.getMonth(),x=g.getFullYear();let b,w,V;m>f.statementDay?b=new Date(x,T,f.statementDay):b=new Date(x,T-1,f.statementDay),w=new Date(b.getFullYear(),b.getMonth()-1,f.statementDay+1);let U=b.getMonth()+1,L=b.getFullYear();U>11&&(U=0,L+=1),V=new Date(L,U,f.dueDay);const G=n.transactions.filter(F=>{const Q=new Date(F.postingDate||F.date);return F.paymentMethod===f.id&&(F.type==="expense"||F.type==="bnpl-payment")&&Q>=w&&Q<=b}),W=n.transactions.filter(F=>{var D,N,P,O,k,Ue,Be;const Q=new Date(F.postingDate||F.date),H=F.paymentMethod===f.id&&(F.type==="expense"||F.type==="bnpl-payment"),R=(((D=F.description)==null?void 0:D.includes(`سداد ${f.name}`))||F.type===`سداد ${f.name}`||F.type===`${f.id}-payment`)&&(F.type==="expense"||((N=F.type)==null?void 0:N.includes("سداد"))||((P=F.type)==null?void 0:P.includes("-payment"))),C=F.paymentMethod===f.id&&(((O=F.description)==null?void 0:O.includes("سداد"))||((k=F.type)==null?void 0:k.includes("سداد"))||((Ue=F.type)==null?void 0:Ue.includes("-payment")))&&!((Be=F.description)!=null&&Be.includes(f.name))&&F.type!==`سداد ${f.name}`&&F.type!==`${f.id}-payment`;return(H||R||C)&&Q>b}),ee=G.reduce((F,Q)=>F+Q.amount,0);u[f.id]={statementDueAmount:ee,dueDate:V,totalOutstanding:0,upcomingTransactions:W}}),u},[n.transactions,n.cards]),l=Object.values(n.cards);return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),d.jsx("button",{onClick:()=>t(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map(u=>{const f=e.cardDetails[u.id];return d.jsx(pU,{card:f,statementDetails:a[f.id],openCardFormModal:t,deleteCard:i},f.id)})})]})},yU=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const i=n.replace("-payment","");if(e.cards[i])return`💳 سداد ${e.cards[i].name}`}return n},vU=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),d.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:d.jsx(Fo,{})})]})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),d.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:Oe(n.balance)})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:Oe(n.deposits)})]}),d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:Oe(n.withdrawals)})]})]})]}),_U=({state:n,setState:e,calculations:t,filteredTransactions:i,categories:a,setModal:l,openBankAccountFormModal:u,deleteBankAccount:f,openTransferModal:g})=>d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),d.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&d.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(m=>d.jsx(vU,{account:m,openBankAccountFormModal:u,deleteBankAccount:f},m.id))}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),d.jsx("tbody",{children:i.filter(m=>n.bankAccounts[m.paymentMethod]).sort((m,T)=>new Date(T.date).getTime()-new Date(m.date).getTime()).map(m=>{var w;const T=["income","investment-withdrawal"].includes(m.type),x=T?"text-emerald-500":"text-red-500",b=a.find(V=>V.id===m.categoryId);return d.jsxs("tr",{className:"border-b border-gray-200/50",children:[d.jsx("td",{className:"p-3",children:m.date}),d.jsx("td",{className:"p-3",children:(w=n.bankAccounts[m.paymentMethod])==null?void 0:w.name}),d.jsx("td",{className:"p-3",children:yU(m.type,n)}),d.jsxs("td",{className:`p-3 font-semibold ${x} number-display`,children:[T?"+":"-",Oe(m.amount)]}),d.jsx("td",{className:"p-3",children:b?`${b.icon} ${b.name}`:"-"}),d.jsx("td",{className:"p-3 text-slate-500",children:m.description||"-"})]},m.id)})})]})})]})]}),_d=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},TU=({state:n,setState:e,filteredTransactions:t,setModal:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=wp.useState(!1),g=()=>{const F=n.installments.filter(N=>N.paid<N.total),Q=F.filter(N=>N.provider==="tabby-bnpl"),H=F.filter(N=>N.provider==="tamara-bnpl"),R=Q.reduce((N,P)=>{const O=P.total-P.paid;return N+P.installmentAmount*O},0),C=H.reduce((N,P)=>{const O=P.total-P.paid;return N+P.installmentAmount*O},0),D=R+C;return{tabbyTotal:R,tamaraTotal:C,grandTotal:D,activeCount:F.length,completedCount:n.installments.filter(N=>N.paid>=N.total).length}},m=()=>{const F=n.installments.filter(R=>R.paid<R.total);if(F.length===0)return null;const Q=n.transactions.filter(R=>R.isInstallmentPayment);if(Q.length===0){const R=F.sort((N,P)=>new Date(N.createdAt).getTime()-new Date(P.createdAt).getTime())[0],C=new Date(R.createdAt),D=new Date(C);return D.setDate(D.getDate()+30),D.toISOString().split("T")[0]}let H=null;for(const R of F){const C=Q.filter(D=>D.installmentId===R.id).sort((D,N)=>new Date(N.date).getTime()-new Date(D.date).getTime());if(C.length>0){const D=C[0],N=new Date(D.date),P=new Date(N);P.setDate(P.getDate()+30),(!H||P<new Date(H))&&(H=P.toISOString().split("T")[0])}else{const D=new Date(R.createdAt),N=new Date(D);N.setDate(N.getDate()+30),(!H||N<new Date(H))&&(H=N.toISOString().split("T")[0])}}return H},T=()=>n.installments.filter(Q=>Q.paid<Q.total).reduce((Q,H)=>Q+H.installmentAmount,0),x=()=>{const F=n.installments.filter(H=>H.paid<H.total),Q=n.transactions.filter(H=>H.isInstallmentPayment);return F.map(H=>{const R=Q.filter(D=>D.installmentId===H.id).sort((D,N)=>new Date(N.date).getTime()-new Date(D.date).getTime());let C;if(R.length>0){const D=R[0],N=new Date(D.date),P=new Date(N);P.setDate(P.getDate()+30),C=P.toISOString().split("T")[0]}else{const D=new Date(H.createdAt),N=new Date(D);N.setDate(N.getDate()+30),C=N.toISOString().split("T")[0]}return{installment:H,nextPaymentDate:C}}).sort((H,R)=>new Date(H.nextPaymentDate).getTime()-new Date(R.nextPaymentDate).getTime())},b=F=>{const Q=n.transactions.find(C=>C.id===F);if(!Q||!Q.isInstallmentPayment||!n.installments.find(C=>C.id===Q.installmentId))return;const R=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${Q.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${Q.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${Q.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(C=>`<option value="${C.id}" ${Q.paymentMethod===C.id?"selected":""}>🏦 ${C.name}</option>`).join("")}
                        <option value="cash" ${Q.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(C=>`<option value="${C.id}" ${Q.paymentMethod===C.id?"selected":""}>💳 ${C.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;i({show:!0,title:"تعديل حركة القسط",body:R,confirmText:"حفظ التعديلات",onConfirm:()=>{const C=parseFloat(document.getElementById("edit-amount").value),D=document.getElementById("edit-date").value,N=document.getElementById("edit-description").value,P=document.getElementById("edit-payment-method").value;e(O=>({...O,transactions:O.transactions.map(k=>k.id===F?{...k,amount:C,date:D,description:N,paymentMethod:P}:k)})),i({show:!1})}})},w=F=>{const Q=n.transactions.find(R=>R.id===F);if(!Q||!Q.isInstallmentPayment)return;i({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const R=Q.installmentId;e(C=>({...C,transactions:C.transactions.filter(D=>D.id!==F),installments:C.installments.map(D=>D.id===R?{...D,paid:Math.max(0,D.paid-1)}:D)})),i({show:!1})}})},V=F=>{const Q=n.installments.find(R=>R.id===F);if(!Q)return;const H=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${Q.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${Q.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${Q.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${Q.paid}" min="0" max="${Q.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;i({show:!0,title:"تعديل خطة القسط",body:H,confirmText:"حفظ التعديلات",onConfirm:()=>{const R=document.getElementById("edit-description").value,C=parseFloat(document.getElementById("edit-amount").value),D=parseInt(document.getElementById("edit-total").value),N=parseInt(document.getElementById("edit-paid").value);e(P=>({...P,installments:P.installments.map(O=>O.id===F?{...O,description:R,installmentAmount:C,total:D,paid:N}:O)})),i({show:!1})}})},U=F=>{const Q=n.installments.find(R=>R.id===F);if(!Q)return;const H=`<p>هل أنت متأكد من حذف خطة القسط "${Q.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;i({show:!0,title:"حذف خطة القسط",body:H,confirmText:"حذف",onConfirm:()=>{e(R=>({...R,installments:R.installments.filter(C=>C.id!==F),transactions:R.transactions.filter(C=>C.installmentId!==F)})),i({show:!1})}})},L=F=>{const Q=n.installments.find(C=>C.id===F);if(!Q||Q.paid>=Q.total)return;let H="";Object.values(n.bankAccounts).forEach(C=>{H+=`<option value="${C.id}">🏦 ${C.name}</option>`}),H+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(C=>{H+=`<option value="${C.id}">💳 ${C.name}</option>`});const R=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${Q.description}" بقيمة ${Oe(Q.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${H}</select></div>`;i({show:!0,title:"سداد قسط",body:R,confirmText:"تأكيد الدفع",onConfirm:()=>{var O;const C=document.getElementById("installment-payment-source").value,D=n.categories.find(k=>k.name==="سداد فواتير"||k.name==="💳 سداد فواتير"),N=(D==null?void 0:D.id)||((O=n.categories.find(k=>k.name==="أخرى"))==null?void 0:O.id)||"",P={id:"trans-"+Date.now(),amount:Q.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${Q.paid+1} لـ: ${Q.description}`,paymentMethod:C,type:"bnpl-payment",categoryId:N,isInstallmentPayment:!0,installmentId:F};e(k=>{const Ue=k.installments.map(Be=>{if(Be.id===F){const te={...Be,paid:Be.paid+1};return console.log("🔄 تحديث قسط:",{id:Be.id,paid:Be.paid,newPaid:te.paid,total:Be.total}),te}return Be});return{...k,transactions:[...k.transactions,P],installments:Ue}})}})},G=n.installments.filter(F=>F.paid<F.total),W=n.transactions.filter(F=>F.isInstallmentPayment),ee=g();return m(),T(),d.jsxs("div",{className:"animate-fade-in",children:[d.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[d.jsx("div",{className:"flex justify-between items-start mb-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"ملخص الأقساط"}),d.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"🎯"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Oe(ee.grandTotal)})]}),d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Oe(ee.tabbyTotal)})]}),d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Oe(ee.tamaraTotal)})]})]}),x().length>0&&d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("span",{className:"text-2xl",children:"⏰"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),d.jsx("div",{className:"space-y-2",children:x().slice(0,3).map((F,Q)=>d.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-slate-700",children:F.installment.description}),d.jsx("p",{className:"text-xs text-slate-500",children:_d(F.installment.provider,n)})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(F.nextPaymentDate).toLocaleDateString("en-GB")}),d.jsx("p",{className:"text-xs text-slate-600",children:Oe(F.installment.installmentAmount)})]})]},F.installment.id))})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"flex gap-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ee.activeCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),d.jsx("div",{className:"text-center",children:d.jsxs("button",{onClick:()=>f(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[d.jsx("p",{className:"text-2xl font-bold text-green-600",children:ee.completedCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),x().length>0&&d.jsx("button",{onClick:()=>{n.installments.filter(Q=>Q.paid<Q.total).forEach(Q=>{L(Q.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),d.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📱 خطط الأقساط النشطة"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:G.length>0?G.map(F=>{const Q=F.paid/F.total*100;return console.log("📊 عرض قسط:",{id:F.id,paid:F.paid,total:F.total,progress:Q}),d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:F.description}),d.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:_d(F.provider,n)})]})]}),d.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:d.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[Oe(F.installmentAmount),"/شهر"]})})]}),d.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg border border-gray-200 dark:border-slate-700 mb-3",children:[d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:d.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${Q}%`}})}),d.jsxs("div",{className:"flex justify-between text-xs text-slate-600 dark:text-slate-400",children:[d.jsxs("span",{className:"font-medium",children:[F.paid," / ",F.total," مدفوع"]}),d.jsxs("span",{className:"font-medium",children:["متبقي: ",F.total-F.paid]})]}),d.jsx("div",{className:"text-center mt-2",children:d.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[Q.toFixed(1),"% مكتمل"]})})]}),d.jsxs("div",{className:"flex gap-2 mt-3",children:[d.jsx("button",{onClick:()=>L(F.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),d.jsx("button",{onClick:()=>V(F.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),d.jsx("button",{onClick:()=>U(F.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},F.id)}):d.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:d.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),d.jsxs("div",{className:"glass-card p-6 mt-8",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📋 سجل دفعات الأقساط"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200 dark:border-slate-700",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"الوصف"}),d.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"المصدر"}),d.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"الإجراءات"})]})}),d.jsx("tbody",{children:W.sort((F,Q)=>new Date(Q.date).getTime()-new Date(F.date).getTime()).map(F=>d.jsxs("tr",{className:"border-b border-gray-200/50 dark:border-slate-700/50 text-slate-700 dark:text-slate-300",children:[d.jsx("td",{className:"p-3",children:new Date(F.date).toLocaleDateString("en-GB")}),d.jsx("td",{className:"p-3 text-slate-600 dark:text-slate-400",children:F.description}),d.jsx("td",{className:"p-3",children:_d(F.paymentMethod,n)}),d.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:Oe(F.amount)}),d.jsx("td",{className:"p-3",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>b(F.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),d.jsx("button",{onClick:()=>w(F.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},F.id))})]})})]}),u&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:F=>F.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),d.jsx("button",{onClick:()=>f(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(F=>F.paid>=F.total).map(F=>d.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-green-800",children:F.description}),d.jsx("p",{className:"text-sm text-green-600",children:_d(F.provider,n)})]}),d.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:F.total}),d.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:Oe(F.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:Oe(F.total*F.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},F.id)),Object.values(n.installments).filter(F=>F.paid>=F.total).length===0&&d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),d.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),d.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),d.jsx("div",{className:"flex justify-end mt-6",children:d.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},Fx=({onClose:n,onSave:e,initialData:t,type:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=he.useState({[i==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[g,m]=he.useState({});wp.useEffect(()=>{t&&f(t)},[t]);const T=V=>{const{name:U,value:L}=V.target;f(G=>({...G,[U]:U==="amount"?parseFloat(L)||0:L})),g[U]&&m(G=>({...G,[U]:""}))},x=()=>{const V={};return u[i==="toMe"?"debtor":"creditor"]||(V[i==="toMe"?"debtor":"creditor"]="اسم المدين/الدائن مطلوب"),u.amount<=0&&(V.amount="المبلغ يجب أن يكون أكبر من صفر"),u.description.trim()||(V.description="وصف الدين مطلوب"),u.date||(V.date="تاريخ الدين مطلوب"),m(V),Object.keys(V).length===0},b=V=>{V.preventDefault(),x()&&e(u,t==null?void 0:t.id)},w=i==="toMe";return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:V=>V.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:w?"إضافة دين لي":"إضافة دين علي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(qu,{})})]}),d.jsxs("form",{onSubmit:b,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:w?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:w?"اسم المدين":"اسم الدائن"}),d.jsx("input",{type:"text",id:w?"debtor":"creditor",name:w?"debtor":"creditor",value:u[w?"debtor":"creditor"],onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w?"اسم الشخص الذي يدين لي":"اسم الشخص الذي أدين له",required:!0}),g[w?"debtor":"creditor"]&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g[w?"debtor":"creditor"]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",value:u.amount,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),g.amount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.amount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:w?"من أين دينني":"أين أضفت الدين"}),d.jsx("input",{type:"text",id:"source",name:"source",value:u.source,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w?"مثال: بنك الراجحي، تطبيق ستور":"مثال: بنك الأهلي، تطبيق تابي"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"السبب (اختياري)"}),d.jsx("textarea",{id:"reason",name:"reason",value:u.reason,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"سبب الدين أو تفاصيل إضافية..."})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"وصف الدين"}),d.jsx("input",{type:"text",id:"description",name:"description",value:u.description,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف مختصر للدين",required:!0}),g.description&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.description})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ الدين"}),d.jsx("input",{type:"date",id:"date",name:"date",value:u.date,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.date&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.date})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"الحالة"}),d.jsxs("select",{id:"status",name:"status",value:u.status,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"pending",children:"معلق"}),d.jsx("option",{value:"partial",children:"جزئي"}),d.jsx("option",{value:"paid",children:"مدفوع"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"إضافة الدين"})]})]})]})})})},xU=({state:n,setState:e,setModal:t,openLoanFormModal:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=he.useState("loans"),[g,m]=he.useState(!1),[T,x]=he.useState(!1),[b,w]=he.useState(!1),V=N=>{switch(N){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},U=N=>{switch(N){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},L=N=>{switch(N){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},G=N=>{switch(N){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},W=N=>{e(P=>({...P,loans:Object.fromEntries(Object.entries(P.loans).filter(([O])=>O!==N))}))},ee=N=>{const P={...N,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(O=>({...O,debtsToMe:{...O.debtsToMe,[P.id]:P}})),x(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين من "${P.debtor}" بقيمة ${Oe(P.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},F=N=>{const P={...N,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(O=>({...O,debtsFromMe:{...O.debtsFromMe,[P.id]:P}})),w(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين لـ "${P.creditor}" بقيمة ${Oe(P.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},Q=N=>{e(P=>({...P,debtsToMe:Object.fromEntries(Object.entries(P.debtsToMe).filter(([O])=>O!==N))}))},H=N=>{e(P=>({...P,debtsFromMe:Object.fromEntries(Object.entries(P.debtsFromMe).filter(([O])=>O!==N))}))},R=Object.values(n.loans).filter(N=>N.status==="active").length,C=Object.values(n.debtsToMe).filter(N=>N.status!=="paid").length,D=Object.values(n.debtsFromMe).filter(N=>N.status!=="paid").length;return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"📊 الديون والقروض"})}),d.jsxs("div",{className:"flex space-x-1 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[d.jsxs("button",{onClick:()=>f("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="loans"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["🏦 القروض (",R,")"]}),d.jsxs("button",{onClick:()=>f("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-to-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["💰 الديون لي (",C,")"]}),d.jsxs("button",{onClick:()=>f("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-from-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["💸 الديون علي (",D,")"]})]}),u==="loans"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),d.jsx("button",{onClick:()=>i(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),d.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(N=>d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:V(N.type)})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:N.name}),d.jsxs("p",{className:"text-sm text-slate-500",children:[U(N.type)," - ",N.lender]})]})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>i(N.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${N.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>W(N.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${N.name}`,children:d.jsx(Fo,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Oe(N.totalAmount)})]}),(N.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[d.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),d.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((N.prepaidAmount||0)/N.totalAmount*100),"%"]})]}),d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(N.prepaidAmount||0)/N.totalAmount*100}%`}})}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[d.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[d.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((N.prepaidAmount||0)/N.monthlyPayment)}),d.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),d.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[d.jsx("p",{className:"text-blue-700 font-bold text-sm",children:N.totalMonths-Math.floor((N.prepaidAmount||0)/N.monthlyPayment)}),d.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Oe(N.monthlyPayment)})]}),d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),d.jsxs("p",{className:"font-semibold text-slate-800",children:[N.remainingMonths||0," شهر"]})]})]}),(N.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),d.jsx("p",{className:"text-orange-900 font-bold text-lg",children:Oe(N.prepaidAmount||0)})]}),d.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),d.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(N.status)}`,children:G(N.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(N.startDate).toLocaleDateString("en-GB")]})]})]})]},N.id))})]}),u==="debts-to-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),d.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💰"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(N=>d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:N.debtor}),d.jsx("p",{className:"text-sm text-slate-500",children:N.description})]}),d.jsx("button",{onClick:()=>Q(N.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${N.debtor}`,children:d.jsx(Fo,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-green-900",children:Oe(N.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(N.status)}`,children:G(N.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(N.date).toLocaleDateString("ar-SA")]})]})]})]},N.id))})]}),u==="debts-from-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),d.jsx("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💸"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(N=>d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:N.creditor}),d.jsx("p",{className:"text-sm text-slate-500",children:N.description})]}),d.jsx("button",{onClick:()=>H(N.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${N.creditor}`,children:d.jsx(Fo,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-red-900",children:Oe(N.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(N.status)}`,children:G(N.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(N.date).toLocaleDateString("ar-SA")]})]})]})]},N.id))})]}),T&&d.jsx(Fx,{onClose:()=>x(!1),onSave:ee,type:"toMe"}),b&&d.jsx(Fx,{onClose:()=>w(!1),onSave:F,type:"fromMe"})]})},EU=({state:n,setState:e,setModal:t,setLoading:i,onRestore:a,darkMode:l=!1,language:u="ar"})=>{const[f,g]=he.useState(Vo()),[m,T]=he.useState({connected:!1}),[x,b]=he.useState(!0),[w,V]=he.useState({firebase:f.hasFirebase,gemini:f.hasGemini});he.useEffect(()=>{const me=Vo();g(me),V({firebase:me.hasFirebase,gemini:me.hasGemini}),me.hasFirebase?(async()=>{try{b(!0);const Ge=await Ri.getData("test","connection");T({connected:!0})}catch(Ge){T({connected:!1,error:Ge instanceof Error?Ge.message:"خطأ في الاتصال"})}finally{b(!1)}})():(T({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),b(!1))},[]);const U=({isValid:me})=>me?d.jsx(Bm,{className:"w-6 h-6 text-green-500"}):d.jsx(zm,{className:"w-6 h-6 text-red-500"}),L=()=>d.jsx(eU,{className:"w-6 h-6 text-yellow-500"}),[G,W]=he.useState({name:"",icon:""}),[ee,F]=he.useState(null),[Q,H]=he.useState({name:"",icon:""}),[R,C]=he.useState({name:"",icon:""}),D=()=>{if(!G.name.trim()||!G.icon.trim()){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}const ge={id:`cat-${Date.now()}`,name:G.name.trim(),icon:G.icon.trim()};e(Ge=>({...Ge,categories:[...Ge.categories,ge]})),W({name:"",icon:""}),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})},[N,P]=he.useState(!1),O=async()=>{const me=G.name.trim();if(!me){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}P(!0);try{const{suggestCategoryIcon:ge,initializeAi:Ge}=await Ai(async()=>{const{suggestCategoryIcon:Sn,initializeAi:Ln}=await Promise.resolve().then(()=>FD);return{suggestCategoryIcon:Sn,initializeAi:Ln}},void 0);Ge();const kt=await ge(me);kt&&kt.trim()?W(Sn=>({...Sn,icon:kt.trim()})):t({title:ie("error",u),body:`<p>${ie("unknown.error",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}catch(ge){console.error("Icon suggestion error:",ge),t({title:ie("error",u),body:`<p>${ie("try.again",u)}</p><p>${ie("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}finally{P(!1)}},k=me=>{n.transactions.some(ge=>ge.categoryId===me)?t({title:ie("cannot.delete",u),body:`<p>${ie("cannot.delete.category",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}):(e(ge=>({...ge,categories:ge.categories.filter(Ge=>Ge.id!==me)})),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}))},[Ue,Be]=he.useState(!1),te=async()=>{const me=Q.name.trim();if(!me){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}try{Be(!0);const ge=await Zm(me);ge&&ge.trim()?H(Ge=>({...Ge,icon:ge.trim()})):t({title:ie("error",u),body:`<p>${ie("unknown.error",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}catch(ge){console.error("Transaction type icon suggestion error:",ge),t({title:ie("error",u),body:`<p>${ie("try.again",u)}</p><p>${ie("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}finally{Be(!1)}},[Z,pe]=he.useState(!1),Me=async()=>{const me=R.name.trim();if(!me){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}try{pe(!0);const ge=await Zm(me);ge&&ge.trim()?C(Ge=>({...Ge,icon:ge.trim()})):t({title:ie("error",u),body:`<p>${ie("unknown.error",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}catch(ge){console.error("Payment method icon suggestion error:",ge),t({title:ie("error",u),body:`<p>${ie("try.again",u)}</p><p>${ie("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}finally{pe(!1)}},Re=()=>{if(!Q.name.trim()||!Q.icon.trim()){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}const ge={id:`custom-type-${Date.now()}`,name:Q.name.trim(),icon:Q.icon.trim(),isCustom:!0};e(Ge=>({...Ge,customTransactionTypes:[...Ge.customTransactionTypes||[],ge]})),H({name:"",icon:""}),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})},q=me=>{n.transactions.some(ge=>ge.type===me)?t({title:ie("cannot.delete",u),body:`<p>${ie("cannot.delete.transaction.type",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}):(e(ge=>({...ge,customTransactionTypes:(ge.customTransactionTypes||[]).filter(Ge=>Ge.id!==me)})),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}))},ae=()=>{if(!R.name.trim()||!R.icon.trim()){t({title:ie("error",u),body:`<p>${ie("required.field",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});return}const ge={id:`custom-payment-${Date.now()}`,name:R.name.trim(),icon:R.icon.trim(),isCustom:!0};e(Ge=>({...Ge,customPaymentMethods:[...Ge.customPaymentMethods||[],ge]})),C({name:"",icon:""}),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})},Te=me=>{n.transactions.some(ge=>ge.paymentMethod===me)?t({title:ie("cannot.delete",u),body:`<p>${ie("cannot.delete.payment.method",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}):(e(ge=>({...ge,customPaymentMethods:(ge.customPaymentMethods||[]).filter(Ge=>Ge.id!==me)})),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)}))},Ee=()=>{try{const me=JSON.stringify(n,null,2),ge=new Blob([me],{type:"application/json"}),Ge=URL.createObjectURL(ge),kt=document.createElement("a");kt.href=Ge,kt.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(kt),kt.click(),document.body.removeChild(kt),URL.revokeObjectURL(Ge),t({title:ie("success",u),body:"<p>تم إنشاء النسخة الاحتياطية بنجاح</p>",hideCancel:!0,confirmText:ie("confirm",u)})}catch{t({title:ie("error",u),body:"<p>فشل في إنشاء النسخة الاحتياطية</p>",hideCancel:!0,confirmText:ie("confirm",u)})}},Ie=()=>{t({title:"استعادة البيانات المحلية",body:"<p>هل تريد استعادة البيانات من النسخ الاحتياطية المحلية؟</p>",confirmText:"نعم، استعادة",onConfirm:()=>{try{let me=localStorage.getItem("financial_dashboard_backup_1");if(me||(me=localStorage.getItem("financial_dashboard_backup_2")),me){const ge=JSON.parse(me);e(ge),t({title:ie("success",u),body:"<p>تم استعادة البيانات بنجاح</p>",hideCancel:!0,confirmText:ie("confirm",u)})}else t({title:ie("error",u),body:"<p>لم توجد نسخ احتياطية محلية</p>",hideCancel:!0,confirmText:ie("confirm",u)})}catch{t({title:ie("error",u),body:"<p>فشل في استعادة البيانات</p>",hideCancel:!0,confirmText:ie("confirm",u)})}}})},ke=async()=>{i(!0,ie("loading",u));try{const me=await Ri.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(me.success)t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)});else throw new Error(me.error)}catch{t({title:ie("error",u),body:`<p>${ie("unknown.error",u)}</p>`,hideCancel:!0,confirmText:ie("confirm",u)})}finally{i(!1)}},Ye=me=>{var kt;const ge=(kt=me.target.files)==null?void 0:kt[0];if(!ge)return;const Ge=new FileReader;Ge.onload=Sn=>{var Ln;try{const _t=JSON.parse((Ln=Sn.target)==null?void 0:Ln.result);if(_t!=null&&_t.transactions&&(_t!=null&&_t.categories))a?a(_t):t({show:!0,title:ie("restore.backup",u),body:`<p>${ie("confirm.restore",u)}</p>`,confirmText:ie("confirm",u),onConfirm:()=>{const si={transactions:_t.transactions||[],categories:_t.categories||[],installments:_t.installments||[],investments:_t.investments||{currentValue:0},cards:_t.cards||{},bankAccounts:_t.bankAccounts||{}};e(si),t({title:ie("success",u),body:`<p>${ie("success",u)}</p>`,confirmText:ie("confirm",u),hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:ie("error",u),body:`<p>${ie("unknown.error",u)}</p>`,confirmText:ie("confirm",u),hideCancel:!0})}},Ge.readAsText(ge),me.target.value=""};return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsxs("h2",{className:`text-2xl font-bold ${l?"text-slate-200":"text-slate-900"}`,children:["⚙️ ",ie("settings",u)]})}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsxs("h3",{className:`text-lg font-bold mb-4 ${l?"text-slate-200":"text-slate-900"}`,children:["🔑 ",ie("api.status",u)]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${l?"bg-slate-700":"bg-slate-50"}`,children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🔥"}),d.jsxs("div",{children:[d.jsx("h4",{className:`font-semibold ${l?"text-slate-200":"text-slate-800"}`,children:"Firebase Configuration"}),d.jsxs("p",{className:`text-sm ${l?"text-slate-400":"text-slate-600"}`,children:["Project ID: ",Ft.firebase.projectId]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:w.firebase?m.connected?d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(L,{}),d.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(zm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),d.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🤖"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),d.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",Ft.gemini.model]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:w.gemini?d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):d.jsxs(d.Fragment,{children:[d.jsx(zm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!f.isValid&&d.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[d.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),d.jsx("ul",{className:"space-y-1",children:f.errors.map((me,ge)=>d.jsxs("li",{className:"text-sm text-red-600",children:["• ",me]},ge))})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📱 معلومات المشروع"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.name})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.version})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.environment})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(U,{isValid:f.isValid&&m.connected}),d.jsx("span",{className:`text-sm font-semibold ${f.isValid&&m.connected?"text-green-600":"text-red-600"}`,children:f.isValid&&m.connected?"جاهز":"يحتاج إعداد"})]})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),d.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!f.isValid||!m.connected)&&d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📝 تعليمات الإعداد"}),d.jsxs("div",{className:"space-y-4",children:[!w.gemini&&d.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),d.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[d.jsxs("li",{children:["اذهب إلى ",d.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),d.jsx("li",{children:"أنشئ مفتاح API جديد"}),d.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),d.jsxs("li",{children:["أو ضعه في ملف ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!w.firebase&&d.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),d.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",d.jsx("br",{}),"• VITE_FIREBASE_API_KEY",d.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",d.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",d.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",d.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",d.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📂 إدارة الفئات"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم الفئة",value:G.name,onChange:me=>W(ge=>({...ge,name:me.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:G.icon,onChange:me=>W(ge=>({...ge,icon:me.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:O,disabled:!G.name.trim()||N,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:N?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),d.jsx("button",{onClick:D,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(me=>d.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-lg",children:me.icon}),d.jsx("span",{className:"text-sm font-medium text-slate-800",children:me.name})]}),d.jsx("button",{onClick:()=>k(me.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},me.id))})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:Q.name,onChange:me=>H(ge=>({...ge,name:me.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:Q.icon,onChange:me=>H(ge=>({...ge,icon:me.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:te,disabled:!Q.name.trim()||Ue,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:Ue?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:Re,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(me=>d.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:me.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:me.name})]}),d.jsx("button",{onClick:()=>q(me.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},me.id))})]}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:R.name,onChange:me=>C(ge=>({...ge,name:me.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:R.icon,onChange:me=>C(ge=>({...ge,icon:me.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:Me,disabled:!R.name.trim()||Z,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:Z?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:ae,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(me=>d.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:me.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:me.name})]}),d.jsx("button",{onClick:()=>Te(me.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},me.id))})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💰 دخل"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💸 مصاريف"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 سداد قسط"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 إيداع استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 سحب استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),d.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[d.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💵 نقدي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تابي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تمارا"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💳 سداد البطاقات"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"💾 النسخ الاحتياطي والاستعادة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),d.jsx("button",{onClick:Ee,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),d.jsx("button",{onClick:ke,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),d.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:Ye}),d.jsx("button",{onClick:()=>{var me;return(me=document.getElementById("backup-file"))==null?void 0:me.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors mb-2",children:"📥 استعادة من ملف"}),d.jsx("button",{onClick:Ie,className:"w-full px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors",children:"🔄 استعادة محلية"})]})]})]}),d.jsx("div",{className:"text-center",children:d.jsx("button",{onClick:()=>{g(Vo()),window.location.reload()},disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:x?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},bU=({onClose:n,onSave:e,initialData:t,categories:i,cards:a,bankAccounts:l,loans:u,setModalConfig:f,darkMode:g=!1,language:m="ar"})=>{var te;const[T,x]=he.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((te=i.find(Z=>Z.name==="أخرى"))==null?void 0:te.id)||null}),[b,w]=he.useState(!1),[V,U]=he.useState(""),[L,G]=he.useState({isOpen:!1,text:""}),[W,ee]=he.useState(!1),[F,Q]=he.useState(!1),[H,R]=he.useState(4),[C,D]=he.useState(Object.keys(l)[0]||"cash");he.useEffect(()=>{var Z;t?x(t):(Z=navigator.clipboard)!=null&&Z.readText&&(async()=>{try{const pe=await navigator.clipboard.readText();pe&&pe.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==pe&&G({isOpen:!0,text:pe})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const N=Z=>{const{name:pe,value:Me}=Z.target;if(pe==="paymentMethod"){const Re=Me.includes("bnpl");Q(Re),Re&&x(q=>({...q,type:"expense"}))}x(Re=>({...Re,[pe]:pe==="amount"?parseFloat(Me):Me}))},P=Z=>{if(Z.preventDefault(),T.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(Me=>Me.status==="active").length>0){ee(!0);return}F&&T.paymentMethod.includes("bnpl")?e({...T,bnplData:{installmentsCount:H,initialPaymentSource:C,installmentAmount:T.amount/H}},t==null?void 0:t.id):e(T,t==null?void 0:t.id)},O=async Z=>{if(Z.trim()){w(!0),U("");try{const pe=await pE(Z,i,a,l),Me=JSON.parse(pe);Me.error?U(Me.error):x(Re=>({...Re,amount:Me.amount||Re.amount,date:Me.date||Re.date,description:Me.merchant||Re.description,paymentMethod:Me.paymentMethod||Re.paymentMethod,categoryId:Me.categoryId||Re.categoryId}))}catch(pe){U(pe instanceof Error?pe.message:ie("unknown.error",m)),console.error(pe)}finally{w(!1)}}},k=async()=>{U("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){U("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const Z=await navigator.clipboard.readText();Z&&Z.trim().length>0?O(Z):U("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(Z){console.error("Clipboard operation failed: ",Z),U("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},Ue=he.useMemo(()=>{const Z=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach(pe=>Z.push({value:pe.id,label:`🏦 ${pe.name}`})),Object.values(a).forEach(pe=>Z.push({value:pe.id,label:`💳 ${pe.name}`})),Z.push({value:"tabby-bnpl",label:"📱 تابي"}),Z.push({value:"tamara-bnpl",label:"📱 تمارا"}),Z},[l,a]),Be=he.useMemo(()=>{const Z=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(a).forEach(pe=>Z.push({value:`${pe.id}-payment`,label:`💳 سداد ${pe.name}`})),Z},[a]);return d.jsxs(d.Fragment,{children:[L.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>G({isOpen:!1,text:""}),children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Z=>Z.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),d.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:L.text}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",L.text),G({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),d.jsx("button",{onClick:()=>{G({isOpen:!1,text:""}),O(L.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Z=>Z.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(qu,{})})]}),d.jsxs("button",{type:"button",onClick:k,disabled:b,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[d.jsx(J4,{}),d.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),b&&d.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),d.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),V&&d.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:V}),d.jsxs("form",{onSubmit:P,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),d.jsx("input",{type:"number",name:"amount",value:T.amount,onChange:N,className:"w-full",required:!0,step:"0.01"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),d.jsx("input",{type:"date",name:"date",value:T.date,onChange:N,className:"w-full",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),d.jsx("input",{type:"text",name:"description",value:T.description,onChange:N,className:"w-full",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),d.jsx("select",{name:"type",value:T.type,onChange:N,className:"w-full",children:Be.map(Z=>d.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),d.jsx("select",{name:"paymentMethod",value:T.paymentMethod,onChange:N,className:"w-full",children:Ue.map(Z=>d.jsx("option",{value:Z.value,children:Z.label},Z.value))})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),d.jsxs("select",{name:"categoryId",value:T.categoryId||"",onChange:N,className:"w-full",children:[d.jsx("option",{value:"",children:"-- اختر فئة --"}),i.map(Z=>d.jsxs("option",{value:Z.id,children:[Z.icon," ",Z.name]},Z.id))]})]}),F&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[d.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),d.jsxs("select",{value:H,onChange:Z=>R(parseInt(Z.target.value)),className:"w-full",children:[d.jsx("option",{value:2,children:"قسطين (2)"}),d.jsx("option",{value:3,children:"3 أقساط"}),d.jsx("option",{value:4,children:"4 أقساط"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),d.jsx("select",{value:C,onChange:Z=>D(Z.target.value),className:"w-full",children:Ue.filter(Z=>!Z.value.includes("bnpl")).map(Z=>d.jsx("option",{value:Z.value,children:Z.label},Z.value))})]})]}),d.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:d.jsxs("p",{className:"text-sm text-blue-700",children:[d.jsx("strong",{children:"الدفعة الأولى:"})," ",(T.amount/H).toFixed(2)," ريال",d.jsx("br",{}),d.jsx("strong",{children:"المبلغ المتبقي:"})," ",(T.amount*(H-1)/H).toFixed(2)," ريال"]})})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),W&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Z=>Z.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),d.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(Z=>Z.status==="active").map(Z=>d.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:d.jsx("div",{className:"flex justify-between items-center",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:Z.name}),d.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",Z.monthlyPayment.toLocaleString()," ريال"]})]})})},Z.id))}),d.jsxs("div",{className:"flex justify-end gap-3",children:[d.jsx("button",{onClick:()=>{ee(!1),e(T,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),d.jsx("button",{onClick:()=>{ee(!1);const Z=Object.values(u).filter(Re=>Re.status==="active"),pe=Z.reduce((Re,q)=>Re+q.monthlyPayment,0),Me={...T};Z.map(Re=>({id:`trans-${Date.now()}-loan-${Re.id}`,amount:Re.monthlyPayment,date:T.date,description:`قسط شهري - ${Re.name}`,paymentMethod:T.paymentMethod,type:"expense",categoryId:null})),e(Me,t==null?void 0:t.id),f({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${pe.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},AU=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:a="ar"})=>{var m;const[l,u]=he.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});he.useEffect(()=>{t&&u(t)},[t]);const f=T=>{const{name:x,value:b,type:w}=T.target;u(x==="smsSamples"?V=>({...V,smsSamples:b.split(",").map(U=>U.trim()).filter(Boolean)}):V=>({...V,[x]:w==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(qu,{})})]}),d.jsxs("form",{onSubmit:g,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),d.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:"w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),d.jsx("input",{type:"number",name:"limit",value:l.limit,onChange:f,className:"w-full p-2",required:!0,step:"100"})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),d.jsx("input",{type:"number",name:"statementDay",value:l.statementDay,onChange:f,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),d.jsx("input",{type:"number",name:"dueDay",value:l.dueDay,onChange:f,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:f,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},SU=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:a="ar"})=>{var m;const[l,u]=he.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});he.useEffect(()=>{t&&u(t)},[t]);const f=T=>{const{name:x,value:b,type:w}=T.target;u(x==="smsSamples"?V=>({...V,smsSamples:b.split(",").map(U=>U.trim()).filter(Boolean)}):V=>({...V,[x]:w==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(qu,{})})]}),d.jsxs("form",{onSubmit:g,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),d.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:"w-full p-2",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),d.jsx("input",{type:"number",name:"balance",value:l.balance,onChange:f,className:"w-full p-2",required:!0,step:"10"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),d.jsxs("select",{name:"currency",value:l.currency||"SAR",onChange:f,className:"w-full p-2",required:!0,children:[d.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),d.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),d.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),d.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),d.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),d.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),d.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),d.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),d.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),d.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:f,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},CU=({onClose:n,onSave:e,initialData:t,bankAccounts:i,darkMode:a=!1,language:l="ar"})=>{const[u,f]=he.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[g,m]=he.useState({});he.useEffect(()=>{t&&f(t)},[t]),he.useEffect(()=>{if(u.totalAmount>0&&u.downPayment>=0&&u.finalPayment>=0&&u.monthlyPayment>0){const U=u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0);if(U>0){const L=Math.ceil(U/u.monthlyPayment),G=new Date(u.startDate),W=new Date(G);W.setMonth(W.getMonth()+L),f(ee=>({...ee,totalMonths:L,endDate:W.toISOString().split("T")[0],remainingMonths:L}))}}},[u.totalAmount,u.downPayment,u.finalPayment,u.monthlyPayment,u.startDate,u.prepaidAmount]),he.useEffect(()=>{if(u.prepaidAmount&&u.monthlyPayment>0){const U=Math.floor(u.prepaidAmount/u.monthlyPayment);f(L=>({...L,prepaidInstallments:U}))}else f(U=>({...U,prepaidInstallments:0}))},[u.prepaidAmount,u.monthlyPayment]);const T=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],x=U=>{const{name:L,value:G}=U.target;f(W=>({...W,[L]:L.includes("Amount")||L.includes("Payment")||L.includes("Months")?parseFloat(G)||0:G})),g[L]&&m(W=>({...W,[L]:""}))},b=()=>{const U={};return u.name.trim()||(U.name="اسم القرض مطلوب"),u.totalAmount<=0&&(U.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),u.downPayment<0&&(U.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),u.finalPayment<0&&(U.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),u.monthlyPayment<=0&&(U.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),u.lender.trim()||(U.lender="اسم البنك أو المؤسسة مطلوب"),u.startDate||(U.startDate="تاريخ بداية القرض مطلوب"),u.downPayment+u.finalPayment>=u.totalAmount&&(U.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),m(U),Object.keys(U).length===0},w=U=>{if(U.preventDefault(),!b())return;const L={...u,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(L)},V=Object.values(i).map(U=>({value:U.id,label:`${U.name} (${U.currency})`}));return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:U=>U.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(qu,{})})]}),d.jsxs("form",{onSubmit:w,className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),d.jsx("select",{id:"type",name:"type",value:u.type,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:T.map(U=>d.jsxs("option",{value:U.value,children:[U.icon," ",U.label]},U.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),d.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),g.name&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.name})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),d.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:u.totalAmount,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.totalAmount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.totalAmount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),d.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:u.downPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.downPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.downPayment})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),d.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:u.finalPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.finalPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.finalPayment})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),d.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:u.monthlyPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.monthlyPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.monthlyPayment})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),d.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:u.prepaidAmount||0,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),d.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(u.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[d.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",u.prepaidInstallments||0," قسط"]}),d.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0))," ريال"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),d.jsx("input",{type:"date",id:"startDate",name:"startDate",value:u.startDate,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.startDate&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.startDate})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),d.jsx("input",{type:"date",id:"endDate",name:"endDate",value:u.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),d.jsx("input",{type:"text",id:"lender",name:"lender",value:u.lender,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),g.lender&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.lender})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),d.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:u.linkedAccount,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"اختر حساب بنكي"}),V.map(U=>d.jsx("option",{value:U.value,children:U.label},U.value))]})]})]}),u.totalMonths>0&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.totalMonths," شهر"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.remainingMonths," شهر"]})]})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},wU=()=>{var Hi,us,La,Gr,$r;const[n,e]=he.useState(!1),[t,i]=he.useState(cd),[a,l]=he.useState(new Date().getFullYear()),[u,f]=he.useState(new Date().getMonth()+1),[g,m]=he.useState("summary"),[T,x]=he.useState({isLoading:!1,text:""}),[b,w]=he.useState(null),[V,U]=he.useState({isOpen:!1}),[L,G]=he.useState({isOpen:!1}),[W,ee]=he.useState({isOpen:!1}),[F,Q]=he.useState({isOpen:!1}),[H,R]=he.useState({isOpen:!1}),[C,D]=he.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[N,P]=he.useState(!1),[O,k]=he.useState(""),[Ue,Be]=he.useState(null),[te,Z]=he.useState(!1),[pe,Me]=he.useState(!0);he.useEffect(()=>{(async()=>{mE();const ce=await Ri.onAuthStateChanged(async fe=>{try{fe?(console.log("✅ تم تسجيل دخول المستخدم:",fe.email),Be(fe),await Re(fe.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),Be(null),await q())}catch(ye){console.error("خطأ في تحميل بيانات المستخدم:",ye),await q()}finally{Me(!1),e(!0)}});return()=>{typeof ce=="function"&&ce()}})()},[]),he.useEffect(()=>(V.isOpen||L.isOpen||W.isOpen||F.isOpen||H.isOpen||b||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[V.isOpen,L.isOpen,W.isOpen,F.isOpen,H.isOpen,b,T.isLoading]),he.useEffect(()=>{t.settings.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const z=document.documentElement;t.settings.language==="ar"?(z.setAttribute("lang","ar"),z.setAttribute("dir","rtl")):(z.setAttribute("lang","en"),z.setAttribute("dir","ltr"))},[t.settings.darkMode,t.settings.language]),he.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(z=>{console.log("Service Worker registered successfully:",z)}).catch(z=>{console.log("Service Worker registration failed:",z)})},[]),he.useEffect(()=>{var z,ce;H.isOpen&&C.fromAccount&&C.toAccount&&((z=t.bankAccounts[C.fromAccount])==null?void 0:z.currency)!==((ce=t.bankAccounts[C.toAccount])==null?void 0:ce.currency)&&Ns()},[C.fromAccount,C.toAccount,H.isOpen]);const Re=async z=>{var ce;try{const fe=await Ri.getData("users",z);if(fe.success&&fe.data){const ye=cd(),_e={...ye,...fe.data,cards:{...ye.cards,...fe.data.cards||{}},bankAccounts:{...ye.bankAccounts,...fe.data.bankAccounts||{}},investments:{...ye.investments,...fe.data.investments||{}}};i(_e),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else fe.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",fe.error),(ce=fe.error)!=null&&ce.includes("الأذونات")&&w({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(fe){console.error("خطأ في تحميل بيانات المستخدم:",fe)}},q=async()=>{try{const z=["financial_dashboard_state","financial_dashboard_backup_1","financial_dashboard_backup_2"];for(let ye=0;ye<7;ye++){const _e=new Date;_e.setDate(_e.getDate()-ye);const Je=_e.toISOString().split("T")[0];z.push(`financial_dashboard_${Je}`)}let ce=null,fe="";for(const ye of z){const _e=localStorage.getItem(ye);if(_e)try{JSON.parse(_e),ce=_e,fe=ye;break}catch{console.warn(`⚠️ بيانات تالفة في ${ye}`)}}if(ce){const ye=JSON.parse(ce),_e=cd(),Je={..._e,...ye,cards:{..._e.cards,...ye.cards||{}},bankAccounts:{..._e.bankAccounts,...ye.bankAccounts||{}},investments:{..._e.investments,...ye.investments||{}}};i(Je),console.log(`✅ تم تحميل البيانات بنجاح من: ${fe}`)}else console.log("ℹ️ لم توجد بيانات محفوظة، سيتم استخدام البيانات الافتراضية")}catch(z){console.error("❌ خطأ في تحميل البيانات المحلية:",z)}};he.useEffect(()=>{if(n&&!pe){try{const z=JSON.stringify(t);localStorage.setItem("financial_dashboard_state",z),localStorage.setItem("financial_dashboard_backup_1",z),localStorage.setItem("financial_dashboard_backup_2",z);const ce=new Date().toISOString();localStorage.setItem(`financial_dashboard_${ce.split("T")[0]}`,z),console.log("✅ تم حفظ البيانات في localStorage مع نسخ احتياطية متعددة")}catch(z){console.error("❌ خطأ في حفظ البيانات:",z)}if(Ue){const ce=setTimeout(async()=>{try{const fe=await Ri.saveData("users",Ue.uid,t);fe.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",fe.error)}catch(fe){console.error("❌ خطأ في حفظ البيانات في Firebase:",fe)}},2e3);return()=>clearTimeout(ce)}}},[t,n,Ue,pe]);const ae=(z,ce="")=>x({isLoading:z,text:ce}),Te=he.useCallback(()=>t.transactions?t.transactions.filter(ce=>{const fe=new Date(ce.date),ye=fe.getFullYear()===a,_e=u==="all"||fe.getMonth()+1===u;return ye&&_e}).sort((ce,fe)=>{const ye=new Date(ce.date),Je=new Date(fe.date).getTime()-ye.getTime();if(Je===0){const Cn=parseInt(ce.id.replace("trans-","").split("-")[0]);return parseInt(fe.id.replace("trans-","").split("-")[0])-Cn}return Je}):[],[t.transactions,a,u]),Ee=he.useMemo(()=>t.transactions?[...t.transactions].sort((z,ce)=>{const fe=new Date(z.date),_e=new Date(ce.date).getTime()-fe.getTime();if(_e===0){const Je=parseInt(z.id.replace("trans-","").split("-")[0]);return parseInt(ce.id.replace("trans-","").split("-")[0])-Je}return _e}):[],[t.transactions]),Ie=he.useMemo(()=>Te(),[Te]),ke=he.useMemo(()=>{const z={},ce={},fe={},ye={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(xe=>{xe&&xe.id&&(fe[xe.id]={...xe,balance:0,available:xe.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(xe=>{xe&&xe.id&&(ye[xe.id]={...xe,deposits:0,withdrawals:0})});let _e=0,Je=0,Cn=0,Rs=0;Ie.forEach(xe=>{if(xe.type==="income")_e+=xe.amount;else if(xe.type==="expense")Je+=xe.amount,xe.categoryId&&(z[xe.categoryId]=(z[xe.categoryId]||0)+xe.amount);else if(xe.type==="bnpl-payment")Je+=xe.amount,xe.categoryId&&(z[xe.categoryId]=(z[xe.categoryId]||0)+xe.amount);else if(xe.type==="investment-deposit")Cn+=xe.amount,Je+=xe.amount;else if(xe.type==="investment-withdrawal")Rs+=xe.amount,_e+=xe.amount;else if(xe.type.endsWith("-payment")){const rt=xe.type.replace("-payment","");ce[rt]?ce[rt]+=xe.amount:ce[rt]=xe.amount}}),Object.keys(t.cards).forEach(xe=>{const rt=t.cards[xe];let Un=0;t.transactions.forEach(xt=>{var Xt,Xe,Ua,Ds,Gi;(Xt=xt.description)!=null&&Xt.includes(`سداد ${rt.name}`)||xt.type===`سداد ${rt.name}`||xt.type===`${xe}-payment`?Un-=xt.amount:(xt.paymentMethod===xe&&((Xe=xt.description)!=null&&Xe.includes("سداد")||(Ua=xt.type)!=null&&Ua.includes("سداد")||(Ds=xt.type)!=null&&Ds.includes("-payment"))&&!((Gi=xt.description)!=null&&Gi.includes(rt.name))&&xt.type!==`سداد ${rt.name}`&&xt.type!==`${xe}-payment`||xt.paymentMethod===xe&&(xt.type==="expense"||xt.type==="bnpl-payment"))&&(Un+=xt.amount)}),fe[xe].balance=Un,fe[xe].available=rt.limit-Un,fe[xe].usagePercentage=rt.limit>0?Un/rt.limit*100:0}),Object.keys(t.bankAccounts).forEach(xe=>{const rt=t.bankAccounts[xe];let Un=0,xt=0,Xt=rt.balance;t.transactions.forEach(Xe=>{Xe.paymentMethod===xe&&(["income","investment-withdrawal"].includes(Xe.type)?Xt+=Xe.amount:["expense","investment-deposit"].includes(Xe.type)&&(Xt-=Xe.amount)),Xe.type.endsWith("-payment")&&Xe.paymentMethod===xe&&(Xt-=Xe.amount),Xe.type==="expense"&&Xe.isInstallmentPayment&&Xe.paymentMethod===xe&&(Xt-=Xe.amount)}),Ie.forEach(Xe=>{Xe.paymentMethod===xe&&(["income","investment-withdrawal"].includes(Xe.type)?Un+=Xe.amount:["expense","investment-deposit"].includes(Xe.type)&&(xt+=Xe.amount)),Xe.type.endsWith("-payment")&&Xe.paymentMethod===xe&&(xt+=Xe.amount),Xe.type==="expense"&&Xe.isInstallmentPayment&&Xe.paymentMethod===xe&&(xt+=Xe.amount)}),ye[xe].balance=Xt,ye[xe].deposits=Un,ye[xe].withdrawals=xt});const wn=Object.values(fe).reduce((xe,rt)=>xe+rt.balance,0),cs=Object.values(fe).reduce((xe,rt)=>xe+rt.available,0),wt=Object.values(fe).reduce((xe,rt)=>xe+rt.limit,0),xn=Object.values(ye).reduce((xe,rt)=>xe+rt.balance,0);return{totalIncome:_e,totalExpenses:Je,cardDetails:fe,cardPayments:ce,bankAccountDetails:ye,totalDebt:wn,totalAvailable:cs,totalLimits:wt,totalBankBalance:xn,totalInvestmentDeposits:Cn,totalInvestmentWithdrawals:Rs,expensesByCategory:z}},[Ie,t.transactions,t.cards,t.bankAccounts]),Ye=(z,ce)=>{i(fe=>{if(ce){const ye=fe.transactions.map(_e=>_e.id===ce?{..._e,...z}:_e);return{...fe,transactions:ye}}else if(z.bnplData&&z.paymentMethod.includes("bnpl")){const ye={id:`installment-${Date.now()}`,provider:z.paymentMethod,description:z.description,totalAmount:z.amount,installmentAmount:z.bnplData.installmentAmount,total:z.bnplData.installmentsCount,paid:1,createdAt:z.date},_e={id:`trans-${Date.now()}-1`,amount:z.bnplData.installmentAmount,date:z.date,description:`الدفعة الأولى لـ: ${z.description}`,paymentMethod:z.bnplData.initialPaymentSource,type:"expense",categoryId:z.categoryId,isInstallmentPayment:!0,installmentId:ye.id};return{...fe,transactions:[...fe.transactions,_e],installments:[...fe.installments,ye]}}else{const ye={id:`trans-${Date.now()}`,...z};return{...fe,transactions:[...fe.transactions,ye]}}}),U({isOpen:!1})},me=z=>{w({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{i(ce=>{const fe=ce.transactions.find(Je=>Je.id===z);if(!fe)return ce;const ye=ce.transactions.filter(Je=>Je.id!==z);let _e=ce.installments;return fe.isInstallmentPayment&&fe.installmentId&&(_e=ce.installments.map(Je=>Je.id===fe.installmentId?{...Je,paid:Math.max(0,Je.paid-1)}:Je)),{...ce,transactions:ye,installments:_e}}),w(null)}})},ge=z=>{const ce=t.transactions.find(fe=>fe.id===z);ce&&U({isOpen:!0,initialData:ce})},Ge=async z=>{Be(z),Z(!1),await Re(z.uid)},kt=async()=>{try{const z=await Ri.signOut();z.success?(console.log("✅ تم تسجيل الخروج بنجاح"),Be(null),await q()):console.error("❌ خطأ في تسجيل الخروج:",z.error)}catch(z){console.error("❌ خطأ في تسجيل الخروج:",z)}},Sn=(z,ce)=>{i(fe=>{const ye={...fe.cards};if(ce)ye[ce]={...ye[ce],...z,id:ce};else{const _e=`card-${Date.now()}`;ye[_e]={...z,id:_e}}return{...fe,cards:ye}}),G({isOpen:!1})},Ln=z=>{var ce;t.transactions.some(fe=>fe.paymentMethod===z||fe.type===`${z}-payment`)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(ce=t.cards[z])==null?void 0:ce.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(fe=>{const ye={...fe.cards};return delete ye[z],{...fe,cards:ye}}),w(null)}})},_t=(z,ce)=>{i(fe=>{const ye={...fe.bankAccounts};if(ce)ye[ce]={...ye[ce],...z,id:ce};else{const _e=`bank-${Date.now()}`;ye[_e]={...z,id:_e}}return{...fe,bankAccounts:ye}}),ee({isOpen:!1})},si=z=>{var ce;t.transactions.some(fe=>fe.paymentMethod===z)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(ce=t.bankAccounts[z])==null?void 0:ce.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(fe=>{const ye={...fe.bankAccounts};return delete ye[z],{...fe,bankAccounts:ye}}),w(null)}})},ii=z=>{w({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const ce=cd();if(z.creditCards&&!z.cards){const ye={};Object.entries(z.creditCards).forEach(([_e,Je])=>{ye[_e]={id:_e,name:_e.toUpperCase(),limit:Je.creditLimit||0,balance:Je.currentBalance||0,dueDay:Je.dueDay||1,smsSamples:[],keywords:[]}}),z.cards=ye}if(z.cards&&typeof z.cards=="object"&&(z.cards.snb||z.cards.enbd)){const ye={};z.cards.snb&&(ye["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:z.cards.snb.limit||0,dueDay:z.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),z.cards.enbd&&(ye["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:z.cards.enbd.limit||0,dueDay:z.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),z.cards=ye}z.bank&&!z.bankAccounts&&(z.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:z.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),z.transactions&&Array.isArray(z.transactions)&&(z.transactions=z.transactions.map(ye=>ye.paymentMethod==="mada-bank"?{...ye,paymentMethod:"bank-default"}:ye));const fe={...ce,...z};i(fe),Ue&&(async()=>{try{const _e=await Ri.saveData("users",Ue.uid,fe);_e.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",_e.error)}catch(_e){console.error("❌ خطأ في حفظ البيانات في Firebase:",_e)}})(),w({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{w({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},Br=z=>G({isOpen:!0,initialData:z?t.cards[z]:null}),zr=z=>ee({isOpen:!0,initialData:z?t.bankAccounts[z]:null}),Dt=z=>Q({isOpen:!0,initialData:z?t.loans[z]:null}),Vt=()=>{i(z=>({...z,settings:{...z.settings,darkMode:!z.settings.darkMode}}))},Is=()=>{i(z=>({...z,settings:{...z.settings,notifications:!z.settings.notifications}}))},al=()=>{i(z=>({...z,settings:{...z.settings,language:z.settings.language==="ar"?"en":"ar"}}))},Va=()=>{if(!C.fromAccount||!C.toAccount||C.amount<=0){w({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(C.fromAccount===C.toAccount){w({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const z=t.bankAccounts[C.fromAccount],ce=t.bankAccounts[C.toAccount],fe=t.cards[C.fromAccount],ye=t.cards[C.toAccount],_e=z||fe,Je=ce||ye,Cn=C.amount*C.exchangeRate,Rs=fe?`${C.fromAccount}-payment`:"expense",wn=ye?`${C.toAccount}-payment`:"income",cs={id:`trans-${Date.now()}-withdrawal`,amount:C.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(Je==null?void 0:Je.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.fromAccount,type:Rs,categoryId:null},wt={id:`trans-${Date.now()}-deposit`,amount:Cn,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(_e==null?void 0:_e.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.toAccount,type:wn,categoryId:null};i(xn=>({...xn,transactions:[...xn.transactions,cs,wt]})),R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k(""),w({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},ln=z=>{if(i(ce=>({...ce,loans:{...ce.loans,[z.id]:z}})),!z.id.includes("edit")){const ce=[];z.downPayment>0&&ce.push({id:`trans-${Date.now()}-down-payment`,amount:z.downPayment,date:z.startDate,description:`دفعة أولى - ${z.name}`,paymentMethod:z.linkedAccount||"cash",type:"expense",categoryId:null}),ce.push({id:`trans-${Date.now()}-loan-deposit`,amount:z.totalAmount,date:z.startDate,description:`إيداع قرض - ${z.name} من ${z.lender}`,paymentMethod:z.linkedAccount||"cash",type:"income",categoryId:null}),z.finalPayment>0&&z.endDate&&ce.push({id:`trans-${Date.now()}-final-payment`,amount:z.finalPayment,date:z.endDate,description:`دفعة أخيرة - ${z.name}`,paymentMethod:z.linkedAccount||"cash",type:"expense",categoryId:null}),i(fe=>({...fe,transactions:[...fe.transactions,...ce]}))}Q({isOpen:!1}),w({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Ns=async()=>{if(!C.fromAccount||!C.toAccount)return;const z=t.bankAccounts[C.fromAccount],ce=t.bankAccounts[C.toAccount];if(!z||!ce)return;const fe=z.currency||"SAR",ye=ce.currency||"SAR";if(fe===ye){D(_e=>({..._e,exchangeRate:1})),k("");return}P(!0),k("");try{const _e=await yE(fe,ye);D(Je=>({...Je,exchangeRate:_e.rate}))}catch(_e){k(_e instanceof Error?_e.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",_e)}finally{P(!1)}};if(!n||pe)return d.jsx(rU,{});if(!Ue)return d.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:d.jsxs("div",{className:"w-full max-w-md px-4",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),d.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),d.jsx(Ox,{onSuccess:Ge,onClose:()=>{},hideCloseButton:!0})]})});`${a}${u==="all"?"كل الشهور":new Date(a,u-1).toLocaleString("ar-SA",{month:"long"})}`;const Hr=()=>{switch(g){case"summary":return d.jsx(lU,{calculations:ke,categories:t.categories,state:t,darkMode:t.settings.darkMode,language:t.settings.language});case"transactions":return d.jsx(uU,{transactions:Ie,allTransactions:Ee,categories:t.categories,deleteTransaction:me,editTransaction:ge,state:t,darkMode:t.settings.darkMode,language:t.settings.language});case"ai-assistant":return d.jsx(dU,{calculations:ke,filteredTransactions:Ie,allTransactions:Ee,state:t,darkMode:t.settings.darkMode,language:t.settings.language});case"analysis":return d.jsx(fU,{calculations:ke,categories:t.categories,allTransactions:t.transactions,darkMode:t.settings.darkMode,language:t.settings.language});case"budget":return d.jsx(hU,{state:t,setLoading:ae,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"investment":return d.jsx(mU,{state:t,setState:i,calculations:ke,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"cards":return d.jsx(gU,{state:t,calculations:ke,openCardFormModal:Br,deleteCard:Ln,darkMode:t.settings.darkMode,language:t.settings.language});case"bank":return d.jsx(_U,{state:t,setState:i,calculations:ke,filteredTransactions:Ie,categories:t.categories,setModal:w,openBankAccountFormModal:zr,deleteBankAccount:si,openTransferModal:()=>R({isOpen:!0}),darkMode:t.settings.darkMode,language:t.settings.language});case"installments":return d.jsx(TU,{state:t,setState:i,filteredTransactions:Ie,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"debts-loans":return d.jsx(xU,{state:t,setState:i,setModal:w,openLoanFormModal:Dt,darkMode:t.settings.darkMode,language:t.settings.language});case"settings":return d.jsx(EU,{state:t,setState:i,setModal:w,setLoading:ae,onRestore:ii,darkMode:t.settings.darkMode,language:t.settings.language});default:return d.jsx("div",{children:"Tab not found"})}};return d.jsxs("div",{className:`min-h-screen font-sans ${t.settings.darkMode?"dark":""}`,children:[d.jsx(tU,{selectedYear:a,selectedMonth:u,onYearChange:l,onMonthChange:z=>f(z),onAddTransaction:()=>U({isOpen:!0}),currentUser:Ue,onSignOut:kt,language:t.settings.language}),d.jsx("div",{className:`backdrop-blur-sm border-b p-4 ${t.settings.darkMode?"bg-slate-800/80 border-slate-700":"bg-white/80 border-slate-200"}`,children:d.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:`text-sm font-medium ${t.settings.darkMode?"text-slate-200":"text-slate-700"}`,children:ie("dark.mode",t.settings.language)}),d.jsx(WC,{darkMode:t.settings.darkMode,onToggle:Vt})]}),d.jsx(ew,{notifications:t.settings.notifications,onToggle:Is,language:t.settings.language})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:al,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${t.settings.darkMode?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-blue-100 hover:bg-blue-200 text-slate-700"}`,children:[d.jsx("span",{className:"text-sm font-medium",children:ie("language",t.settings.language)}),d.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${t.settings.darkMode?"bg-blue-500":"bg-blue-600"}`,children:d.jsx("span",{className:"text-white font-bold text-xs",children:t.settings.language==="ar"?"A":"E"})})]})})]})}),d.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx(sU,{activeTab:g,setActiveTab:m,language:t.settings.language}),Hr()]}),d.jsx("button",{onClick:()=>U({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),V.isOpen&&d.jsx(bU,{onClose:()=>U({isOpen:!1}),onSave:Ye,initialData:V.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,loans:t.loans,setModalConfig:w,darkMode:t.settings.darkMode,language:t.settings.language}),L.isOpen&&d.jsx(AU,{onClose:()=>G({isOpen:!1}),onSave:Sn,initialData:L.initialData}),W.isOpen&&d.jsx(SU,{onClose:()=>ee({isOpen:!1}),onSave:_t,initialData:W.initialData}),F.isOpen&&d.jsx(CU,{onClose:()=>Q({isOpen:!1}),onSave:ln,initialData:F.initialData,bankAccounts:t.bankAccounts}),H.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},children:d.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:z=>z.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),d.jsxs("select",{id:"fromAccount",name:"fromAccount",value:C.fromAccount,onChange:z=>D(ce=>({...ce,fromAccount:z.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([z,ce])=>d.jsxs("option",{value:z,children:["🏦 ",ce.name]},z)),Object.entries(t.cards).map(([z,ce])=>d.jsxs("option",{value:z,children:["💳 ",ce.name]},z))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),d.jsxs("select",{id:"toAccount",name:"toAccount",value:C.toAccount,onChange:z=>D(ce=>({...ce,toAccount:z.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([z])=>z!==C.fromAccount).map(([z,ce])=>d.jsxs("option",{value:z,children:["🏦 ",ce.name]},z)),Object.entries(t.cards).filter(([z])=>z!==C.fromAccount).map(([z,ce])=>d.jsxs("option",{value:z,children:["💳 ",ce.name]},z))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:C.amount,onChange:z=>D(ce=>({...ce,amount:parseFloat(z.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),C.fromAccount&&C.toAccount&&((Hi=t.bankAccounts[C.fromAccount])==null?void 0:Hi.currency)!==((us=t.bankAccounts[C.toAccount])==null?void 0:us.currency)&&d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(La=t.bankAccounts[C.fromAccount])==null?void 0:La.currency," → ",(Gr=t.bankAccounts[C.toAccount])==null?void 0:Gr.currency,")"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"number",step:"0.0001",value:C.exchangeRate,onChange:z=>D(ce=>({...ce,exchangeRate:parseFloat(z.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),d.jsxs("button",{type:"button",onClick:Ns,disabled:N,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[N?d.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",d.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),O&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:O}),d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(C.amount*C.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",($r=t.bankAccounts[C.toAccount])==null?void 0:$r.currency]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),d.jsx("input",{type:"text",id:"description",name:"description",value:C.description,onChange:z=>D(ce=>({...ce,description:z.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"button",onClick:Va,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),b&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>w(null),children:d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:z=>z.stopPropagation(),children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 mb-4",children:b.title}),d.jsx("div",{className:"text-slate-600 dark:text-slate-300",dangerouslySetInnerHTML:{__html:b.body}}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!b.hideCancel&&d.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),d.jsx("button",{onClick:()=>{(!b.onConfirm||b.onConfirm()!==!1)&&w(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:b.confirmText||"موافق"})]})]})}),T.isLoading&&d.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),d.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),te&&Ue&&d.jsx(Ox,{onSuccess:Ge,onClose:()=>Z(!1)})]})},cS=document.getElementById("root");if(!cS)throw new Error("Could not find root element");const IU=XC.createRoot(cS);IU.render(d.jsx(wp.StrictMode,{children:d.jsx(wU,{})}));
