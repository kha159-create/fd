(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function qE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ym={exports:{}},Ql={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function UC(){if(Lv)return Ql;Lv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,o,l){var c=null;if(l!==void 0&&(c=""+l),o.key!==void 0&&(c=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:n,type:s,key:c,ref:o!==void 0?o:null,props:l}}return Ql.Fragment=e,Ql.jsx=t,Ql.jsxs=t,Ql}var Ov;function LC(){return Ov||(Ov=1,ym.exports=UC()),ym.exports}var _=LC(),_m={exports:{}},ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function OC(){if(qv)return ke;qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),A=Symbol.iterator;function I(q){return q===null||typeof q!="object"?null:(q=A&&q[A]||q["@@iterator"],typeof q=="function"?q:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,F={};function Z(q,se,me){this.props=q,this.context=se,this.refs=F,this.updater=me||k}Z.prototype.isReactComponent={},Z.prototype.setState=function(q,se){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,se,"setState")},Z.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function te(){}te.prototype=Z.prototype;function K(q,se,me){this.props=q,this.context=se,this.refs=F,this.updater=me||k}var Y=K.prototype=new te;Y.constructor=K,B(Y,Z.prototype),Y.isPureReactComponent=!0;var ae=Array.isArray;function ee(){}var M={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function N(q,se,me){var ye=me.ref;return{$$typeof:n,type:q,key:se,ref:ye!==void 0?ye:null,props:me}}function L(q,se){return N(q.type,se,q.props)}function D(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function V(q){var se={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(me){return se[me]})}var P=/\/+/g;function Ve(q,se){return typeof q=="object"&&q!==null&&q.key!=null?V(""+q.key):se.toString(36)}function $e(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(ee,ee):(q.status="pending",q.then(function(se){q.status==="pending"&&(q.status="fulfilled",q.value=se)},function(se){q.status==="pending"&&(q.status="rejected",q.reason=se)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function X(q,se,me,ye,re){var ce=typeof q;(ce==="undefined"||ce==="boolean")&&(q=null);var ve=!1;if(q===null)ve=!0;else switch(ce){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(q.$$typeof){case n:case e:ve=!0;break;case T:return ve=q._init,X(ve(q._payload),se,me,ye,re)}}if(ve)return re=re(q),ve=ye===""?"."+Ve(q,0):ye,ae(re)?(me="",ve!=null&&(me=ve.replace(P,"$&/")+"/"),X(re,se,me,"",function(vn){return vn})):re!=null&&(D(re)&&(re=L(re,me+(re.key==null||q&&q.key===re.key?"":(""+re.key).replace(P,"$&/")+"/")+ve)),se.push(re)),1;ve=0;var Qe=ye===""?".":ye+":";if(ae(q))for(var tt=0;tt<q.length;tt++)ye=q[tt],ce=Qe+Ve(ye,tt),ve+=X(ye,se,me,ce,re);else if(tt=I(q),typeof tt=="function")for(q=tt.call(q),tt=0;!(ye=q.next()).done;)ye=ye.value,ce=Qe+Ve(ye,tt++),ve+=X(ye,se,me,ce,re);else if(ce==="object"){if(typeof q.then=="function")return X($e(q),se,me,ye,re);throw se=String(q),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return ve}function fe(q,se,me){if(q==null)return q;var ye=[],re=0;return X(q,ye,"","",function(ce){return se.call(me,ce,re++)}),ye}function Ae(q){if(q._status===-1){var se=q._result;se=se(),se.then(function(me){(q._status===0||q._status===-1)&&(q._status=1,q._result=me)},function(me){(q._status===0||q._status===-1)&&(q._status=2,q._result=me)}),q._status===-1&&(q._status=0,q._result=se)}if(q._status===1)return q._result.default;throw q._result}var qe=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},We={map:fe,forEach:function(q,se,me){fe(q,function(){se.apply(this,arguments)},me)},count:function(q){var se=0;return fe(q,function(){se++}),se},toArray:function(q){return fe(q,function(se){return se})||[]},only:function(q){if(!D(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return ke.Activity=E,ke.Children=We,ke.Component=Z,ke.Fragment=t,ke.Profiler=o,ke.PureComponent=K,ke.StrictMode=s,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,ke.__COMPILER_RUNTIME={__proto__:null,c:function(q){return M.H.useMemoCache(q)}},ke.cache=function(q){return function(){return q.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(q,se,me){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ye=B({},q.props),re=q.key;if(se!=null)for(ce in se.key!==void 0&&(re=""+se.key),se)!R.call(se,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&se.ref===void 0||(ye[ce]=se[ce]);var ce=arguments.length-2;if(ce===1)ye.children=me;else if(1<ce){for(var ve=Array(ce),Qe=0;Qe<ce;Qe++)ve[Qe]=arguments[Qe+2];ye.children=ve}return N(q.type,re,ye)},ke.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},ke.createElement=function(q,se,me){var ye,re={},ce=null;if(se!=null)for(ye in se.key!==void 0&&(ce=""+se.key),se)R.call(se,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(re[ye]=se[ye]);var ve=arguments.length-2;if(ve===1)re.children=me;else if(1<ve){for(var Qe=Array(ve),tt=0;tt<ve;tt++)Qe[tt]=arguments[tt+2];re.children=Qe}if(q&&q.defaultProps)for(ye in ve=q.defaultProps,ve)re[ye]===void 0&&(re[ye]=ve[ye]);return N(q,ce,re)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(q){return{$$typeof:d,render:q}},ke.isValidElement=D,ke.lazy=function(q){return{$$typeof:T,_payload:{_status:-1,_result:q},_init:Ae}},ke.memo=function(q,se){return{$$typeof:h,type:q,compare:se===void 0?null:se}},ke.startTransition=function(q){var se=M.T,me={};M.T=me;try{var ye=q(),re=M.S;re!==null&&re(me,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(ee,qe)}catch(ce){qe(ce)}finally{se!==null&&me.types!==null&&(se.types=me.types),M.T=se}},ke.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},ke.use=function(q){return M.H.use(q)},ke.useActionState=function(q,se,me){return M.H.useActionState(q,se,me)},ke.useCallback=function(q,se){return M.H.useCallback(q,se)},ke.useContext=function(q){return M.H.useContext(q)},ke.useDebugValue=function(){},ke.useDeferredValue=function(q,se){return M.H.useDeferredValue(q,se)},ke.useEffect=function(q,se){return M.H.useEffect(q,se)},ke.useEffectEvent=function(q){return M.H.useEffectEvent(q)},ke.useId=function(){return M.H.useId()},ke.useImperativeHandle=function(q,se,me){return M.H.useImperativeHandle(q,se,me)},ke.useInsertionEffect=function(q,se){return M.H.useInsertionEffect(q,se)},ke.useLayoutEffect=function(q,se){return M.H.useLayoutEffect(q,se)},ke.useMemo=function(q,se){return M.H.useMemo(q,se)},ke.useOptimistic=function(q,se){return M.H.useOptimistic(q,se)},ke.useReducer=function(q,se,me){return M.H.useReducer(q,se,me)},ke.useRef=function(q){return M.H.useRef(q)},ke.useState=function(q){return M.H.useState(q)},ke.useSyncExternalStore=function(q,se,me){return M.H.useSyncExternalStore(q,se,me)},ke.useTransition=function(){return M.H.useTransition()},ke.version="19.2.0",ke}var Bv;function Ap(){return Bv||(Bv=1,_m.exports=OC()),_m.exports}var pe=Ap();const qC=qE(pe);var vm={exports:{}},Xl={},Tm={exports:{}},Em={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fv;function BC(){return Fv||(Fv=1,(function(n){function e(X,fe){var Ae=X.length;X.push(fe);e:for(;0<Ae;){var qe=Ae-1>>>1,We=X[qe];if(0<o(We,fe))X[qe]=fe,X[Ae]=We,Ae=qe;else break e}}function t(X){return X.length===0?null:X[0]}function s(X){if(X.length===0)return null;var fe=X[0],Ae=X.pop();if(Ae!==fe){X[0]=Ae;e:for(var qe=0,We=X.length,q=We>>>1;qe<q;){var se=2*(qe+1)-1,me=X[se],ye=se+1,re=X[ye];if(0>o(me,Ae))ye<We&&0>o(re,me)?(X[qe]=re,X[ye]=Ae,qe=ye):(X[qe]=me,X[se]=Ae,qe=se);else if(ye<We&&0>o(re,Ae))X[qe]=re,X[ye]=Ae,qe=ye;else break e}}return fe}function o(X,fe){var Ae=X.sortIndex-fe.sortIndex;return Ae!==0?Ae:X.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var p=[],h=[],T=1,E=null,A=3,I=!1,k=!1,B=!1,F=!1,Z=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;function Y(X){for(var fe=t(h);fe!==null;){if(fe.callback===null)s(h);else if(fe.startTime<=X)s(h),fe.sortIndex=fe.expirationTime,e(p,fe);else break;fe=t(h)}}function ae(X){if(B=!1,Y(X),!k)if(t(p)!==null)k=!0,ee||(ee=!0,V());else{var fe=t(h);fe!==null&&$e(ae,fe.startTime-X)}}var ee=!1,M=-1,R=5,N=-1;function L(){return F?!0:!(n.unstable_now()-N<R)}function D(){if(F=!1,ee){var X=n.unstable_now();N=X;var fe=!0;try{e:{k=!1,B&&(B=!1,te(M),M=-1),I=!0;var Ae=A;try{t:{for(Y(X),E=t(p);E!==null&&!(E.expirationTime>X&&L());){var qe=E.callback;if(typeof qe=="function"){E.callback=null,A=E.priorityLevel;var We=qe(E.expirationTime<=X);if(X=n.unstable_now(),typeof We=="function"){E.callback=We,Y(X),fe=!0;break t}E===t(p)&&s(p),Y(X)}else s(p);E=t(p)}if(E!==null)fe=!0;else{var q=t(h);q!==null&&$e(ae,q.startTime-X),fe=!1}}break e}finally{E=null,A=Ae,I=!1}fe=void 0}}finally{fe?V():ee=!1}}}var V;if(typeof K=="function")V=function(){K(D)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,Ve=P.port2;P.port1.onmessage=D,V=function(){Ve.postMessage(null)}}else V=function(){Z(D,0)};function $e(X,fe){M=Z(function(){X(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_next=function(X){switch(A){case 1:case 2:case 3:var fe=3;break;default:fe=A}var Ae=A;A=fe;try{return X()}finally{A=Ae}},n.unstable_requestPaint=function(){F=!0},n.unstable_runWithPriority=function(X,fe){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Ae=A;A=X;try{return fe()}finally{A=Ae}},n.unstable_scheduleCallback=function(X,fe,Ae){var qe=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?qe+Ae:qe):Ae=qe,X){case 1:var We=-1;break;case 2:We=250;break;case 5:We=1073741823;break;case 4:We=1e4;break;default:We=5e3}return We=Ae+We,X={id:T++,callback:fe,priorityLevel:X,startTime:Ae,expirationTime:We,sortIndex:-1},Ae>qe?(X.sortIndex=Ae,e(h,X),t(p)===null&&X===t(h)&&(B?(te(M),M=-1):B=!0,$e(ae,Ae-qe))):(X.sortIndex=We,e(p,X),k||I||(k=!0,ee||(ee=!0,V()))),X},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(X){var fe=A;return function(){var Ae=A;A=fe;try{return X.apply(this,arguments)}finally{A=Ae}}}})(Em)),Em}var Hv;function FC(){return Hv||(Hv=1,Tm.exports=BC()),Tm.exports}var Sm={exports:{}},cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function HC(){if(zv)return cn;zv=1;var n=Ap();function e(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)h+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(p,h,T){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:E==null?null:""+E,children:p,containerInfo:h,implementation:T}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,cn.createPortal=function(p,h){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(p,h,null,T)},cn.flushSync=function(p){var h=c.T,T=s.p;try{if(c.T=null,s.p=2,p)return p()}finally{c.T=h,s.p=T,s.d.f()}},cn.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(p,h))},cn.prefetchDNS=function(p){typeof p=="string"&&s.d.D(p)},cn.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var T=h.as,E=d(T,h.crossOrigin),A=typeof h.integrity=="string"?h.integrity:void 0,I=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;T==="style"?s.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:E,integrity:A,fetchPriority:I}):T==="script"&&s.d.X(p,{crossOrigin:E,integrity:A,fetchPriority:I,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},cn.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var T=d(h.as,h.crossOrigin);s.d.M(p,{crossOrigin:T,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(p)},cn.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var T=h.as,E=d(T,h.crossOrigin);s.d.L(p,T,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},cn.preloadModule=function(p,h){if(typeof p=="string")if(h){var T=d(h.as,h.crossOrigin);s.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:T,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(p)},cn.requestFormReset=function(p){s.d.r(p)},cn.unstable_batchedUpdates=function(p,h){return p(h)},cn.useFormState=function(p,h,T){return c.H.useFormState(p,h,T)},cn.useFormStatus=function(){return c.H.useHostTransitionStatus()},cn.version="19.2.0",cn}var Gv;function zC(){if(Gv)return Sm.exports;Gv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sm.exports=HC(),Sm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function GC(){if(jv)return Xl;jv=1;var n=FC(),e=Ap(),t=zC();function s(i){var r="https://react.dev/errors/"+i;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+i+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function l(i){var r=i,a=i;if(i.alternate)for(;r.return;)r=r.return;else{i=r;do r=i,(r.flags&4098)!==0&&(a=r.return),i=r.return;while(i)}return r.tag===3?a:null}function c(i){if(i.tag===13){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function d(i){if(i.tag===31){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function p(i){if(l(i)!==i)throw Error(s(188))}function h(i){var r=i.alternate;if(!r){if(r=l(i),r===null)throw Error(s(188));return r!==i?null:i}for(var a=i,u=r;;){var y=a.return;if(y===null)break;var v=y.alternate;if(v===null){if(u=y.return,u!==null){a=u;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===a)return p(y),i;if(v===u)return p(y),r;v=v.sibling}throw Error(s(188))}if(a.return!==u.return)a=y,u=v;else{for(var b=!1,C=y.child;C;){if(C===a){b=!0,a=y,u=v;break}if(C===u){b=!0,u=y,a=v;break}C=C.sibling}if(!b){for(C=v.child;C;){if(C===a){b=!0,a=v,u=y;break}if(C===u){b=!0,u=v,a=y;break}C=C.sibling}if(!b)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?i:r}function T(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i;for(i=i.child;i!==null;){if(r=T(i),r!==null)return r;i=i.sibling}return null}var E=Object.assign,A=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),te=Symbol.for("react.consumer"),K=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function V(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var P=Symbol.for("react.client.reference");function Ve(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===P?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case B:return"Fragment";case Z:return"Profiler";case F:return"StrictMode";case ae:return"Suspense";case ee:return"SuspenseList";case N:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case k:return"Portal";case K:return i.displayName||"Context";case te:return(i._context.displayName||"Context")+".Consumer";case Y:var r=i.render;return i=i.displayName,i||(i=r.displayName||r.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case M:return r=i.displayName||null,r!==null?r:Ve(i.type)||"Memo";case R:r=i._payload,i=i._init;try{return Ve(i(r))}catch{}}return null}var $e=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},qe=[],We=-1;function q(i){return{current:i}}function se(i){0>We||(i.current=qe[We],qe[We]=null,We--)}function me(i,r){We++,qe[We]=i.current,i.current=r}var ye=q(null),re=q(null),ce=q(null),ve=q(null);function Qe(i,r){switch(me(ce,r),me(re,i),me(ye,null),r.nodeType){case 9:case 11:i=(i=r.documentElement)&&(i=i.namespaceURI)?ov(i):0;break;default:if(i=r.tagName,r=r.namespaceURI)r=ov(r),i=av(r,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}se(ye),me(ye,i)}function tt(){se(ye),se(re),se(ce)}function vn(i){i.memoizedState!==null&&me(ve,i);var r=ye.current,a=av(r,i.type);r!==a&&(me(re,i),me(ye,a))}function xt(i){re.current===i&&(se(ye),se(re)),ve.current===i&&(se(ve),Yl._currentValue=Ae)}var _i,Us;function wn(i){if(_i===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);_i=r&&r[1]||"",Us=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_i+i+Us}var Ls=!1;function vi(i,r){if(!i||Ls)return"";Ls=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(W){var J=W}Reflect.construct(i,[],oe)}else{try{oe.call()}catch(W){J=W}i.call(oe.prototype)}}else{try{throw Error()}catch(W){J=W}(oe=i())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(W){if(W&&J&&typeof W.stack=="string")return[W.stack,J.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=u.DetermineComponentFrameRoot(),b=v[0],C=v[1];if(b&&C){var U=b.split(`
`),j=C.split(`
`);for(y=u=0;u<U.length&&!U[u].includes("DetermineComponentFrameRoot");)u++;for(;y<j.length&&!j[y].includes("DetermineComponentFrameRoot");)y++;if(u===U.length||y===j.length)for(u=U.length-1,y=j.length-1;1<=u&&0<=y&&U[u]!==j[y];)y--;for(;1<=u&&0<=y;u--,y--)if(U[u]!==j[y]){if(u!==1||y!==1)do if(u--,y--,0>y||U[u]!==j[y]){var ne=`
`+U[u].replace(" at new "," at ");return i.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",i.displayName)),ne}while(1<=u&&0<=y);break}}}finally{Ls=!1,Error.prepareStackTrace=a}return(a=i?i.displayName||i.name:"")?wn(a):""}function Os(i,r){switch(i.tag){case 26:case 27:case 5:return wn(i.type);case 16:return wn("Lazy");case 13:return i.child!==r&&r!==null?wn("Suspense Fallback"):wn("Suspense");case 19:return wn("SuspenseList");case 0:case 15:return vi(i.type,!1);case 11:return vi(i.type.render,!1);case 1:return vi(i.type,!0);case 31:return wn("Activity");default:return""}}function qs(i){try{var r="",a=null;do r+=Os(i,a),a=i,i=i.return;while(i);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Q=Object.prototype.hasOwnProperty,de=n.unstable_scheduleCallback,ge=n.unstable_cancelCallback,Ce=n.unstable_shouldYield,Ze=n.unstable_requestPaint,gt=n.unstable_now,Ti=n.unstable_getCurrentPriorityLevel,Bs=n.unstable_ImmediatePriority,kr=n.unstable_UserBlockingPriority,Ei=n.unstable_NormalPriority,Qa=n.unstable_LowPriority,wo=n.unstable_IdlePriority,Te=n.log,It=n.unstable_setDisableYieldValue,kt=null,dt=null;function Qt(i){if(typeof Te=="function"&&It(i),dt&&typeof dt.setStrictMode=="function")try{dt.setStrictMode(kt,i)}catch{}}var De=Math.clz32?Math.clz32:ku,Vu=Math.log,Ro=Math.LN2;function ku(i){return i>>>=0,i===0?32:31-(Vu(i)/Ro|0)|0}var Si=256,Ur=262144,Ut=4194304;function Ai(i){var r=i&42;if(r!==0)return r;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function bi(i,r,a){var u=i.pendingLanes;if(u===0)return 0;var y=0,v=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var C=u&134217727;return C!==0?(u=C&~v,u!==0?y=Ai(u):(b&=C,b!==0?y=Ai(b):a||(a=C&~i,a!==0&&(y=Ai(a))))):(C=u&~v,C!==0?y=Ai(C):b!==0?y=Ai(b):a||(a=u&~i,a!==0&&(y=Ai(a)))),y===0?0:r!==0&&r!==y&&(r&v)===0&&(v=y&-y,a=r&-r,v>=a||v===32&&(a&4194048)!==0)?r:y}function ei(i,r){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&r)===0}function Ef(i,r){switch(i){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uu(){var i=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),i}function xi(i){for(var r=[],a=0;31>a;a++)r.push(i);return r}function Lr(i,r){i.pendingLanes|=r,r!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Sf(i,r,a,u,y,v){var b=i.pendingLanes;i.pendingLanes=a,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=a,i.entangledLanes&=a,i.errorRecoveryDisabledLanes&=a,i.shellSuspendCounter=0;var C=i.entanglements,U=i.expirationTimes,j=i.hiddenUpdates;for(a=b&~a;0<a;){var ne=31-De(a),oe=1<<ne;C[ne]=0,U[ne]=-1;var J=j[ne];if(J!==null)for(j[ne]=null,ne=0;ne<J.length;ne++){var W=J[ne];W!==null&&(W.lane&=-536870913)}a&=~oe}u!==0&&Or(i,u,0),v!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=v&~(b&~r))}function Or(i,r,a){i.pendingLanes|=r,i.suspendedLanes&=~r;var u=31-De(r);i.entangledLanes|=r,i.entanglements[u]=i.entanglements[u]|1073741824|a&261930}function Xa(i,r){var a=i.entangledLanes|=r;for(i=i.entanglements;a;){var u=31-De(a),y=1<<u;y&r|i[u]&r&&(i[u]|=r),a&=~y}}function Wa(i,r){var a=r&-r;return a=(a&42)!==0?1:qr(a),(a&(i.suspendedLanes|r))!==0?0:a}function qr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Xi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Lu(){var i=fe.p;return i!==0?i:(i=window.event,i===void 0?32:Nv(i.type))}function ti(i,r){var a=fe.p;try{return fe.p=i,r()}finally{fe.p=a}}var ni=Math.random().toString(36).slice(2),Lt="__reactFiber$"+ni,Xt="__reactProps$"+ni,Ci="__reactContainer$"+ni,No="__reactEvents$"+ni,Af="__reactListeners$"+ni,Ou="__reactHandles$"+ni,qu="__reactResources$"+ni,Ii="__reactMarker$"+ni;function Mo(i){delete i[Lt],delete i[Xt],delete i[No],delete i[Af],delete i[Ou]}function wi(i){var r=i[Lt];if(r)return r;for(var a=i.parentNode;a;){if(r=a[Ci]||a[Lt]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(i=mv(i);i!==null;){if(a=i[Lt])return a;i=mv(i)}return r}i=a,a=i.parentNode}return null}function qn(i){if(i=i[Lt]||i[Ci]){var r=i.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return i}return null}function Rn(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i.stateNode;throw Error(s(33))}function Ri(i){var r=i[qu];return r||(r=i[qu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ot(i){i[Ii]=!0}var Za=new Set,el={};function Ni(i,r){Mi(i,r),Mi(i+"Capture",r)}function Mi(i,r){for(el[i]=r,i=0;i<r.length;i++)Za.add(r[i])}var tl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nl={},il={};function Bu(i){return Q.call(il,i)?!0:Q.call(nl,i)?!1:tl.test(i)?il[i]=!0:(nl[i]=!0,!1)}function Do(i,r,a){if(Bu(r))if(a===null)i.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":i.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(r);return}}i.setAttribute(r,""+a)}}function Nn(i,r,a){if(a===null)i.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(r);return}i.setAttribute(r,""+a)}}function qt(i,r,a,u){if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttributeNS(r,a,""+u)}}function Wt(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Fs(i){var r=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function sl(i,r,a){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,r);if(!i.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,v=u.set;return Object.defineProperty(i,r,{configurable:!0,get:function(){return y.call(this)},set:function(b){a=""+b,v.call(this,b)}}),Object.defineProperty(i,r,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(b){a=""+b},stopTracking:function(){i._valueTracker=null,delete i[r]}}}}function lt(i){if(!i._valueTracker){var r=Fs(i)?"checked":"value";i._valueTracker=sl(i,r,""+i[r])}}function Br(i){if(!i)return!1;var r=i._valueTracker;if(!r)return!0;var a=r.getValue(),u="";return i&&(u=Fs(i)?i.checked?"true":"false":i.value),i=u,i!==a?(r.setValue(i),!0):!1}function Di(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Fr=/[\n"\\]/g;function Tn(i){return i.replace(Fr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Po(i,r,a,u,y,v,b,C){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),r!=null?b==="number"?(r===0&&i.value===""||i.value!=r)&&(i.value=""+Wt(r)):i.value!==""+Wt(r)&&(i.value=""+Wt(r)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),r!=null?rl(i,b,Wt(r)):a!=null?rl(i,b,Wt(a)):u!=null&&i.removeAttribute("value"),y==null&&v!=null&&(i.defaultChecked=!!v),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?i.name=""+Wt(C):i.removeAttribute("name")}function Fu(i,r,a,u,y,v,b,C){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),r!=null||a!=null){if(!(v!=="submit"&&v!=="reset"||r!=null)){lt(i);return}a=a!=null?""+Wt(a):"",r=r!=null?""+Wt(r):a,C||r===i.value||(i.value=r),i.defaultValue=r}u=u??y,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=C?i.checked:!!u,i.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b),lt(i)}function rl(i,r,a){r==="number"&&Di(i.ownerDocument)===i||i.defaultValue===""+a||(i.defaultValue=""+a)}function Hs(i,r,a,u){if(i=i.options,r){r={};for(var y=0;y<a.length;y++)r["$"+a[y]]=!0;for(a=0;a<i.length;a++)y=r.hasOwnProperty("$"+i[a].value),i[a].selected!==y&&(i[a].selected=y),y&&u&&(i[a].defaultSelected=!0)}else{for(a=""+Wt(a),r=null,y=0;y<i.length;y++){if(i[y].value===a){i[y].selected=!0,u&&(i[y].defaultSelected=!0);return}r!==null||i[y].disabled||(r=i[y])}r!==null&&(r.selected=!0)}}function Hu(i,r,a){if(r!=null&&(r=""+Wt(r),r!==i.value&&(i.value=r),a==null)){i.defaultValue!==r&&(i.defaultValue=r);return}i.defaultValue=a!=null?""+Wt(a):""}function zs(i,r,a,u){if(r==null){if(u!=null){if(a!=null)throw Error(s(92));if($e(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),r=a}a=Wt(r),i.defaultValue=a,u=i.textContent,u===a&&u!==""&&u!==null&&(i.value=u),lt(i)}function En(i,r){if(r){var a=i.firstChild;if(a&&a===i.lastChild&&a.nodeType===3){a.nodeValue=r;return}}i.textContent=r}var zu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ol(i,r,a){var u=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?i.setProperty(r,""):r==="float"?i.cssFloat="":i[r]="":u?i.setProperty(r,a):typeof a!="number"||a===0||zu.has(r)?r==="float"?i.cssFloat=a:i[r]=(""+a).trim():i[r]=a+"px"}function al(i,r,a){if(r!=null&&typeof r!="object")throw Error(s(62));if(i=i.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var y in r)u=r[y],r.hasOwnProperty(y)&&a[y]!==u&&ol(i,y,u)}else for(var v in r)r.hasOwnProperty(v)&&ol(i,v,r[v])}function Vo(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ko(i){return Gs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ii(){}var ll=null;function Bn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var js=null,Pi=null;function Hr(i){var r=qn(i);if(r&&(i=r.stateNode)){var a=i[Xt]||null;e:switch(i=r.stateNode,r.type){case"input":if(Po(i,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=i;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Tn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var u=a[r];if(u!==i&&u.form===i.form){var y=u[Xt]||null;if(!y)throw Error(s(90));Po(u,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(r=0;r<a.length;r++)u=a[r],u.form===i.form&&Br(u)}break e;case"textarea":Hu(i,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Hs(i,!!a.multiple,r,!1)}}}var Uo=!1;function Ys(i,r,a){if(Uo)return i(r,a);Uo=!0;try{var u=i(r);return u}finally{if(Uo=!1,(js!==null||Pi!==null)&&(Lc(),js&&(r=js,i=Pi,Pi=js=null,Hr(r),i)))for(r=0;r<i.length;r++)Hr(i[r])}}function si(i,r){var a=i.stateNode;if(a===null)return null;var u=a[Xt]||null;if(u===null)return null;a=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(a&&typeof a!="function")throw Error(s(231,r,typeof a));return a}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zr=!1;if(Fn)try{var ft={};Object.defineProperty(ft,"passive",{get:function(){zr=!0}}),window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,ft)}catch{zr=!1}var Vi=null,ul=null,Gr=null;function cl(){if(Gr)return Gr;var i,r=ul,a=r.length,u,y="value"in Vi?Vi.value:Vi.textContent,v=y.length;for(i=0;i<a&&r[i]===y[i];i++);var b=a-i;for(u=1;u<=b&&r[a-u]===y[v-u];u++);return Gr=y.slice(i,1<u?1-u:void 0)}function jr(i){var r=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&r===13&&(i=13)):i=r,i===10&&(i=13),32<=i||i===13?i:0}function Wi(){return!0}function ri(){return!1}function sn(i){function r(a,u,y,v,b){this._reactName=a,this._targetInst=y,this.type=u,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var C in i)i.hasOwnProperty(C)&&(a=i[C],this[C]=a?a(v):v[C]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Wi:ri,this.isPropagationStopped=ri,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Wi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Wi)},persist:function(){},isPersistent:Wi}),r}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ki=sn(Zi),Js=E({},Zi,{view:0,detail:0}),dl=sn(Js),Ks,Lo,Ui,Oo=E({},Js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$s,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ui&&(Ui&&i.type==="mousemove"?(Ks=i.screenX-Ui.screenX,Lo=i.screenY-Ui.screenY):Lo=Ks=0,Ui=i),Ks)},movementY:function(i){return"movementY"in i?i.movementY:Lo}}),fl=sn(Oo),Yr=E({},Oo,{dataTransfer:0}),ju=sn(Yr),Yu=E({},Js,{relatedTarget:0}),Jr=sn(Yu),hl=E({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ju=sn(hl),qo=E({},Zi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ku=sn(qo),$u=E({},Zi,{data:0}),Li=sn($u),Qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zu(i){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(i):(i=Wu[i])?!!r[i]:!1}function $s(){return Zu}var gn=E({},Js,{key:function(i){if(i.key){var r=Qu[i.key]||i.key;if(r!=="Unidentified")return r}return i.type==="keypress"?(i=jr(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Xu[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$s,charCode:function(i){return i.type==="keypress"?jr(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?jr(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ec=sn(gn),tc=E({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),es=sn(tc),m=E({},Js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$s}),S=sn(m),x=E({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),w=sn(x),z=E({},Oo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),$=sn(z),he=E({},Zi,{newState:0,oldState:0}),Le=sn(he),Mt=[9,13,27,32],rt=Fn&&"CompositionEvent"in window,At=null;Fn&&"documentMode"in document&&(At=document.documentMode);var Hn=Fn&&"TextEvent"in window&&!At,Oi=Fn&&(!rt||At&&8<At&&11>=At),oi=" ",ai=!1;function Kr(i,r){switch(i){case"keyup":return Mt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bo(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Fo=!1;function ox(i,r){switch(i){case"compositionend":return Bo(r);case"keypress":return r.which!==32?null:(ai=!0,oi);case"textInput":return i=r.data,i===oi&&ai?null:i;default:return null}}function ax(i,r){if(Fo)return i==="compositionend"||!rt&&Kr(i,r)?(i=cl(),Gr=ul=Vi=null,Fo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Oi&&r.locale!=="ko"?null:r.data;default:return null}}var lx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yg(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r==="input"?!!lx[i.type]:r==="textarea"}function _g(i,r,a,u){js?Pi?Pi.push(u):Pi=[u]:js=u,r=Gc(r,"onChange"),0<r.length&&(a=new ki("onChange","change",null,a,u),i.push({event:a,listeners:r}))}var ml=null,pl=null;function ux(i){ev(i,0)}function nc(i){var r=Rn(i);if(Br(r))return i}function vg(i,r){if(i==="change")return r}var Tg=!1;if(Fn){var bf;if(Fn){var xf="oninput"in document;if(!xf){var Eg=document.createElement("div");Eg.setAttribute("oninput","return;"),xf=typeof Eg.oninput=="function"}bf=xf}else bf=!1;Tg=bf&&(!document.documentMode||9<document.documentMode)}function Sg(){ml&&(ml.detachEvent("onpropertychange",Ag),pl=ml=null)}function Ag(i){if(i.propertyName==="value"&&nc(pl)){var r=[];_g(r,pl,i,Bn(i)),Ys(ux,r)}}function cx(i,r,a){i==="focusin"?(Sg(),ml=r,pl=a,ml.attachEvent("onpropertychange",Ag)):i==="focusout"&&Sg()}function dx(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return nc(pl)}function fx(i,r){if(i==="click")return nc(r)}function hx(i,r){if(i==="input"||i==="change")return nc(r)}function mx(i,r){return i===r&&(i!==0||1/i===1/r)||i!==i&&r!==r}var Mn=typeof Object.is=="function"?Object.is:mx;function gl(i,r){if(Mn(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;var a=Object.keys(i),u=Object.keys(r);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var y=a[u];if(!Q.call(r,y)||!Mn(i[y],r[y]))return!1}return!0}function bg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function xg(i,r){var a=bg(i);i=0;for(var u;a;){if(a.nodeType===3){if(u=i+a.textContent.length,i<=r&&u>=r)return{node:a,offset:r-i};i=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=bg(a)}}function Cg(i,r){return i&&r?i===r?!0:i&&i.nodeType===3?!1:r&&r.nodeType===3?Cg(i,r.parentNode):"contains"in i?i.contains(r):i.compareDocumentPosition?!!(i.compareDocumentPosition(r)&16):!1:!1}function Ig(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var r=Di(i.document);r instanceof i.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)i=r.contentWindow;else break;r=Di(i.document)}return r}function Cf(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r&&(r==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||r==="textarea"||i.contentEditable==="true")}var px=Fn&&"documentMode"in document&&11>=document.documentMode,Ho=null,If=null,yl=null,wf=!1;function wg(i,r,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;wf||Ho==null||Ho!==Di(u)||(u=Ho,"selectionStart"in u&&Cf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),yl&&gl(yl,u)||(yl=u,u=Gc(If,"onSelect"),0<u.length&&(r=new ki("onSelect","select",null,r,a),i.push({event:r,listeners:u}),r.target=Ho)))}function $r(i,r){var a={};return a[i.toLowerCase()]=r.toLowerCase(),a["Webkit"+i]="webkit"+r,a["Moz"+i]="moz"+r,a}var zo={animationend:$r("Animation","AnimationEnd"),animationiteration:$r("Animation","AnimationIteration"),animationstart:$r("Animation","AnimationStart"),transitionrun:$r("Transition","TransitionRun"),transitionstart:$r("Transition","TransitionStart"),transitioncancel:$r("Transition","TransitionCancel"),transitionend:$r("Transition","TransitionEnd")},Rf={},Rg={};Fn&&(Rg=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function Qr(i){if(Rf[i])return Rf[i];if(!zo[i])return i;var r=zo[i],a;for(a in r)if(r.hasOwnProperty(a)&&a in Rg)return Rf[i]=r[a];return i}var Ng=Qr("animationend"),Mg=Qr("animationiteration"),Dg=Qr("animationstart"),gx=Qr("transitionrun"),yx=Qr("transitionstart"),_x=Qr("transitioncancel"),Pg=Qr("transitionend"),Vg=new Map,Nf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nf.push("scrollEnd");function li(i,r){Vg.set(i,r),Ni(r,[i])}var ic=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},zn=[],Go=0,Mf=0;function sc(){for(var i=Go,r=Mf=Go=0;r<i;){var a=zn[r];zn[r++]=null;var u=zn[r];zn[r++]=null;var y=zn[r];zn[r++]=null;var v=zn[r];if(zn[r++]=null,u!==null&&y!==null){var b=u.pending;b===null?y.next=y:(y.next=b.next,b.next=y),u.pending=y}v!==0&&kg(a,y,v)}}function rc(i,r,a,u){zn[Go++]=i,zn[Go++]=r,zn[Go++]=a,zn[Go++]=u,Mf|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Df(i,r,a,u){return rc(i,r,a,u),oc(i)}function Xr(i,r){return rc(i,null,null,r),oc(i)}function kg(i,r,a){i.lanes|=a;var u=i.alternate;u!==null&&(u.lanes|=a);for(var y=!1,v=i.return;v!==null;)v.childLanes|=a,u=v.alternate,u!==null&&(u.childLanes|=a),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(y=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,y&&r!==null&&(y=31-De(a),i=v.hiddenUpdates,u=i[y],u===null?i[y]=[r]:u.push(r),r.lane=a|536870912),v):null}function oc(i){if(50<ql)throw ql=0,Fh=null,Error(s(185));for(var r=i.return;r!==null;)i=r,r=i.return;return i.tag===3?i.stateNode:null}var jo={};function vx(i,r,a,u){this.tag=i,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(i,r,a,u){return new vx(i,r,a,u)}function Pf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ts(i,r){var a=i.alternate;return a===null?(a=Dn(i.tag,r,i.key,i.mode),a.elementType=i.elementType,a.type=i.type,a.stateNode=i.stateNode,a.alternate=i,i.alternate=a):(a.pendingProps=r,a.type=i.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=i.flags&65011712,a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,r=i.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=i.sibling,a.index=i.index,a.ref=i.ref,a.refCleanup=i.refCleanup,a}function Ug(i,r){i.flags&=65011714;var a=i.alternate;return a===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,r=a.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i}function ac(i,r,a,u,y,v){var b=0;if(u=i,typeof i=="function")Pf(i)&&(b=1);else if(typeof i=="string")b=bC(i,a,ye.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case N:return i=Dn(31,a,r,y),i.elementType=N,i.lanes=v,i;case B:return Wr(a.children,y,v,r);case F:b=8,y|=24;break;case Z:return i=Dn(12,a,r,y|2),i.elementType=Z,i.lanes=v,i;case ae:return i=Dn(13,a,r,y),i.elementType=ae,i.lanes=v,i;case ee:return i=Dn(19,a,r,y),i.elementType=ee,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case K:b=10;break e;case te:b=9;break e;case Y:b=11;break e;case M:b=14;break e;case R:b=16,u=null;break e}b=29,a=Error(s(130,i===null?"null":typeof i,"")),u=null}return r=Dn(b,a,r,y),r.elementType=i,r.type=u,r.lanes=v,r}function Wr(i,r,a,u){return i=Dn(7,i,u,r),i.lanes=a,i}function Vf(i,r,a){return i=Dn(6,i,null,r),i.lanes=a,i}function Lg(i){var r=Dn(18,null,null,0);return r.stateNode=i,r}function kf(i,r,a){return r=Dn(4,i.children!==null?i.children:[],i.key,r),r.lanes=a,r.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},r}var Og=new WeakMap;function Gn(i,r){if(typeof i=="object"&&i!==null){var a=Og.get(i);return a!==void 0?a:(r={value:i,source:r,stack:qs(r)},Og.set(i,r),r)}return{value:i,source:r,stack:qs(r)}}var Yo=[],Jo=0,lc=null,_l=0,jn=[],Yn=0,Qs=null,qi=1,Bi="";function ns(i,r){Yo[Jo++]=_l,Yo[Jo++]=lc,lc=i,_l=r}function qg(i,r,a){jn[Yn++]=qi,jn[Yn++]=Bi,jn[Yn++]=Qs,Qs=i;var u=qi;i=Bi;var y=32-De(u)-1;u&=~(1<<y),a+=1;var v=32-De(r)+y;if(30<v){var b=y-y%5;v=(u&(1<<b)-1).toString(32),u>>=b,y-=b,qi=1<<32-De(r)+y|a<<y|u,Bi=v+i}else qi=1<<v|a<<y|u,Bi=i}function Uf(i){i.return!==null&&(ns(i,1),qg(i,1,0))}function Lf(i){for(;i===lc;)lc=Yo[--Jo],Yo[Jo]=null,_l=Yo[--Jo],Yo[Jo]=null;for(;i===Qs;)Qs=jn[--Yn],jn[Yn]=null,Bi=jn[--Yn],jn[Yn]=null,qi=jn[--Yn],jn[Yn]=null}function Bg(i,r){jn[Yn++]=qi,jn[Yn++]=Bi,jn[Yn++]=Qs,qi=r.id,Bi=r.overflow,Qs=i}var rn=null,vt=null,Ke=!1,Xs=null,Jn=!1,Of=Error(s(519));function Ws(i){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vl(Gn(r,i)),Of}function Fg(i){var r=i.stateNode,a=i.type,u=i.memoizedProps;switch(r[Lt]=i,r[Xt]=u,a){case"dialog":He("cancel",r),He("close",r);break;case"iframe":case"object":case"embed":He("load",r);break;case"video":case"audio":for(a=0;a<Fl.length;a++)He(Fl[a],r);break;case"source":He("error",r);break;case"img":case"image":case"link":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"input":He("invalid",r),Fu(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":He("invalid",r);break;case"textarea":He("invalid",r),zs(r,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||u.suppressHydrationWarning===!0||sv(r.textContent,a)?(u.popover!=null&&(He("beforetoggle",r),He("toggle",r)),u.onScroll!=null&&He("scroll",r),u.onScrollEnd!=null&&He("scrollend",r),u.onClick!=null&&(r.onclick=ii),r=!0):r=!1,r||Ws(i,!0)}function Hg(i){for(rn=i.return;rn;)switch(rn.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:rn=rn.return}}function Ko(i){if(i!==rn)return!1;if(!Ke)return Hg(i),Ke=!0,!1;var r=i.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=i.type,a=!(a!=="form"&&a!=="button")||nm(i.type,i.memoizedProps)),a=!a),a&&vt&&Ws(i),Hg(i),r===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));vt=hv(i)}else if(r===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));vt=hv(i)}else r===27?(r=vt,fr(i.type)?(i=am,am=null,vt=i):vt=r):vt=rn?$n(i.stateNode.nextSibling):null;return!0}function Zr(){vt=rn=null,Ke=!1}function qf(){var i=Xs;return i!==null&&(xn===null?xn=i:xn.push.apply(xn,i),Xs=null),i}function vl(i){Xs===null?Xs=[i]:Xs.push(i)}var Bf=q(null),eo=null,is=null;function Zs(i,r,a){me(Bf,r._currentValue),r._currentValue=a}function ss(i){i._currentValue=Bf.current,se(Bf)}function Ff(i,r,a){for(;i!==null;){var u=i.alternate;if((i.childLanes&r)!==r?(i.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),i===a)break;i=i.return}}function Hf(i,r,a,u){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var v=y.dependencies;if(v!==null){var b=y.child;v=v.firstContext;e:for(;v!==null;){var C=v;v=y;for(var U=0;U<r.length;U++)if(C.context===r[U]){v.lanes|=a,C=v.alternate,C!==null&&(C.lanes|=a),Ff(v.return,a,i),u||(b=null);break e}v=C.next}}else if(y.tag===18){if(b=y.return,b===null)throw Error(s(341));b.lanes|=a,v=b.alternate,v!==null&&(v.lanes|=a),Ff(b,a,i),b=null}else b=y.child;if(b!==null)b.return=y;else for(b=y;b!==null;){if(b===i){b=null;break}if(y=b.sibling,y!==null){y.return=b.return,b=y;break}b=b.return}y=b}}function $o(i,r,a,u){i=null;for(var y=r,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var b=y.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var C=y.type;Mn(y.pendingProps.value,b.value)||(i!==null?i.push(C):i=[C])}}else if(y===ve.current){if(b=y.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(Yl):i=[Yl])}y=y.return}i!==null&&Hf(r,i,a,u),r.flags|=262144}function uc(i){for(i=i.firstContext;i!==null;){if(!Mn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function to(i){eo=i,is=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function on(i){return zg(eo,i)}function cc(i,r){return eo===null&&to(i),zg(i,r)}function zg(i,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},is===null){if(i===null)throw Error(s(308));is=r,i.dependencies={lanes:0,firstContext:r},i.flags|=524288}else is=is.next=r;return a}var Tx=typeof AbortController<"u"?AbortController:function(){var i=[],r=this.signal={aborted:!1,addEventListener:function(a,u){i.push(u)}};this.abort=function(){r.aborted=!0,i.forEach(function(a){return a()})}},Ex=n.unstable_scheduleCallback,Sx=n.unstable_NormalPriority,Bt={$$typeof:K,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new Tx,data:new Map,refCount:0}}function Tl(i){i.refCount--,i.refCount===0&&Ex(Sx,function(){i.controller.abort()})}var El=null,Gf=0,Qo=0,Xo=null;function Ax(i,r){if(El===null){var a=El=[];Gf=0,Qo=Jh(),Xo={status:"pending",value:void 0,then:function(u){a.push(u)}}}return Gf++,r.then(Gg,Gg),r}function Gg(){if(--Gf===0&&El!==null){Xo!==null&&(Xo.status="fulfilled");var i=El;El=null,Qo=0,Xo=null;for(var r=0;r<i.length;r++)(0,i[r])()}}function bx(i,r){var a=[],u={status:"pending",value:null,reason:null,then:function(y){a.push(y)}};return i.then(function(){u.status="fulfilled",u.value=r;for(var y=0;y<a.length;y++)(0,a[y])(r)},function(y){for(u.status="rejected",u.reason=y,y=0;y<a.length;y++)(0,a[y])(void 0)}),u}var jg=X.S;X.S=function(i,r){w_=gt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Ax(i,r),jg!==null&&jg(i,r)};var no=q(null);function jf(){var i=no.current;return i!==null?i:yt.pooledCache}function dc(i,r){r===null?me(no,no.current):me(no,r.pool)}function Yg(){var i=jf();return i===null?null:{parent:Bt._currentValue,pool:i}}var Wo=Error(s(460)),Yf=Error(s(474)),fc=Error(s(542)),hc={then:function(){}};function Jg(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Kg(i,r,a){switch(a=i[a],a===void 0?i.push(r):a!==r&&(r.then(ii,ii),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Qg(i),i;default:if(typeof r.status=="string")r.then(ii,ii);else{if(i=yt,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=r,i.status="pending",i.then(function(u){if(r.status==="pending"){var y=r;y.status="fulfilled",y.value=u}},function(u){if(r.status==="pending"){var y=r;y.status="rejected",y.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Qg(i),i}throw so=r,Wo}}function io(i){try{var r=i._init;return r(i._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(so=a,Wo):a}}var so=null;function $g(){if(so===null)throw Error(s(459));var i=so;return so=null,i}function Qg(i){if(i===Wo||i===fc)throw Error(s(483))}var Zo=null,Sl=0;function mc(i){var r=Sl;return Sl+=1,Zo===null&&(Zo=[]),Kg(Zo,i,r)}function Al(i,r){r=r.props.ref,i.ref=r!==void 0?r:null}function pc(i,r){throw r.$$typeof===A?Error(s(525)):(i=Object.prototype.toString.call(r),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":i)))}function Xg(i){function r(H,O){if(i){var G=H.deletions;G===null?(H.deletions=[O],H.flags|=16):G.push(O)}}function a(H,O){if(!i)return null;for(;O!==null;)r(H,O),O=O.sibling;return null}function u(H){for(var O=new Map;H!==null;)H.key!==null?O.set(H.key,H):O.set(H.index,H),H=H.sibling;return O}function y(H,O){return H=ts(H,O),H.index=0,H.sibling=null,H}function v(H,O,G){return H.index=G,i?(G=H.alternate,G!==null?(G=G.index,G<O?(H.flags|=67108866,O):G):(H.flags|=67108866,O)):(H.flags|=1048576,O)}function b(H){return i&&H.alternate===null&&(H.flags|=67108866),H}function C(H,O,G,ie){return O===null||O.tag!==6?(O=Vf(G,H.mode,ie),O.return=H,O):(O=y(O,G),O.return=H,O)}function U(H,O,G,ie){var Ie=G.type;return Ie===B?ne(H,O,G.props.children,ie,G.key):O!==null&&(O.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===R&&io(Ie)===O.type)?(O=y(O,G.props),Al(O,G),O.return=H,O):(O=ac(G.type,G.key,G.props,null,H.mode,ie),Al(O,G),O.return=H,O)}function j(H,O,G,ie){return O===null||O.tag!==4||O.stateNode.containerInfo!==G.containerInfo||O.stateNode.implementation!==G.implementation?(O=kf(G,H.mode,ie),O.return=H,O):(O=y(O,G.children||[]),O.return=H,O)}function ne(H,O,G,ie,Ie){return O===null||O.tag!==7?(O=Wr(G,H.mode,ie,Ie),O.return=H,O):(O=y(O,G),O.return=H,O)}function oe(H,O,G){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=Vf(""+O,H.mode,G),O.return=H,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case I:return G=ac(O.type,O.key,O.props,null,H.mode,G),Al(G,O),G.return=H,G;case k:return O=kf(O,H.mode,G),O.return=H,O;case R:return O=io(O),oe(H,O,G)}if($e(O)||V(O))return O=Wr(O,H.mode,G,null),O.return=H,O;if(typeof O.then=="function")return oe(H,mc(O),G);if(O.$$typeof===K)return oe(H,cc(H,O),G);pc(H,O)}return null}function J(H,O,G,ie){var Ie=O!==null?O.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return Ie!==null?null:C(H,O,""+G,ie);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case I:return G.key===Ie?U(H,O,G,ie):null;case k:return G.key===Ie?j(H,O,G,ie):null;case R:return G=io(G),J(H,O,G,ie)}if($e(G)||V(G))return Ie!==null?null:ne(H,O,G,ie,null);if(typeof G.then=="function")return J(H,O,mc(G),ie);if(G.$$typeof===K)return J(H,O,cc(H,G),ie);pc(H,G)}return null}function W(H,O,G,ie,Ie){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return H=H.get(G)||null,C(O,H,""+ie,Ie);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:return H=H.get(ie.key===null?G:ie.key)||null,U(O,H,ie,Ie);case k:return H=H.get(ie.key===null?G:ie.key)||null,j(O,H,ie,Ie);case R:return ie=io(ie),W(H,O,G,ie,Ie)}if($e(ie)||V(ie))return H=H.get(G)||null,ne(O,H,ie,Ie,null);if(typeof ie.then=="function")return W(H,O,G,mc(ie),Ie);if(ie.$$typeof===K)return W(H,O,G,cc(O,ie),Ie);pc(O,ie)}return null}function Ee(H,O,G,ie){for(var Ie=null,nt=null,xe=O,Be=O=0,Ge=null;xe!==null&&Be<G.length;Be++){xe.index>Be?(Ge=xe,xe=null):Ge=xe.sibling;var it=J(H,xe,G[Be],ie);if(it===null){xe===null&&(xe=Ge);break}i&&xe&&it.alternate===null&&r(H,xe),O=v(it,O,Be),nt===null?Ie=it:nt.sibling=it,nt=it,xe=Ge}if(Be===G.length)return a(H,xe),Ke&&ns(H,Be),Ie;if(xe===null){for(;Be<G.length;Be++)xe=oe(H,G[Be],ie),xe!==null&&(O=v(xe,O,Be),nt===null?Ie=xe:nt.sibling=xe,nt=xe);return Ke&&ns(H,Be),Ie}for(xe=u(xe);Be<G.length;Be++)Ge=W(xe,H,Be,G[Be],ie),Ge!==null&&(i&&Ge.alternate!==null&&xe.delete(Ge.key===null?Be:Ge.key),O=v(Ge,O,Be),nt===null?Ie=Ge:nt.sibling=Ge,nt=Ge);return i&&xe.forEach(function(yr){return r(H,yr)}),Ke&&ns(H,Be),Ie}function Re(H,O,G,ie){if(G==null)throw Error(s(151));for(var Ie=null,nt=null,xe=O,Be=O=0,Ge=null,it=G.next();xe!==null&&!it.done;Be++,it=G.next()){xe.index>Be?(Ge=xe,xe=null):Ge=xe.sibling;var yr=J(H,xe,it.value,ie);if(yr===null){xe===null&&(xe=Ge);break}i&&xe&&yr.alternate===null&&r(H,xe),O=v(yr,O,Be),nt===null?Ie=yr:nt.sibling=yr,nt=yr,xe=Ge}if(it.done)return a(H,xe),Ke&&ns(H,Be),Ie;if(xe===null){for(;!it.done;Be++,it=G.next())it=oe(H,it.value,ie),it!==null&&(O=v(it,O,Be),nt===null?Ie=it:nt.sibling=it,nt=it);return Ke&&ns(H,Be),Ie}for(xe=u(xe);!it.done;Be++,it=G.next())it=W(xe,H,Be,it.value,ie),it!==null&&(i&&it.alternate!==null&&xe.delete(it.key===null?Be:it.key),O=v(it,O,Be),nt===null?Ie=it:nt.sibling=it,nt=it);return i&&xe.forEach(function(kC){return r(H,kC)}),Ke&&ns(H,Be),Ie}function pt(H,O,G,ie){if(typeof G=="object"&&G!==null&&G.type===B&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case I:e:{for(var Ie=G.key;O!==null;){if(O.key===Ie){if(Ie=G.type,Ie===B){if(O.tag===7){a(H,O.sibling),ie=y(O,G.props.children),ie.return=H,H=ie;break e}}else if(O.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===R&&io(Ie)===O.type){a(H,O.sibling),ie=y(O,G.props),Al(ie,G),ie.return=H,H=ie;break e}a(H,O);break}else r(H,O);O=O.sibling}G.type===B?(ie=Wr(G.props.children,H.mode,ie,G.key),ie.return=H,H=ie):(ie=ac(G.type,G.key,G.props,null,H.mode,ie),Al(ie,G),ie.return=H,H=ie)}return b(H);case k:e:{for(Ie=G.key;O!==null;){if(O.key===Ie)if(O.tag===4&&O.stateNode.containerInfo===G.containerInfo&&O.stateNode.implementation===G.implementation){a(H,O.sibling),ie=y(O,G.children||[]),ie.return=H,H=ie;break e}else{a(H,O);break}else r(H,O);O=O.sibling}ie=kf(G,H.mode,ie),ie.return=H,H=ie}return b(H);case R:return G=io(G),pt(H,O,G,ie)}if($e(G))return Ee(H,O,G,ie);if(V(G)){if(Ie=V(G),typeof Ie!="function")throw Error(s(150));return G=Ie.call(G),Re(H,O,G,ie)}if(typeof G.then=="function")return pt(H,O,mc(G),ie);if(G.$$typeof===K)return pt(H,O,cc(H,G),ie);pc(H,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,O!==null&&O.tag===6?(a(H,O.sibling),ie=y(O,G),ie.return=H,H=ie):(a(H,O),ie=Vf(G,H.mode,ie),ie.return=H,H=ie),b(H)):a(H,O)}return function(H,O,G,ie){try{Sl=0;var Ie=pt(H,O,G,ie);return Zo=null,Ie}catch(xe){if(xe===Wo||xe===fc)throw xe;var nt=Dn(29,xe,null,H.mode);return nt.lanes=ie,nt.return=H,nt}finally{}}}var ro=Xg(!0),Wg=Xg(!1),er=!1;function Jf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Kf(i,r){i=i.updateQueue,r.updateQueue===i&&(r.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function tr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function nr(i,r,a){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(ot&2)!==0){var y=u.pending;return y===null?r.next=r:(r.next=y.next,y.next=r),u.pending=r,r=oc(i),kg(i,null,a),r}return rc(i,u,r,a),oc(i)}function bl(i,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var u=r.lanes;u&=i.pendingLanes,a|=u,r.lanes=a,Xa(i,a)}}function $f(i,r){var a=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var y=null,v=null;if(a=a.firstBaseUpdate,a!==null){do{var b={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};v===null?y=v=b:v=v.next=b,a=a.next}while(a!==null);v===null?y=v=r:v=v.next=r}else y=v=r;a={baseState:u.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:u.shared,callbacks:u.callbacks},i.updateQueue=a;return}i=a.lastBaseUpdate,i===null?a.firstBaseUpdate=r:i.next=r,a.lastBaseUpdate=r}var Qf=!1;function xl(){if(Qf){var i=Xo;if(i!==null)throw i}}function Cl(i,r,a,u){Qf=!1;var y=i.updateQueue;er=!1;var v=y.firstBaseUpdate,b=y.lastBaseUpdate,C=y.shared.pending;if(C!==null){y.shared.pending=null;var U=C,j=U.next;U.next=null,b===null?v=j:b.next=j,b=U;var ne=i.alternate;ne!==null&&(ne=ne.updateQueue,C=ne.lastBaseUpdate,C!==b&&(C===null?ne.firstBaseUpdate=j:C.next=j,ne.lastBaseUpdate=U))}if(v!==null){var oe=y.baseState;b=0,ne=j=U=null,C=v;do{var J=C.lane&-536870913,W=J!==C.lane;if(W?(ze&J)===J:(u&J)===J){J!==0&&J===Qo&&(Qf=!0),ne!==null&&(ne=ne.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var Ee=i,Re=C;J=r;var pt=a;switch(Re.tag){case 1:if(Ee=Re.payload,typeof Ee=="function"){oe=Ee.call(pt,oe,J);break e}oe=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Re.payload,J=typeof Ee=="function"?Ee.call(pt,oe,J):Ee,J==null)break e;oe=E({},oe,J);break e;case 2:er=!0}}J=C.callback,J!==null&&(i.flags|=64,W&&(i.flags|=8192),W=y.callbacks,W===null?y.callbacks=[J]:W.push(J))}else W={lane:J,tag:C.tag,payload:C.payload,callback:C.callback,next:null},ne===null?(j=ne=W,U=oe):ne=ne.next=W,b|=J;if(C=C.next,C===null){if(C=y.shared.pending,C===null)break;W=C,C=W.next,W.next=null,y.lastBaseUpdate=W,y.shared.pending=null}}while(!0);ne===null&&(U=oe),y.baseState=U,y.firstBaseUpdate=j,y.lastBaseUpdate=ne,v===null&&(y.shared.lanes=0),ar|=b,i.lanes=b,i.memoizedState=oe}}function Zg(i,r){if(typeof i!="function")throw Error(s(191,i));i.call(r)}function ey(i,r){var a=i.callbacks;if(a!==null)for(i.callbacks=null,i=0;i<a.length;i++)Zg(a[i],r)}var ea=q(null),gc=q(0);function ty(i,r){i=hs,me(gc,i),me(ea,r),hs=i|r.baseLanes}function Xf(){me(gc,hs),me(ea,ea.current)}function Wf(){hs=gc.current,se(ea),se(gc)}var Pn=q(null),Kn=null;function ir(i){var r=i.alternate;me(Dt,Dt.current&1),me(Pn,i),Kn===null&&(r===null||ea.current!==null||r.memoizedState!==null)&&(Kn=i)}function Zf(i){me(Dt,Dt.current),me(Pn,i),Kn===null&&(Kn=i)}function ny(i){i.tag===22?(me(Dt,Dt.current),me(Pn,i),Kn===null&&(Kn=i)):sr()}function sr(){me(Dt,Dt.current),me(Pn,Pn.current)}function Vn(i){se(Pn),Kn===i&&(Kn=null),se(Dt)}var Dt=q(0);function yc(i){for(var r=i;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||rm(a)||om(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var rs=0,Oe=null,ht=null,Ft=null,_c=!1,ta=!1,oo=!1,vc=0,Il=0,na=null,xx=0;function wt(){throw Error(s(321))}function eh(i,r){if(r===null)return!1;for(var a=0;a<r.length&&a<i.length;a++)if(!Mn(i[a],r[a]))return!1;return!0}function th(i,r,a,u,y,v){return rs=v,Oe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,X.H=i===null||i.memoizedState===null?qy:gh,oo=!1,v=a(u,y),oo=!1,ta&&(v=sy(r,a,u,y)),iy(i),v}function iy(i){X.H=Nl;var r=ht!==null&&ht.next!==null;if(rs=0,Ft=ht=Oe=null,_c=!1,Il=0,na=null,r)throw Error(s(300));i===null||Ht||(i=i.dependencies,i!==null&&uc(i)&&(Ht=!0))}function sy(i,r,a,u){Oe=i;var y=0;do{if(ta&&(na=null),Il=0,ta=!1,25<=y)throw Error(s(301));if(y+=1,Ft=ht=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}X.H=By,v=r(a,u)}while(ta);return v}function Cx(){var i=X.H,r=i.useState()[0];return r=typeof r.then=="function"?wl(r):r,i=i.useState()[0],(ht!==null?ht.memoizedState:null)!==i&&(Oe.flags|=1024),r}function nh(){var i=vc!==0;return vc=0,i}function ih(i,r,a){r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~a}function sh(i){if(_c){for(i=i.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}_c=!1}rs=0,Ft=ht=Oe=null,ta=!1,Il=vc=0,na=null}function yn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?Oe.memoizedState=Ft=i:Ft=Ft.next=i,Ft}function Pt(){if(ht===null){var i=Oe.alternate;i=i!==null?i.memoizedState:null}else i=ht.next;var r=Ft===null?Oe.memoizedState:Ft.next;if(r!==null)Ft=r,ht=i;else{if(i===null)throw Oe.alternate===null?Error(s(467)):Error(s(310));ht=i,i={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},Ft===null?Oe.memoizedState=Ft=i:Ft=Ft.next=i}return Ft}function Tc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wl(i){var r=Il;return Il+=1,na===null&&(na=[]),i=Kg(na,i,r),r=Oe,(Ft===null?r.memoizedState:Ft.next)===null&&(r=r.alternate,X.H=r===null||r.memoizedState===null?qy:gh),i}function Ec(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return wl(i);if(i.$$typeof===K)return on(i)}throw Error(s(438,String(i)))}function rh(i){var r=null,a=Oe.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var u=Oe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(y){return y.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=Tc(),Oe.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(i),u=0;u<i;u++)a[u]=L;return r.index++,a}function os(i,r){return typeof r=="function"?r(i):r}function Sc(i){var r=Pt();return oh(r,ht,i)}function oh(i,r,a){var u=i.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var y=i.baseQueue,v=u.pending;if(v!==null){if(y!==null){var b=y.next;y.next=v.next,v.next=b}r.baseQueue=y=v,u.pending=null}if(v=i.baseState,y===null)i.memoizedState=v;else{r=y.next;var C=b=null,U=null,j=r,ne=!1;do{var oe=j.lane&-536870913;if(oe!==j.lane?(ze&oe)===oe:(rs&oe)===oe){var J=j.revertLane;if(J===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),oe===Qo&&(ne=!0);else if((rs&J)===J){j=j.next,J===Qo&&(ne=!0);continue}else oe={lane:0,revertLane:j.revertLane,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},U===null?(C=U=oe,b=v):U=U.next=oe,Oe.lanes|=J,ar|=J;oe=j.action,oo&&a(v,oe),v=j.hasEagerState?j.eagerState:a(v,oe)}else J={lane:oe,revertLane:j.revertLane,gesture:j.gesture,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},U===null?(C=U=J,b=v):U=U.next=J,Oe.lanes|=oe,ar|=oe;j=j.next}while(j!==null&&j!==r);if(U===null?b=v:U.next=C,!Mn(v,i.memoizedState)&&(Ht=!0,ne&&(a=Xo,a!==null)))throw a;i.memoizedState=v,i.baseState=b,i.baseQueue=U,u.lastRenderedState=v}return y===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function ah(i){var r=Pt(),a=r.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=i;var u=a.dispatch,y=a.pending,v=r.memoizedState;if(y!==null){a.pending=null;var b=y=y.next;do v=i(v,b.action),b=b.next;while(b!==y);Mn(v,r.memoizedState)||(Ht=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),a.lastRenderedState=v}return[v,u]}function ry(i,r,a){var u=Oe,y=Pt(),v=Ke;if(v){if(a===void 0)throw Error(s(407));a=a()}else a=r();var b=!Mn((ht||y).memoizedState,a);if(b&&(y.memoizedState=a,Ht=!0),y=y.queue,ch(ly.bind(null,u,y,i),[i]),y.getSnapshot!==r||b||Ft!==null&&Ft.memoizedState.tag&1){if(u.flags|=2048,ia(9,{destroy:void 0},ay.bind(null,u,y,a,r),null),yt===null)throw Error(s(349));v||(rs&127)!==0||oy(u,r,a)}return a}function oy(i,r,a){i.flags|=16384,i={getSnapshot:r,value:a},r=Oe.updateQueue,r===null?(r=Tc(),Oe.updateQueue=r,r.stores=[i]):(a=r.stores,a===null?r.stores=[i]:a.push(i))}function ay(i,r,a,u){r.value=a,r.getSnapshot=u,uy(r)&&cy(i)}function ly(i,r,a){return a(function(){uy(r)&&cy(i)})}function uy(i){var r=i.getSnapshot;i=i.value;try{var a=r();return!Mn(i,a)}catch{return!0}}function cy(i){var r=Xr(i,2);r!==null&&Cn(r,i,2)}function lh(i){var r=yn();if(typeof i=="function"){var a=i;if(i=a(),oo){Qt(!0);try{a()}finally{Qt(!1)}}}return r.memoizedState=r.baseState=i,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:i},r}function dy(i,r,a,u){return i.baseState=a,oh(i,ht,typeof u=="function"?u:os)}function Ix(i,r,a,u,y){if(xc(i))throw Error(s(485));if(i=r.action,i!==null){var v={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};X.T!==null?a(!0):v.isTransition=!1,u(v),a=r.pending,a===null?(v.next=r.pending=v,fy(r,v)):(v.next=a.next,r.pending=a.next=v)}}function fy(i,r){var a=r.action,u=r.payload,y=i.state;if(r.isTransition){var v=X.T,b={};X.T=b;try{var C=a(y,u),U=X.S;U!==null&&U(b,C),hy(i,r,C)}catch(j){uh(i,r,j)}finally{v!==null&&b.types!==null&&(v.types=b.types),X.T=v}}else try{v=a(y,u),hy(i,r,v)}catch(j){uh(i,r,j)}}function hy(i,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){my(i,r,u)},function(u){return uh(i,r,u)}):my(i,r,a)}function my(i,r,a){r.status="fulfilled",r.value=a,py(r),i.state=a,r=i.pending,r!==null&&(a=r.next,a===r?i.pending=null:(a=a.next,r.next=a,fy(i,a)))}function uh(i,r,a){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=a,py(r),r=r.next;while(r!==u)}i.action=null}function py(i){i=i.listeners;for(var r=0;r<i.length;r++)(0,i[r])()}function gy(i,r){return r}function yy(i,r){if(Ke){var a=yt.formState;if(a!==null){e:{var u=Oe;if(Ke){if(vt){t:{for(var y=vt,v=Jn;y.nodeType!==8;){if(!v){y=null;break t}if(y=$n(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){vt=$n(y.nextSibling),u=y.data==="F!";break e}}Ws(u)}u=!1}u&&(r=a[0])}}return a=yn(),a.memoizedState=a.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gy,lastRenderedState:r},a.queue=u,a=Uy.bind(null,Oe,u),u.dispatch=a,u=lh(!1),v=ph.bind(null,Oe,!1,u.queue),u=yn(),y={state:r,dispatch:null,action:i,pending:null},u.queue=y,a=Ix.bind(null,Oe,y,v,a),y.dispatch=a,u.memoizedState=i,[r,a,!1]}function _y(i){var r=Pt();return vy(r,ht,i)}function vy(i,r,a){if(r=oh(i,r,gy)[0],i=Sc(os)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=wl(r)}catch(b){throw b===Wo?fc:b}else u=r;r=Pt();var y=r.queue,v=y.dispatch;return a!==r.memoizedState&&(Oe.flags|=2048,ia(9,{destroy:void 0},wx.bind(null,y,a),null)),[u,v,i]}function wx(i,r){i.action=r}function Ty(i){var r=Pt(),a=ht;if(a!==null)return vy(r,a,i);Pt(),r=r.memoizedState,a=Pt();var u=a.queue.dispatch;return a.memoizedState=i,[r,u,!1]}function ia(i,r,a,u){return i={tag:i,create:a,deps:u,inst:r,next:null},r=Oe.updateQueue,r===null&&(r=Tc(),Oe.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=i.next=i:(u=a.next,a.next=i,i.next=u,r.lastEffect=i),i}function Ey(){return Pt().memoizedState}function Ac(i,r,a,u){var y=yn();Oe.flags|=i,y.memoizedState=ia(1|r,{destroy:void 0},a,u===void 0?null:u)}function bc(i,r,a,u){var y=Pt();u=u===void 0?null:u;var v=y.memoizedState.inst;ht!==null&&u!==null&&eh(u,ht.memoizedState.deps)?y.memoizedState=ia(r,v,a,u):(Oe.flags|=i,y.memoizedState=ia(1|r,v,a,u))}function Sy(i,r){Ac(8390656,8,i,r)}function ch(i,r){bc(2048,8,i,r)}function Rx(i){Oe.flags|=4;var r=Oe.updateQueue;if(r===null)r=Tc(),Oe.updateQueue=r,r.events=[i];else{var a=r.events;a===null?r.events=[i]:a.push(i)}}function Ay(i){var r=Pt().memoizedState;return Rx({ref:r,nextImpl:i}),function(){if((ot&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function by(i,r){return bc(4,2,i,r)}function xy(i,r){return bc(4,4,i,r)}function Cy(i,r){if(typeof r=="function"){i=i();var a=r(i);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return i=i(),r.current=i,function(){r.current=null}}function Iy(i,r,a){a=a!=null?a.concat([i]):null,bc(4,4,Cy.bind(null,r,i),a)}function dh(){}function wy(i,r){var a=Pt();r=r===void 0?null:r;var u=a.memoizedState;return r!==null&&eh(r,u[1])?u[0]:(a.memoizedState=[i,r],i)}function Ry(i,r){var a=Pt();r=r===void 0?null:r;var u=a.memoizedState;if(r!==null&&eh(r,u[1]))return u[0];if(u=i(),oo){Qt(!0);try{i()}finally{Qt(!1)}}return a.memoizedState=[u,r],u}function fh(i,r,a){return a===void 0||(rs&1073741824)!==0&&(ze&261930)===0?i.memoizedState=r:(i.memoizedState=a,i=N_(),Oe.lanes|=i,ar|=i,a)}function Ny(i,r,a,u){return Mn(a,r)?a:ea.current!==null?(i=fh(i,a,u),Mn(i,r)||(Ht=!0),i):(rs&42)===0||(rs&1073741824)!==0&&(ze&261930)===0?(Ht=!0,i.memoizedState=a):(i=N_(),Oe.lanes|=i,ar|=i,r)}function My(i,r,a,u,y){var v=fe.p;fe.p=v!==0&&8>v?v:8;var b=X.T,C={};X.T=C,ph(i,!1,r,a);try{var U=y(),j=X.S;if(j!==null&&j(C,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ne=bx(U,u);Rl(i,r,ne,Ln(i))}else Rl(i,r,u,Ln(i))}catch(oe){Rl(i,r,{then:function(){},status:"rejected",reason:oe},Ln())}finally{fe.p=v,b!==null&&C.types!==null&&(b.types=C.types),X.T=b}}function Nx(){}function hh(i,r,a,u){if(i.tag!==5)throw Error(s(476));var y=Dy(i).queue;My(i,y,r,Ae,a===null?Nx:function(){return Py(i),a(u)})}function Dy(i){var r=i.memoizedState;if(r!==null)return r;r={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:Ae},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:a},next:null},i.memoizedState=r,i=i.alternate,i!==null&&(i.memoizedState=r),r}function Py(i){var r=Dy(i);r.next===null&&(r=i.alternate.memoizedState),Rl(i,r.next.queue,{},Ln())}function mh(){return on(Yl)}function Vy(){return Pt().memoizedState}function ky(){return Pt().memoizedState}function Mx(i){for(var r=i.return;r!==null;){switch(r.tag){case 24:case 3:var a=Ln();i=tr(a);var u=nr(r,i,a);u!==null&&(Cn(u,r,a),bl(u,r,a)),r={cache:zf()},i.payload=r;return}r=r.return}}function Dx(i,r,a){var u=Ln();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},xc(i)?Ly(r,a):(a=Df(i,r,a,u),a!==null&&(Cn(a,i,u),Oy(a,r,u)))}function Uy(i,r,a){var u=Ln();Rl(i,r,a,u)}function Rl(i,r,a,u){var y={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(xc(i))Ly(r,y);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var b=r.lastRenderedState,C=v(b,a);if(y.hasEagerState=!0,y.eagerState=C,Mn(C,b))return rc(i,r,y,0),yt===null&&sc(),!1}catch{}finally{}if(a=Df(i,r,y,u),a!==null)return Cn(a,i,u),Oy(a,r,u),!0}return!1}function ph(i,r,a,u){if(u={lane:2,revertLane:Jh(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},xc(i)){if(r)throw Error(s(479))}else r=Df(i,a,u,2),r!==null&&Cn(r,i,2)}function xc(i){var r=i.alternate;return i===Oe||r!==null&&r===Oe}function Ly(i,r){ta=_c=!0;var a=i.pending;a===null?r.next=r:(r.next=a.next,a.next=r),i.pending=r}function Oy(i,r,a){if((a&4194048)!==0){var u=r.lanes;u&=i.pendingLanes,a|=u,r.lanes=a,Xa(i,a)}}var Nl={readContext:on,use:Ec,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt};Nl.useEffectEvent=wt;var qy={readContext:on,use:Ec,useCallback:function(i,r){return yn().memoizedState=[i,r===void 0?null:r],i},useContext:on,useEffect:Sy,useImperativeHandle:function(i,r,a){a=a!=null?a.concat([i]):null,Ac(4194308,4,Cy.bind(null,r,i),a)},useLayoutEffect:function(i,r){return Ac(4194308,4,i,r)},useInsertionEffect:function(i,r){Ac(4,2,i,r)},useMemo:function(i,r){var a=yn();r=r===void 0?null:r;var u=i();if(oo){Qt(!0);try{i()}finally{Qt(!1)}}return a.memoizedState=[u,r],u},useReducer:function(i,r,a){var u=yn();if(a!==void 0){var y=a(r);if(oo){Qt(!0);try{a(r)}finally{Qt(!1)}}}else y=r;return u.memoizedState=u.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},u.queue=i,i=i.dispatch=Dx.bind(null,Oe,i),[u.memoizedState,i]},useRef:function(i){var r=yn();return i={current:i},r.memoizedState=i},useState:function(i){i=lh(i);var r=i.queue,a=Uy.bind(null,Oe,r);return r.dispatch=a,[i.memoizedState,a]},useDebugValue:dh,useDeferredValue:function(i,r){var a=yn();return fh(a,i,r)},useTransition:function(){var i=lh(!1);return i=My.bind(null,Oe,i.queue,!0,!1),yn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,r,a){var u=Oe,y=yn();if(Ke){if(a===void 0)throw Error(s(407));a=a()}else{if(a=r(),yt===null)throw Error(s(349));(ze&127)!==0||oy(u,r,a)}y.memoizedState=a;var v={value:a,getSnapshot:r};return y.queue=v,Sy(ly.bind(null,u,v,i),[i]),u.flags|=2048,ia(9,{destroy:void 0},ay.bind(null,u,v,a,r),null),a},useId:function(){var i=yn(),r=yt.identifierPrefix;if(Ke){var a=Bi,u=qi;a=(u&~(1<<32-De(u)-1)).toString(32)+a,r="_"+r+"R_"+a,a=vc++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=xx++,r="_"+r+"r_"+a.toString(32)+"_";return i.memoizedState=r},useHostTransitionStatus:mh,useFormState:yy,useActionState:yy,useOptimistic:function(i){var r=yn();r.memoizedState=r.baseState=i;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=ph.bind(null,Oe,!0,a),a.dispatch=r,[i,r]},useMemoCache:rh,useCacheRefresh:function(){return yn().memoizedState=Mx.bind(null,Oe)},useEffectEvent:function(i){var r=yn(),a={impl:i};return r.memoizedState=a,function(){if((ot&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},gh={readContext:on,use:Ec,useCallback:wy,useContext:on,useEffect:ch,useImperativeHandle:Iy,useInsertionEffect:by,useLayoutEffect:xy,useMemo:Ry,useReducer:Sc,useRef:Ey,useState:function(){return Sc(os)},useDebugValue:dh,useDeferredValue:function(i,r){var a=Pt();return Ny(a,ht.memoizedState,i,r)},useTransition:function(){var i=Sc(os)[0],r=Pt().memoizedState;return[typeof i=="boolean"?i:wl(i),r]},useSyncExternalStore:ry,useId:Vy,useHostTransitionStatus:mh,useFormState:_y,useActionState:_y,useOptimistic:function(i,r){var a=Pt();return dy(a,ht,i,r)},useMemoCache:rh,useCacheRefresh:ky};gh.useEffectEvent=Ay;var By={readContext:on,use:Ec,useCallback:wy,useContext:on,useEffect:ch,useImperativeHandle:Iy,useInsertionEffect:by,useLayoutEffect:xy,useMemo:Ry,useReducer:ah,useRef:Ey,useState:function(){return ah(os)},useDebugValue:dh,useDeferredValue:function(i,r){var a=Pt();return ht===null?fh(a,i,r):Ny(a,ht.memoizedState,i,r)},useTransition:function(){var i=ah(os)[0],r=Pt().memoizedState;return[typeof i=="boolean"?i:wl(i),r]},useSyncExternalStore:ry,useId:Vy,useHostTransitionStatus:mh,useFormState:Ty,useActionState:Ty,useOptimistic:function(i,r){var a=Pt();return ht!==null?dy(a,ht,i,r):(a.baseState=i,[i,a.queue.dispatch])},useMemoCache:rh,useCacheRefresh:ky};By.useEffectEvent=Ay;function yh(i,r,a,u){r=i.memoizedState,a=a(u,r),a=a==null?r:E({},r,a),i.memoizedState=a,i.lanes===0&&(i.updateQueue.baseState=a)}var _h={enqueueSetState:function(i,r,a){i=i._reactInternals;var u=Ln(),y=tr(u);y.payload=r,a!=null&&(y.callback=a),r=nr(i,y,u),r!==null&&(Cn(r,i,u),bl(r,i,u))},enqueueReplaceState:function(i,r,a){i=i._reactInternals;var u=Ln(),y=tr(u);y.tag=1,y.payload=r,a!=null&&(y.callback=a),r=nr(i,y,u),r!==null&&(Cn(r,i,u),bl(r,i,u))},enqueueForceUpdate:function(i,r){i=i._reactInternals;var a=Ln(),u=tr(a);u.tag=2,r!=null&&(u.callback=r),r=nr(i,u,a),r!==null&&(Cn(r,i,a),bl(r,i,a))}};function Fy(i,r,a,u,y,v,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,v,b):r.prototype&&r.prototype.isPureReactComponent?!gl(a,u)||!gl(y,v):!0}function Hy(i,r,a,u){i=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,u),r.state!==i&&_h.enqueueReplaceState(r,r.state,null)}function ao(i,r){var a=r;if("ref"in r){a={};for(var u in r)u!=="ref"&&(a[u]=r[u])}if(i=i.defaultProps){a===r&&(a=E({},a));for(var y in i)a[y]===void 0&&(a[y]=i[y])}return a}function zy(i){ic(i)}function Gy(i){console.error(i)}function jy(i){ic(i)}function Cc(i,r){try{var a=i.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Yy(i,r,a){try{var u=i.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function vh(i,r,a){return a=tr(a),a.tag=3,a.payload={element:null},a.callback=function(){Cc(i,r)},a}function Jy(i){return i=tr(i),i.tag=3,i}function Ky(i,r,a,u){var y=a.type.getDerivedStateFromError;if(typeof y=="function"){var v=u.value;i.payload=function(){return y(v)},i.callback=function(){Yy(r,a,u)}}var b=a.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){Yy(r,a,u),typeof y!="function"&&(lr===null?lr=new Set([this]):lr.add(this));var C=u.stack;this.componentDidCatch(u.value,{componentStack:C!==null?C:""})})}function Px(i,r,a,u,y){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=a.alternate,r!==null&&$o(r,a,y,!0),a=Pn.current,a!==null){switch(a.tag){case 31:case 13:return Kn===null?Oc():a.alternate===null&&Rt===0&&(Rt=3),a.flags&=-257,a.flags|=65536,a.lanes=y,u===hc?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([u]):r.add(u),Gh(i,u,y)),!1;case 22:return a.flags|=65536,u===hc?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([u]):a.add(u)),Gh(i,u,y)),!1}throw Error(s(435,a.tag))}return Gh(i,u,y),Oc(),!1}if(Ke)return r=Pn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=y,u!==Of&&(i=Error(s(422),{cause:u}),vl(Gn(i,a)))):(u!==Of&&(r=Error(s(423),{cause:u}),vl(Gn(r,a))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,u=Gn(u,a),y=vh(i.stateNode,u,y),$f(i,y),Rt!==4&&(Rt=2)),!1;var v=Error(s(520),{cause:u});if(v=Gn(v,a),Ol===null?Ol=[v]:Ol.push(v),Rt!==4&&(Rt=2),r===null)return!0;u=Gn(u,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,i=y&-y,a.lanes|=i,i=vh(a.stateNode,u,i),$f(a,i),!1;case 1:if(r=a.type,v=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(lr===null||!lr.has(v))))return a.flags|=65536,y&=-y,a.lanes|=y,y=Jy(y),Ky(y,i,a,u),$f(a,y),!1}a=a.return}while(a!==null);return!1}var Th=Error(s(461)),Ht=!1;function an(i,r,a,u){r.child=i===null?Wg(r,null,a,u):ro(r,i.child,a,u)}function $y(i,r,a,u,y){a=a.render;var v=r.ref;if("ref"in u){var b={};for(var C in u)C!=="ref"&&(b[C]=u[C])}else b=u;return to(r),u=th(i,r,a,b,v,y),C=nh(),i!==null&&!Ht?(ih(i,r,y),as(i,r,y)):(Ke&&C&&Uf(r),r.flags|=1,an(i,r,u,y),r.child)}function Qy(i,r,a,u,y){if(i===null){var v=a.type;return typeof v=="function"&&!Pf(v)&&v.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=v,Xy(i,r,v,u,y)):(i=ac(a.type,null,u,r,r.mode,y),i.ref=r.ref,i.return=r,r.child=i)}if(v=i.child,!wh(i,y)){var b=v.memoizedProps;if(a=a.compare,a=a!==null?a:gl,a(b,u)&&i.ref===r.ref)return as(i,r,y)}return r.flags|=1,i=ts(v,u),i.ref=r.ref,i.return=r,r.child=i}function Xy(i,r,a,u,y){if(i!==null){var v=i.memoizedProps;if(gl(v,u)&&i.ref===r.ref)if(Ht=!1,r.pendingProps=u=v,wh(i,y))(i.flags&131072)!==0&&(Ht=!0);else return r.lanes=i.lanes,as(i,r,y)}return Eh(i,r,a,u,y)}function Wy(i,r,a,u){var y=u.children,v=i!==null?i.memoizedState:null;if(i===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(v=v!==null?v.baseLanes|a:a,i!==null){for(u=r.child=i.child,y=0;u!==null;)y=y|u.lanes|u.childLanes,u=u.sibling;u=y&~v}else u=0,r.child=null;return Zy(i,r,v,a,u)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},i!==null&&dc(r,v!==null?v.cachePool:null),v!==null?ty(r,v):Xf(),ny(r);else return u=r.lanes=536870912,Zy(i,r,v!==null?v.baseLanes|a:a,a,u)}else v!==null?(dc(r,v.cachePool),ty(r,v),sr(),r.memoizedState=null):(i!==null&&dc(r,null),Xf(),sr());return an(i,r,y,a),r.child}function Ml(i,r){return i!==null&&i.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Zy(i,r,a,u,y){var v=jf();return v=v===null?null:{parent:Bt._currentValue,pool:v},r.memoizedState={baseLanes:a,cachePool:v},i!==null&&dc(r,null),Xf(),ny(r),i!==null&&$o(i,r,u,!0),r.childLanes=y,null}function Ic(i,r){return r=Rc({mode:r.mode,children:r.children},i.mode),r.ref=i.ref,i.child=r,r.return=i,r}function e_(i,r,a){return ro(r,i.child,null,a),i=Ic(r,r.pendingProps),i.flags|=2,Vn(r),r.memoizedState=null,i}function Vx(i,r,a){var u=r.pendingProps,y=(r.flags&128)!==0;if(r.flags&=-129,i===null){if(Ke){if(u.mode==="hidden")return i=Ic(r,u),r.lanes=536870912,Ml(null,i);if(Zf(r),(i=vt)?(i=fv(i,Jn),i=i!==null&&i.data==="&"?i:null,i!==null&&(r.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:qi,overflow:Bi}:null,retryLane:536870912,hydrationErrors:null},a=Lg(i),a.return=r,r.child=a,rn=r,vt=null)):i=null,i===null)throw Ws(r);return r.lanes=536870912,null}return Ic(r,u)}var v=i.memoizedState;if(v!==null){var b=v.dehydrated;if(Zf(r),y)if(r.flags&256)r.flags&=-257,r=e_(i,r,a);else if(r.memoizedState!==null)r.child=i.child,r.flags|=128,r=null;else throw Error(s(558));else if(Ht||$o(i,r,a,!1),y=(a&i.childLanes)!==0,Ht||y){if(u=yt,u!==null&&(b=Wa(u,a),b!==0&&b!==v.retryLane))throw v.retryLane=b,Xr(i,b),Cn(u,i,b),Th;Oc(),r=e_(i,r,a)}else i=v.treeContext,vt=$n(b.nextSibling),rn=r,Ke=!0,Xs=null,Jn=!1,i!==null&&Bg(r,i),r=Ic(r,u),r.flags|=4096;return r}return i=ts(i.child,{mode:u.mode,children:u.children}),i.ref=r.ref,r.child=i,i.return=r,i}function wc(i,r){var a=r.ref;if(a===null)i!==null&&i.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(i===null||i.ref!==a)&&(r.flags|=4194816)}}function Eh(i,r,a,u,y){return to(r),a=th(i,r,a,u,void 0,y),u=nh(),i!==null&&!Ht?(ih(i,r,y),as(i,r,y)):(Ke&&u&&Uf(r),r.flags|=1,an(i,r,a,y),r.child)}function t_(i,r,a,u,y,v){return to(r),r.updateQueue=null,a=sy(r,u,a,y),iy(i),u=nh(),i!==null&&!Ht?(ih(i,r,v),as(i,r,v)):(Ke&&u&&Uf(r),r.flags|=1,an(i,r,a,v),r.child)}function n_(i,r,a,u,y){if(to(r),r.stateNode===null){var v=jo,b=a.contextType;typeof b=="object"&&b!==null&&(v=on(b)),v=new a(u,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=_h,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=u,v.state=r.memoizedState,v.refs={},Jf(r),b=a.contextType,v.context=typeof b=="object"&&b!==null?on(b):jo,v.state=r.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(yh(r,a,b,u),v.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&_h.enqueueReplaceState(v,v.state,null),Cl(r,u,v,y),xl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(i===null){v=r.stateNode;var C=r.memoizedProps,U=ao(a,C);v.props=U;var j=v.context,ne=a.contextType;b=jo,typeof ne=="object"&&ne!==null&&(b=on(ne));var oe=a.getDerivedStateFromProps;ne=typeof oe=="function"||typeof v.getSnapshotBeforeUpdate=="function",C=r.pendingProps!==C,ne||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(C||j!==b)&&Hy(r,v,u,b),er=!1;var J=r.memoizedState;v.state=J,Cl(r,u,v,y),xl(),j=r.memoizedState,C||J!==j||er?(typeof oe=="function"&&(yh(r,a,oe,u),j=r.memoizedState),(U=er||Fy(r,a,U,u,J,j,b))?(ne||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=j),v.props=u,v.state=j,v.context=b,u=U):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{v=r.stateNode,Kf(i,r),b=r.memoizedProps,ne=ao(a,b),v.props=ne,oe=r.pendingProps,J=v.context,j=a.contextType,U=jo,typeof j=="object"&&j!==null&&(U=on(j)),C=a.getDerivedStateFromProps,(j=typeof C=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==oe||J!==U)&&Hy(r,v,u,U),er=!1,J=r.memoizedState,v.state=J,Cl(r,u,v,y),xl();var W=r.memoizedState;b!==oe||J!==W||er||i!==null&&i.dependencies!==null&&uc(i.dependencies)?(typeof C=="function"&&(yh(r,a,C,u),W=r.memoizedState),(ne=er||Fy(r,a,ne,u,J,W,U)||i!==null&&i.dependencies!==null&&uc(i.dependencies))?(j||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(u,W,U),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(u,W,U)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=W),v.props=u,v.state=W,v.context=U,u=ne):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(r.flags|=1024),u=!1)}return v=u,wc(i,r),u=(r.flags&128)!==0,v||u?(v=r.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,i!==null&&u?(r.child=ro(r,i.child,null,y),r.child=ro(r,null,a,y)):an(i,r,a,y),r.memoizedState=v.state,i=r.child):i=as(i,r,y),i}function i_(i,r,a,u){return Zr(),r.flags|=256,an(i,r,a,u),r.child}var Sh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ah(i){return{baseLanes:i,cachePool:Yg()}}function bh(i,r,a){return i=i!==null?i.childLanes&~a:0,r&&(i|=Un),i}function s_(i,r,a){var u=r.pendingProps,y=!1,v=(r.flags&128)!==0,b;if((b=v)||(b=i!==null&&i.memoizedState===null?!1:(Dt.current&2)!==0),b&&(y=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,i===null){if(Ke){if(y?ir(r):sr(),(i=vt)?(i=fv(i,Jn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(r.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:qi,overflow:Bi}:null,retryLane:536870912,hydrationErrors:null},a=Lg(i),a.return=r,r.child=a,rn=r,vt=null)):i=null,i===null)throw Ws(r);return om(i)?r.lanes=32:r.lanes=536870912,null}var C=u.children;return u=u.fallback,y?(sr(),y=r.mode,C=Rc({mode:"hidden",children:C},y),u=Wr(u,y,a,null),C.return=r,u.return=r,C.sibling=u,r.child=C,u=r.child,u.memoizedState=Ah(a),u.childLanes=bh(i,b,a),r.memoizedState=Sh,Ml(null,u)):(ir(r),xh(r,C))}var U=i.memoizedState;if(U!==null&&(C=U.dehydrated,C!==null)){if(v)r.flags&256?(ir(r),r.flags&=-257,r=Ch(i,r,a)):r.memoizedState!==null?(sr(),r.child=i.child,r.flags|=128,r=null):(sr(),C=u.fallback,y=r.mode,u=Rc({mode:"visible",children:u.children},y),C=Wr(C,y,a,null),C.flags|=2,u.return=r,C.return=r,u.sibling=C,r.child=u,ro(r,i.child,null,a),u=r.child,u.memoizedState=Ah(a),u.childLanes=bh(i,b,a),r.memoizedState=Sh,r=Ml(null,u));else if(ir(r),om(C)){if(b=C.nextSibling&&C.nextSibling.dataset,b)var j=b.dgst;b=j,u=Error(s(419)),u.stack="",u.digest=b,vl({value:u,source:null,stack:null}),r=Ch(i,r,a)}else if(Ht||$o(i,r,a,!1),b=(a&i.childLanes)!==0,Ht||b){if(b=yt,b!==null&&(u=Wa(b,a),u!==0&&u!==U.retryLane))throw U.retryLane=u,Xr(i,u),Cn(b,i,u),Th;rm(C)||Oc(),r=Ch(i,r,a)}else rm(C)?(r.flags|=192,r.child=i.child,r=null):(i=U.treeContext,vt=$n(C.nextSibling),rn=r,Ke=!0,Xs=null,Jn=!1,i!==null&&Bg(r,i),r=xh(r,u.children),r.flags|=4096);return r}return y?(sr(),C=u.fallback,y=r.mode,U=i.child,j=U.sibling,u=ts(U,{mode:"hidden",children:u.children}),u.subtreeFlags=U.subtreeFlags&65011712,j!==null?C=ts(j,C):(C=Wr(C,y,a,null),C.flags|=2),C.return=r,u.return=r,u.sibling=C,r.child=u,Ml(null,u),u=r.child,C=i.child.memoizedState,C===null?C=Ah(a):(y=C.cachePool,y!==null?(U=Bt._currentValue,y=y.parent!==U?{parent:U,pool:U}:y):y=Yg(),C={baseLanes:C.baseLanes|a,cachePool:y}),u.memoizedState=C,u.childLanes=bh(i,b,a),r.memoizedState=Sh,Ml(i.child,u)):(ir(r),a=i.child,i=a.sibling,a=ts(a,{mode:"visible",children:u.children}),a.return=r,a.sibling=null,i!==null&&(b=r.deletions,b===null?(r.deletions=[i],r.flags|=16):b.push(i)),r.child=a,r.memoizedState=null,a)}function xh(i,r){return r=Rc({mode:"visible",children:r},i.mode),r.return=i,i.child=r}function Rc(i,r){return i=Dn(22,i,null,r),i.lanes=0,i}function Ch(i,r,a){return ro(r,i.child,null,a),i=xh(r,r.pendingProps.children),i.flags|=2,r.memoizedState=null,i}function r_(i,r,a){i.lanes|=r;var u=i.alternate;u!==null&&(u.lanes|=r),Ff(i.return,r,a)}function Ih(i,r,a,u,y,v){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:y,treeForkCount:v}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=a,b.tailMode=y,b.treeForkCount=v)}function o_(i,r,a){var u=r.pendingProps,y=u.revealOrder,v=u.tail;u=u.children;var b=Dt.current,C=(b&2)!==0;if(C?(b=b&1|2,r.flags|=128):b&=1,me(Dt,b),an(i,r,u,a),u=Ke?_l:0,!C&&i!==null&&(i.flags&128)!==0)e:for(i=r.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&r_(i,a,r);else if(i.tag===19)r_(i,a,r);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(a=r.child,y=null;a!==null;)i=a.alternate,i!==null&&yc(i)===null&&(y=a),a=a.sibling;a=y,a===null?(y=r.child,r.child=null):(y=a.sibling,a.sibling=null),Ih(r,!1,y,a,v,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,y=r.child,r.child=null;y!==null;){if(i=y.alternate,i!==null&&yc(i)===null){r.child=y;break}i=y.sibling,y.sibling=a,a=y,y=i}Ih(r,!0,a,null,v,u);break;case"together":Ih(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function as(i,r,a){if(i!==null&&(r.dependencies=i.dependencies),ar|=r.lanes,(a&r.childLanes)===0)if(i!==null){if($o(i,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(i!==null&&r.child!==i.child)throw Error(s(153));if(r.child!==null){for(i=r.child,a=ts(i,i.pendingProps),r.child=a,a.return=r;i.sibling!==null;)i=i.sibling,a=a.sibling=ts(i,i.pendingProps),a.return=r;a.sibling=null}return r.child}function wh(i,r){return(i.lanes&r)!==0?!0:(i=i.dependencies,!!(i!==null&&uc(i)))}function kx(i,r,a){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),Zs(r,Bt,i.memoizedState.cache),Zr();break;case 27:case 5:vn(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:Zs(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Zf(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ir(r),r.flags|=128,null):(a&r.child.childLanes)!==0?s_(i,r,a):(ir(r),i=as(i,r,a),i!==null?i.sibling:null);ir(r);break;case 19:var y=(i.flags&128)!==0;if(u=(a&r.childLanes)!==0,u||($o(i,r,a,!1),u=(a&r.childLanes)!==0),y){if(u)return o_(i,r,a);r.flags|=128}if(y=r.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),me(Dt,Dt.current),u)break;return null;case 22:return r.lanes=0,Wy(i,r,a,r.pendingProps);case 24:Zs(r,Bt,i.memoizedState.cache)}return as(i,r,a)}function a_(i,r,a){if(i!==null)if(i.memoizedProps!==r.pendingProps)Ht=!0;else{if(!wh(i,a)&&(r.flags&128)===0)return Ht=!1,kx(i,r,a);Ht=(i.flags&131072)!==0}else Ht=!1,Ke&&(r.flags&1048576)!==0&&qg(r,_l,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(i=io(r.elementType),r.type=i,typeof i=="function")Pf(i)?(u=ao(i,u),r.tag=1,r=n_(null,r,i,u,a)):(r.tag=0,r=Eh(null,r,i,u,a));else{if(i!=null){var y=i.$$typeof;if(y===Y){r.tag=11,r=$y(null,r,i,u,a);break e}else if(y===M){r.tag=14,r=Qy(null,r,i,u,a);break e}}throw r=Ve(i)||i,Error(s(306,r,""))}}return r;case 0:return Eh(i,r,r.type,r.pendingProps,a);case 1:return u=r.type,y=ao(u,r.pendingProps),n_(i,r,u,y,a);case 3:e:{if(Qe(r,r.stateNode.containerInfo),i===null)throw Error(s(387));u=r.pendingProps;var v=r.memoizedState;y=v.element,Kf(i,r),Cl(r,u,null,a);var b=r.memoizedState;if(u=b.cache,Zs(r,Bt,u),u!==v.cache&&Hf(r,[Bt],a,!0),xl(),u=b.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=i_(i,r,u,a);break e}else if(u!==y){y=Gn(Error(s(424)),r),vl(y),r=i_(i,r,u,a);break e}else{switch(i=r.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(vt=$n(i.firstChild),rn=r,Ke=!0,Xs=null,Jn=!0,a=Wg(r,null,u,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Zr(),u===y){r=as(i,r,a);break e}an(i,r,u,a)}r=r.child}return r;case 26:return wc(i,r),i===null?(a=_v(r.type,null,r.pendingProps,null))?r.memoizedState=a:Ke||(a=r.type,i=r.pendingProps,u=jc(ce.current).createElement(a),u[Lt]=r,u[Xt]=i,ln(u,a,i),Ot(u),r.stateNode=u):r.memoizedState=_v(r.type,i.memoizedProps,r.pendingProps,i.memoizedState),null;case 27:return vn(r),i===null&&Ke&&(u=r.stateNode=pv(r.type,r.pendingProps,ce.current),rn=r,Jn=!0,y=vt,fr(r.type)?(am=y,vt=$n(u.firstChild)):vt=y),an(i,r,r.pendingProps.children,a),wc(i,r),i===null&&(r.flags|=4194304),r.child;case 5:return i===null&&Ke&&((y=u=vt)&&(u=dC(u,r.type,r.pendingProps,Jn),u!==null?(r.stateNode=u,rn=r,vt=$n(u.firstChild),Jn=!1,y=!0):y=!1),y||Ws(r)),vn(r),y=r.type,v=r.pendingProps,b=i!==null?i.memoizedProps:null,u=v.children,nm(y,v)?u=null:b!==null&&nm(y,b)&&(r.flags|=32),r.memoizedState!==null&&(y=th(i,r,Cx,null,null,a),Yl._currentValue=y),wc(i,r),an(i,r,u,a),r.child;case 6:return i===null&&Ke&&((i=a=vt)&&(a=fC(a,r.pendingProps,Jn),a!==null?(r.stateNode=a,rn=r,vt=null,i=!0):i=!1),i||Ws(r)),null;case 13:return s_(i,r,a);case 4:return Qe(r,r.stateNode.containerInfo),u=r.pendingProps,i===null?r.child=ro(r,null,u,a):an(i,r,u,a),r.child;case 11:return $y(i,r,r.type,r.pendingProps,a);case 7:return an(i,r,r.pendingProps,a),r.child;case 8:return an(i,r,r.pendingProps.children,a),r.child;case 12:return an(i,r,r.pendingProps.children,a),r.child;case 10:return u=r.pendingProps,Zs(r,r.type,u.value),an(i,r,u.children,a),r.child;case 9:return y=r.type._context,u=r.pendingProps.children,to(r),y=on(y),u=u(y),r.flags|=1,an(i,r,u,a),r.child;case 14:return Qy(i,r,r.type,r.pendingProps,a);case 15:return Xy(i,r,r.type,r.pendingProps,a);case 19:return o_(i,r,a);case 31:return Vx(i,r,a);case 22:return Wy(i,r,a,r.pendingProps);case 24:return to(r),u=on(Bt),i===null?(y=jf(),y===null&&(y=yt,v=zf(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=a),y=v),r.memoizedState={parent:u,cache:y},Jf(r),Zs(r,Bt,y)):((i.lanes&a)!==0&&(Kf(i,r),Cl(r,null,null,a),xl()),y=i.memoizedState,v=r.memoizedState,y.parent!==u?(y={parent:u,cache:u},r.memoizedState=y,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=y),Zs(r,Bt,u)):(u=v.cache,Zs(r,Bt,u),u!==y.cache&&Hf(r,[Bt],a,!0))),an(i,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function ls(i){i.flags|=4}function Rh(i,r,a,u,y){if((r=(i.mode&32)!==0)&&(r=!1),r){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(V_())i.flags|=8192;else throw so=hc,Yf}else i.flags&=-16777217}function l_(i,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Av(r))if(V_())i.flags|=8192;else throw so=hc,Yf}function Nc(i,r){r!==null&&(i.flags|=4),i.flags&16384&&(r=i.tag!==22?Uu():536870912,i.lanes|=r,aa|=r)}function Dl(i,r){if(!Ke)switch(i.tailMode){case"hidden":r=i.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?i.tail=null:a.sibling=null;break;case"collapsed":a=i.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function Tt(i){var r=i.alternate!==null&&i.alternate.child===i.child,a=0,u=0;if(r)for(var y=i.child;y!==null;)a|=y.lanes|y.childLanes,u|=y.subtreeFlags&65011712,u|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)a|=y.lanes|y.childLanes,u|=y.subtreeFlags,u|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=u,i.childLanes=a,r}function Ux(i,r,a){var u=r.pendingProps;switch(Lf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(r),null;case 1:return Tt(r),null;case 3:return a=r.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),ss(Bt),tt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(i===null||i.child===null)&&(Ko(r)?ls(r):i===null||i.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,qf())),Tt(r),null;case 26:var y=r.type,v=r.memoizedState;return i===null?(ls(r),v!==null?(Tt(r),l_(r,v)):(Tt(r),Rh(r,y,null,u,a))):v?v!==i.memoizedState?(ls(r),Tt(r),l_(r,v)):(Tt(r),r.flags&=-16777217):(i=i.memoizedProps,i!==u&&ls(r),Tt(r),Rh(r,y,i,u,a)),null;case 27:if(xt(r),a=ce.current,y=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==u&&ls(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return Tt(r),null}i=ye.current,Ko(r)?Fg(r):(i=pv(y,u,a),r.stateNode=i,ls(r))}return Tt(r),null;case 5:if(xt(r),y=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==u&&ls(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return Tt(r),null}if(v=ye.current,Ko(r))Fg(r);else{var b=jc(ce.current);switch(v){case 1:v=b.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=b.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=b.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=b.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=b.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?v.multiple=!0:u.size&&(v.size=u.size);break;default:v=typeof u.is=="string"?b.createElement(y,{is:u.is}):b.createElement(y)}}v[Lt]=r,v[Xt]=u;e:for(b=r.child;b!==null;){if(b.tag===5||b.tag===6)v.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===r)break e;for(;b.sibling===null;){if(b.return===null||b.return===r)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}r.stateNode=v;e:switch(ln(v,y,u),y){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&ls(r)}}return Tt(r),Rh(r,r.type,i===null?null:i.memoizedProps,r.pendingProps,a),null;case 6:if(i&&r.stateNode!=null)i.memoizedProps!==u&&ls(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(s(166));if(i=ce.current,Ko(r)){if(i=r.stateNode,a=r.memoizedProps,u=null,y=rn,y!==null)switch(y.tag){case 27:case 5:u=y.memoizedProps}i[Lt]=r,i=!!(i.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||sv(i.nodeValue,a)),i||Ws(r,!0)}else i=jc(i).createTextNode(u),i[Lt]=r,r.stateNode=i}return Tt(r),null;case 31:if(a=r.memoizedState,i===null||i.memoizedState!==null){if(u=Ko(r),a!==null){if(i===null){if(!u)throw Error(s(318));if(i=r.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[Lt]=r}else Zr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Tt(r),i=!1}else a=qf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=a),i=!0;if(!i)return r.flags&256?(Vn(r),r):(Vn(r),null);if((r.flags&128)!==0)throw Error(s(558))}return Tt(r),null;case 13:if(u=r.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Ko(r),u!==null&&u.dehydrated!==null){if(i===null){if(!y)throw Error(s(318));if(y=r.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(s(317));y[Lt]=r}else Zr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Tt(r),y=!1}else y=qf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return r.flags&256?(Vn(r),r):(Vn(r),null)}return Vn(r),(r.flags&128)!==0?(r.lanes=a,r):(a=u!==null,i=i!==null&&i.memoizedState!==null,a&&(u=r.child,y=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(y=u.alternate.memoizedState.cachePool.pool),v=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==y&&(u.flags|=2048)),a!==i&&a&&(r.child.flags|=8192),Nc(r,r.updateQueue),Tt(r),null);case 4:return tt(),i===null&&Xh(r.stateNode.containerInfo),Tt(r),null;case 10:return ss(r.type),Tt(r),null;case 19:if(se(Dt),u=r.memoizedState,u===null)return Tt(r),null;if(y=(r.flags&128)!==0,v=u.rendering,v===null)if(y)Dl(u,!1);else{if(Rt!==0||i!==null&&(i.flags&128)!==0)for(i=r.child;i!==null;){if(v=yc(i),v!==null){for(r.flags|=128,Dl(u,!1),i=v.updateQueue,r.updateQueue=i,Nc(r,i),r.subtreeFlags=0,i=a,a=r.child;a!==null;)Ug(a,i),a=a.sibling;return me(Dt,Dt.current&1|2),Ke&&ns(r,u.treeForkCount),r.child}i=i.sibling}u.tail!==null&&gt()>kc&&(r.flags|=128,y=!0,Dl(u,!1),r.lanes=4194304)}else{if(!y)if(i=yc(v),i!==null){if(r.flags|=128,y=!0,i=i.updateQueue,r.updateQueue=i,Nc(r,i),Dl(u,!0),u.tail===null&&u.tailMode==="hidden"&&!v.alternate&&!Ke)return Tt(r),null}else 2*gt()-u.renderingStartTime>kc&&a!==536870912&&(r.flags|=128,y=!0,Dl(u,!1),r.lanes=4194304);u.isBackwards?(v.sibling=r.child,r.child=v):(i=u.last,i!==null?i.sibling=v:r.child=v,u.last=v)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=gt(),i.sibling=null,a=Dt.current,me(Dt,y?a&1|2:a&1),Ke&&ns(r,u.treeForkCount),i):(Tt(r),null);case 22:case 23:return Vn(r),Wf(),u=r.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(a&536870912)!==0&&(r.flags&128)===0&&(Tt(r),r.subtreeFlags&6&&(r.flags|=8192)):Tt(r),a=r.updateQueue,a!==null&&Nc(r,a.retryQueue),a=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==a&&(r.flags|=2048),i!==null&&se(no),null;case 24:return a=null,i!==null&&(a=i.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),ss(Bt),Tt(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function Lx(i,r){switch(Lf(r),r.tag){case 1:return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 3:return ss(Bt),tt(),i=r.flags,(i&65536)!==0&&(i&128)===0?(r.flags=i&-65537|128,r):null;case 26:case 27:case 5:return xt(r),null;case 31:if(r.memoizedState!==null){if(Vn(r),r.alternate===null)throw Error(s(340));Zr()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 13:if(Vn(r),i=r.memoizedState,i!==null&&i.dehydrated!==null){if(r.alternate===null)throw Error(s(340));Zr()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 19:return se(Dt),null;case 4:return tt(),null;case 10:return ss(r.type),null;case 22:case 23:return Vn(r),Wf(),i!==null&&se(no),i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 24:return ss(Bt),null;case 25:return null;default:return null}}function u_(i,r){switch(Lf(r),r.tag){case 3:ss(Bt),tt();break;case 26:case 27:case 5:xt(r);break;case 4:tt();break;case 31:r.memoizedState!==null&&Vn(r);break;case 13:Vn(r);break;case 19:se(Dt);break;case 10:ss(r.type);break;case 22:case 23:Vn(r),Wf(),i!==null&&se(no);break;case 24:ss(Bt)}}function Pl(i,r){try{var a=r.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var y=u.next;a=y;do{if((a.tag&i)===i){u=void 0;var v=a.create,b=a.inst;u=v(),b.destroy=u}a=a.next}while(a!==y)}}catch(C){ct(r,r.return,C)}}function rr(i,r,a){try{var u=r.updateQueue,y=u!==null?u.lastEffect:null;if(y!==null){var v=y.next;u=v;do{if((u.tag&i)===i){var b=u.inst,C=b.destroy;if(C!==void 0){b.destroy=void 0,y=r;var U=a,j=C;try{j()}catch(ne){ct(y,U,ne)}}}u=u.next}while(u!==v)}}catch(ne){ct(r,r.return,ne)}}function c_(i){var r=i.updateQueue;if(r!==null){var a=i.stateNode;try{ey(r,a)}catch(u){ct(i,i.return,u)}}}function d_(i,r,a){a.props=ao(i.type,i.memoizedProps),a.state=i.memoizedState;try{a.componentWillUnmount()}catch(u){ct(i,r,u)}}function Vl(i,r){try{var a=i.ref;if(a!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof a=="function"?i.refCleanup=a(u):a.current=u}}catch(y){ct(i,r,y)}}function Fi(i,r){var a=i.ref,u=i.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(y){ct(i,r,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(y){ct(i,r,y)}else a.current=null}function f_(i){var r=i.type,a=i.memoizedProps,u=i.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(y){ct(i,i.return,y)}}function Nh(i,r,a){try{var u=i.stateNode;rC(u,i.type,a,r),u[Xt]=r}catch(y){ct(i,i.return,y)}}function h_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&fr(i.type)||i.tag===4}function Mh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||h_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&fr(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Dh(i,r,a){var u=i.tag;if(u===5||u===6)i=i.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(i,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(i),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=ii));else if(u!==4&&(u===27&&fr(i.type)&&(a=i.stateNode,r=null),i=i.child,i!==null))for(Dh(i,r,a),i=i.sibling;i!==null;)Dh(i,r,a),i=i.sibling}function Mc(i,r,a){var u=i.tag;if(u===5||u===6)i=i.stateNode,r?a.insertBefore(i,r):a.appendChild(i);else if(u!==4&&(u===27&&fr(i.type)&&(a=i.stateNode),i=i.child,i!==null))for(Mc(i,r,a),i=i.sibling;i!==null;)Mc(i,r,a),i=i.sibling}function m_(i){var r=i.stateNode,a=i.memoizedProps;try{for(var u=i.type,y=r.attributes;y.length;)r.removeAttributeNode(y[0]);ln(r,u,a),r[Lt]=i,r[Xt]=a}catch(v){ct(i,i.return,v)}}var us=!1,zt=!1,Ph=!1,p_=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function Ox(i,r){if(i=i.containerInfo,em=Wc,i=Ig(i),Cf(i)){if("selectionStart"in i)var a={start:i.selectionStart,end:i.selectionEnd};else e:{a=(a=i.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var y=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{a.nodeType,v.nodeType}catch{a=null;break e}var b=0,C=-1,U=-1,j=0,ne=0,oe=i,J=null;t:for(;;){for(var W;oe!==a||y!==0&&oe.nodeType!==3||(C=b+y),oe!==v||u!==0&&oe.nodeType!==3||(U=b+u),oe.nodeType===3&&(b+=oe.nodeValue.length),(W=oe.firstChild)!==null;)J=oe,oe=W;for(;;){if(oe===i)break t;if(J===a&&++j===y&&(C=b),J===v&&++ne===u&&(U=b),(W=oe.nextSibling)!==null)break;oe=J,J=oe.parentNode}oe=W}a=C===-1||U===-1?null:{start:C,end:U}}else a=null}a=a||{start:0,end:0}}else a=null;for(tm={focusedElem:i,selectionRange:a},Wc=!1,Zt=r;Zt!==null;)if(r=Zt,i=r.child,(r.subtreeFlags&1028)!==0&&i!==null)i.return=r,Zt=i;else for(;Zt!==null;){switch(r=Zt,v=r.alternate,i=r.flags,r.tag){case 0:if((i&4)!==0&&(i=r.updateQueue,i=i!==null?i.events:null,i!==null))for(a=0;a<i.length;a++)y=i[a],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,a=r,y=v.memoizedProps,v=v.memoizedState,u=a.stateNode;try{var Ee=ao(a.type,y);i=u.getSnapshotBeforeUpdate(Ee,v),u.__reactInternalSnapshotBeforeUpdate=i}catch(Re){ct(a,a.return,Re)}}break;case 3:if((i&1024)!==0){if(i=r.stateNode.containerInfo,a=i.nodeType,a===9)sm(i);else if(a===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":sm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=r.sibling,i!==null){i.return=r.return,Zt=i;break}Zt=r.return}}function g_(i,r,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:ds(i,a),u&4&&Pl(5,a);break;case 1:if(ds(i,a),u&4)if(i=a.stateNode,r===null)try{i.componentDidMount()}catch(b){ct(a,a.return,b)}else{var y=ao(a.type,r.memoizedProps);r=r.memoizedState;try{i.componentDidUpdate(y,r,i.__reactInternalSnapshotBeforeUpdate)}catch(b){ct(a,a.return,b)}}u&64&&c_(a),u&512&&Vl(a,a.return);break;case 3:if(ds(i,a),u&64&&(i=a.updateQueue,i!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{ey(i,r)}catch(b){ct(a,a.return,b)}}break;case 27:r===null&&u&4&&m_(a);case 26:case 5:ds(i,a),r===null&&u&4&&f_(a),u&512&&Vl(a,a.return);break;case 12:ds(i,a);break;case 31:ds(i,a),u&4&&v_(i,a);break;case 13:ds(i,a),u&4&&T_(i,a),u&64&&(i=a.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(a=Jx.bind(null,a),hC(i,a))));break;case 22:if(u=a.memoizedState!==null||us,!u){r=r!==null&&r.memoizedState!==null||zt,y=us;var v=zt;us=u,(zt=r)&&!v?fs(i,a,(a.subtreeFlags&8772)!==0):ds(i,a),us=y,zt=v}break;case 30:break;default:ds(i,a)}}function y_(i){var r=i.alternate;r!==null&&(i.alternate=null,y_(r)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(r=i.stateNode,r!==null&&Mo(r)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var bt=null,Sn=!1;function cs(i,r,a){for(a=a.child;a!==null;)__(i,r,a),a=a.sibling}function __(i,r,a){if(dt&&typeof dt.onCommitFiberUnmount=="function")try{dt.onCommitFiberUnmount(kt,a)}catch{}switch(a.tag){case 26:zt||Fi(a,r),cs(i,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:zt||Fi(a,r);var u=bt,y=Sn;fr(a.type)&&(bt=a.stateNode,Sn=!1),cs(i,r,a),zl(a.stateNode),bt=u,Sn=y;break;case 5:zt||Fi(a,r);case 6:if(u=bt,y=Sn,bt=null,cs(i,r,a),bt=u,Sn=y,bt!==null)if(Sn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(a.stateNode)}catch(v){ct(a,r,v)}else try{bt.removeChild(a.stateNode)}catch(v){ct(a,r,v)}break;case 18:bt!==null&&(Sn?(i=bt,cv(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.stateNode),pa(i)):cv(bt,a.stateNode));break;case 4:u=bt,y=Sn,bt=a.stateNode.containerInfo,Sn=!0,cs(i,r,a),bt=u,Sn=y;break;case 0:case 11:case 14:case 15:rr(2,a,r),zt||rr(4,a,r),cs(i,r,a);break;case 1:zt||(Fi(a,r),u=a.stateNode,typeof u.componentWillUnmount=="function"&&d_(a,r,u)),cs(i,r,a);break;case 21:cs(i,r,a);break;case 22:zt=(u=zt)||a.memoizedState!==null,cs(i,r,a),zt=u;break;default:cs(i,r,a)}}function v_(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{pa(i)}catch(a){ct(r,r.return,a)}}}function T_(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{pa(i)}catch(a){ct(r,r.return,a)}}function qx(i){switch(i.tag){case 31:case 13:case 19:var r=i.stateNode;return r===null&&(r=i.stateNode=new p_),r;case 22:return i=i.stateNode,r=i._retryCache,r===null&&(r=i._retryCache=new p_),r;default:throw Error(s(435,i.tag))}}function Dc(i,r){var a=qx(i);r.forEach(function(u){if(!a.has(u)){a.add(u);var y=Kx.bind(null,i,u);u.then(y,y)}})}function An(i,r){var a=r.deletions;if(a!==null)for(var u=0;u<a.length;u++){var y=a[u],v=i,b=r,C=b;e:for(;C!==null;){switch(C.tag){case 27:if(fr(C.type)){bt=C.stateNode,Sn=!1;break e}break;case 5:bt=C.stateNode,Sn=!1;break e;case 3:case 4:bt=C.stateNode.containerInfo,Sn=!0;break e}C=C.return}if(bt===null)throw Error(s(160));__(v,b,y),bt=null,Sn=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)E_(r,i),r=r.sibling}var ui=null;function E_(i,r){var a=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:An(r,i),bn(i),u&4&&(rr(3,i,i.return),Pl(3,i),rr(5,i,i.return));break;case 1:An(r,i),bn(i),u&512&&(zt||a===null||Fi(a,a.return)),u&64&&us&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(a=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var y=ui;if(An(r,i),bn(i),u&512&&(zt||a===null||Fi(a,a.return)),u&4){var v=a!==null?a.memoizedState:null;if(u=i.memoizedState,a===null)if(u===null)if(i.stateNode===null){e:{u=i.type,a=i.memoizedProps,y=y.ownerDocument||y;t:switch(u){case"title":v=y.getElementsByTagName("title")[0],(!v||v[Ii]||v[Lt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(u),y.head.insertBefore(v,y.querySelector("head > title"))),ln(v,u,a),v[Lt]=i,Ot(v),u=v;break e;case"link":var b=Ev("link","href",y).get(u+(a.href||""));if(b){for(var C=0;C<b.length;C++)if(v=b[C],v.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&v.getAttribute("rel")===(a.rel==null?null:a.rel)&&v.getAttribute("title")===(a.title==null?null:a.title)&&v.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){b.splice(C,1);break t}}v=y.createElement(u),ln(v,u,a),y.head.appendChild(v);break;case"meta":if(b=Ev("meta","content",y).get(u+(a.content||""))){for(C=0;C<b.length;C++)if(v=b[C],v.getAttribute("content")===(a.content==null?null:""+a.content)&&v.getAttribute("name")===(a.name==null?null:a.name)&&v.getAttribute("property")===(a.property==null?null:a.property)&&v.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&v.getAttribute("charset")===(a.charSet==null?null:a.charSet)){b.splice(C,1);break t}}v=y.createElement(u),ln(v,u,a),y.head.appendChild(v);break;default:throw Error(s(468,u))}v[Lt]=i,Ot(v),u=v}i.stateNode=u}else Sv(y,i.type,i.stateNode);else i.stateNode=Tv(y,u,i.memoizedProps);else v!==u?(v===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):v.count--,u===null?Sv(y,i.type,i.stateNode):Tv(y,u,i.memoizedProps)):u===null&&i.stateNode!==null&&Nh(i,i.memoizedProps,a.memoizedProps)}break;case 27:An(r,i),bn(i),u&512&&(zt||a===null||Fi(a,a.return)),a!==null&&u&4&&Nh(i,i.memoizedProps,a.memoizedProps);break;case 5:if(An(r,i),bn(i),u&512&&(zt||a===null||Fi(a,a.return)),i.flags&32){y=i.stateNode;try{En(y,"")}catch(Ee){ct(i,i.return,Ee)}}u&4&&i.stateNode!=null&&(y=i.memoizedProps,Nh(i,y,a!==null?a.memoizedProps:y)),u&1024&&(Ph=!0);break;case 6:if(An(r,i),bn(i),u&4){if(i.stateNode===null)throw Error(s(162));u=i.memoizedProps,a=i.stateNode;try{a.nodeValue=u}catch(Ee){ct(i,i.return,Ee)}}break;case 3:if(Kc=null,y=ui,ui=Yc(r.containerInfo),An(r,i),ui=y,bn(i),u&4&&a!==null&&a.memoizedState.isDehydrated)try{pa(r.containerInfo)}catch(Ee){ct(i,i.return,Ee)}Ph&&(Ph=!1,S_(i));break;case 4:u=ui,ui=Yc(i.stateNode.containerInfo),An(r,i),bn(i),ui=u;break;case 12:An(r,i),bn(i);break;case 31:An(r,i),bn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Dc(i,u)));break;case 13:An(r,i),bn(i),i.child.flags&8192&&i.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Vc=gt()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Dc(i,u)));break;case 22:y=i.memoizedState!==null;var U=a!==null&&a.memoizedState!==null,j=us,ne=zt;if(us=j||y,zt=ne||U,An(r,i),zt=ne,us=j,bn(i),u&8192)e:for(r=i.stateNode,r._visibility=y?r._visibility&-2:r._visibility|1,y&&(a===null||U||us||zt||lo(i)),a=null,r=i;;){if(r.tag===5||r.tag===26){if(a===null){U=a=r;try{if(v=U.stateNode,y)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{C=U.stateNode;var oe=U.memoizedProps.style,J=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;C.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(Ee){ct(U,U.return,Ee)}}}else if(r.tag===6){if(a===null){U=r;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(Ee){ct(U,U.return,Ee)}}}else if(r.tag===18){if(a===null){U=r;try{var W=U.stateNode;y?dv(W,!0):dv(U.stateNode,!1)}catch(Ee){ct(U,U.return,Ee)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===i)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=i.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,Dc(i,a))));break;case 19:An(r,i),bn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Dc(i,u)));break;case 30:break;case 21:break;default:An(r,i),bn(i)}}function bn(i){var r=i.flags;if(r&2){try{for(var a,u=i.return;u!==null;){if(h_(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var y=a.stateNode,v=Mh(i);Mc(i,v,y);break;case 5:var b=a.stateNode;a.flags&32&&(En(b,""),a.flags&=-33);var C=Mh(i);Mc(i,C,b);break;case 3:case 4:var U=a.stateNode.containerInfo,j=Mh(i);Dh(i,j,U);break;default:throw Error(s(161))}}catch(ne){ct(i,i.return,ne)}i.flags&=-3}r&4096&&(i.flags&=-4097)}function S_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var r=i;S_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),i=i.sibling}}function ds(i,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)g_(i,r.alternate,r),r=r.sibling}function lo(i){for(i=i.child;i!==null;){var r=i;switch(r.tag){case 0:case 11:case 14:case 15:rr(4,r,r.return),lo(r);break;case 1:Fi(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&d_(r,r.return,a),lo(r);break;case 27:zl(r.stateNode);case 26:case 5:Fi(r,r.return),lo(r);break;case 22:r.memoizedState===null&&lo(r);break;case 30:lo(r);break;default:lo(r)}i=i.sibling}}function fs(i,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,y=i,v=r,b=v.flags;switch(v.tag){case 0:case 11:case 15:fs(y,v,a),Pl(4,v);break;case 1:if(fs(y,v,a),u=v,y=u.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(j){ct(u,u.return,j)}if(u=v,y=u.updateQueue,y!==null){var C=u.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)Zg(U[y],C)}catch(j){ct(u,u.return,j)}}a&&b&64&&c_(v),Vl(v,v.return);break;case 27:m_(v);case 26:case 5:fs(y,v,a),a&&u===null&&b&4&&f_(v),Vl(v,v.return);break;case 12:fs(y,v,a);break;case 31:fs(y,v,a),a&&b&4&&v_(y,v);break;case 13:fs(y,v,a),a&&b&4&&T_(y,v);break;case 22:v.memoizedState===null&&fs(y,v,a),Vl(v,v.return);break;case 30:break;default:fs(y,v,a)}r=r.sibling}}function Vh(i,r){var a=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),i=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(i=r.memoizedState.cachePool.pool),i!==a&&(i!=null&&i.refCount++,a!=null&&Tl(a))}function kh(i,r){i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Tl(i))}function ci(i,r,a,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)A_(i,r,a,u),r=r.sibling}function A_(i,r,a,u){var y=r.flags;switch(r.tag){case 0:case 11:case 15:ci(i,r,a,u),y&2048&&Pl(9,r);break;case 1:ci(i,r,a,u);break;case 3:ci(i,r,a,u),y&2048&&(i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Tl(i)));break;case 12:if(y&2048){ci(i,r,a,u),i=r.stateNode;try{var v=r.memoizedProps,b=v.id,C=v.onPostCommit;typeof C=="function"&&C(b,r.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(U){ct(r,r.return,U)}}else ci(i,r,a,u);break;case 31:ci(i,r,a,u);break;case 13:ci(i,r,a,u);break;case 23:break;case 22:v=r.stateNode,b=r.alternate,r.memoizedState!==null?v._visibility&2?ci(i,r,a,u):kl(i,r):v._visibility&2?ci(i,r,a,u):(v._visibility|=2,sa(i,r,a,u,(r.subtreeFlags&10256)!==0||!1)),y&2048&&Vh(b,r);break;case 24:ci(i,r,a,u),y&2048&&kh(r.alternate,r);break;default:ci(i,r,a,u)}}function sa(i,r,a,u,y){for(y=y&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var v=i,b=r,C=a,U=u,j=b.flags;switch(b.tag){case 0:case 11:case 15:sa(v,b,C,U,y),Pl(8,b);break;case 23:break;case 22:var ne=b.stateNode;b.memoizedState!==null?ne._visibility&2?sa(v,b,C,U,y):kl(v,b):(ne._visibility|=2,sa(v,b,C,U,y)),y&&j&2048&&Vh(b.alternate,b);break;case 24:sa(v,b,C,U,y),y&&j&2048&&kh(b.alternate,b);break;default:sa(v,b,C,U,y)}r=r.sibling}}function kl(i,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=i,u=r,y=u.flags;switch(u.tag){case 22:kl(a,u),y&2048&&Vh(u.alternate,u);break;case 24:kl(a,u),y&2048&&kh(u.alternate,u);break;default:kl(a,u)}r=r.sibling}}var Ul=8192;function ra(i,r,a){if(i.subtreeFlags&Ul)for(i=i.child;i!==null;)b_(i,r,a),i=i.sibling}function b_(i,r,a){switch(i.tag){case 26:ra(i,r,a),i.flags&Ul&&i.memoizedState!==null&&xC(a,ui,i.memoizedState,i.memoizedProps);break;case 5:ra(i,r,a);break;case 3:case 4:var u=ui;ui=Yc(i.stateNode.containerInfo),ra(i,r,a),ui=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=Ul,Ul=16777216,ra(i,r,a),Ul=u):ra(i,r,a));break;default:ra(i,r,a)}}function x_(i){var r=i.alternate;if(r!==null&&(i=r.child,i!==null)){r.child=null;do r=i.sibling,i.sibling=null,i=r;while(i!==null)}}function Ll(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var u=r[a];Zt=u,I_(u,i)}x_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)C_(i),i=i.sibling}function C_(i){switch(i.tag){case 0:case 11:case 15:Ll(i),i.flags&2048&&rr(9,i,i.return);break;case 3:Ll(i);break;case 12:Ll(i);break;case 22:var r=i.stateNode;i.memoizedState!==null&&r._visibility&2&&(i.return===null||i.return.tag!==13)?(r._visibility&=-3,Pc(i)):Ll(i);break;default:Ll(i)}}function Pc(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var u=r[a];Zt=u,I_(u,i)}x_(i)}for(i=i.child;i!==null;){switch(r=i,r.tag){case 0:case 11:case 15:rr(8,r,r.return),Pc(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,Pc(r));break;default:Pc(r)}i=i.sibling}}function I_(i,r){for(;Zt!==null;){var a=Zt;switch(a.tag){case 0:case 11:case 15:rr(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Tl(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,Zt=u;else e:for(a=i;Zt!==null;){u=Zt;var y=u.sibling,v=u.return;if(y_(u),u===a){Zt=null;break e}if(y!==null){y.return=v,Zt=y;break e}Zt=v}}}var Bx={getCacheForType:function(i){var r=on(Bt),a=r.data.get(i);return a===void 0&&(a=i(),r.data.set(i,a)),a},cacheSignal:function(){return on(Bt).controller.signal}},Fx=typeof WeakMap=="function"?WeakMap:Map,ot=0,yt=null,Fe=null,ze=0,ut=0,kn=null,or=!1,oa=!1,Uh=!1,hs=0,Rt=0,ar=0,uo=0,Lh=0,Un=0,aa=0,Ol=null,xn=null,Oh=!1,Vc=0,w_=0,kc=1/0,Uc=null,lr=null,Jt=0,ur=null,la=null,ms=0,qh=0,Bh=null,R_=null,ql=0,Fh=null;function Ln(){return(ot&2)!==0&&ze!==0?ze&-ze:X.T!==null?Jh():Lu()}function N_(){if(Un===0)if((ze&536870912)===0||Ke){var i=Ur;Ur<<=1,(Ur&3932160)===0&&(Ur=262144),Un=i}else Un=536870912;return i=Pn.current,i!==null&&(i.flags|=32),Un}function Cn(i,r,a){(i===yt&&(ut===2||ut===9)||i.cancelPendingCommit!==null)&&(ua(i,0),cr(i,ze,Un,!1)),Lr(i,a),((ot&2)===0||i!==yt)&&(i===yt&&((ot&2)===0&&(uo|=a),Rt===4&&cr(i,ze,Un,!1)),Hi(i))}function M_(i,r,a){if((ot&6)!==0)throw Error(s(327));var u=!a&&(r&127)===0&&(r&i.expiredLanes)===0||ei(i,r),y=u?Gx(i,r):zh(i,r,!0),v=u;do{if(y===0){oa&&!u&&cr(i,r,0,!1);break}else{if(a=i.current.alternate,v&&!Hx(a)){y=zh(i,r,!1),v=!1;continue}if(y===2){if(v=r,i.errorRecoveryDisabledLanes&v)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var C=i;y=Ol;var U=C.current.memoizedState.isDehydrated;if(U&&(ua(C,b).flags|=256),b=zh(C,b,!1),b!==2){if(Uh&&!U){C.errorRecoveryDisabledLanes|=v,uo|=v,y=4;break e}v=xn,xn=y,v!==null&&(xn===null?xn=v:xn.push.apply(xn,v))}y=b}if(v=!1,y!==2)continue}}if(y===1){ua(i,0),cr(i,r,0,!0);break}e:{switch(u=i,v=y,v){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:cr(u,r,Un,!or);break e;case 2:xn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(y=Vc+300-gt(),10<y)){if(cr(u,r,Un,!or),bi(u,0,!0)!==0)break e;ms=r,u.timeoutHandle=lv(D_.bind(null,u,a,xn,Uc,Oh,r,Un,uo,aa,or,v,"Throttled",-0,0),y);break e}D_(u,a,xn,Uc,Oh,r,Un,uo,aa,or,v,null,-0,0)}}break}while(!0);Hi(i)}function D_(i,r,a,u,y,v,b,C,U,j,ne,oe,J,W){if(i.timeoutHandle=-1,oe=r.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ii},b_(r,v,oe);var Ee=(v&62914560)===v?Vc-gt():(v&4194048)===v?w_-gt():0;if(Ee=CC(oe,Ee),Ee!==null){ms=v,i.cancelPendingCommit=Ee(B_.bind(null,i,r,v,a,u,y,b,C,U,ne,oe,null,J,W)),cr(i,v,b,!j);return}}B_(i,r,v,a,u,y,b,C,U)}function Hx(i){for(var r=i;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var y=a[u],v=y.getSnapshot;y=y.value;try{if(!Mn(v(),y))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function cr(i,r,a,u){r&=~Lh,r&=~uo,i.suspendedLanes|=r,i.pingedLanes&=~r,u&&(i.warmLanes|=r),u=i.expirationTimes;for(var y=r;0<y;){var v=31-De(y),b=1<<v;u[v]=-1,y&=~b}a!==0&&Or(i,a,r)}function Lc(){return(ot&6)===0?(Bl(0),!1):!0}function Hh(){if(Fe!==null){if(ut===0)var i=Fe.return;else i=Fe,is=eo=null,sh(i),Zo=null,Sl=0,i=Fe;for(;i!==null;)u_(i.alternate,i),i=i.return;Fe=null}}function ua(i,r){var a=i.timeoutHandle;a!==-1&&(i.timeoutHandle=-1,lC(a)),a=i.cancelPendingCommit,a!==null&&(i.cancelPendingCommit=null,a()),ms=0,Hh(),yt=i,Fe=a=ts(i.current,null),ze=r,ut=0,kn=null,or=!1,oa=ei(i,r),Uh=!1,aa=Un=Lh=uo=ar=Rt=0,xn=Ol=null,Oh=!1,(r&8)!==0&&(r|=r&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=r;0<u;){var y=31-De(u),v=1<<y;r|=i[y],u&=~v}return hs=r,sc(),a}function P_(i,r){Oe=null,X.H=Nl,r===Wo||r===fc?(r=$g(),ut=3):r===Yf?(r=$g(),ut=4):ut=r===Th?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,kn=r,Fe===null&&(Rt=1,Cc(i,Gn(r,i.current)))}function V_(){var i=Pn.current;return i===null?!0:(ze&4194048)===ze?Kn===null:(ze&62914560)===ze||(ze&536870912)!==0?i===Kn:!1}function k_(){var i=X.H;return X.H=Nl,i===null?Nl:i}function U_(){var i=X.A;return X.A=Bx,i}function Oc(){Rt=4,or||(ze&4194048)!==ze&&Pn.current!==null||(oa=!0),(ar&134217727)===0&&(uo&134217727)===0||yt===null||cr(yt,ze,Un,!1)}function zh(i,r,a){var u=ot;ot|=2;var y=k_(),v=U_();(yt!==i||ze!==r)&&(Uc=null,ua(i,r)),r=!1;var b=Rt;e:do try{if(ut!==0&&Fe!==null){var C=Fe,U=kn;switch(ut){case 8:Hh(),b=6;break e;case 3:case 2:case 9:case 6:Pn.current===null&&(r=!0);var j=ut;if(ut=0,kn=null,ca(i,C,U,j),a&&oa){b=0;break e}break;default:j=ut,ut=0,kn=null,ca(i,C,U,j)}}zx(),b=Rt;break}catch(ne){P_(i,ne)}while(!0);return r&&i.shellSuspendCounter++,is=eo=null,ot=u,X.H=y,X.A=v,Fe===null&&(yt=null,ze=0,sc()),b}function zx(){for(;Fe!==null;)L_(Fe)}function Gx(i,r){var a=ot;ot|=2;var u=k_(),y=U_();yt!==i||ze!==r?(Uc=null,kc=gt()+500,ua(i,r)):oa=ei(i,r);e:do try{if(ut!==0&&Fe!==null){r=Fe;var v=kn;t:switch(ut){case 1:ut=0,kn=null,ca(i,r,v,1);break;case 2:case 9:if(Jg(v)){ut=0,kn=null,O_(r);break}r=function(){ut!==2&&ut!==9||yt!==i||(ut=7),Hi(i)},v.then(r,r);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:Jg(v)?(ut=0,kn=null,O_(r)):(ut=0,kn=null,ca(i,r,v,7));break;case 5:var b=null;switch(Fe.tag){case 26:b=Fe.memoizedState;case 5:case 27:var C=Fe;if(b?Av(b):C.stateNode.complete){ut=0,kn=null;var U=C.sibling;if(U!==null)Fe=U;else{var j=C.return;j!==null?(Fe=j,qc(j)):Fe=null}break t}}ut=0,kn=null,ca(i,r,v,5);break;case 6:ut=0,kn=null,ca(i,r,v,6);break;case 8:Hh(),Rt=6;break e;default:throw Error(s(462))}}jx();break}catch(ne){P_(i,ne)}while(!0);return is=eo=null,X.H=u,X.A=y,ot=a,Fe!==null?0:(yt=null,ze=0,sc(),Rt)}function jx(){for(;Fe!==null&&!Ce();)L_(Fe)}function L_(i){var r=a_(i.alternate,i,hs);i.memoizedProps=i.pendingProps,r===null?qc(i):Fe=r}function O_(i){var r=i,a=r.alternate;switch(r.tag){case 15:case 0:r=t_(a,r,r.pendingProps,r.type,void 0,ze);break;case 11:r=t_(a,r,r.pendingProps,r.type.render,r.ref,ze);break;case 5:sh(r);default:u_(a,r),r=Fe=Ug(r,hs),r=a_(a,r,hs)}i.memoizedProps=i.pendingProps,r===null?qc(i):Fe=r}function ca(i,r,a,u){is=eo=null,sh(r),Zo=null,Sl=0;var y=r.return;try{if(Px(i,y,r,a,ze)){Rt=1,Cc(i,Gn(a,i.current)),Fe=null;return}}catch(v){if(y!==null)throw Fe=y,v;Rt=1,Cc(i,Gn(a,i.current)),Fe=null;return}r.flags&32768?(Ke||u===1?i=!0:oa||(ze&536870912)!==0?i=!1:(or=i=!0,(u===2||u===9||u===3||u===6)&&(u=Pn.current,u!==null&&u.tag===13&&(u.flags|=16384))),q_(r,i)):qc(r)}function qc(i){var r=i;do{if((r.flags&32768)!==0){q_(r,or);return}i=r.return;var a=Ux(r.alternate,r,hs);if(a!==null){Fe=a;return}if(r=r.sibling,r!==null){Fe=r;return}Fe=r=i}while(r!==null);Rt===0&&(Rt=5)}function q_(i,r){do{var a=Lx(i.alternate,i);if(a!==null){a.flags&=32767,Fe=a;return}if(a=i.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(i=i.sibling,i!==null)){Fe=i;return}Fe=i=a}while(i!==null);Rt=6,Fe=null}function B_(i,r,a,u,y,v,b,C,U){i.cancelPendingCommit=null;do Bc();while(Jt!==0);if((ot&6)!==0)throw Error(s(327));if(r!==null){if(r===i.current)throw Error(s(177));if(v=r.lanes|r.childLanes,v|=Mf,Sf(i,a,v,b,C,U),i===yt&&(Fe=yt=null,ze=0),la=r,ur=i,ms=a,qh=v,Bh=y,R_=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,$x(Ei,function(){return j_(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=X.T,X.T=null,y=fe.p,fe.p=2,b=ot,ot|=4;try{Ox(i,r,a)}finally{ot=b,fe.p=y,X.T=u}}Jt=1,F_(),H_(),z_()}}function F_(){if(Jt===1){Jt=0;var i=ur,r=la,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=X.T,X.T=null;var u=fe.p;fe.p=2;var y=ot;ot|=4;try{E_(r,i);var v=tm,b=Ig(i.containerInfo),C=v.focusedElem,U=v.selectionRange;if(b!==C&&C&&C.ownerDocument&&Cg(C.ownerDocument.documentElement,C)){if(U!==null&&Cf(C)){var j=U.start,ne=U.end;if(ne===void 0&&(ne=j),"selectionStart"in C)C.selectionStart=j,C.selectionEnd=Math.min(ne,C.value.length);else{var oe=C.ownerDocument||document,J=oe&&oe.defaultView||window;if(J.getSelection){var W=J.getSelection(),Ee=C.textContent.length,Re=Math.min(U.start,Ee),pt=U.end===void 0?Re:Math.min(U.end,Ee);!W.extend&&Re>pt&&(b=pt,pt=Re,Re=b);var H=xg(C,Re),O=xg(C,pt);if(H&&O&&(W.rangeCount!==1||W.anchorNode!==H.node||W.anchorOffset!==H.offset||W.focusNode!==O.node||W.focusOffset!==O.offset)){var G=oe.createRange();G.setStart(H.node,H.offset),W.removeAllRanges(),Re>pt?(W.addRange(G),W.extend(O.node,O.offset)):(G.setEnd(O.node,O.offset),W.addRange(G))}}}}for(oe=[],W=C;W=W.parentNode;)W.nodeType===1&&oe.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<oe.length;C++){var ie=oe[C];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Wc=!!em,tm=em=null}finally{ot=y,fe.p=u,X.T=a}}i.current=r,Jt=2}}function H_(){if(Jt===2){Jt=0;var i=ur,r=la,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=X.T,X.T=null;var u=fe.p;fe.p=2;var y=ot;ot|=4;try{g_(i,r.alternate,r)}finally{ot=y,fe.p=u,X.T=a}}Jt=3}}function z_(){if(Jt===4||Jt===3){Jt=0,Ze();var i=ur,r=la,a=ms,u=R_;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Jt=5:(Jt=0,la=ur=null,G_(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(lr=null),Xi(a),r=r.stateNode,dt&&typeof dt.onCommitFiberRoot=="function")try{dt.onCommitFiberRoot(kt,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=X.T,y=fe.p,fe.p=2,X.T=null;try{for(var v=i.onRecoverableError,b=0;b<u.length;b++){var C=u[b];v(C.value,{componentStack:C.stack})}}finally{X.T=r,fe.p=y}}(ms&3)!==0&&Bc(),Hi(i),y=i.pendingLanes,(a&261930)!==0&&(y&42)!==0?i===Fh?ql++:(ql=0,Fh=i):ql=0,Bl(0)}}function G_(i,r){(i.pooledCacheLanes&=r)===0&&(r=i.pooledCache,r!=null&&(i.pooledCache=null,Tl(r)))}function Bc(){return F_(),H_(),z_(),j_()}function j_(){if(Jt!==5)return!1;var i=ur,r=qh;qh=0;var a=Xi(ms),u=X.T,y=fe.p;try{fe.p=32>a?32:a,X.T=null,a=Bh,Bh=null;var v=ur,b=ms;if(Jt=0,la=ur=null,ms=0,(ot&6)!==0)throw Error(s(331));var C=ot;if(ot|=4,C_(v.current),A_(v,v.current,b,a),ot=C,Bl(0,!1),dt&&typeof dt.onPostCommitFiberRoot=="function")try{dt.onPostCommitFiberRoot(kt,v)}catch{}return!0}finally{fe.p=y,X.T=u,G_(i,r)}}function Y_(i,r,a){r=Gn(a,r),r=vh(i.stateNode,r,2),i=nr(i,r,2),i!==null&&(Lr(i,2),Hi(i))}function ct(i,r,a){if(i.tag===3)Y_(i,i,a);else for(;r!==null;){if(r.tag===3){Y_(r,i,a);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(lr===null||!lr.has(u))){i=Gn(a,i),a=Jy(2),u=nr(r,a,2),u!==null&&(Ky(a,u,r,i),Lr(u,2),Hi(u));break}}r=r.return}}function Gh(i,r,a){var u=i.pingCache;if(u===null){u=i.pingCache=new Fx;var y=new Set;u.set(r,y)}else y=u.get(r),y===void 0&&(y=new Set,u.set(r,y));y.has(a)||(Uh=!0,y.add(a),i=Yx.bind(null,i,r,a),r.then(i,i))}function Yx(i,r,a){var u=i.pingCache;u!==null&&u.delete(r),i.pingedLanes|=i.suspendedLanes&a,i.warmLanes&=~a,yt===i&&(ze&a)===a&&(Rt===4||Rt===3&&(ze&62914560)===ze&&300>gt()-Vc?(ot&2)===0&&ua(i,0):Lh|=a,aa===ze&&(aa=0)),Hi(i)}function J_(i,r){r===0&&(r=Uu()),i=Xr(i,r),i!==null&&(Lr(i,r),Hi(i))}function Jx(i){var r=i.memoizedState,a=0;r!==null&&(a=r.retryLane),J_(i,a)}function Kx(i,r){var a=0;switch(i.tag){case 31:case 13:var u=i.stateNode,y=i.memoizedState;y!==null&&(a=y.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(r),J_(i,a)}function $x(i,r){return de(i,r)}var Fc=null,da=null,jh=!1,Hc=!1,Yh=!1,dr=0;function Hi(i){i!==da&&i.next===null&&(da===null?Fc=da=i:da=da.next=i),Hc=!0,jh||(jh=!0,Xx())}function Bl(i,r){if(!Yh&&Hc){Yh=!0;do for(var a=!1,u=Fc;u!==null;){if(i!==0){var y=u.pendingLanes;if(y===0)var v=0;else{var b=u.suspendedLanes,C=u.pingedLanes;v=(1<<31-De(42|i)+1)-1,v&=y&~(b&~C),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(a=!0,X_(u,v))}else v=ze,v=bi(u,u===yt?v:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(v&3)===0||ei(u,v)||(a=!0,X_(u,v));u=u.next}while(a);Yh=!1}}function Qx(){K_()}function K_(){Hc=jh=!1;var i=0;dr!==0&&aC()&&(i=dr);for(var r=gt(),a=null,u=Fc;u!==null;){var y=u.next,v=$_(u,r);v===0?(u.next=null,a===null?Fc=y:a.next=y,y===null&&(da=a)):(a=u,(i!==0||(v&3)!==0)&&(Hc=!0)),u=y}Jt!==0&&Jt!==5||Bl(i),dr!==0&&(dr=0)}function $_(i,r){for(var a=i.suspendedLanes,u=i.pingedLanes,y=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var b=31-De(v),C=1<<b,U=y[b];U===-1?((C&a)===0||(C&u)!==0)&&(y[b]=Ef(C,r)):U<=r&&(i.expiredLanes|=C),v&=~C}if(r=yt,a=ze,a=bi(i,i===r?a:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,a===0||i===r&&(ut===2||ut===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&ge(u),i.callbackNode=null,i.callbackPriority=0;if((a&3)===0||ei(i,a)){if(r=a&-a,r===i.callbackPriority)return r;switch(u!==null&&ge(u),Xi(a)){case 2:case 8:a=kr;break;case 32:a=Ei;break;case 268435456:a=wo;break;default:a=Ei}return u=Q_.bind(null,i),a=de(a,u),i.callbackPriority=r,i.callbackNode=a,r}return u!==null&&u!==null&&ge(u),i.callbackPriority=2,i.callbackNode=null,2}function Q_(i,r){if(Jt!==0&&Jt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var a=i.callbackNode;if(Bc()&&i.callbackNode!==a)return null;var u=ze;return u=bi(i,i===yt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(M_(i,u,r),$_(i,gt()),i.callbackNode!=null&&i.callbackNode===a?Q_.bind(null,i):null)}function X_(i,r){if(Bc())return null;M_(i,r,!0)}function Xx(){uC(function(){(ot&6)!==0?de(Bs,Qx):K_()})}function Jh(){if(dr===0){var i=Qo;i===0&&(i=Si,Si<<=1,(Si&261888)===0&&(Si=256)),dr=i}return dr}function W_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ko(""+i)}function Z_(i,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,i.id&&a.setAttribute("form",i.id),r.parentNode.insertBefore(a,r),i=new FormData(i),a.parentNode.removeChild(a),i}function Wx(i,r,a,u,y){if(r==="submit"&&a&&a.stateNode===y){var v=W_((y[Xt]||null).action),b=u.submitter;b&&(r=(r=b[Xt]||null)?W_(r.formAction):b.getAttribute("formAction"),r!==null&&(v=r,b=null));var C=new ki("action","action",null,u,y);i.push({event:C,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(dr!==0){var U=b?Z_(y,b):new FormData(y);hh(a,{pending:!0,data:U,method:y.method,action:v},null,U)}}else typeof v=="function"&&(C.preventDefault(),U=b?Z_(y,b):new FormData(y),hh(a,{pending:!0,data:U,method:y.method,action:v},v,U))},currentTarget:y}]})}}for(var Kh=0;Kh<Nf.length;Kh++){var $h=Nf[Kh],Zx=$h.toLowerCase(),eC=$h[0].toUpperCase()+$h.slice(1);li(Zx,"on"+eC)}li(Ng,"onAnimationEnd"),li(Mg,"onAnimationIteration"),li(Dg,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(gx,"onTransitionRun"),li(yx,"onTransitionStart"),li(_x,"onTransitionCancel"),li(Pg,"onTransitionEnd"),Mi("onMouseEnter",["mouseout","mouseover"]),Mi("onMouseLeave",["mouseout","mouseover"]),Mi("onPointerEnter",["pointerout","pointerover"]),Mi("onPointerLeave",["pointerout","pointerover"]),Ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ni("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fl));function ev(i,r){r=(r&4)!==0;for(var a=0;a<i.length;a++){var u=i[a],y=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var b=u.length-1;0<=b;b--){var C=u[b],U=C.instance,j=C.currentTarget;if(C=C.listener,U!==v&&y.isPropagationStopped())break e;v=C,y.currentTarget=j;try{v(y)}catch(ne){ic(ne)}y.currentTarget=null,v=U}else for(b=0;b<u.length;b++){if(C=u[b],U=C.instance,j=C.currentTarget,C=C.listener,U!==v&&y.isPropagationStopped())break e;v=C,y.currentTarget=j;try{v(y)}catch(ne){ic(ne)}y.currentTarget=null,v=U}}}}function He(i,r){var a=r[No];a===void 0&&(a=r[No]=new Set);var u=i+"__bubble";a.has(u)||(tv(r,i,2,!1),a.add(u))}function Qh(i,r,a){var u=0;r&&(u|=4),tv(a,i,u,r)}var zc="_reactListening"+Math.random().toString(36).slice(2);function Xh(i){if(!i[zc]){i[zc]=!0,Za.forEach(function(a){a!=="selectionchange"&&(tC.has(a)||Qh(a,!1,i),Qh(a,!0,i))});var r=i.nodeType===9?i:i.ownerDocument;r===null||r[zc]||(r[zc]=!0,Qh("selectionchange",!1,r))}}function tv(i,r,a,u){switch(Nv(r)){case 2:var y=RC;break;case 8:y=NC;break;default:y=fm}a=y.bind(null,r,a,i),y=void 0,!zr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(y=!0),u?y!==void 0?i.addEventListener(r,a,{capture:!0,passive:y}):i.addEventListener(r,a,!0):y!==void 0?i.addEventListener(r,a,{passive:y}):i.addEventListener(r,a,!1)}function Wh(i,r,a,u,y){var v=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var C=u.stateNode.containerInfo;if(C===y)break;if(b===4)for(b=u.return;b!==null;){var U=b.tag;if((U===3||U===4)&&b.stateNode.containerInfo===y)return;b=b.return}for(;C!==null;){if(b=wi(C),b===null)return;if(U=b.tag,U===5||U===6||U===26||U===27){u=v=b;continue e}C=C.parentNode}}u=u.return}Ys(function(){var j=v,ne=Bn(a),oe=[];e:{var J=Vg.get(i);if(J!==void 0){var W=ki,Ee=i;switch(i){case"keypress":if(jr(a)===0)break e;case"keydown":case"keyup":W=ec;break;case"focusin":Ee="focus",W=Jr;break;case"focusout":Ee="blur",W=Jr;break;case"beforeblur":case"afterblur":W=Jr;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=fl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=S;break;case Ng:case Mg:case Dg:W=Ju;break;case Pg:W=w;break;case"scroll":case"scrollend":W=dl;break;case"wheel":W=$;break;case"copy":case"cut":case"paste":W=Ku;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=es;break;case"toggle":case"beforetoggle":W=Le}var Re=(r&4)!==0,pt=!Re&&(i==="scroll"||i==="scrollend"),H=Re?J!==null?J+"Capture":null:J;Re=[];for(var O=j,G;O!==null;){var ie=O;if(G=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||G===null||H===null||(ie=si(O,H),ie!=null&&Re.push(Hl(O,ie,G))),pt)break;O=O.return}0<Re.length&&(J=new W(J,Ee,null,a,ne),oe.push({event:J,listeners:Re}))}}if((r&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",W=i==="mouseout"||i==="pointerout",J&&a!==ll&&(Ee=a.relatedTarget||a.fromElement)&&(wi(Ee)||Ee[Ci]))break e;if((W||J)&&(J=ne.window===ne?ne:(J=ne.ownerDocument)?J.defaultView||J.parentWindow:window,W?(Ee=a.relatedTarget||a.toElement,W=j,Ee=Ee?wi(Ee):null,Ee!==null&&(pt=l(Ee),Re=Ee.tag,Ee!==pt||Re!==5&&Re!==27&&Re!==6)&&(Ee=null)):(W=null,Ee=j),W!==Ee)){if(Re=fl,ie="onMouseLeave",H="onMouseEnter",O="mouse",(i==="pointerout"||i==="pointerover")&&(Re=es,ie="onPointerLeave",H="onPointerEnter",O="pointer"),pt=W==null?J:Rn(W),G=Ee==null?J:Rn(Ee),J=new Re(ie,O+"leave",W,a,ne),J.target=pt,J.relatedTarget=G,ie=null,wi(ne)===j&&(Re=new Re(H,O+"enter",Ee,a,ne),Re.target=G,Re.relatedTarget=pt,ie=Re),pt=ie,W&&Ee)t:{for(Re=nC,H=W,O=Ee,G=0,ie=H;ie;ie=Re(ie))G++;ie=0;for(var Ie=O;Ie;Ie=Re(Ie))ie++;for(;0<G-ie;)H=Re(H),G--;for(;0<ie-G;)O=Re(O),ie--;for(;G--;){if(H===O||O!==null&&H===O.alternate){Re=H;break t}H=Re(H),O=Re(O)}Re=null}else Re=null;W!==null&&nv(oe,J,W,Re,!1),Ee!==null&&pt!==null&&nv(oe,pt,Ee,Re,!0)}}e:{if(J=j?Rn(j):window,W=J.nodeName&&J.nodeName.toLowerCase(),W==="select"||W==="input"&&J.type==="file")var nt=vg;else if(yg(J))if(Tg)nt=hx;else{nt=dx;var xe=cx}else W=J.nodeName,!W||W.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?j&&Vo(j.elementType)&&(nt=vg):nt=fx;if(nt&&(nt=nt(i,j))){_g(oe,nt,a,ne);break e}xe&&xe(i,J,j),i==="focusout"&&j&&J.type==="number"&&j.memoizedProps.value!=null&&rl(J,"number",J.value)}switch(xe=j?Rn(j):window,i){case"focusin":(yg(xe)||xe.contentEditable==="true")&&(Ho=xe,If=j,yl=null);break;case"focusout":yl=If=Ho=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,wg(oe,a,ne);break;case"selectionchange":if(px)break;case"keydown":case"keyup":wg(oe,a,ne)}var Be;if(rt)e:{switch(i){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Fo?Kr(i,a)&&(Ge="onCompositionEnd"):i==="keydown"&&a.keyCode===229&&(Ge="onCompositionStart");Ge&&(Oi&&a.locale!=="ko"&&(Fo||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Fo&&(Be=cl()):(Vi=ne,ul="value"in Vi?Vi.value:Vi.textContent,Fo=!0)),xe=Gc(j,Ge),0<xe.length&&(Ge=new Li(Ge,i,null,a,ne),oe.push({event:Ge,listeners:xe}),Be?Ge.data=Be:(Be=Bo(a),Be!==null&&(Ge.data=Be)))),(Be=Hn?ox(i,a):ax(i,a))&&(Ge=Gc(j,"onBeforeInput"),0<Ge.length&&(xe=new Li("onBeforeInput","beforeinput",null,a,ne),oe.push({event:xe,listeners:Ge}),xe.data=Be)),Wx(oe,i,j,a,ne)}ev(oe,r)})}function Hl(i,r,a){return{instance:i,listener:r,currentTarget:a}}function Gc(i,r){for(var a=r+"Capture",u=[];i!==null;){var y=i,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=si(i,a),y!=null&&u.unshift(Hl(i,y,v)),y=si(i,r),y!=null&&u.push(Hl(i,y,v))),i.tag===3)return u;i=i.return}return[]}function nC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function nv(i,r,a,u,y){for(var v=r._reactName,b=[];a!==null&&a!==u;){var C=a,U=C.alternate,j=C.stateNode;if(C=C.tag,U!==null&&U===u)break;C!==5&&C!==26&&C!==27||j===null||(U=j,y?(j=si(a,v),j!=null&&b.unshift(Hl(a,j,U))):y||(j=si(a,v),j!=null&&b.push(Hl(a,j,U)))),a=a.return}b.length!==0&&i.push({event:r,listeners:b})}var iC=/\r\n?/g,sC=/\u0000|\uFFFD/g;function iv(i){return(typeof i=="string"?i:""+i).replace(iC,`
`).replace(sC,"")}function sv(i,r){return r=iv(r),iv(i)===r}function mt(i,r,a,u,y,v){switch(a){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||En(i,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&En(i,""+u);break;case"className":Nn(i,"class",u);break;case"tabIndex":Nn(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Nn(i,a,u);break;case"style":al(i,u,v);break;case"data":if(r!=="object"){Nn(i,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||a!=="href")){i.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(a);break}u=ko(""+u),i.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(a==="formAction"?(r!=="input"&&mt(i,r,"name",y.name,y,null),mt(i,r,"formEncType",y.formEncType,y,null),mt(i,r,"formMethod",y.formMethod,y,null),mt(i,r,"formTarget",y.formTarget,y,null)):(mt(i,r,"encType",y.encType,y,null),mt(i,r,"method",y.method,y,null),mt(i,r,"target",y.target,y,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(a);break}u=ko(""+u),i.setAttribute(a,u);break;case"onClick":u!=null&&(i.onclick=ii);break;case"onScroll":u!=null&&He("scroll",i);break;case"onScrollEnd":u!=null&&He("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(y.children!=null)throw Error(s(60));i.innerHTML=a}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}a=ko(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(a,""+u):i.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(a,""):i.removeAttribute(a);break;case"capture":case"download":u===!0?i.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(a,u):i.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(a,u):i.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(a):i.setAttribute(a,u);break;case"popover":He("beforetoggle",i),He("toggle",i),Do(i,"popover",u);break;case"xlinkActuate":qt(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":qt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":qt(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":qt(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":qt(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":qt(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":qt(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":qt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":qt(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Do(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Gu.get(a)||a,Do(i,a,u))}}function Zh(i,r,a,u,y,v){switch(a){case"style":al(i,u,v);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(y.children!=null)throw Error(s(60));i.innerHTML=a}}break;case"children":typeof u=="string"?En(i,u):(typeof u=="number"||typeof u=="bigint")&&En(i,""+u);break;case"onScroll":u!=null&&He("scroll",i);break;case"onScrollEnd":u!=null&&He("scrollend",i);break;case"onClick":u!=null&&(i.onclick=ii);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!el.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(y=a.endsWith("Capture"),r=a.slice(2,y?a.length-7:void 0),v=i[Xt]||null,v=v!=null?v[a]:null,typeof v=="function"&&i.removeEventListener(r,v,y),typeof u=="function")){typeof v!="function"&&v!==null&&(a in i?i[a]=null:i.hasAttribute(a)&&i.removeAttribute(a)),i.addEventListener(r,u,y);break e}a in i?i[a]=u:u===!0?i.setAttribute(a,""):Do(i,a,u)}}}function ln(i,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",i),He("load",i);var u=!1,y=!1,v;for(v in a)if(a.hasOwnProperty(v)){var b=a[v];if(b!=null)switch(v){case"src":u=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:mt(i,r,v,b,a,null)}}y&&mt(i,r,"srcSet",a.srcSet,a,null),u&&mt(i,r,"src",a.src,a,null);return;case"input":He("invalid",i);var C=v=b=y=null,U=null,j=null;for(u in a)if(a.hasOwnProperty(u)){var ne=a[u];if(ne!=null)switch(u){case"name":y=ne;break;case"type":b=ne;break;case"checked":U=ne;break;case"defaultChecked":j=ne;break;case"value":v=ne;break;case"defaultValue":C=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(137,r));break;default:mt(i,r,u,ne,a,null)}}Fu(i,v,C,U,j,b,y,!1);return;case"select":He("invalid",i),u=b=v=null;for(y in a)if(a.hasOwnProperty(y)&&(C=a[y],C!=null))switch(y){case"value":v=C;break;case"defaultValue":b=C;break;case"multiple":u=C;default:mt(i,r,y,C,a,null)}r=v,a=b,i.multiple=!!u,r!=null?Hs(i,!!u,r,!1):a!=null&&Hs(i,!!u,a,!0);return;case"textarea":He("invalid",i),v=y=u=null;for(b in a)if(a.hasOwnProperty(b)&&(C=a[b],C!=null))switch(b){case"value":u=C;break;case"defaultValue":y=C;break;case"children":v=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:mt(i,r,b,C,a,null)}zs(i,u,y,v);return;case"option":for(U in a)if(a.hasOwnProperty(U)&&(u=a[U],u!=null))switch(U){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:mt(i,r,U,u,a,null)}return;case"dialog":He("beforetoggle",i),He("toggle",i),He("cancel",i),He("close",i);break;case"iframe":case"object":He("load",i);break;case"video":case"audio":for(u=0;u<Fl.length;u++)He(Fl[u],i);break;case"image":He("error",i),He("load",i);break;case"details":He("toggle",i);break;case"embed":case"source":case"link":He("error",i),He("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(j in a)if(a.hasOwnProperty(j)&&(u=a[j],u!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:mt(i,r,j,u,a,null)}return;default:if(Vo(r)){for(ne in a)a.hasOwnProperty(ne)&&(u=a[ne],u!==void 0&&Zh(i,r,ne,u,a,void 0));return}}for(C in a)a.hasOwnProperty(C)&&(u=a[C],u!=null&&mt(i,r,C,u,a,null))}function rC(i,r,a,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,b=null,C=null,U=null,j=null,ne=null;for(W in a){var oe=a[W];if(a.hasOwnProperty(W)&&oe!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":U=oe;default:u.hasOwnProperty(W)||mt(i,r,W,null,u,oe)}}for(var J in u){var W=u[J];if(oe=a[J],u.hasOwnProperty(J)&&(W!=null||oe!=null))switch(J){case"type":v=W;break;case"name":y=W;break;case"checked":j=W;break;case"defaultChecked":ne=W;break;case"value":b=W;break;case"defaultValue":C=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(s(137,r));break;default:W!==oe&&mt(i,r,J,W,u,oe)}}Po(i,b,C,U,j,ne,v,y);return;case"select":W=b=C=J=null;for(v in a)if(U=a[v],a.hasOwnProperty(v)&&U!=null)switch(v){case"value":break;case"multiple":W=U;default:u.hasOwnProperty(v)||mt(i,r,v,null,u,U)}for(y in u)if(v=u[y],U=a[y],u.hasOwnProperty(y)&&(v!=null||U!=null))switch(y){case"value":J=v;break;case"defaultValue":C=v;break;case"multiple":b=v;default:v!==U&&mt(i,r,y,v,u,U)}r=C,a=b,u=W,J!=null?Hs(i,!!a,J,!1):!!u!=!!a&&(r!=null?Hs(i,!!a,r,!0):Hs(i,!!a,a?[]:"",!1));return;case"textarea":W=J=null;for(C in a)if(y=a[C],a.hasOwnProperty(C)&&y!=null&&!u.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:mt(i,r,C,null,u,y)}for(b in u)if(y=u[b],v=a[b],u.hasOwnProperty(b)&&(y!=null||v!=null))switch(b){case"value":J=y;break;case"defaultValue":W=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(s(91));break;default:y!==v&&mt(i,r,b,y,u,v)}Hu(i,J,W);return;case"option":for(var Ee in a)if(J=a[Ee],a.hasOwnProperty(Ee)&&J!=null&&!u.hasOwnProperty(Ee))switch(Ee){case"selected":i.selected=!1;break;default:mt(i,r,Ee,null,u,J)}for(U in u)if(J=u[U],W=a[U],u.hasOwnProperty(U)&&J!==W&&(J!=null||W!=null))switch(U){case"selected":i.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:mt(i,r,U,J,u,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in a)J=a[Re],a.hasOwnProperty(Re)&&J!=null&&!u.hasOwnProperty(Re)&&mt(i,r,Re,null,u,J);for(j in u)if(J=u[j],W=a[j],u.hasOwnProperty(j)&&J!==W&&(J!=null||W!=null))switch(j){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(s(137,r));break;default:mt(i,r,j,J,u,W)}return;default:if(Vo(r)){for(var pt in a)J=a[pt],a.hasOwnProperty(pt)&&J!==void 0&&!u.hasOwnProperty(pt)&&Zh(i,r,pt,void 0,u,J);for(ne in u)J=u[ne],W=a[ne],!u.hasOwnProperty(ne)||J===W||J===void 0&&W===void 0||Zh(i,r,ne,J,u,W);return}}for(var H in a)J=a[H],a.hasOwnProperty(H)&&J!=null&&!u.hasOwnProperty(H)&&mt(i,r,H,null,u,J);for(oe in u)J=u[oe],W=a[oe],!u.hasOwnProperty(oe)||J===W||J==null&&W==null||mt(i,r,oe,J,u,W)}function rv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function oC(){if(typeof performance.getEntriesByType=="function"){for(var i=0,r=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var y=a[u],v=y.transferSize,b=y.initiatorType,C=y.duration;if(v&&C&&rv(b)){for(b=0,C=y.responseEnd,u+=1;u<a.length;u++){var U=a[u],j=U.startTime;if(j>C)break;var ne=U.transferSize,oe=U.initiatorType;ne&&rv(oe)&&(U=U.responseEnd,b+=ne*(U<C?1:(C-j)/(U-j)))}if(--u,r+=8*(v+b)/(y.duration/1e3),i++,10<i)break}}if(0<i)return r/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var em=null,tm=null;function jc(i){return i.nodeType===9?i:i.ownerDocument}function ov(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function av(i,r){if(i===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&r==="foreignObject"?0:i}function nm(i,r){return i==="textarea"||i==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var im=null;function aC(){var i=window.event;return i&&i.type==="popstate"?i===im?!1:(im=i,!0):(im=null,!1)}var lv=typeof setTimeout=="function"?setTimeout:void 0,lC=typeof clearTimeout=="function"?clearTimeout:void 0,uv=typeof Promise=="function"?Promise:void 0,uC=typeof queueMicrotask=="function"?queueMicrotask:typeof uv<"u"?function(i){return uv.resolve(null).then(i).catch(cC)}:lv;function cC(i){setTimeout(function(){throw i})}function fr(i){return i==="head"}function cv(i,r){var a=r,u=0;do{var y=a.nextSibling;if(i.removeChild(a),y&&y.nodeType===8)if(a=y.data,a==="/$"||a==="/&"){if(u===0){i.removeChild(y),pa(r);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")zl(i.ownerDocument.documentElement);else if(a==="head"){a=i.ownerDocument.head,zl(a);for(var v=a.firstChild;v;){var b=v.nextSibling,C=v.nodeName;v[Ii]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&v.rel.toLowerCase()==="stylesheet"||a.removeChild(v),v=b}}else a==="body"&&zl(i.ownerDocument.body);a=y}while(a);pa(r)}function dv(i,r){var a=i;i=0;do{var u=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(i===0)break;i--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||i++;a=u}while(a)}function sm(i){var r=i.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":sm(a),Mo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}i.removeChild(a)}}function dC(i,r,a,u){for(;i.nodeType===1;){var y=a;if(i.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[Ii])switch(r){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(r==="input"&&i.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=$n(i.nextSibling),i===null)break}return null}function fC(i,r,a){if(r==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=$n(i.nextSibling),i===null))return null;return i}function fv(i,r){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!r||(i=$n(i.nextSibling),i===null))return null;return i}function rm(i){return i.data==="$?"||i.data==="$~"}function om(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function hC(i,r){var a=i.ownerDocument;if(i.data==="$~")i._reactRetry=r;else if(i.data!=="$?"||a.readyState!=="loading")r();else{var u=function(){r(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function $n(i){for(;i!=null;i=i.nextSibling){var r=i.nodeType;if(r===1||r===3)break;if(r===8){if(r=i.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return i}var am=null;function hv(i){i=i.nextSibling;for(var r=0;i;){if(i.nodeType===8){var a=i.data;if(a==="/$"||a==="/&"){if(r===0)return $n(i.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}i=i.nextSibling}return null}function mv(i){i=i.previousSibling;for(var r=0;i;){if(i.nodeType===8){var a=i.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return i;r--}else a!=="/$"&&a!=="/&"||r++}i=i.previousSibling}return null}function pv(i,r,a){switch(r=jc(a),i){case"html":if(i=r.documentElement,!i)throw Error(s(452));return i;case"head":if(i=r.head,!i)throw Error(s(453));return i;case"body":if(i=r.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function zl(i){for(var r=i.attributes;r.length;)i.removeAttributeNode(r[0]);Mo(i)}var Qn=new Map,gv=new Set;function Yc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ps=fe.d;fe.d={f:mC,r:pC,D:gC,C:yC,L:_C,m:vC,X:EC,S:TC,M:SC};function mC(){var i=ps.f(),r=Lc();return i||r}function pC(i){var r=qn(i);r!==null&&r.tag===5&&r.type==="form"?Py(r):ps.r(i)}var fa=typeof document>"u"?null:document;function yv(i,r,a){var u=fa;if(u&&typeof r=="string"&&r){var y=Tn(r);y='link[rel="'+i+'"][href="'+y+'"]',typeof a=="string"&&(y+='[crossorigin="'+a+'"]'),gv.has(y)||(gv.add(y),i={rel:i,crossOrigin:a,href:r},u.querySelector(y)===null&&(r=u.createElement("link"),ln(r,"link",i),Ot(r),u.head.appendChild(r)))}}function gC(i){ps.D(i),yv("dns-prefetch",i,null)}function yC(i,r){ps.C(i,r),yv("preconnect",i,r)}function _C(i,r,a){ps.L(i,r,a);var u=fa;if(u&&i&&r){var y='link[rel="preload"][as="'+Tn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(y+='[imagesrcset="'+Tn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(y+='[imagesizes="'+Tn(a.imageSizes)+'"]')):y+='[href="'+Tn(i)+'"]';var v=y;switch(r){case"style":v=ha(i);break;case"script":v=ma(i)}Qn.has(v)||(i=E({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:i,as:r},a),Qn.set(v,i),u.querySelector(y)!==null||r==="style"&&u.querySelector(Gl(v))||r==="script"&&u.querySelector(jl(v))||(r=u.createElement("link"),ln(r,"link",i),Ot(r),u.head.appendChild(r)))}}function vC(i,r){ps.m(i,r);var a=fa;if(a&&i){var u=r&&typeof r.as=="string"?r.as:"script",y='link[rel="modulepreload"][as="'+Tn(u)+'"][href="'+Tn(i)+'"]',v=y;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ma(i)}if(!Qn.has(v)&&(i=E({rel:"modulepreload",href:i},r),Qn.set(v,i),a.querySelector(y)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(jl(v)))return}u=a.createElement("link"),ln(u,"link",i),Ot(u),a.head.appendChild(u)}}}function TC(i,r,a){ps.S(i,r,a);var u=fa;if(u&&i){var y=Ri(u).hoistableStyles,v=ha(i);r=r||"default";var b=y.get(v);if(!b){var C={loading:0,preload:null};if(b=u.querySelector(Gl(v)))C.loading=5;else{i=E({rel:"stylesheet",href:i,"data-precedence":r},a),(a=Qn.get(v))&&lm(i,a);var U=b=u.createElement("link");Ot(U),ln(U,"link",i),U._p=new Promise(function(j,ne){U.onload=j,U.onerror=ne}),U.addEventListener("load",function(){C.loading|=1}),U.addEventListener("error",function(){C.loading|=2}),C.loading|=4,Jc(b,r,u)}b={type:"stylesheet",instance:b,count:1,state:C},y.set(v,b)}}}function EC(i,r){ps.X(i,r);var a=fa;if(a&&i){var u=Ri(a).hoistableScripts,y=ma(i),v=u.get(y);v||(v=a.querySelector(jl(y)),v||(i=E({src:i,async:!0},r),(r=Qn.get(y))&&um(i,r),v=a.createElement("script"),Ot(v),ln(v,"link",i),a.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(y,v))}}function SC(i,r){ps.M(i,r);var a=fa;if(a&&i){var u=Ri(a).hoistableScripts,y=ma(i),v=u.get(y);v||(v=a.querySelector(jl(y)),v||(i=E({src:i,async:!0,type:"module"},r),(r=Qn.get(y))&&um(i,r),v=a.createElement("script"),Ot(v),ln(v,"link",i),a.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},u.set(y,v))}}function _v(i,r,a,u){var y=(y=ce.current)?Yc(y):null;if(!y)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=ha(a.href),a=Ri(y).hoistableStyles,u=a.get(r),u||(u={type:"style",instance:null,count:0,state:null},a.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){i=ha(a.href);var v=Ri(y).hoistableStyles,b=v.get(i);if(b||(y=y.ownerDocument||y,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,b),(v=y.querySelector(Gl(i)))&&!v._p&&(b.instance=v,b.state.loading=5),Qn.has(i)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Qn.set(i,a),v||AC(y,i,a,b.state))),r&&u===null)throw Error(s(528,""));return b}if(r&&u!==null)throw Error(s(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ma(a),a=Ri(y).hoistableScripts,u=a.get(r),u||(u={type:"script",instance:null,count:0,state:null},a.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function ha(i){return'href="'+Tn(i)+'"'}function Gl(i){return'link[rel="stylesheet"]['+i+"]"}function vv(i){return E({},i,{"data-precedence":i.precedence,precedence:null})}function AC(i,r,a,u){i.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=i.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),ln(r,"link",a),Ot(r),i.head.appendChild(r))}function ma(i){return'[src="'+Tn(i)+'"]'}function jl(i){return"script[async]"+i}function Tv(i,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var u=i.querySelector('style[data-href~="'+Tn(a.href)+'"]');if(u)return r.instance=u,Ot(u),u;var y=E({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),Ot(u),ln(u,"style",y),Jc(u,a.precedence,i),r.instance=u;case"stylesheet":y=ha(a.href);var v=i.querySelector(Gl(y));if(v)return r.state.loading|=4,r.instance=v,Ot(v),v;u=vv(a),(y=Qn.get(y))&&lm(u,y),v=(i.ownerDocument||i).createElement("link"),Ot(v);var b=v;return b._p=new Promise(function(C,U){b.onload=C,b.onerror=U}),ln(v,"link",u),r.state.loading|=4,Jc(v,a.precedence,i),r.instance=v;case"script":return v=ma(a.src),(y=i.querySelector(jl(v)))?(r.instance=y,Ot(y),y):(u=a,(y=Qn.get(v))&&(u=E({},a),um(u,y)),i=i.ownerDocument||i,y=i.createElement("script"),Ot(y),ln(y,"link",u),i.head.appendChild(y),r.instance=y);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Jc(u,a.precedence,i));return r.instance}function Jc(i,r,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=u.length?u[u.length-1]:null,v=y,b=0;b<u.length;b++){var C=u[b];if(C.dataset.precedence===r)v=C;else if(v!==y)break}v?v.parentNode.insertBefore(i,v.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(i,r.firstChild))}function lm(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.title==null&&(i.title=r.title)}function um(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.integrity==null&&(i.integrity=r.integrity)}var Kc=null;function Ev(i,r,a){if(Kc===null){var u=new Map,y=Kc=new Map;y.set(a,u)}else y=Kc,u=y.get(a),u||(u=new Map,y.set(a,u));if(u.has(i))return u;for(u.set(i,null),a=a.getElementsByTagName(i),y=0;y<a.length;y++){var v=a[y];if(!(v[Ii]||v[Lt]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(r)||"";b=i+b;var C=u.get(b);C?C.push(v):u.set(b,[v])}}return u}function Sv(i,r,a){i=i.ownerDocument||i,i.head.insertBefore(a,r==="title"?i.querySelector("head > title"):null)}function bC(i,r,a){if(a===1||r.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return i=r.disabled,typeof r.precedence=="string"&&i==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Av(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function xC(i,r,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var y=ha(u.href),v=r.querySelector(Gl(y));if(v){r=v._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(i.count++,i=$c.bind(i),r.then(i,i)),a.state.loading|=4,a.instance=v,Ot(v);return}v=r.ownerDocument||r,u=vv(u),(y=Qn.get(y))&&lm(u,y),v=v.createElement("link"),Ot(v);var b=v;b._p=new Promise(function(C,U){b.onload=C,b.onerror=U}),ln(v,"link",u),a.instance=v}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(i.count++,a=$c.bind(i),r.addEventListener("load",a),r.addEventListener("error",a))}}var cm=0;function CC(i,r){return i.stylesheets&&i.count===0&&Xc(i,i.stylesheets),0<i.count||0<i.imgCount?function(a){var u=setTimeout(function(){if(i.stylesheets&&Xc(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4+r);0<i.imgBytes&&cm===0&&(cm=62500*oC());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Xc(i,i.stylesheets),i.unsuspend)){var v=i.unsuspend;i.unsuspend=null,v()}},(i.imgBytes>cm?50:800)+r);return i.unsuspend=a,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(y)}}:null}function $c(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xc(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Qc=null;function Xc(i,r){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Qc=new Map,r.forEach(IC,i),Qc=null,$c.call(i))}function IC(i,r){if(!(r.state.loading&4)){var a=Qc.get(i);if(a)var u=a.get(null);else{a=new Map,Qc.set(i,a);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var b=y[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(a.set(b.dataset.precedence,b),u=b)}u&&a.set(null,u)}y=r.instance,b=y.getAttribute("data-precedence"),v=a.get(b)||u,v===u&&a.set(null,y),a.set(b,y),this.count++,u=$c.bind(this),y.addEventListener("load",u),y.addEventListener("error",u),v?v.parentNode.insertBefore(y,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),r.state.loading|=4}}var Yl={$$typeof:K,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function wC(i,r,a,u,y,v,b,C,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xi(0),this.hiddenUpdates=xi(null),this.identifierPrefix=u,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function bv(i,r,a,u,y,v,b,C,U,j,ne,oe){return i=new wC(i,r,a,b,U,j,ne,oe,C),r=1,v===!0&&(r|=24),v=Dn(3,null,null,r),i.current=v,v.stateNode=i,r=zf(),r.refCount++,i.pooledCache=r,r.refCount++,v.memoizedState={element:u,isDehydrated:a,cache:r},Jf(v),i}function xv(i){return i?(i=jo,i):jo}function Cv(i,r,a,u,y,v){y=xv(y),u.context===null?u.context=y:u.pendingContext=y,u=tr(r),u.payload={element:a},v=v===void 0?null:v,v!==null&&(u.callback=v),a=nr(i,u,r),a!==null&&(Cn(a,i,r),bl(a,i,r))}function Iv(i,r){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var a=i.retryLane;i.retryLane=a!==0&&a<r?a:r}}function dm(i,r){Iv(i,r),(i=i.alternate)&&Iv(i,r)}function wv(i){if(i.tag===13||i.tag===31){var r=Xr(i,67108864);r!==null&&Cn(r,i,67108864),dm(i,67108864)}}function Rv(i){if(i.tag===13||i.tag===31){var r=Ln();r=qr(r);var a=Xr(i,r);a!==null&&Cn(a,i,r),dm(i,r)}}var Wc=!0;function RC(i,r,a,u){var y=X.T;X.T=null;var v=fe.p;try{fe.p=2,fm(i,r,a,u)}finally{fe.p=v,X.T=y}}function NC(i,r,a,u){var y=X.T;X.T=null;var v=fe.p;try{fe.p=8,fm(i,r,a,u)}finally{fe.p=v,X.T=y}}function fm(i,r,a,u){if(Wc){var y=hm(u);if(y===null)Wh(i,r,u,Zc,a),Mv(i,u);else if(DC(y,i,r,a,u))u.stopPropagation();else if(Mv(i,u),r&4&&-1<MC.indexOf(i)){for(;y!==null;){var v=qn(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=Ai(v.pendingLanes);if(b!==0){var C=v;for(C.pendingLanes|=2,C.entangledLanes|=2;b;){var U=1<<31-De(b);C.entanglements[1]|=U,b&=~U}Hi(v),(ot&6)===0&&(kc=gt()+500,Bl(0))}}break;case 31:case 13:C=Xr(v,2),C!==null&&Cn(C,v,2),Lc(),dm(v,2)}if(v=hm(u),v===null&&Wh(i,r,u,Zc,a),v===y)break;y=v}y!==null&&u.stopPropagation()}else Wh(i,r,u,null,a)}}function hm(i){return i=Bn(i),mm(i)}var Zc=null;function mm(i){if(Zc=null,i=wi(i),i!==null){var r=l(i);if(r===null)i=null;else{var a=r.tag;if(a===13){if(i=c(r),i!==null)return i;i=null}else if(a===31){if(i=d(r),i!==null)return i;i=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}return Zc=i,null}function Nv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ti()){case Bs:return 2;case kr:return 8;case Ei:case Qa:return 32;case wo:return 268435456;default:return 32}default:return 32}}var pm=!1,hr=null,mr=null,pr=null,Jl=new Map,Kl=new Map,gr=[],MC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mv(i,r){switch(i){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":mr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":Jl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kl.delete(r.pointerId)}}function $l(i,r,a,u,y,v){return i===null||i.nativeEvent!==v?(i={blockedOn:r,domEventName:a,eventSystemFlags:u,nativeEvent:v,targetContainers:[y]},r!==null&&(r=qn(r),r!==null&&wv(r)),i):(i.eventSystemFlags|=u,r=i.targetContainers,y!==null&&r.indexOf(y)===-1&&r.push(y),i)}function DC(i,r,a,u,y){switch(r){case"focusin":return hr=$l(hr,i,r,a,u,y),!0;case"dragenter":return mr=$l(mr,i,r,a,u,y),!0;case"mouseover":return pr=$l(pr,i,r,a,u,y),!0;case"pointerover":var v=y.pointerId;return Jl.set(v,$l(Jl.get(v)||null,i,r,a,u,y)),!0;case"gotpointercapture":return v=y.pointerId,Kl.set(v,$l(Kl.get(v)||null,i,r,a,u,y)),!0}return!1}function Dv(i){var r=wi(i.target);if(r!==null){var a=l(r);if(a!==null){if(r=a.tag,r===13){if(r=c(a),r!==null){i.blockedOn=r,ti(i.priority,function(){Rv(a)});return}}else if(r===31){if(r=d(a),r!==null){i.blockedOn=r,ti(i.priority,function(){Rv(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){i.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ed(i){if(i.blockedOn!==null)return!1;for(var r=i.targetContainers;0<r.length;){var a=hm(i.nativeEvent);if(a===null){a=i.nativeEvent;var u=new a.constructor(a.type,a);ll=u,a.target.dispatchEvent(u),ll=null}else return r=qn(a),r!==null&&wv(r),i.blockedOn=a,!1;r.shift()}return!0}function Pv(i,r,a){ed(i)&&a.delete(r)}function PC(){pm=!1,hr!==null&&ed(hr)&&(hr=null),mr!==null&&ed(mr)&&(mr=null),pr!==null&&ed(pr)&&(pr=null),Jl.forEach(Pv),Kl.forEach(Pv)}function td(i,r){i.blockedOn===r&&(i.blockedOn=null,pm||(pm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PC)))}var nd=null;function Vv(i){nd!==i&&(nd=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){nd===i&&(nd=null);for(var r=0;r<i.length;r+=3){var a=i[r],u=i[r+1],y=i[r+2];if(typeof u!="function"){if(mm(u||a)===null)continue;break}var v=qn(a);v!==null&&(i.splice(r,3),r-=3,hh(v,{pending:!0,data:y,method:a.method,action:u},u,y))}}))}function pa(i){function r(U){return td(U,i)}hr!==null&&td(hr,i),mr!==null&&td(mr,i),pr!==null&&td(pr,i),Jl.forEach(r),Kl.forEach(r);for(var a=0;a<gr.length;a++){var u=gr[a];u.blockedOn===i&&(u.blockedOn=null)}for(;0<gr.length&&(a=gr[0],a.blockedOn===null);)Dv(a),a.blockedOn===null&&gr.shift();if(a=(i.ownerDocument||i).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var y=a[u],v=a[u+1],b=y[Xt]||null;if(typeof v=="function")b||Vv(a);else if(b){var C=null;if(v&&v.hasAttribute("formAction")){if(y=v,b=v[Xt]||null)C=b.formAction;else if(mm(y)!==null)continue}else C=b.action;typeof C=="function"?a[u+1]=C:(a.splice(u,3),u-=3),Vv(a)}}}function kv(){function i(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(b){return y=b})},focusReset:"manual",scroll:"manual"})}function r(){y!==null&&(y(),y=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),y!==null&&(y(),y=null)}}}function gm(i){this._internalRoot=i}id.prototype.render=gm.prototype.render=function(i){var r=this._internalRoot;if(r===null)throw Error(s(409));var a=r.current,u=Ln();Cv(a,u,i,r,null,null)},id.prototype.unmount=gm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var r=i.containerInfo;Cv(i.current,2,null,i,null,null),Lc(),r[Ci]=null}};function id(i){this._internalRoot=i}id.prototype.unstable_scheduleHydration=function(i){if(i){var r=Lu();i={blockedOn:null,target:i,priority:r};for(var a=0;a<gr.length&&r!==0&&r<gr[a].priority;a++);gr.splice(a,0,i),a===0&&Dv(i)}};var Uv=e.version;if(Uv!=="19.2.0")throw Error(s(527,Uv,"19.2.0"));fe.findDOMNode=function(i){var r=i._reactInternals;if(r===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=h(r),i=i!==null?T(i):null,i=i===null?null:i.stateNode,i};var VC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{kt=sd.inject(VC),dt=sd}catch{}}return Xl.createRoot=function(i,r){if(!o(i))throw Error(s(299));var a=!1,u="",y=zy,v=Gy,b=jy;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError)),r=bv(i,1,!1,null,null,a,u,null,y,v,b,kv),i[Ci]=r.current,Xh(i),new gm(r)},Xl.hydrateRoot=function(i,r,a){if(!o(i))throw Error(s(299));var u=!1,y="",v=zy,b=Gy,C=jy,U=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(y=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(b=a.onCaughtError),a.onRecoverableError!==void 0&&(C=a.onRecoverableError),a.formState!==void 0&&(U=a.formState)),r=bv(i,1,!0,r,a??null,u,y,U,v,b,C,kv),r.context=xv(null),a=r.current,u=Ln(),u=qr(u),y=tr(u),y.callback=null,nr(a,y,u),a=u,r.current.lanes=a,Lr(r,a),Hi(r),i[Ci]=r.current,Xh(i),new id(r)},Xl.version="19.2.0",Xl}var Yv;function jC(){if(Yv)return vm.exports;Yv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vm.exports=GC(),vm.exports}var YC=jC();const JC=qE(YC),rd=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KC,$C;function QC(){return{geminiUrl:KC,vertexUrl:$C}}function XC(n,e,t,s){var o,l;if(!(n!=null&&n.baseUrl)){const c=QC();return e?(o=c.vertexUrl)!==null&&o!==void 0?o:t:(l=c.geminiUrl)!==null&&l!==void 0?l:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Eo{}function Se(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const l=e[o];return l!=null?String(l):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function g(n,e,t){for(let l=0;l<e.length-1;l++){const c=e[l];if(c.endsWith("[]")){const d=c.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[d])){const p=n[d];if(Array.isArray(t))for(let h=0;h<p.length;h++){const T=p[h];g(T,e.slice(l+1),t[h])}else for(const h of p)g(h,e.slice(l+1),t)}return}else if(c.endsWith("[0]")){const d=c.slice(0,-3);d in n||(n[d]=[{}]);const p=n[d];g(p[0],e.slice(l+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const s=e[e.length-1],o=n[s];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[s]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let s=0;s<e.length;s++){if(typeof n!="object"||n===null)return t;const o=e[s];if(o.endsWith("[]")){const l=o.slice(0,-2);if(l in n){const c=n[l];return Array.isArray(c)?c.map(d=>f(d,e.slice(s+1),t)):t}else return t}else n=n[o]}return n}catch(s){if(s instanceof TypeError)return t;throw s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bp(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WC(n){const e={},t=f(n,["operationName"]);t!=null&&g(e,["operationName"],t);const s=f(n,["resourceName"]);return s!=null&&g(e,["_url","resourceName"],s),e}function ZC(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["metadata"]);s!=null&&g(e,["metadata"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);l!=null&&g(e,["error"],l);const c=f(n,["response","generateVideoResponse"]);return c!=null&&g(e,["response"],tI(c)),e}function eI(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["metadata"]);s!=null&&g(e,["metadata"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);l!=null&&g(e,["error"],l);const c=f(n,["response"]);return c!=null&&g(e,["response"],nI(c)),e}function tI(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>iI(c))),g(e,["generatedVideos"],l)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const o=f(n,["raiMediaFilteredReasons"]);return o!=null&&g(e,["raiMediaFilteredReasons"],o),e}function nI(n){const e={},t=f(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>sI(c))),g(e,["generatedVideos"],l)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const o=f(n,["raiMediaFilteredReasons"]);return o!=null&&g(e,["raiMediaFilteredReasons"],o),e}function iI(n){const e={},t=f(n,["_self"]);return t!=null&&g(e,["video"],aI(t)),e}function sI(n){const e={},t=f(n,["_self"]);return t!=null&&g(e,["video"],lI(t)),e}function rI(n){const e={},t=f(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function oI(n){const e={},t=f(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function aI(n){const e={},t=f(n,["video","uri"]);t!=null&&g(e,["uri"],t);const s=f(n,["video","encodedVideo"]);s!=null&&g(e,["videoBytes"],bp(s));const o=f(n,["encoding"]);return o!=null&&g(e,["mimeType"],o),e}function lI(n){const e={},t=f(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&g(e,["videoBytes"],bp(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Jv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Jv||(Jv={}));var Kv;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Kv||(Kv={}));var vr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(vr||(vr={}));var $v;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})($v||($v={}));var Qv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Qv||(Qv={}));var Xv;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Xv||(Xv={}));var Wv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Wv||(Wv={}));var Zv;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Zv||(Zv={}));var e0;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(e0||(e0={}));var t0;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(t0||(t0={}));var n0;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(n0||(n0={}));var i0;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(i0||(i0={}));var s0;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(s0||(s0={}));var r0;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(r0||(r0={}));var o0;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(o0||(o0={}));var bd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(bd||(bd={}));var a0;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(a0||(a0={}));var Hm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Hm||(Hm={}));var l0;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(l0||(l0={}));var u0;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(u0||(u0={}));var c0;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(c0||(c0={}));var d0;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(d0||(d0={}));var f0;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(f0||(f0={}));var h0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(h0||(h0={}));var m0;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(m0||(m0={}));var p0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(p0||(p0={}));var g0;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(g0||(g0={}));var y0;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(y0||(y0={}));var _0;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(_0||(_0={}));var v0;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(v0||(v0={}));var T0;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(T0||(T0={}));var E0;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(E0||(E0={}));var S0;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(S0||(S0={}));var A0;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(A0||(A0={}));var b0;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(b0||(b0={}));var x0;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(x0||(x0={}));var C0;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(C0||(C0={}));var I0;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(I0||(I0={}));var w0;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(w0||(w0={}));var R0;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(R0||(R0={}));var N0;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(N0||(N0={}));var M0;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(M0||(M0={}));var D0;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(D0||(D0={}));var P0;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(P0||(P0={}));var V0;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(V0||(V0={}));var k0;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(k0||(k0={}));var U0;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(U0||(U0={}));var L0;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(L0||(L0={}));var Ta;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Ta||(Ta={}));class zm{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Wl{get text(){var e,t,s,o,l,c,d,p;if(((o=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",T=!1;const E=[];for(const A of(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[I,k]of Object.entries(A))I!=="text"&&I!=="thought"&&(k!==null||k!==void 0)&&E.push(I);if(typeof A.text=="string"){if(typeof A.thought=="boolean"&&A.thought)continue;T=!0,h+=A.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?h:void 0}get data(){var e,t,s,o,l,c,d,p;if(((o=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const T=[];for(const E of(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[A,I]of Object.entries(E))A!=="inlineData"&&(I!==null||I!==void 0)&&T.push(A);E.inlineData&&typeof E.inlineData.data=="string"&&(h+=atob(E.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,s,o,l,c,d,p;if(((o=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,s,o,l,c,d,p,h;if(((o=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(h=T==null?void 0:T[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,s,o,l,c,d,p,h;if(((o=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(h=T==null?void 0:T[0])===null||h===void 0?void 0:h.output}}class O0{}class q0{}class uI{}class cI{}class dI{}class fI{}class B0{}class F0{}class H0{}class hI{}class xd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const s=new xd;let o;const l=e;return t?o=eI(l):o=ZC(l),Object.assign(s,o),s}}class z0{}class G0{}class j0{}class mI{}class pI{}class gI{}class Y0{}class yI{get text(){var e,t,s;let o="",l=!1;const c=[];for(const d of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[p,h]of Object.entries(d))p!=="text"&&p!=="thought"&&h!==null&&c.push(p);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;l=!0,o+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var e,t,s;let o="";const l=[];for(const c of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[d,p]of Object.entries(c))d!=="inlineData"&&p!==null&&l.push(d);c.inlineData&&typeof c.inlineData.data=="string"&&(o+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class _I{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function st(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function BE(n,e){const t=st(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function FE(n){return Array.isArray(n)?n.map(e=>Cd(e)):[Cd(n)]}function Cd(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function HE(n){const e=Cd(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function zE(n){const e=Cd(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function J0(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function GE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>J0(e)):[J0(n)]}function Gm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function K0(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function $0(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function mn(n){if(n==null)throw new Error("ContentUnion is required");return Gm(n)?n:{role:"user",parts:GE(n)}}function xp(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=mn(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=mn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>mn(t)):[mn(e)]}function Zn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(K0(n)||$0(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[mn(n)]}const e=[],t=[],s=Gm(n[0]);for(const o of n){const l=Gm(o);if(l!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(o);else{if(K0(o)||$0(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return s||e.push({role:"user",parts:GE(t)}),e}function vI(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.values(vr).includes(t[0].toUpperCase())?t[0].toUpperCase():vr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.values(vr).includes(s.toUpperCase())?s.toUpperCase():vr.TYPE_UNSPECIFIED})}}function Aa(n){const e={},t=["items"],s=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&vI(n.type,e);for(const[c,d]of Object.entries(n))if(d!=null)if(c=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(vr).includes(d.toUpperCase())?d.toUpperCase():vr.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=Aa(d);else if(s.includes(c)){const p=[];for(const h of d){if(h.type=="null"){e.nullable=!0;continue}p.push(Aa(h))}e[c]=p}else if(o.includes(c)){const p={};for(const[h,T]of Object.entries(d))p[h]=Aa(T);e[c]=p}else{if(c==="additionalProperties")continue;e[c]=d}return e}function Cp(n){return Aa(n)}function Ip(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function wp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Ba(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Aa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Aa(e.response));return n}function Fa(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function TI(n,e,t,s=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Ps(n,e){if(typeof e!="string")throw new Error("name must be a string");return TI(n,e,"cachedContents")}function jE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Pr(n){return bp(n)}function EI(n){return n!=null&&typeof n=="object"&&"name"in n}function SI(n){return n!=null&&typeof n=="object"&&"video"in n}function AI(n){return n!=null&&typeof n=="object"&&"uri"in n}function YE(n){var e;let t;if(EI(n)&&(t=n.name),!(AI(n)&&(t=n.uri,t===void 0))&&!(SI(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function JE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function KE(n){for(const e of["models","tunedModels","publisherModels"])if(bI(n,e))return n[e];return[]}function bI(n,e){return n!==null&&typeof n=="object"&&e in n}function xI(n,e={}){const t=n,s={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(s.responseJsonSchema=t.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function CI(n,e={}){const t=[],s=new Set;for(const o of n){const l=o.name;if(s.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);s.add(l);const c=xI(o,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function $E(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const s=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function II(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function QE(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let l=!1;for(const c of o){if(typeof c!="object"||c===null)continue;const p=c.response;if(typeof p!="object"||p===null)continue;if(p.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Ha(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function XE(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wI(n){const e={},t=f(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const s=f(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>sw(c))),g(e,["inlinedResponses"],l)}const o=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["inlinedEmbedContentResponses"],l)}return e}function RI(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const s=f(n,["gcsDestination","outputUriPrefix"]);s!=null&&g(e,["gcsUri"],s);const o=f(n,["bigqueryDestination","outputUri"]);return o!=null&&g(e,["bigqueryUri"],o),e}function NI(n){const e={},t=f(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const s=f(n,["gcsUri"]);s!=null&&g(e,["gcsDestination","outputUriPrefix"],s);const o=f(n,["bigqueryUri"]);if(o!=null&&g(e,["bigqueryDestination","outputUri"],o),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Zl(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["metadata","displayName"]);s!=null&&g(e,["displayName"],s);const o=f(n,["metadata","state"]);o!=null&&g(e,["state"],XE(o));const l=f(n,["metadata","createTime"]);l!=null&&g(e,["createTime"],l);const c=f(n,["metadata","endTime"]);c!=null&&g(e,["endTime"],c);const d=f(n,["metadata","updateTime"]);d!=null&&g(e,["updateTime"],d);const p=f(n,["metadata","model"]);p!=null&&g(e,["model"],p);const h=f(n,["metadata","output"]);return h!=null&&g(e,["dest"],wI(QE(h))),e}function jm(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["displayName"]);s!=null&&g(e,["displayName"],s);const o=f(n,["state"]);o!=null&&g(e,["state"],XE(o));const l=f(n,["error"]);l!=null&&g(e,["error"],l);const c=f(n,["createTime"]);c!=null&&g(e,["createTime"],c);const d=f(n,["startTime"]);d!=null&&g(e,["startTime"],d);const p=f(n,["endTime"]);p!=null&&g(e,["endTime"],p);const h=f(n,["updateTime"]);h!=null&&g(e,["updateTime"],h);const T=f(n,["model"]);T!=null&&g(e,["model"],T);const E=f(n,["inputConfig"]);E!=null&&g(e,["src"],MI(E));const A=f(n,["outputConfig"]);return A!=null&&g(e,["dest"],RI(QE(A))),e}function MI(n){const e={},t=f(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const s=f(n,["gcsSource","uris"]);s!=null&&g(e,["gcsUri"],s);const o=f(n,["bigquerySource","inputUri"]);return o!=null&&g(e,["bigqueryUri"],o),e}function DI(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=f(e,["fileName"]);s!=null&&g(t,["fileName"],s);const o=f(e,["inlinedRequests"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>iw(n,c))),g(t,["requests","requests"],l)}return t}function PI(n){const e={},t=f(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const s=f(n,["gcsUri"]);s!=null&&g(e,["gcsSource","uris"],s);const o=f(n,["bigqueryUri"]);if(o!=null&&g(e,["bigquerySource","inputUri"],o),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function VI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["data"]);t!=null&&g(e,["data"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function kI(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function UI(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function LI(n){const e={},t=f(n,["content"]);t!=null&&g(e,["content"],t);const s=f(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],OI(s));const o=f(n,["tokenCount"]);o!=null&&g(e,["tokenCount"],o);const l=f(n,["finishReason"]);l!=null&&g(e,["finishReason"],l);const c=f(n,["urlContextMetadata"]);c!=null&&g(e,["urlContextMetadata"],c);const d=f(n,["avgLogprobs"]);d!=null&&g(e,["avgLogprobs"],d);const p=f(n,["groundingMetadata"]);p!=null&&g(e,["groundingMetadata"],p);const h=f(n,["index"]);h!=null&&g(e,["index"],h);const T=f(n,["logprobsResult"]);T!=null&&g(e,["logprobsResult"],T);const E=f(n,["safetyRatings"]);if(E!=null){let A=E;Array.isArray(A)&&(A=A.map(I=>I)),g(e,["safetyRatings"],A)}return e}function OI(n){const e={},t=f(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["citations"],s)}return e}function WE(n){const e={},t=f(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>dw(l))),g(e,["parts"],o)}const s=f(n,["role"]);return s!=null&&g(e,["role"],s),e}function qI(n,e){const t={},s=f(n,["displayName"]);if(e!==void 0&&s!=null&&g(e,["batch","displayName"],s),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function BI(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const o=f(n,["dest"]);return e!==void 0&&o!=null&&g(e,["outputConfig"],NI(II(o))),t}function Q0(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["src"]);o!=null&&g(t,["batch","inputConfig"],DI(n,$E(n,o)));const l=f(e,["config"]);return l!=null&&qI(l,t),t}function FI(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["model"],st(n,s));const o=f(e,["src"]);o!=null&&g(t,["inputConfig"],PI($E(n,o)));const l=f(e,["config"]);return l!=null&&BI(l,t),t}function HI(n,e){const t={},s=f(n,["displayName"]);return e!==void 0&&s!=null&&g(e,["batch","displayName"],s),t}function Am(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["src"]);o!=null&&g(t,["batch","inputConfig"],$I(n,o));const l=f(e,["config"]);return l!=null&&HI(l,t),t}function zI(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function GI(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function jI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);return l!=null&&g(e,["error"],l),e}function YI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);return l!=null&&g(e,["error"],l),e}function JI(n,e){const t={},s=f(e,["contents"]);if(s!=null){let l=xp(n,s);Array.isArray(l)&&(l=l.map(c=>c)),g(t,["requests[]","request","content"],l)}const o=f(e,["config"]);return o!=null&&g(t,["_self"],KI(o,t)),t}function KI(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&g(e,["requests[]","taskType"],s);const o=f(n,["title"]);e!==void 0&&o!=null&&g(e,["requests[]","title"],o);const l=f(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&g(e,["requests[]","outputDimensionality"],l),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $I(n,e){const t={},s=f(e,["fileName"]);s!=null&&g(t,["file_name"],s);const o=f(e,["inlinedRequests"]);return o!=null&&g(t,["requests"],JI(n,o)),t}function QI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function XI(n,e,t){const s={},o=f(e,["systemInstruction"]);t!==void 0&&o!=null&&g(t,["systemInstruction"],WE(mn(o)));const l=f(e,["temperature"]);l!=null&&g(s,["temperature"],l);const c=f(e,["topP"]);c!=null&&g(s,["topP"],c);const d=f(e,["topK"]);d!=null&&g(s,["topK"],d);const p=f(e,["candidateCount"]);p!=null&&g(s,["candidateCount"],p);const h=f(e,["maxOutputTokens"]);h!=null&&g(s,["maxOutputTokens"],h);const T=f(e,["stopSequences"]);T!=null&&g(s,["stopSequences"],T);const E=f(e,["responseLogprobs"]);E!=null&&g(s,["responseLogprobs"],E);const A=f(e,["logprobs"]);A!=null&&g(s,["logprobs"],A);const I=f(e,["presencePenalty"]);I!=null&&g(s,["presencePenalty"],I);const k=f(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const B=f(e,["seed"]);B!=null&&g(s,["seed"],B);const F=f(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Z=f(e,["responseSchema"]);Z!=null&&g(s,["responseSchema"],Cp(Z));const te=f(e,["responseJsonSchema"]);if(te!=null&&g(s,["responseJsonSchema"],te),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const K=f(e,["safetySettings"]);if(t!==void 0&&K!=null){let V=K;Array.isArray(V)&&(V=V.map(P=>fw(P))),g(t,["safetySettings"],V)}const Y=f(e,["tools"]);if(t!==void 0&&Y!=null){let V=Fa(Y);Array.isArray(V)&&(V=V.map(P=>hw(Ba(P)))),g(t,["tools"],V)}const ae=f(e,["toolConfig"]);if(t!==void 0&&ae!=null&&g(t,["toolConfig"],ae),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=f(e,["cachedContent"]);t!==void 0&&ee!=null&&g(t,["cachedContent"],Ps(n,ee));const M=f(e,["responseModalities"]);M!=null&&g(s,["responseModalities"],M);const R=f(e,["mediaResolution"]);R!=null&&g(s,["mediaResolution"],R);const N=f(e,["speechConfig"]);if(N!=null&&g(s,["speechConfig"],Ip(N)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=f(e,["thinkingConfig"]);L!=null&&g(s,["thinkingConfig"],L);const D=f(e,["imageConfig"]);return D!=null&&g(s,["imageConfig"],D),s}function WI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(h=>LI(h))),g(e,["candidates"],p)}const o=f(n,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);const l=f(n,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const c=f(n,["responseId"]);c!=null&&g(e,["responseId"],c);const d=f(n,["usageMetadata"]);return d!=null&&g(e,["usageMetadata"],d),e}function ZI(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function ew(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ha(n,s)),t}function tw(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function nw(n){const e={},t=f(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],t),f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iw(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["request","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let d=Zn(o);Array.isArray(d)&&(d=d.map(p=>WE(p))),g(t,["request","contents"],d)}const l=f(e,["metadata"]);l!=null&&g(t,["metadata"],l);const c=f(e,["config"]);return c!=null&&g(t,["request","generationConfig"],XI(n,c,f(t,["request"],{}))),t}function sw(n){const e={},t=f(n,["response"]);t!=null&&g(e,["response"],WI(t));const s=f(n,["error"]);return s!=null&&g(e,["error"],s),e}function rw(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);if(e!==void 0&&o!=null&&g(e,["_query","pageToken"],o),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function ow(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=f(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),t}function aw(n){const e={},t=f(n,["config"]);return t!=null&&rw(t,e),e}function lw(n){const e={},t=f(n,["config"]);return t!=null&&ow(t,e),e}function uw(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["operations"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>Zl(c))),g(e,["batchJobs"],l)}return e}function cw(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["batchPredictionJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>jm(c))),g(e,["batchJobs"],l)}return e}function dw(n){const e={},t=f(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],t);const s=f(n,["thought"]);s!=null&&g(e,["thought"],s);const o=f(n,["inlineData"]);o!=null&&g(e,["inlineData"],VI(o));const l=f(n,["fileData"]);l!=null&&g(e,["fileData"],QI(l));const c=f(n,["thoughtSignature"]);c!=null&&g(e,["thoughtSignature"],c);const d=f(n,["functionCall"]);d!=null&&g(e,["functionCall"],d);const p=f(n,["codeExecutionResult"]);p!=null&&g(e,["codeExecutionResult"],p);const h=f(n,["executableCode"]);h!=null&&g(e,["executableCode"],h);const T=f(n,["functionResponse"]);T!=null&&g(e,["functionResponse"],T);const E=f(n,["text"]);return E!=null&&g(e,["text"],E),e}function fw(n){const e={};if(f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=f(n,["category"]);t!=null&&g(e,["category"],t);const s=f(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function hw(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["functionDeclarations"],h)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],nw(s));const o=f(n,["googleSearchRetrieval"]);if(o!=null&&g(e,["googleSearchRetrieval"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],tw(l));const c=f(n,["urlContext"]);c!=null&&g(e,["urlContext"],c);const d=f(n,["computerUse"]);d!=null&&g(e,["computerUse"],d);const p=f(n,["codeExecution"]);return p!=null&&g(e,["codeExecution"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var mo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(mo||(mo={}));class vu{constructor(e,t,s,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,o)}init(e,t,s){var o,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!s||Object.keys(s).length===0?c={config:{}}:typeof s=="object"?c=Object.assign({},s):c=s,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(o=c.config)===null||o===void 0?void 0:o.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mw extends Eo{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var s,o;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const d=this.createInlinedEmbedContentRequest(t),p=d.path,h=d.body,T=Am(this.apiClient,t)._query||{};return this.apiClient.request({path:p,queryParams:T,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(A=>A.json()).then(A=>Zl(A))},this.list=async(t={})=>new vu(mo.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=Q0(this.apiClient,e),s=t._url,o=Se("{model}:batchGenerateContent",s),d=t.batch.inputConfig.requests,p=d.requests,h=[];for(const T of p){const E=Object.assign({},T);if(E.systemInstruction){const A=E.systemInstruction;delete E.systemInstruction;const I=E.request;I.systemInstruction=A,E.request=I}h.push(E)}return d.requests=h,delete t.config,delete t._url,delete t._query,{path:o,body:t}}createInlinedEmbedContentRequest(e){const t=Am(this.apiClient,e),s=t._url,o=Se("{model}:asyncBatchEmbedContent",s),d=t.batch.inputConfig.requests,p=d.requests,h=[];delete d.config;for(const T of p){const E=Object.assign({},T),A=E.request;for(const I in E)I!=="request"&&(A[I]=E[I],delete E[I]);h.push(E)}return d.requests=h,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const s=t?Object.assign({},t):{},o=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${o}`),s.dest===void 0){const l=this.getGcsUri(e),c=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?s.dest=`${l.slice(0,-6)}/dest`:s.dest=`${l}_dest_${o}`;else if(c)s.dest=`${c}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=FI(this.apiClient,e);return d=Se("batchPredictionJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>jm(T))}else{const h=Q0(this.apiClient,e);return d=Se("{model}:batchGenerateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>Zl(T))}}async createEmbeddingsInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Am(this.apiClient,e);return l=Se("{model}:asyncBatchEmbedContent",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>Zl(p))}}async get(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=ew(this.apiClient,e);return d=Se("batchPredictionJobs/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>jm(T))}else{const h=ZI(this.apiClient,e);return d=Se("batches/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>Zl(T))}}async cancel(e){var t,s,o,l;let c="",d={};if(this.apiClient.isVertexAI()){const p=UI(this.apiClient,e);c=Se("batchPredictionJobs/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const p=kI(this.apiClient,e);c=Se("batches/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=lw(e);return d=Se("batchPredictionJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=cw(T),A=new Y0;return Object.assign(A,E),A})}else{const h=aw(e);return d=Se("batches",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=uw(T),A=new Y0;return Object.assign(A,E),A})}}async delete(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=GI(this.apiClient,e);return d=Se("batchPredictionJobs/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>YI(T))}else{const h=zI(this.apiClient,e);return d=Se("batches/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>jI(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pw(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["data"]);t!=null&&g(e,["data"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function X0(n){const e={},t=f(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Uw(l))),g(e,["parts"],o)}const s=f(n,["role"]);return s!=null&&g(e,["role"],s),e}function gw(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const o=f(n,["expireTime"]);e!==void 0&&o!=null&&g(e,["expireTime"],o);const l=f(n,["displayName"]);e!==void 0&&l!=null&&g(e,["displayName"],l);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let T=Zn(c);Array.isArray(T)&&(T=T.map(E=>X0(E))),g(e,["contents"],T)}const d=f(n,["systemInstruction"]);e!==void 0&&d!=null&&g(e,["systemInstruction"],X0(mn(d)));const p=f(n,["tools"]);if(e!==void 0&&p!=null){let T=p;Array.isArray(T)&&(T=T.map(E=>Lw(E))),g(e,["tools"],T)}const h=f(n,["toolConfig"]);if(e!==void 0&&h!=null&&g(e,["toolConfig"],h),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function yw(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const o=f(n,["expireTime"]);e!==void 0&&o!=null&&g(e,["expireTime"],o);const l=f(n,["displayName"]);e!==void 0&&l!=null&&g(e,["displayName"],l);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let E=Zn(c);Array.isArray(E)&&(E=E.map(A=>A)),g(e,["contents"],E)}const d=f(n,["systemInstruction"]);e!==void 0&&d!=null&&g(e,["systemInstruction"],mn(d));const p=f(n,["tools"]);if(e!==void 0&&p!=null){let E=p;Array.isArray(E)&&(E=E.map(A=>Ow(A))),g(e,["tools"],E)}const h=f(n,["toolConfig"]);e!==void 0&&h!=null&&g(e,["toolConfig"],h);const T=f(n,["kmsKeyName"]);return e!==void 0&&T!=null&&g(e,["encryption_spec","kmsKeyName"],T),t}function _w(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["model"],BE(n,s));const o=f(e,["config"]);return o!=null&&gw(o,t),t}function vw(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["model"],BE(n,s));const o=f(e,["config"]);return o!=null&&yw(o,t),t}function Tw(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ps(n,s)),t}function Ew(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ps(n,s)),t}function Sw(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Aw(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function bw(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function xw(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&g(e,["description"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["parameters"]);o!=null&&g(e,["parameters"],o);const l=f(n,["parametersJsonSchema"]);l!=null&&g(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&g(e,["response"],c);const d=f(n,["responseJsonSchema"]);return d!=null&&g(e,["responseJsonSchema"],d),e}function Cw(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ps(n,s)),t}function Iw(n,e){const t={},s=f(e,["name"]);return s!=null&&g(t,["_url","name"],Ps(n,s)),t}function ww(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function Rw(n){const e={},t=f(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],t),f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Nw(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);return e!==void 0&&o!=null&&g(e,["_query","pageToken"],o),t}function Mw(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);return e!==void 0&&o!=null&&g(e,["_query","pageToken"],o),t}function Dw(n){const e={},t=f(n,["config"]);return t!=null&&Nw(t,e),e}function Pw(n){const e={},t=f(n,["config"]);return t!=null&&Mw(t,e),e}function Vw(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["cachedContents"],l)}return e}function kw(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["cachedContents"],l)}return e}function Uw(n){const e={},t=f(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],t);const s=f(n,["thought"]);s!=null&&g(e,["thought"],s);const o=f(n,["inlineData"]);o!=null&&g(e,["inlineData"],pw(o));const l=f(n,["fileData"]);l!=null&&g(e,["fileData"],bw(l));const c=f(n,["thoughtSignature"]);c!=null&&g(e,["thoughtSignature"],c);const d=f(n,["functionCall"]);d!=null&&g(e,["functionCall"],d);const p=f(n,["codeExecutionResult"]);p!=null&&g(e,["codeExecutionResult"],p);const h=f(n,["executableCode"]);h!=null&&g(e,["executableCode"],h);const T=f(n,["functionResponse"]);T!=null&&g(e,["functionResponse"],T);const E=f(n,["text"]);return E!=null&&g(e,["text"],E),e}function Lw(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["functionDeclarations"],h)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],Rw(s));const o=f(n,["googleSearchRetrieval"]);if(o!=null&&g(e,["googleSearchRetrieval"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],ww(l));const c=f(n,["urlContext"]);c!=null&&g(e,["urlContext"],c);const d=f(n,["computerUse"]);d!=null&&g(e,["computerUse"],d);const p=f(n,["codeExecution"]);return p!=null&&g(e,["codeExecution"],p),e}function Ow(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(A=>xw(A))),g(e,["functionDeclarations"],E)}const s=f(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const o=f(n,["googleSearch"]);o!=null&&g(e,["googleSearch"],o);const l=f(n,["googleSearchRetrieval"]);l!=null&&g(e,["googleSearchRetrieval"],l);const c=f(n,["enterpriseWebSearch"]);c!=null&&g(e,["enterpriseWebSearch"],c);const d=f(n,["googleMaps"]);d!=null&&g(e,["googleMaps"],d);const p=f(n,["urlContext"]);p!=null&&g(e,["urlContext"],p);const h=f(n,["computerUse"]);h!=null&&g(e,["computerUse"],h);const T=f(n,["codeExecution"]);return T!=null&&g(e,["codeExecution"],T),e}function qw(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const o=f(n,["expireTime"]);return e!==void 0&&o!=null&&g(e,["expireTime"],o),t}function Bw(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const o=f(n,["expireTime"]);return e!==void 0&&o!=null&&g(e,["expireTime"],o),t}function Fw(n,e){const t={},s=f(e,["name"]);s!=null&&g(t,["_url","name"],Ps(n,s));const o=f(e,["config"]);return o!=null&&qw(o,t),t}function Hw(n,e){const t={},s=f(e,["name"]);s!=null&&g(t,["_url","name"],Ps(n,s));const o=f(e,["config"]);return o!=null&&Bw(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zw extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vu(mo.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=vw(this.apiClient,e);return d=Se("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>T)}else{const h=_w(this.apiClient,e);return d=Se("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>T)}}async get(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Iw(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>T)}else{const h=Cw(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>T)}}async delete(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Ew(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=Aw(T),A=new G0;return Object.assign(A,E),A})}else{const h=Tw(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=Sw(T),A=new G0;return Object.assign(A,E),A})}}async update(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Hw(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>T)}else{const h=Fw(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>T)}}async listInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Pw(e);return d=Se("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=kw(T),A=new j0;return Object.assign(A,E),A})}else{const h=Dw(e);return d=Se("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=Vw(T),A=new j0;return Object.assign(A,E),A})}}}function W0(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Et(n){return this instanceof Et?(this.v=n,this):new Et(n)}function ba(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),o[Symbol.asyncIterator]=function(){return this},o;function c(I){return function(k){return Promise.resolve(k).then(I,E)}}function d(I,k){s[I]&&(o[I]=function(B){return new Promise(function(F,Z){l.push([I,B,F,Z])>1||p(I,B)})},k&&(o[I]=k(o[I])))}function p(I,k){try{h(s[I](k))}catch(B){A(l[0][3],B)}}function h(I){I.value instanceof Et?Promise.resolve(I.value.v).then(T,E):A(l[0][2],I)}function T(I){p("next",I)}function E(I){p("throw",I)}function A(I,k){I(k),l.shift(),l.length&&p(l[0][0],l[0][1])}}function ru(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof W0=="function"?W0(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(l){t[l]=n[l]&&function(c){return new Promise(function(d,p){c=n[l](c),o(d,p,c.done,c.value)})}}function o(l,c,d,p){Promise.resolve(p).then(function(h){l({value:h,done:d})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gw(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ZE(t)}function ZE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function jw(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Z0(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const o=[];let l=!0;for(;s<t&&n[s].role==="model";)o.push(n[s]),l&&!ZE(n[s])&&(l=!1),s++;l?e.push(...o):e.pop()}return e}class Yw{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Jw(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Jw{constructor(e,t,s,o={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=o,this.history=l,this.sendPromise=Promise.resolve(),jw(l)}async sendMessage(e){var t;await this.sendPromise;const s=mn(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,c,d;const p=await o,h=(c=(l=p.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,T=p.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let A=[];T!=null&&(A=(d=T.slice(E))!==null&&d!==void 0?d:[]);const I=h?[h]:[];this.recordHistory(s,I,A)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const s=mn(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const l=await o;return this.processStreamResponse(l,s)}getHistory(e=!1){const t=e?Z0(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var s,o;return ba(this,arguments,function*(){var c,d,p,h;const T=[];try{for(var E=!0,A=ru(e),I;I=yield Et(A.next()),c=I.done,!c;E=!0){h=I.value,E=!1;const k=h;if(Gw(k)){const B=(o=(s=k.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content;B!==void 0&&T.push(B)}yield yield Et(k)}}catch(k){d={error:k}}finally{try{!E&&!c&&(p=A.return)&&(yield Et(p.call(A)))}finally{if(d)throw d.error}}this.recordHistory(t,T)})}recordHistory(e,t,s){let o=[];t.length>0&&t.every(l=>l.role!==void 0)?o=t:o.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...Z0(s)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Kd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kw(n){const e={},t=f(n,["file"]);return t!=null&&g(e,["file"],t),e}function $w(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Qw(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","file"],YE(t)),e}function Xw(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function Ww(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","file"],YE(t)),e}function Zw(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);return e!==void 0&&o!=null&&g(e,["_query","pageToken"],o),t}function eR(n){const e={},t=f(n,["config"]);return t!=null&&Zw(t,e),e}function tR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["files"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nR extends Eo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vu(mo.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=eR(e);return l=Se("files",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>{const h=tR(p),T=new mI;return Object.assign(T,h),T})}}async createInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Kw(e);return l=Se("upload/v1beta/files",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>{const h=$w(p),T=new pI;return Object.assign(T,h),T})}}async get(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Ww(e);return l=Se("files/{file}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>p)}}async delete(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Qw(e);return l=Se("files/{file}",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>{const h=Xw(p),T=new gI;return Object.assign(T,h),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function md(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["data"]);t!=null&&g(e,["data"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function iR(n){const e={},t=f(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>_R(l))),g(e,["parts"],o)}const s=f(n,["role"]);return s!=null&&g(e,["role"],s),e}function sR(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function rR(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&g(e,["description"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["parameters"]);o!=null&&g(e,["parameters"],o);const l=f(n,["parametersJsonSchema"]);l!=null&&g(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&g(e,["response"],c);const d=f(n,["responseJsonSchema"]);return d!=null&&g(e,["responseJsonSchema"],d),e}function oR(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const s=f(n,["audioTimestamp"]);s!=null&&g(e,["audioTimestamp"],s);const o=f(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);const l=f(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const c=f(n,["frequencyPenalty"]);c!=null&&g(e,["frequencyPenalty"],c);const d=f(n,["logprobs"]);d!=null&&g(e,["logprobs"],d);const p=f(n,["maxOutputTokens"]);p!=null&&g(e,["maxOutputTokens"],p);const h=f(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);const T=f(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const E=f(n,["responseJsonSchema"]);E!=null&&g(e,["responseJsonSchema"],E);const A=f(n,["responseLogprobs"]);A!=null&&g(e,["responseLogprobs"],A);const I=f(n,["responseMimeType"]);I!=null&&g(e,["responseMimeType"],I);const k=f(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const B=f(n,["responseSchema"]);B!=null&&g(e,["responseSchema"],B);const F=f(n,["routingConfig"]);F!=null&&g(e,["routingConfig"],F);const Z=f(n,["seed"]);Z!=null&&g(e,["seed"],Z);const te=f(n,["speechConfig"]);te!=null&&g(e,["speechConfig"],eS(te));const K=f(n,["stopSequences"]);K!=null&&g(e,["stopSequences"],K);const Y=f(n,["temperature"]);Y!=null&&g(e,["temperature"],Y);const ae=f(n,["thinkingConfig"]);ae!=null&&g(e,["thinkingConfig"],ae);const ee=f(n,["topK"]);ee!=null&&g(e,["topK"],ee);const M=f(n,["topP"]);return M!=null&&g(e,["topP"],M),e}function aR(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function lR(n){const e={},t=f(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],t),f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function uR(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const o=f(n,["responseModalities"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","responseModalities"],o);const l=f(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=f(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=f(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=f(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const T=f(n,["seed"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","seed"],T);const E=f(n,["speechConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","speechConfig"],wp(E));const A=f(n,["thinkingConfig"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","thinkingConfig"],A);const I=f(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],I);const k=f(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],iR(mn(k)));const B=f(n,["tools"]);if(e!==void 0&&B!=null){let ee=Fa(B);Array.isArray(ee)&&(ee=ee.map(M=>TR(Ba(M)))),g(e,["setup","tools"],ee)}const F=f(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],vR(F));const Z=f(n,["inputAudioTranscription"]);e!==void 0&&Z!=null&&g(e,["setup","inputAudioTranscription"],Z);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&g(e,["setup","outputAudioTranscription"],te);const K=f(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&g(e,["setup","realtimeInputConfig"],K);const Y=f(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);const ae=f(n,["proactivity"]);return e!==void 0&&ae!=null&&g(e,["setup","proactivity"],ae),t}function cR(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],oR(s));const o=f(n,["responseModalities"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","responseModalities"],o);const l=f(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=f(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=f(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=f(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const T=f(n,["seed"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","seed"],T);const E=f(n,["speechConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","speechConfig"],eS(wp(E)));const A=f(n,["thinkingConfig"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","thinkingConfig"],A);const I=f(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],I);const k=f(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],mn(k));const B=f(n,["tools"]);if(e!==void 0&&B!=null){let ee=Fa(B);Array.isArray(ee)&&(ee=ee.map(M=>ER(Ba(M)))),g(e,["setup","tools"],ee)}const F=f(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],F);const Z=f(n,["inputAudioTranscription"]);e!==void 0&&Z!=null&&g(e,["setup","inputAudioTranscription"],Z);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&g(e,["setup","outputAudioTranscription"],te);const K=f(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&g(e,["setup","realtimeInputConfig"],K);const Y=f(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);const ae=f(n,["proactivity"]);return e!==void 0&&ae!=null&&g(e,["setup","proactivity"],ae),t}function dR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["setup","model"],st(n,s));const o=f(e,["config"]);return o!=null&&g(t,["config"],uR(o,t)),t}function fR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["setup","model"],st(n,s));const o=f(e,["config"]);return o!=null&&g(t,["config"],cR(o,t)),t}function hR(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function mR(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["weightedPrompts"],s)}return e}function pR(n){const e={},t=f(n,["media"]);if(t!=null){let h=FE(t);Array.isArray(h)&&(h=h.map(T=>md(T))),g(e,["mediaChunks"],h)}const s=f(n,["audio"]);s!=null&&g(e,["audio"],md(zE(s)));const o=f(n,["audioStreamEnd"]);o!=null&&g(e,["audioStreamEnd"],o);const l=f(n,["video"]);l!=null&&g(e,["video"],md(HE(l)));const c=f(n,["text"]);c!=null&&g(e,["text"],c);const d=f(n,["activityStart"]);d!=null&&g(e,["activityStart"],d);const p=f(n,["activityEnd"]);return p!=null&&g(e,["activityEnd"],p),e}function gR(n){const e={},t=f(n,["media"]);if(t!=null){let h=FE(t);Array.isArray(h)&&(h=h.map(T=>T)),g(e,["mediaChunks"],h)}const s=f(n,["audio"]);s!=null&&g(e,["audio"],zE(s));const o=f(n,["audioStreamEnd"]);o!=null&&g(e,["audioStreamEnd"],o);const l=f(n,["video"]);l!=null&&g(e,["video"],HE(l));const c=f(n,["text"]);c!=null&&g(e,["text"],c);const d=f(n,["activityStart"]);d!=null&&g(e,["activityStart"],d);const p=f(n,["activityEnd"]);return p!=null&&g(e,["activityEnd"],p),e}function yR(n){const e={},t=f(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const s=f(n,["serverContent"]);s!=null&&g(e,["serverContent"],s);const o=f(n,["toolCall"]);o!=null&&g(e,["toolCall"],o);const l=f(n,["toolCallCancellation"]);l!=null&&g(e,["toolCallCancellation"],l);const c=f(n,["usageMetadata"]);c!=null&&g(e,["usageMetadata"],SR(c));const d=f(n,["goAway"]);d!=null&&g(e,["goAway"],d);const p=f(n,["sessionResumptionUpdate"]);return p!=null&&g(e,["sessionResumptionUpdate"],p),e}function _R(n){const e={},t=f(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],t);const s=f(n,["thought"]);s!=null&&g(e,["thought"],s);const o=f(n,["inlineData"]);o!=null&&g(e,["inlineData"],md(o));const l=f(n,["fileData"]);l!=null&&g(e,["fileData"],sR(l));const c=f(n,["thoughtSignature"]);c!=null&&g(e,["thoughtSignature"],c);const d=f(n,["functionCall"]);d!=null&&g(e,["functionCall"],d);const p=f(n,["codeExecutionResult"]);p!=null&&g(e,["codeExecutionResult"],p);const h=f(n,["executableCode"]);h!=null&&g(e,["executableCode"],h);const T=f(n,["functionResponse"]);T!=null&&g(e,["functionResponse"],T);const E=f(n,["text"]);return E!=null&&g(e,["text"],E),e}function vR(n){const e={},t=f(n,["handle"]);if(t!=null&&g(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function eS(n){const e={},t=f(n,["voiceConfig"]);if(t!=null&&g(e,["voiceConfig"],t),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=f(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function TR(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["functionDeclarations"],h)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],lR(s));const o=f(n,["googleSearchRetrieval"]);if(o!=null&&g(e,["googleSearchRetrieval"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],aR(l));const c=f(n,["urlContext"]);c!=null&&g(e,["urlContext"],c);const d=f(n,["computerUse"]);d!=null&&g(e,["computerUse"],d);const p=f(n,["codeExecution"]);return p!=null&&g(e,["codeExecution"],p),e}function ER(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(A=>rR(A))),g(e,["functionDeclarations"],E)}const s=f(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const o=f(n,["googleSearch"]);o!=null&&g(e,["googleSearch"],o);const l=f(n,["googleSearchRetrieval"]);l!=null&&g(e,["googleSearchRetrieval"],l);const c=f(n,["enterpriseWebSearch"]);c!=null&&g(e,["enterpriseWebSearch"],c);const d=f(n,["googleMaps"]);d!=null&&g(e,["googleMaps"],d);const p=f(n,["urlContext"]);p!=null&&g(e,["urlContext"],p);const h=f(n,["computerUse"]);h!=null&&g(e,["computerUse"],h);const T=f(n,["codeExecution"]);return T!=null&&g(e,["codeExecution"],T),e}function SR(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const s=f(n,["cachedContentTokenCount"]);s!=null&&g(e,["cachedContentTokenCount"],s);const o=f(n,["candidatesTokenCount"]);o!=null&&g(e,["responseTokenCount"],o);const l=f(n,["toolUsePromptTokenCount"]);l!=null&&g(e,["toolUsePromptTokenCount"],l);const c=f(n,["thoughtsTokenCount"]);c!=null&&g(e,["thoughtsTokenCount"],c);const d=f(n,["totalTokenCount"]);d!=null&&g(e,["totalTokenCount"],d);const p=f(n,["promptTokensDetails"]);if(p!=null){let I=p;Array.isArray(I)&&(I=I.map(k=>k)),g(e,["promptTokensDetails"],I)}const h=f(n,["cacheTokensDetails"]);if(h!=null){let I=h;Array.isArray(I)&&(I=I.map(k=>k)),g(e,["cacheTokensDetails"],I)}const T=f(n,["candidatesTokensDetails"]);if(T!=null){let I=T;Array.isArray(I)&&(I=I.map(k=>k)),g(e,["responseTokensDetails"],I)}const E=f(n,["toolUsePromptTokensDetails"]);if(E!=null){let I=E;Array.isArray(I)&&(I=I.map(k=>k)),g(e,["toolUsePromptTokensDetails"],I)}const A=f(n,["trafficType"]);return A!=null&&g(e,["trafficType"],A),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AR(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["data"]);t!=null&&g(e,["data"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function bR(n){const e={},t=f(n,["content"]);t!=null&&g(e,["content"],t);const s=f(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],xR(s));const o=f(n,["tokenCount"]);o!=null&&g(e,["tokenCount"],o);const l=f(n,["finishReason"]);l!=null&&g(e,["finishReason"],l);const c=f(n,["urlContextMetadata"]);c!=null&&g(e,["urlContextMetadata"],c);const d=f(n,["avgLogprobs"]);d!=null&&g(e,["avgLogprobs"],d);const p=f(n,["groundingMetadata"]);p!=null&&g(e,["groundingMetadata"],p);const h=f(n,["index"]);h!=null&&g(e,["index"],h);const T=f(n,["logprobsResult"]);T!=null&&g(e,["logprobsResult"],T);const E=f(n,["safetyRatings"]);if(E!=null){let A=E;Array.isArray(A)&&(A=A.map(I=>I)),g(e,["safetyRatings"],A)}return e}function xR(n){const e={},t=f(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["citations"],s)}return e}function CR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let l=Zn(o);Array.isArray(l)&&(l=l.map(c=>c)),g(t,["contents"],l)}return t}function IR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["tokensInfo"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["tokensInfo"],o)}return e}function wR(n){const e={},t=f(n,["values"]);t!=null&&g(e,["values"],t);const s=f(n,["statistics"]);return s!=null&&g(e,["statistics"],RR(s)),e}function RR(n){const e={},t=f(n,["truncated"]);t!=null&&g(e,["truncated"],t);const s=f(n,["token_count"]);return s!=null&&g(e,["tokenCount"],s),e}function $d(n){const e={},t=f(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>VN(l))),g(e,["parts"],o)}const s=f(n,["role"]);return s!=null&&g(e,["role"],s),e}function NR(n){const e={},t=f(n,["controlType"]);t!=null&&g(e,["controlType"],t);const s=f(n,["enableControlImageComputation"]);return s!=null&&g(e,["computeControl"],s),e}function MR(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function DR(n,e){const t={},s=f(n,["systemInstruction"]);e!==void 0&&s!=null&&g(e,["systemInstruction"],mn(s));const o=f(n,["tools"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>rS(d))),g(e,["tools"],c)}const l=f(n,["generationConfig"]);return e!==void 0&&l!=null&&g(e,["generationConfig"],EN(l)),t}function PR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let c=Zn(o);Array.isArray(c)&&(c=c.map(d=>$d(d))),g(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&MR(l),t}function VR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let c=Zn(o);Array.isArray(c)&&(c=c.map(d=>d)),g(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&DR(l,t),t}function kR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["totalTokens"]);s!=null&&g(e,["totalTokens"],s);const o=f(n,["cachedContentTokenCount"]);return o!=null&&g(e,["cachedContentTokenCount"],o),e}function UR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["totalTokens"]);return s!=null&&g(e,["totalTokens"],s),e}function LR(n,e){const t={},s=f(e,["model"]);return s!=null&&g(t,["_url","name"],st(n,s)),t}function OR(n,e){const t={},s=f(e,["model"]);return s!=null&&g(t,["_url","name"],st(n,s)),t}function qR(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function BR(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function FR(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const o=f(n,["negativePrompt"]);e!==void 0&&o!=null&&g(e,["parameters","negativePrompt"],o);const l=f(n,["numberOfImages"]);e!==void 0&&l!=null&&g(e,["parameters","sampleCount"],l);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);const d=f(n,["guidanceScale"]);e!==void 0&&d!=null&&g(e,["parameters","guidanceScale"],d);const p=f(n,["seed"]);e!==void 0&&p!=null&&g(e,["parameters","seed"],p);const h=f(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&g(e,["parameters","safetySetting"],h);const T=f(n,["personGeneration"]);e!==void 0&&T!=null&&g(e,["parameters","personGeneration"],T);const E=f(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&g(e,["parameters","includeSafetyAttributes"],E);const A=f(n,["includeRaiReason"]);e!==void 0&&A!=null&&g(e,["parameters","includeRaiReason"],A);const I=f(n,["language"]);e!==void 0&&I!=null&&g(e,["parameters","language"],I);const k=f(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const B=f(n,["outputCompressionQuality"]);e!==void 0&&B!=null&&g(e,["parameters","outputOptions","compressionQuality"],B);const F=f(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const Z=f(n,["labels"]);e!==void 0&&Z!=null&&g(e,["labels"],Z);const te=f(n,["editMode"]);e!==void 0&&te!=null&&g(e,["parameters","editMode"],te);const K=f(n,["baseSteps"]);return e!==void 0&&K!=null&&g(e,["parameters","editConfig","baseSteps"],K),t}function HR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["prompt"]);o!=null&&g(t,["instances[0]","prompt"],o);const l=f(e,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(p=>BN(p))),g(t,["instances[0]","referenceImages"],d)}const c=f(e,["config"]);return c!=null&&FR(c,t),t}function zR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Qd(l))),g(e,["generatedImages"],o)}return e}function GR(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&g(e,["requests[]","taskType"],s);const o=f(n,["title"]);e!==void 0&&o!=null&&g(e,["requests[]","title"],o);const l=f(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&g(e,["requests[]","outputDimensionality"],l),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function jR(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&g(e,["instances[]","task_type"],s);const o=f(n,["title"]);e!==void 0&&o!=null&&g(e,["instances[]","title"],o);const l=f(n,["outputDimensionality"]);e!==void 0&&l!=null&&g(e,["parameters","outputDimensionality"],l);const c=f(n,["mimeType"]);e!==void 0&&c!=null&&g(e,["instances[]","mimeType"],c);const d=f(n,["autoTruncate"]);return e!==void 0&&d!=null&&g(e,["parameters","autoTruncate"],d),t}function YR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let d=xp(n,o);Array.isArray(d)&&(d=d.map(p=>p)),g(t,["requests[]","content"],d)}const l=f(e,["config"]);l!=null&&GR(l,t);const c=f(e,["model"]);return c!==void 0&&g(t,["requests[]","model"],st(n,c)),t}function JR(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let c=xp(n,o);Array.isArray(c)&&(c=c.map(d=>d)),g(t,["instances[]","content"],c)}const l=f(e,["config"]);return l!=null&&jR(l,t),t}function KR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["embeddings"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["embeddings"],l)}const o=f(n,["metadata"]);return o!=null&&g(e,["metadata"],o),e}function $R(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["predictions[]","embeddings"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>wR(c))),g(e,["embeddings"],l)}const o=f(n,["metadata"]);return o!=null&&g(e,["metadata"],o),e}function QR(n){const e={},t=f(n,["endpoint"]);t!=null&&g(e,["name"],t);const s=f(n,["deployedModelId"]);return s!=null&&g(e,["deployedModelId"],s),e}function XR(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function WR(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&g(e,["description"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["parameters"]);o!=null&&g(e,["parameters"],o);const l=f(n,["parametersJsonSchema"]);l!=null&&g(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&g(e,["response"],c);const d=f(n,["responseJsonSchema"]);return d!=null&&g(e,["responseJsonSchema"],d),e}function ZR(n,e,t){const s={},o=f(e,["systemInstruction"]);t!==void 0&&o!=null&&g(t,["systemInstruction"],$d(mn(o)));const l=f(e,["temperature"]);l!=null&&g(s,["temperature"],l);const c=f(e,["topP"]);c!=null&&g(s,["topP"],c);const d=f(e,["topK"]);d!=null&&g(s,["topK"],d);const p=f(e,["candidateCount"]);p!=null&&g(s,["candidateCount"],p);const h=f(e,["maxOutputTokens"]);h!=null&&g(s,["maxOutputTokens"],h);const T=f(e,["stopSequences"]);T!=null&&g(s,["stopSequences"],T);const E=f(e,["responseLogprobs"]);E!=null&&g(s,["responseLogprobs"],E);const A=f(e,["logprobs"]);A!=null&&g(s,["logprobs"],A);const I=f(e,["presencePenalty"]);I!=null&&g(s,["presencePenalty"],I);const k=f(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const B=f(e,["seed"]);B!=null&&g(s,["seed"],B);const F=f(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Z=f(e,["responseSchema"]);Z!=null&&g(s,["responseSchema"],Cp(Z));const te=f(e,["responseJsonSchema"]);if(te!=null&&g(s,["responseJsonSchema"],te),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const K=f(e,["safetySettings"]);if(t!==void 0&&K!=null){let V=K;Array.isArray(V)&&(V=V.map(P=>FN(P))),g(t,["safetySettings"],V)}const Y=f(e,["tools"]);if(t!==void 0&&Y!=null){let V=Fa(Y);Array.isArray(V)&&(V=V.map(P=>JN(Ba(P)))),g(t,["tools"],V)}const ae=f(e,["toolConfig"]);if(t!==void 0&&ae!=null&&g(t,["toolConfig"],ae),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ee=f(e,["cachedContent"]);t!==void 0&&ee!=null&&g(t,["cachedContent"],Ps(n,ee));const M=f(e,["responseModalities"]);M!=null&&g(s,["responseModalities"],M);const R=f(e,["mediaResolution"]);R!=null&&g(s,["mediaResolution"],R);const N=f(e,["speechConfig"]);if(N!=null&&g(s,["speechConfig"],Ip(N)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=f(e,["thinkingConfig"]);L!=null&&g(s,["thinkingConfig"],L);const D=f(e,["imageConfig"]);return D!=null&&g(s,["imageConfig"],D),s}function eN(n,e,t){const s={},o=f(e,["systemInstruction"]);t!==void 0&&o!=null&&g(t,["systemInstruction"],mn(o));const l=f(e,["temperature"]);l!=null&&g(s,["temperature"],l);const c=f(e,["topP"]);c!=null&&g(s,["topP"],c);const d=f(e,["topK"]);d!=null&&g(s,["topK"],d);const p=f(e,["candidateCount"]);p!=null&&g(s,["candidateCount"],p);const h=f(e,["maxOutputTokens"]);h!=null&&g(s,["maxOutputTokens"],h);const T=f(e,["stopSequences"]);T!=null&&g(s,["stopSequences"],T);const E=f(e,["responseLogprobs"]);E!=null&&g(s,["responseLogprobs"],E);const A=f(e,["logprobs"]);A!=null&&g(s,["logprobs"],A);const I=f(e,["presencePenalty"]);I!=null&&g(s,["presencePenalty"],I);const k=f(e,["frequencyPenalty"]);k!=null&&g(s,["frequencyPenalty"],k);const B=f(e,["seed"]);B!=null&&g(s,["seed"],B);const F=f(e,["responseMimeType"]);F!=null&&g(s,["responseMimeType"],F);const Z=f(e,["responseSchema"]);Z!=null&&g(s,["responseSchema"],Cp(Z));const te=f(e,["responseJsonSchema"]);te!=null&&g(s,["responseJsonSchema"],te);const K=f(e,["routingConfig"]);K!=null&&g(s,["routingConfig"],K);const Y=f(e,["modelSelectionConfig"]);Y!=null&&g(s,["modelConfig"],Y);const ae=f(e,["safetySettings"]);if(t!==void 0&&ae!=null){let X=ae;Array.isArray(X)&&(X=X.map(fe=>fe)),g(t,["safetySettings"],X)}const ee=f(e,["tools"]);if(t!==void 0&&ee!=null){let X=Fa(ee);Array.isArray(X)&&(X=X.map(fe=>rS(Ba(fe)))),g(t,["tools"],X)}const M=f(e,["toolConfig"]);t!==void 0&&M!=null&&g(t,["toolConfig"],M);const R=f(e,["labels"]);t!==void 0&&R!=null&&g(t,["labels"],R);const N=f(e,["cachedContent"]);t!==void 0&&N!=null&&g(t,["cachedContent"],Ps(n,N));const L=f(e,["responseModalities"]);L!=null&&g(s,["responseModalities"],L);const D=f(e,["mediaResolution"]);D!=null&&g(s,["mediaResolution"],D);const V=f(e,["speechConfig"]);V!=null&&g(s,["speechConfig"],sS(Ip(V)));const P=f(e,["audioTimestamp"]);P!=null&&g(s,["audioTimestamp"],P);const Ve=f(e,["thinkingConfig"]);Ve!=null&&g(s,["thinkingConfig"],Ve);const $e=f(e,["imageConfig"]);return $e!=null&&g(s,["imageConfig"],$e),s}function eT(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let c=Zn(o);Array.isArray(c)&&(c=c.map(d=>$d(d))),g(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&g(t,["generationConfig"],ZR(n,l,t)),t}function tT(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["contents"]);if(o!=null){let c=Zn(o);Array.isArray(c)&&(c=c.map(d=>d)),g(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&g(t,["generationConfig"],eN(n,l,t)),t}function nT(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(h=>bR(h))),g(e,["candidates"],p)}const o=f(n,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);const l=f(n,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const c=f(n,["responseId"]);c!=null&&g(e,["responseId"],c);const d=f(n,["usageMetadata"]);return d!=null&&g(e,["usageMetadata"],d),e}function iT(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["candidates"],h)}const o=f(n,["createTime"]);o!=null&&g(e,["createTime"],o);const l=f(n,["modelVersion"]);l!=null&&g(e,["modelVersion"],l);const c=f(n,["promptFeedback"]);c!=null&&g(e,["promptFeedback"],c);const d=f(n,["responseId"]);d!=null&&g(e,["responseId"],d);const p=f(n,["usageMetadata"]);return p!=null&&g(e,["usageMetadata"],p),e}function tN(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const o=f(n,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);const l=f(n,["guidanceScale"]);if(e!==void 0&&l!=null&&g(e,["parameters","guidanceScale"],l),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&g(e,["parameters","safetySetting"],c);const d=f(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const p=f(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&g(e,["parameters","includeSafetyAttributes"],p);const h=f(n,["includeRaiReason"]);e!==void 0&&h!=null&&g(e,["parameters","includeRaiReason"],h);const T=f(n,["language"]);e!==void 0&&T!=null&&g(e,["parameters","language"],T);const E=f(n,["outputMimeType"]);e!==void 0&&E!=null&&g(e,["parameters","outputOptions","mimeType"],E);const A=f(n,["outputCompressionQuality"]);if(e!==void 0&&A!=null&&g(e,["parameters","outputOptions","compressionQuality"],A),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=f(n,["imageSize"]);if(e!==void 0&&I!=null&&g(e,["parameters","sampleImageSize"],I),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function nN(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const o=f(n,["negativePrompt"]);e!==void 0&&o!=null&&g(e,["parameters","negativePrompt"],o);const l=f(n,["numberOfImages"]);e!==void 0&&l!=null&&g(e,["parameters","sampleCount"],l);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);const d=f(n,["guidanceScale"]);e!==void 0&&d!=null&&g(e,["parameters","guidanceScale"],d);const p=f(n,["seed"]);e!==void 0&&p!=null&&g(e,["parameters","seed"],p);const h=f(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&g(e,["parameters","safetySetting"],h);const T=f(n,["personGeneration"]);e!==void 0&&T!=null&&g(e,["parameters","personGeneration"],T);const E=f(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&g(e,["parameters","includeSafetyAttributes"],E);const A=f(n,["includeRaiReason"]);e!==void 0&&A!=null&&g(e,["parameters","includeRaiReason"],A);const I=f(n,["language"]);e!==void 0&&I!=null&&g(e,["parameters","language"],I);const k=f(n,["outputMimeType"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","mimeType"],k);const B=f(n,["outputCompressionQuality"]);e!==void 0&&B!=null&&g(e,["parameters","outputOptions","compressionQuality"],B);const F=f(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const Z=f(n,["labels"]);e!==void 0&&Z!=null&&g(e,["labels"],Z);const te=f(n,["imageSize"]);e!==void 0&&te!=null&&g(e,["parameters","sampleImageSize"],te);const K=f(n,["enhancePrompt"]);return e!==void 0&&K!=null&&g(e,["parameters","enhancePrompt"],K),t}function iN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["prompt"]);o!=null&&g(t,["instances[0]","prompt"],o);const l=f(e,["config"]);return l!=null&&tN(l,t),t}function sN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["prompt"]);o!=null&&g(t,["instances[0]","prompt"],o);const l=f(e,["config"]);return l!=null&&nN(l,t),t}function rN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>yN(c))),g(e,["generatedImages"],l)}const o=f(n,["positivePromptSafetyAttributes"]);return o!=null&&g(e,["positivePromptSafetyAttributes"],nS(o)),e}function oN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>Qd(c))),g(e,["generatedImages"],l)}const o=f(n,["positivePromptSafetyAttributes"]);return o!=null&&g(e,["positivePromptSafetyAttributes"],iS(o)),e}function aN(n,e){const t={},s=f(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=f(n,["durationSeconds"]);if(e!==void 0&&o!=null&&g(e,["parameters","durationSeconds"],o),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=f(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const c=f(n,["resolution"]);e!==void 0&&c!=null&&g(e,["parameters","resolution"],c);const d=f(n,["personGeneration"]);if(e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const p=f(n,["negativePrompt"]);e!==void 0&&p!=null&&g(e,["parameters","negativePrompt"],p);const h=f(n,["enhancePrompt"]);if(e!==void 0&&h!=null&&g(e,["parameters","enhancePrompt"],h),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=f(n,["lastFrame"]);e!==void 0&&T!=null&&g(e,["instances[0]","lastFrame"],Xd(T));const E=f(n,["referenceImages"]);if(e!==void 0&&E!=null){let A=E;Array.isArray(A)&&(A=A.map(I=>o1(I))),g(e,["instances[0]","referenceImages"],A)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function lN(n,e){const t={},s=f(n,["numberOfVideos"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const o=f(n,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);const l=f(n,["fps"]);e!==void 0&&l!=null&&g(e,["parameters","fps"],l);const c=f(n,["durationSeconds"]);e!==void 0&&c!=null&&g(e,["parameters","durationSeconds"],c);const d=f(n,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);const p=f(n,["aspectRatio"]);e!==void 0&&p!=null&&g(e,["parameters","aspectRatio"],p);const h=f(n,["resolution"]);e!==void 0&&h!=null&&g(e,["parameters","resolution"],h);const T=f(n,["personGeneration"]);e!==void 0&&T!=null&&g(e,["parameters","personGeneration"],T);const E=f(n,["pubsubTopic"]);e!==void 0&&E!=null&&g(e,["parameters","pubsubTopic"],E);const A=f(n,["negativePrompt"]);e!==void 0&&A!=null&&g(e,["parameters","negativePrompt"],A);const I=f(n,["enhancePrompt"]);e!==void 0&&I!=null&&g(e,["parameters","enhancePrompt"],I);const k=f(n,["generateAudio"]);e!==void 0&&k!=null&&g(e,["parameters","generateAudio"],k);const B=f(n,["lastFrame"]);e!==void 0&&B!=null&&g(e,["instances[0]","lastFrame"],yi(B));const F=f(n,["referenceImages"]);if(e!==void 0&&F!=null){let K=F;Array.isArray(K)&&(K=K.map(Y=>a1(Y))),g(e,["instances[0]","referenceImages"],K)}const Z=f(n,["mask"]);e!==void 0&&Z!=null&&g(e,["instances[0]","mask"],r1(Z));const te=f(n,["compressionQuality"]);return e!==void 0&&te!=null&&g(e,["parameters","compressionQuality"],te),t}function uN(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["metadata"]);s!=null&&g(e,["metadata"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);l!=null&&g(e,["error"],l);const c=f(n,["response","generateVideoResponse"]);return c!=null&&g(e,["response"],hN(c)),e}function cN(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["metadata"]);s!=null&&g(e,["metadata"],s);const o=f(n,["done"]);o!=null&&g(e,["done"],o);const l=f(n,["error"]);l!=null&&g(e,["error"],l);const c=f(n,["response"]);return c!=null&&g(e,["response"],mN(c)),e}function dN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["prompt"]);o!=null&&g(t,["instances[0]","prompt"],o);const l=f(e,["image"]);l!=null&&g(t,["instances[0]","image"],Xd(l));const c=f(e,["video"]);c!=null&&g(t,["instances[0]","video"],oS(c));const d=f(e,["source"]);d!=null&&pN(d,t);const p=f(e,["config"]);return p!=null&&aN(p,t),t}function fN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["prompt"]);o!=null&&g(t,["instances[0]","prompt"],o);const l=f(e,["image"]);l!=null&&g(t,["instances[0]","image"],yi(l));const c=f(e,["video"]);c!=null&&g(t,["instances[0]","video"],aS(c));const d=f(e,["source"]);d!=null&&gN(d,t);const p=f(e,["config"]);return p!=null&&lN(p,t),t}function hN(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>vN(c))),g(e,["generatedVideos"],l)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const o=f(n,["raiMediaFilteredReasons"]);return o!=null&&g(e,["raiMediaFilteredReasons"],o),e}function mN(n){const e={},t=f(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>TN(c))),g(e,["generatedVideos"],l)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const o=f(n,["raiMediaFilteredReasons"]);return o!=null&&g(e,["raiMediaFilteredReasons"],o),e}function pN(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const o=f(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],Xd(o));const l=f(n,["video"]);return e!==void 0&&l!=null&&g(e,["instances[0]","video"],oS(l)),t}function gN(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const o=f(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],yi(o));const l=f(n,["video"]);return e!==void 0&&l!=null&&g(e,["instances[0]","video"],aS(l)),t}function yN(n){const e={},t=f(n,["_self"]);t!=null&&g(e,["image"],CN(t));const s=f(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const o=f(n,["_self"]);return o!=null&&g(e,["safetyAttributes"],nS(o)),e}function Qd(n){const e={},t=f(n,["_self"]);t!=null&&g(e,["image"],tS(t));const s=f(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const o=f(n,["_self"]);o!=null&&g(e,["safetyAttributes"],iS(o));const l=f(n,["prompt"]);return l!=null&&g(e,["enhancedPrompt"],l),e}function _N(n){const e={},t=f(n,["_self"]);t!=null&&g(e,["mask"],tS(t));const s=f(n,["labels"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),g(e,["labels"],o)}return e}function vN(n){const e={},t=f(n,["_self"]);return t!=null&&g(e,["video"],i1(t)),e}function TN(n){const e={},t=f(n,["_self"]);return t!=null&&g(e,["video"],s1(t)),e}function EN(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const s=f(n,["audioTimestamp"]);s!=null&&g(e,["audioTimestamp"],s);const o=f(n,["candidateCount"]);o!=null&&g(e,["candidateCount"],o);const l=f(n,["enableAffectiveDialog"]);l!=null&&g(e,["enableAffectiveDialog"],l);const c=f(n,["frequencyPenalty"]);c!=null&&g(e,["frequencyPenalty"],c);const d=f(n,["logprobs"]);d!=null&&g(e,["logprobs"],d);const p=f(n,["maxOutputTokens"]);p!=null&&g(e,["maxOutputTokens"],p);const h=f(n,["mediaResolution"]);h!=null&&g(e,["mediaResolution"],h);const T=f(n,["presencePenalty"]);T!=null&&g(e,["presencePenalty"],T);const E=f(n,["responseJsonSchema"]);E!=null&&g(e,["responseJsonSchema"],E);const A=f(n,["responseLogprobs"]);A!=null&&g(e,["responseLogprobs"],A);const I=f(n,["responseMimeType"]);I!=null&&g(e,["responseMimeType"],I);const k=f(n,["responseModalities"]);k!=null&&g(e,["responseModalities"],k);const B=f(n,["responseSchema"]);B!=null&&g(e,["responseSchema"],B);const F=f(n,["routingConfig"]);F!=null&&g(e,["routingConfig"],F);const Z=f(n,["seed"]);Z!=null&&g(e,["seed"],Z);const te=f(n,["speechConfig"]);te!=null&&g(e,["speechConfig"],sS(te));const K=f(n,["stopSequences"]);K!=null&&g(e,["stopSequences"],K);const Y=f(n,["temperature"]);Y!=null&&g(e,["temperature"],Y);const ae=f(n,["thinkingConfig"]);ae!=null&&g(e,["thinkingConfig"],ae);const ee=f(n,["topK"]);ee!=null&&g(e,["topK"],ee);const M=f(n,["topP"]);return M!=null&&g(e,["topP"],M),e}function SN(n,e){const t={},s=f(e,["model"]);return s!=null&&g(t,["_url","name"],st(n,s)),t}function AN(n,e){const t={},s=f(e,["model"]);return s!=null&&g(t,["_url","name"],st(n,s)),t}function bN(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function xN(n){const e={},t=f(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],t),f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function CN(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],Pr(t));const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function tS(n){const e={},t=f(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&g(e,["imageBytes"],Pr(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["mimeType"],o),e}function Xd(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],Pr(t));const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function yi(n){const e={},t=f(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=f(n,["imageBytes"]);s!=null&&g(e,["bytesBase64Encoded"],Pr(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["mimeType"],o),e}function IN(n,e,t){const s={},o=f(e,["pageSize"]);t!==void 0&&o!=null&&g(t,["_query","pageSize"],o);const l=f(e,["pageToken"]);t!==void 0&&l!=null&&g(t,["_query","pageToken"],l);const c=f(e,["filter"]);t!==void 0&&c!=null&&g(t,["_query","filter"],c);const d=f(e,["queryBase"]);return t!==void 0&&d!=null&&g(t,["_url","models_url"],JE(n,d)),s}function wN(n,e,t){const s={},o=f(e,["pageSize"]);t!==void 0&&o!=null&&g(t,["_query","pageSize"],o);const l=f(e,["pageToken"]);t!==void 0&&l!=null&&g(t,["_query","pageToken"],l);const c=f(e,["filter"]);t!==void 0&&c!=null&&g(t,["_query","filter"],c);const d=f(e,["queryBase"]);return t!==void 0&&d!=null&&g(t,["_url","models_url"],JE(n,d)),s}function RN(n,e){const t={},s=f(e,["config"]);return s!=null&&IN(n,s,t),t}function NN(n,e){const t={},s=f(e,["config"]);return s!=null&&wN(n,s,t),t}function MN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["_self"]);if(o!=null){let l=KE(o);Array.isArray(l)&&(l=l.map(c=>Ym(c))),g(e,["models"],l)}return e}function DN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["_self"]);if(o!=null){let l=KE(o);Array.isArray(l)&&(l=l.map(c=>Jm(c))),g(e,["models"],l)}return e}function PN(n){const e={},t=f(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);const s=f(n,["segmentationClasses"]);s!=null&&g(e,["maskClasses"],s);const o=f(n,["maskDilation"]);return o!=null&&g(e,["dilation"],o),e}function Ym(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["displayName"]);s!=null&&g(e,["displayName"],s);const o=f(n,["description"]);o!=null&&g(e,["description"],o);const l=f(n,["version"]);l!=null&&g(e,["version"],l);const c=f(n,["_self"]);c!=null&&g(e,["tunedModelInfo"],KN(c));const d=f(n,["inputTokenLimit"]);d!=null&&g(e,["inputTokenLimit"],d);const p=f(n,["outputTokenLimit"]);p!=null&&g(e,["outputTokenLimit"],p);const h=f(n,["supportedGenerationMethods"]);return h!=null&&g(e,["supportedActions"],h),e}function Jm(n){const e={},t=f(n,["name"]);t!=null&&g(e,["name"],t);const s=f(n,["displayName"]);s!=null&&g(e,["displayName"],s);const o=f(n,["description"]);o!=null&&g(e,["description"],o);const l=f(n,["versionId"]);l!=null&&g(e,["version"],l);const c=f(n,["deployedModels"]);if(c!=null){let E=c;Array.isArray(E)&&(E=E.map(A=>QR(A))),g(e,["endpoints"],E)}const d=f(n,["labels"]);d!=null&&g(e,["labels"],d);const p=f(n,["_self"]);p!=null&&g(e,["tunedModelInfo"],$N(p));const h=f(n,["defaultCheckpointId"]);h!=null&&g(e,["defaultCheckpointId"],h);const T=f(n,["checkpoints"]);if(T!=null){let E=T;Array.isArray(E)&&(E=E.map(A=>A)),g(e,["checkpoints"],E)}return e}function VN(n){const e={},t=f(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],t);const s=f(n,["thought"]);s!=null&&g(e,["thought"],s);const o=f(n,["inlineData"]);o!=null&&g(e,["inlineData"],AR(o));const l=f(n,["fileData"]);l!=null&&g(e,["fileData"],XR(l));const c=f(n,["thoughtSignature"]);c!=null&&g(e,["thoughtSignature"],c);const d=f(n,["functionCall"]);d!=null&&g(e,["functionCall"],d);const p=f(n,["codeExecutionResult"]);p!=null&&g(e,["codeExecutionResult"],p);const h=f(n,["executableCode"]);h!=null&&g(e,["executableCode"],h);const T=f(n,["functionResponse"]);T!=null&&g(e,["functionResponse"],T);const E=f(n,["text"]);return E!=null&&g(e,["text"],E),e}function kN(n){const e={},t=f(n,["productImage"]);return t!=null&&g(e,["image"],yi(t)),e}function UN(n,e){const t={},s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const o=f(n,["baseSteps"]);e!==void 0&&o!=null&&g(e,["parameters","editConfig","baseSteps"],o);const l=f(n,["outputGcsUri"]);e!==void 0&&l!=null&&g(e,["parameters","storageUri"],l);const c=f(n,["seed"]);e!==void 0&&c!=null&&g(e,["parameters","seed"],c);const d=f(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&g(e,["parameters","safetySetting"],d);const p=f(n,["personGeneration"]);e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p);const h=f(n,["addWatermark"]);e!==void 0&&h!=null&&g(e,["parameters","addWatermark"],h);const T=f(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);const E=f(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&g(e,["parameters","outputOptions","compressionQuality"],E);const A=f(n,["enhancePrompt"]);e!==void 0&&A!=null&&g(e,["parameters","enhancePrompt"],A);const I=f(n,["labels"]);return e!==void 0&&I!=null&&g(e,["labels"],I),t}function LN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["source"]);o!=null&&qN(o,t);const l=f(e,["config"]);return l!=null&&UN(l,t),t}function ON(n){const e={},t=f(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>Qd(o))),g(e,["generatedImages"],s)}return e}function qN(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const o=f(n,["personImage"]);e!==void 0&&o!=null&&g(e,["instances[0]","personImage","image"],yi(o));const l=f(n,["productImages"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>kN(d))),g(e,["instances[0]","productImages"],c)}return t}function BN(n){const e={},t=f(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],yi(t));const s=f(n,["referenceId"]);s!=null&&g(e,["referenceId"],s);const o=f(n,["referenceType"]);o!=null&&g(e,["referenceType"],o);const l=f(n,["maskImageConfig"]);l!=null&&g(e,["maskImageConfig"],PN(l));const c=f(n,["controlImageConfig"]);c!=null&&g(e,["controlImageConfig"],NR(c));const d=f(n,["styleImageConfig"]);d!=null&&g(e,["styleImageConfig"],d);const p=f(n,["subjectImageConfig"]);return p!=null&&g(e,["subjectImageConfig"],p),e}function nS(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=f(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const o=f(n,["contentType"]);return o!=null&&g(e,["contentType"],o),e}function iS(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=f(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const o=f(n,["contentType"]);return o!=null&&g(e,["contentType"],o),e}function FN(n){const e={};if(f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=f(n,["category"]);t!=null&&g(e,["category"],t);const s=f(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function HN(n){const e={},t=f(n,["image"]);return t!=null&&g(e,["image"],yi(t)),e}function zN(n,e){const t={},s=f(n,["mode"]);e!==void 0&&s!=null&&g(e,["parameters","mode"],s);const o=f(n,["maxPredictions"]);e!==void 0&&o!=null&&g(e,["parameters","maxPredictions"],o);const l=f(n,["confidenceThreshold"]);e!==void 0&&l!=null&&g(e,["parameters","confidenceThreshold"],l);const c=f(n,["maskDilation"]);e!==void 0&&c!=null&&g(e,["parameters","maskDilation"],c);const d=f(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&g(e,["parameters","binaryColorThreshold"],d);const p=f(n,["labels"]);return e!==void 0&&p!=null&&g(e,["labels"],p),t}function GN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["source"]);o!=null&&YN(o,t);const l=f(e,["config"]);return l!=null&&zN(l,t),t}function jN(n){const e={},t=f(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>_N(o))),g(e,["generatedMasks"],s)}return e}function YN(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const o=f(n,["image"]);e!==void 0&&o!=null&&g(e,["instances[0]","image"],yi(o));const l=f(n,["scribbleImage"]);return e!==void 0&&l!=null&&g(e,["instances[0]","scribble"],HN(l)),t}function sS(n){const e={},t=f(n,["voiceConfig"]);if(t!=null&&g(e,["voiceConfig"],t),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=f(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function JN(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["functionDeclarations"],h)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],xN(s));const o=f(n,["googleSearchRetrieval"]);if(o!=null&&g(e,["googleSearchRetrieval"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],bN(l));const c=f(n,["urlContext"]);c!=null&&g(e,["urlContext"],c);const d=f(n,["computerUse"]);d!=null&&g(e,["computerUse"],d);const p=f(n,["codeExecution"]);return p!=null&&g(e,["codeExecution"],p),e}function rS(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(A=>WR(A))),g(e,["functionDeclarations"],E)}const s=f(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const o=f(n,["googleSearch"]);o!=null&&g(e,["googleSearch"],o);const l=f(n,["googleSearchRetrieval"]);l!=null&&g(e,["googleSearchRetrieval"],l);const c=f(n,["enterpriseWebSearch"]);c!=null&&g(e,["enterpriseWebSearch"],c);const d=f(n,["googleMaps"]);d!=null&&g(e,["googleMaps"],d);const p=f(n,["urlContext"]);p!=null&&g(e,["urlContext"],p);const h=f(n,["computerUse"]);h!=null&&g(e,["computerUse"],h);const T=f(n,["codeExecution"]);return T!=null&&g(e,["codeExecution"],T),e}function KN(n){const e={},t=f(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=f(n,["createTime"]);s!=null&&g(e,["createTime"],s);const o=f(n,["updateTime"]);return o!=null&&g(e,["updateTime"],o),e}function $N(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);const s=f(n,["createTime"]);s!=null&&g(e,["createTime"],s);const o=f(n,["updateTime"]);return o!=null&&g(e,["updateTime"],o),e}function QN(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const o=f(n,["description"]);e!==void 0&&o!=null&&g(e,["description"],o);const l=f(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&g(e,["defaultCheckpointId"],l),t}function XN(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const o=f(n,["description"]);e!==void 0&&o!=null&&g(e,["description"],o);const l=f(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&g(e,["defaultCheckpointId"],l),t}function WN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","name"],st(n,s));const o=f(e,["config"]);return o!=null&&QN(o,t),t}function ZN(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["config"]);return o!=null&&XN(o,t),t}function e1(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const o=f(n,["includeRaiReason"]);e!==void 0&&o!=null&&g(e,["parameters","includeRaiReason"],o);const l=f(n,["outputMimeType"]);e!==void 0&&l!=null&&g(e,["parameters","outputOptions","mimeType"],l);const c=f(n,["outputCompressionQuality"]);e!==void 0&&c!=null&&g(e,["parameters","outputOptions","compressionQuality"],c);const d=f(n,["enhanceInputImage"]);e!==void 0&&d!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],d);const p=f(n,["imagePreservationFactor"]);e!==void 0&&p!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],p);const h=f(n,["labels"]);e!==void 0&&h!=null&&g(e,["labels"],h);const T=f(n,["numberOfImages"]);e!==void 0&&T!=null&&g(e,["parameters","sampleCount"],T);const E=f(n,["mode"]);return e!==void 0&&E!=null&&g(e,["parameters","mode"],E),t}function t1(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["_url","model"],st(n,s));const o=f(e,["image"]);o!=null&&g(t,["instances[0]","image"],yi(o));const l=f(e,["upscaleFactor"]);l!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],l);const c=f(e,["config"]);return c!=null&&e1(c,t),t}function n1(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Qd(l))),g(e,["generatedImages"],o)}return e}function i1(n){const e={},t=f(n,["video","uri"]);t!=null&&g(e,["uri"],t);const s=f(n,["video","encodedVideo"]);s!=null&&g(e,["videoBytes"],Pr(s));const o=f(n,["encoding"]);return o!=null&&g(e,["mimeType"],o),e}function s1(n){const e={},t=f(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&g(e,["videoBytes"],Pr(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["mimeType"],o),e}function r1(n){const e={},t=f(n,["image"]);t!=null&&g(e,["_self"],yi(t));const s=f(n,["maskMode"]);return s!=null&&g(e,["maskMode"],s),e}function o1(n){const e={},t=f(n,["image"]);t!=null&&g(e,["image"],Xd(t));const s=f(n,["referenceType"]);return s!=null&&g(e,["referenceType"],s),e}function a1(n){const e={},t=f(n,["image"]);t!=null&&g(e,["image"],yi(t));const s=f(n,["referenceType"]);return s!=null&&g(e,["referenceType"],s),e}function oS(n){const e={},t=f(n,["uri"]);t!=null&&g(e,["video","uri"],t);const s=f(n,["videoBytes"]);s!=null&&g(e,["video","encodedVideo"],Pr(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["encoding"],o),e}function aS(n){const e={},t=f(n,["uri"]);t!=null&&g(e,["gcsUri"],t);const s=f(n,["videoBytes"]);s!=null&&g(e,["bytesBase64Encoded"],Pr(s));const o=f(n,["mimeType"]);return o!=null&&g(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const l1="Content-Type",u1="X-Server-Timeout",c1="User-Agent",Km="x-goog-api-client",d1="1.24.0",f1=`google-genai-sdk/${d1}`,h1="v1beta1",m1="v1beta",sT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class p1{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:h1,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:m1,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const o=[this.getRequestUrlInternal(t)];return s&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[c,d]of Object.entries(e.queryParams))o.searchParams.append(c,String(d));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(o,l,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[o,l]of Object.entries(t))typeof l=="object"?s[o]=Object.assign(Object.assign({},s[o]),l):l!==void 0&&(s[o]=l);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,s);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(o,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>o.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&g1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async o=>(await rT(o),new zm(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async o=>(await rT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return ba(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let c="";for(;;){const{done:d,value:p}=yield Et(o.read());if(d){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=l.decode(p,{stream:!0});try{const E=JSON.parse(h);if("error"in E){const A=JSON.parse(JSON.stringify(E.error)),I=A.status,k=A.code,B=`got status: ${I}. ${JSON.stringify(E)}`;if(k>=400&&k<600)throw new Kd({message:B,status:k})}}catch(E){if(E.name==="ApiError")throw E}c+=h;let T=c.match(sT);for(;T;){const E=T[1];try{const A=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Et(new zm(A)),c=c.slice(T[0].length),T=c.match(sT)}catch(A){throw new Error(`exception parsing stream chunk ${E}. ${A}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=f1+" "+this.clientOptions.userAgentExtra;return e[c1]=t,e[Km]=t,e[l1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))t.append(s,o);e.timeout&&e.timeout>0&&t.append(u1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var s;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,c=await l.stat(e);o.sizeBytes=String(c.size);const d=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:c.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=d;const p=await this.fetchUploadUrl(o,t);return l.upload(e,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var s;let o={};t!=null&&t.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},c=await this.request({path:Se("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(s=c==null?void 0:c.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function rT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(s);throw t>=400&&t<600?new Kd({message:o,status:t}):new Error(o)}}function g1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(l,c){const d=Object.assign({},l);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const h=c[p],T=d[p];h&&typeof h=="object"&&!Array.isArray(h)&&T&&typeof T=="object"&&!Array.isArray(T)?d[p]=s(T,h):(T&&h&&typeof T!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof T}, New type: ${typeof h}. Overwriting.`),d[p]=h)}return d}const o=s(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const y1="mcp_used/unknown";let _1=!1;function lS(n){for(const e of n)if(v1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return _1}function uS(n){var e;const t=(e=n[Km])!==null&&e!==void 0?e:"";n[Km]=(t+` ${y1}`).trimStart()}function v1(n){return n!==null&&typeof n=="object"&&n instanceof Rp}function T1(n,e=100){return ba(this,arguments,function*(){let s,o=0;for(;o<e;){const l=yield Et(n.listTools({cursor:s}));for(const c of l.tools)yield yield Et(c),o++;if(!l.nextCursor)break;s=l.nextCursor}})}class Rp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Rp(e,t)}async initialize(){var e,t,s,o;if(this.mcpTools.length>0)return;const l={},c=[];for(const T of this.mcpClients)try{for(var d=!0,p=(t=void 0,ru(T1(T))),h;h=await p.next(),e=h.done,!e;d=!0){o=h.value,d=!1;const E=o;c.push(E);const A=E.name;if(l[A])throw new Error(`Duplicate function name ${A} found in MCP tools. Please ensure function names are unique.`);l[A]=T}}catch(E){t={error:E}}finally{try{!d&&!e&&(s=p.return)&&await s.call(p)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),CI(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[s.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await o.callTool({name:s.name,arguments:s.args},void 0,l);t.push({functionResponse:{name:s.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function E1(n,e,t){const s=new _I;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(s,o),e(s)}class S1{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=x1(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),p=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${d}`;let h=()=>{};const T=new Promise(K=>{h=K}),E=e.callbacks,A=function(){h({})},I=this.apiClient,k={onopen:A,onmessage:K=>{E1(I,E.onmessage,K)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(K){},onclose:(s=E==null?void 0:E.onclose)!==null&&s!==void 0?s:function(K){}},B=this.webSocketFactory.create(p,b1(c),k);B.connect(),await T;const te={setup:{model:st(this.apiClient,e.model)}};return B.send(JSON.stringify(te)),new A1(B,this.apiClient)}}class A1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=mR(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=hR(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ta.PLAY)}pause(){this.sendPlaybackControl(Ta.PAUSE)}stop(){this.sendPlaybackControl(Ta.STOP)}resetContext(){this.sendPlaybackControl(Ta.RESET_CONTEXT)}close(){this.conn.close()}}function b1(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function x1(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function I1(n,e,t){const s=new yI;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const l=JSON.parse(o);if(n.isVertexAI()){const c=yR(l);Object.assign(s,c)}else Object.assign(s,l);e(s)}class w1{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new S1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,o,l,c,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const p=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let T;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&lS(e.config.tools)&&uS(E);const A=D1(E);if(this.apiClient.isVertexAI())T=`${p}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(A);else{const N=this.apiClient.getApiKey();let L="BidiGenerateContent",D="key";N!=null&&N.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",D="access_token"),T=`${p}/ws/google.ai.generativelanguage.${h}.GenerativeService.${L}?${D}=${N}`}let I=()=>{};const k=new Promise(N=>{I=N}),B=e.callbacks,F=function(){var N;(N=B==null?void 0:B.onopen)===null||N===void 0||N.call(B),I({})},Z=this.apiClient,te={onopen:F,onmessage:N=>{I1(Z,B.onmessage,N)},onerror:(t=B==null?void 0:B.onerror)!==null&&t!==void 0?t:function(N){},onclose:(s=B==null?void 0:B.onclose)!==null&&s!==void 0?s:function(N){}},K=this.webSocketFactory.create(T,M1(A),te);K.connect(),await k;let Y=st(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&Y.startsWith("publishers/")){const N=this.apiClient.getProject(),L=this.apiClient.getLocation();Y=`projects/${N}/locations/${L}/`+Y}let ae={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[bd.AUDIO]}:e.config.responseModalities=[bd.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ee=(d=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[],M=[];for(const N of ee)if(this.isCallableTool(N)){const L=N;M.push(await L.tool())}else M.push(N);M.length>0&&(e.config.tools=M);const R={model:Y,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ae=fR(this.apiClient,R):ae=dR(this.apiClient,R),delete ae.config,K.send(JSON.stringify(ae)),new N1(K,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const R1={turnComplete:!0};class N1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=Zn(t.turns),e.isVertexAI()||(s=s.map(o=>$d(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const l of s){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(C1)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},R1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:gR(e)}:t={realtimeInput:pR(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function M1(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function D1(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oT=10;function aT(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(xa(c)){o=!0;break}if(!o)return!0;const l=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function xa(n){return"callTool"in n&&typeof n.callTool=="function"}function P1(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>xa(o)))!==null&&s!==void 0?s:!1}function V1(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!xa(o)))!==null&&s!==void 0?s:!1}function lT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k1 extends Eo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,o,l,c,d;const p=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!P1(t)||aT(t.config))return await this.generateContentInternal(p);if(V1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,T;const E=Zn(p.contents),A=(l=(o=(s=p.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&l!==void 0?l:oT;let I=0;for(;I<A&&(h=await this.generateContentInternal(p),!(!h.functionCalls||h.functionCalls.length===0));){const k=h.candidates[0].content,B=[];for(const F of(d=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[])if(xa(F)){const te=await F.callTool(h.functionCalls);B.push(...te)}I++,T={role:"user",parts:B},p.contents=Zn(p.contents),p.contents.push(k),p.contents.push(T),lT(p.config)&&(E.push(k),E.push(T))}return lT(p.config)&&(h.automaticFunctionCallingHistory=E),h},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),aT(t.config)){const s=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var o;let l;const c=[];if(s!=null&&s.generatedImages)for(const p of s.generatedImages)p&&(p!=null&&p.safetyAttributes)&&((o=p==null?void 0:p.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?l=p==null?void 0:p.safetyAttributes:c.push(p);let d;return l?d={generatedImages:c,positivePromptSafetyAttributes:l,sdkHttpResponse:s.sdkHttpResponse}:d={generatedImages:c,sdkHttpResponse:s.sdkHttpResponse},d}),this.list=async t=>{var s;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((s=c.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new vu(mo.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(c),c)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,s,o;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const c=await Promise.all(l.map(async p=>xa(p)?await p.tool():p)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(d.config.tools=c,e.config&&e.config.tools&&lS(e.config.tools)){const p=(o=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&o!==void 0?o:{};let h=Object.assign({},p);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),uS(h),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return d}async initAfcToolsMap(e){var t,s,o;const l=new Map;for(const c of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(xa(c)){const d=c,p=await d.tool();for(const h of(o=p.functionDeclarations)!==null&&o!==void 0?o:[]){if(!h.name)throw new Error("Function declaration name is required.");if(l.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);l.set(h.name,d)}}return l}async processAfcStream(e){var t,s,o;const l=(o=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:oT;let c=!1,d=0;const p=await this.initAfcToolsMap(e);return(function(h,T,E){var A,I;return ba(this,arguments,function*(){for(var k,B,F,Z;d<l;){c&&(d++,c=!1);const ae=yield Et(h.processParamsMaybeAddMcpUsage(E)),ee=yield Et(h.generateContentStreamInternal(ae)),M=[],R=[];try{for(var te=!0,K=(B=void 0,ru(ee)),Y;Y=yield Et(K.next()),k=Y.done,!k;te=!0){Z=Y.value,te=!1;const N=Z;if(yield yield Et(N),N.candidates&&(!((A=N.candidates[0])===null||A===void 0)&&A.content)){R.push(N.candidates[0].content);for(const L of(I=N.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(d<l&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(L.functionCall.name)){const D=yield Et(T.get(L.functionCall.name).callTool([L.functionCall]));M.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(N){B={error:N}}finally{try{!te&&!k&&(F=K.return)&&(yield Et(F.call(K)))}finally{if(B)throw B.error}}if(M.length>0){c=!0;const N=new Wl;N.candidates=[{content:{role:"user",parts:M}}],yield yield Et(N);const L=[];L.push(...R),L.push({role:"user",parts:M});const D=Zn(E.contents).concat(L);E.contents=D}else break}})})(this,p,e)}async generateContentInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=tT(this.apiClient,e);return d=Se("{model}:generateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=iT(T),A=new Wl;return Object.assign(A,E),A})}else{const h=eT(this.apiClient,e);return d=Se("{model}:generateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=nT(T),A=new Wl;return Object.assign(A,E),A})}}async generateContentStreamInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=tT(this.apiClient,e);return d=Se("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),c.then(function(E){return ba(this,arguments,function*(){var A,I,k,B;try{for(var F=!0,Z=ru(E),te;te=yield Et(Z.next()),A=te.done,!A;F=!0){B=te.value,F=!1;const K=B,Y=iT(yield Et(K.json()));Y.sdkHttpResponse={headers:K.headers};const ae=new Wl;Object.assign(ae,Y),yield yield Et(ae)}}catch(K){I={error:K}}finally{try{!F&&!A&&(k=Z.return)&&(yield Et(k.call(Z)))}finally{if(I)throw I.error}}})})}else{const h=eT(this.apiClient,e);return d=Se("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(E){return ba(this,arguments,function*(){var A,I,k,B;try{for(var F=!0,Z=ru(E),te;te=yield Et(Z.next()),A=te.done,!A;F=!0){B=te.value,F=!1;const K=B,Y=nT(yield Et(K.json()));Y.sdkHttpResponse={headers:K.headers};const ae=new Wl;Object.assign(ae,Y),yield yield Et(ae)}}catch(K){I={error:K}}finally{try{!F&&!A&&(k=Z.return)&&(yield Et(k.call(Z)))}finally{if(I)throw I.error}}})})}}async embedContent(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=JR(this.apiClient,e);return d=Se("{model}:predict",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=$R(T),A=new O0;return Object.assign(A,E),A})}else{const h=YR(this.apiClient,e);return d=Se("{model}:batchEmbedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=KR(T),A=new O0;return Object.assign(A,E),A})}}async generateImagesInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=sN(this.apiClient,e);return d=Se("{model}:predict",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=oN(T),A=new q0;return Object.assign(A,E),A})}else{const h=iN(this.apiClient,e);return d=Se("{model}:predict",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=rN(T),A=new q0;return Object.assign(A,E),A})}}async editImageInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=HR(this.apiClient,e);return l=Se("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>{const h=zR(p),T=new uI;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=t1(this.apiClient,e);return l=Se("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>{const h=n1(p),T=new cI;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=LN(this.apiClient,e);return l=Se("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>{const h=ON(p),T=new dI;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=GN(this.apiClient,e);return l=Se("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o.then(p=>{const h=jN(p),T=new fI;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=AN(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>Jm(T))}else{const h=SN(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>Ym(T))}}async listInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=NN(this.apiClient,e);return d=Se("{models_url}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=DN(T),A=new B0;return Object.assign(A,E),A})}else{const h=RN(this.apiClient,e);return d=Se("{models_url}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=MN(T),A=new B0;return Object.assign(A,E),A})}}async update(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=ZN(this.apiClient,e);return d=Se("{model}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>Jm(T))}else{const h=WN(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>Ym(T))}}async delete(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=OR(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=BR(T),A=new F0;return Object.assign(A,E),A})}else{const h=LR(this.apiClient,e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=qR(T),A=new F0;return Object.assign(A,E),A})}}async countTokens(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=VR(this.apiClient,e);return d=Se("{model}:countTokens",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=UR(T),A=new H0;return Object.assign(A,E),A})}else{const h=PR(this.apiClient,e);return d=Se("{model}:countTokens",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=kR(T),A=new H0;return Object.assign(A,E),A})}}async computeTokens(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=CR(this.apiClient,e);return l=Se("{model}:computeTokens",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>{const h=IR(p),T=new hI;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=fN(this.apiClient,e);return d=Se("{model}:predictLongRunning",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c.then(T=>{const E=cN(T),A=new xd;return Object.assign(A,E),A})}else{const h=dN(this.apiClient,e);return d=Se("{model}:predictLongRunning",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c.then(T=>{const E=uN(T),A=new xd;return Object.assign(A,E),A})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U1 extends Eo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;s&&"httpOptions"in s&&(l=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async get(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;s&&"httpOptions"in s&&(l=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=oI(e);return d=Se("{operationName}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json()),c}else{const h=rI(e);return d=Se("{operationName}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),c}}async fetchPredictVideosOperationInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=WC(e);return l=Se("{resourceName}:fetchPredictOperation",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L1(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["data"]);t!=null&&g(e,["data"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function O1(n){const e={},t=f(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Y1(l))),g(e,["parts"],o)}const s=f(n,["role"]);return s!=null&&g(e,["role"],s),e}function q1(n,e,t){const s={},o=f(e,["expireTime"]);t!==void 0&&o!=null&&g(t,["expireTime"],o);const l=f(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&g(t,["newSessionExpireTime"],l);const c=f(e,["uses"]);t!==void 0&&c!=null&&g(t,["uses"],c);const d=f(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&g(t,["bidiGenerateContentSetup"],j1(n,d));const p=f(e,["lockAdditionalFields"]);return t!==void 0&&p!=null&&g(t,["fieldMask"],p),s}function B1(n,e){const t={},s=f(e,["config"]);return s!=null&&g(t,["config"],q1(n,s,t)),t}function F1(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function H1(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function z1(n){const e={},t=f(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],t),f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function G1(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const o=f(n,["responseModalities"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","responseModalities"],o);const l=f(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=f(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=f(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=f(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const T=f(n,["seed"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","seed"],T);const E=f(n,["speechConfig"]);e!==void 0&&E!=null&&g(e,["setup","generationConfig","speechConfig"],wp(E));const A=f(n,["thinkingConfig"]);e!==void 0&&A!=null&&g(e,["setup","generationConfig","thinkingConfig"],A);const I=f(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],I);const k=f(n,["systemInstruction"]);e!==void 0&&k!=null&&g(e,["setup","systemInstruction"],O1(mn(k)));const B=f(n,["tools"]);if(e!==void 0&&B!=null){let ee=Fa(B);Array.isArray(ee)&&(ee=ee.map(M=>K1(Ba(M)))),g(e,["setup","tools"],ee)}const F=f(n,["sessionResumption"]);e!==void 0&&F!=null&&g(e,["setup","sessionResumption"],J1(F));const Z=f(n,["inputAudioTranscription"]);e!==void 0&&Z!=null&&g(e,["setup","inputAudioTranscription"],Z);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&g(e,["setup","outputAudioTranscription"],te);const K=f(n,["realtimeInputConfig"]);e!==void 0&&K!=null&&g(e,["setup","realtimeInputConfig"],K);const Y=f(n,["contextWindowCompression"]);e!==void 0&&Y!=null&&g(e,["setup","contextWindowCompression"],Y);const ae=f(n,["proactivity"]);return e!==void 0&&ae!=null&&g(e,["setup","proactivity"],ae),t}function j1(n,e){const t={},s=f(e,["model"]);s!=null&&g(t,["setup","model"],st(n,s));const o=f(e,["config"]);return o!=null&&g(t,["config"],G1(o,t)),t}function Y1(n){const e={},t=f(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],t);const s=f(n,["thought"]);s!=null&&g(e,["thought"],s);const o=f(n,["inlineData"]);o!=null&&g(e,["inlineData"],L1(o));const l=f(n,["fileData"]);l!=null&&g(e,["fileData"],F1(l));const c=f(n,["thoughtSignature"]);c!=null&&g(e,["thoughtSignature"],c);const d=f(n,["functionCall"]);d!=null&&g(e,["functionCall"],d);const p=f(n,["codeExecutionResult"]);p!=null&&g(e,["codeExecutionResult"],p);const h=f(n,["executableCode"]);h!=null&&g(e,["executableCode"],h);const T=f(n,["functionResponse"]);T!=null&&g(e,["functionResponse"],T);const E=f(n,["text"]);return E!=null&&g(e,["text"],E),e}function J1(n){const e={},t=f(n,["handle"]);if(t!=null&&g(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function K1(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),g(e,["functionDeclarations"],h)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],z1(s));const o=f(n,["googleSearchRetrieval"]);if(o!=null&&g(e,["googleSearchRetrieval"],o),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=f(n,["googleMaps"]);l!=null&&g(e,["googleMaps"],H1(l));const c=f(n,["urlContext"]);c!=null&&g(e,["urlContext"],c);const d=f(n,["computerUse"]);d!=null&&g(e,["computerUse"],d);const p=f(n,["codeExecution"]);return p!=null&&g(e,["codeExecution"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $1(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const o=Object.keys(s).map(l=>`${t}.${l}`);e.push(...o)}else e.push(t)}return e.join(",")}function Q1(n,e){let t=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const l=s.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const l=$1(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];o.length>0&&(d=o.map(h=>c.includes(h)?`generationConfig.${h}`:h));const p=[];l&&p.push(l),d.length>0&&p.push(...d),p.length>0?n.fieldMask=p.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class X1 extends Eo{constructor(e){super(),this.apiClient=e}async create(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=B1(this.apiClient,e);l=Se("auth_tokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const p=Q1(d,e.config);return o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W1(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function Z1(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function eM(n,e){const t={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=f(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&g(e,["displayName"],s),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=f(n,["epochCount"]);e!==void 0&&o!=null&&g(e,["tuningTask","hyperparameters","epochCount"],o);const l=f(n,["learningRateMultiplier"]);if(l!=null&&g(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=f(n,["batchSize"]);e!==void 0&&c!=null&&g(e,["tuningTask","hyperparameters","batchSize"],c);const d=f(n,["learningRate"]);if(e!==void 0&&d!=null&&g(e,["tuningTask","hyperparameters","learningRate"],d),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function tM(n,e){const t={},s=f(n,["validationDataset"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec"],gM(s,t));const o=f(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&g(e,["tunedModelDisplayName"],o);const l=f(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);const c=f(n,["epochCount"]);e!==void 0&&c!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const d=f(n,["learningRateMultiplier"]);e!==void 0&&d!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const p=f(n,["exportLastCheckpointOnly"]);e!==void 0&&p!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],p);const h=f(n,["adapterSize"]);if(e!==void 0&&h!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],h),f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=f(n,["labels"]);return e!==void 0&&T!=null&&g(e,["labels"],T),t}function nM(n){const e={},t=f(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=f(n,["preTunedModel"]);s!=null&&g(e,["preTunedModel"],s);const o=f(n,["trainingDataset"]);o!=null&&g(e,["tuningTask","trainingData"],hM(o));const l=f(n,["config"]);return l!=null&&eM(l,e),e}function iM(n){const e={},t=f(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=f(n,["preTunedModel"]);s!=null&&g(e,["preTunedModel"],s);const o=f(n,["trainingDataset"]);o!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],mM(o,e));const l=f(n,["config"]);return l!=null&&tM(l,e),e}function sM(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function rM(n){const e={},t=f(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function oM(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=f(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),t}function aM(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const o=f(n,["pageToken"]);e!==void 0&&o!=null&&g(e,["_query","pageToken"],o);const l=f(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),t}function lM(n){const e={},t=f(n,["config"]);return t!=null&&oM(t,e),e}function uM(n){const e={},t=f(n,["config"]);return t!=null&&aM(t,e),e}function cM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>cS(c))),g(e,["tuningJobs"],l)}return e}function dM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const o=f(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(c=>$m(c))),g(e,["tuningJobs"],l)}return e}function fM(n){const e={},t=f(n,["name"]);t!=null&&g(e,["model"],t);const s=f(n,["name"]);return s!=null&&g(e,["endpoint"],s),e}function hM(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=f(n,["examples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>o)),g(e,["examples","examples"],s)}return e}function mM(n,e){const t={},s=f(n,["gcsUri"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],s);const o=f(n,["vertexDatasetResource"]);if(e!==void 0&&o!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],o),f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function cS(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["state"]);o!=null&&g(e,["state"],jE(o));const l=f(n,["createTime"]);l!=null&&g(e,["createTime"],l);const c=f(n,["tuningTask","startTime"]);c!=null&&g(e,["startTime"],c);const d=f(n,["tuningTask","completeTime"]);d!=null&&g(e,["endTime"],d);const p=f(n,["updateTime"]);p!=null&&g(e,["updateTime"],p);const h=f(n,["description"]);h!=null&&g(e,["description"],h);const T=f(n,["baseModel"]);T!=null&&g(e,["baseModel"],T);const E=f(n,["_self"]);E!=null&&g(e,["tunedModel"],fM(E));const A=f(n,["customBaseModel"]);A!=null&&g(e,["customBaseModel"],A);const I=f(n,["experiment"]);I!=null&&g(e,["experiment"],I);const k=f(n,["labels"]);k!=null&&g(e,["labels"],k);const B=f(n,["outputUri"]);B!=null&&g(e,["outputUri"],B);const F=f(n,["pipelineJob"]);F!=null&&g(e,["pipelineJob"],F);const Z=f(n,["serviceAccount"]);Z!=null&&g(e,["serviceAccount"],Z);const te=f(n,["tunedModelDisplayName"]);te!=null&&g(e,["tunedModelDisplayName"],te);const K=f(n,["veoTuningSpec"]);return K!=null&&g(e,["veoTuningSpec"],K),e}function $m(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["state"]);o!=null&&g(e,["state"],jE(o));const l=f(n,["createTime"]);l!=null&&g(e,["createTime"],l);const c=f(n,["startTime"]);c!=null&&g(e,["startTime"],c);const d=f(n,["endTime"]);d!=null&&g(e,["endTime"],d);const p=f(n,["updateTime"]);p!=null&&g(e,["updateTime"],p);const h=f(n,["error"]);h!=null&&g(e,["error"],h);const T=f(n,["description"]);T!=null&&g(e,["description"],T);const E=f(n,["baseModel"]);E!=null&&g(e,["baseModel"],E);const A=f(n,["tunedModel"]);A!=null&&g(e,["tunedModel"],A);const I=f(n,["preTunedModel"]);I!=null&&g(e,["preTunedModel"],I);const k=f(n,["supervisedTuningSpec"]);k!=null&&g(e,["supervisedTuningSpec"],k);const B=f(n,["tuningDataStats"]);B!=null&&g(e,["tuningDataStats"],B);const F=f(n,["encryptionSpec"]);F!=null&&g(e,["encryptionSpec"],F);const Z=f(n,["partnerModelTuningSpec"]);Z!=null&&g(e,["partnerModelTuningSpec"],Z);const te=f(n,["customBaseModel"]);te!=null&&g(e,["customBaseModel"],te);const K=f(n,["experiment"]);K!=null&&g(e,["experiment"],K);const Y=f(n,["labels"]);Y!=null&&g(e,["labels"],Y);const ae=f(n,["outputUri"]);ae!=null&&g(e,["outputUri"],ae);const ee=f(n,["pipelineJob"]);ee!=null&&g(e,["pipelineJob"],ee);const M=f(n,["serviceAccount"]);M!=null&&g(e,["serviceAccount"],M);const R=f(n,["tunedModelDisplayName"]);R!=null&&g(e,["tunedModelDisplayName"],R);const N=f(n,["veoTuningSpec"]);return N!=null&&g(e,["veoTuningSpec"],N),e}function pM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&g(e,["name"],s);const o=f(n,["metadata"]);o!=null&&g(e,["metadata"],o);const l=f(n,["done"]);l!=null&&g(e,["done"],l);const c=f(n,["error"]);return c!=null&&g(e,["error"],c),e}function gM(n,e){const t={},s=f(n,["gcsUri"]);s!=null&&g(t,["validationDatasetUri"],s);const o=f(n,["vertexDatasetResource"]);return e!==void 0&&o!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yM extends Eo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new vu(mo.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.tune=async t=>{var s;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((s=t.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:o});return l.baseModel=void 0,await this.tuneInternal(l)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),l=await this.tuneMldevInternal(o);let c="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?c=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(c=l.name.split("/operations/")[0]),{name:c,state:Hm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=rM(e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>$m(T))}else{const h=sM(e);return d=Se("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>cS(T))}}async listInternal(e){var t,s,o,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=uM(e);return d=Se("tuningJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=dM(T),A=new z0;return Object.assign(A,E),A})}else{const h=lM(e);return d=Se("tunedModels",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const A=E;return A.sdkHttpResponse={headers:T.headers},A})),c.then(T=>{const E=cM(T),A=new z0;return Object.assign(A,E),A})}}async cancel(e){var t,s,o,l;let c="",d={};if(this.apiClient.isVertexAI()){const p=Z1(e);c=Se("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const p=W1(e);c=Se("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=iM(e);return l=Se("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>$m(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let o,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=nM(e);return l=Se("tunedModels",d._url),c=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(p=>p.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:p.headers},T})),o.then(p=>pM(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _M{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const vM=1024*1024*8,TM=3,EM=1e3,SM=2,bm="x-goog-upload-status";async function AM(n,e,t){var s,o,l;let c=0,d=0,p=new zm(new Response),h="upload";for(c=n.size;d<c;){const E=Math.min(vM,c-d),A=n.slice(d,d+E);d+E>=c&&(h+=", finalize");let I=0,k=EM;for(;I<TM&&(p=await t.request({path:"",body:A,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(d),"Content-Length":String(E)}}}),!(!((s=p==null?void 0:p.headers)===null||s===void 0)&&s[bm]));)I++,await xM(k),k=k*SM;if(d+=E,((o=p==null?void 0:p.headers)===null||o===void 0?void 0:o[bm])!=="active")break;if(c<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(p==null?void 0:p.json());if(((l=p==null?void 0:p.headers)===null||l===void 0?void 0:l[bm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function bM(n){return{size:n.size,type:n.type}}function xM(n){return new Promise(e=>setTimeout(e,n))}class CM{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await AM(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await bM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IM{create(e,t,s){return new wM(e,t,s)}}class wM{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uT="x-goog-api-key";class RM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(uT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(uT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NM="gl-node/";class MM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=XC(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const o=new RM(this.apiKey);this.apiClient=new p1({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:NM+"web",uploader:new CM,downloader:new _M}),this.models=new k1(this.apiClient),this.live=new w1(this.apiClient,o,new IM),this.batches=new mw(this.apiClient),this.chats=new Yw(this.models,this.apiClient),this.caches=new zw(this.apiClient),this.files=new nR(this.apiClient),this.operations=new U1(this.apiClient),this.authTokens=new X1(this.apiClient),this.tunings=new yM(this.apiClient)}}const dS={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},Nt={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:Nt.app.environment,firebaseApiKey:Nt.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:Nt.firebase.authDomain||"❌ مفقود",firebaseProjectId:Nt.firebase.projectId||"❌ مفقود",firebaseStorageBucket:Nt.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:Nt.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:Nt.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(dS).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(dS).filter(n=>n.startsWith("VITE_")));const Ca=()=>{const n=[];return Nt.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),Nt.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),Nt.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),Nt.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),Nt.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),Nt.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!Nt.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=Ca();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Id;const DM=Nt.gemini.model,fS=()=>{if(Id)return;const n=Ca();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Id=new MM({apiKey:Nt.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},Tu={FINANCIAL_ANALYST:`You are an expert financial analyst assistant, "المحلل الذكي". You have full access to the user's financial data for a specific period. Your purpose is to provide detailed, insightful analysis and answer complex questions in Arabic based ONLY on the data provided for that period.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- Analyze the user's provided financial state (transactions, card details, bank balance, investments, installments) for the specified period to answer their query.
- Be thorough. Connect different parts of their financial data to give holistic answers.
- DO NOT just state data, INTERPRET it. Provide insights, identify trends, and offer observations.
- Be friendly, professional, and act as a true financial advisor.`,INVESTMENT_COACH:`You are an educational investment coach named "المستشار الذكي". Your primary role is to educate the user about investment concepts and strategies, particularly within the context of the Saudi stock market (Tadawul).
- You MUST NOT give direct financial advice. Do not recommend buying or selling specific stocks (e.g., "Buy Aramco").
- When asked for a recommendation, you MUST politely decline and instead explain HOW the user can research and make their own informed decisions.
- Your tone should be encouraging, educational, and responsible.
- Keep your answers clear, concise, and in Arabic.`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`},Eu=async(n,e,t=!1)=>{if(!Id)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Id.models.generateContent({model:DM,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(s){console.error("Gemini API Error:",s);let o="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw s instanceof Error&&"message"in s&&s.message.includes("403")&&(o="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(o)}},hS=(n,e)=>Eu(Tu.FINANCIAL_ANALYST,`User Query: "${n}"

Financial Data: ${JSON.stringify(e)}`),mS=(n,e,t,s)=>{const o=Object.keys(t),l=Object.keys(s);let c=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...o].map(p=>`'${p}'`).join(", ")}].
`;Object.values(s).forEach(p=>{const h=[p.name.split(" ")[0],...p.smsSamples||[]].filter(Boolean);h.length>0&&(c+=`  - If the text is a bank/mada transaction and contains any of these: '${h.join("', '")}', use '${p.id}'.
`)}),Object.values(t).forEach(p=>{const h=[p.name.split(" ")[0],...p.smsSamples||[]].filter(Boolean);h.length>0&&(c+=`  - If the text is a credit card transaction and contains any of these: '${h.join("', '")}', use '${p.id}'.
`)}),c+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const d=Tu.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",c);return Eu(d,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},pS=n=>Eu(Tu.INVESTMENT_COACH,n),Qm=n=>Eu(Tu.ICON_SUGGESTER,`Category: ${n}`),gS=(n,e,t)=>Eu(Tu.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),PM=Object.freeze(Object.defineProperty({__proto__:null,analyzeFinancialData:hS,analyzePastedText:mS,generateBudgetPlan:gS,generateInvestmentAdvice:pS,initializeAi:fS,suggestCategoryIcon:Qm},Symbol.toStringTag,{value:"Module"})),VM="modulepreload",kM=function(n){return"/fd/"+n},cT={},gs=function(e,t,s){let o=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(T=>Promise.resolve(T).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=c(t.map(h=>{if(h=kM(h),h in cT)return;cT[h]=!0;const T=h.endsWith(".css"),E=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${E}`))return;const A=document.createElement("link");if(A.rel=T?"stylesheet":VM,T||(A.as="script"),A.crossOrigin="",A.href=h,p&&A.setAttribute("nonce",p),document.head.appendChild(A),T)return new Promise((I,k)=>{A.addEventListener("load",I),A.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return o.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},UM=()=>{};var dT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},LM=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const o=n[t++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[s++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],c=n[t++],d=n[t++],p=((o&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const l=n[t++],c=n[t++];e[s++]=String.fromCharCode((o&15)<<12|(l&63)<<6|c&63)}}return e.join("")},_S={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<n.length;o+=3){const l=n[o],c=o+1<n.length,d=c?n[o+1]:0,p=o+2<n.length,h=p?n[o+2]:0,T=l>>2,E=(l&3)<<4|d>>4;let A=(d&15)<<2|h>>6,I=h&63;p||(I=64,c||(A=64)),s.push(t[T],t[E],t[A],t[I])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):LM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const h=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||d==null||h==null||E==null)throw new OM;const A=l<<2|d>>4;if(s.push(A),h!==64){const I=d<<4&240|h>>2;if(s.push(I),E!==64){const k=h<<6&192|E;s.push(k)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class OM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qM=function(n){const e=yS(n);return _S.encodeByteArray(e,!0)},wd=function(n){return qM(n).replace(/\./g,"")},vS=function(n){try{return _S.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM=()=>BM().__FIREBASE_DEFAULTS__,HM=()=>{if(typeof process>"u"||typeof dT>"u")return;const n=dT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&vS(n[1]);return e&&JSON.parse(e)},Wd=()=>{try{return UM()||FM()||HM()||zM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},TS=n=>{var e,t;return(t=(e=Wd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},GM=n=>{const e=TS(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},ES=()=>{var n;return(n=Wd())==null?void 0:n.config},SS=n=>{var e;return(e=Wd())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AS(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[wd(JSON.stringify(t)),wd(JSON.stringify(c)),""].join(".")}const ou={};function JM(){const n={prod:[],emulator:[]};for(const e of Object.keys(ou))ou[e]?n.emulator.push(e):n.prod.push(e);return n}function KM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let fT=!1;function bS(n,e){if(typeof window>"u"||typeof document>"u"||!za(window.location.host)||ou[n]===e||ou[n]||fT)return;ou[n]=e;function t(A){return`__firebase__banner__${A}`}const s="__firebase__banner",l=JM().prod.length>0;function c(){const A=document.getElementById(s);A&&A.remove()}function d(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function p(A,I){A.setAttribute("width","24"),A.setAttribute("id",I),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function h(){const A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{fT=!0,c()},A}function T(A,I){A.setAttribute("id",I),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function E(){const A=KM(s),I=t("text"),k=document.getElementById(I)||document.createElement("span"),B=t("learnmore"),F=document.getElementById(B)||document.createElement("a"),Z=t("preprendIcon"),te=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){const K=A.element;d(K),T(F,B);const Y=h();p(te,Z),K.append(te,k,F,Y),document.body.appendChild(K)}l?(k.innerText="Preview backend disconnected.",te.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(te.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $M(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function QM(){var e;const n=(e=Wd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WM(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ZM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eD(){const n=pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tD(){return!QM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nD(){try{return typeof indexedDB=="object"}catch{return!1}}function iD(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD="FirebaseError";class Vs extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=sD,Object.setPrototypeOf(this,Vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Su.prototype.create)}}class Su{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],c=l?rD(l,s):"Error",d=`${this.serviceName}: ${c} (${o}).`;return new Vs(o,d,s)}}function rD(n,e){return n.replace(oD,(t,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const oD=/\{\$([^}]+)}/g;function aD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function po(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const o of t){if(!s.includes(o))return!1;const l=n[o],c=e[o];if(hT(l)&&hT(c)){if(!po(l,c))return!1}else if(l!==c)return!1}for(const o of s)if(!t.includes(o))return!1;return!0}function hT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function eu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,l]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function tu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function lD(n,e){const t=new uD(n,e);return t.subscribe.bind(t)}class uD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let o;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");cD(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:s},o.next===void 0&&(o.next=xm),o.error===void 0&&(o.error=xm),o.complete===void 0&&(o.complete=xm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function xm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n){return n&&n._delegate?n._delegate:n}class go{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new jM;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hD(e))try{this.getOrInitializeService({instanceIdentifier:co})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});s.resolve(l)}catch{}}}}clearInstance(e=co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=co){return this.instances.has(e)}getOptions(e=co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);s===d&&c.resolve(o)}return o}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const l=this.instances.get(s);return l&&e(l,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const o of s)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:fD(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=co){return this.component?this.component.multipleInstances?e:co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fD(n){return n===co?void 0:n}function hD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(je||(je={}));const pD={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},gD=je.INFO,yD={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},_D=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),o=yD[e];if(o)console[o](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Np{constructor(e){this.name=e,this._logLevel=gD,this._logHandler=_D,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const vD=(n,e)=>e.some(t=>n instanceof t);let mT,pT;function TD(){return mT||(mT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ED(){return pT||(pT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xS=new WeakMap,Xm=new WeakMap,CS=new WeakMap,Cm=new WeakMap,Mp=new WeakMap;function SD(n){const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Er(n.result)),o()},c=()=>{s(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&xS.set(t,n)}).catch(()=>{}),Mp.set(e,n),e}function AD(n){if(Xm.has(n))return;const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),o()},c=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Xm.set(n,e)}let Wm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Xm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||CS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Er(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bD(n){Wm=n(Wm)}function xD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Im(this),e,...t);return CS.set(s,e.sort?e.sort():[e]),Er(s)}:ED().includes(n)?function(...e){return n.apply(Im(this),e),Er(xS.get(this))}:function(...e){return Er(n.apply(Im(this),e))}}function CD(n){return typeof n=="function"?xD(n):(n instanceof IDBTransaction&&AD(n),vD(n,TD())?new Proxy(n,Wm):n)}function Er(n){if(n instanceof IDBRequest)return SD(n);if(Cm.has(n))return Cm.get(n);const e=CD(n);return e!==n&&(Cm.set(n,e),Mp.set(e,n)),e}const Im=n=>Mp.get(n);function ID(n,e,{blocked:t,upgrade:s,blocking:o,terminated:l}={}){const c=indexedDB.open(n,e),d=Er(c);return s&&c.addEventListener("upgradeneeded",p=>{s(Er(c.result),p.oldVersion,p.newVersion,Er(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{l&&p.addEventListener("close",()=>l()),o&&p.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),d}const wD=["get","getKey","getAll","getAllKeys","count"],RD=["put","add","delete","clear"],wm=new Map;function gT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(wm.get(e))return wm.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,o=RD.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(o||wD.includes(t)))return;const l=async function(c,...d){const p=this.transaction(c,o?"readwrite":"readonly");let h=p.store;return s&&(h=h.index(d.shift())),(await Promise.all([h[t](...d),o&&p.done]))[0]};return wm.set(e,l),l}bD(n=>({...n,get:(e,t,s)=>gT(e,t)||n.get(e,t,s),has:(e,t)=>!!gT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(MD(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function MD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zm="@firebase/app",yT="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws=new Np("@firebase/app"),DD="@firebase/app-compat",PD="@firebase/analytics-compat",VD="@firebase/analytics",kD="@firebase/app-check-compat",UD="@firebase/app-check",LD="@firebase/auth",OD="@firebase/auth-compat",qD="@firebase/database",BD="@firebase/data-connect",FD="@firebase/database-compat",HD="@firebase/functions",zD="@firebase/functions-compat",GD="@firebase/installations",jD="@firebase/installations-compat",YD="@firebase/messaging",JD="@firebase/messaging-compat",KD="@firebase/performance",$D="@firebase/performance-compat",QD="@firebase/remote-config",XD="@firebase/remote-config-compat",WD="@firebase/storage",ZD="@firebase/storage-compat",e2="@firebase/firestore",t2="@firebase/ai",n2="@firebase/firestore-compat",i2="firebase",s2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="[DEFAULT]",r2={[Zm]:"fire-core",[DD]:"fire-core-compat",[VD]:"fire-analytics",[PD]:"fire-analytics-compat",[UD]:"fire-app-check",[kD]:"fire-app-check-compat",[LD]:"fire-auth",[OD]:"fire-auth-compat",[qD]:"fire-rtdb",[BD]:"fire-data-connect",[FD]:"fire-rtdb-compat",[HD]:"fire-fn",[zD]:"fire-fn-compat",[GD]:"fire-iid",[jD]:"fire-iid-compat",[YD]:"fire-fcm",[JD]:"fire-fcm-compat",[KD]:"fire-perf",[$D]:"fire-perf-compat",[QD]:"fire-rc",[XD]:"fire-rc-compat",[WD]:"fire-gcs",[ZD]:"fire-gcs-compat",[e2]:"fire-fst",[n2]:"fire-fst-compat",[t2]:"fire-vertex","fire-js":"fire-js",[i2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd=new Map,o2=new Map,tp=new Map;function _T(n,e){try{n.container.addComponent(e)}catch(t){ws.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ma(n){const e=n.name;if(tp.has(e))return ws.debug(`There were multiple attempts to register component ${e}.`),!1;tp.set(e,n);for(const t of Rd.values())_T(t,n);for(const t of o2.values())_T(t,n);return!0}function Dp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Xn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sr=new Su("app","Firebase",a2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=s2;function IS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:ep,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw Sr.create("bad-app-name",{appName:String(o)});if(t||(t=ES()),!t)throw Sr.create("no-options");const l=Rd.get(o);if(l){if(po(t,l.options)&&po(s,l.config))return l;throw Sr.create("duplicate-app",{appName:o})}const c=new mD(o);for(const p of tp.values())c.addComponent(p);const d=new l2(t,s,c);return Rd.set(o,d),d}function wS(n=ep){const e=Rd.get(n);if(!e&&n===ep&&ES())return IS();if(!e)throw Sr.create("no-app",{appName:n});return e}function Ar(n,e,t){let s=r2[n]??n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const c=[`Unable to register library "${s}" with version "${e}":`];o&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ws.warn(c.join(" "));return}Ma(new go(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="firebase-heartbeat-database",c2=1,hu="firebase-heartbeat-store";let Rm=null;function RS(){return Rm||(Rm=ID(u2,c2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(hu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Sr.create("idb-open",{originalErrorMessage:n.message})})),Rm}async function d2(n){try{const t=(await RS()).transaction(hu),s=await t.objectStore(hu).get(NS(n));return await t.done,s}catch(e){if(e instanceof Vs)ws.warn(e.message);else{const t=Sr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ws.warn(t.message)}}}async function vT(n,e){try{const s=(await RS()).transaction(hu,"readwrite");await s.objectStore(hu).put(e,NS(n)),await s.done}catch(t){if(t instanceof Vs)ws.warn(t.message);else{const s=Sr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ws.warn(s.message)}}}function NS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=1024,h2=30;class m2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new g2(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=TT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>h2){const c=y2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){ws.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=TT(),{heartbeatsToSend:s,unsentEntries:o}=p2(this._heartbeatsCache.heartbeats),l=wd(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return ws.warn(t),""}}}function TT(){return new Date().toISOString().substring(0,10)}function p2(n,e=f2){const t=[];let s=n.slice();for(const o of n){const l=t.find(c=>c.agent===o.agent);if(l){if(l.dates.push(o.date),ET(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),ET(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class g2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nD()?iD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await d2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return vT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return vT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ET(n){return wd(JSON.stringify({version:2,heartbeats:n})).length}function y2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2(n){Ma(new go("platform-logger",e=>new ND(e),"PRIVATE")),Ma(new go("heartbeat",e=>new m2(e),"PRIVATE")),Ar(Zm,yT,n),Ar(Zm,yT,"esm2020"),Ar("fire-js","")}_2("");var v2="firebase",T2="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar(v2,T2,"app");var ST=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var br,MS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(M,R){function N(){}N.prototype=R.prototype,M.F=R.prototype,M.prototype=new N,M.prototype.constructor=M,M.D=function(L,D,V){for(var P=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)P[Ve-2]=arguments[Ve];return R.prototype[D].apply(L,P)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(M,R,N){N||(N=0);const L=Array(16);if(typeof R=="string")for(var D=0;D<16;++D)L[D]=R.charCodeAt(N++)|R.charCodeAt(N++)<<8|R.charCodeAt(N++)<<16|R.charCodeAt(N++)<<24;else for(D=0;D<16;++D)L[D]=R[N++]|R[N++]<<8|R[N++]<<16|R[N++]<<24;R=M.g[0],N=M.g[1],D=M.g[2];let V=M.g[3],P;P=R+(V^N&(D^V))+L[0]+3614090360&4294967295,R=N+(P<<7&4294967295|P>>>25),P=V+(D^R&(N^D))+L[1]+3905402710&4294967295,V=R+(P<<12&4294967295|P>>>20),P=D+(N^V&(R^N))+L[2]+606105819&4294967295,D=V+(P<<17&4294967295|P>>>15),P=N+(R^D&(V^R))+L[3]+3250441966&4294967295,N=D+(P<<22&4294967295|P>>>10),P=R+(V^N&(D^V))+L[4]+4118548399&4294967295,R=N+(P<<7&4294967295|P>>>25),P=V+(D^R&(N^D))+L[5]+1200080426&4294967295,V=R+(P<<12&4294967295|P>>>20),P=D+(N^V&(R^N))+L[6]+2821735955&4294967295,D=V+(P<<17&4294967295|P>>>15),P=N+(R^D&(V^R))+L[7]+4249261313&4294967295,N=D+(P<<22&4294967295|P>>>10),P=R+(V^N&(D^V))+L[8]+1770035416&4294967295,R=N+(P<<7&4294967295|P>>>25),P=V+(D^R&(N^D))+L[9]+2336552879&4294967295,V=R+(P<<12&4294967295|P>>>20),P=D+(N^V&(R^N))+L[10]+4294925233&4294967295,D=V+(P<<17&4294967295|P>>>15),P=N+(R^D&(V^R))+L[11]+2304563134&4294967295,N=D+(P<<22&4294967295|P>>>10),P=R+(V^N&(D^V))+L[12]+1804603682&4294967295,R=N+(P<<7&4294967295|P>>>25),P=V+(D^R&(N^D))+L[13]+4254626195&4294967295,V=R+(P<<12&4294967295|P>>>20),P=D+(N^V&(R^N))+L[14]+2792965006&4294967295,D=V+(P<<17&4294967295|P>>>15),P=N+(R^D&(V^R))+L[15]+1236535329&4294967295,N=D+(P<<22&4294967295|P>>>10),P=R+(D^V&(N^D))+L[1]+4129170786&4294967295,R=N+(P<<5&4294967295|P>>>27),P=V+(N^D&(R^N))+L[6]+3225465664&4294967295,V=R+(P<<9&4294967295|P>>>23),P=D+(R^N&(V^R))+L[11]+643717713&4294967295,D=V+(P<<14&4294967295|P>>>18),P=N+(V^R&(D^V))+L[0]+3921069994&4294967295,N=D+(P<<20&4294967295|P>>>12),P=R+(D^V&(N^D))+L[5]+3593408605&4294967295,R=N+(P<<5&4294967295|P>>>27),P=V+(N^D&(R^N))+L[10]+38016083&4294967295,V=R+(P<<9&4294967295|P>>>23),P=D+(R^N&(V^R))+L[15]+3634488961&4294967295,D=V+(P<<14&4294967295|P>>>18),P=N+(V^R&(D^V))+L[4]+3889429448&4294967295,N=D+(P<<20&4294967295|P>>>12),P=R+(D^V&(N^D))+L[9]+568446438&4294967295,R=N+(P<<5&4294967295|P>>>27),P=V+(N^D&(R^N))+L[14]+3275163606&4294967295,V=R+(P<<9&4294967295|P>>>23),P=D+(R^N&(V^R))+L[3]+4107603335&4294967295,D=V+(P<<14&4294967295|P>>>18),P=N+(V^R&(D^V))+L[8]+1163531501&4294967295,N=D+(P<<20&4294967295|P>>>12),P=R+(D^V&(N^D))+L[13]+2850285829&4294967295,R=N+(P<<5&4294967295|P>>>27),P=V+(N^D&(R^N))+L[2]+4243563512&4294967295,V=R+(P<<9&4294967295|P>>>23),P=D+(R^N&(V^R))+L[7]+1735328473&4294967295,D=V+(P<<14&4294967295|P>>>18),P=N+(V^R&(D^V))+L[12]+2368359562&4294967295,N=D+(P<<20&4294967295|P>>>12),P=R+(N^D^V)+L[5]+4294588738&4294967295,R=N+(P<<4&4294967295|P>>>28),P=V+(R^N^D)+L[8]+2272392833&4294967295,V=R+(P<<11&4294967295|P>>>21),P=D+(V^R^N)+L[11]+1839030562&4294967295,D=V+(P<<16&4294967295|P>>>16),P=N+(D^V^R)+L[14]+4259657740&4294967295,N=D+(P<<23&4294967295|P>>>9),P=R+(N^D^V)+L[1]+2763975236&4294967295,R=N+(P<<4&4294967295|P>>>28),P=V+(R^N^D)+L[4]+1272893353&4294967295,V=R+(P<<11&4294967295|P>>>21),P=D+(V^R^N)+L[7]+4139469664&4294967295,D=V+(P<<16&4294967295|P>>>16),P=N+(D^V^R)+L[10]+3200236656&4294967295,N=D+(P<<23&4294967295|P>>>9),P=R+(N^D^V)+L[13]+681279174&4294967295,R=N+(P<<4&4294967295|P>>>28),P=V+(R^N^D)+L[0]+3936430074&4294967295,V=R+(P<<11&4294967295|P>>>21),P=D+(V^R^N)+L[3]+3572445317&4294967295,D=V+(P<<16&4294967295|P>>>16),P=N+(D^V^R)+L[6]+76029189&4294967295,N=D+(P<<23&4294967295|P>>>9),P=R+(N^D^V)+L[9]+3654602809&4294967295,R=N+(P<<4&4294967295|P>>>28),P=V+(R^N^D)+L[12]+3873151461&4294967295,V=R+(P<<11&4294967295|P>>>21),P=D+(V^R^N)+L[15]+530742520&4294967295,D=V+(P<<16&4294967295|P>>>16),P=N+(D^V^R)+L[2]+3299628645&4294967295,N=D+(P<<23&4294967295|P>>>9),P=R+(D^(N|~V))+L[0]+4096336452&4294967295,R=N+(P<<6&4294967295|P>>>26),P=V+(N^(R|~D))+L[7]+1126891415&4294967295,V=R+(P<<10&4294967295|P>>>22),P=D+(R^(V|~N))+L[14]+2878612391&4294967295,D=V+(P<<15&4294967295|P>>>17),P=N+(V^(D|~R))+L[5]+4237533241&4294967295,N=D+(P<<21&4294967295|P>>>11),P=R+(D^(N|~V))+L[12]+1700485571&4294967295,R=N+(P<<6&4294967295|P>>>26),P=V+(N^(R|~D))+L[3]+2399980690&4294967295,V=R+(P<<10&4294967295|P>>>22),P=D+(R^(V|~N))+L[10]+4293915773&4294967295,D=V+(P<<15&4294967295|P>>>17),P=N+(V^(D|~R))+L[1]+2240044497&4294967295,N=D+(P<<21&4294967295|P>>>11),P=R+(D^(N|~V))+L[8]+1873313359&4294967295,R=N+(P<<6&4294967295|P>>>26),P=V+(N^(R|~D))+L[15]+4264355552&4294967295,V=R+(P<<10&4294967295|P>>>22),P=D+(R^(V|~N))+L[6]+2734768916&4294967295,D=V+(P<<15&4294967295|P>>>17),P=N+(V^(D|~R))+L[13]+1309151649&4294967295,N=D+(P<<21&4294967295|P>>>11),P=R+(D^(N|~V))+L[4]+4149444226&4294967295,R=N+(P<<6&4294967295|P>>>26),P=V+(N^(R|~D))+L[11]+3174756917&4294967295,V=R+(P<<10&4294967295|P>>>22),P=D+(R^(V|~N))+L[2]+718787259&4294967295,D=V+(P<<15&4294967295|P>>>17),P=N+(V^(D|~R))+L[9]+3951481745&4294967295,M.g[0]=M.g[0]+R&4294967295,M.g[1]=M.g[1]+(D+(P<<21&4294967295|P>>>11))&4294967295,M.g[2]=M.g[2]+D&4294967295,M.g[3]=M.g[3]+V&4294967295}s.prototype.v=function(M,R){R===void 0&&(R=M.length);const N=R-this.blockSize,L=this.C;let D=this.h,V=0;for(;V<R;){if(D==0)for(;V<=N;)o(this,M,V),V+=this.blockSize;if(typeof M=="string"){for(;V<R;)if(L[D++]=M.charCodeAt(V++),D==this.blockSize){o(this,L),D=0;break}}else for(;V<R;)if(L[D++]=M[V++],D==this.blockSize){o(this,L),D=0;break}}this.h=D,this.o+=R},s.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var R=1;R<M.length-8;++R)M[R]=0;R=this.o*8;for(var N=M.length-8;N<M.length;++N)M[N]=R&255,R/=256;for(this.v(M),M=Array(16),R=0,N=0;N<4;++N)for(let L=0;L<32;L+=8)M[R++]=this.g[N]>>>L&255;return M};function l(M,R){var N=d;return Object.prototype.hasOwnProperty.call(N,M)?N[M]:N[M]=R(M)}function c(M,R){this.h=R;const N=[];let L=!0;for(let D=M.length-1;D>=0;D--){const V=M[D]|0;L&&V==R||(N[D]=V,L=!1)}this.g=N}var d={};function p(M){return-128<=M&&M<128?l(M,function(R){return new c([R|0],R<0?-1:0)}):new c([M|0],M<0?-1:0)}function h(M){if(isNaN(M)||!isFinite(M))return E;if(M<0)return F(h(-M));const R=[];let N=1;for(let L=0;M>=N;L++)R[L]=M/N|0,N*=4294967296;return new c(R,0)}function T(M,R){if(M.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(M.charAt(0)=="-")return F(T(M.substring(1),R));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=h(Math.pow(R,8));let L=E;for(let V=0;V<M.length;V+=8){var D=Math.min(8,M.length-V);const P=parseInt(M.substring(V,V+D),R);D<8?(D=h(Math.pow(R,D)),L=L.j(D).add(h(P))):(L=L.j(N),L=L.add(h(P)))}return L}var E=p(0),A=p(1),I=p(16777216);n=c.prototype,n.m=function(){if(B(this))return-F(this).m();let M=0,R=1;for(let N=0;N<this.g.length;N++){const L=this.i(N);M+=(L>=0?L:4294967296+L)*R,R*=4294967296}return M},n.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(k(this))return"0";if(B(this))return"-"+F(this).toString(M);const R=h(Math.pow(M,6));var N=this;let L="";for(;;){const D=Y(N,R).g;N=Z(N,D.j(R));let V=((N.g.length>0?N.g[0]:N.h)>>>0).toString(M);if(N=D,k(N))return V+L;for(;V.length<6;)V="0"+V;L=V+L}},n.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function k(M){if(M.h!=0)return!1;for(let R=0;R<M.g.length;R++)if(M.g[R]!=0)return!1;return!0}function B(M){return M.h==-1}n.l=function(M){return M=Z(this,M),B(M)?-1:k(M)?0:1};function F(M){const R=M.g.length,N=[];for(let L=0;L<R;L++)N[L]=~M.g[L];return new c(N,~M.h).add(A)}n.abs=function(){return B(this)?F(this):this},n.add=function(M){const R=Math.max(this.g.length,M.g.length),N=[];let L=0;for(let D=0;D<=R;D++){let V=L+(this.i(D)&65535)+(M.i(D)&65535),P=(V>>>16)+(this.i(D)>>>16)+(M.i(D)>>>16);L=P>>>16,V&=65535,P&=65535,N[D]=P<<16|V}return new c(N,N[N.length-1]&-2147483648?-1:0)};function Z(M,R){return M.add(F(R))}n.j=function(M){if(k(this)||k(M))return E;if(B(this))return B(M)?F(this).j(F(M)):F(F(this).j(M));if(B(M))return F(this.j(F(M)));if(this.l(I)<0&&M.l(I)<0)return h(this.m()*M.m());const R=this.g.length+M.g.length,N=[];for(var L=0;L<2*R;L++)N[L]=0;for(L=0;L<this.g.length;L++)for(let D=0;D<M.g.length;D++){const V=this.i(L)>>>16,P=this.i(L)&65535,Ve=M.i(D)>>>16,$e=M.i(D)&65535;N[2*L+2*D]+=P*$e,te(N,2*L+2*D),N[2*L+2*D+1]+=V*$e,te(N,2*L+2*D+1),N[2*L+2*D+1]+=P*Ve,te(N,2*L+2*D+1),N[2*L+2*D+2]+=V*Ve,te(N,2*L+2*D+2)}for(M=0;M<R;M++)N[M]=N[2*M+1]<<16|N[2*M];for(M=R;M<2*R;M++)N[M]=0;return new c(N,0)};function te(M,R){for(;(M[R]&65535)!=M[R];)M[R+1]+=M[R]>>>16,M[R]&=65535,R++}function K(M,R){this.g=M,this.h=R}function Y(M,R){if(k(R))throw Error("division by zero");if(k(M))return new K(E,E);if(B(M))return R=Y(F(M),R),new K(F(R.g),F(R.h));if(B(R))return R=Y(M,F(R)),new K(F(R.g),R.h);if(M.g.length>30){if(B(M)||B(R))throw Error("slowDivide_ only works with positive integers.");for(var N=A,L=R;L.l(M)<=0;)N=ae(N),L=ae(L);var D=ee(N,1),V=ee(L,1);for(L=ee(L,2),N=ee(N,2);!k(L);){var P=V.add(L);P.l(M)<=0&&(D=D.add(N),V=P),L=ee(L,1),N=ee(N,1)}return R=Z(M,D.j(R)),new K(D,R)}for(D=E;M.l(R)>=0;){for(N=Math.max(1,Math.floor(M.m()/R.m())),L=Math.ceil(Math.log(N)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),V=h(N),P=V.j(R);B(P)||P.l(M)>0;)N-=L,V=h(N),P=V.j(R);k(V)&&(V=A),D=D.add(V),M=Z(M,P)}return new K(D,M)}n.B=function(M){return Y(this,M).h},n.and=function(M){const R=Math.max(this.g.length,M.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)&M.i(L);return new c(N,this.h&M.h)},n.or=function(M){const R=Math.max(this.g.length,M.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)|M.i(L);return new c(N,this.h|M.h)},n.xor=function(M){const R=Math.max(this.g.length,M.g.length),N=[];for(let L=0;L<R;L++)N[L]=this.i(L)^M.i(L);return new c(N,this.h^M.h)};function ae(M){const R=M.g.length+1,N=[];for(let L=0;L<R;L++)N[L]=M.i(L)<<1|M.i(L-1)>>>31;return new c(N,M.h)}function ee(M,R){const N=R>>5;R%=32;const L=M.g.length-N,D=[];for(let V=0;V<L;V++)D[V]=R>0?M.i(V+N)>>>R|M.i(V+N+1)<<32-R:M.i(V+N);return new c(D,M.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,MS=s,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=h,c.fromString=T,br=c}).apply(typeof ST<"u"?ST:typeof self<"u"?self:typeof window<"u"?window:{});var od=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DS,nu,PS,pd,np,VS,kS,US;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof od=="object"&&od];for(var S=0;S<m.length;++S){var x=m[S];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var s=t(this);function o(m,S){if(S)e:{var x=s;m=m.split(".");for(var w=0;w<m.length-1;w++){var z=m[w];if(!(z in x))break e;x=x[z]}m=m[m.length-1],w=x[m],S=S(w),S!=w&&S!=null&&e(x,m,{configurable:!0,writable:!0,value:S})}}o("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(m){return m||function(S){var x=[],w;for(w in S)Object.prototype.hasOwnProperty.call(S,w)&&x.push([w,S[w]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(m){var S=typeof m;return S=="object"&&m!=null||S=="function"}function p(m,S,x){return m.call.apply(m.bind,arguments)}function h(m,S,x){return h=p,h.apply(null,arguments)}function T(m,S){var x=Array.prototype.slice.call(arguments,1);return function(){var w=x.slice();return w.push.apply(w,arguments),m.apply(this,w)}}function E(m,S){function x(){}x.prototype=S.prototype,m.Z=S.prototype,m.prototype=new x,m.prototype.constructor=m,m.Ob=function(w,z,$){for(var he=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)he[Le-2]=arguments[Le];return S.prototype[z].apply(w,he)}}var A=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function I(m){const S=m.length;if(S>0){const x=Array(S);for(let w=0;w<S;w++)x[w]=m[w];return x}return[]}function k(m,S){for(let w=1;w<arguments.length;w++){const z=arguments[w];var x=typeof z;if(x=x!="object"?x:z?Array.isArray(z)?"array":x:"null",x=="array"||x=="object"&&typeof z.length=="number"){x=m.length||0;const $=z.length||0;m.length=x+$;for(let he=0;he<$;he++)m[x+he]=z[he]}else m.push(z)}}class B{constructor(S,x){this.i=S,this.j=x,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function F(m){c.setTimeout(()=>{throw m},0)}function Z(){var m=M;let S=null;return m.g&&(S=m.g,m.g=m.g.next,m.g||(m.h=null),S.next=null),S}class te{constructor(){this.h=this.g=null}add(S,x){const w=K.get();w.set(S,x),this.h?this.h.next=w:this.g=w,this.h=w}}var K=new B(()=>new Y,m=>m.reset());class Y{constructor(){this.next=this.g=this.h=null}set(S,x){this.h=S,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,ee=!1,M=new te,R=()=>{const m=Promise.resolve(void 0);ae=()=>{m.then(N)}};function N(){for(var m;m=Z();){try{m.h.call(m.g)}catch(x){F(x)}var S=K;S.j(m),S.h<100&&(S.h++,m.next=S.g,S.g=m)}ee=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(m,S){this.type=m,this.g=this.target=S,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var V=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,S=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const x=()=>{};c.addEventListener("test",x,S),c.removeEventListener("test",x,S)}catch{}return m})();function P(m){return/^[\s\xa0]*$/.test(m)}function Ve(m,S){D.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,S)}E(Ve,D),Ve.prototype.init=function(m,S){const x=this.type=m.type,w=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=S,S=m.relatedTarget,S||(x=="mouseover"?S=m.fromElement:x=="mouseout"&&(S=m.toElement)),this.relatedTarget=S,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&Ve.Z.h.call(this)},Ve.prototype.h=function(){Ve.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var $e="closure_listenable_"+(Math.random()*1e6|0),X=0;function fe(m,S,x,w,z){this.listener=m,this.proxy=null,this.src=S,this.type=x,this.capture=!!w,this.ha=z,this.key=++X,this.da=this.fa=!1}function Ae(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function qe(m,S,x){for(const w in m)S.call(x,m[w],w,m)}function We(m,S){for(const x in m)S.call(void 0,m[x],x,m)}function q(m){const S={};for(const x in m)S[x]=m[x];return S}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(m,S){let x,w;for(let z=1;z<arguments.length;z++){w=arguments[z];for(x in w)m[x]=w[x];for(let $=0;$<se.length;$++)x=se[$],Object.prototype.hasOwnProperty.call(w,x)&&(m[x]=w[x])}}function ye(m){this.src=m,this.g={},this.h=0}ye.prototype.add=function(m,S,x,w,z){const $=m.toString();m=this.g[$],m||(m=this.g[$]=[],this.h++);const he=ce(m,S,w,z);return he>-1?(S=m[he],x||(S.fa=!1)):(S=new fe(S,this.src,$,!!w,z),S.fa=x,m.push(S)),S};function re(m,S){const x=S.type;if(x in m.g){var w=m.g[x],z=Array.prototype.indexOf.call(w,S,void 0),$;($=z>=0)&&Array.prototype.splice.call(w,z,1),$&&(Ae(S),m.g[x].length==0&&(delete m.g[x],m.h--))}}function ce(m,S,x,w){for(let z=0;z<m.length;++z){const $=m[z];if(!$.da&&$.listener==S&&$.capture==!!x&&$.ha==w)return z}return-1}var ve="closure_lm_"+(Math.random()*1e6|0),Qe={};function tt(m,S,x,w,z){if(Array.isArray(S)){for(let $=0;$<S.length;$++)tt(m,S[$],x,w,z);return null}return x=qs(x),m&&m[$e]?m.J(S,x,d(w)?!!w.capture:!1,z):vn(m,S,x,!1,w,z)}function vn(m,S,x,w,z,$){if(!S)throw Error("Invalid event type");const he=d(z)?!!z.capture:!!z;let Le=vi(m);if(Le||(m[ve]=Le=new ye(m)),x=Le.add(S,x,w,he,$),x.proxy)return x;if(w=xt(),x.proxy=w,w.src=m,w.listener=x,m.addEventListener)V||(z=he),z===void 0&&(z=!1),m.addEventListener(S.toString(),w,z);else if(m.attachEvent)m.attachEvent(wn(S.toString()),w);else if(m.addListener&&m.removeListener)m.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return x}function xt(){function m(x){return S.call(m.src,m.listener,x)}const S=Ls;return m}function _i(m,S,x,w,z){if(Array.isArray(S))for(var $=0;$<S.length;$++)_i(m,S[$],x,w,z);else w=d(w)?!!w.capture:!!w,x=qs(x),m&&m[$e]?(m=m.i,$=String(S).toString(),$ in m.g&&(S=m.g[$],x=ce(S,x,w,z),x>-1&&(Ae(S[x]),Array.prototype.splice.call(S,x,1),S.length==0&&(delete m.g[$],m.h--)))):m&&(m=vi(m))&&(S=m.g[S.toString()],m=-1,S&&(m=ce(S,x,w,z)),(x=m>-1?S[m]:null)&&Us(x))}function Us(m){if(typeof m!="number"&&m&&!m.da){var S=m.src;if(S&&S[$e])re(S.i,m);else{var x=m.type,w=m.proxy;S.removeEventListener?S.removeEventListener(x,w,m.capture):S.detachEvent?S.detachEvent(wn(x),w):S.addListener&&S.removeListener&&S.removeListener(w),(x=vi(S))?(re(x,m),x.h==0&&(x.src=null,S[ve]=null)):Ae(m)}}}function wn(m){return m in Qe?Qe[m]:Qe[m]="on"+m}function Ls(m,S){if(m.da)m=!0;else{S=new Ve(S,this);const x=m.listener,w=m.ha||m.src;m.fa&&Us(m),m=x.call(w,S)}return m}function vi(m){return m=m[ve],m instanceof ye?m:null}var Os="__closure_events_fn_"+(Math.random()*1e9>>>0);function qs(m){return typeof m=="function"?m:(m[Os]||(m[Os]=function(S){return m.handleEvent(S)}),m[Os])}function Q(){L.call(this),this.i=new ye(this),this.M=this,this.G=null}E(Q,L),Q.prototype[$e]=!0,Q.prototype.removeEventListener=function(m,S,x,w){_i(this,m,S,x,w)};function de(m,S){var x,w=m.G;if(w)for(x=[];w;w=w.G)x.push(w);if(m=m.M,w=S.type||S,typeof S=="string")S=new D(S,m);else if(S instanceof D)S.target=S.target||m;else{var z=S;S=new D(w,m),me(S,z)}z=!0;let $,he;if(x)for(he=x.length-1;he>=0;he--)$=S.g=x[he],z=ge($,w,!0,S)&&z;if($=S.g=m,z=ge($,w,!0,S)&&z,z=ge($,w,!1,S)&&z,x)for(he=0;he<x.length;he++)$=S.g=x[he],z=ge($,w,!1,S)&&z}Q.prototype.N=function(){if(Q.Z.N.call(this),this.i){var m=this.i;for(const S in m.g){const x=m.g[S];for(let w=0;w<x.length;w++)Ae(x[w]);delete m.g[S],m.h--}}this.G=null},Q.prototype.J=function(m,S,x,w){return this.i.add(String(m),S,!1,x,w)},Q.prototype.K=function(m,S,x,w){return this.i.add(String(m),S,!0,x,w)};function ge(m,S,x,w){if(S=m.i.g[String(S)],!S)return!0;S=S.concat();let z=!0;for(let $=0;$<S.length;++$){const he=S[$];if(he&&!he.da&&he.capture==x){const Le=he.listener,Mt=he.ha||he.src;he.fa&&re(m.i,he),z=Le.call(Mt,w)!==!1&&z}}return z&&!w.defaultPrevented}function Ce(m,S){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:c.setTimeout(m,S||0)}function Ze(m){m.g=Ce(()=>{m.g=null,m.i&&(m.i=!1,Ze(m))},m.l);const S=m.h;m.h=null,m.m.apply(null,S)}class gt extends L{constructor(S,x){super(),this.m=S,this.l=x,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Ze(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ti(m){L.call(this),this.h=m,this.g={}}E(Ti,L);var Bs=[];function kr(m){qe(m.g,function(S,x){this.g.hasOwnProperty(x)&&Us(S)},m),m.g={}}Ti.prototype.N=function(){Ti.Z.N.call(this),kr(this)},Ti.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ei=c.JSON.stringify,Qa=c.JSON.parse,wo=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function Te(){}function It(){}var kt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function dt(){D.call(this,"d")}E(dt,D);function Qt(){D.call(this,"c")}E(Qt,D);var De={},Vu=null;function Ro(){return Vu=Vu||new Q}De.Ia="serverreachability";function ku(m){D.call(this,De.Ia,m)}E(ku,D);function Si(m){const S=Ro();de(S,new ku(S))}De.STAT_EVENT="statevent";function Ur(m,S){D.call(this,De.STAT_EVENT,m),this.stat=S}E(Ur,D);function Ut(m){const S=Ro();de(S,new Ur(S,m))}De.Ja="timingevent";function Ai(m,S){D.call(this,De.Ja,m),this.size=S}E(Ai,D);function bi(m,S){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},S)}function ei(){this.g=!0}ei.prototype.ua=function(){this.g=!1};function Ef(m,S,x,w,z,$){m.info(function(){if(m.g)if($){var he="",Le=$.split("&");for(let rt=0;rt<Le.length;rt++){var Mt=Le[rt].split("=");if(Mt.length>1){const At=Mt[0];Mt=Mt[1];const Hn=At.split("_");he=Hn.length>=2&&Hn[1]=="type"?he+(At+"="+Mt+"&"):he+(At+"=redacted&")}}}else he=null;else he=$;return"XMLHTTP REQ ("+w+") [attempt "+z+"]: "+S+`
`+x+`
`+he})}function Uu(m,S,x,w,z,$,he){m.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+z+"]: "+S+`
`+x+`
`+$+" "+he})}function xi(m,S,x,w){m.info(function(){return"XMLHTTP TEXT ("+S+"): "+Sf(m,x)+(w?" "+w:"")})}function Lr(m,S){m.info(function(){return"TIMEOUT: "+S})}ei.prototype.info=function(){};function Sf(m,S){if(!m.g)return S;if(!S)return null;try{const $=JSON.parse(S);if($){for(m=0;m<$.length;m++)if(Array.isArray($[m])){var x=$[m];if(!(x.length<2)){var w=x[1];if(Array.isArray(w)&&!(w.length<1)){var z=w[0];if(z!="noop"&&z!="stop"&&z!="close")for(let he=1;he<w.length;he++)w[he]=""}}}}return Ei($)}catch{return S}}var Or={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Xa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Wa;function qr(){}E(qr,Te),qr.prototype.g=function(){return new XMLHttpRequest},Wa=new qr;function Xi(m){return encodeURIComponent(String(m))}function Lu(m){var S=1;m=m.split(":");const x=[];for(;S>0&&m.length;)x.push(m.shift()),S--;return m.length&&x.push(m.join(":")),x}function ti(m,S,x,w){this.j=m,this.i=S,this.l=x,this.S=w||1,this.V=new Ti(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ni}function ni(){this.i=null,this.g="",this.h=!1}var Lt={},Xt={};function Ci(m,S,x){m.M=1,m.A=Br(qt(S)),m.u=x,m.R=!0,No(m,null)}function No(m,S){m.F=Date.now(),Ii(m),m.B=qt(m.A);var x=m.B,w=m.S;Array.isArray(w)||(w=[String(w)]),Vo(x.i,"t",w),m.C=0,x=m.j.L,m.h=new ni,m.g=Wu(m.j,x?S:null,!m.u),m.P>0&&(m.O=new gt(h(m.Y,m,m.g),m.P)),S=m.V,x=m.g,w=m.ba;var z="readystatechange";Array.isArray(z)||(z&&(Bs[0]=z.toString()),z=Bs);for(let $=0;$<z.length;$++){const he=tt(x,z[$],w||S.handleEvent,!1,S.h||S);if(!he)break;S.g[he.key]=he}S=m.J?q(m.J):{},m.u?(m.v||(m.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,S)):(m.v="GET",m.g.ea(m.B,m.v,null,S)),Si(),Ef(m.i,m.v,m.B,m.l,m.S,m.u)}ti.prototype.ba=function(m){m=m.target;const S=this.O;S&&ri(m)==3?S.j():this.Y(m)},ti.prototype.Y=function(m){try{if(m==this.g)e:{const Le=ri(this.g),Mt=this.g.ya(),rt=this.g.ca();if(!(Le<3)&&(Le!=3||this.g&&(this.h.h||this.g.la()||sn(this.g)))){this.K||Le!=4||Mt==7||(Mt==8||rt<=0?Si(3):Si(2)),wi(this);var S=this.g.ca();this.X=S;var x=Af(this);if(this.o=S==200,Uu(this.i,this.v,this.B,this.l,this.S,Le,S),this.o){if(this.U&&!this.L){t:{if(this.g){var w,z=this.g;if((w=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(w)){var $=w;break t}}$=null}if(m=$)xi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ri(this,m);else{this.o=!1,this.m=3,Ut(12),Rn(this),qn(this);break e}}if(this.R){m=!0;let At;for(;!this.K&&this.C<x.length;)if(At=qu(this,x),At==Xt){Le==4&&(this.m=4,Ut(14),m=!1),xi(this.i,this.l,null,"[Incomplete Response]");break}else if(At==Lt){this.m=4,Ut(15),xi(this.i,this.l,x,"[Invalid Chunk]"),m=!1;break}else xi(this.i,this.l,At,null),Ri(this,At);if(Ou(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||x.length!=0||this.h.h||(this.m=1,Ut(16),m=!1),this.o=this.o&&m,!m)xi(this.i,this.l,x,"[Invalid Chunked Response]"),Rn(this),qn(this);else if(x.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),hl(he),he.P=!0,Ut(11))}}else xi(this.i,this.l,x,null),Ri(this,x);Le==4&&Rn(this),this.o&&!this.K&&(Le==4?Ku(this.j,this):(this.o=!1,Ii(this)))}else Zi(this.g),S==400&&x.indexOf("Unknown SID")>0?(this.m=3,Ut(12)):(this.m=0,Ut(13)),Rn(this),qn(this)}}}catch{}finally{}};function Af(m){if(!Ou(m))return m.g.la();const S=sn(m.g);if(S==="")return"";let x="";const w=S.length,z=ri(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Rn(m),qn(m),"";m.h.i=new c.TextDecoder}for(let $=0;$<w;$++)m.h.h=!0,x+=m.h.i.decode(S[$],{stream:!(z&&$==w-1)});return S.length=0,m.h.g+=x,m.C=0,m.h.g}function Ou(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function qu(m,S){var x=m.C,w=S.indexOf(`
`,x);return w==-1?Xt:(x=Number(S.substring(x,w)),isNaN(x)?Lt:(w+=1,w+x>S.length?Xt:(S=S.slice(w,w+x),m.C=w+x,S)))}ti.prototype.cancel=function(){this.K=!0,Rn(this)};function Ii(m){m.T=Date.now()+m.H,Mo(m,m.H)}function Mo(m,S){if(m.D!=null)throw Error("WatchDog timer not null");m.D=bi(h(m.aa,m),S)}function wi(m){m.D&&(c.clearTimeout(m.D),m.D=null)}ti.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(Lr(this.i,this.B),this.M!=2&&(Si(),Ut(17)),Rn(this),this.m=2,qn(this)):Mo(this,this.T-m)};function qn(m){m.j.I==0||m.K||Ku(m.j,m)}function Rn(m){wi(m);var S=m.O;S&&typeof S.dispose=="function"&&S.dispose(),m.O=null,kr(m.V),m.g&&(S=m.g,m.g=null,S.abort(),S.dispose())}function Ri(m,S){try{var x=m.j;if(x.I!=0&&(x.g==m||Mi(x.h,m))){if(!m.L&&Mi(x.h,m)&&x.I==3){try{var w=x.Ba.g.parse(S)}catch{w=null}if(Array.isArray(w)&&w.length==3){var z=w;if(z[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<m.F)qo(x),Ks(x);else break e;Jr(x),Ut(18)}}else x.xa=z[1],0<x.xa-x.K&&z[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=bi(h(x.Va,x),6e3));Ni(x.h)<=1&&x.ta&&(x.ta=void 0)}else Li(x,11)}else if((m.L||x.g==m)&&qo(x),!P(S))for(z=x.Ba.g.parse(S),S=0;S<z.length;S++){let rt=z[S];const At=rt[0];if(!(At<=x.K))if(x.K=At,rt=rt[1],x.I==2)if(rt[0]=="c"){x.M=rt[1],x.ba=rt[2];const Hn=rt[3];Hn!=null&&(x.ka=Hn,x.j.info("VER="+x.ka));const Oi=rt[4];Oi!=null&&(x.za=Oi,x.j.info("SVER="+x.za));const oi=rt[5];oi!=null&&typeof oi=="number"&&oi>0&&(w=1.5*oi,x.O=w,x.j.info("backChannelRequestTimeoutMs_="+w)),w=x;const ai=m.g;if(ai){const Kr=ai.g?ai.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Kr){var $=w.h;$.g||Kr.indexOf("spdy")==-1&&Kr.indexOf("quic")==-1&&Kr.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(tl($,$.h),$.h=null))}if(w.G){const Bo=ai.g?ai.g.getResponseHeader("X-HTTP-Session-Id"):null;Bo&&(w.wa=Bo,lt(w.J,w.G,Bo))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-m.F,x.j.info("Handshake RTT: "+x.T+"ms")),w=x;var he=m;if(w.na=Xu(w,w.L?w.ba:null,w.W),he.L){nl(w.h,he);var Le=he,Mt=w.O;Mt&&(Le.H=Mt),Le.D&&(wi(Le),Ii(Le)),w.g=he}else Yu(w);x.i.length>0&&Ui(x)}else rt[0]!="stop"&&rt[0]!="close"||Li(x,7);else x.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Li(x,7):dl(x):rt[0]!="noop"&&x.l&&x.l.qa(rt),x.A=0)}}Si(4)}catch{}}var Ot=class{constructor(m,S){this.g=m,this.map=S}};function Za(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function el(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Ni(m){return m.h?1:m.g?m.g.size:0}function Mi(m,S){return m.h?m.h==S:m.g?m.g.has(S):!1}function tl(m,S){m.g?m.g.add(S):m.h=S}function nl(m,S){m.h&&m.h==S?m.h=null:m.g&&m.g.has(S)&&m.g.delete(S)}Za.prototype.cancel=function(){if(this.i=il(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function il(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let S=m.i;for(const x of m.g.values())S=S.concat(x.G);return S}return I(m.i)}var Bu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Do(m,S){if(m){m=m.split("&");for(let x=0;x<m.length;x++){const w=m[x].indexOf("=");let z,$=null;w>=0?(z=m[x].substring(0,w),$=m[x].substring(w+1)):z=m[x],S(z,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function Nn(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;m instanceof Nn?(this.l=m.l,Wt(this,m.j),this.o=m.o,this.g=m.g,Fs(this,m.u),this.h=m.h,sl(this,Gu(m.i)),this.m=m.m):m&&(S=String(m).match(Bu))?(this.l=!1,Wt(this,S[1]||"",!0),this.o=Di(S[2]||""),this.g=Di(S[3]||"",!0),Fs(this,S[4]),this.h=Di(S[5]||"",!0),sl(this,S[6]||"",!0),this.m=Di(S[7]||"")):(this.l=!1,this.i=new zs(null,this.l))}Nn.prototype.toString=function(){const m=[];var S=this.j;S&&m.push(Fr(S,Po,!0),":");var x=this.g;return(x||S=="file")&&(m.push("//"),(S=this.o)&&m.push(Fr(S,Po,!0),"@"),m.push(Xi(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&m.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&m.push("/"),m.push(Fr(x,x.charAt(0)=="/"?rl:Fu,!0))),(x=this.i.toString())&&m.push("?",x),(x=this.m)&&m.push("#",Fr(x,Hu)),m.join("")},Nn.prototype.resolve=function(m){const S=qt(this);let x=!!m.j;x?Wt(S,m.j):x=!!m.o,x?S.o=m.o:x=!!m.g,x?S.g=m.g:x=m.u!=null;var w=m.h;if(x)Fs(S,m.u);else if(x=!!m.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var z=S.h.lastIndexOf("/");z!=-1&&(w=S.h.slice(0,z+1)+w)}if(z=w,z==".."||z==".")w="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){w=z.lastIndexOf("/",0)==0,z=z.split("/");const $=[];for(let he=0;he<z.length;){const Le=z[he++];Le=="."?w&&he==z.length&&$.push(""):Le==".."?(($.length>1||$.length==1&&$[0]!="")&&$.pop(),w&&he==z.length&&$.push("")):($.push(Le),w=!0)}w=$.join("/")}else w=z}return x?S.h=w:x=m.i.toString()!=="",x?sl(S,Gu(m.i)):x=!!m.m,x&&(S.m=m.m),S};function qt(m){return new Nn(m)}function Wt(m,S,x){m.j=x?Di(S,!0):S,m.j&&(m.j=m.j.replace(/:$/,""))}function Fs(m,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);m.u=S}else m.u=null}function sl(m,S,x){S instanceof zs?(m.i=S,ko(m.i,m.l)):(x||(S=Fr(S,Hs)),m.i=new zs(S,m.l))}function lt(m,S,x){m.i.set(S,x)}function Br(m){return lt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Di(m,S){return m?S?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Fr(m,S,x){return typeof m=="string"?(m=encodeURI(m).replace(S,Tn),x&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Tn(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Po=/[#\/\?@]/g,Fu=/[#\?:]/g,rl=/[#\?]/g,Hs=/[#\?@]/g,Hu=/#/g;function zs(m,S){this.h=this.g=null,this.i=m||null,this.j=!!S}function En(m){m.g||(m.g=new Map,m.h=0,m.i&&Do(m.i,function(S,x){m.add(decodeURIComponent(S.replace(/\+/g," ")),x)}))}n=zs.prototype,n.add=function(m,S){En(this),this.i=null,m=Gs(this,m);let x=this.g.get(m);return x||this.g.set(m,x=[]),x.push(S),this.h+=1,this};function zu(m,S){En(m),S=Gs(m,S),m.g.has(S)&&(m.i=null,m.h-=m.g.get(S).length,m.g.delete(S))}function ol(m,S){return En(m),S=Gs(m,S),m.g.has(S)}n.forEach=function(m,S){En(this),this.g.forEach(function(x,w){x.forEach(function(z){m.call(S,z,w,this)},this)},this)};function al(m,S){En(m);let x=[];if(typeof S=="string")ol(m,S)&&(x=x.concat(m.g.get(Gs(m,S))));else for(m=Array.from(m.g.values()),S=0;S<m.length;S++)x=x.concat(m[S]);return x}n.set=function(m,S){return En(this),this.i=null,m=Gs(this,m),ol(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[S]),this.h+=1,this},n.get=function(m,S){return m?(m=al(this,m),m.length>0?String(m[0]):S):S};function Vo(m,S,x){zu(m,S),x.length>0&&(m.i=null,m.g.set(Gs(m,S),I(x)),m.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],S=Array.from(this.g.keys());for(let w=0;w<S.length;w++){var x=S[w];const z=Xi(x);x=al(this,x);for(let $=0;$<x.length;$++){let he=z;x[$]!==""&&(he+="="+Xi(x[$])),m.push(he)}}return this.i=m.join("&")};function Gu(m){const S=new zs;return S.i=m.i,m.g&&(S.g=new Map(m.g),S.h=m.h),S}function Gs(m,S){return S=String(S),m.j&&(S=S.toLowerCase()),S}function ko(m,S){S&&!m.j&&(En(m),m.i=null,m.g.forEach(function(x,w){const z=w.toLowerCase();w!=z&&(zu(this,w),Vo(this,z,x))},m)),m.j=S}function ii(m,S){const x=new ei;if(c.Image){const w=new Image;w.onload=T(Bn,x,"TestLoadImage: loaded",!0,S,w),w.onerror=T(Bn,x,"TestLoadImage: error",!1,S,w),w.onabort=T(Bn,x,"TestLoadImage: abort",!1,S,w),w.ontimeout=T(Bn,x,"TestLoadImage: timeout",!1,S,w),c.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=m}else S(!1)}function ll(m,S){const x=new ei,w=new AbortController,z=setTimeout(()=>{w.abort(),Bn(x,"TestPingServer: timeout",!1,S)},1e4);fetch(m,{signal:w.signal}).then($=>{clearTimeout(z),$.ok?Bn(x,"TestPingServer: ok",!0,S):Bn(x,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(z),Bn(x,"TestPingServer: error",!1,S)})}function Bn(m,S,x,w,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),w(x)}catch{}}function js(){this.g=new wo}function Pi(m){this.i=m.Sb||null,this.h=m.ab||!1}E(Pi,Te),Pi.prototype.g=function(){return new Hr(this.i,this.h)};function Hr(m,S){Q.call(this),this.H=m,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(Hr,Q),n=Hr.prototype,n.open=function(m,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=S,this.readyState=1,si(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(S.body=m),(this.H||c).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ys(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,si(this)),this.g&&(this.readyState=3,si(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Uo(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function Uo(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var S=m.value?m.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!m.done}))&&(this.response=this.responseText+=S)}m.done?Ys(this):si(this),this.readyState==3&&Uo(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,Ys(this))},n.Na=function(m){this.g&&(this.response=m,Ys(this))},n.ga=function(){this.g&&Ys(this)};function Ys(m){m.readyState=4,m.l=null,m.j=null,m.B=null,si(m)}n.setRequestHeader=function(m,S){this.A.append(m,S)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],S=this.h.entries();for(var x=S.next();!x.done;)x=x.value,m.push(x[0]+": "+x[1]),x=S.next();return m.join(`\r
`)};function si(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Hr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Fn(m){let S="";return qe(m,function(x,w){S+=w,S+=":",S+=x,S+=`\r
`}),S}function zr(m,S,x){e:{for(w in x){var w=!1;break e}w=!0}w||(x=Fn(x),typeof m=="string"?x!=null&&Xi(x):lt(m,S,x))}function ft(m){Q.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(ft,Q);var Vi=/^https?$/i,ul=["POST","PUT"];n=ft.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,S,x,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);S=S?S.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Wa.g(),this.g.onreadystatechange=A(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(m),!0),this.B=!1}catch($){Gr(this,$);return}if(m=x||"",x=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var z in w)x.set(z,w[z]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const $ of w.keys())x.set($,w.get($));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),z=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(ul,S,void 0)>=0)||w||z||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,he]of x)this.g.setRequestHeader($,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch($){Gr(this,$)}};function Gr(m,S){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=S,m.o=5,cl(m),Wi(m)}function cl(m){m.A||(m.A=!0,de(m,"complete"),de(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,de(this,"complete"),de(this,"abort"),Wi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wi(this,!0)),ft.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?jr(this):this.Xa())},n.Xa=function(){jr(this)};function jr(m){if(m.h&&typeof l<"u"){if(m.v&&ri(m)==4)setTimeout(m.Ca.bind(m),0);else if(de(m,"readystatechange"),ri(m)==4){m.h=!1;try{const $=m.ca();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var x;if(!(x=S)){var w;if(w=$===0){let he=String(m.D).match(Bu)[1]||null;!he&&c.self&&c.self.location&&(he=c.self.location.protocol.slice(0,-1)),w=!Vi.test(he?he.toLowerCase():"")}x=w}if(x)de(m,"complete"),de(m,"success");else{m.o=6;try{var z=ri(m)>2?m.g.statusText:""}catch{z=""}m.l=z+" ["+m.ca()+"]",cl(m)}}finally{Wi(m)}}}}function Wi(m,S){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const x=m.g;m.g=null,S||de(m,"ready");try{x.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ri(m){return m.g?m.g.readyState:0}n.ca=function(){try{return ri(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var S=this.g.responseText;return m&&S.indexOf(m)==0&&(S=S.substring(m.length)),Qa(S)}};function sn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Zi(m){const S={};m=(m.g&&ri(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<m.length;w++){if(P(m[w]))continue;var x=Lu(m[w]);const z=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=S[z]||[];S[z]=$,$.push(x)}We(S,function(w){return w.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(m,S,x){return x&&x.internalChannelParams&&x.internalChannelParams[m]||S}function Js(m){this.za=0,this.i=[],this.j=new ei,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ki("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ki("baseRetryDelayMs",5e3,m),this.Za=ki("retryDelaySeedMs",1e4,m),this.Ta=ki("forwardChannelMaxRetries",2,m),this.va=ki("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Za(m&&m.concurrentRequestLimit),this.Ba=new js,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Js.prototype,n.ka=8,n.I=1,n.connect=function(m,S,x,w){Ut(0),this.W=m,this.H=S||{},x&&w!==void 0&&(this.H.OSID=x,this.H.OAID=w),this.F=this.X,this.J=Xu(this,null,this.W),Ui(this)};function dl(m){if(Lo(m),m.I==3){var S=m.V++,x=qt(m.J);if(lt(x,"SID",m.M),lt(x,"RID",S),lt(x,"TYPE","terminate"),Yr(m,x),S=new ti(m,m.j,S),S.M=2,S.A=Br(qt(x)),x=!1,c.navigator&&c.navigator.sendBeacon)try{x=c.navigator.sendBeacon(S.A.toString(),"")}catch{}!x&&c.Image&&(new Image().src=S.A,x=!0),x||(S.g=Wu(S.j,null),S.g.ea(S.A)),S.F=Date.now(),Ii(S)}Qu(m)}function Ks(m){m.g&&(hl(m),m.g.cancel(),m.g=null)}function Lo(m){Ks(m),m.v&&(c.clearTimeout(m.v),m.v=null),qo(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function Ui(m){if(!el(m.h)&&!m.m){m.m=!0;var S=m.Ea;ae||R(),ee||(ae(),ee=!0),M.add(S,m),m.D=0}}function Oo(m,S){return Ni(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=S.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=bi(h(m.Ea,m,S),$u(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const z=new ti(this,this.j,m);let $=this.o;if(this.U&&($?($=q($),me($,this.U)):$=this.U),this.u!==null||this.R||(z.J=$,$=null),this.S)e:{for(var S=0,x=0;x<this.i.length;x++){t:{var w=this.i[x];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(S+=w,S>4096){S=x;break e}if(S===4096||x===this.i.length-1){S=x+1;break e}}S=1e3}else S=1e3;S=ju(this,z,S),x=qt(this.J),lt(x,"RID",m),lt(x,"CVER",22),this.G&&lt(x,"X-HTTP-Session-Id",this.G),Yr(this,x),$&&(this.R?S="headers="+Xi(Fn($))+"&"+S:this.u&&zr(x,this.u,$)),tl(this.h,z),this.Ra&&lt(x,"TYPE","init"),this.S?(lt(x,"$req",S),lt(x,"SID","null"),z.U=!0,Ci(z,x,null)):Ci(z,x,S),this.I=2}}else this.I==3&&(m?fl(this,m):this.i.length==0||el(this.h)||fl(this))};function fl(m,S){var x;S?x=S.l:x=m.V++;const w=qt(m.J);lt(w,"SID",m.M),lt(w,"RID",x),lt(w,"AID",m.K),Yr(m,w),m.u&&m.o&&zr(w,m.u,m.o),x=new ti(m,m.j,x,m.D+1),m.u===null&&(x.J=m.o),S&&(m.i=S.G.concat(m.i)),S=ju(m,x,1e3),x.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),tl(m.h,x),Ci(x,w,S)}function Yr(m,S){m.H&&qe(m.H,function(x,w){lt(S,w,x)}),m.l&&qe({},function(x,w){lt(S,w,x)})}function ju(m,S,x){x=Math.min(m.i.length,x);const w=m.l?h(m.l.Ka,m.l,m):null;e:{var z=m.i;let Le=-1;for(;;){const Mt=["count="+x];Le==-1?x>0?(Le=z[0].g,Mt.push("ofs="+Le)):Le=0:Mt.push("ofs="+Le);let rt=!0;for(let At=0;At<x;At++){var $=z[At].g;const Hn=z[At].map;if($-=Le,$<0)Le=Math.max(0,z[At].g-100),rt=!1;else try{$="req"+$+"_"||"";try{var he=Hn instanceof Map?Hn:Object.entries(Hn);for(const[Oi,oi]of he){let ai=oi;d(oi)&&(ai=Ei(oi)),Mt.push($+Oi+"="+encodeURIComponent(ai))}}catch(Oi){throw Mt.push($+"type="+encodeURIComponent("_badmap")),Oi}}catch{w&&w(Hn)}}if(rt){he=Mt.join("&");break e}}he=void 0}return m=m.i.splice(0,x),S.G=m,he}function Yu(m){if(!m.g&&!m.v){m.Y=1;var S=m.Da;ae||R(),ee||(ae(),ee=!0),M.add(S,m),m.A=0}}function Jr(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=bi(h(m.Da,m),$u(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,Ju(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=bi(h(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ut(10),Ks(this),Ju(this))};function hl(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function Ju(m){m.g=new ti(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var S=qt(m.na);lt(S,"RID","rpc"),lt(S,"SID",m.M),lt(S,"AID",m.K),lt(S,"CI",m.F?"0":"1"),!m.F&&m.ia&&lt(S,"TO",m.ia),lt(S,"TYPE","xmlhttp"),Yr(m,S),m.u&&m.o&&zr(S,m.u,m.o),m.O&&(m.g.H=m.O);var x=m.g;m=m.ba,x.M=1,x.A=Br(qt(S)),x.u=null,x.R=!0,No(x,m)}n.Va=function(){this.C!=null&&(this.C=null,Ks(this),Jr(this),Ut(19))};function qo(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function Ku(m,S){var x=null;if(m.g==S){qo(m),hl(m),m.g=null;var w=2}else if(Mi(m.h,S))x=S.G,nl(m.h,S),w=1;else return;if(m.I!=0){if(S.o)if(w==1){x=S.u?S.u.length:0,S=Date.now()-S.F;var z=m.D;w=Ro(),de(w,new Ai(w,x)),Ui(m)}else Yu(m);else if(z=S.m,z==3||z==0&&S.X>0||!(w==1&&Oo(m,S)||w==2&&Jr(m)))switch(x&&x.length>0&&(S=m.h,S.i=S.i.concat(x)),z){case 1:Li(m,5);break;case 4:Li(m,10);break;case 3:Li(m,6);break;default:Li(m,2)}}}function $u(m,S){let x=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(x*=2),x*S}function Li(m,S){if(m.j.info("Error code "+S),S==2){var x=h(m.bb,m),w=m.Ua;const z=!w;w=new Nn(w||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Wt(w,"https"),Br(w),z?ii(w.toString(),x):ll(w.toString(),x)}else Ut(2);m.I=0,m.l&&m.l.pa(S),Qu(m),Lo(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function Qu(m){if(m.I=0,m.ja=[],m.l){const S=il(m.h);(S.length!=0||m.i.length!=0)&&(k(m.ja,S),k(m.ja,m.i),m.h.i.length=0,I(m.i),m.i.length=0),m.l.oa()}}function Xu(m,S,x){var w=x instanceof Nn?qt(x):new Nn(x);if(w.g!="")S&&(w.g=S+"."+w.g),Fs(w,w.u);else{var z=c.location;w=z.protocol,S=S?S+"."+z.hostname:z.hostname,z=+z.port;const $=new Nn(null);w&&Wt($,w),S&&($.g=S),z&&Fs($,z),x&&($.h=x),w=$}return x=m.G,S=m.wa,x&&S&&lt(w,x,S),lt(w,"VER",m.ka),Yr(m,w),w}function Wu(m,S,x){if(S&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=m.Aa&&!m.ma?new ft(new Pi({ab:x})):new ft(m.ma),S.Fa(m.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}n=Zu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $s(){}$s.prototype.g=function(m,S){return new gn(m,S)};function gn(m,S){Q.call(this),this.g=new Js(S),this.l=m,this.h=S&&S.messageUrlParams||null,m=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(m?m["X-WebChannel-Content-Type"]=S.messageContentType:m={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(m?m["X-WebChannel-Client-Profile"]=S.sa:m={"X-WebChannel-Client-Profile":S.sa}),this.g.U=m,(m=S&&S.Qb)&&!P(m)&&(this.g.u=m),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!P(S)&&(this.g.G=S,m=this.h,m!==null&&S in m&&(m=this.h,S in m&&delete m[S])),this.j=new es(this)}E(gn,Q),gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){dl(this.g)},gn.prototype.o=function(m){var S=this.g;if(typeof m=="string"){var x={};x.__data__=m,m=x}else this.v&&(x={},x.__data__=Ei(m),m=x);S.i.push(new Ot(S.Ya++,m)),S.I==3&&Ui(S)},gn.prototype.N=function(){this.g.l=null,delete this.j,dl(this.g),delete this.g,gn.Z.N.call(this)};function ec(m){dt.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var S=m.__sm__;if(S){e:{for(const x in S){m=x;break e}m=void 0}(this.i=m)&&(m=this.i,S=S!==null&&m in S?S[m]:void 0),this.data=S}else this.data=m}E(ec,dt);function tc(){Qt.call(this),this.status=1}E(tc,Qt);function es(m){this.g=m}E(es,Zu),es.prototype.ra=function(){de(this.g,"a")},es.prototype.qa=function(m){de(this.g,new ec(m))},es.prototype.pa=function(m){de(this.g,new tc)},es.prototype.oa=function(){de(this.g,"b")},$s.prototype.createWebChannel=$s.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,US=function(){return new $s},kS=function(){return Ro()},VS=De,np={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Or.NO_ERROR=0,Or.TIMEOUT=8,Or.HTTP_ERROR=6,pd=Or,Xa.COMPLETE="complete",PS=Xa,It.EventType=kt,kt.OPEN="a",kt.CLOSE="b",kt.ERROR="c",kt.MESSAGE="d",Q.prototype.listen=Q.prototype.J,nu=It,ft.prototype.listenOnce=ft.prototype.K,ft.prototype.getLastError=ft.prototype.Ha,ft.prototype.getLastErrorCode=ft.prototype.ya,ft.prototype.getStatus=ft.prototype.ca,ft.prototype.getResponseJson=ft.prototype.La,ft.prototype.getResponseText=ft.prototype.la,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Fa,DS=ft}).apply(typeof od<"u"?od:typeof self<"u"?self:typeof window<"u"?window:{});const AT="@firebase/firestore",bT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ja="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo=new Np("@firebase/firestore");function ga(){return yo.logLevel}function _e(n,...e){if(yo.logLevel<=je.DEBUG){const t=e.map(Pp);yo.debug(`Firestore (${ja}): ${n}`,...t)}}function Rs(n,...e){if(yo.logLevel<=je.ERROR){const t=e.map(Pp);yo.error(`Firestore (${ja}): ${n}`,...t)}}function _o(n,...e){if(yo.logLevel<=je.WARN){const t=e.map(Pp);yo.warn(`Firestore (${ja}): ${n}`,...t)}}function Pp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,LS(n,s,t)}function LS(n,e,t){let s=`FIRESTORE (${ja}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Rs(s),new Error(s)}function at(n,e,t,s){let o="Unexpected state";typeof t=="string"?o=t:s=t,n||LS(e,o,s)}function Ue(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class be extends Vs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class qS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class E2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class S2{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){at(this.o===void 0,42304);let s=this.i;const o=p=>this.i!==s?(s=this.i,t(p)):Promise.resolve();let l=new xs;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new xs,e.enqueueRetryable((()=>o(this.currentUser)))};const c=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},d=p=>{_e("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(_e("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new xs)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(_e("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(at(typeof s.accessToken=="string",31837,{l:s}),new OS(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class A2{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class b2{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new A2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class xT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class x2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Xn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){at(this.o===void 0,3512);const s=l=>{l.error!=null&&_e("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,_e("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const o=l=>{_e("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):_e("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new xT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(at(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new xT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=C2(40);for(let l=0;l<o.length;++l)s.length<20&&o[l]<t&&(s+=e.charAt(o[l]%62))}return s}}function Ye(n,e){return n<e?-1:n>e?1:0}function ip(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const o=n.charAt(s),l=e.charAt(s);if(o!==l)return Nm(o)===Nm(l)?Ye(o,l):Nm(o)?1:-1}return Ye(n.length,e.length)}const I2=55296,w2=57343;function Nm(n){const e=n.charCodeAt(0);return e>=I2&&e<=w2}function Da(n,e,t){return n.length===e.length&&n.every(((s,o)=>t(s,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="__name__";class zi{constructor(e,t,s){t===void 0?t=0:t>e.length&&Me(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Me(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return zi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zi?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let o=0;o<s;o++){const l=zi.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return Ye(e.length,t.length)}static compareSegments(e,t){const s=zi.isNumericId(e),o=zi.isNumericId(t);return s&&!o?-1:!s&&o?1:s&&o?zi.extractNumericId(e).compare(zi.extractNumericId(t)):ip(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return br.fromString(e.substring(4,e.length-2))}}class St extends zi{construct(e,t,s){return new St(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new be(ue.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((o=>o.length>0)))}return new St(t)}static emptyPath(){return new St([])}}const R2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends zi{construct(e,t,s){return new tn(e,t,s)}static isValidIdentifier(e){return R2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CT}static keyField(){return new tn([CT])}static fromServerFormat(e){const t=[];let s="",o=0;const l=()=>{if(s.length===0)throw new be(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let c=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new be(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new be(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,o+=2}else d==="`"?(c=!c,o++):d!=="."||c?(s+=d,o++):(l(),o++)}if(l(),c)throw new be(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(t)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(St.fromString(e))}static fromName(e){return new we(St.fromString(e).popFirst(5))}static empty(){return new we(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&St.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return St.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new St(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(n,e,t){if(!t)throw new be(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FS(n,e,t,s){if(e===!0&&s===!0)throw new be(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function IT(n){if(!we.isDocumentKey(n))throw new be(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function wT(n){if(we.isDocumentKey(n))throw new be(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function HS(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Me(12329,{type:typeof n})}function Ns(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new be(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Vp(n);throw new be(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(n,e){const t={typeString:n};return e&&(t.value=e),t}function bu(n,e){if(!HS(n))throw new be(ue.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const o=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const c=n[s];if(o&&typeof c!==o){t=`JSON field '${s}' must be a ${o}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new be(ue.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=-62135596800,NT=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*NT);return new _t(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new be(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new be(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<RT)throw new be(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new be(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/NT}_compareTo(e){return this.seconds===e.seconds?Ye(this.nanoseconds,e.nanoseconds):Ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bu(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-RT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:jt("string",_t._jsonSchemaVersion),seconds:jt("number"),nanoseconds:jt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new _t(0,0))}static max(){return new Pe(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=-1;function N2(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,o=Pe.fromTimestamp(s===1e9?new _t(t+1,0):new _t(t,s));return new Cr(o,we.empty(),e)}function M2(n){return new Cr(n.readTime,n.key,mu)}class Cr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Cr(Pe.min(),we.empty(),mu)}static max(){return new Cr(Pe.max(),we.empty(),mu)}}function D2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:Ye(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ya(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==P2)throw n;_e("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((s,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,s)=>{t(e)}))}static reject(e){return new le(((t,s)=>{s(e)}))}static waitFor(e){return new le(((t,s)=>{let o=0,l=0,c=!1;e.forEach((d=>{++o,d.next((()=>{++l,c&&l===o&&t()}),(p=>s(p)))})),c=!0,l===o&&t()}))}static or(e){let t=le.resolve(!1);for(const s of e)t=t.next((o=>o?le.resolve(o):s()));return t}static forEach(e,t){const s=[];return e.forEach(((o,l)=>{s.push(t.call(this,o,l))})),this.waitFor(s)}static mapArray(e,t){return new le(((s,o)=>{const l=e.length,c=new Array(l);let d=0;for(let p=0;p<l;p++){const h=p;t(e[h]).next((T=>{c[h]=T,++d,d===l&&s(c)}),(T=>o(T)))}}))}static doWhile(e,t){return new le(((s,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):s()};l()}))}}function k2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ja(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kp=-1;function tf(n){return n==null}function Nd(n){return n===0&&1/n==-1/0}function U2(n){return typeof n=="number"&&Number.isInteger(n)&&!Nd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="";function L2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=MT(e)),e=O2(n.get(t),e);return MT(e)}function O2(n,e){let t=e;const s=n.length;for(let o=0;o<s;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case zS:t+="";break;default:t+=l}}return t}function MT(n){return n+zS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function So(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new Ct(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new Ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return t+s.left.size;o<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ad(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ad(this.root,e,this.comparator,!1)}getReverseIterator(){return new ad(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ad(this.root,e,this.comparator,!0)}}class ad{constructor(e,t,s,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,s,o,l){this.key=e,this.value=t,this.color=s??un.RED,this.left=o??un.EMPTY,this.right=l??un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,o,l){return new un(e??this.key,t??this.value,s??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let o=this;const l=s(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,s),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return un.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1;un.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,t,s,o,l){return this}insert(e,t,s){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new PT(this.data.getIterator())}getIteratorFrom(e){return new PT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=s.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $t(this.comparator);return t.data=e,t}}class PT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new fi([])}unionWith(e){let t=new $t(tn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new fi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Da(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new jS("Invalid base64 string: "+l):l}})(e);return new nn(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let c=0;c<o.length;++c)l+=String.fromCharCode(o[c]);return l})(e);return new nn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nn.EMPTY_BYTE_STRING=new nn("");const q2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ir(n){if(at(!!n,39018),typeof n=="string"){let e=0;const t=q2.exec(n);if(at(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wr(n){return typeof n=="string"?nn.fromBase64String(n):nn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="server_timestamp",JS="__type__",KS="__previous_value__",$S="__local_write_time__";function Up(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[JS])==null?void 0:s.stringValue)===YS}function nf(n){const e=n.mapValue.fields[KS];return Up(e)?nf(e):e}function pu(n){const e=Ir(n.mapValue.fields[$S].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,t,s,o,l,c,d,p,h,T){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=o,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=h,this.isUsingEmulator=T}}const Md="(default)";class Pa{constructor(e,t){this.projectId=e,this.database=t||Md}static empty(){return new Pa("","")}get isDefaultDatabase(){return this.database===Md}isEqual(e){return e instanceof Pa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS="__type__",F2="__max__",ld={mapValue:{}},XS="__vector__",Dd="value";function Rr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Up(n)?4:z2(n)?9007199254740991:H2(n)?10:11:Me(28295,{value:n})}function $i(n,e){if(n===e)return!0;const t=Rr(n);if(t!==Rr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return pu(n).isEqual(pu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const c=Ir(o.timestampValue),d=Ir(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return wr(o.bytesValue).isEqual(wr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return Vt(o.geoPointValue.latitude)===Vt(l.geoPointValue.latitude)&&Vt(o.geoPointValue.longitude)===Vt(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return Vt(o.integerValue)===Vt(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const c=Vt(o.doubleValue),d=Vt(l.doubleValue);return c===d?Nd(c)===Nd(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return Da(n.arrayValue.values||[],e.arrayValue.values||[],$i);case 10:case 11:return(function(o,l){const c=o.mapValue.fields||{},d=l.mapValue.fields||{};if(DT(c)!==DT(d))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(d[p]===void 0||!$i(c[p],d[p])))return!1;return!0})(n,e);default:return Me(52216,{left:n})}}function gu(n,e){return(n.values||[]).find((t=>$i(t,e)))!==void 0}function Va(n,e){if(n===e)return 0;const t=Rr(n),s=Rr(e);if(t!==s)return Ye(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ye(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=Vt(l.integerValue||l.doubleValue),p=Vt(c.integerValue||c.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(n,e);case 3:return VT(n.timestampValue,e.timestampValue);case 4:return VT(pu(n),pu(e));case 5:return ip(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=wr(l),p=wr(c);return d.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),p=c.split("/");for(let h=0;h<d.length&&h<p.length;h++){const T=Ye(d[h],p[h]);if(T!==0)return T}return Ye(d.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=Ye(Vt(l.latitude),Vt(c.latitude));return d!==0?d:Ye(Vt(l.longitude),Vt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return kT(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var A,I,k,B;const d=l.fields||{},p=c.fields||{},h=(A=d[Dd])==null?void 0:A.arrayValue,T=(I=p[Dd])==null?void 0:I.arrayValue,E=Ye(((k=h==null?void 0:h.values)==null?void 0:k.length)||0,((B=T==null?void 0:T.values)==null?void 0:B.length)||0);return E!==0?E:kT(h,T)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===ld.mapValue&&c===ld.mapValue)return 0;if(l===ld.mapValue)return 1;if(c===ld.mapValue)return-1;const d=l.fields||{},p=Object.keys(d),h=c.fields||{},T=Object.keys(h);p.sort(),T.sort();for(let E=0;E<p.length&&E<T.length;++E){const A=ip(p[E],T[E]);if(A!==0)return A;const I=Va(d[p[E]],h[T[E]]);if(I!==0)return I}return Ye(p.length,T.length)})(n.mapValue,e.mapValue);default:throw Me(23264,{he:t})}}function VT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ye(n,e);const t=Ir(n),s=Ir(e),o=Ye(t.seconds,s.seconds);return o!==0?o:Ye(t.nanos,s.nanos)}function kT(n,e){const t=n.values||[],s=e.values||[];for(let o=0;o<t.length&&o<s.length;++o){const l=Va(t[o],s[o]);if(l)return l}return Ye(t.length,s.length)}function ka(n){return sp(n)}function sp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Ir(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return we.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",o=!0;for(const l of t.values||[])o?o=!1:s+=",",s+=sp(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const c of s)l?l=!1:o+=",",o+=`${c}:${sp(t.fields[c])}`;return o+"}"})(n.mapValue):Me(61005,{value:n})}function gd(n){switch(Rr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(n);return e?16+gd(e):16;case 5:return 2*n.stringValue.length;case 6:return wr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,l)=>o+gd(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let o=0;return So(s.fields,((l,c)=>{o+=l.length+gd(c)})),o})(n.mapValue);default:throw Me(13486,{value:n})}}function rp(n){return!!n&&"integerValue"in n}function Lp(n){return!!n&&"arrayValue"in n}function UT(n){return!!n&&"nullValue"in n}function LT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function yd(n){return!!n&&"mapValue"in n}function H2(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[QS])==null?void 0:s.stringValue)===XS}function au(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return So(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=au(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=au(n.arrayValue.values[t]);return e}return{...n}}function z2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===F2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.value=e}static empty(){return new Wn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!yd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=au(t)}setAll(e){let t=tn.emptyPath(),s={},o=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,s,o),s={},o=[],t=d.popLast()}c?s[d.lastSegment()]=au(c):o.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,o)}delete(e){const t=this.field(e.popLast());yd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $i(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=t.mapValue.fields[e.get(s)];yd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,s){So(t,((o,l)=>e[o]=l));for(const o of s)delete e[o]}clone(){return new Wn(au(this.value))}}function WS(n){const e=[];return So(n.fields,((t,s)=>{const o=new tn([t]);if(yd(s)){const l=WS(s.mapValue).fields;if(l.length===0)e.push(o);else for(const c of l)e.push(o.child(c))}else e.push(o)})),new fi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,t,s,o,l,c,d){this.key=e,this.documentType=t,this.version=s,this.readTime=o,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new hn(e,0,Pe.min(),Pe.min(),Pe.min(),Wn.empty(),0)}static newFoundDocument(e,t,s,o){return new hn(e,1,t,Pe.min(),s,o,0)}static newNoDocument(e,t){return new hn(e,2,t,Pe.min(),Pe.min(),Wn.empty(),0)}static newUnknownDocument(e,t){return new hn(e,3,t,Pe.min(),Pe.min(),Wn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t){this.position=e,this.inclusive=t}}function OT(n,e,t){let s=0;for(let o=0;o<n.position.length;o++){const l=e[o],c=n.position[o];if(l.field.isKeyField()?s=we.comparator(we.fromName(c.referenceValue),t.key):s=Va(c,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function qT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$i(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e,t="asc"){this.field=e,this.dir=t}}function G2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{}class Kt extends ZS{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new Y2(e,t,s):t==="array-contains"?new $2(e,s):t==="in"?new Q2(e,s):t==="not-in"?new X2(e,s):t==="array-contains-any"?new W2(e,s):new Kt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new J2(e,s):new K2(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Va(t,this.value)):t!==null&&Rr(this.value)===Rr(t)&&this.matchesComparison(Va(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qi extends ZS{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qi(e,t)}matches(e){return eA(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function eA(n){return n.op==="and"}function tA(n){return j2(n)&&eA(n)}function j2(n){for(const e of n.filters)if(e instanceof Qi)return!1;return!0}function op(n){if(n instanceof Kt)return n.field.canonicalString()+n.op.toString()+ka(n.value);if(tA(n))return n.filters.map((e=>op(e))).join(",");{const e=n.filters.map((t=>op(t))).join(",");return`${n.op}(${e})`}}function nA(n,e){return n instanceof Kt?(function(s,o){return o instanceof Kt&&s.op===o.op&&s.field.isEqual(o.field)&&$i(s.value,o.value)})(n,e):n instanceof Qi?(function(s,o){return o instanceof Qi&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((l,c,d)=>l&&nA(c,o.filters[d])),!0):!1})(n,e):void Me(19439)}function iA(n){return n instanceof Kt?(function(t){return`${t.field.canonicalString()} ${t.op} ${ka(t.value)}`})(n):n instanceof Qi?(function(t){return t.op.toString()+" {"+t.getFilters().map(iA).join(" ,")+"}"})(n):"Filter"}class Y2 extends Kt{constructor(e,t,s){super(e,t,s),this.key=we.fromName(s.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class J2 extends Kt{constructor(e,t){super(e,"in",t),this.keys=sA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class K2 extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=sA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function sA(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((s=>we.fromName(s.referenceValue)))}class $2 extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Lp(t)&&gu(t.arrayValue,this.value)}}class Q2 extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&gu(this.value.arrayValue,t)}}class X2 extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!gu(this.value.arrayValue,t)}}class W2 extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Lp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>gu(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,t=null,s=[],o=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=o,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function BT(n,e=null,t=[],s=[],o=null,l=null,c=null){return new Z2(n,e,t,s,o,l,c)}function Op(n){const e=Ue(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>op(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>ka(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>ka(s))).join(",")),e.Te=t}return e.Te}function qp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!G2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!nA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qT(n.startAt,e.startAt)&&qT(n.endAt,e.endAt)}function ap(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t=null,s=[],o=[],l=null,c="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=o,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function eP(n,e,t,s,o,l,c,d){return new sf(n,e,t,s,o,l,c,d)}function Bp(n){return new sf(n)}function FT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tP(n){return n.collectionGroup!==null}function lu(n){const e=Ue(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new $t(tn.comparator);return c.filters.forEach((p=>{p.getFlattenedFilters().forEach((h=>{h.isInequality()&&(d=d.add(h.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Vd(l,s))})),t.has(tn.keyField().canonicalString())||e.Ie.push(new Vd(tn.keyField(),s))}return e.Ie}function Gi(n){const e=Ue(n);return e.Ee||(e.Ee=nP(e,lu(n))),e.Ee}function nP(n,e){if(n.limitType==="F")return BT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Vd(o.field,l)}));const t=n.endAt?new Pd(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Pd(n.startAt.position,n.startAt.inclusive):null;return BT(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function lp(n,e,t){return new sf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rf(n,e){return qp(Gi(n),Gi(e))&&n.limitType===e.limitType}function rA(n){return`${Op(Gi(n))}|lt:${n.limitType}`}function ya(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((o=>iA(o))).join(", ")}]`),tf(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((o=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(o))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((o=>ka(o))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((o=>ka(o))).join(",")),`Target(${s})`})(Gi(n))}; limitType=${n.limitType})`}function of(n,e){return e.isFoundDocument()&&(function(s,o){const l=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):we.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,o){for(const l of lu(s))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,o){for(const l of s.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(s,o){return!(s.startAt&&!(function(c,d,p){const h=OT(c,d,p);return c.inclusive?h<=0:h<0})(s.startAt,lu(s),o)||s.endAt&&!(function(c,d,p){const h=OT(c,d,p);return c.inclusive?h>=0:h>0})(s.endAt,lu(s),o))})(n,e)}function iP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function oA(n){return(e,t)=>{let s=!1;for(const o of lu(n)){const l=sP(o,e,t);if(l!==0)return l;s=s||o.field.isKeyField()}return 0}}function sP(n,e,t){const s=n.field.isKeyField()?we.comparator(e.key,t.key):(function(l,c,d){const p=c.data.field(l),h=d.data.field(l);return p!==null&&h!==null?Va(p,h):Me(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Me(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[o,l]of s)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[t]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){So(this.inner,((t,s)=>{for(const[o,l]of s)e(o,l)}))}isEmpty(){return GS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=new Ct(we.comparator);function Ms(){return rP}const aA=new Ct(we.comparator);function iu(...n){let e=aA;for(const t of n)e=e.insert(t.key,t);return e}function lA(n){let e=aA;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function fo(){return uu()}function uA(){return uu()}function uu(){return new Ao((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oP=new Ct(we.comparator),aP=new $t(we.comparator);function Je(...n){let e=aP;for(const t of n)e=e.add(t);return e}const lP=new $t(Ye);function uP(){return lP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nd(e)?"-0":e}}function cA(n){return{integerValue:""+n}}function cP(n,e){return U2(e)?cA(e):Fp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(){this._=void 0}}function dP(n,e,t){return n instanceof kd?(function(o,l){const c={fields:{[JS]:{stringValue:YS},[$S]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Up(l)&&(l=nf(l)),l&&(c.fields[KS]=l),{mapValue:c}})(t,e):n instanceof yu?fA(n,e):n instanceof _u?hA(n,e):(function(o,l){const c=dA(o,l),d=HT(c)+HT(o.Ae);return rp(c)&&rp(o.Ae)?cA(d):Fp(o.serializer,d)})(n,e)}function fP(n,e,t){return n instanceof yu?fA(n,e):n instanceof _u?hA(n,e):t}function dA(n,e){return n instanceof Ud?(function(s){return rp(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class kd extends af{}class yu extends af{constructor(e){super(),this.elements=e}}function fA(n,e){const t=mA(e);for(const s of n.elements)t.some((o=>$i(o,s)))||t.push(s);return{arrayValue:{values:t}}}class _u extends af{constructor(e){super(),this.elements=e}}function hA(n,e){let t=mA(e);for(const s of n.elements)t=t.filter((o=>!$i(o,s)));return{arrayValue:{values:t}}}class Ud extends af{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function HT(n){return Vt(n.integerValue||n.doubleValue)}function mA(n){return Lp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function hP(n,e){return n.field.isEqual(e.field)&&(function(s,o){return s instanceof yu&&o instanceof yu||s instanceof _u&&o instanceof _u?Da(s.elements,o.elements,$i):s instanceof Ud&&o instanceof Ud?$i(s.Ae,o.Ae):s instanceof kd&&o instanceof kd})(n.transform,e.transform)}class mP{constructor(e,t){this.version=e,this.transformResults=t}}class ji{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ji}static exists(e){return new ji(void 0,e)}static updateTime(e){return new ji(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _d(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class lf{}function pA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Hp(n.key,ji.none()):new xu(n.key,n.data,ji.none());{const t=n.data,s=Wn.empty();let o=new $t(tn.comparator);for(let l of e.fields)if(!o.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?s.delete(l):s.set(l,c),o=o.add(l)}return new bo(n.key,s,new fi(o.toArray()),ji.none())}}function pP(n,e,t){n instanceof xu?(function(o,l,c){const d=o.value.clone(),p=GT(o.fieldTransforms,l,c.transformResults);d.setAll(p),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof bo?(function(o,l,c){if(!_d(o.precondition,l))return void l.convertToUnknownDocument(c.version);const d=GT(o.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(gA(o)),p.setAll(d),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(n,e,t):(function(o,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function cu(n,e,t,s){return n instanceof xu?(function(l,c,d,p){if(!_d(l.precondition,c))return d;const h=l.value.clone(),T=jT(l.fieldTransforms,p,c);return h.setAll(T),c.convertToFoundDocument(c.version,h).setHasLocalMutations(),null})(n,e,t,s):n instanceof bo?(function(l,c,d,p){if(!_d(l.precondition,c))return d;const h=jT(l.fieldTransforms,p,c),T=c.data;return T.setAll(gA(l)),T.setAll(h),c.convertToFoundDocument(c.version,T).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,s):(function(l,c,d){return _d(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function gP(n,e){let t=null;for(const s of n.fieldTransforms){const o=e.data.field(s.field),l=dA(s.transform,o||null);l!=null&&(t===null&&(t=Wn.empty()),t.set(s.field,l))}return t||null}function zT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&Da(s,o,((l,c)=>hP(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class xu extends lf{constructor(e,t,s,o=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class bo extends lf{constructor(e,t,s,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function gA(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function GT(n,e,t){const s=new Map;at(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],c=l.transform,d=e.data.field(l.field);s.set(l.field,fP(c,d,t[o]))}return s}function jT(n,e,t){const s=new Map;for(const o of n){const l=o.transform,c=t.data.field(o.field);s.set(o.field,dP(l,c,e))}return s}class Hp extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yP extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,t,s,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&pP(l,e,s[o])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=cu(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=cu(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=uA();return this.mutations.forEach((o=>{const l=e.get(o.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(o.key)?null:d;const p=pA(c,d);p!==null&&s.set(o.key,p),c.isValidDocument()||c.convertToNoDocument(Pe.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Je())}isEqual(e){return this.batchId===e.batchId&&Da(this.mutations,e.mutations,((t,s)=>zT(t,s)))&&Da(this.baseMutations,e.baseMutations,((t,s)=>zT(t,s)))}}class zp{constructor(e,t,s,o){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=o}static from(e,t,s){at(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return oP})();const l=e.mutations;for(let c=0;c<l.length;c++)o=o.insert(l[c].key,s[c].version);return new zp(e,t,s,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,Xe;function EP(n){switch(n){case ue.OK:return Me(64938);case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0;default:return Me(15467,{code:n})}}function yA(n){if(n===void 0)return Rs("GRPC error has no .code"),ue.UNKNOWN;switch(n){case Gt.OK:return ue.OK;case Gt.CANCELLED:return ue.CANCELLED;case Gt.UNKNOWN:return ue.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return ue.INTERNAL;case Gt.UNAVAILABLE:return ue.UNAVAILABLE;case Gt.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Gt.NOT_FOUND:return ue.NOT_FOUND;case Gt.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Gt.ABORTED:return ue.ABORTED;case Gt.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Gt.DATA_LOSS:return ue.DATA_LOSS;default:return Me(39323,{code:n})}}(Xe=Gt||(Gt={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=new br([4294967295,4294967295],0);function YT(n){const e=SP().encode(n),t=new MS;return t.update(e),new Uint8Array(t.digest())}function JT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new br([t,s],0),new br([o,l],0)]}class Gp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new su(`Invalid padding: ${t}`);if(s<0)throw new su(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new su(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new su(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=br.fromNumber(this.ge)}ye(e,t,s){let o=e.add(t.multiply(br.fromNumber(s)));return o.compare(AP)===1&&(o=new br([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=YT(e),[s,o]=JT(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(s,o,l);if(!this.we(c))return!1}return!0}static create(e,t,s){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Gp(l,o,t);return s.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=YT(e),[s,o]=JT(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(s,o,l);this.Se(c)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t,s,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const o=new Map;return o.set(e,Cu.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new uf(Pe.min(),o,new Ct(Ye),Ms(),Je())}}class Cu{constructor(e,t,s,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Cu(s,t,Je(),Je(),Je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t,s,o){this.be=e,this.removedTargetIds=t,this.key=s,this.De=o}}class _A{constructor(e,t){this.targetId=e,this.Ce=t}}class vA{constructor(e,t,s=nn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=o}}class KT{constructor(){this.ve=0,this.Fe=$T(),this.Me=nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Je(),t=Je(),s=Je();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:s=s.add(o);break;default:Me(38017,{changeType:l})}})),new Cu(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=$T()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ms(),this.Je=ud(),this.He=ud(),this.Ye=new Ct(Ye)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,s=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(ap(l))if(s===0){const c=new we(l.path);this.et(t,c,hn.newNoDocument(c,Pe.min()))}else at(s===1,20013,{expectedCount:s});else{const c=this._t(t);if(c!==s){const d=this.ut(e),p=d?this.ct(d,e,c):1;if(p!==0){this.it(t);const h=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:l=0}=t;let c,d;try{c=wr(s).toUint8Array()}catch(p){if(p instanceof jS)return _o("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new Gp(c,o,l)}catch(p){return _o(p instanceof su?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let o=0;return s.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&ap(d.target)){const p=new we(d.target.path);this.It(p).has(c)||this.Et(c,p)||this.et(c,p,hn.newNoDocument(p,e))}l.Be&&(t.set(c,l.ke()),l.qe())}}));let s=Je();this.He.forEach(((l,c)=>{let d=!0;c.forEachWhile((p=>{const h=this.ot(p);return!h||h.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(s=s.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const o=new uf(e,t,this.Ye,this.je,s);return this.je=Ms(),this.Je=ud(),this.He=ud(),this.Ye=new Ct(Ye),o}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new KT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new $t(Ye),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new $t(Ye),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||_e("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new KT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ud(){return new Ct(we.comparator)}function $T(){return new Ct(we.comparator)}const xP={asc:"ASCENDING",desc:"DESCENDING"},CP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IP={and:"AND",or:"OR"};class wP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function up(n,e){return n.useProto3Json||tf(e)?e:{value:e}}function Ld(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function RP(n,e){return Ld(n,e.toTimestamp())}function Yi(n){return at(!!n,49232),Pe.fromTimestamp((function(t){const s=Ir(t);return new _t(s.seconds,s.nanos)})(n))}function jp(n,e){return cp(n,e).canonicalString()}function cp(n,e){const t=(function(o){return new St(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function EA(n){const e=St.fromString(n);return at(CA(e),10190,{key:e.toString()}),e}function dp(n,e){return jp(n.databaseId,e.path)}function Mm(n,e){const t=EA(e);if(t.get(1)!==n.databaseId.projectId)throw new be(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new be(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(AA(t))}function SA(n,e){return jp(n.databaseId,e)}function NP(n){const e=EA(n);return e.length===4?St.emptyPath():AA(e)}function fp(n){return new St(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function AA(n){return at(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function QT(n,e,t){return{name:dp(n,e),fields:t.value.mapValue.fields}}function MP(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Me(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(h,T){return h.useProto3Json?(at(T===void 0||typeof T=="string",58123),nn.fromBase64String(T||"")):(at(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),nn.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(h){const T=h.code===void 0?ue.UNKNOWN:yA(h.code);return new be(T,h.message||"")})(c);t=new vA(s,o,l,d||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=Mm(n,s.document.name),l=Yi(s.document.updateTime),c=s.document.createTime?Yi(s.document.createTime):Pe.min(),d=new Wn({mapValue:{fields:s.document.fields}}),p=hn.newFoundDocument(o,l,c,d),h=s.targetIds||[],T=s.removedTargetIds||[];t=new vd(h,T,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=Mm(n,s.document),l=s.readTime?Yi(s.readTime):Pe.min(),c=hn.newNoDocument(o,l),d=s.removedTargetIds||[];t=new vd([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=Mm(n,s.document),l=s.removedTargetIds||[];t=new vd([],l,o,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:l}=s,c=new TP(o,l),d=s.targetId;t=new _A(d,c)}}return t}function DP(n,e){let t;if(e instanceof xu)t={update:QT(n,e.key,e.value)};else if(e instanceof Hp)t={delete:dp(n,e.key)};else if(e instanceof bo)t={update:QT(n,e.key,e.data),updateMask:FP(e.fieldMask)};else{if(!(e instanceof yP))return Me(16599,{Vt:e.type});t={verify:dp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,c){const d=c.transform;if(d instanceof kd)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof yu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof _u)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Ud)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw Me(20930,{transform:c.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:RP(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Me(27497)})(n,e.precondition)),t}function PP(n,e){return n&&n.length>0?(at(e!==void 0,14353),n.map((t=>(function(o,l){let c=o.updateTime?Yi(o.updateTime):Yi(l);return c.isEqual(Pe.min())&&(c=Yi(l)),new mP(c,o.transformResults||[])})(t,e)))):[]}function VP(n,e){return{documents:[SA(n,e.path)]}}function kP(n,e){const t={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=SA(n,o);const l=(function(h){if(h.length!==0)return xA(Qi.create(h,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(h){if(h.length!==0)return h.map((T=>(function(A){return{field:_a(A.field),direction:OP(A.dir)}})(T)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=up(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:o}}function UP(n){let e=NP(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let o=null;if(s>0){at(s===1,65062);const T=t.from[0];T.allDescendants?o=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(E){const A=bA(E);return A instanceof Qi&&tA(A)?A.getFilters():[A]})(t.where));let c=[];t.orderBy&&(c=(function(E){return E.map((A=>(function(k){return new Vd(va(k.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(A)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let A;return A=typeof E=="object"?E.value:E,tf(A)?null:A})(t.limit));let p=null;t.startAt&&(p=(function(E){const A=!!E.before,I=E.values||[];return new Pd(I,A)})(t.startAt));let h=null;return t.endAt&&(h=(function(E){const A=!E.before,I=E.values||[];return new Pd(I,A)})(t.endAt)),eP(e,o,c,l,d,"F",p,h)}function LP(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bA(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=va(t.unaryFilter.field);return Kt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=va(t.unaryFilter.field);return Kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=va(t.unaryFilter.field);return Kt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=va(t.unaryFilter.field);return Kt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Kt.create(va(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qi.create(t.compositeFilter.filters.map((s=>bA(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Me(1026)}})(t.compositeFilter.op))})(n):Me(30097,{filter:n})}function OP(n){return xP[n]}function qP(n){return CP[n]}function BP(n){return IP[n]}function _a(n){return{fieldPath:n.canonicalString()}}function va(n){return tn.fromServerFormat(n.fieldPath)}function xA(n){return n instanceof Kt?(function(t){if(t.op==="=="){if(LT(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NAN"}};if(UT(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(LT(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NOT_NAN"}};if(UT(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_a(t.field),op:qP(t.op),value:t.value}}})(n):n instanceof Qi?(function(t){const s=t.getFilters().map((o=>xA(o)));return s.length===1?s[0]:{compositeFilter:{op:BP(t.op),filters:s}}})(n):Me(54877,{filter:n})}function FP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function CA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t,s,o,l=Pe.min(),c=Pe.min(),d=nn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.yt=e}}function zP(n){const e=UP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(){this.Cn=new jP}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Cr.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Cr.min())}updateCollectionGroup(e,t,s){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class jP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t]||new $t(St.comparator),l=!o.has(s);return this.index[t]=o.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t];return o&&o.has(s)}getEntries(e){return(this.index[e]||new $t(St.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},IA=41943040;class In{static withCacheSize(e){return new In(e,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In.DEFAULT_COLLECTION_PERCENTILE=10,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,In.DEFAULT=new In(IA,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),In.DISABLED=new In(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ua(0)}static cr(){return new Ua(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="LruGarbageCollector",YP=1048576;function ZT([n,e],[t,s]){const o=Ye(n,t);return o===0?Ye(e,s):o}class JP{constructor(e){this.Ir=e,this.buffer=new $t(ZT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();ZT(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){_e(WT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ja(t)?_e(WT,"Ignoring IndexedDB error during garbage collection: ",t):await Ya(t)}await this.Vr(3e5)}))}}class $P{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(ef.ce);const s=new JP(t);return this.mr.forEachTarget(e,(o=>s.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>s.Ar(o))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(_e("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(XT)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(_e("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),XT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,o,l,c,d,p,h;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(_e("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,c=Date.now(),this.nthSequenceNumber(e,o)))).next((E=>(s=E,d=Date.now(),this.removeTargets(e,s,t)))).next((E=>(l=E,p=Date.now(),this.removeOrphanedDocuments(e,s)))).next((E=>(h=Date.now(),ga()<=je.DEBUG&&_e("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-T}ms
	Determined least recently used ${o} in `+(d-c)+`ms
	Removed ${l} targets in `+(p-d)+`ms
	Removed ${E} documents in `+(h-p)+`ms
Total Duration: ${h-T}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:E}))))}}function QP(n,e){return new $P(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this.changes=new Ao((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?le.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,t,s,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(s!==null&&cu(s.mutation,o,fi.empty(),_t.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Je()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Je()){const o=fo();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,s).next((l=>{let c=iu();return l.forEach(((d,p)=>{c=c.insert(d,p.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const s=fo();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Je())))}populateOverlays(e,t,s){const o=[];return s.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,s,o){let l=Ms();const c=uu(),d=(function(){return uu()})();return t.forEach(((p,h)=>{const T=s.get(h.key);o.has(h.key)&&(T===void 0||T.mutation instanceof bo)?l=l.insert(h.key,h):T!==void 0?(c.set(h.key,T.mutation.getFieldMask()),cu(T.mutation,h,T.mutation.getFieldMask(),_t.now())):c.set(h.key,fi.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((h,T)=>c.set(h,T))),t.forEach(((h,T)=>d.set(h,new WP(T,c.get(h)??null)))),d)))}recalculateAndSaveOverlays(e,t){const s=uu();let o=new Ct(((c,d)=>c-d)),l=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((p=>{const h=t.get(p);if(h===null)return;let T=s.get(p)||fi.empty();T=d.applyToLocalView(h,T),s.set(p,T);const E=(o.get(d.batchId)||Je()).add(p);o=o.insert(d.batchId,E)}))})).next((()=>{const c=[],d=o.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),h=p.key,T=p.value,E=uA();T.forEach((A=>{if(!l.has(A)){const I=pA(t.get(A),s.get(A));I!==null&&E.set(A,I),l=l.add(A)}})),c.push(this.documentOverlayCache.saveOverlays(e,h,E))}return le.waitFor(c)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,o){return(function(c){return we.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,o):this.getDocumentsMatchingCollectionQuery(e,t,s,o)}getNextDocuments(e,t,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,o).next((l=>{const c=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,o-l.size):le.resolve(fo());let d=mu,p=l;return c.next((h=>le.forEach(h,((T,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),l.get(T)?le.resolve():this.remoteDocumentCache.getEntry(e,T).next((A=>{p=p.insert(T,A)}))))).next((()=>this.populateOverlays(e,h,l))).next((()=>this.computeViews(e,p,h,Je()))).next((T=>({batchId:d,changes:lA(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next((s=>{let o=iu();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,o){const l=t.collectionGroup;let c=iu();return this.indexManager.getCollectionParents(e,l).next((d=>le.forEach(d,(p=>{const h=(function(E,A){return new sf(A,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,h,s,o).next((T=>{T.forEach(((E,A)=>{c=c.insert(E,A)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,s,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,o)))).next((c=>{l.forEach(((p,h)=>{const T=h.getKey();c.get(T)===null&&(c=c.insert(T,hn.newInvalidDocument(T)))}));let d=iu();return c.forEach(((p,h)=>{const T=l.get(p);T!==void 0&&cu(T.mutation,h,fi.empty(),_t.now()),of(t,h)&&(d=d.insert(p,h))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return le.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Yi(o.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:zP(o.bundledQuery),readTime:Yi(o.readTime)}})(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(){this.overlays=new Ct(we.comparator),this.qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const s=fo();return le.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&s.set(o,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((o,l)=>{this.St(e,t,l)})),le.resolve()}removeOverlaysForBatchId(e,t,s){const o=this.qr.get(s);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(s)),le.resolve()}getOverlaysForCollection(e,t,s){const o=fo(),l=t.length+1,c=new we(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const p=d.getNext().value,h=p.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===l&&p.largestBatchId>s&&o.set(p.getKey(),p)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,s,o){let l=new Ct(((h,T)=>h-T));const c=this.overlays.getIterator();for(;c.hasNext();){const h=c.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>s){let T=l.get(h.largestBatchId);T===null&&(T=fo(),l=l.insert(h.largestBatchId,T)),T.set(h.getKey(),h)}}const d=fo(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((h,T)=>d.set(h,T))),!(d.size()>=o)););return le.resolve(d)}St(e,t,s){const o=this.overlays.get(s.key);if(o!==null){const c=this.qr.get(o.largestBatchId).delete(s.key);this.qr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(s.key,new vP(t,s));let l=this.qr.get(t);l===void 0&&(l=Je(),this.qr.set(t,l)),this.qr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(){this.sessionToken=nn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(){this.Qr=new $t(en.$r),this.Ur=new $t(en.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new en(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new en(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new we(new St([])),s=new en(t,e),o=new en(t,e+1),l=[];return this.Ur.forEachInRange([s,o],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new we(new St([])),s=new en(t,e),o=new en(t,e+1);let l=Je();return this.Ur.forEachInRange([s,o],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new en(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class en{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return we.comparator(e.key,t.key)||Ye(e.Yr,t.Yr)}static Kr(e,t){return Ye(e.Yr,t.Yr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new $t(en.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new _P(l,t,s,o);this.mutationQueue.push(c);for(const d of o)this.Zr=this.Zr.add(new en(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return le.resolve(c)}lookupMutationBatch(e,t){return le.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=this.ei(s),l=o<0?0:o;return le.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?kp:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new en(t,0),o=new en(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([s,o],(c=>{const d=this.Xr(c.Yr);l.push(d)})),le.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new $t(Ye);return t.forEach((o=>{const l=new en(o,0),c=new en(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(d=>{s=s.add(d.Yr)}))})),le.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1;let l=s;we.isDocumentKey(l)||(l=l.child(""));const c=new en(new we(l),0);let d=new $t(Ye);return this.Zr.forEachWhile((p=>{const h=p.key.path;return!!s.isPrefixOf(h)&&(h.length===o&&(d=d.add(p.Yr)),!0)}),c),le.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((s=>{const o=this.Xr(s);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){at(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return le.forEach(t.mutations,(o=>{const l=new en(o.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new en(t,0),o=this.Zr.firstAfterOrEqual(s);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e){this.ri=e,this.docs=(function(){return new Ct(we.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,o=this.docs.get(s),l=o?o.size:0,c=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return le.resolve(s?s.document.mutableCopy():hn.newInvalidDocument(t))}getEntries(e,t){let s=Ms();return t.forEach((o=>{const l=this.docs.get(o);s=s.insert(o,l?l.document.mutableCopy():hn.newInvalidDocument(o))})),le.resolve(s)}getDocumentsMatchingQuery(e,t,s,o){let l=Ms();const c=t.path,d=new we(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:h,value:{document:T}}=p.getNext();if(!c.isPrefixOf(h.path))break;h.path.length>c.length+1||D2(M2(T),s)<=0||(o.has(T.key)||of(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return le.resolve(l)}getAllFromCollectionGroup(e,t,s,o){Me(9500)}ii(e,t){return le.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new rV(this)}getSize(e){return le.resolve(this.size)}}class rV extends XP{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(s)})),le.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.persistence=e,this.si=new Ao((t=>Op(t)),qp),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new Yp,this.targetCount=0,this.ai=Ua.ur()}forEachTarget(e,t){return this.si.forEach(((s,o)=>t(o))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),le.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ua(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Pr(t),le.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,s){let o=0;const l=[];return this.si.forEach(((c,d)=>{d.sequenceNumber<=t&&s.get(d.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),le.waitFor(l).next((()=>o))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return le.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),le.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((c=>{l.push(o.markPotentiallyOrphaned(e,c))})),le.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return le.resolve(s)}containsKey(e,t){return le.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.ui={},this.overlays={},this.ci=new ef(0),this.li=!1,this.li=!0,this.hi=new nV,this.referenceDelegate=e(this),this.Pi=new oV(this),this.indexManager=new GP,this.remoteDocumentCache=(function(o){return new sV(o)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new HP(t),this.Ii=new eV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new iV(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){_e("MemoryPersistence","Starting transaction:",e);const o=new aV(this.ci.next());return this.referenceDelegate.Ei(),s(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return le.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class aV extends V2{constructor(e){super(),this.currentSequenceNumber=e}}class Jp{constructor(e){this.persistence=e,this.Ri=new Yp,this.Vi=null}static mi(e){return new Jp(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),le.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(s=>{const o=we.fromPath(s);return this.gi(e,o).next((l=>{l||t.removeEntry(o,Pe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Od{constructor(e,t){this.persistence=e,this.pi=new Ao((s=>L2(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=QP(this,t)}static mi(e,t){return new Od(e,t)}Ei(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return le.forEach(this.pi,((s,o)=>this.br(e,s,o).next((l=>l?le.resolve():t(o)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(c=>this.br(e,c,t).next((d=>{d||(s++,l.removeEntry(c,Pe.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),le.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=gd(e.data.value)),t}br(e,t,s){return le.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return le.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t,s,o){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=o}static As(e,t){let s=Je(),o=Je();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Kp(e,t.fromCache,s,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return tD()?8:k2(pn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,o){const l={result:null};return this.ys(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,t,o,s).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new lV;return this.Ss(e,t,c).next((d=>{if(l.result=d,this.Vs)return this.bs(e,t,c,d.size)}))})).next((()=>l.result))}bs(e,t,s,o){return s.documentReadCount<this.fs?(ga()<=je.DEBUG&&_e("QueryEngine","SDK will not create cache indexes for query:",ya(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(ga()<=je.DEBUG&&_e("QueryEngine","Query:",ya(t),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.gs*o?(ga()<=je.DEBUG&&_e("QueryEngine","The SDK decides to create cache indexes for query:",ya(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gi(t))):le.resolve())}ys(e,t){if(FT(t))return le.resolve(null);let s=Gi(t);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=lp(t,null,"F"),s=Gi(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const c=Je(...l);return this.ps.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,s).next((p=>{const h=this.Ds(t,d);return this.Cs(t,h,c,p.readTime)?this.ys(e,lp(t,null,"F")):this.vs(e,h,t,p)}))))})))))}ws(e,t,s,o){return FT(t)||o.isEqual(Pe.min())?le.resolve(null):this.ps.getDocuments(e,s).next((l=>{const c=this.Ds(t,l);return this.Cs(t,c,s,o)?le.resolve(null):(ga()<=je.DEBUG&&_e("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ya(t)),this.vs(e,c,t,N2(o,mu)).next((d=>d)))}))}Ds(e,t){let s=new $t(oA(e));return t.forEach(((o,l)=>{of(e,l)&&(s=s.add(l))})),s}Cs(e,t,s,o){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,s){return ga()<=je.DEBUG&&_e("QueryEngine","Using full collection scan to execute query:",ya(t)),this.ps.getDocumentsMatchingQuery(e,t,Cr.min(),s)}vs(e,t,s,o){return this.ps.getDocumentsMatchingQuery(e,s,o).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="LocalStore",cV=3e8;class dV{constructor(e,t,s,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new Ct(Ye),this.xs=new Ao((l=>Op(l)),qp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function fV(n,e,t,s){return new dV(n,e,t,s)}async function RA(n,e){const t=Ue(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return t.mutationQueue.getAllMutationBatches(s).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const c=[],d=[];let p=Je();for(const h of o){c.push(h.batchId);for(const T of h.mutations)p=p.add(T.key)}for(const h of l){d.push(h.batchId);for(const T of h.mutations)p=p.add(T.key)}return t.localDocuments.getDocuments(s,p).next((h=>({Ls:h,removedBatchIds:c,addedBatchIds:d})))}))}))}function hV(n,e){const t=Ue(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,p,h,T){const E=h.batch,A=E.keys();let I=le.resolve();return A.forEach((k=>{I=I.next((()=>T.getEntry(p,k))).next((B=>{const F=h.docVersions.get(k);at(F!==null,48541),B.version.compareTo(F)<0&&(E.applyToRemoteDocument(B,h),B.isValidDocument()&&(B.setReadTime(h.commitVersion),T.addEntry(B)))}))})),I.next((()=>d.mutationQueue.removeMutationBatch(p,E)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(d){let p=Je();for(let h=0;h<d.mutationResults.length;++h)d.mutationResults[h].transformResults.length>0&&(p=p.add(d.batch.mutations[h].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(s,o)))}))}function NA(n){const e=Ue(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function mV(n,e){const t=Ue(n),s=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const d=[];e.targetChanges.forEach(((T,E)=>{const A=o.get(E);if(!A)return;d.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,E))));let I=A.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?I=I.withResumeToken(nn.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):T.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(T.resumeToken,s)),o=o.insert(E,I),(function(B,F,Z){return B.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=cV?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0})(A,I,T)&&d.push(t.Pi.updateTargetData(l,I))}));let p=Ms(),h=Je();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),d.push(pV(l,c,e.documentUpdates).next((T=>{p=T.ks,h=T.qs}))),!s.isEqual(Pe.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((E=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,s)));d.push(T)}return le.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,h))).next((()=>p))})).then((l=>(t.Ms=o,l)))}function pV(n,e,t){let s=Je(),o=Je();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let c=Ms();return t.forEach(((d,p)=>{const h=l.get(d);p.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(d)),p.isNoDocument()&&p.version.isEqual(Pe.min())?(e.removeEntry(d,p.readTime),c=c.insert(d,p)):!h.isValidDocument()||p.version.compareTo(h.version)>0||p.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(p),c=c.insert(d,p)):_e($p,"Ignoring outdated watch update for ",d,". Current version:",h.version," Watch version:",p.version)})),{ks:c,qs:o}}))}function gV(n,e){const t=Ue(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=kp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function yV(n,e){const t=Ue(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return t.Pi.getTargetData(s,e).next((l=>l?(o=l,le.resolve(o)):t.Pi.allocateTargetId(s).next((c=>(o=new Tr(e,c,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=t.Ms.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function hp(n,e,t){const s=Ue(n),o=s.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(c=>s.persistence.referenceDelegate.removeTarget(c,o)))}catch(c){if(!Ja(c))throw c;_e($p,`Failed to update sequence numbers for target ${e}: ${c}`)}s.Ms=s.Ms.remove(e),s.xs.delete(o.target)}function eE(n,e,t){const s=Ue(n);let o=Pe.min(),l=Je();return s.persistence.runTransaction("Execute query","readwrite",(c=>(function(p,h,T){const E=Ue(p),A=E.xs.get(T);return A!==void 0?le.resolve(E.Ms.get(A)):E.Pi.getTargetData(h,T)})(s,c,Gi(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(c,d.targetId).next((p=>{l=p}))})).next((()=>s.Fs.getDocumentsMatchingQuery(c,e,t?o:Pe.min(),t?l:Je()))).next((d=>(_V(s,iP(e),d),{documents:d,Qs:l})))))}function _V(n,e,t){let s=n.Os.get(e)||Pe.min();t.forEach(((o,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.Os.set(e,s)}class tE{constructor(){this.activeTargetIds=uP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vV{constructor(){this.Mo=new tE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new tE,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE="ConnectivityMonitor";class iE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){_e(nE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){_e(nE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd=null;function mp(){return cd===null?cd=(function(){return 268435456+Math.round(2147483648*Math.random())})():cd++,"0x"+cd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm="RestConnection",EV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class SV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${o}`,this.Wo=this.databaseId.database===Md?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Go(e,t,s,o,l){const c=mp(),d=this.zo(e,t.toUriEncodedString());_e(Dm,`Sending RPC '${e}' ${c}:`,d,s);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,o,l);const{host:h}=new URL(d),T=za(h);return this.Jo(e,d,p,s,T).then((E=>(_e(Dm,`Received RPC '${e}' ${c}: `,E),E)),(E=>{throw _o(Dm,`RPC '${e}' ${c} failed with error: `,E,"url: ",d,"request:",s),E}))}Ho(e,t,s,o,l,c){return this.Go(e,t,s,o,l)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ja})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),s&&s.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const s=EV[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class bV extends SV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,o,l){const c=mp();return new Promise(((d,p)=>{const h=new DS;h.setWithCredentials(!0),h.listenOnce(PS.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case pd.NO_ERROR:const E=h.getResponseJson();_e(dn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(E)),d(E);break;case pd.TIMEOUT:_e(dn,`RPC '${e}' ${c} timed out`),p(new be(ue.DEADLINE_EXCEEDED,"Request time out"));break;case pd.HTTP_ERROR:const A=h.getStatus();if(_e(dn,`RPC '${e}' ${c} failed with status:`,A,"response text:",h.getResponseText()),A>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const k=I==null?void 0:I.error;if(k&&k.status&&k.message){const B=(function(Z){const te=Z.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(te)>=0?te:ue.UNKNOWN})(k.status);p(new be(B,k.message))}else p(new be(ue.UNKNOWN,"Server responded with status "+h.getStatus()))}else p(new be(ue.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:c,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{_e(dn,`RPC '${e}' ${c} completed.`)}}));const T=JSON.stringify(o);_e(dn,`RPC '${e}' ${c} sending request:`,o),h.send(t,"POST",T,s,15)}))}T_(e,t,s){const o=mp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=US(),d=kS(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(p.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,t,s),p.encodeInitMessageHeaders=!0;const T=l.join("");_e(dn,`Creating RPC '${e}' stream ${o}: ${T}`,p);const E=c.createWebChannel(T,p);this.I_(E);let A=!1,I=!1;const k=new AV({Yo:F=>{I?_e(dn,`Not sending because RPC '${e}' stream ${o} is closed:`,F):(A||(_e(dn,`Opening RPC '${e}' stream ${o} transport.`),E.open(),A=!0),_e(dn,`RPC '${e}' stream ${o} sending:`,F),E.send(F))},Zo:()=>E.close()}),B=(F,Z,te)=>{F.listen(Z,(K=>{try{te(K)}catch(Y){setTimeout((()=>{throw Y}),0)}}))};return B(E,nu.EventType.OPEN,(()=>{I||(_e(dn,`RPC '${e}' stream ${o} transport opened.`),k.o_())})),B(E,nu.EventType.CLOSE,(()=>{I||(I=!0,_e(dn,`RPC '${e}' stream ${o} transport closed`),k.a_(),this.E_(E))})),B(E,nu.EventType.ERROR,(F=>{I||(I=!0,_o(dn,`RPC '${e}' stream ${o} transport errored. Name:`,F.name,"Message:",F.message),k.a_(new be(ue.UNAVAILABLE,"The operation could not be completed")))})),B(E,nu.EventType.MESSAGE,(F=>{var Z;if(!I){const te=F.data[0];at(!!te,16349);const K=te,Y=(K==null?void 0:K.error)||((Z=K[0])==null?void 0:Z.error);if(Y){_e(dn,`RPC '${e}' stream ${o} received error:`,Y);const ae=Y.status;let ee=(function(N){const L=Gt[N];if(L!==void 0)return yA(L)})(ae),M=Y.message;ee===void 0&&(ee=ue.INTERNAL,M="Unknown error status: "+ae+" with message "+Y.message),I=!0,k.a_(new be(ee,M)),E.close()}else _e(dn,`RPC '${e}' stream ${o} received:`,te),k.u_(te)}})),B(d,VS.STAT_EVENT,(F=>{F.stat===np.PROXY?_e(dn,`RPC '${e}' stream ${o} detected buffering proxy`):F.stat===np.NOPROXY&&_e(dn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Pm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(n){return new wP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e,t,s=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-s);o>0&&_e("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="PersistentStream";class DA{constructor(e,t,s,o,l,c,d,p){this.Mi=e,this.S_=s,this.b_=o,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new MA(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Rs(t.toString()),Rs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===t&&this.G_(s,o)}),(s=>{e((()=>{const o=new be(ue.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return _e(sE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(_e(sE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xV extends DA{constructor(e,t,s,o,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,o,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=MP(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Pe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Pe.min():c.readTime?Yi(c.readTime):Pe.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=fp(this.serializer),t.addTarget=(function(l,c){let d;const p=c.target;if(d=ap(p)?{documents:VP(l,p)}:{query:kP(l,p).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=TA(l,c.resumeToken);const h=up(l,c.expectedCount);h!==null&&(d.expectedCount=h)}else if(c.snapshotVersion.compareTo(Pe.min())>0){d.readTime=Ld(l,c.snapshotVersion.toTimestamp());const h=up(l,c.expectedCount);h!==null&&(d.expectedCount=h)}return d})(this.serializer,e);const s=LP(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=fp(this.serializer),t.removeTarget=e,this.q_(t)}}class CV extends DA{constructor(e,t,s,o,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,o,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=PP(e.writeResults,e.commitTime),s=Yi(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=fp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>DP(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{}class wV extends IV{constructor(e,t,s,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new be(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,cp(t,s),o,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new be(ue.UNKNOWN,l.toString())}))}Ho(e,t,s,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Ho(e,cp(t,s),o,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new be(ue.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class RV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Rs(t),this.aa=!1):_e("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="RemoteStore";class NV{constructor(e,t,s,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{s.enqueueAndForget((async()=>{xo(this)&&(_e(vo,"Restarting streams for network reachability change."),await(async function(p){const h=Ue(p);h.Ea.add(4),await Iu(h),h.Ra.set("Unknown"),h.Ea.delete(4),await df(h)})(this))}))})),this.Ra=new RV(s,o)}}async function df(n){if(xo(n))for(const e of n.da)await e(!0)}async function Iu(n){for(const e of n.da)await e(!1)}function PA(n,e){const t=Ue(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Zp(t)?Wp(t):Ka(t).O_()&&Xp(t,e))}function Qp(n,e){const t=Ue(n),s=Ka(t);t.Ia.delete(e),s.O_()&&VA(t,e),t.Ia.size===0&&(s.O_()?s.L_():xo(t)&&t.Ra.set("Unknown"))}function Xp(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ka(n).Y_(e)}function VA(n,e){n.Va.Ue(e),Ka(n).Z_(e)}function Wp(n){n.Va=new bP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ka(n).start(),n.Ra.ua()}function Zp(n){return xo(n)&&!Ka(n).x_()&&n.Ia.size>0}function xo(n){return Ue(n).Ea.size===0}function kA(n){n.Va=void 0}async function MV(n){n.Ra.set("Online")}async function DV(n){n.Ia.forEach(((e,t)=>{Xp(n,e)}))}async function PV(n,e){kA(n),Zp(n)?(n.Ra.ha(e),Wp(n)):n.Ra.set("Unknown")}async function VV(n,e,t){if(n.Ra.set("Online"),e instanceof vA&&e.state===2&&e.cause)try{await(async function(o,l){const c=l.cause;for(const d of l.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,c),o.Ia.delete(d),o.Va.removeTarget(d))})(n,e)}catch(s){_e(vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await qd(n,s)}else if(e instanceof vd?n.Va.Ze(e):e instanceof _A?n.Va.st(e):n.Va.tt(e),!t.isEqual(Pe.min()))try{const s=await NA(n.localStore);t.compareTo(s)>=0&&await(function(l,c){const d=l.Va.Tt(c);return d.targetChanges.forEach(((p,h)=>{if(p.resumeToken.approximateByteSize()>0){const T=l.Ia.get(h);T&&l.Ia.set(h,T.withResumeToken(p.resumeToken,c))}})),d.targetMismatches.forEach(((p,h)=>{const T=l.Ia.get(p);if(!T)return;l.Ia.set(p,T.withResumeToken(nn.EMPTY_BYTE_STRING,T.snapshotVersion)),VA(l,p);const E=new Tr(T.target,p,h,T.sequenceNumber);Xp(l,E)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(s){_e(vo,"Failed to raise snapshot:",s),await qd(n,s)}}async function qd(n,e,t){if(!Ja(e))throw e;n.Ea.add(1),await Iu(n),n.Ra.set("Offline"),t||(t=()=>NA(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{_e(vo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await df(n)}))}function UA(n,e){return e().catch((t=>qd(n,t,e)))}async function ff(n){const e=Ue(n),t=Nr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kp;for(;kV(e);)try{const o=await gV(e.localStore,s);if(o===null){e.Ta.length===0&&t.L_();break}s=o.batchId,UV(e,o)}catch(o){await qd(e,o)}LA(e)&&OA(e)}function kV(n){return xo(n)&&n.Ta.length<10}function UV(n,e){n.Ta.push(e);const t=Nr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function LA(n){return xo(n)&&!Nr(n).x_()&&n.Ta.length>0}function OA(n){Nr(n).start()}async function LV(n){Nr(n).ra()}async function OV(n){const e=Nr(n);for(const t of n.Ta)e.ea(t.mutations)}async function qV(n,e,t){const s=n.Ta.shift(),o=zp.from(s,e,t);await UA(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await ff(n)}async function BV(n,e){e&&Nr(n).X_&&await(async function(s,o){if((function(c){return EP(c)&&c!==ue.ABORTED})(o.code)){const l=s.Ta.shift();Nr(s).B_(),await UA(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,o))),await ff(s)}})(n,e),LA(n)&&OA(n)}async function rE(n,e){const t=Ue(n);t.asyncQueue.verifyOperationInProgress(),_e(vo,"RemoteStore received new credentials");const s=xo(t);t.Ea.add(3),await Iu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await df(t)}async function FV(n,e){const t=Ue(n);e?(t.Ea.delete(2),await df(t)):e||(t.Ea.add(2),await Iu(t),t.Ra.set("Unknown"))}function Ka(n){return n.ma||(n.ma=(function(t,s,o){const l=Ue(t);return l.sa(),new xV(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:MV.bind(null,n),t_:DV.bind(null,n),r_:PV.bind(null,n),H_:VV.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Zp(n)?Wp(n):n.Ra.set("Unknown")):(await n.ma.stop(),kA(n))}))),n.ma}function Nr(n){return n.fa||(n.fa=(function(t,s,o){const l=Ue(t);return l.sa(),new CV(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:LV.bind(null,n),r_:BV.bind(null,n),ta:OV.bind(null,n),na:qV.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await ff(n)):(await n.fa.stop(),n.Ta.length>0&&(_e(vo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t,s,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=o,this.removalCallback=l,this.deferred=new xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,o,l){const c=Date.now()+s,d=new eg(e,t,c,o,l);return d.start(s),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new be(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tg(n,e){if(Rs("AsyncQueue",`${e}: ${n}`),Ja(n))return new be(ue.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{static emptySet(e){return new Ia(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||we.comparator(t.key,s.key):(t,s)=>we.comparator(t.key,s.key),this.keyedMap=iu(),this.sortedSet=new Ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ia)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=s.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ia;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(){this.ga=new Ct(we.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class La{constructor(e,t,s,o,l,c,d,p,h){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=h}static fromInitialDocuments(e,t,s,o,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new La(e,t,Ia.emptySet(t),c,s,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==s[o].type||!t[o].doc.isEqual(s[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class zV{constructor(){this.queries=aE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const o=Ue(t),l=o.queries;o.queries=aE(),l.forEach(((c,d)=>{for(const p of d.Sa)p.onError(s)}))})(this,new be(ue.ABORTED,"Firestore shutting down"))}}function aE(){return new Ao((n=>rA(n)),rf)}async function qA(n,e){const t=Ue(n);let s=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(s=2):(l=new HV,s=e.Da()?0:1);try{switch(s){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(c){const d=tg(c,`Initialization of query '${ya(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&ng(t)}async function BA(n,e){const t=Ue(n),s=e.query;let o=3;const l=t.queries.get(s);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function GV(n,e){const t=Ue(n);let s=!1;for(const o of e){const l=o.query,c=t.queries.get(l);if(c){for(const d of c.Sa)d.Fa(o)&&(s=!0);c.wa=o}}s&&ng(t)}function jV(n,e,t){const s=Ue(n),o=s.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);s.queries.delete(e)}function ng(n){n.Ca.forEach((e=>{e.next()}))}var pp,lE;(lE=pp||(pp={})).Ma="default",lE.Cache="cache";class FA{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new La(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=La.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e){this.key=e}}class zA{constructor(e){this.key=e}}class YV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Je(),this.mutatedKeys=Je(),this.eu=oA(e),this.tu=new Ia(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new oE,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=o,d=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((T,E)=>{const A=o.get(T),I=of(this.query,E)?E:null,k=!!A&&this.mutatedKeys.has(A.key),B=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let F=!1;A&&I?A.data.isEqual(I.data)?k!==B&&(s.track({type:3,doc:I}),F=!0):this.su(A,I)||(s.track({type:2,doc:I}),F=!0,(p&&this.eu(I,p)>0||h&&this.eu(I,h)<0)&&(d=!0)):!A&&I?(s.track({type:0,doc:I}),F=!0):A&&!I&&(s.track({type:1,doc:A}),F=!0,(p||h)&&(d=!0)),F&&(I?(c=c.add(I),l=B?l.add(T):l.delete(T)):(c=c.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const T=this.query.limitType==="F"?c.last():c.first();c=c.delete(T.key),l=l.delete(T.key),s.track({type:1,doc:T})}return{tu:c,iu:s,Cs:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((T,E)=>(function(I,k){const B=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:F})}};return B(I)-B(k)})(T.type,E.type)||this.eu(T.doc,E.doc))),this.ou(s),o=o??!1;const d=t&&!o?this._u():[],p=this.Xa.size===0&&this.current&&!o?1:0,h=p!==this.Za;return this.Za=p,c.length!==0||h?{snapshot:new La(this.query,e.tu,l,c,e.mutatedKeys,p===0,h,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Je(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new zA(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new HA(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Je();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return La.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ig="SyncEngine";class JV{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class KV{constructor(e){this.key=e,this.hu=!1}}class $V{constructor(e,t,s,o,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ao((d=>rA(d)),rf),this.Iu=new Map,this.Eu=new Set,this.du=new Ct(we.comparator),this.Au=new Map,this.Ru=new Yp,this.Vu={},this.mu=new Map,this.fu=Ua.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function QV(n,e,t=!0){const s=$A(n);let o;const l=s.Tu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await GA(s,e,t,!0),o}async function XV(n,e){const t=$A(n);await GA(t,e,!0,!1)}async function GA(n,e,t,s){const o=await yV(n.localStore,Gi(e)),l=o.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return s&&(d=await WV(n,e,l,c==="current",o.resumeToken)),n.isPrimaryClient&&t&&PA(n.remoteStore,o),d}async function WV(n,e,t,s,o){n.pu=(E,A,I)=>(async function(B,F,Z,te){let K=F.view.ru(Z);K.Cs&&(K=await eE(B.localStore,F.query,!1).then((({documents:M})=>F.view.ru(M,K))));const Y=te&&te.targetChanges.get(F.targetId),ae=te&&te.targetMismatches.get(F.targetId)!=null,ee=F.view.applyChanges(K,B.isPrimaryClient,Y,ae);return cE(B,F.targetId,ee.au),ee.snapshot})(n,E,A,I);const l=await eE(n.localStore,e,!0),c=new YV(e,l.Qs),d=c.ru(l.documents),p=Cu.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",o),h=c.applyChanges(d,n.isPrimaryClient,p);cE(n,t,h.au);const T=new JV(e,t,c);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function ZV(n,e,t){const s=Ue(n),o=s.Tu.get(e),l=s.Iu.get(o.targetId);if(l.length>1)return s.Iu.set(o.targetId,l.filter((c=>!rf(c,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await hp(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),t&&Qp(s.remoteStore,o.targetId),gp(s,o.targetId)})).catch(Ya)):(gp(s,o.targetId),await hp(s.localStore,o.targetId,!0))}async function ek(n,e){const t=Ue(n),s=t.Tu.get(e),o=t.Iu.get(s.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Qp(t.remoteStore,s.targetId))}async function tk(n,e,t){const s=lk(n);try{const o=await(function(c,d){const p=Ue(c),h=_t.now(),T=d.reduce(((I,k)=>I.add(k.key)),Je());let E,A;return p.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let k=Ms(),B=Je();return p.Ns.getEntries(I,T).next((F=>{k=F,k.forEach(((Z,te)=>{te.isValidDocument()||(B=B.add(Z))}))})).next((()=>p.localDocuments.getOverlayedDocuments(I,k))).next((F=>{E=F;const Z=[];for(const te of d){const K=gP(te,E.get(te.key).overlayedDocument);K!=null&&Z.push(new bo(te.key,K,WS(K.value.mapValue),ji.exists(!0)))}return p.mutationQueue.addMutationBatch(I,h,Z,d)})).next((F=>{A=F;const Z=F.applyToLocalDocumentSet(E,B);return p.documentOverlayCache.saveOverlays(I,F.batchId,Z)}))})).then((()=>({batchId:A.batchId,changes:lA(E)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(c,d,p){let h=c.Vu[c.currentUser.toKey()];h||(h=new Ct(Ye)),h=h.insert(d,p),c.Vu[c.currentUser.toKey()]=h})(s,o.batchId,t),await wu(s,o.changes),await ff(s.remoteStore)}catch(o){const l=tg(o,"Failed to persist write");t.reject(l)}}async function jA(n,e){const t=Ue(n);try{const s=await mV(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const c=t.Au.get(l);c&&(at(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?c.hu=!0:o.modifiedDocuments.size>0?at(c.hu,14607):o.removedDocuments.size>0&&(at(c.hu,42227),c.hu=!1))})),await wu(t,s,e)}catch(s){await Ya(s)}}function uE(n,e,t){const s=Ue(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const o=[];s.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(c,d){const p=Ue(c);p.onlineState=d;let h=!1;p.queries.forEach(((T,E)=>{for(const A of E.Sa)A.va(d)&&(h=!0)})),h&&ng(p)})(s.eventManager,e),o.length&&s.Pu.H_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function nk(n,e,t){const s=Ue(n);s.sharedClientState.updateQueryState(e,"rejected",t);const o=s.Au.get(e),l=o&&o.key;if(l){let c=new Ct(we.comparator);c=c.insert(l,hn.newNoDocument(l,Pe.min()));const d=Je().add(l),p=new uf(Pe.min(),new Map,new Ct(Ye),c,d);await jA(s,p),s.du=s.du.remove(l),s.Au.delete(e),sg(s)}else await hp(s.localStore,e,!1).then((()=>gp(s,e,t))).catch(Ya)}async function ik(n,e){const t=Ue(n),s=e.batch.batchId;try{const o=await hV(t.localStore,e);JA(t,s,null),YA(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await wu(t,o)}catch(o){await Ya(o)}}async function sk(n,e,t){const s=Ue(n);try{const o=await(function(c,d){const p=Ue(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let T;return p.mutationQueue.lookupMutationBatch(h,d).next((E=>(at(E!==null,37113),T=E.keys(),p.mutationQueue.removeMutationBatch(h,E)))).next((()=>p.mutationQueue.performConsistencyCheck(h))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(h,T,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,T))).next((()=>p.localDocuments.getDocuments(h,T)))}))})(s.localStore,e);JA(s,e,t),YA(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await wu(s,o)}catch(o){await Ya(o)}}function YA(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function JA(n,e,t){const s=Ue(n);let o=s.Vu[s.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),s.Vu[s.currentUser.toKey()]=o}}function gp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||KA(n,s)}))}function KA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Qp(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),sg(n))}function cE(n,e,t){for(const s of t)s instanceof HA?(n.Ru.addReference(s.key,e),rk(n,s)):s instanceof zA?(_e(ig,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||KA(n,s.key)):Me(19791,{wu:s})}function rk(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(_e(ig,"New document in limbo: "+t),n.Eu.add(s),sg(n))}function sg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new we(St.fromString(e)),s=n.fu.next();n.Au.set(s,new KV(t)),n.du=n.du.insert(t,s),PA(n.remoteStore,new Tr(Gi(Bp(t.path)),s,"TargetPurposeLimboResolution",ef.ce))}}async function wu(n,e,t){const s=Ue(n),o=[],l=[],c=[];s.Tu.isEmpty()||(s.Tu.forEach(((d,p)=>{c.push(s.pu(p,e,t).then((h=>{var T;if((h||t)&&s.isPrimaryClient){const E=h?!h.fromCache:(T=t==null?void 0:t.targetChanges.get(p.targetId))==null?void 0:T.current;s.sharedClientState.updateQueryState(p.targetId,E?"current":"not-current")}if(h){o.push(h);const E=Kp.As(p.targetId,h);l.push(E)}})))})),await Promise.all(c),s.Pu.H_(o),await(async function(p,h){const T=Ue(p);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>le.forEach(h,(A=>le.forEach(A.Es,(I=>T.persistence.referenceDelegate.addReference(E,A.targetId,I))).next((()=>le.forEach(A.ds,(I=>T.persistence.referenceDelegate.removeReference(E,A.targetId,I)))))))))}catch(E){if(!Ja(E))throw E;_e($p,"Failed to update sequence numbers: "+E)}for(const E of h){const A=E.targetId;if(!E.fromCache){const I=T.Ms.get(A),k=I.snapshotVersion,B=I.withLastLimboFreeSnapshotVersion(k);T.Ms=T.Ms.insert(A,B)}}})(s.localStore,l))}async function ok(n,e){const t=Ue(n);if(!t.currentUser.isEqual(e)){_e(ig,"User change. New user:",e.toKey());const s=await RA(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((p=>{p.reject(new be(ue.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await wu(t,s.Ls)}}function ak(n,e){const t=Ue(n),s=t.Au.get(e);if(s&&s.hu)return Je().add(s.key);{let o=Je();const l=t.Iu.get(e);if(!l)return o;for(const c of l){const d=t.Tu.get(c);o=o.unionWith(d.view.nu)}return o}}function $A(n){const e=Ue(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ak.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nk.bind(null,e),e.Pu.H_=GV.bind(null,e.eventManager),e.Pu.yu=jV.bind(null,e.eventManager),e}function lk(n){const e=Ue(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ik.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sk.bind(null,e),e}class Bd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return fV(this.persistence,new uV,e.initialUser,this.serializer)}Cu(e){return new wA(Jp.mi,this.serializer)}Du(e){return new vV}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bd.provider={build:()=>new Bd};class uk extends Bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){at(this.persistence.referenceDelegate instanceof Od,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new KP(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new wA((s=>Od.mi(s,t)),this.serializer)}}class yp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>uE(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=ok.bind(null,this.syncEngine),await FV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new zV})()}createDatastore(e){const t=cf(e.databaseInfo.databaseId),s=(function(l){return new bV(l)})(e.databaseInfo);return(function(l,c,d,p){return new wV(l,c,d,p)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,o,l,c,d){return new NV(s,o,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>uE(this.syncEngine,t,0)),(function(){return iE.v()?new iE:new TV})())}createSyncEngine(e,t){return(function(o,l,c,d,p,h,T){const E=new $V(o,l,c,d,p,h);return T&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const l=Ue(o);_e(vo,"RemoteStore shutting down."),l.Ea.add(5),await Iu(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}yp.provider={build:()=>new yp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Rs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class ck{constructor(e,t,s,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=o,this.user=fn.UNAUTHENTICATED,this.clientId=Zd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async c=>{_e(Mr,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(s,(c=>(_e(Mr,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=tg(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Vm(n,e){n.asyncQueue.verifyOperationInProgress(),_e(Mr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async o=>{s.isEqual(o)||(await RA(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function dE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await dk(n);_e(Mr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>rE(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,o)=>rE(e.remoteStore,o))),n._onlineComponents=e}async function dk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){_e(Mr,"Using user provided OfflineComponentProvider");try{await Vm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ue.FAILED_PRECONDITION||o.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;_o("Error using user provided cache. Falling back to memory cache: "+t),await Vm(n,new Bd)}}else _e(Mr,"Using default OfflineComponentProvider"),await Vm(n,new uk(void 0));return n._offlineComponents}async function XA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(_e(Mr,"Using user provided OnlineComponentProvider"),await dE(n,n._uninitializedComponentsProvider._online)):(_e(Mr,"Using default OnlineComponentProvider"),await dE(n,new yp))),n._onlineComponents}function fk(n){return XA(n).then((e=>e.syncEngine))}async function WA(n){const e=await XA(n),t=e.eventManager;return t.onListen=QV.bind(null,e.syncEngine),t.onUnlisten=ZV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=XV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ek.bind(null,e.syncEngine),t}function hk(n,e,t={}){const s=new xs;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,h){const T=new QA({next:A=>{T.Nu(),c.enqueueAndForget((()=>BA(l,E)));const I=A.docs.has(d);!I&&A.fromCache?h.reject(new be(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&A.fromCache&&p&&p.source==="server"?h.reject(new be(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(A)},error:A=>h.reject(A)}),E=new FA(Bp(d.path),T,{includeMetadataChanges:!0,qa:!0});return qA(l,E)})(await WA(n),n.asyncQueue,e,t,s))),s.promise}function mk(n,e,t={}){const s=new xs;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,h){const T=new QA({next:A=>{T.Nu(),c.enqueueAndForget((()=>BA(l,E))),A.fromCache&&p.source==="server"?h.reject(new be(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(A)},error:A=>h.reject(A)}),E=new FA(d,T,{includeMetadataChanges:!0,qa:!0});return qA(l,E)})(await WA(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb="firestore.googleapis.com",hE=!0;class mE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new be(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eb,this.ssl=hE}else this.host=e.host,this.ssl=e.ssl??hE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=IA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YP)throw new be(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZA(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new be(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new be(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new be(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hf{constructor(e,t,s,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new be(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new be(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new qS;switch(s.type){case"firstParty":return new b2(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new be(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=fE.get(t);s&&(_e("ComponentProvider","Removing Datastore"),fE.delete(t),s.terminate())})(this),Promise.resolve()}}function tb(n,e,t,s={}){var h;n=Ns(n,hf);const o=za(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(AS(`https://${d}`),bS("Firestore",!0)),l.host!==eb&&l.host!==d&&_o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:d,ssl:o,emulatorOptions:s};if(!po(p,c)&&(n._setSettings(p),s.mockUserToken)){let T,E;if(typeof s.mockUserToken=="string")T=s.mockUserToken,E=fn.MOCK_USER;else{T=YM(s.mockUserToken,(h=n._app)==null?void 0:h.options.projectId);const A=s.mockUserToken.sub||s.mockUserToken.user_id;if(!A)throw new be(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new fn(A)}n._authCredentials=new E2(new OS(T,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Ru(this.firestore,e,this._query)}}class Yt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}toJSON(){return{type:Yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(bu(t,Yt._jsonSchema))return new Yt(e,s||null,new we(St.fromString(t.referencePath)))}}Yt._jsonSchemaVersion="firestore/documentReference/1.0",Yt._jsonSchema={type:jt("string",Yt._jsonSchemaVersion),referencePath:jt("string")};class Cs extends Ru{constructor(e,t,s){super(e,t,Bp(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new we(e))}withConverter(e){return new Cs(this.firestore,e,this._path)}}function pk(n,e,...t){if(n=_n(n),BS("collection","path",e),n instanceof hf){const s=St.fromString(e,...t);return wT(s),new Cs(n,null,s)}{if(!(n instanceof Yt||n instanceof Cs))throw new be(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(St.fromString(e,...t));return wT(s),new Cs(n.firestore,null,s)}}function gk(n,e,...t){if(n=_n(n),arguments.length===1&&(e=Zd.newId()),BS("doc","path",e),n instanceof hf){const s=St.fromString(e,...t);return IT(s),new Yt(n,null,new we(s))}{if(!(n instanceof Yt||n instanceof Cs))throw new be(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(St.fromString(e,...t));return IT(s),new Yt(n.firestore,n instanceof Cs?n.converter:null,new we(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="AsyncQueue";class gE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new MA(this,"async_queue_retry"),this._c=()=>{const s=Pm();s&&_e(pE,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Pm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new xs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ja(e))throw e;_e(pE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Rs("INTERNAL UNHANDLED ERROR: ",yE(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=eg.createAndSchedule(this,e,t,s,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&Me(47125,{Pc:yE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class $a extends hf{constructor(e,t,s,o){super(e,t,s,o),this.type="firestore",this._queue=new gE,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gE(e),this._firestoreClient=void 0,await e}}}function nb(n,e){const t=typeof n=="object"?n:wS(),s=typeof n=="string"?n:Md,o=Dp(t,"firestore").getImmediate({identifier:s});if(!o._initialized){const l=GM("firestore");l&&tb(o,...l)}return o}function mf(n){if(n._terminated)throw new be(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yk(n),n._firestoreClient}function yk(n){var s,o,l;const e=n._freezeSettings(),t=(function(d,p,h,T){return new B2(d,p,h,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,ZA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new ck(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const p=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(p),_online:p}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this._byteString=e}static fromBase64String(e){try{return new On(nn.fromBase64String(e))}catch(t){throw new be(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new On(nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:On._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bu(e,On._jsonSchema))return On.fromBase64String(e.bytes)}}On._jsonSchemaVersion="firestore/bytes/1.0",On._jsonSchema={type:jt("string",On._jsonSchemaVersion),bytes:jt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new be(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new be(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new be(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ye(this._lat,e._lat)||Ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mi._jsonSchemaVersion}}static fromJSON(e){if(bu(e,mi._jsonSchema))return new mi(e.latitude,e.longitude)}}mi._jsonSchemaVersion="firestore/geoPoint/1.0",mi._jsonSchema={type:jt("string",mi._jsonSchemaVersion),latitude:jt("number"),longitude:jt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bu(e,pi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new pi(e.vectorValues);throw new be(ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pi._jsonSchemaVersion="firestore/vectorValue/1.0",pi._jsonSchema={type:jt("string",pi._jsonSchemaVersion),vectorValues:jt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=/^__.*__$/;class vk{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new bo(e,this.data,this.fieldMask,t,this.fieldTransforms):new xu(e,this.data,t,this.fieldTransforms)}}function ib(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:n})}}class og{constructor(e,t,s,o,l,c){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new og({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ib(this.Ac)&&_k.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Tk{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||cf(e)}Cc(e,t,s,o=!1){return new og({Ac:e,methodName:t,Dc:s,path:tn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ek(n){const e=n._freezeSettings(),t=cf(n._databaseId);return new Tk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sk(n,e,t,s,o,l={}){const c=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);ab("Data must be an object, but it was:",c,s);const d=rb(s,c);let p,h;if(l.merge)p=new fi(c.fieldMask),h=c.fieldTransforms;else if(l.mergeFields){const T=[];for(const E of l.mergeFields){const A=Ak(e,E,t);if(!c.contains(A))throw new be(ue.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);xk(T,A)||T.push(A)}p=new fi(T),h=c.fieldTransforms.filter((E=>p.covers(E.field)))}else p=null,h=c.fieldTransforms;return new vk(new Wn(d),p,h)}function sb(n,e){if(ob(n=_n(n)))return ab("Unsupported field value:",e,n),rb(n,e);if(n instanceof rg)return(function(s,o){if(!ib(o.Ac))throw o.Sc(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,o){const l=[];let c=0;for(const d of s){let p=sb(d,o.wc(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}})(n,e)}return(function(s,o){if((s=_n(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return cP(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=_t.fromDate(s);return{timestampValue:Ld(o.serializer,l)}}if(s instanceof _t){const l=new _t(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ld(o.serializer,l)}}if(s instanceof mi)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof On)return{bytesValue:TA(o.serializer,s._byteString)};if(s instanceof Yt){const l=o.databaseId,c=s.firestore._databaseId;if(!c.isEqual(l))throw o.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:jp(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof pi)return(function(c,d){return{mapValue:{fields:{[QS]:{stringValue:XS},[Dd]:{arrayValue:{values:c.toArray().map((h=>{if(typeof h!="number")throw d.Sc("VectorValues must only contain numeric values.");return Fp(d.serializer,h)}))}}}}}})(s,o);throw o.Sc(`Unsupported field value: ${Vp(s)}`)})(n,e)}function rb(n,e){const t={};return GS(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):So(n,((s,o)=>{const l=sb(o,e.mc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function ob(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof mi||n instanceof On||n instanceof Yt||n instanceof rg||n instanceof pi)}function ab(n,e,t){if(!ob(t)||!HS(t)){const s=Vp(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Ak(n,e,t){if((e=_n(e))instanceof pf)return e._internalPath;if(typeof e=="string")return lb(n,e);throw Fd("Field path arguments must be of type string or ",n,!1,void 0,t)}const bk=new RegExp("[~\\*/\\[\\]]");function lb(n,e,t){if(e.search(bk)>=0)throw Fd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pf(...e.split("."))._internalPath}catch{throw Fd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fd(n,e,t,s,o){const l=s&&!s.isEmpty(),c=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${s}`),c&&(p+=` in document ${o}`),p+=")"),new be(ue.INVALID_ARGUMENT,d+n+p)}function xk(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,t,s,o,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ck(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(cb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Ck extends ub{data(){return super.data()}}function cb(n,e){return typeof e=="string"?lb(n,e):e instanceof pf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new be(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class db{convertValue(e,t="none"){switch(Rr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return So(e,((o,l)=>{s[o]=this.convertValue(l,t)})),s}convertVectorValue(e){var s,o,l;const t=(l=(o=(s=e.fields)==null?void 0:s[Dd].arrayValue)==null?void 0:o.values)==null?void 0:l.map((c=>Vt(c.doubleValue)));return new pi(t)}convertGeoPoint(e){return new mi(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=nf(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(pu(e));default:return null}}convertTimestamp(e){const t=Ir(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=St.fromString(e);at(CA(s),9688,{name:e});const o=new Pa(s.get(1),s.get(3)),l=new we(s.popFirst(5));return o.isEqual(t)||Rs(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Ea{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xr extends ub{constructor(e,t,s,o,l,c){super(e,t,s,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new du(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(cb("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new be(ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}xr._jsonSchemaVersion="firestore/documentSnapshot/1.0",xr._jsonSchema={type:jt("string",xr._jsonSchemaVersion),bundleSource:jt("string","DocumentSnapshot"),bundleName:jt("string"),bundle:jt("string")};class du extends xr{data(e={}){return super.data(e)}}class ho{constructor(e,t,s,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Ea(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new du(this._firestore,this._userDataWriter,s.key,s,new Ea(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new be(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map((d=>{const p=new du(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ea(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}}))}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const p=new du(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ea(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,T=-1;return d.type!==0&&(h=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),T=c.indexOf(d.doc.key)),{type:Rk(d.type),doc:p,oldIndex:h,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new be(ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ho._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Rk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(n){n=Ns(n,Yt);const e=Ns(n.firestore,$a);return hk(mf(e),n._key).then((t=>Vk(e,n,t)))}ho._jsonSchemaVersion="firestore/querySnapshot/1.0",ho._jsonSchema={type:jt("string",ho._jsonSchemaVersion),bundleSource:jt("string","QuerySnapshot"),bundleName:jt("string"),bundle:jt("string")};class fb extends db{constructor(e){super(),this.firestore=e}convertBytes(e){return new On(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,t)}}function Mk(n){n=Ns(n,Ru);const e=Ns(n.firestore,$a),t=mf(e),s=new fb(e);return Ik(n._query),mk(t,n._query).then((o=>new ho(e,s,n,o)))}function Dk(n,e,t){n=Ns(n,Yt);const s=Ns(n.firestore,$a),o=wk(n.converter,e,t);return ag(s,[Sk(Ek(s),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,ji.none())])}function Pk(n){return ag(Ns(n.firestore,$a),[new Hp(n._key,ji.none())])}function ag(n,e){return(function(s,o){const l=new xs;return s.asyncQueue.enqueueAndForget((async()=>tk(await fk(s),o,l))),l.promise})(mf(n),e)}function Vk(n,e,t){const s=t.docs.get(e._key),o=new fb(n);return new xr(n,o,e._key,s,new Ea(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){ja=o})(Ga),Ma(new go("firestore",((s,{instanceIdentifier:o,options:l})=>{const c=s.getProvider("app").getImmediate(),d=new $a(new S2(s.getProvider("auth-internal")),new x2(c,s.getProvider("app-check-internal")),(function(h,T){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new be(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pa(h.options.projectId,T)})(c,o),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),Ar(AT,bT,e),Ar(AT,bT,"esm2020")})();const dd=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:db,Bytes:On,CollectionReference:Cs,DocumentReference:Yt,DocumentSnapshot:xr,FieldPath:pf,FieldValue:rg,Firestore:$a,FirestoreError:be,GeoPoint:mi,Query:Ru,QueryDocumentSnapshot:du,QuerySnapshot:ho,SnapshotMetadata:Ea,Timestamp:_t,VectorValue:pi,_AutoId:Zd,_ByteString:nn,_DatabaseId:Pa,_DocumentKey:we,_EmptyAuthCredentialsProvider:qS,_FieldPath:tn,_cast:Ns,_logWarn:_o,_validateIsNotUsedTogether:FS,collection:pk,connectFirestoreEmulator:tb,deleteDoc:Pk,doc:gk,ensureFirestoreConfigured:mf,executeWrite:ag,getDoc:Nk,getDocs:Mk,getFirestore:nb,setDoc:Dk},Symbol.toStringTag,{value:"Module"}));function hb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mb=hb,pb=new Su("auth","Firebase",hb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=new Np("@firebase/auth");function kk(n,...e){Hd.logLevel<=je.WARN&&Hd.warn(`Auth (${Ga}): ${n}`,...e)}function Td(n,...e){Hd.logLevel<=je.ERROR&&Hd.error(`Auth (${Ga}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(n,...e){throw lg(n,...e)}function Ji(n,...e){return lg(n,...e)}function gb(n,e,t){const s={...mb(),[e]:t};return new Su("auth","Firebase",s).create(e,{appName:n.name})}function Is(n){return gb(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lg(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return pb.create(n,...e)}function Ne(n,e,...t){if(!n)throw lg(e,...t)}function As(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Td(e),new Error(e)}function Ds(n,e){n||As(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Uk(){return _E()==="http:"||_E()==="https:"}function _E(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Uk()||WM()||"connection"in navigator)?navigator.onLine:!0}function Ok(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ds(t>e,"Short delay should be less than long delay!"),this.isMobile=$M()||ZM()}get(){return Lk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(n,e){Ds(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;As("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;As("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;As("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fk=new Nu(3e4,6e4);function Vr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ks(n,e,t,s,o={}){return _b(n,o,async()=>{let l={},c={};s&&(e==="GET"?c=s:l={body:JSON.stringify(s)});const d=Au({key:n.config.apiKey,...c}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:p,...l};return XM()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&za(n.emulatorConfig.host)&&(h.credentials="include"),yb.fetch()(await vb(n,n.config.apiHost,t,d),h)})}async function _b(n,e,t){n._canInitEmulator=!1;const s={...qk,...e};try{const o=new zk(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw fd(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[p,h]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw fd(n,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw fd(n,"email-already-in-use",c);if(p==="USER_DISABLED")throw fd(n,"user-disabled",c);const T=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw gb(n,T,h);gi(n,T)}}catch(o){if(o instanceof Vs)throw o;gi(n,"network-request-failed",{message:String(o)})}}async function Mu(n,e,t,s,o={}){const l=await ks(n,e,t,s,o);return"mfaPendingCredential"in l&&gi(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function vb(n,e,t,s){const o=`${e}${t}?${s}`,l=n,c=l.config.emulator?ug(n.config,o):`${n.config.apiScheme}://${o}`;return Bk.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function Hk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Ji(this.auth,"network-request-failed")),Fk.get())})}}function fd(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const o=Ji(n,e,s);return o.customData._tokenResponse=t,o}function vE(n){return n!==void 0&&n.enterprise!==void 0}class Gk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Hk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jk(n,e){return ks(n,"GET","/v2/recaptchaConfig",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yk(n,e){return ks(n,"POST","/v1/accounts:delete",e)}async function zd(n,e){return ks(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Tb(n,e=!1){const t=_n(n),s=await t.getIdToken(e),o=cg(s);Ne(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:o,token:s,authTime:fu(km(o.auth_time)),issuedAtTime:fu(km(o.iat)),expirationTime:fu(km(o.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function km(n){return Number(n)*1e3}function cg(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Td("JWT malformed, contained fewer than 3 sections"),null;try{const o=vS(t);return o?JSON.parse(o):(Td("Failed to decode base64 JWT payload"),null)}catch(o){return Td("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function TE(n){const e=cg(n);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oa(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Vs&&Jk(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function Jk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gd(n){var E;const e=n.auth,t=await n.getIdToken(),s=await Oa(n,zd(e,{idToken:t}));Ne(s==null?void 0:s.users.length,e,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const l=(E=o.providerUserInfo)!=null&&E.length?Sb(o.providerUserInfo):[],c=$k(n.providerData,l),d=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!(c!=null&&c.length),h=d?p:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new vp(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,T)}async function Eb(n){const e=_n(n);await Gd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $k(n,e){return[...n.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function Sb(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qk(n,e){const t=await _b(n,{},async()=>{const s=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,c=await vb(n,o,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:s};return n.emulatorConfig&&za(n.emulatorConfig.host)&&(p.credentials="include"),yb.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Xk(n,e){return ks(n,"POST","/v2/accounts:revokeToken",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):TE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const t=TE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:o,expiresIn:l}=await Qk(e,t);this.updateTokensAndExpiration(s,o,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:o,expirationTime:l}=t,c=new wa;return s&&(Ne(typeof s=="string","internal-error",{appName:e}),c.refreshToken=s),o&&(Ne(typeof o=="string","internal-error",{appName:e}),c.accessToken=o),l&&(Ne(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wa,this.toJSON())}_performRefresh(){return As("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(n,e){Ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class hi{constructor({uid:e,auth:t,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new Kk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new vp(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Oa(this,this.stsTokenManager.getToken(this.auth,e));return Ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Tb(this,e)}reload(){return Eb(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Gd(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xn(this.auth.app))return Promise.reject(Is(this.auth));const e=await this.getIdToken();return await Oa(this,Yk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,h=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:E,emailVerified:A,isAnonymous:I,providerData:k,stsTokenManager:B}=t;Ne(E&&B,e,"internal-error");const F=wa.fromJSON(this.name,B);Ne(typeof E=="string",e,"internal-error"),_r(s,e.name),_r(o,e.name),Ne(typeof A=="boolean",e,"internal-error"),Ne(typeof I=="boolean",e,"internal-error"),_r(l,e.name),_r(c,e.name),_r(d,e.name),_r(p,e.name),_r(h,e.name),_r(T,e.name);const Z=new hi({uid:E,auth:e,email:o,emailVerified:A,displayName:s,isAnonymous:I,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:F,createdAt:h,lastLoginAt:T});return k&&Array.isArray(k)&&(Z.providerData=k.map(te=>({...te}))),p&&(Z._redirectEventId=p),Z}static async _fromIdTokenResponse(e,t,s=!1){const o=new wa;o.updateFromServerResponse(t);const l=new hi({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await Gd(l),l}static async _fromGetAccountInfoResponse(e,t,s){const o=t.users[0];Ne(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?Sb(o.providerUserInfo):[],c=!(o.email&&o.passwordHash)&&!(l!=null&&l.length),d=new wa;d.updateFromIdToken(s);const p=new hi({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:c}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new vp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(l!=null&&l.length)};return Object.assign(p,h),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=new Map;function bs(n){Ds(n instanceof Function,"Expected a class definition");let e=EE.get(n);return e?(Ds(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,EE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ab.type="NONE";const Tp=Ab;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(n,e,t){return`firebase:${n}:${e}:${t}`}class Ra{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:o,name:l}=this.auth;this.fullUserKey=Ed(this.userKey,o.apiKey,l),this.fullPersistenceKey=Ed("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await zd(this.auth,{idToken:e}).catch(()=>{});return t?hi._fromGetAccountInfoResponse(this.auth,t,e):null}return hi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Ra(bs(Tp),e,s);const o=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let l=o[0]||bs(Tp);const c=Ed(s,e.config.apiKey,e.name);let d=null;for(const h of t)try{const T=await h._get(c);if(T){let E;if(typeof T=="string"){const A=await zd(e,{idToken:T}).catch(()=>{});if(!A)break;E=await hi._fromGetAccountInfoResponse(e,A,T)}else E=hi._fromJSON(e,T);h!==l&&(d=E),l=h;break}}catch{}const p=o.filter(h=>h._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Ra(l,e,s):(l=p[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async h=>{if(h!==l)try{await h._remove(c)}catch{}})),new Ra(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ib(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rb(e))return"Blackberry";if(Nb(e))return"Webos";if(xb(e))return"Safari";if((e.includes("chrome/")||Cb(e))&&!e.includes("edge/"))return"Chrome";if(wb(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function bb(n=pn()){return/firefox\//i.test(n)}function xb(n=pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cb(n=pn()){return/crios\//i.test(n)}function Ib(n=pn()){return/iemobile/i.test(n)}function wb(n=pn()){return/android/i.test(n)}function Rb(n=pn()){return/blackberry/i.test(n)}function Nb(n=pn()){return/webos/i.test(n)}function dg(n=pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Wk(n=pn()){var e;return dg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function Zk(){return eD()&&document.documentMode===10}function Mb(n=pn()){return dg(n)||wb(n)||Nb(n)||Rb(n)||/windows phone/i.test(n)||Ib(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(n,e=[]){let t;switch(n){case"Browser":t=SE(pn());break;case"Worker":t=`${SE(pn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ga}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((c,d)=>{try{const p=e(l);c(p)}catch(p){d(p)}});s.onAbort=t,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tU(n,e={}){return ks(n,"GET","/v2/passwordPolicy",Vr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU=6;class iU{constructor(e){var s;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??nU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(e,t,s,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AE(this),this.idTokenSubscription=new AE(this),this.beforeStateQueue=new eU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bs(t)),this._initializationPromise=this.queue(async()=>{var s,o,l;if(!this._deleted&&(this.persistenceManager=await Ra.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await zd(this,{idToken:e}),s=await hi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(Xn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=s==null?void 0:s._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&(p!=null&&p.user)&&(s=p.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ok()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xn(this.app))return Promise.reject(Is(this));const t=e?_n(e):null;return t&&Ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xn(this.app)?Promise.reject(Is(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xn(this.app)?Promise.reject(Is(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tU(this),t=new iU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Su("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await Xk(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bs(e)||this._popupRedirectResolver;Ne(t,this,"argument-error"),this.redirectPersistenceManager=await Ra.create(this,[bs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,s,o);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Db(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var t;if(Xn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&kk(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Co(n){return _n(n)}class AE{constructor(e){this.auth=e,this.observer=null,this.addObserver=lD(t=>this.observer=t)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rU(n){gf=n}function Pb(n){return gf.loadJS(n)}function oU(){return gf.recaptchaEnterpriseScript}function aU(){return gf.gapiScript}function lU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class uU{constructor(){this.enterprise=new cU}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class cU{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const dU="recaptcha-enterprise",Vb="NO_RECAPTCHA";class fU{constructor(e){this.type=dU,this.auth=Co(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{jk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const h=new Gk(p);return l.tenantId==null?l._agentRecaptchaConfig=h:l._tenantRecaptchaConfigs[l.tenantId]=h,c(h.siteKey)}}).catch(p=>{d(p)})})}function o(l,c,d){const p=window.grecaptcha;vE(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(h=>{c(h)}).catch(()=>{c(Vb)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new uU().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{s(this.auth).then(d=>{if(!t&&vE(window.grecaptcha))o(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=oU();p.length!==0&&(p+=d),Pb(p).then(()=>{o(d,l,c)}).catch(h=>{c(h)})}}).catch(d=>{c(d)})})}}async function bE(n,e,t,s=!1,o=!1){const l=new fU(n);let c;if(o)c=Vb;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,h=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return s?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Ep(n,e,t,s,o){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await bE(n,e,t,t==="getOobCode");return s(n,c)}else return s(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await bE(n,e,t,t==="getOobCode");return s(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(n,e){const t=Dp(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(po(l,e??{}))return o;gi(o,"already-initialized")}return t.initialize({options:e})}function hU(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(bs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function Ub(n,e,t){const s=Co(n);Ne(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,l=Lb(e),{host:c,port:d}=mU(e),p=d===null?"":`:${d}`,h={url:`${l}//${c}${p}/`},T=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){Ne(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ne(po(h,s.config.emulator)&&po(T,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=h,s.emulatorConfig=T,s.settings.appVerificationDisabledForTesting=!0,za(c)?(AS(`${l}//${c}${p}`),bS("Auth",!0)):pU()}function Lb(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mU(n){const e=Lb(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const l=o[1];return{host:l,port:xE(s.substr(l.length+1))}}else{const[l,c]=s.split(":");return{host:l,port:xE(c)}}}function xE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return As("not implemented")}_getIdTokenResponse(e){return As("not implemented")}_linkToIdToken(e,t){return As("not implemented")}_getReauthenticationResolver(e){return As("not implemented")}}async function gU(n,e){return ks(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yU(n,e){return Mu(n,"POST","/v1/accounts:signInWithPassword",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _U(n,e){return Mu(n,"POST","/v1/accounts:signInWithEmailLink",Vr(n,e))}async function vU(n,e){return Mu(n,"POST","/v1/accounts:signInWithEmailLink",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa extends yf{constructor(e,t,s,o=null){super("password",s),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new qa(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new qa(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ep(e,t,"signInWithPassword",yU);case"emailLink":return _U(e,{email:this._email,oobCode:this._password});default:gi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ep(e,s,"signUpPassword",gU);case"emailLink":return vU(e,{idToken:t,email:this._email,oobCode:this._password});default:gi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Na(n,e){return Mu(n,"POST","/v1/accounts:signInWithIdp",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU="http://localhost";class Dr extends yf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...l}=t;if(!s||!o)return null;const c=new Dr(s,o);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Na(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Na(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Na(e,t)}buildRequest(){const e={requestUri:TU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Au(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SU(n){const e=eu(tu(n)).link,t=e?eu(tu(e)).deep_link_id:null,s=eu(tu(n)).deep_link_id;return(s?eu(tu(s)).link:null)||s||t||e||n}class _f{constructor(e){const t=eu(tu(e)),s=t.apiKey??null,o=t.oobCode??null,l=EU(t.mode??null);Ne(s&&o&&l,"argument-error"),this.apiKey=s,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=SU(e);try{return new _f(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.providerId=Io.PROVIDER_ID}static credential(e,t){return qa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_f.parseLink(t);return Ne(s,"argument-error"),qa._fromEmailAndCode(e,s.code,s.tenantId)}}Io.PROVIDER_ID="password";Io.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Io.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends Ob{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends Du{constructor(){super("facebook.com")}static credential(e){return Dr._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _s.credential(e.oauthAccessToken)}catch{return null}}}_s.FACEBOOK_SIGN_IN_METHOD="facebook.com";_s.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dr._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return vs.credential(t,s)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Du{constructor(){super("github.com")}static credential(e){return Dr._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Du{constructor(){super("twitter.com")}static credential(e,t){return Dr._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Es.credential(t,s)}catch{return null}}}Es.TWITTER_SIGN_IN_METHOD="twitter.com";Es.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AU(n,e){return Mu(n,"POST","/v1/accounts:signUp",Vr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,o=!1){const l=await hi._fromIdTokenResponse(e,s,o),c=CE(s);return new To({user:l,providerId:c,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const o=CE(s);return new To({user:e,providerId:o,_tokenResponse:s,operationType:t})}}function CE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd extends Vs{constructor(e,t,s,o){super(t.code,t.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,jd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,o){return new jd(e,t,s,o)}}function qb(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?jd._fromErrorAndOperation(n,l,e,s):l})}async function bU(n,e,t=!1){const s=await Oa(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return To._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xU(n,e,t=!1){const{auth:s}=n;if(Xn(s.app))return Promise.reject(Is(s));const o="reauthenticate";try{const l=await Oa(n,qb(s,o,e,n),t);Ne(l.idToken,s,"internal-error");const c=cg(l.idToken);Ne(c,s,"internal-error");const{sub:d}=c;return Ne(n.uid===d,s,"user-mismatch"),To._forOperation(n,o,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&gi(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bb(n,e,t=!1){if(Xn(n.app))return Promise.reject(Is(n));const s="signIn",o=await qb(n,s,e),l=await To._fromIdTokenResponse(n,s,o);return t||await n._updateCurrentUser(l.user),l}async function Fb(n,e){return Bb(Co(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hb(n){const e=Co(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CU(n,e,t){if(Xn(n.app))return Promise.reject(Is(n));const s=Co(n),c=await Ep(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AU).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&Hb(n),p}),d=await To._fromIdTokenResponse(s,"signIn",c);return await s._updateCurrentUser(d.user),d}function IU(n,e,t){return Xn(n.app)?Promise.reject(Is(n)):Fb(_n(n),Io.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&Hb(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wU(n,e){return ks(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RU(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=_n(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await Oa(s,wU(s.auth,l));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;const d=s.providerData.find(({providerId:p})=>p==="password");d&&(d.displayName=s.displayName,d.photoURL=s.photoURL),await s._updateTokensIfNecessary(c)}function zb(n,e,t,s){return _n(n).onIdTokenChanged(e,t,s)}function Gb(n,e,t){return _n(n).beforeAuthStateChanged(e,t)}function NU(n,e,t,s){return _n(n).onAuthStateChanged(e,t,s)}function MU(n){return _n(n).signOut()}const Yd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Yd,"1"),this.storage.removeItem(Yd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU=1e3,PU=10;class Yb extends jb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),o=this.localCache[t];s!==o&&e(t,o,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,p)=>{this.notifyListeners(c,p)});return}const s=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(s);!t&&this.localCache[s]===c||this.notifyListeners(s,c)},l=this.storage.getItem(s);Zk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,PU):o()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},DU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Yb.type="LOCAL";const Jb=Yb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb extends jb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Kb.type="SESSION";const fg=Kb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const s=new vf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:o,data:l}=t.data,c=this.handlersMap[o];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const d=Array.from(c).map(async h=>h(t.origin,l)),p=await VU(d);t.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,c;return new Promise((d,p)=>{const h=hg("",20);o.port1.start();const T=setTimeout(()=>{p(new Error("unsupported_event"))},s);c={messageChannel:o,onMessage(E){const A=E;if(A.data.eventId===h)switch(A.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(A.data.response);break;default:clearTimeout(T),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),o.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[o.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(){return window}function UU(n){Ki().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(){return typeof Ki().WorkerGlobalScope<"u"&&typeof Ki().importScripts=="function"}async function LU(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function OU(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function qU(){return $b()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb="firebaseLocalStorageDb",BU=1,Jd="firebaseLocalStorage",Xb="fbase_key";class Pu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Tf(n,e){return n.transaction([Jd],e?"readwrite":"readonly").objectStore(Jd)}function FU(){const n=indexedDB.deleteDatabase(Qb);return new Pu(n).toPromise()}function Sp(){const n=indexedDB.open(Qb,BU);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Jd,{keyPath:Xb})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Jd)?e(s):(s.close(),await FU(),e(await Sp()))})})}async function IE(n,e,t){const s=Tf(n,!0).put({[Xb]:e,value:t});return new Pu(s).toPromise()}async function HU(n,e){const t=Tf(n,!1).get(e),s=await new Pu(t).toPromise();return s===void 0?null:s.value}function wE(n,e){const t=Tf(n,!0).delete(e);return new Pu(t).toPromise()}const zU=800,GU=3;class Wb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>GU)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $b()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vf._getInstance(qU()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,s;if(this.activeServiceWorker=await LU(),!this.activeServiceWorker)return;this.sender=new kU(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||OU()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await IE(e,Yd,"1"),await wE(e,Yd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>IE(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>HU(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>wE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=Tf(o,!1).getAll();return new Pu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Wb.type="LOCAL";const Zb=Wb;new Nu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(n,e){return e?bs(e):(Ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg extends yf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Na(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Na(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Na(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function YU(n){return Bb(n.auth,new mg(n),n.bypassAuthState)}function JU(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),xU(t,new mg(n),n.bypassAuthState)}async function KU(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),bU(t,new mg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e,t,s,o,l=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:o,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return YU;case"linkViaPopup":case"linkViaRedirect":return KU;case"reauthViaPopup":case"reauthViaRedirect":return JU;default:gi(this.auth,"internal-error")}}resolve(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U=new Nu(2e3,1e4);class Sa extends ex{constructor(e,t,s,o,l){super(e,t,o,l),this.provider=s,this.authWindow=null,this.pollId=null,Sa.currentPopupAction&&Sa.currentPopupAction.cancel(),Sa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Ds(this.filter.length===1,"Popup operations only handle one event");const e=hg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ji(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ji(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if((s=(t=this.authWindow)==null?void 0:t.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ji(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$U.get())};e()}}Sa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU="pendingRedirect",Sd=new Map;class XU extends ex{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Sd.get(this.auth._key());if(!e){try{const s=await WU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Sd.set(this.auth._key(),e)}return this.bypassAuthState||Sd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WU(n,e){const t=tL(e),s=eL(n);if(!await s._isAvailable())return!1;const o=await s._get(t)==="true";return await s._remove(t),o}function ZU(n,e){Sd.set(n._key(),e)}function eL(n){return bs(n._redirectPersistence)}function tL(n){return Ed(QU,n.config.apiKey,n.name)}async function nL(n,e,t=!1){if(Xn(n.app))return Promise.reject(Is(n));const s=Co(n),o=jU(s,e),c=await new XU(s,o,t).execute();return c&&!t&&(delete c.user._redirectEventId,await s._persistUserIfCurrent(c.user),await s._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=600*1e3;class sL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!tx(e)){const o=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";t.onError(Ji(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iL&&this.cachedEventUids.clear(),this.cachedEventUids.has(RE(e))}saveEventToCache(e){this.cachedEventUids.add(RE(e)),this.lastProcessedEventTime=Date.now()}}function RE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function tx({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tx(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oL(n,e={}){return ks(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lL=/^https?/;async function uL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await oL(n);for(const t of e)try{if(cL(t))return}catch{}gi(n,"unauthorized-domain")}function cL(n){const e=_p(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===s}if(!lL.test(t))return!1;if(aL.test(n))return s===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=new Nu(3e4,6e4);function NE(){const n=Ki().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function fL(n){return new Promise((e,t)=>{var o,l,c;function s(){NE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{NE(),t(Ji(n,"network-request-failed"))},timeout:dL.get()})}if((l=(o=Ki().gapi)==null?void 0:o.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=Ki().gapi)!=null&&c.load)s();else{const d=lU("iframefcb");return Ki()[d]=()=>{gapi.load?s():t(Ji(n,"network-request-failed"))},Pb(`${aU()}?onload=${d}`).catch(p=>t(p))}}).catch(e=>{throw Ad=null,e})}let Ad=null;function hL(n){return Ad=Ad||fL(n),Ad}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL=new Nu(5e3,15e3),pL="__/auth/iframe",gL="emulator/auth/iframe",yL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_L=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vL(n){const e=n.config;Ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ug(e,gL):`https://${n.config.authDomain}/${pL}`,s={apiKey:e.apiKey,appName:n.name,v:Ga},o=_L.get(n.config.apiHost);o&&(s.eid=o);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Au(s).slice(1)}`}async function TL(n){const e=await hL(n),t=Ki().gapi;return Ne(t,n,"internal-error"),e.open({where:document.body,url:vL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yL,dontclear:!0},s=>new Promise(async(o,l)=>{await s.restyle({setHideOnLeave:!1});const c=Ji(n,"network-request-failed"),d=Ki().setTimeout(()=>{l(c)},mL.get());function p(){Ki().clearTimeout(d),o(s)}s.ping(p).then(p,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},SL=500,AL=600,bL="_blank",xL="http://localhost";class ME{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CL(n,e,t,s=SL,o=AL){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),c=Math.max((window.screen.availWidth-s)/2,0).toString();let d="";const p={...EL,width:s.toString(),height:o.toString(),top:l,left:c},h=pn().toLowerCase();t&&(d=Cb(h)?bL:t),bb(h)&&(e=e||xL,p.scrollbars="yes");const T=Object.entries(p).reduce((A,[I,k])=>`${A}${I}=${k},`,"");if(Wk(h)&&d!=="_self")return IL(e||"",d),new ME(null);const E=window.open(e||"",d,T);Ne(E,n,"popup-blocked");try{E.focus()}catch{}return new ME(E)}function IL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL="__/auth/handler",RL="emulator/auth/handler",NL=encodeURIComponent("fac");async function DE(n,e,t,s,o,l){Ne(n.config.authDomain,n,"auth-domain-config-required"),Ne(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Ga,eventId:o};if(e instanceof Ob){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",aD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,E]of Object.entries({}))c[T]=E}if(e instanceof Du){const T=e.getScopes().filter(E=>E!=="");T.length>0&&(c.scopes=T.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const T of Object.keys(d))d[T]===void 0&&delete d[T];const p=await n._getAppCheckToken(),h=p?`#${NL}=${encodeURIComponent(p)}`:"";return`${ML(n)}?${Au(d).slice(1)}${h}`}function ML({config:n}){return n.emulator?ug(n,RL):`https://${n.authDomain}/${wL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="webStorageSupport";class DL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fg,this._completeRedirectFn=nL,this._overrideRedirectResult=ZU}async _openPopup(e,t,s,o){var c;Ds((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await DE(e,t,s,_p(),o);return CL(e,l,hg())}async _openRedirect(e,t,s,o){await this._originValidation(e);const l=await DE(e,t,s,_p(),o);return UU(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(Ds(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await TL(e),s=new sL(e);return t.register("authEvent",o=>(Ne(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Um,{type:Um},o=>{var c;const l=(c=o==null?void 0:o[0])==null?void 0:c[Um];l!==void 0&&t(!!l),gi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mb()||xb()||dg()}}const nx=DL;var PE="@firebase/auth",VE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kL(n){Ma(new go("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=s.options;Ne(c&&!c.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Db(n)},h=new sU(s,o,l,p);return hU(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Ma(new go("auth-internal",e=>{const t=Co(e.getProvider("auth").getImmediate());return(s=>new PL(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ar(PE,VE,VL(n)),Ar(PE,VE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=300,LL=SS("authIdTokenMaxAge")||UL;let kE=null;const OL=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>LL)return;const o=t==null?void 0:t.token;kE!==o&&(kE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function ix(n=wS()){const e=Dp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=kb(n,{popupRedirectResolver:nx,persistence:[Zb,Jb,fg]}),s=SS("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const c=OL(l.toString());Gb(t,c,()=>c(t.currentUser)),zb(t,d=>c(d))}}const o=TS("auth");return o&&Ub(t,`http://${o}`),t}function qL(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}rU({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=o=>{const l=Ji("internal-error");l.customData=o,t(l)},s.type="text/javascript",s.charset="UTF-8",qL().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kL("Browser");const hd=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:_f,AuthCredential:yf,EmailAuthCredential:qa,EmailAuthProvider:Io,FacebookAuthProvider:_s,GithubAuthProvider:Ts,GoogleAuthProvider:vs,OAuthCredential:Dr,TwitterAuthProvider:Es,beforeAuthStateChanged:Gb,browserLocalPersistence:Jb,browserPopupRedirectResolver:nx,browserSessionPersistence:fg,connectAuthEmulator:Ub,createUserWithEmailAndPassword:CU,getAuth:ix,getIdTokenResult:Tb,inMemoryPersistence:Tp,indexedDBLocalPersistence:Zb,initializeAuth:kb,onAuthStateChanged:NU,onIdTokenChanged:zb,prodErrorMap:mb,reload:Eb,signInWithCredential:Fb,signInWithEmailAndPassword:IU,signOut:MU,updateProfile:RU},Symbol.toStringTag,{value:"Module"}));let Lm=null,ys=null,di=null;const BL=()=>{try{return Ca().hasFirebase?(Lm=IS(Nt.firebase),ys=nb(Lm),di=ix(Lm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};BL();const Ss={async signUp(n,e,t){if(!di)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:s,updateProfile:o}=await gs(async()=>{const{createUserWithEmailAndPassword:c,updateProfile:d}=await Promise.resolve().then(()=>hd);return{createUserWithEmailAndPassword:c,updateProfile:d}},void 0),l=await s(di,n,e);return await o(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(s){return console.error("خطأ في التسجيل:",s),{success:!1,error:s instanceof Error?s.message:"خطأ غير معروف"}}},async signIn(n,e){if(!di)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await gs(async()=>{const{signInWithEmailAndPassword:o}=await Promise.resolve().then(()=>hd);return{signInWithEmailAndPassword:o}},void 0);return{success:!0,user:(await t(di,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!di)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await gs(async()=>{const{signOut:e}=await Promise.resolve().then(()=>hd);return{signOut:e}},void 0);return await n(di),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return di?di.currentUser:null},async onAuthStateChanged(n){if(!di)return n(null),()=>{};try{const{onAuthStateChanged:e}=await gs(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>hd);return{onAuthStateChanged:t}},void 0);return e(di,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:s,setDoc:o}=await gs(async()=>{const{doc:c,setDoc:d}=await Promise.resolve().then(()=>dd);return{doc:c,setDoc:d}},void 0),l=s(ys,n,e);return await o(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(s){return console.error("خطأ في حفظ البيانات:",s),{success:!1,error:s instanceof Error?s.message:"خطأ غير معروف"}}},async getData(n,e){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:s}=await gs(async()=>{const{doc:c,getDoc:d}=await Promise.resolve().then(()=>dd);return{doc:c,getDoc:d}},void 0),o=t(ys,n,e),l=await s(o);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await gs(async()=>{const{collection:l,getDocs:c}=await Promise.resolve().then(()=>dd);return{collection:l,getDocs:c}},void 0),s=await t(e(ys,n)),o=[];return s.forEach(l=>{o.push({id:l.id,...l.data()})}),{success:!0,data:o}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:s}=await gs(async()=>{const{doc:l,deleteDoc:c}=await Promise.resolve().then(()=>dd);return{doc:l,deleteDoc:c}},void 0),o=t(ys,n,e);return await s(o),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},UE=({onSuccess:n,onClose:e,hideCloseButton:t=!1})=>{const[s,o]=pe.useState(!0),[l,c]=pe.useState({email:"",password:"",displayName:""}),[d,p]=pe.useState(!1),[h,T]=pe.useState(""),E=async I=>{I.preventDefault(),p(!0),T("");try{let k;if(s)k=await Ss.signIn(l.email,l.password);else{if(!l.displayName.trim()){T("الاسم مطلوب"),p(!1);return}k=await Ss.signUp(l.email,l.password,l.displayName)}k.success?n(k.user):T(k.error||"حدث خطأ غير متوقع")}catch{T("حدث خطأ في الاتصال")}finally{p(!1)}},A=I=>{c(k=>({...k,[I.target.name]:I.target.value}))};return _.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:_.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:s?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&_.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),_.jsxs("form",{onSubmit:E,className:"space-y-4",children:[!s&&_.jsxs("div",{children:[_.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),_.jsx("input",{type:"text",id:"displayName",name:"displayName",value:l.displayName,onChange:A,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!s})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),_.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:A,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),_.jsx("input",{type:"password",id:"password",name:"password",value:l.password,onChange:A,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),h&&_.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:_.jsx("p",{className:"text-red-600 text-sm",children:h})}),_.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:d?"⏳ جاري المعالجة...":s?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),_.jsx("div",{className:"mt-6 text-center",children:_.jsx("button",{onClick:()=>o(!s),className:"text-blue-600 hover:text-blue-700 font-medium",children:s?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},sx=()=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[_.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),_.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),pg=()=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[_.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),_.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),FL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),HL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),zL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),GL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),jL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),gg=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Om=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),qm=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),YL=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),JL=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:s,onAddTransaction:o,currentUser:l,onSignOut:c})=>{const d=pe.useMemo(()=>{const h=new Date().getFullYear(),T=[];for(let E=h+1;E>=2020;E--)T.push(E);return T},[]),p=pe.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return _.jsx("header",{className:"bg-slate-50/95 backdrop-blur-lg border-b border-slate-200 py-3 shadow-sm",children:_.jsx("div",{className:"container mx-auto px-4",children:_.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-wide",children:"لوحة التحكم المالية"}),_.jsx("p",{className:"text-xs text-slate-500",children:"Developed by K.A Team"})]})]}),_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 p-1.5 rounded-lg",children:[_.jsx("select",{value:n,onChange:h=>t(parseInt(h.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:d.map(h=>_.jsx("option",{value:h,children:h},h))}),_.jsx("select",{value:e,onChange:h=>s(h.target.value==="all"?"all":parseInt(h.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:p.map(h=>_.jsx("option",{value:h.value,children:h.label},h.value))})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("div",{className:"text-right",children:[_.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:l.displayName||"المستخدم"}),_.jsx("p",{className:"text-xs text-slate-500",children:l.email})]}),_.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),_.jsx("button",{onClick:c,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),_.jsxs("button",{onClick:o,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[_.jsx(jL,{className:"w-5 h-5"}),_.jsx("span",{children:"إضافة حركة"})]})]})]})})})},Bm=[{id:"summary",label:"📊 الملخص",icon:FL},{id:"analysis",label:"📈 التحليل",icon:HL},{id:"transactions",label:"💳 الحركات",icon:zL},{id:"budget",label:"✨ الميزانية"},{id:"investment",label:"💹 الاستثمار"},{id:"ai-assistant",label:"🤖 المحلل الذكي"},{id:"cards",label:"💳 إدارة البطاقات"},{id:"bank",label:"🏦 البنك"},{id:"installments",label:"📱 الأقساط"},{id:"settings",label:"⚙️ الإعدادات"}],LE=["summary","analysis","transactions"],KL=({activeTab:n,setActiveTab:e})=>{const[t,s]=pe.useState(!1),o=d=>{e(d),s(!1)},l=Bm.filter(d=>LE.includes(d.id)),c=Bm.filter(d=>!LE.includes(d.id));return _.jsxs(_.Fragment,{children:[_.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:Bm.map(d=>_.jsx("button",{onClick:()=>o(d.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===d.id?"active":""}`,children:d.label},d.id))}),_.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[l.map(d=>{const p=d.icon;return _.jsxs("button",{onClick:()=>o(d.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===d.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[p&&_.jsx(p,{}),_.jsx("span",{className:"text-xs",children:d.label.split(" ")[1]})]},d.id)}),_.jsxs("button",{onClick:()=>s(!t),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${t?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[_.jsx(GL,{}),_.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),t&&_.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>s(!1),children:_.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:d=>d.stopPropagation(),children:[_.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),_.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:c.map(d=>_.jsxs("button",{onClick:()=>o(d.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===d.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[_.jsx("span",{className:"text-2xl",children:d.label.split(" ")[0]}),_.jsx("span",{className:"text-xs font-semibold",children:d.label.split(" ")[1]})]},d.id))})]})})]})},$L=({className:n})=>_.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-slate-200/80 to-transparent ${n}`}),Fm=()=>_.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[_.jsx("div",{className:"h-6 w-1/2 bg-slate-200 rounded mb-6"}),_.jsxs("div",{className:"space-y-4",children:[_.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),_.jsx("div",{className:"h-4 w-5/6 bg-slate-200 rounded"}),_.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),_.jsx("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]}),_.jsx($L,{})]}),QL=()=>_.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[_.jsx("div",{className:"h-16 mb-3"}),_.jsx("div",{className:"flex flex-wrap justify-center mb-8 bg-slate-100 rounded-xl p-2 h-14"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[_.jsx(Fm,{}),_.jsx(Fm,{}),_.jsx(Fm,{})]})]}),et=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),XL=({title:n,details:e,barColor:t})=>_.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between",children:[_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsx("h4",{className:"font-bold text-sm text-slate-800",children:n}),_.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),_.jsxs("div",{className:"bg-slate-50 p-2 rounded-lg border border-gray-200",children:[_.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[_.jsx("span",{className:"text-slate-600",children:"المستحق:"}),_.jsx("span",{className:"font-semibold number-display text-slate-900 text-xs",children:et(e.balance)})]}),_.jsxs("div",{className:"flex justify-between text-xs",children:[_.jsx("span",{className:"text-slate-600",children:"المتبقي:"}),_.jsx("span",{className:"font-semibold number-display text-emerald-700 text-xs",children:et(e.available)})]})]}),_.jsx("div",{className:"bg-slate-200 rounded-full h-1.5 overflow-hidden",children:_.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),WL=({calculations:n,categories:e})=>{const t=Object.values(n.expensesByCategory).reduce((o,l)=>o+Number(l),0);if(t===0)return _.jsx("p",{className:"text-slate-500 text-center p-4 text-sm",children:"لا توجد مصاريف في هذه الفترة."});const s=Object.entries(n.expensesByCategory).sort(([,o],[,l])=>l-o);return _.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:s.map(([o,l])=>{const c=e.find(p=>p.id===o);c&&`${c.icon}${c.name}`;const d=Number(l)/t*100;return _.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-base",children:(c==null?void 0:c.icon)||"📊"}),_.jsx("span",{className:"font-medium text-slate-700 truncate text-sm",title:c==null?void 0:c.name,children:(c==null?void 0:c.name)||"غير مصنف"})]}),_.jsx("span",{className:"font-semibold text-slate-900 number-display text-sm bg-slate-50 px-2 py-1 rounded border border-gray-200",children:et(l)})]}),_.jsx("div",{className:"mt-2 bg-slate-200 rounded-full h-1.5 overflow-hidden",children:_.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${d.toFixed(1)}%`}})}),_.jsxs("div",{className:"text-xs text-slate-500 mt-1 text-center",children:[d.toFixed(1),"%"]})]},o)})})},ZL=({calculations:n,categories:e})=>{const{totalIncome:t,totalExpenses:s,cardDetails:o,cardPayments:l,bankAccountDetails:c,totalDebt:d,totalAvailable:p,totalLimits:h,totalBankBalance:T}=n,E=t-s,A=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"];return _.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[_.jsxs("div",{className:"card-consistent xl:col-span-1",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"💳 ملخص ديون البطاقات"}),_.jsx("div",{className:"space-y-4",children:Object.values(o).map((I,k)=>_.jsx(XL,{title:I.name,details:I,barColor:A[k%A.length]},I.id))}),_.jsx("div",{className:"mt-4 p-3 bg-slate-100 rounded-lg",children:_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[_.jsx("p",{className:"text-red-600 font-semibold text-xs mb-2",children:"إجمالي الديون"}),_.jsx("p",{className:"font-bold text-sm text-red-600 number-display",children:et(d)})]}),_.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[_.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-2",children:"إجمالي المتاح"}),_.jsx("p",{className:"font-bold text-sm text-emerald-600 number-display",children:et(p)})]}),_.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[_.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),_.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:et(h)})]})]})})]}),_.jsxs("div",{className:"card-consistent xl:col-span-1",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),_.jsx("div",{className:"space-y-3",children:Object.values(c).map(I=>{const k=I.balance>0?"bank-card-positive":I.balance<0?"bank-card-negative":"bank-card-neutral";return _.jsxs("div",{className:`card-consistent ${k} h-32 flex flex-col justify-between`,children:[_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:I.name}),_.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),_.jsx("div",{className:"text-center",children:_.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:et(I.balance)})}),_.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),_.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",et(I.deposits)]})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),_.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",et(I.withdrawals)]})]})]})]},I.id)})}),_.jsxs("div",{className:"mt-4 card-consistent text-center",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-2",children:"🏦 إجمالي الأرصدة البنكية"}),_.jsx("p",{className:"font-bold text-xl text-blue-900 number-display",children:et(T)})]})]}),_.jsxs("div",{className:"card-consistent xl:col-span-1",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),_.jsxs("div",{className:"space-y-2 text-sm",children:[_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{children:"إجمالي الدخل:"}),_.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:et(t)})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{children:"إجمالي المصاريف:"}),_.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:et(s)})]}),_.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(o).map((I,k)=>_.jsxs("div",{className:"flex justify-between text-xs",children:[_.jsxs("span",{className:"text-slate-500",children:["مصاريف ",I.name,":"]}),_.jsx("span",{className:`font-semibold ${A[k%A.length].replace("bg-","text-")} number-display`,children:et(I.balance+(l[I.id]||0))})]},I.id)),_.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(l).map(([I,k])=>{var B;return _.jsxs("div",{className:"flex justify-between text-xs",children:[_.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(B=o[I])==null?void 0:B.name,":"]}),_.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:et(k)})]},I)}),_.jsx("hr",{className:"my-2 border-slate-200"}),_.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[_.jsx("span",{children:"الصافي:"}),_.jsx("span",{className:`number-display ${E>=0?"text-emerald-500":"text-red-500"}`,children:et(E)})]})]})]}),_.jsxs("div",{className:"card-consistent xl:col-span-1",children:[_.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),_.jsx(WL,{calculations:n,categories:e})]})]})},e4=({transactions:n,allTransactions:e,categories:t,deleteTransaction:s,editTransaction:o,state:l})=>{const[c,d]=pe.useState(""),[p,h]=pe.useState(""),[T,E]=pe.useState(""),[A,I]=pe.useState(""),[k,B]=pe.useState(""),F=Y=>{const ae={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return ae[Y]?ae[Y]:l.cards[Y]?`💳 ${l.cards[Y].name}`:l.bankAccounts[Y]?`🏦 ${l.bankAccounts[Y].name}`:Y},Z=Y=>{const ae={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(ae[Y])return ae[Y];if(Y.endsWith("-payment")){const ee=Y.replace("-payment","");if(l.cards[ee])return`💳 سداد ${l.cards[ee].name}`}return Y},te=pe.useMemo(()=>{let Y=n;if(A&&k){const ae=new Date(A),ee=new Date(k);ee.setHours(23,59,59,999),Y=e.filter(M=>{const R=new Date(M.date);return R>=ae&&R<=ee})}return Y=Y.filter(ae=>{const ee=c.toLowerCase(),M=t.find(D=>D.id===ae.categoryId),R=ae.description.toLowerCase().includes(ee)||(M==null?void 0:M.name.toLowerCase().includes(ee)),N=!p||ae.paymentMethod===p,L=!T||ae.categoryId===T;return R&&N&&L}),Y.sort((ae,ee)=>{const M=parseInt(ae.id.replace("trans-","").split("-")[0]);return parseInt(ee.id.replace("trans-","").split("-")[0])-M})},[n,e,c,p,T,A,k,t]),K=pe.useMemo(()=>te.reduce((Y,ae)=>(ae.type==="income"||ae.type.toString().includes("payment")||ae.type==="investment-withdrawal"?Y.positive+=ae.amount:Y.negative+=ae.amount,Y),{positive:0,negative:0}),[te]);return _.jsx("div",{className:"space-y-6 animate-fade-in",children:_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),_.jsx("input",{type:"date",id:"dateFrom",value:A,onChange:Y=>I(Y.target.value),className:"w-full p-2"})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),_.jsx("input",{type:"date",id:"dateTo",value:k,onChange:Y=>B(Y.target.value),className:"w-full p-2"})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),_.jsxs("select",{id:"filterMethod",value:p,onChange:Y=>h(Y.target.value),className:"p-2 w-full",children:[_.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(Y=>_.jsxs("option",{value:Y.id,children:["🏦 ",Y.name]},Y.id)),_.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(Y=>_.jsxs("option",{value:Y.id,children:["💳 ",Y.name]},Y.id)),_.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),_.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),_.jsxs("select",{id:"filterCategory",value:T,onChange:Y=>E(Y.target.value),className:"p-2 w-full",children:[_.jsx("option",{value:"",children:"كل الفئات"}),t.map(Y=>_.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]}),_.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[_.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),_.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:c,onChange:Y=>d(Y.target.value),className:"p-2 w-full"})]})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[_.jsxs("div",{className:"card-consistent",children:[_.jsxs("div",{className:"flex justify-between items-start mb-3",children:[_.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),_.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),_.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:_.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:et(K.positive)})})]}),_.jsxs("div",{className:"card-consistent",children:[_.jsxs("div",{className:"flex justify-between items-start mb-3",children:[_.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),_.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),_.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:_.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:et(K.negative)})})]}),_.jsxs("div",{className:"card-consistent",children:[_.jsxs("div",{className:"flex justify-between items-start mb-3",children:[_.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),_.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),_.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:_.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:et(K.positive-K.negative)})})]})]}),_.jsxs("div",{className:"overflow-x-auto",children:[_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"border-b border-gray-200",children:_.jsxs("tr",{children:[_.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),_.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),_.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),_.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),_.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),_.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),_.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),_.jsx("tbody",{children:te.map(Y=>{const ae=t.find(M=>M.id===Y.categoryId),ee=Y.type==="income"||Y.type.toString().includes("payment")||Y.type==="investment-withdrawal";return _.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[_.jsx("td",{className:"p-3",children:Y.date}),_.jsx("td",{className:"p-3",children:F(Y.paymentMethod)}),_.jsx("td",{className:"p-3",children:Z(Y.type)}),_.jsxs("td",{className:`p-3 font-semibold number-display ${ee?"text-emerald-500":"text-red-500"}`,children:[ee?"+":"-"," ",et(Y.amount)]}),_.jsx("td",{className:"p-3",children:ae?`${ae.icon} ${ae.name}`:"غير محدد"}),_.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:Y.description||"-"}),_.jsx("td",{className:"p-3 text-center",children:_.jsxs("div",{className:"flex gap-2 justify-center",children:[_.jsx("button",{onClick:()=>o(Y.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),_.jsx("button",{onClick:()=>s(Y.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:_.jsx(pg,{})})]})})]},Y.id)})})]}),te.length===0&&_.jsxs("div",{className:"text-center p-8 text-slate-500",children:[_.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),_.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},t4=()=>_.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),n4=({calculations:n,filteredTransactions:e})=>{const[t,s]=pe.useState([{id:"1",text:'أهلاً بك! أنا مساعدك المالي الشامل. يمكنك أن تسألني أسئلة تفصيلية عن وضعك المالي، مثل "ما هو إجمالي ديوني؟" أو "هل إنفاقي هذا الشهر يتوافق مع أهدافي؟"',sender:"ai"}]),[o,l]=pe.useState(""),[c,d]=pe.useState(!1),p=pe.useRef(null);pe.useEffect(()=>{var T;(T=p.current)==null||T.scrollTo(0,p.current.scrollHeight)},[t,c]);const h=async T=>{T.preventDefault();const E=o.trim();if(!E||c)return;const A={id:Date.now().toString(),text:E,sender:"user"};s(I=>[...I,A]),l(""),d(!0);try{const k=await hS(E,{periodSummary:n,transactions:e}),B={id:(Date.now()+1).toString(),text:k,sender:"ai"};s(F=>[...F,B])}catch(I){const k={id:(Date.now()+1).toString(),text:I instanceof Error?I.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};s(B=>[...B,k])}finally{d(!1)}};return _.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[_.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[_.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل المالي الذكي"}),_.jsx("p",{className:"text-sm text-slate-500",children:"اسأل أي شيء عن بياناتك المالية للشهر المحدد"})]}),_.jsxs("div",{ref:p,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[t.map(T=>_.jsx("div",{className:`chat-bubble ${T.sender==="user"?"user-bubble":"ai-bubble"}`,children:_.jsx("p",{dangerouslySetInnerHTML:{__html:T.text.replace(/\n/g,"<br />")}})},T.id)),c&&_.jsx(t4,{})]}),_.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:_.jsxs("form",{onSubmit:h,className:"flex gap-2",children:[_.jsx("input",{type:"text",value:o,onChange:T=>l(T.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:c}),_.jsx("button",{type:"submit",disabled:c,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:_.jsx(sx,{})})]})})]})},i4=({calculations:n,categories:e,allTransactions:t})=>{const s=pe.useRef(null),o=pe.useRef(null),l=pe.useRef({}),c=pe.useMemo(()=>Object.entries(n.expensesByCategory).map(([p,h])=>{const T=e.find(E=>E.id===p);return{name:T?`${T.icon} ${T.name}`:"غير محدد",value:h}}).sort((p,h)=>h.value-p.value),[n.expensesByCategory,e]),d=pe.useMemo(()=>{const p={},h=new Date;for(let T=5;T>=0;T--){const A=new Date(h.getFullYear(),h.getMonth()-T,1).toLocaleString("en-US",{month:"short",year:"numeric"});p[A]={income:0,expenses:0}}return t.forEach(T=>{const A=new Date(T.date).toLocaleString("en-US",{month:"short",year:"numeric"});p[A]&&(T.type==="income"&&(p[A].income+=T.amount),(T.type==="expense"||T.type==="bnpl-payment")&&(p[A].expenses+=T.amount))}),{labels:Object.keys(p),incomeData:Object.values(p).map(T=>T.income),expensesData:Object.values(p).map(T=>T.expenses)}},[t]);return pe.useEffect(()=>{var h,T;const p=window.Chart;if(p){if((h=l.current.pie)==null||h.destroy(),(T=l.current.bar)==null||T.destroy(),s.current&&c.length>0){const E=s.current.getContext("2d");E&&(l.current.pie=new p(E,{type:"doughnut",data:{labels:c.map(A=>A.name),datasets:[{data:c.map(A=>A.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(o.current&&d.labels.length>0){const E=o.current.getContext("2d");E&&(l.current.bar=new p(E,{type:"bar",data:{labels:d.labels,datasets:[{label:"الدخل",data:d.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:d.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var E,A;(E=l.current.pie)==null||E.destroy(),(A=l.current.bar)==null||A.destroy()}}},[c,d]),_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📊 توزيع مصاريف الفترة"}),_.jsx("div",{className:"h-80",children:c.length>0?_.jsx("canvas",{ref:s}):_.jsx("p",{className:"text-center text-slate-500 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),_.jsx("div",{className:"h-80",children:_.jsx("canvas",{ref:o})})]})]})},s4=({state:n,setLoading:e,setModal:t})=>{const[s,o]=pe.useState(""),[l,c]=pe.useState(""),d=async()=>{const p=parseFloat(s);if(isNaN(p)||p<=0){t({title:"خطأ",body:"<p>الرجاء إدخال مبلغ ميزانية صحيح.</p>",confirmText:"موافق",hideCancel:!0});return}e(!0,"جاري إنشاء خطة الميزانية..."),c("");try{const h=new Date;h.setDate(h.getDate()-60);const T=n.transactions.filter(A=>new Date(A.date)>=h&&A.type==="expense");if(T.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const E=await gS(p,n.categories,T);c(E)}catch(h){const T=h instanceof Error?h.message:"حدث خطأ غير متوقع.";t({title:"خطأ في إنشاء الميزانية",body:`<p>${T}</p>`,confirmText:"موافق",hideCancel:!0})}finally{e(!1)}};return _.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[_.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"✨ الميزانية الشهرية الذكية"}),_.jsxs("div",{className:"flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 bg-slate-100 rounded-lg",children:[_.jsxs("div",{className:"flex-grow",children:[_.jsx("label",{htmlFor:"monthly-budget-input",className:"block text-sm font-medium text-slate-600 mb-1",children:"أدخل إجمالي ميزانيتك الشهرية (ريال)"}),_.jsx("input",{type:"number",id:"monthly-budget-input",className:"w-full p-2",placeholder:"5000",value:s,onChange:p=>o(p.target.value)})]}),_.jsx("button",{onClick:d,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:"✨ إنشاء خطة الميزانية"})]}),_.jsx("div",{className:"prose max-w-none",children:l?_.jsx("div",{dangerouslySetInnerHTML:{__html:l.replace(/### (.*)/g,'<h4 class="text-lg font-bold text-slate-900 mt-3 mb-2">$1</h4>').replace(/\n/g,"<br />")}}):_.jsx("p",{className:"text-center text-slate-500",children:"أدخل ميزانيتك أعلاه للحصول على خطة مخصصة بناءً على إنفاقك."})})]})},r4=({state:n,setState:e,calculations:t,setModal:s})=>{const[o,l]=pe.useState([{id:"1",text:'أهلاً بك! أنا مرشدك لفهم عالم الاستثمار. يمكنك سؤالي عن استراتيجيات، أو مفاهيم مثل "ما هو الاستثمار طويل الأجل؟". تذكر، أنا لا أقدم نصائح مباشرة لشراء أسهم معينة.',sender:"ai"}]),[c,d]=pe.useState(""),[p,h]=pe.useState(!1),T=pe.useRef(null);pe.useEffect(()=>{var k;(k=T.current)==null||k.scrollTo(0,T.current.scrollHeight)},[o,p]);const E=k=>{k.preventDefault();const B=k.target,F=parseFloat(B.elements.namedItem("investment-amount").value),Z=B.elements.namedItem("investment-type").value,te=B.elements.namedItem("payment-method").value;if(isNaN(F)||F<=0){s({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const K={amount:F,date:new Date().toISOString().split("T")[0],description:Z==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:te,type:Z==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(Y=>({...Y,transactions:[...Y.transactions,{...K,id:`trans-${Date.now()}`}]})),B.reset()},A=async k=>{k.preventDefault();const B=c.trim();if(!(!B||p)){l(F=>[...F,{id:Date.now().toString(),text:B,sender:"user"}]),d(""),h(!0);try{const F=await pS(B);l(Z=>[...Z,{id:(Date.now()+1).toString(),text:F,sender:"ai"}])}catch(F){l(Z=>[...Z,{id:(Date.now()+1).toString(),text:F instanceof Error?F.message:"عذراً، حدث خطأ.",sender:"ai"}])}finally{h(!1)}}},I=()=>{const k=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;s({show:!0,title:"تحديث قيمة المحفظة",body:k,confirmText:"حفظ",onConfirm:()=>{const B=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(B)||B<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(F=>({...F,investments:{...F.investments,currentValue:B}}))}})};return _.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[_.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[_.jsxs("div",{className:"glass-card p-6 text-center",children:[_.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),_.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:et(n.investments.currentValue)}),_.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",_.jsx("span",{className:"font-semibold number-display text-slate-600",children:et(t.totalInvestmentDeposits)})]}),_.jsx("button",{onClick:I,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),_.jsxs("form",{onSubmit:E,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),_.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),_.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[_.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),_.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),_.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(k=>_.jsxs("option",{value:k.id,children:["🏦 ",k.name]},k.id))})]}),_.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),_.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[_.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[_.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 مستشارك الاستثماري الذكي"}),_.jsx("p",{className:"text-sm text-slate-500",children:"اسأل عن المفاهيم والاستراتيجيات لاتخاذ قرارات أفضل"})]}),_.jsxs("div",{ref:T,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[o.map(k=>_.jsx("div",{className:`chat-bubble ${k.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:k.text.replace(/\n/g,"<br/>")}},k.id)),p&&_.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),_.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),_.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:_.jsxs("form",{onSubmit:A,className:"flex gap-2",children:[_.jsx("input",{type:"text",value:c,onChange:k=>d(k.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:p}),_.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:p,children:_.jsx(sx,{})})]})})]})]})},o4=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:s})=>{const o=l=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(c=>`
            <tr class="hover:bg-slate-50">
                <td class="p-2">${c.postingDate||c.date}</td>
                <td class="p-2 truncate" title="${c.description}">${c.description}</td>
                <td class="p-2 number-display text-red-500">${et(c.amount)}</td>
            </tr>
        `).join("");return _.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[_.jsxs("div",{className:"flex items-start justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),_.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),_.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[_.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),_.jsx("button",{onClick:()=>s(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:_.jsx(pg,{})})]})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[_.jsxs("div",{className:"flex justify-between items-center mb-2",children:[_.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),_.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),_.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:_.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[et(e.statementDueAmount)," ريال"]})}),_.jsxs("div",{className:"flex justify-between items-center text-xs",children:[_.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),_.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),_.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:_.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[_.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[_.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),_.jsxs("p",{className:"font-bold text-red-800 number-display",children:[et(n.balance)," ريال"]})]}),_.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[_.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),_.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[et(n.limit)," ريال"]})]}),_.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[_.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),_.jsxs("p",{className:"font-bold text-green-800 number-display",children:[et(n.available)," ريال"]})]}),_.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[_.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),_.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),_.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[_.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),_.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:_.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${o(e.upcomingTransactions)}</tbody>`}})})]})]})},a4=({state:n,openCardFormModal:e,deleteCard:t})=>{const s=pe.useMemo(()=>{const l={};return Object.values(n.cards).forEach(c=>{const d=new Date,p=d.getDate(),h=d.getMonth(),T=d.getFullYear();let E,A,I;p>c.statementDay?E=new Date(T,h,c.statementDay):E=new Date(T,h-1,c.statementDay),A=new Date(E.getFullYear(),E.getMonth()-1,c.statementDay+1);let k=E.getMonth()+1,B=E.getFullYear();k>11&&(k=0,B+=1),I=new Date(B,k,c.dueDay);const F=n.transactions.filter(K=>{const Y=new Date(K.postingDate||K.date);return K.paymentMethod===c.id&&(K.type==="expense"||K.type==="bnpl-payment")&&Y>=A&&Y<=E}),Z=n.transactions.filter(K=>{const Y=new Date(K.postingDate||K.date);return K.paymentMethod===c.id&&(K.type==="expense"||K.type==="bnpl-payment")&&Y>E}),te=F.reduce((K,Y)=>K+Y.amount,0);l[c.id]={statementDueAmount:te,dueDate:I,totalOutstanding:0,upcomingTransactions:Z}}),l},[n.transactions,n.cards]),o=Object.values(n.cards);return _.jsxs("div",{className:"space-y-6 animate-fade-in",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),_.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(l=>{const c=n.transactions.filter(p=>p.paymentMethod===l.id&&(p.type==="expense"||p.type==="bnpl-payment")).reduce((p,h)=>p+h.amount,0)-n.transactions.filter(p=>p.type===`${l.id}-payment`).reduce((p,h)=>p+h.amount,0),d={...l,balance:c,available:l.limit-c,usagePercentage:l.limit>0?c/l.limit*100:0};return _.jsx(o4,{card:d,statementDetails:s[d.id],openCardFormModal:e,deleteCard:t},d.id)})})]})},l4=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const s=n.replace("-payment","");if(e.cards[s])return`💳 سداد ${e.cards[s].name}`}return n},u4=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>_.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsxs("div",{className:"flex justify-between items-start mb-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),_.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),_.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[_.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),_.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:_.jsx(pg,{})})]})]}),_.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[_.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),_.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:et(n.balance)})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[_.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),_.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:et(n.deposits)})]}),_.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[_.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),_.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:et(n.withdrawals)})]})]})]}),c4=({state:n,setState:e,calculations:t,filteredTransactions:s,categories:o,setModal:l,openBankAccountFormModal:c,deleteBankAccount:d,openTransferModal:p})=>_.jsxs("div",{className:"space-y-6 animate-fade-in",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),_.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&_.jsx("button",{onClick:p,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),_.jsx("button",{onClick:()=>c(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(h=>_.jsx(u4,{account:h,openBankAccountFormModal:c,deleteBankAccount:d},h.id))}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"border-b border-gray-200",children:_.jsxs("tr",{children:[_.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),_.jsx("tbody",{children:s.filter(h=>n.bankAccounts[h.paymentMethod]).sort((h,T)=>new Date(T.date).getTime()-new Date(h.date).getTime()).map(h=>{var I;const T=["income","investment-withdrawal"].includes(h.type),E=T?"text-emerald-500":"text-red-500",A=o.find(k=>k.id===h.categoryId);return _.jsxs("tr",{className:"border-b border-gray-200/50",children:[_.jsx("td",{className:"p-3",children:h.date}),_.jsx("td",{className:"p-3",children:(I=n.bankAccounts[h.paymentMethod])==null?void 0:I.name}),_.jsx("td",{className:"p-3",children:l4(h.type,n)}),_.jsxs("td",{className:`p-3 font-semibold ${E} number-display`,children:[T?"+":"-",et(h.amount)]}),_.jsx("td",{className:"p-3",children:A?`${A.icon} ${A.name}`:"-"}),_.jsx("td",{className:"p-3 text-slate-500",children:h.description||"-"})]},h.id)})})]})})]})]}),OE=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},d4=({state:n,setState:e,filteredTransactions:t,setModal:s})=>{const o=d=>{const p=n.installments.find(E=>E.id===d);if(!p||p.paid>=p.total)return;let h="";Object.values(n.bankAccounts).forEach(E=>{h+=`<option value="${E.id}">🏦 ${E.name}</option>`}),h+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(E=>{h+=`<option value="${E.id}">💳 ${E.name}</option>`});const T=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${p.description}" بقيمة ${et(p.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${h}</select></div>`;s({show:!0,title:"سداد قسط",body:T,confirmText:"تأكيد الدفع",onConfirm:()=>{var B;const E=document.getElementById("installment-payment-source").value,A=n.categories.find(F=>F.name==="سداد فواتير"||F.name==="💳 سداد فواتير"),I=(A==null?void 0:A.id)||((B=n.categories.find(F=>F.name==="أخرى"))==null?void 0:B.id)||"",k={id:"trans-"+Date.now(),amount:p.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${p.paid+1} لـ: ${p.description}`,paymentMethod:E,type:"bnpl-payment",categoryId:I,isInstallmentPayment:!0,installmentId:d};e(F=>{const Z=F.installments.map(te=>{if(te.id===d){const K={...te,paid:te.paid+1};return console.log("🔄 تحديث قسط:",{id:te.id,paid:te.paid,newPaid:K.paid,total:te.total}),K}return te});return{...F,transactions:[...F.transactions,k],installments:Z}})}})},l=n.installments.filter(d=>d.paid<d.total),c=n.transactions.filter(d=>d.isInstallmentPayment);return _.jsxs("div",{className:"animate-fade-in",children:[_.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900",children:"📱 خطط الأقساط النشطة"}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:l.length>0?l.map(d=>{const p=d.paid/d.total*100;return console.log("📊 عرض قسط:",{id:d.id,paid:d.paid,total:d.total,progress:p}),_.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[_.jsxs("div",{className:"flex justify-between items-start mb-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:_.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-bold text-slate-900",children:d.description}),_.jsx("p",{className:"text-sm text-slate-500",children:OE(d.provider,n)})]})]}),_.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:_.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[et(d.installmentAmount),"/شهر"]})})]}),_.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-gray-200 mb-3",children:[_.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:_.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${p}%`}})}),_.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[_.jsxs("span",{className:"font-medium",children:[d.paid," / ",d.total," مدفوع"]}),_.jsxs("span",{className:"font-medium",children:["متبقي: ",d.total-d.paid]})]}),_.jsx("div",{className:"text-center mt-2",children:_.jsxs("span",{className:"text-xs text-slate-500",children:[p.toFixed(1),"% مكتمل"]})})]}),_.jsx("div",{className:"text-center mt-3",children:_.jsx("button",{onClick:()=>o(d.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm w-full shadow-md font-semibold",children:"💳 دفع القسط التالي"})})]},d.id)}):_.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:_.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),_.jsxs("div",{className:"glass-card p-6 mt-8",children:[_.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 سجل دفعات الأقساط"}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"border-b border-gray-200",children:_.jsxs("tr",{children:[_.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"المصدر"}),_.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"})]})}),_.jsx("tbody",{children:c.sort((d,p)=>new Date(p.date).getTime()-new Date(d.date).getTime()).map(d=>_.jsxs("tr",{className:"border-b border-gray-200/50",children:[_.jsx("td",{className:"p-3",children:d.date}),_.jsx("td",{className:"p-3 text-slate-600",children:d.description}),_.jsx("td",{className:"p-3",children:OE(d.paymentMethod,n)}),_.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:et(d.amount)})]},d.id))})]})})]})]})},f4=({state:n,setState:e,setModal:t,setLoading:s,onRestore:o})=>{const[l,c]=pe.useState(Ca()),[d,p]=pe.useState({connected:!1}),[h,T]=pe.useState(!0),[E,A]=pe.useState({firebase:l.hasFirebase,gemini:l.hasGemini});pe.useEffect(()=>{const re=Ca();c(re),A({firebase:re.hasFirebase,gemini:re.hasGemini}),re.hasFirebase?(async()=>{try{T(!0);const ve=await Ss.getData("test","connection");p({connected:!0})}catch(ve){p({connected:!1,error:ve instanceof Error?ve.message:"خطأ في الاتصال"})}finally{T(!1)}})():(p({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),T(!1))},[]);const I=({isValid:re})=>re?_.jsx(Om,{className:"w-6 h-6 text-green-500"}):_.jsx(qm,{className:"w-6 h-6 text-red-500"}),k=()=>_.jsx(YL,{className:"w-6 h-6 text-yellow-500"}),[B,F]=pe.useState({name:"",icon:""}),[Z,te]=pe.useState(null),[K,Y]=pe.useState({name:"",icon:""}),[ae,ee]=pe.useState({name:"",icon:""}),M=()=>{if(!B.name.trim()||!B.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة للفئة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`cat-${Date.now()}`,name:B.name.trim(),icon:B.icon.trim()};e(ve=>({...ve,categories:[...ve.categories,ce]})),F({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},[R,N]=pe.useState(!1),L=async()=>{const re=B.name.trim();if(!re){t({title:"خطأ",body:"<p>الرجاء إدخال اسم الفئة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}N(!0);try{const{suggestCategoryIcon:ce,initializeAi:ve}=await gs(async()=>{const{suggestCategoryIcon:tt,initializeAi:vn}=await Promise.resolve().then(()=>PM);return{suggestCategoryIcon:tt,initializeAi:vn}},void 0);ve();const Qe=await ce(re);Qe&&Qe.trim()?F(tt=>({...tt,icon:Qe.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{N(!1)}},D=re=>{n.transactions.some(ce=>ce.categoryId===re)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات. يرجى تغيير فئة الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,categories:ce.categories.filter(ve=>ve.id!==re)})),t({title:"نجح",body:"<p>تم حذف الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},[V,P]=pe.useState(!1),Ve=async()=>{const re=K.name.trim();if(!re){t({title:"خطأ",body:"<p>يرجى إدخال اسم نوع الحركة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{P(!0);const ce=await Qm(re);ce&&ce.trim()?Y(ve=>({...ve,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Transaction type icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{P(!1)}},[$e,X]=pe.useState(!1),fe=async()=>{const re=ae.name.trim();if(!re){t({title:"خطأ",body:"<p>يرجى إدخال اسم وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{X(!0);const ce=await Qm(re);ce&&ce.trim()?ee(ve=>({...ve,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Payment method icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{X(!1)}},Ae=()=>{if(!K.name.trim()||!K.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لنوع الحركة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-type-${Date.now()}`,name:K.name.trim(),icon:K.icon.trim(),isCustom:!0};e(ve=>({...ve,customTransactionTypes:[...ve.customTransactionTypes||[],ce]})),Y({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},qe=re=>{n.transactions.some(ce=>ce.type===re)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات. يرجى تغيير نوع الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customTransactionTypes:(ce.customTransactionTypes||[]).filter(ve=>ve.id!==re)})),t({title:"نجح",body:"<p>تم حذف نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},We=()=>{if(!ae.name.trim()||!ae.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لوسيلة الدفع.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-payment-${Date.now()}`,name:ae.name.trim(),icon:ae.icon.trim(),isCustom:!0};e(ve=>({...ve,customPaymentMethods:[...ve.customPaymentMethods||[],ce]})),ee({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},q=re=>{n.transactions.some(ce=>ce.paymentMethod===re)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات. يرجى تغيير وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customPaymentMethods:(ce.customPaymentMethods||[]).filter(ve=>ve.id!==re)})),t({title:"نجح",body:"<p>تم حذف وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},se=()=>{try{const re=JSON.stringify(n,null,2),ce=new Blob([re],{type:"application/json"}),ve=URL.createObjectURL(ce),Qe=document.createElement("a");Qe.href=ve,Qe.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),URL.revokeObjectURL(ve),t({title:"نجح",body:"<p>تم إنشاء النسخة الاحتياطية المحلية بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})}catch{t({title:"خطأ",body:"<p>فشل إنشاء النسخة الاحتياطية.</p>",hideCancel:!0,confirmText:"موافق"})}},me=async()=>{s(!0,"جاري حفظ النسخة الاحتياطية في السحابة...");try{const re=await Ss.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(re.success)t({title:"نجح",body:"<p>تم حفظ النسخة الاحتياطية في السحابة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"});else throw new Error(re.error)}catch{t({title:"خطأ",body:"<p>فشل في حفظ النسخة الاحتياطية في السحابة.</p>",hideCancel:!0,confirmText:"موافق"})}finally{s(!1)}},ye=re=>{var Qe;const ce=(Qe=re.target.files)==null?void 0:Qe[0];if(!ce)return;const ve=new FileReader;ve.onload=tt=>{var vn;try{const xt=JSON.parse((vn=tt.target)==null?void 0:vn.result);if(xt!=null&&xt.transactions&&(xt!=null&&xt.categories))o?o(xt):t({show:!0,title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية.</p>",confirmText:"نعم، استعادة",onConfirm:()=>{const _i={transactions:xt.transactions||[],categories:xt.categories||[],installments:xt.installments||[],investments:xt.investments||{currentValue:0},cards:xt.cards||{},bankAccounts:xt.bankAccounts||{}};e(_i),t({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح.</p>",confirmText:"موافق",hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:"خطأ",body:"<p>فشل في استعادة النسخة الاحتياطية. الملف غير صالح.</p>",confirmText:"موافق",hideCancel:!0})}},ve.readAsText(ce),re.target.value=""};return _.jsxs("div",{className:"space-y-6 animate-fade-in",children:[_.jsx("div",{className:"flex justify-between items-center",children:_.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"⚙️ إعدادات النظام"})}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"🔑 حالة مفاتيح API"}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"text-2xl",children:"🔥"}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-slate-800",children:"Firebase Configuration"}),_.jsxs("p",{className:"text-sm text-slate-600",children:["Project ID: ",Nt.firebase.projectId]})]})]}),_.jsx("div",{className:"flex items-center gap-2",children:E.firebase?d.connected?_.jsxs(_.Fragment,{children:[_.jsx(Om,{className:"w-6 h-6 text-green-500"}),_.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):_.jsxs(_.Fragment,{children:[_.jsx(k,{}),_.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):_.jsxs(_.Fragment,{children:[_.jsx(qm,{className:"w-6 h-6 text-red-500"}),_.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),_.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"text-2xl",children:"🤖"}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),_.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",Nt.gemini.model]})]})]}),_.jsx("div",{className:"flex items-center gap-2",children:E.gemini?_.jsxs(_.Fragment,{children:[_.jsx(Om,{className:"w-6 h-6 text-green-500"}),_.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):_.jsxs(_.Fragment,{children:[_.jsx(qm,{className:"w-6 h-6 text-red-500"}),_.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!l.isValid&&_.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[_.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),_.jsx("ul",{className:"space-y-1",children:l.errors.map((re,ce)=>_.jsxs("li",{className:"text-sm text-red-600",children:["• ",re]},ce))})]})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📱 معلومات المشروع"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[_.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[_.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),_.jsx("p",{className:"font-semibold text-slate-800",children:Nt.app.name})]}),_.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[_.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),_.jsx("p",{className:"font-semibold text-slate-800",children:Nt.app.version})]}),_.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[_.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),_.jsx("p",{className:"font-semibold text-slate-800",children:Nt.app.environment})]}),_.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[_.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(I,{isValid:l.isValid&&d.connected}),_.jsx("span",{className:`text-sm font-semibold ${l.isValid&&d.connected?"text-green-600":"text-red-600"}`,children:l.isValid&&d.connected?"جاهز":"يحتاج إعداد"})]})]}),_.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[_.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),_.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!l.isValid||!d.connected)&&_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📝 تعليمات الإعداد"}),_.jsxs("div",{className:"space-y-4",children:[!E.gemini&&_.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[_.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),_.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[_.jsxs("li",{children:["اذهب إلى ",_.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),_.jsx("li",{children:"أنشئ مفتاح API جديد"}),_.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",_.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),_.jsxs("li",{children:["أو ضعه في ملف ",_.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!E.firebase&&_.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[_.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),_.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",_.jsx("br",{}),"• VITE_FIREBASE_API_KEY",_.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",_.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",_.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",_.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",_.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📂 إدارة الفئات"}),_.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[_.jsx("input",{type:"text",placeholder:"اسم الفئة",value:B.name,onChange:re=>F(ce=>({...ce,name:re.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:B.icon,onChange:re=>F(ce=>({...ce,icon:re.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsx("button",{type:"button",onClick:L,disabled:!B.name.trim()||R,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:R?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),_.jsx("button",{onClick:M,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),_.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(re=>_.jsxs("div",{className:"p-3 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-lg",children:re.icon}),_.jsx("span",{className:"text-sm font-medium text-slate-800",children:re.name})]}),_.jsx("button",{onClick:()=>D(re.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},re.id))})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),_.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[_.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:K.name,onChange:re=>Y(ce=>({...ce,name:re.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:K.icon,onChange:re=>Y(ce=>({...ce,icon:re.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsx("button",{type:"button",onClick:Ve,disabled:!K.name.trim()||V,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:V?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),_.jsx("button",{onClick:Ae,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),_.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(re=>_.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-sm",children:re.icon}),_.jsx("span",{className:"text-xs font-medium text-slate-800",children:re.name})]}),_.jsx("button",{onClick:()=>qe(re.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},re.id))})]}),_.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[_.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:ae.name,onChange:re=>ee(ce=>({...ce,name:re.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:ae.icon,onChange:re=>ee(ce=>({...ce,icon:re.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),_.jsx("button",{type:"button",onClick:fe,disabled:!ae.name.trim()||$e,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:$e?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),_.jsx("button",{onClick:We,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),_.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(re=>_.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-sm",children:re.icon}),_.jsx("span",{className:"text-xs font-medium text-slate-800",children:re.name})]}),_.jsx("button",{onClick:()=>q(re.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},re.id))})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[_.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),_.jsxs("div",{className:"space-y-2 text-sm",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💰 دخل"}),_.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💸 مصاريف"}),_.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"📱 سداد قسط"}),_.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💹 إيداع استثماري"}),_.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💹 سحب استثماري"}),_.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),_.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[_.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),_.jsxs("div",{className:"space-y-2 text-sm",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💵 نقدي"}),_.jsx("span",{className:"text-green-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"📱 تابي"}),_.jsx("span",{className:"text-green-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"📱 تمارا"}),_.jsx("span",{className:"text-green-600",children:"مدمج"})]}),_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsx("span",{children:"💳 سداد البطاقات"}),_.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),_.jsxs("div",{className:"glass-card p-6",children:[_.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"💾 النسخ الاحتياطي والاستعادة"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),_.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),_.jsx("button",{onClick:se,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),_.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),_.jsx("button",{onClick:me,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),_.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),_.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:ye}),_.jsx("button",{onClick:()=>{var re;return(re=document.getElementById("backup-file"))==null?void 0:re.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors",children:"📥 استعادة البيانات"})]})]})]}),_.jsx("div",{className:"text-center",children:_.jsx("button",{onClick:()=>{c(Ca()),window.location.reload()},disabled:h,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:h?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},h4=({onClose:n,onSave:e,initialData:t,categories:s,cards:o,bankAccounts:l,setModalConfig:c})=>{var L;const[d,p]=pe.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((L=s.find(D=>D.name==="أخرى"))==null?void 0:L.id)||null}),[h,T]=pe.useState(!1),[E,A]=pe.useState(""),[I,k]=pe.useState({isOpen:!1,text:""}),[B,F]=pe.useState(!1),[Z,te]=pe.useState(4),[K,Y]=pe.useState(Object.keys(l)[0]||"cash");pe.useEffect(()=>{var D;t?p(t):(D=navigator.clipboard)!=null&&D.readText?(async()=>{try{console.log("🔍 محاولة قراءة الحافظة...");const V=await navigator.clipboard.readText();console.log("📋 نص الحافظة:",V),V&&V.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==V?(console.log("✅ تم العثور على نص مناسب في الحافظة"),console.log("🔍 فتح نافذة الحافظة..."),k({isOpen:!0,text:V}),console.log("✅ تم فتح نافذة الحافظة")):(console.log("❌ نص الحافظة غير مناسب أو تم تجاهله"),console.log("📊 تفاصيل:",{textLength:V==null?void 0:V.trim().length,ignored:sessionStorage.getItem("ignoredClipboardText")===V,text:(V==null?void 0:V.substring(0,50))+"..."}))}catch(V){console.error("❌ خطأ في قراءة الحافظة:",V)}})():console.log("❌ navigator.clipboard غير مدعوم")},[t]);const ae=D=>{const{name:V,value:P}=D.target;if(V==="paymentMethod"){const Ve=P.includes("bnpl");F(Ve),Ve&&p($e=>({...$e,type:"expense"}))}p(Ve=>({...Ve,[V]:V==="amount"?parseFloat(P):P}))},ee=D=>{D.preventDefault(),B&&d.paymentMethod.includes("bnpl")?e({...d,bnplData:{installmentsCount:Z,initialPaymentSource:K,installmentAmount:d.amount/Z}},t==null?void 0:t.id):e(d,t==null?void 0:t.id)},M=async D=>{if(D.trim()){console.log("🔍 بدء تحليل النص...",D.substring(0,100)),T(!0),A("");try{console.log("📤 إرسال طلب تحليل إلى Gemini...");const V=await mS(D,s,o,l);console.log("📥 استجابة Gemini:",V);const P=JSON.parse(V);console.log("📊 نتيجة التحليل:",P),P.error?(console.log("❌ خطأ في التحليل:",P.error),A(P.error)):(console.log("✅ تطبيق النتيجة على النموذج..."),p(Ve=>{const $e={...Ve,amount:P.amount||Ve.amount,date:P.date||Ve.date,description:P.merchant||Ve.description,paymentMethod:P.paymentMethod||Ve.paymentMethod,categoryId:P.categoryId||Ve.categoryId};return console.log("🔄 النموذج الجديد:",$e),$e}),console.log("✅ تم تحديث النموذج بنجاح"),setTimeout(()=>{c({title:"✅ تم بنجاح",body:'<div class="text-center"><p class="text-green-600 font-medium mb-2">🎉 تم تحليل النص وملء الحقول تلقائياً!</p><p class="text-gray-600 text-sm">يرجى مراجعة البيانات قبل الحفظ</p></div>',hideCancel:!0,confirmText:"حسنًا"})},500))}catch(V){console.error("❌ خطأ في تحليل النص:",V),A(V instanceof Error?V.message:"فشل تحليل النص.")}finally{T(!1),console.log("🏁 انتهى تحليل النص")}}},R=pe.useMemo(()=>{const D=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach(V=>D.push({value:V.id,label:`🏦 ${V.name}`})),Object.values(o).forEach(V=>D.push({value:V.id,label:`💳 ${V.name}`})),D.push({value:"tabby-bnpl",label:"📱 تابي"}),D.push({value:"tamara-bnpl",label:"📱 تمارا"}),D},[l,o]),N=pe.useMemo(()=>{const D=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(o).forEach(V=>D.push({value:`${V.id}-payment`,label:`💳 سداد ${V.name}`})),D},[o]);return _.jsxs(_.Fragment,{children:[I.isOpen&&_.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>k({isOpen:!1,text:""}),children:_.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md animate-fade-in max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:_.jsxs("div",{className:"p-6",children:[_.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),_.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),_.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:I.text}),_.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[_.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",I.text),k({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),_.jsx("button",{onClick:()=>{k({isOpen:!1,text:""}),M(I.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),_.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:_.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:handlePasteFromClipboard,className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm",title:"قراءة الحافظة وتحليل النص",children:"📋 لصق"}),_.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:_.jsx(gg,{})})]})]}),h&&_.jsxs("div",{className:"text-center p-6 mb-4 bg-blue-50 border-2 border-blue-200 rounded-xl shadow-sm relative z-[10000]",children:[_.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent mx-auto"}),_.jsx("p",{className:"text-blue-700 mt-3 text-base font-medium",children:"🤖 جاري تحليل النص بالذكاء الاصطناعي..."}),_.jsx("p",{className:"text-blue-600 mt-1 text-sm",children:"يرجى الانتظار لحظات"})]}),E&&_.jsxs("div",{className:"text-center p-4 mb-4 bg-red-50 border-2 border-red-200 rounded-xl shadow-sm relative z-[10000]",children:[_.jsx("div",{className:"text-red-500 text-lg mb-2",children:"❌"}),_.jsx("p",{className:"text-red-700 font-medium",children:"فشل في تحليل النص"}),_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E})]}),_.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),_.jsx("input",{type:"number",name:"amount",value:d.amount,onChange:ae,className:"w-full",required:!0,step:"0.01"})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),_.jsx("input",{type:"date",name:"date",value:d.date,onChange:ae,className:"w-full",required:!0})]})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"description",className:"form-label",children:["الوصف ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx("input",{type:"text",name:"description",value:d.description,onChange:ae,className:"w-full",required:!0})]}),_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),_.jsx("select",{name:"type",value:d.type,onChange:ae,className:"w-full",children:N.map(D=>_.jsx("option",{value:D.value,children:D.label},D.value))})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),_.jsx("select",{name:"paymentMethod",value:d.paymentMethod,onChange:ae,className:"w-full",children:R.map(D=>_.jsx("option",{value:D.value,children:D.label},D.value))})]})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"categoryId",className:"form-label",children:["الفئة ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsxs("select",{name:"categoryId",value:d.categoryId||"",onChange:ae,className:"w-full",required:!0,children:[_.jsx("option",{value:"",children:"-- اختر فئة --"}),s.map(D=>_.jsxs("option",{value:D.id,children:[D.icon," ",D.name]},D.id))]})]}),B&&_.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[_.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),_.jsxs("select",{value:Z,onChange:D=>te(parseInt(D.target.value)),className:"w-full",children:[_.jsx("option",{value:2,children:"قسطين (2)"}),_.jsx("option",{value:3,children:"3 أقساط"}),_.jsx("option",{value:4,children:"4 أقساط"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),_.jsx("select",{value:K,onChange:D=>Y(D.target.value),className:"w-full",children:R.filter(D=>!D.value.includes("bnpl")).map(D=>_.jsx("option",{value:D.value,children:D.label},D.value))})]})]}),_.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:_.jsxs("p",{className:"text-sm text-blue-700",children:[_.jsx("strong",{children:"الدفعة الأولى:"})," ",(d.amount/Z).toFixed(2)," ريال",_.jsx("br",{}),_.jsx("strong",{children:"المبلغ المتبقي:"})," ",(d.amount*(Z-1)/Z).toFixed(2)," ريال"]})})]}),_.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})})]})},m4=({onClose:n,onSave:e,initialData:t})=>{var d;const[s,o]=pe.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});pe.useEffect(()=>{t&&o(t)},[t]);const l=p=>{const{name:h,value:T,type:E}=p.target;o(h==="smsSamples"?A=>({...A,smsSamples:T.split(",").map(I=>I.trim()).filter(Boolean)}):A=>({...A,[h]:E==="number"?parseFloat(T)||0:T}))},c=p=>{p.preventDefault(),e(s,t==null?void 0:t.id)};return _.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:_.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:p=>p.stopPropagation(),children:_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),_.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:_.jsx(gg,{})})]}),_.jsxs("form",{onSubmit:c,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),_.jsx("input",{type:"text",name:"name",value:s.name,onChange:l,className:"w-full p-2",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),_.jsx("input",{type:"number",name:"limit",value:s.limit,onChange:l,className:"w-full p-2",required:!0,step:"100"})]}),_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),_.jsx("input",{type:"number",name:"statementDay",value:s.statementDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),_.jsx("input",{type:"number",name:"dueDay",value:s.dueDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),_.jsx("input",{type:"text",name:"smsSamples",value:((d=s.smsSamples)==null?void 0:d.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),_.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),_.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},p4=({onClose:n,onSave:e,initialData:t})=>{var d;const[s,o]=pe.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});pe.useEffect(()=>{t&&o(t)},[t]);const l=p=>{const{name:h,value:T,type:E}=p.target;o(h==="smsSamples"?A=>({...A,smsSamples:T.split(",").map(I=>I.trim()).filter(Boolean)}):A=>({...A,[h]:E==="number"?parseFloat(T)||0:T}))},c=p=>{p.preventDefault(),e(s,t==null?void 0:t.id)};return _.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:_.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:p=>p.stopPropagation(),children:_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),_.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:_.jsx(gg,{})})]}),_.jsxs("form",{onSubmit:c,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),_.jsx("input",{type:"text",name:"name",value:s.name,onChange:l,className:"w-full p-2",required:!0})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),_.jsx("input",{type:"number",name:"balance",value:s.balance,onChange:l,className:"w-full p-2",required:!0,step:"10"})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),_.jsxs("select",{name:"currency",value:s.currency||"SAR",onChange:l,className:"w-full p-2",required:!0,children:[_.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),_.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),_.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),_.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),_.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),_.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),_.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),_.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),_.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),_.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),_.jsx("input",{type:"text",name:"smsSamples",value:((d=s.smsSamples)==null?void 0:d.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),_.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),_.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},g4=()=>{var wn,Ls,vi,Os,qs;const[n,e]=pe.useState(!1),[t,s]=pe.useState(rd),[o,l]=pe.useState(new Date().getFullYear()),[c,d]=pe.useState(new Date().getMonth()+1),[p,h]=pe.useState("summary"),[T,E]=pe.useState({isLoading:!1,text:""}),[A,I]=pe.useState(null),[k,B]=pe.useState({isOpen:!1}),[F,Z]=pe.useState({isOpen:!1}),[te,K]=pe.useState({isOpen:!1}),[Y,ae]=pe.useState({isOpen:!1}),[ee,M]=pe.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[R,N]=pe.useState(null),[L,D]=pe.useState(!1),[V,P]=pe.useState(!0);pe.useEffect(()=>{(async()=>{fS();const de=await Ss.onAuthStateChanged(async ge=>{try{ge?(console.log("✅ تم تسجيل دخول المستخدم:",ge.email),N(ge),await Ve(ge.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),N(null),await $e())}catch(Ce){console.error("خطأ في تحميل بيانات المستخدم:",Ce),await $e()}finally{P(!1),e(!0)}});return()=>{typeof de=="function"&&de()}})()},[]),pe.useEffect(()=>(k.isOpen||F.isOpen||te.isOpen||Y.isOpen||A||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[k.isOpen,F.isOpen,te.isOpen,Y.isOpen,A,T.isLoading]);const Ve=async Q=>{var de;try{const ge=await Ss.getData("users",Q);if(ge.success&&ge.data){const Ce=rd(),Ze={...Ce,...ge.data,cards:{...Ce.cards,...ge.data.cards||{}},bankAccounts:{...Ce.bankAccounts,...ge.data.bankAccounts||{}},investments:{...Ce.investments,...ge.data.investments||{}}};s(Ze),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else ge.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",ge.error),(de=ge.error)!=null&&de.includes("الأذونات")&&I({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(ge){console.error("خطأ في تحميل بيانات المستخدم:",ge)}},$e=async()=>{try{const Q=localStorage.getItem("financial_dashboard_state");if(Q){const de=JSON.parse(Q),ge=rd(),Ce={...ge,...de,cards:{...ge.cards,...de.cards||{}},bankAccounts:{...ge.bankAccounts,...de.bankAccounts||{}},investments:{...ge.investments,...de.investments||{}}};s(Ce),console.log("✅ تم تحميل البيانات من localStorage")}}catch(Q){console.error("خطأ في تحميل البيانات المحلية:",Q)}};pe.useEffect(()=>{if(n&&!V&&(localStorage.setItem("financial_dashboard_state",JSON.stringify(t)),R)){const de=setTimeout(async()=>{try{const ge=await Ss.saveData("users",R.uid,t);ge.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",ge.error)}catch(ge){console.error("❌ خطأ في حفظ البيانات في Firebase:",ge)}},2e3);return()=>clearTimeout(de)}},[t,n,R,V]);const X=(Q,de="")=>E({isLoading:Q,text:de}),fe=pe.useCallback(()=>t.transactions?t.transactions.filter(Q=>{const de=new Date(Q.date),ge=de.getFullYear()===o,Ce=c==="all"||de.getMonth()+1===c;return ge&&Ce}):[],[t.transactions,o,c]),Ae=pe.useMemo(()=>fe(),[fe]),qe=pe.useMemo(()=>{const Q={},de={},ge={},Ce={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(Te=>{Te&&Te.id&&(ge[Te.id]={...Te,balance:0,available:Te.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(Te=>{Te&&Te.id&&(Ce[Te.id]={...Te,deposits:0,withdrawals:0})});let Ze=0,gt=0,Ti=0,Bs=0;Ae.forEach(Te=>{if(Te.type==="income")Ze+=Te.amount;else if(Te.type==="expense")gt+=Te.amount,Te.categoryId&&(Q[Te.categoryId]=(Q[Te.categoryId]||0)+Te.amount);else if(Te.type==="bnpl-payment")gt+=Te.amount,Te.categoryId&&(Q[Te.categoryId]=(Q[Te.categoryId]||0)+Te.amount);else if(Te.type==="investment-deposit")Ti+=Te.amount,gt+=Te.amount;else if(Te.type==="investment-withdrawal")Bs+=Te.amount,Ze+=Te.amount;else if(Te.type.endsWith("-payment")){const It=Te.type.replace("-payment","");de[It]?de[It]+=Te.amount:de[It]=Te.amount}}),Object.keys(t.cards).forEach(Te=>{const It=t.cards[Te];let kt=0;t.transactions.forEach(dt=>{dt.paymentMethod===Te&&dt.type==="expense"&&(kt+=dt.amount),dt.type===`${Te}-payment`&&(kt-=dt.amount)}),ge[Te].balance=kt,ge[Te].available=It.limit-kt,ge[Te].usagePercentage=It.limit>0?kt/It.limit*100:0}),Object.keys(t.bankAccounts).forEach(Te=>{const It=t.bankAccounts[Te];let kt=0,dt=0,Qt=It.balance;t.transactions.forEach(De=>{De.paymentMethod===Te&&(["income","investment-withdrawal"].includes(De.type)?Qt+=De.amount:["expense","investment-deposit"].includes(De.type)&&(Qt-=De.amount)),De.type.endsWith("-payment")&&De.paymentMethod===Te&&(Qt-=De.amount),De.type==="expense"&&De.isInstallmentPayment&&De.paymentMethod===Te&&(Qt-=De.amount)}),Ae.forEach(De=>{De.paymentMethod===Te&&(["income","investment-withdrawal"].includes(De.type)?kt+=De.amount:["expense","investment-deposit"].includes(De.type)&&(dt+=De.amount)),De.type.endsWith("-payment")&&De.paymentMethod===Te&&(dt+=De.amount),De.type==="expense"&&De.isInstallmentPayment&&De.paymentMethod===Te&&(dt+=De.amount)}),Ce[Te].balance=Qt,Ce[Te].deposits=kt,Ce[Te].withdrawals=dt});const kr=Object.values(ge).reduce((Te,It)=>Te+It.balance,0),Ei=Object.values(ge).reduce((Te,It)=>Te+It.available,0),Qa=Object.values(ge).reduce((Te,It)=>Te+It.limit,0),wo=Object.values(Ce).reduce((Te,It)=>Te+It.balance,0);return{totalIncome:Ze,totalExpenses:gt,cardDetails:ge,cardPayments:de,bankAccountDetails:Ce,totalDebt:kr,totalAvailable:Ei,totalLimits:Qa,totalBankBalance:wo,totalInvestmentDeposits:Ti,totalInvestmentWithdrawals:Bs,expensesByCategory:Q}},[Ae,t.transactions,t.cards,t.bankAccounts]),We=(Q,de)=>{s(ge=>{if(de){const Ce=ge.transactions.map(Ze=>Ze.id===de?{...Ze,...Q}:Ze);return{...ge,transactions:Ce}}else if(Q.bnplData&&Q.paymentMethod.includes("bnpl")){const Ce={id:`installment-${Date.now()}`,provider:Q.paymentMethod,description:Q.description,totalAmount:Q.amount,installmentAmount:Q.bnplData.installmentAmount,total:Q.bnplData.installmentsCount,paid:1,createdAt:Q.date},Ze={id:`trans-${Date.now()}-1`,amount:Q.bnplData.installmentAmount,date:Q.date,description:`الدفعة الأولى لـ: ${Q.description}`,paymentMethod:Q.bnplData.initialPaymentSource,type:"expense",categoryId:Q.categoryId,isInstallmentPayment:!0,installmentId:Ce.id};return{...ge,transactions:[...ge.transactions,Ze],installments:[...ge.installments,Ce]}}else{const Ce={id:`trans-${Date.now()}`,...Q};return{...ge,transactions:[...ge.transactions,Ce]}}}),B({isOpen:!1})},q=Q=>{I({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{s(de=>({...de,transactions:de.transactions.filter(ge=>ge.id!==Q)})),I(null)}})},se=Q=>{const de=t.transactions.find(ge=>ge.id===Q);de&&B({isOpen:!0,initialData:de})},me=async Q=>{N(Q),D(!1),await Ve(Q.uid)},ye=async()=>{try{const Q=await Ss.signOut();Q.success?(console.log("✅ تم تسجيل الخروج بنجاح"),N(null),await $e()):console.error("❌ خطأ في تسجيل الخروج:",Q.error)}catch(Q){console.error("❌ خطأ في تسجيل الخروج:",Q)}},re=(Q,de)=>{s(ge=>{const Ce={...ge.cards};if(de)Ce[de]={...Ce[de],...Q,id:de};else{const Ze=`card-${Date.now()}`;Ce[Ze]={...Q,id:Ze}}return{...ge,cards:Ce}}),Z({isOpen:!1})},ce=Q=>{var de;t.transactions.some(ge=>ge.paymentMethod===Q||ge.type===`${Q}-payment`)?I({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):I({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(de=t.cards[Q])==null?void 0:de.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{s(ge=>{const Ce={...ge.cards};return delete Ce[Q],{...ge,cards:Ce}}),I(null)}})},ve=(Q,de)=>{s(ge=>{const Ce={...ge.bankAccounts};if(de)Ce[de]={...Ce[de],...Q,id:de};else{const Ze=`bank-${Date.now()}`;Ce[Ze]={...Q,id:Ze}}return{...ge,bankAccounts:Ce}}),K({isOpen:!1})},Qe=Q=>{var de;t.transactions.some(ge=>ge.paymentMethod===Q)?I({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):I({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(de=t.bankAccounts[Q])==null?void 0:de.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{s(ge=>{const Ce={...ge.bankAccounts};return delete Ce[Q],{...ge,bankAccounts:Ce}}),I(null)}})},tt=Q=>{I({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const de=rd();if(Q.creditCards&&!Q.cards){const Ce={};Object.entries(Q.creditCards).forEach(([Ze,gt])=>{Ce[Ze]={id:Ze,name:Ze.toUpperCase(),limit:gt.creditLimit||0,balance:gt.currentBalance||0,dueDay:gt.dueDay||1,smsSamples:[],keywords:[]}}),Q.cards=Ce}if(Q.cards&&typeof Q.cards=="object"&&(Q.cards.snb||Q.cards.enbd)){const Ce={};Q.cards.snb&&(Ce["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:Q.cards.snb.limit||0,dueDay:Q.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),Q.cards.enbd&&(Ce["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:Q.cards.enbd.limit||0,dueDay:Q.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),Q.cards=Ce}Q.bank&&!Q.bankAccounts&&(Q.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:Q.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),Q.transactions&&Array.isArray(Q.transactions)&&(Q.transactions=Q.transactions.map(Ce=>Ce.paymentMethod==="mada-bank"?{...Ce,paymentMethod:"bank-default"}:Ce));const ge={...de,...Q};s(ge),R&&(async()=>{try{const Ze=await Ss.saveData("users",R.uid,ge);Ze.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",Ze.error)}catch(Ze){console.error("❌ خطأ في حفظ البيانات في Firebase:",Ze)}})(),I({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{I({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},vn=Q=>Z({isOpen:!0,initialData:Q?t.cards[Q]:null}),xt=Q=>K({isOpen:!0,initialData:Q?t.bankAccounts[Q]:null}),_i=()=>{if(!ee.fromAccount||!ee.toAccount||ee.amount<=0){I({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(ee.fromAccount===ee.toAccount){I({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const Q=t.bankAccounts[ee.fromAccount],de=t.bankAccounts[ee.toAccount],ge=ee.amount*ee.exchangeRate,Ce={id:`trans-${Date.now()}-withdrawal`,amount:ee.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(de==null?void 0:de.name)||"حساب آخر"}: ${ee.description}${ee.exchangeRate!==1?` (معدل: ${ee.exchangeRate})`:""}`,paymentMethod:ee.fromAccount,type:"expense",categoryId:null},Ze={id:`trans-${Date.now()}-deposit`,amount:ge,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(Q==null?void 0:Q.name)||"حساب آخر"}: ${ee.description}${ee.exchangeRate!==1?` (معدل: ${ee.exchangeRate})`:""}`,paymentMethod:ee.toAccount,type:"income",categoryId:null};s(gt=>({...gt,transactions:[...gt.transactions,Ce,Ze]})),ae({isOpen:!1}),M({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),I({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})};if(!n||V)return _.jsx(QL,{});if(!R)return _.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:_.jsxs("div",{className:"w-full max-w-md px-4",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),_.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),_.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),_.jsx(UE,{onSuccess:me,onClose:()=>{},hideCloseButton:!0})]})});`${o}${c==="all"?"كل الشهور":new Date(o,c-1).toLocaleString("ar-SA",{month:"long"})}`;const Us=()=>{switch(p){case"summary":return _.jsx(ZL,{calculations:qe,categories:t.categories});case"transactions":return _.jsx(e4,{transactions:Ae,allTransactions:t.transactions,categories:t.categories,deleteTransaction:q,editTransaction:se,state:t});case"ai-assistant":return _.jsx(n4,{calculations:qe,filteredTransactions:Ae});case"analysis":return _.jsx(i4,{calculations:qe,categories:t.categories,allTransactions:t.transactions});case"budget":return _.jsx(s4,{state:t,setLoading:X,setModal:I});case"investment":return _.jsx(r4,{state:t,setState:s,calculations:qe,setModal:I});case"cards":return _.jsx(a4,{state:t,openCardFormModal:vn,deleteCard:ce});case"bank":return _.jsx(c4,{state:t,setState:s,calculations:qe,filteredTransactions:Ae,categories:t.categories,setModal:I,openBankAccountFormModal:xt,deleteBankAccount:Qe,openTransferModal:()=>ae({isOpen:!0})});case"installments":return _.jsx(d4,{state:t,setState:s,filteredTransactions:Ae,setModal:I});case"settings":return _.jsx(f4,{state:t,setState:s,setModal:I,setLoading:X,onRestore:tt});default:return _.jsx("div",{children:"Tab not found"})}};return _.jsxs("div",{className:"bg-slate-100 min-h-screen font-sans",children:[_.jsx(JL,{selectedYear:o,selectedMonth:c,onYearChange:l,onMonthChange:Q=>d(Q),onAddTransaction:()=>B({isOpen:!0}),currentUser:R,onSignOut:ye}),_.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[_.jsx(KL,{activeTab:p,setActiveTab:h}),Us()]}),_.jsx("button",{onClick:()=>B({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),k.isOpen&&_.jsx(h4,{onClose:()=>B({isOpen:!1}),onSave:We,initialData:k.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,setModalConfig:I}),F.isOpen&&_.jsx(m4,{onClose:()=>Z({isOpen:!1}),onSave:re,initialData:F.initialData}),te.isOpen&&_.jsx(p4,{onClose:()=>K({isOpen:!1}),onSave:ve,initialData:te.initialData}),Y.isOpen&&_.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>ae({isOpen:!1}),children:_.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Q=>Q.stopPropagation(),children:_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"💸 تحويل بين الحسابات"}),_.jsx("button",{onClick:()=>ae({isOpen:!1}),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),_.jsxs("select",{id:"fromAccount",name:"fromAccount",value:ee.fromAccount,onChange:Q=>M(de=>({...de,fromAccount:Q.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[_.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([Q,de])=>_.jsx("option",{value:Q,children:de.name},Q))]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),_.jsxs("select",{id:"toAccount",name:"toAccount",value:ee.toAccount,onChange:Q=>M(de=>({...de,toAccount:Q.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[_.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([Q])=>Q!==ee.fromAccount).map(([Q,de])=>_.jsx("option",{value:Q,children:de.name},Q))]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),_.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:ee.amount,onChange:Q=>M(de=>({...de,amount:parseFloat(Q.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),ee.fromAccount&&ee.toAccount&&((wn=t.bankAccounts[ee.fromAccount])==null?void 0:wn.currency)!==((Ls=t.bankAccounts[ee.toAccount])==null?void 0:Ls.currency)&&_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(vi=t.bankAccounts[ee.fromAccount])==null?void 0:vi.currency," → ",(Os=t.bankAccounts[ee.toAccount])==null?void 0:Os.currency,")"]}),_.jsx("input",{type:"number",step:"0.0001",value:ee.exchangeRate,onChange:Q=>M(de=>({...de,exchangeRate:parseFloat(Q.target.value)||1})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),_.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(ee.amount*ee.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(qs=t.bankAccounts[ee.toAccount])==null?void 0:qs.currency]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),_.jsx("input",{type:"text",id:"description",name:"description",value:ee.description,onChange:Q=>M(de=>({...de,description:Q.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),_.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[_.jsx("button",{type:"button",onClick:()=>ae({isOpen:!1}),className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),_.jsx("button",{type:"button",onClick:_i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),A&&_.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>I(null),children:_.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Q=>Q.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:A.title}),_.jsx("div",{className:"text-slate-600",dangerouslySetInnerHTML:{__html:A.body}}),_.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!A.hideCancel&&_.jsx("button",{onClick:()=>I(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),_.jsx("button",{onClick:()=>{(!A.onConfirm||A.onConfirm()!==!1)&&I(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:A.confirmText||"موافق"})]})]})}),T.isLoading&&_.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),_.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),L&&R&&_.jsx(UE,{onSuccess:me,onClose:()=>D(!1)})]})},rx=document.getElementById("root");if(!rx)throw new Error("Could not find root element");const y4=JC.createRoot(rx);y4.render(_.jsx(qC.StrictMode,{children:_.jsx(g4,{})}));
