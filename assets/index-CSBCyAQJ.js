(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function Ix(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Om={exports:{}},cu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o_;function Dw(){if(o_)return cu;o_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,r,o){var u=null;if(o!==void 0&&(u=""+o),r.key!==void 0&&(u=""+r.key),"key"in r){o={};for(var d in r)d!=="key"&&(o[d]=r[d])}else o=r;return r=o.ref,{$$typeof:n,type:s,key:u,ref:r!==void 0?r:null,props:o}}return cu.Fragment=e,cu.jsx=t,cu.jsxs=t,cu}var l_;function Mw(){return l_||(l_=1,Om.exports=Dw()),Om.exports}var p=Mw(),Um={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u_;function Pw(){if(u_)return Oe;u_=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),x=Symbol.iterator;function C(q){return q===null||typeof q!="object"?null:(q=x&&q[x]||q["@@iterator"],typeof q=="function"?q:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,V={};function $(q,re,me){this.props=q,this.context=re,this.refs=V,this.updater=me||M}$.prototype.isReactComponent={},$.prototype.setState=function(q,re){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,re,"setState")},$.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function U(){}U.prototype=$.prototype;function B(q,re,me){this.props=q,this.context=re,this.refs=V,this.updater=me||M}var K=B.prototype=new U;K.constructor=B,k(K,$.prototype),K.isPureReactComponent=!0;var se=Array.isArray;function H(){}var R={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function D(q,re,me){var ye=me.ref;return{$$typeof:n,type:q,key:re,ref:ye!==void 0?ye:null,props:me}}function w(q,re){return D(q.type,re,q.props)}function L(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function j(q){var re={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(me){return re[me]})}var O=/\/+/g;function Pe(q,re){return typeof q=="object"&&q!==null&&q.key!=null?j(""+q.key):re.toString(36)}function We(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(H,H):(q.status="pending",q.then(function(re){q.status==="pending"&&(q.status="fulfilled",q.value=re)},function(re){q.status==="pending"&&(q.status="rejected",q.reason=re)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function Z(q,re,me,ye,Ne){var Fe=typeof q;(Fe==="undefined"||Fe==="boolean")&&(q=null);var Be=!1;if(q===null)Be=!0;else switch(Fe){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(q.$$typeof){case n:case e:Be=!0;break;case _:return Be=q._init,Z(Be(q._payload),re,me,ye,Ne)}}if(Be)return Ne=Ne(q),Be=ye===""?"."+Pe(q,0):ye,se(Ne)?(me="",Be!=null&&(me=Be.replace(O,"$&/")+"/"),Z(Ne,re,me,"",function(ei){return ei})):Ne!=null&&(L(Ne)&&(Ne=w(Ne,me+(Ne.key==null||q&&q.key===Ne.key?"":(""+Ne.key).replace(O,"$&/")+"/")+Be)),re.push(Ne)),1;Be=0;var vt=ye===""?".":ye+":";if(se(q))for(var gt=0;gt<q.length;gt++)ye=q[gt],Fe=vt+Pe(ye,gt),Be+=Z(ye,re,me,Fe,Ne);else if(gt=C(q),typeof gt=="function")for(q=gt.call(q),gt=0;!(ye=q.next()).done;)ye=ye.value,Fe=vt+Pe(ye,gt++),Be+=Z(ye,re,me,Fe,Ne);else if(Fe==="object"){if(typeof q.then=="function")return Z(We(q),re,me,ye,Ne);throw re=String(q),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return Be}function Q(q,re,me){if(q==null)return q;var ye=[],Ne=0;return Z(q,ye,"","",function(Fe){return re.call(me,Fe,Ne++)}),ye}function he(q){if(q._status===-1){var re=q._result;re=re(),re.then(function(me){(q._status===0||q._status===-1)&&(q._status=1,q._result=me)},function(me){(q._status===0||q._status===-1)&&(q._status=2,q._result=me)}),q._status===-1&&(q._status=0,q._result=re)}if(q._status===1)return q._result.default;throw q._result}var Ae=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Ce={map:Q,forEach:function(q,re,me){Q(q,function(){re.apply(this,arguments)},me)},count:function(q){var re=0;return Q(q,function(){re++}),re},toArray:function(q){return Q(q,function(re){return re})||[]},only:function(q){if(!L(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Oe.Activity=b,Oe.Children=Ce,Oe.Component=$,Oe.Fragment=t,Oe.Profiler=r,Oe.PureComponent=B,Oe.StrictMode=s,Oe.Suspense=h,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return R.H.useMemoCache(q)}},Oe.cache=function(q){return function(){return q.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(q,re,me){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ye=k({},q.props),Ne=q.key;if(re!=null)for(Fe in re.key!==void 0&&(Ne=""+re.key),re)!N.call(re,Fe)||Fe==="key"||Fe==="__self"||Fe==="__source"||Fe==="ref"&&re.ref===void 0||(ye[Fe]=re[Fe]);var Fe=arguments.length-2;if(Fe===1)ye.children=me;else if(1<Fe){for(var Be=Array(Fe),vt=0;vt<Fe;vt++)Be[vt]=arguments[vt+2];ye.children=Be}return D(q.type,Ne,ye)},Oe.createContext=function(q){return q={$$typeof:u,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:o,_context:q},q},Oe.createElement=function(q,re,me){var ye,Ne={},Fe=null;if(re!=null)for(ye in re.key!==void 0&&(Fe=""+re.key),re)N.call(re,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Ne[ye]=re[ye]);var Be=arguments.length-2;if(Be===1)Ne.children=me;else if(1<Be){for(var vt=Array(Be),gt=0;gt<Be;gt++)vt[gt]=arguments[gt+2];Ne.children=vt}if(q&&q.defaultProps)for(ye in Be=q.defaultProps,Be)Ne[ye]===void 0&&(Ne[ye]=Be[ye]);return D(q,Fe,Ne)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(q){return{$$typeof:d,render:q}},Oe.isValidElement=L,Oe.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:he}},Oe.memo=function(q,re){return{$$typeof:f,type:q,compare:re===void 0?null:re}},Oe.startTransition=function(q){var re=R.T,me={};R.T=me;try{var ye=q(),Ne=R.S;Ne!==null&&Ne(me,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(H,Ae)}catch(Fe){Ae(Fe)}finally{re!==null&&me.types!==null&&(re.types=me.types),R.T=re}},Oe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Oe.use=function(q){return R.H.use(q)},Oe.useActionState=function(q,re,me){return R.H.useActionState(q,re,me)},Oe.useCallback=function(q,re){return R.H.useCallback(q,re)},Oe.useContext=function(q){return R.H.useContext(q)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(q,re){return R.H.useDeferredValue(q,re)},Oe.useEffect=function(q,re){return R.H.useEffect(q,re)},Oe.useEffectEvent=function(q){return R.H.useEffectEvent(q)},Oe.useId=function(){return R.H.useId()},Oe.useImperativeHandle=function(q,re,me){return R.H.useImperativeHandle(q,re,me)},Oe.useInsertionEffect=function(q,re){return R.H.useInsertionEffect(q,re)},Oe.useLayoutEffect=function(q,re){return R.H.useLayoutEffect(q,re)},Oe.useMemo=function(q,re){return R.H.useMemo(q,re)},Oe.useOptimistic=function(q,re){return R.H.useOptimistic(q,re)},Oe.useReducer=function(q,re,me){return R.H.useReducer(q,re,me)},Oe.useRef=function(q){return R.H.useRef(q)},Oe.useState=function(q){return R.H.useState(q)},Oe.useSyncExternalStore=function(q,re,me){return R.H.useSyncExternalStore(q,re,me)},Oe.useTransition=function(){return R.H.useTransition()},Oe.version="19.2.0",Oe}var c_;function Kp(){return c_||(c_=1,Um.exports=Pw()),Um.exports}var fe=Kp();const Yp=Ix(fe);var Fm={exports:{}},du={},Bm={exports:{}},jm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d_;function kw(){return d_||(d_=1,(function(n){function e(Z,Q){var he=Z.length;Z.push(Q);e:for(;0<he;){var Ae=he-1>>>1,Ce=Z[Ae];if(0<r(Ce,Q))Z[Ae]=Q,Z[he]=Ce,he=Ae;else break e}}function t(Z){return Z.length===0?null:Z[0]}function s(Z){if(Z.length===0)return null;var Q=Z[0],he=Z.pop();if(he!==Q){Z[0]=he;e:for(var Ae=0,Ce=Z.length,q=Ce>>>1;Ae<q;){var re=2*(Ae+1)-1,me=Z[re],ye=re+1,Ne=Z[ye];if(0>r(me,he))ye<Ce&&0>r(Ne,me)?(Z[Ae]=Ne,Z[ye]=he,Ae=ye):(Z[Ae]=me,Z[re]=he,Ae=re);else if(ye<Ce&&0>r(Ne,he))Z[Ae]=Ne,Z[ye]=he,Ae=ye;else break e}}return Q}function r(Z,Q){var he=Z.sortIndex-Q.sortIndex;return he!==0?he:Z.id-Q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var h=[],f=[],_=1,b=null,x=3,C=!1,M=!1,k=!1,V=!1,$=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function K(Z){for(var Q=t(f);Q!==null;){if(Q.callback===null)s(f);else if(Q.startTime<=Z)s(f),Q.sortIndex=Q.expirationTime,e(h,Q);else break;Q=t(f)}}function se(Z){if(k=!1,K(Z),!M)if(t(h)!==null)M=!0,H||(H=!0,j());else{var Q=t(f);Q!==null&&We(se,Q.startTime-Z)}}var H=!1,R=-1,N=5,D=-1;function w(){return V?!0:!(n.unstable_now()-D<N)}function L(){if(V=!1,H){var Z=n.unstable_now();D=Z;var Q=!0;try{e:{M=!1,k&&(k=!1,U(R),R=-1),C=!0;var he=x;try{t:{for(K(Z),b=t(h);b!==null&&!(b.expirationTime>Z&&w());){var Ae=b.callback;if(typeof Ae=="function"){b.callback=null,x=b.priorityLevel;var Ce=Ae(b.expirationTime<=Z);if(Z=n.unstable_now(),typeof Ce=="function"){b.callback=Ce,K(Z),Q=!0;break t}b===t(h)&&s(h),K(Z)}else s(h);b=t(h)}if(b!==null)Q=!0;else{var q=t(f);q!==null&&We(se,q.startTime-Z),Q=!1}}break e}finally{b=null,x=he,C=!1}Q=void 0}}finally{Q?j():H=!1}}}var j;if(typeof B=="function")j=function(){B(L)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Pe=O.port2;O.port1.onmessage=L,j=function(){Pe.postMessage(null)}}else j=function(){$(L,0)};function We(Z,Q){R=$(function(){Z(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(Z){switch(x){case 1:case 2:case 3:var Q=3;break;default:Q=x}var he=x;x=Q;try{return Z()}finally{x=he}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function(Z,Q){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var he=x;x=Z;try{return Q()}finally{x=he}},n.unstable_scheduleCallback=function(Z,Q,he){var Ae=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ae+he:Ae):he=Ae,Z){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=he+Ce,Z={id:_++,callback:Q,priorityLevel:Z,startTime:he,expirationTime:Ce,sortIndex:-1},he>Ae?(Z.sortIndex=he,e(f,Z),t(h)===null&&Z===t(f)&&(k?(U(R),R=-1):k=!0,We(se,he-Ae))):(Z.sortIndex=Ce,e(h,Z),M||C||(M=!0,H||(H=!0,j()))),Z},n.unstable_shouldYield=w,n.unstable_wrapCallback=function(Z){var Q=x;return function(){var he=x;x=Q;try{return Z.apply(this,arguments)}finally{x=he}}}})(jm)),jm}var f_;function Lw(){return f_||(f_=1,Bm.exports=kw()),Bm.exports}var qm={exports:{}},hn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_;function Vw(){if(h_)return hn;h_=1;var n=Kp();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)f+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,f,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:h,containerInfo:f,implementation:_}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,hn.createPortal=function(h,f){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,_)},hn.flushSync=function(h){var f=u.T,_=s.p;try{if(u.T=null,s.p=2,h)return h()}finally{u.T=f,s.p=_,s.d.f()}},hn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,s.d.C(h,f))},hn.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},hn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var _=f.as,b=d(_,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,C=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;_==="style"?s.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:C}):_==="script"&&s.d.X(h,{crossOrigin:b,integrity:x,fetchPriority:C,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},hn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var _=d(f.as,f.crossOrigin);s.d.M(h,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&s.d.M(h)},hn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var _=f.as,b=d(_,f.crossOrigin);s.d.L(h,_,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},hn.preloadModule=function(h,f){if(typeof h=="string")if(f){var _=d(f.as,f.crossOrigin);s.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else s.d.m(h)},hn.requestFormReset=function(h){s.d.r(h)},hn.unstable_batchedUpdates=function(h,f){return h(f)},hn.useFormState=function(h,f,_){return u.H.useFormState(h,f,_)},hn.useFormStatus=function(){return u.H.useHostTransitionStatus()},hn.version="19.2.0",hn}var m_;function Ow(){if(m_)return qm.exports;m_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qm.exports=Vw(),qm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p_;function Uw(){if(p_)return du;p_=1;var n=Lw(),e=Kp(),t=Ow();function s(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,l=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(l=a.return),i=a.return;while(i)}return a.tag===3?l:null}function u(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function d(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(s(188))}function f(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(s(188));return a!==i?null:i}for(var l=i,c=a;;){var v=l.return;if(v===null)break;var T=v.alternate;if(T===null){if(c=v.return,c!==null){l=c;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===l)return h(v),i;if(T===c)return h(v),a;T=T.sibling}throw Error(s(188))}if(l.return!==c.return)l=v,c=T;else{for(var S=!1,I=v.child;I;){if(I===l){S=!0,l=v,c=T;break}if(I===c){S=!0,c=v,l=T;break}I=I.sibling}if(!S){for(I=T.child;I;){if(I===l){S=!0,l=T,c=v;break}if(I===c){S=!0,c=T,l=v;break}I=I.sibling}if(!S)throw Error(s(189))}}if(l.alternate!==c)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?i:a}function _(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=_(i),a!==null)return a;i=i.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),B=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),w=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function j(i){return i===null||typeof i!="object"?null:(i=L&&i[L]||i["@@iterator"],typeof i=="function"?i:null)}var O=Symbol.for("react.client.reference");function Pe(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===O?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case k:return"Fragment";case $:return"Profiler";case V:return"StrictMode";case se:return"Suspense";case H:return"SuspenseList";case D:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case M:return"Portal";case B:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case K:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case R:return a=i.displayName||null,a!==null?a:Pe(i.type)||"Memo";case N:a=i._payload,i=i._init;try{return Pe(i(a))}catch{}}return null}var We=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Ae=[],Ce=-1;function q(i){return{current:i}}function re(i){0>Ce||(i.current=Ae[Ce],Ae[Ce]=null,Ce--)}function me(i,a){Ce++,Ae[Ce]=i.current,i.current=a}var ye=q(null),Ne=q(null),Fe=q(null),Be=q(null);function vt(i,a){switch(me(Fe,a),me(Ne,i),me(ye,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?R0(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=R0(a),i=D0(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}re(ye),me(ye,i)}function gt(){re(ye),re(Ne),re(Fe)}function ei(i){i.memoizedState!==null&&me(Be,i);var a=ye.current,l=D0(a,i.type);a!==l&&(me(Ne,i),me(ye,l))}function qi(i){Ne.current===i&&(re(ye),re(Ne)),Be.current===i&&(re(Be),au._currentValue=he)}var ti,Hi;function zn(i){if(ti===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);ti=a&&a[1]||"",Hi=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ti+i+Hi}var Br=!1;function ni(i,a){if(!i||Br)return"";Br=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ne){var ee=ne}Reflect.construct(i,[],oe)}else{try{oe.call()}catch(ne){ee=ne}i.call(oe.prototype)}}else{try{throw Error()}catch(ne){ee=ne}(oe=i())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ne){if(ne&&ee&&typeof ne.stack=="string")return[ne.stack,ee.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=c.DetermineComponentFrameRoot(),S=T[0],I=T[1];if(S&&I){var F=S.split(`
`),W=I.split(`
`);for(v=c=0;c<F.length&&!F[c].includes("DetermineComponentFrameRoot");)c++;for(;v<W.length&&!W[v].includes("DetermineComponentFrameRoot");)v++;if(c===F.length||v===W.length)for(c=F.length-1,v=W.length-1;1<=c&&0<=v&&F[c]!==W[v];)v--;for(;1<=c&&0<=v;c--,v--)if(F[c]!==W[v]){if(c!==1||v!==1)do if(c--,v--,0>v||F[c]!==W[v]){var ie=`
`+F[c].replace(" at new "," at ");return i.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",i.displayName)),ie}while(1<=c&&0<=v);break}}}finally{Br=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?zn(l):""}function jr(i,a){switch(i.tag){case 26:case 27:case 5:return zn(i.type);case 16:return zn("Lazy");case 13:return i.child!==a&&a!==null?zn("Suspense Fallback"):zn("Suspense");case 19:return zn("SuspenseList");case 0:case 15:return ni(i.type,!1);case 11:return ni(i.type.render,!1);case 1:return ni(i.type,!0);case 31:return zn("Activity");default:return""}}function qr(i){try{var a="",l=null;do a+=jr(i,l),l=i,i=i.return;while(i);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ct=Object.prototype.hasOwnProperty,Dt=n.unstable_scheduleCallback,Cs=n.unstable_cancelCallback,cl=n.unstable_shouldYield,Ua=n.unstable_requestPaint,rn=n.unstable_now,si=n.unstable_getCurrentPriorityLevel,Hr=n.unstable_ImmediatePriority,zi=n.unstable_UserBlockingPriority,ws=n.unstable_NormalPriority,Fa=n.unstable_LowPriority,zr=n.unstable_IdlePriority,Gr=n.log,$r=n.unstable_setDisableYieldValue,Sn=null,G=null;function ue(i){if(typeof Gr=="function"&&$r(i),G&&typeof G.setStrictMode=="function")try{G.setStrictMode(Sn,i)}catch{}}var ce=Math.clz32?Math.clz32:ze,ge=Math.log,_e=Math.LN2;function ze(i){return i>>>=0,i===0?32:31-(ge(i)/_e|0)|0}var fn=256,ls=262144,wt=4194304;function Gn(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function $n(i,a,l){var c=i.pendingLanes;if(c===0)return 0;var v=0,T=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var I=c&134217727;return I!==0?(c=I&~T,c!==0?v=Gn(c):(S&=I,S!==0?v=Gn(S):l||(l=I&~i,l!==0&&(v=Gn(l))))):(I=c&~T,I!==0?v=Gn(I):S!==0?v=Gn(S):l||(l=c&~i,l!==0&&(v=Gn(l)))),v===0?0:a!==0&&a!==v&&(a&T)===0&&(T=v&-v,l=a&-a,T>=l||T===32&&(l&4194048)!==0)?a:v}function Pn(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function Te(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function It(){var i=wt;return wt<<=1,(wt&62914560)===0&&(wt=4194304),i}function Kt(i){for(var a=[],l=0;31>l;l++)a.push(i);return a}function Xt(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ii(i,a,l,c,v,T){var S=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var I=i.entanglements,F=i.expirationTimes,W=i.hiddenUpdates;for(l=S&~l;0<l;){var ie=31-ce(l),oe=1<<ie;I[ie]=0,F[ie]=-1;var ee=W[ie];if(ee!==null)for(W[ie]=null,ie=0;ie<ee.length;ie++){var ne=ee[ie];ne!==null&&(ne.lane&=-536870913)}l&=~oe}c!==0&&tt(i,c,0),T!==0&&v===0&&i.tag!==0&&(i.suspendedLanes|=T&~(S&~a))}function tt(i,a,l){i.pendingLanes|=a,i.suspendedLanes&=~a;var c=31-ce(a);i.entangledLanes|=a,i.entanglements[c]=i.entanglements[c]|1073741824|l&261930}function dl(i,a){var l=i.entangledLanes|=a;for(i=i.entanglements;l;){var c=31-ce(l),v=1<<c;v&a|i[c]&a&&(i[c]|=a),l&=~v}}function fl(i,a){var l=a&-a;return l=(l&42)!==0?1:Kr(l),(l&(i.suspendedLanes|a))!==0?0:l}function Kr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ri(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Zu(){var i=Q.p;return i!==0?i:(i=window.event,i===void 0?32:e_(i.type))}function us(i,a){var l=Q.p;try{return Q.p=i,a()}finally{Q.p=l}}var cs=Math.random().toString(36).slice(2),Ot="__reactFiber$"+cs,Wt="__reactProps$"+cs,Is="__reactContainer$"+cs,Ba="__reactEvents$"+cs,Hf="__reactListeners$"+cs,ec="__reactHandles$"+cs,tc="__reactResources$"+cs,Ns="__reactMarker$"+cs;function ja(i){delete i[Ot],delete i[Wt],delete i[Ba],delete i[Hf],delete i[ec]}function Rs(i){var a=i[Ot];if(a)return a;for(var l=i.parentNode;l;){if(a=l[Is]||l[Ot]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(i=U0(i);i!==null;){if(l=i[Ot])return l;i=U0(i)}return a}i=l,l=i.parentNode}return null}function Kn(i){if(i=i[Ot]||i[Is]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function kn(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(s(33))}function Ds(i){var a=i[tc];return a||(a=i[tc]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ut(i){i[Ns]=!0}var hl=new Set,ml={};function Ms(i,a){Ps(i,a),Ps(i+"Capture",a)}function Ps(i,a){for(ml[i]=a,i=0;i<a.length;i++)hl.add(a[i])}var pl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gl={},yl={};function nc(i){return Ct.call(yl,i)?!0:Ct.call(gl,i)?!1:pl.test(i)?yl[i]=!0:(gl[i]=!0,!1)}function qa(i,a,l){if(nc(a))if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+l)}}function Ln(i,a,l){if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+l)}}function Ft(i,a,l,c){if(c===null)i.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(a,l,""+c)}}function Zt(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Gi(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function vl(i,a,l){var c=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,T=c.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return v.call(this)},set:function(S){l=""+S,T.call(this,S)}}),Object.defineProperty(i,a,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function lt(i){if(!i._valueTracker){var a=Gi(i)?"checked":"value";i._valueTracker=vl(i,a,""+i[a])}}function Yr(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return i&&(c=Gi(i)?i.checked?"true":"false":i.value),i=c,i!==l?(a.setValue(i),!0):!1}function ks(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Jr=/[\n"\\]/g;function An(i){return i.replace(Jr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ha(i,a,l,c,v,T,S,I){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),a!=null?S==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Zt(a)):i.value!==""+Zt(a)&&(i.value=""+Zt(a)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),a!=null?_l(i,S,Zt(a)):l!=null?_l(i,S,Zt(l)):c!=null&&i.removeAttribute("value"),v==null&&T!=null&&(i.defaultChecked=!!T),v!=null&&(i.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?i.name=""+Zt(I):i.removeAttribute("name")}function sc(i,a,l,c,v,T,S,I){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),a!=null||l!=null){if(!(T!=="submit"&&T!=="reset"||a!=null)){lt(i);return}l=l!=null?""+Zt(l):"",a=a!=null?""+Zt(a):l,I||a===i.value||(i.value=a),i.defaultValue=a}c=c??v,c=typeof c!="function"&&typeof c!="symbol"&&!!c,i.checked=I?i.checked:!!c,i.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S),lt(i)}function _l(i,a,l){a==="number"&&ks(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function $i(i,a,l,c){if(i=i.options,a){a={};for(var v=0;v<l.length;v++)a["$"+l[v]]=!0;for(l=0;l<i.length;l++)v=a.hasOwnProperty("$"+i[l].value),i[l].selected!==v&&(i[l].selected=v),v&&c&&(i[l].defaultSelected=!0)}else{for(l=""+Zt(l),a=null,v=0;v<i.length;v++){if(i[v].value===l){i[v].selected=!0,c&&(i[v].defaultSelected=!0);return}a!==null||i[v].disabled||(a=i[v])}a!==null&&(a.selected=!0)}}function ic(i,a,l){if(a!=null&&(a=""+Zt(a),a!==i.value&&(i.value=a),l==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=l!=null?""+Zt(l):""}function Ki(i,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(s(92));if(We(c)){if(1<c.length)throw Error(s(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=Zt(a),i.defaultValue=l,c=i.textContent,c===l&&c!==""&&c!==null&&(i.value=c),lt(i)}function Cn(i,a){if(a){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=a;return}}i.textContent=a}var rc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tl(i,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":c?i.setProperty(a,l):typeof l!="number"||l===0||rc.has(a)?a==="float"?i.cssFloat=l:i[a]=(""+l).trim():i[a]=l+"px"}function bl(i,a,l){if(a!=null&&typeof a!="object")throw Error(s(62));if(i=i.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="");for(var v in a)c=a[v],a.hasOwnProperty(v)&&l[v]!==c&&Tl(i,v,c)}else for(var T in a)a.hasOwnProperty(T)&&Tl(i,T,a[T])}function za(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ga(i){return Yi.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ds(){}var xl=null;function Yn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ji=null,Ls=null;function Qr(i){var a=Kn(i);if(a&&(i=a.stateNode)){var l=i[Wt]||null;e:switch(i=a.stateNode,a.type){case"input":if(Ha(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+An(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==i&&c.form===i.form){var v=c[Wt]||null;if(!v)throw Error(s(90));Ha(c,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===i.form&&Yr(c)}break e;case"textarea":ic(i,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&$i(i,!!l.multiple,a,!1)}}}var $a=!1;function Qi(i,a,l){if($a)return i(a,l);$a=!0;try{var c=i(a);return c}finally{if($a=!1,(Ji!==null||Ls!==null)&&(Zc(),Ji&&(a=Ji,i=Ls,Ls=Ji=null,Qr(a),i)))for(a=0;a<i.length;a++)Qr(i[a])}}function fs(i,a){var l=i.stateNode;if(l===null)return null;var c=l[Wt]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(s(231,a,typeof l));return l}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xr=!1;if(Jn)try{var dt={};Object.defineProperty(dt,"passive",{get:function(){Xr=!0}}),window.addEventListener("test",dt,dt),window.removeEventListener("test",dt,dt)}catch{Xr=!1}var Vs=null,El=null,Wr=null;function Sl(){if(Wr)return Wr;var i,a=El,l=a.length,c,v="value"in Vs?Vs.value:Vs.textContent,T=v.length;for(i=0;i<l&&a[i]===v[i];i++);var S=l-i;for(c=1;c<=S&&a[l-c]===v[T-c];c++);return Wr=v.slice(i,1<c?1-c:void 0)}function Zr(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function ai(){return!0}function hs(){return!1}function an(i){function a(l,c,v,T,S){this._reactName=l,this._targetInst=v,this.type=c,this.nativeEvent=T,this.target=S,this.currentTarget=null;for(var I in i)i.hasOwnProperty(I)&&(l=i[I],this[I]=l?l(T):T[I]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?ai:hs,this.isPropagationStopped=hs,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),a}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Os=an(oi),Xi=b({},oi,{view:0,detail:0}),Al=an(Xi),Wi,Ka,Us,Ya=b({},Xi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zi,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Us&&(Us&&i.type==="mousemove"?(Wi=i.screenX-Us.screenX,Ka=i.screenY-Us.screenY):Ka=Wi=0,Us=i),Wi)},movementY:function(i){return"movementY"in i?i.movementY:Ka}}),Cl=an(Ya),ea=b({},Ya,{dataTransfer:0}),oc=an(ea),lc=b({},Xi,{relatedTarget:0}),ta=an(lc),wl=b({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),uc=an(wl),Ja=b({},oi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),cc=an(Ja),dc=b({},oi,{data:0}),Fs=an(dc),fc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pc(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=mc[i])?!!a[i]:!1}function Zi(){return pc}var bn=b({},Xi,{key:function(i){if(i.key){var a=fc[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=Zr(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?hc[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zi,charCode:function(i){return i.type==="keypress"?Zr(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Zr(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),gc=an(bn),yc=b({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=an(yc),g=b({},Xi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zi}),E=an(g),A=b({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),P=an(A),J=b({},Ya,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),te=an(J),pe=b({},oi,{newState:0,oldState:0}),je=an(pe),Mt=[9,13,27,32],rt=Jn&&"CompositionEvent"in window,Et=null;Jn&&"documentMode"in document&&(Et=document.documentMode);var Qn=Jn&&"TextEvent"in window&&!Et,Bs=Jn&&(!rt||Et&&8<Et&&11>=Et),ms=" ",ps=!1;function na(i,a){switch(i){case"keyup":return Mt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qa(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Xa=!1;function tC(i,a){switch(i){case"compositionend":return Qa(a);case"keypress":return a.which!==32?null:(ps=!0,ms);case"textInput":return i=a.data,i===ms&&ps?null:i;default:return null}}function nC(i,a){if(Xa)return i==="compositionend"||!rt&&na(i,a)?(i=Sl(),Wr=El=Vs=null,Xa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Bs&&a.locale!=="ko"?null:a.data;default:return null}}var sC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jg(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!sC[i.type]:a==="textarea"}function qg(i,a,l,c){Ji?Ls?Ls.push(c):Ls=[c]:Ji=c,a=ad(a,"onChange"),0<a.length&&(l=new Os("onChange","change",null,l,c),i.push({event:l,listeners:a}))}var Il=null,Nl=null;function iC(i){S0(i,0)}function vc(i){var a=kn(i);if(Yr(a))return i}function Hg(i,a){if(i==="change")return a}var zg=!1;if(Jn){var zf;if(Jn){var Gf="oninput"in document;if(!Gf){var Gg=document.createElement("div");Gg.setAttribute("oninput","return;"),Gf=typeof Gg.oninput=="function"}zf=Gf}else zf=!1;zg=zf&&(!document.documentMode||9<document.documentMode)}function $g(){Il&&(Il.detachEvent("onpropertychange",Kg),Nl=Il=null)}function Kg(i){if(i.propertyName==="value"&&vc(Nl)){var a=[];qg(a,Nl,i,Yn(i)),Qi(iC,a)}}function rC(i,a,l){i==="focusin"?($g(),Il=a,Nl=l,Il.attachEvent("onpropertychange",Kg)):i==="focusout"&&$g()}function aC(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return vc(Nl)}function oC(i,a){if(i==="click")return vc(a)}function lC(i,a){if(i==="input"||i==="change")return vc(a)}function uC(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Vn=typeof Object.is=="function"?Object.is:uC;function Rl(i,a){if(Vn(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var l=Object.keys(i),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var v=l[c];if(!Ct.call(a,v)||!Vn(i[v],a[v]))return!1}return!0}function Yg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Jg(i,a){var l=Yg(i);i=0;for(var c;l;){if(l.nodeType===3){if(c=i+l.textContent.length,i<=a&&c>=a)return{node:l,offset:a-i};i=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Yg(l)}}function Qg(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?Qg(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function Xg(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=ks(i.document);a instanceof i.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)i=a.contentWindow;else break;a=ks(i.document)}return a}function $f(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var cC=Jn&&"documentMode"in document&&11>=document.documentMode,Wa=null,Kf=null,Dl=null,Yf=!1;function Wg(i,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Yf||Wa==null||Wa!==ks(c)||(c=Wa,"selectionStart"in c&&$f(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Dl&&Rl(Dl,c)||(Dl=c,c=ad(Kf,"onSelect"),0<c.length&&(a=new Os("onSelect","select",null,a,l),i.push({event:a,listeners:c}),a.target=Wa)))}function sa(i,a){var l={};return l[i.toLowerCase()]=a.toLowerCase(),l["Webkit"+i]="webkit"+a,l["Moz"+i]="moz"+a,l}var Za={animationend:sa("Animation","AnimationEnd"),animationiteration:sa("Animation","AnimationIteration"),animationstart:sa("Animation","AnimationStart"),transitionrun:sa("Transition","TransitionRun"),transitionstart:sa("Transition","TransitionStart"),transitioncancel:sa("Transition","TransitionCancel"),transitionend:sa("Transition","TransitionEnd")},Jf={},Zg={};Jn&&(Zg=document.createElement("div").style,"AnimationEvent"in window||(delete Za.animationend.animation,delete Za.animationiteration.animation,delete Za.animationstart.animation),"TransitionEvent"in window||delete Za.transitionend.transition);function ia(i){if(Jf[i])return Jf[i];if(!Za[i])return i;var a=Za[i],l;for(l in a)if(a.hasOwnProperty(l)&&l in Zg)return Jf[i]=a[l];return i}var ey=ia("animationend"),ty=ia("animationiteration"),ny=ia("animationstart"),dC=ia("transitionrun"),fC=ia("transitionstart"),hC=ia("transitioncancel"),sy=ia("transitionend"),iy=new Map,Qf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qf.push("scrollEnd");function gs(i,a){iy.set(i,a),Ms(a,[i])}var _c=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Xn=[],eo=0,Xf=0;function Tc(){for(var i=eo,a=Xf=eo=0;a<i;){var l=Xn[a];Xn[a++]=null;var c=Xn[a];Xn[a++]=null;var v=Xn[a];Xn[a++]=null;var T=Xn[a];if(Xn[a++]=null,c!==null&&v!==null){var S=c.pending;S===null?v.next=v:(v.next=S.next,S.next=v),c.pending=v}T!==0&&ry(l,v,T)}}function bc(i,a,l,c){Xn[eo++]=i,Xn[eo++]=a,Xn[eo++]=l,Xn[eo++]=c,Xf|=c,i.lanes|=c,i=i.alternate,i!==null&&(i.lanes|=c)}function Wf(i,a,l,c){return bc(i,a,l,c),xc(i)}function ra(i,a){return bc(i,null,null,a),xc(i)}function ry(i,a,l){i.lanes|=l;var c=i.alternate;c!==null&&(c.lanes|=l);for(var v=!1,T=i.return;T!==null;)T.childLanes|=l,c=T.alternate,c!==null&&(c.childLanes|=l),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(v=!0)),i=T,T=T.return;return i.tag===3?(T=i.stateNode,v&&a!==null&&(v=31-ce(l),i=T.hiddenUpdates,c=i[v],c===null?i[v]=[a]:c.push(a),a.lane=l|536870912),T):null}function xc(i){if(50<Zl)throw Zl=0,om=null,Error(s(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var to={};function mC(i,a,l,c){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(i,a,l,c){return new mC(i,a,l,c)}function Zf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ui(i,a){var l=i.alternate;return l===null?(l=On(i.tag,a,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=a,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,a=i.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function ay(i,a){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,a=l.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function Ec(i,a,l,c,v,T){var S=0;if(c=i,typeof i=="function")Zf(i)&&(S=1);else if(typeof i=="string")S=_w(i,l,ye.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case D:return i=On(31,l,a,v),i.elementType=D,i.lanes=T,i;case k:return aa(l.children,v,T,a);case V:S=8,v|=24;break;case $:return i=On(12,l,a,v|2),i.elementType=$,i.lanes=T,i;case se:return i=On(13,l,a,v),i.elementType=se,i.lanes=T,i;case H:return i=On(19,l,a,v),i.elementType=H,i.lanes=T,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case B:S=10;break e;case U:S=9;break e;case K:S=11;break e;case R:S=14;break e;case N:S=16,c=null;break e}S=29,l=Error(s(130,i===null?"null":typeof i,"")),c=null}return a=On(S,l,a,v),a.elementType=i,a.type=c,a.lanes=T,a}function aa(i,a,l,c){return i=On(7,i,c,a),i.lanes=l,i}function eh(i,a,l){return i=On(6,i,null,a),i.lanes=l,i}function oy(i){var a=On(18,null,null,0);return a.stateNode=i,a}function th(i,a,l){return a=On(4,i.children!==null?i.children:[],i.key,a),a.lanes=l,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var ly=new WeakMap;function Wn(i,a){if(typeof i=="object"&&i!==null){var l=ly.get(i);return l!==void 0?l:(a={value:i,source:a,stack:qr(a)},ly.set(i,a),a)}return{value:i,source:a,stack:qr(a)}}var no=[],so=0,Sc=null,Ml=0,Zn=[],es=0,er=null,js=1,qs="";function ci(i,a){no[so++]=Ml,no[so++]=Sc,Sc=i,Ml=a}function uy(i,a,l){Zn[es++]=js,Zn[es++]=qs,Zn[es++]=er,er=i;var c=js;i=qs;var v=32-ce(c)-1;c&=~(1<<v),l+=1;var T=32-ce(a)+v;if(30<T){var S=v-v%5;T=(c&(1<<S)-1).toString(32),c>>=S,v-=S,js=1<<32-ce(a)+v|l<<v|c,qs=T+i}else js=1<<T|l<<v|c,qs=i}function nh(i){i.return!==null&&(ci(i,1),uy(i,1,0))}function sh(i){for(;i===Sc;)Sc=no[--so],no[so]=null,Ml=no[--so],no[so]=null;for(;i===er;)er=Zn[--es],Zn[es]=null,qs=Zn[--es],Zn[es]=null,js=Zn[--es],Zn[es]=null}function cy(i,a){Zn[es++]=js,Zn[es++]=qs,Zn[es++]=er,js=a.id,qs=a.overflow,er=i}var on=null,_t=null,Ze=!1,tr=null,ts=!1,ih=Error(s(519));function nr(i){var a=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Pl(Wn(a,i)),ih}function dy(i){var a=i.stateNode,l=i.type,c=i.memoizedProps;switch(a[Ot]=i,a[Wt]=c,l){case"dialog":$e("cancel",a),$e("close",a);break;case"iframe":case"object":case"embed":$e("load",a);break;case"video":case"audio":for(l=0;l<tu.length;l++)$e(tu[l],a);break;case"source":$e("error",a);break;case"img":case"image":case"link":$e("error",a),$e("load",a);break;case"details":$e("toggle",a);break;case"input":$e("invalid",a),sc(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":$e("invalid",a);break;case"textarea":$e("invalid",a),Ki(a,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||I0(a.textContent,l)?(c.popover!=null&&($e("beforetoggle",a),$e("toggle",a)),c.onScroll!=null&&$e("scroll",a),c.onScrollEnd!=null&&$e("scrollend",a),c.onClick!=null&&(a.onclick=ds),a=!0):a=!1,a||nr(i,!0)}function fy(i){for(on=i.return;on;)switch(on.tag){case 5:case 31:case 13:ts=!1;return;case 27:case 3:ts=!0;return;default:on=on.return}}function io(i){if(i!==on)return!1;if(!Ze)return fy(i),Ze=!0,!1;var a=i.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||xm(i.type,i.memoizedProps)),l=!l),l&&_t&&nr(i),fy(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));_t=O0(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));_t=O0(i)}else a===27?(a=_t,gr(i.type)?(i=wm,wm=null,_t=i):_t=a):_t=on?ss(i.stateNode.nextSibling):null;return!0}function oa(){_t=on=null,Ze=!1}function rh(){var i=tr;return i!==null&&(Rn===null?Rn=i:Rn.push.apply(Rn,i),tr=null),i}function Pl(i){tr===null?tr=[i]:tr.push(i)}var ah=q(null),la=null,di=null;function sr(i,a,l){me(ah,a._currentValue),a._currentValue=l}function fi(i){i._currentValue=ah.current,re(ah)}function oh(i,a,l){for(;i!==null;){var c=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),i===l)break;i=i.return}}function lh(i,a,l,c){var v=i.child;for(v!==null&&(v.return=i);v!==null;){var T=v.dependencies;if(T!==null){var S=v.child;T=T.firstContext;e:for(;T!==null;){var I=T;T=v;for(var F=0;F<a.length;F++)if(I.context===a[F]){T.lanes|=l,I=T.alternate,I!==null&&(I.lanes|=l),oh(T.return,l,i),c||(S=null);break e}T=I.next}}else if(v.tag===18){if(S=v.return,S===null)throw Error(s(341));S.lanes|=l,T=S.alternate,T!==null&&(T.lanes|=l),oh(S,l,i),S=null}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===i){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}}function ro(i,a,l,c){i=null;for(var v=a,T=!1;v!==null;){if(!T){if((v.flags&524288)!==0)T=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var S=v.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var I=v.type;Vn(v.pendingProps.value,S.value)||(i!==null?i.push(I):i=[I])}}else if(v===Be.current){if(S=v.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(i!==null?i.push(au):i=[au])}v=v.return}i!==null&&lh(a,i,l,c),a.flags|=262144}function Ac(i){for(i=i.firstContext;i!==null;){if(!Vn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ua(i){la=i,di=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function ln(i){return hy(la,i)}function Cc(i,a){return la===null&&ua(i),hy(i,a)}function hy(i,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},di===null){if(i===null)throw Error(s(308));di=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else di=di.next=a;return l}var pC=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(l,c){i.push(c)}};this.abort=function(){a.aborted=!0,i.forEach(function(l){return l()})}},gC=n.unstable_scheduleCallback,yC=n.unstable_NormalPriority,Bt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uh(){return{controller:new pC,data:new Map,refCount:0}}function kl(i){i.refCount--,i.refCount===0&&gC(yC,function(){i.controller.abort()})}var Ll=null,ch=0,ao=0,oo=null;function vC(i,a){if(Ll===null){var l=Ll=[];ch=0,ao=hm(),oo={status:"pending",value:void 0,then:function(c){l.push(c)}}}return ch++,a.then(my,my),a}function my(){if(--ch===0&&Ll!==null){oo!==null&&(oo.status="fulfilled");var i=Ll;Ll=null,ao=0,oo=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function _C(i,a){var l=[],c={status:"pending",value:null,reason:null,then:function(v){l.push(v)}};return i.then(function(){c.status="fulfilled",c.value=a;for(var v=0;v<l.length;v++)(0,l[v])(a)},function(v){for(c.status="rejected",c.reason=v,v=0;v<l.length;v++)(0,l[v])(void 0)}),c}var py=Z.S;Z.S=function(i,a){Wv=rn(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&vC(i,a),py!==null&&py(i,a)};var ca=q(null);function dh(){var i=ca.current;return i!==null?i:pt.pooledCache}function wc(i,a){a===null?me(ca,ca.current):me(ca,a.pool)}function gy(){var i=dh();return i===null?null:{parent:Bt._currentValue,pool:i}}var lo=Error(s(460)),fh=Error(s(474)),Ic=Error(s(542)),Nc={then:function(){}};function yy(i){return i=i.status,i==="fulfilled"||i==="rejected"}function vy(i,a,l){switch(l=i[l],l===void 0?i.push(a):l!==a&&(a.then(ds,ds),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Ty(i),i;default:if(typeof a.status=="string")a.then(ds,ds);else{if(i=pt,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=a,i.status="pending",i.then(function(c){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=c}},function(c){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Ty(i),i}throw fa=a,lo}}function da(i){try{var a=i._init;return a(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(fa=l,lo):l}}var fa=null;function _y(){if(fa===null)throw Error(s(459));var i=fa;return fa=null,i}function Ty(i){if(i===lo||i===Ic)throw Error(s(483))}var uo=null,Vl=0;function Rc(i){var a=Vl;return Vl+=1,uo===null&&(uo=[]),vy(uo,i,a)}function Ol(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Dc(i,a){throw a.$$typeof===x?Error(s(525)):(i=Object.prototype.toString.call(a),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function by(i){function a(Y,z){if(i){var X=Y.deletions;X===null?(Y.deletions=[z],Y.flags|=16):X.push(z)}}function l(Y,z){if(!i)return null;for(;z!==null;)a(Y,z),z=z.sibling;return null}function c(Y){for(var z=new Map;Y!==null;)Y.key!==null?z.set(Y.key,Y):z.set(Y.index,Y),Y=Y.sibling;return z}function v(Y,z){return Y=ui(Y,z),Y.index=0,Y.sibling=null,Y}function T(Y,z,X){return Y.index=X,i?(X=Y.alternate,X!==null?(X=X.index,X<z?(Y.flags|=67108866,z):X):(Y.flags|=67108866,z)):(Y.flags|=1048576,z)}function S(Y){return i&&Y.alternate===null&&(Y.flags|=67108866),Y}function I(Y,z,X,ae){return z===null||z.tag!==6?(z=eh(X,Y.mode,ae),z.return=Y,z):(z=v(z,X),z.return=Y,z)}function F(Y,z,X,ae){var we=X.type;return we===k?ie(Y,z,X.props.children,ae,X.key):z!==null&&(z.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===N&&da(we)===z.type)?(z=v(z,X.props),Ol(z,X),z.return=Y,z):(z=Ec(X.type,X.key,X.props,null,Y.mode,ae),Ol(z,X),z.return=Y,z)}function W(Y,z,X,ae){return z===null||z.tag!==4||z.stateNode.containerInfo!==X.containerInfo||z.stateNode.implementation!==X.implementation?(z=th(X,Y.mode,ae),z.return=Y,z):(z=v(z,X.children||[]),z.return=Y,z)}function ie(Y,z,X,ae,we){return z===null||z.tag!==7?(z=aa(X,Y.mode,ae,we),z.return=Y,z):(z=v(z,X),z.return=Y,z)}function oe(Y,z,X){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=eh(""+z,Y.mode,X),z.return=Y,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case C:return X=Ec(z.type,z.key,z.props,null,Y.mode,X),Ol(X,z),X.return=Y,X;case M:return z=th(z,Y.mode,X),z.return=Y,z;case N:return z=da(z),oe(Y,z,X)}if(We(z)||j(z))return z=aa(z,Y.mode,X,null),z.return=Y,z;if(typeof z.then=="function")return oe(Y,Rc(z),X);if(z.$$typeof===B)return oe(Y,Cc(Y,z),X);Dc(Y,z)}return null}function ee(Y,z,X,ae){var we=z!==null?z.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return we!==null?null:I(Y,z,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case C:return X.key===we?F(Y,z,X,ae):null;case M:return X.key===we?W(Y,z,X,ae):null;case N:return X=da(X),ee(Y,z,X,ae)}if(We(X)||j(X))return we!==null?null:ie(Y,z,X,ae,null);if(typeof X.then=="function")return ee(Y,z,Rc(X),ae);if(X.$$typeof===B)return ee(Y,z,Cc(Y,X),ae);Dc(Y,X)}return null}function ne(Y,z,X,ae,we){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Y=Y.get(X)||null,I(z,Y,""+ae,we);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case C:return Y=Y.get(ae.key===null?X:ae.key)||null,F(z,Y,ae,we);case M:return Y=Y.get(ae.key===null?X:ae.key)||null,W(z,Y,ae,we);case N:return ae=da(ae),ne(Y,z,X,ae,we)}if(We(ae)||j(ae))return Y=Y.get(X)||null,ie(z,Y,ae,we,null);if(typeof ae.then=="function")return ne(Y,z,X,Rc(ae),we);if(ae.$$typeof===B)return ne(Y,z,X,Cc(z,ae),we);Dc(z,ae)}return null}function be(Y,z,X,ae){for(var we=null,nt=null,Se=z,He=z=0,Ye=null;Se!==null&&He<X.length;He++){Se.index>He?(Ye=Se,Se=null):Ye=Se.sibling;var st=ee(Y,Se,X[He],ae);if(st===null){Se===null&&(Se=Ye);break}i&&Se&&st.alternate===null&&a(Y,Se),z=T(st,z,He),nt===null?we=st:nt.sibling=st,nt=st,Se=Ye}if(He===X.length)return l(Y,Se),Ze&&ci(Y,He),we;if(Se===null){for(;He<X.length;He++)Se=oe(Y,X[He],ae),Se!==null&&(z=T(Se,z,He),nt===null?we=Se:nt.sibling=Se,nt=Se);return Ze&&ci(Y,He),we}for(Se=c(Se);He<X.length;He++)Ye=ne(Se,Y,He,X[He],ae),Ye!==null&&(i&&Ye.alternate!==null&&Se.delete(Ye.key===null?He:Ye.key),z=T(Ye,z,He),nt===null?we=Ye:nt.sibling=Ye,nt=Ye);return i&&Se.forEach(function(br){return a(Y,br)}),Ze&&ci(Y,He),we}function Re(Y,z,X,ae){if(X==null)throw Error(s(151));for(var we=null,nt=null,Se=z,He=z=0,Ye=null,st=X.next();Se!==null&&!st.done;He++,st=X.next()){Se.index>He?(Ye=Se,Se=null):Ye=Se.sibling;var br=ee(Y,Se,st.value,ae);if(br===null){Se===null&&(Se=Ye);break}i&&Se&&br.alternate===null&&a(Y,Se),z=T(br,z,He),nt===null?we=br:nt.sibling=br,nt=br,Se=Ye}if(st.done)return l(Y,Se),Ze&&ci(Y,He),we;if(Se===null){for(;!st.done;He++,st=X.next())st=oe(Y,st.value,ae),st!==null&&(z=T(st,z,He),nt===null?we=st:nt.sibling=st,nt=st);return Ze&&ci(Y,He),we}for(Se=c(Se);!st.done;He++,st=X.next())st=ne(Se,Y,He,st.value,ae),st!==null&&(i&&st.alternate!==null&&Se.delete(st.key===null?He:st.key),z=T(st,z,He),nt===null?we=st:nt.sibling=st,nt=st);return i&&Se.forEach(function(Rw){return a(Y,Rw)}),Ze&&ci(Y,He),we}function mt(Y,z,X,ae){if(typeof X=="object"&&X!==null&&X.type===k&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case C:e:{for(var we=X.key;z!==null;){if(z.key===we){if(we=X.type,we===k){if(z.tag===7){l(Y,z.sibling),ae=v(z,X.props.children),ae.return=Y,Y=ae;break e}}else if(z.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===N&&da(we)===z.type){l(Y,z.sibling),ae=v(z,X.props),Ol(ae,X),ae.return=Y,Y=ae;break e}l(Y,z);break}else a(Y,z);z=z.sibling}X.type===k?(ae=aa(X.props.children,Y.mode,ae,X.key),ae.return=Y,Y=ae):(ae=Ec(X.type,X.key,X.props,null,Y.mode,ae),Ol(ae,X),ae.return=Y,Y=ae)}return S(Y);case M:e:{for(we=X.key;z!==null;){if(z.key===we)if(z.tag===4&&z.stateNode.containerInfo===X.containerInfo&&z.stateNode.implementation===X.implementation){l(Y,z.sibling),ae=v(z,X.children||[]),ae.return=Y,Y=ae;break e}else{l(Y,z);break}else a(Y,z);z=z.sibling}ae=th(X,Y.mode,ae),ae.return=Y,Y=ae}return S(Y);case N:return X=da(X),mt(Y,z,X,ae)}if(We(X))return be(Y,z,X,ae);if(j(X)){if(we=j(X),typeof we!="function")throw Error(s(150));return X=we.call(X),Re(Y,z,X,ae)}if(typeof X.then=="function")return mt(Y,z,Rc(X),ae);if(X.$$typeof===B)return mt(Y,z,Cc(Y,X),ae);Dc(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,z!==null&&z.tag===6?(l(Y,z.sibling),ae=v(z,X),ae.return=Y,Y=ae):(l(Y,z),ae=eh(X,Y.mode,ae),ae.return=Y,Y=ae),S(Y)):l(Y,z)}return function(Y,z,X,ae){try{Vl=0;var we=mt(Y,z,X,ae);return uo=null,we}catch(Se){if(Se===lo||Se===Ic)throw Se;var nt=On(29,Se,null,Y.mode);return nt.lanes=ae,nt.return=Y,nt}finally{}}}var ha=by(!0),xy=by(!1),ir=!1;function hh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mh(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function rr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ar(i,a,l){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var v=c.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),c.pending=a,a=xc(i),ry(i,null,l),a}return bc(i,c,a,l),xc(i)}function Ul(i,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=i.pendingLanes,l|=c,a.lanes=l,dl(i,l)}}function ph(i,a){var l=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var v=null,T=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};T===null?v=T=S:T=T.next=S,l=l.next}while(l!==null);T===null?v=T=a:T=T.next=a}else v=T=a;l={baseState:c.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:c.shared,callbacks:c.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=a:i.next=a,l.lastBaseUpdate=a}var gh=!1;function Fl(){if(gh){var i=oo;if(i!==null)throw i}}function Bl(i,a,l,c){gh=!1;var v=i.updateQueue;ir=!1;var T=v.firstBaseUpdate,S=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var F=I,W=F.next;F.next=null,S===null?T=W:S.next=W,S=F;var ie=i.alternate;ie!==null&&(ie=ie.updateQueue,I=ie.lastBaseUpdate,I!==S&&(I===null?ie.firstBaseUpdate=W:I.next=W,ie.lastBaseUpdate=F))}if(T!==null){var oe=v.baseState;S=0,ie=W=F=null,I=T;do{var ee=I.lane&-536870913,ne=ee!==I.lane;if(ne?(Ke&ee)===ee:(c&ee)===ee){ee!==0&&ee===ao&&(gh=!0),ie!==null&&(ie=ie.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var be=i,Re=I;ee=a;var mt=l;switch(Re.tag){case 1:if(be=Re.payload,typeof be=="function"){oe=be.call(mt,oe,ee);break e}oe=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Re.payload,ee=typeof be=="function"?be.call(mt,oe,ee):be,ee==null)break e;oe=b({},oe,ee);break e;case 2:ir=!0}}ee=I.callback,ee!==null&&(i.flags|=64,ne&&(i.flags|=8192),ne=v.callbacks,ne===null?v.callbacks=[ee]:ne.push(ee))}else ne={lane:ee,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ie===null?(W=ie=ne,F=oe):ie=ie.next=ne,S|=ee;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;ne=I,I=ne.next,ne.next=null,v.lastBaseUpdate=ne,v.shared.pending=null}}while(!0);ie===null&&(F=oe),v.baseState=F,v.firstBaseUpdate=W,v.lastBaseUpdate=ie,T===null&&(v.shared.lanes=0),dr|=S,i.lanes=S,i.memoizedState=oe}}function Ey(i,a){if(typeof i!="function")throw Error(s(191,i));i.call(a)}function Sy(i,a){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)Ey(l[i],a)}var co=q(null),Mc=q(0);function Ay(i,a){i=bi,me(Mc,i),me(co,a),bi=i|a.baseLanes}function yh(){me(Mc,bi),me(co,co.current)}function vh(){bi=Mc.current,re(co),re(Mc)}var Un=q(null),ns=null;function or(i){var a=i.alternate;me(Pt,Pt.current&1),me(Un,i),ns===null&&(a===null||co.current!==null||a.memoizedState!==null)&&(ns=i)}function _h(i){me(Pt,Pt.current),me(Un,i),ns===null&&(ns=i)}function Cy(i){i.tag===22?(me(Pt,Pt.current),me(Un,i),ns===null&&(ns=i)):lr()}function lr(){me(Pt,Pt.current),me(Un,Un.current)}function Fn(i){re(Un),ns===i&&(ns=null),re(Pt)}var Pt=q(0);function Pc(i){for(var a=i;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Am(l)||Cm(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var hi=0,qe=null,ft=null,jt=null,kc=!1,fo=!1,ma=!1,Lc=0,jl=0,ho=null,TC=0;function Nt(){throw Error(s(321))}function Th(i,a){if(a===null)return!1;for(var l=0;l<a.length&&l<i.length;l++)if(!Vn(i[l],a[l]))return!1;return!0}function bh(i,a,l,c,v,T){return hi=T,qe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Z.H=i===null||i.memoizedState===null?uv:Vh,ma=!1,T=l(c,v),ma=!1,fo&&(T=Iy(a,l,c,v)),wy(i),T}function wy(i){Z.H=zl;var a=ft!==null&&ft.next!==null;if(hi=0,jt=ft=qe=null,kc=!1,jl=0,ho=null,a)throw Error(s(300));i===null||qt||(i=i.dependencies,i!==null&&Ac(i)&&(qt=!0))}function Iy(i,a,l,c){qe=i;var v=0;do{if(fo&&(ho=null),jl=0,fo=!1,25<=v)throw Error(s(301));if(v+=1,jt=ft=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}Z.H=cv,T=a(l,c)}while(fo);return T}function bC(){var i=Z.H,a=i.useState()[0];return a=typeof a.then=="function"?ql(a):a,i=i.useState()[0],(ft!==null?ft.memoizedState:null)!==i&&(qe.flags|=1024),a}function xh(){var i=Lc!==0;return Lc=0,i}function Eh(i,a,l){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~l}function Sh(i){if(kc){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}kc=!1}hi=0,jt=ft=qe=null,fo=!1,jl=Lc=0,ho=null}function xn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?qe.memoizedState=jt=i:jt=jt.next=i,jt}function kt(){if(ft===null){var i=qe.alternate;i=i!==null?i.memoizedState:null}else i=ft.next;var a=jt===null?qe.memoizedState:jt.next;if(a!==null)jt=a,ft=i;else{if(i===null)throw qe.alternate===null?Error(s(467)):Error(s(310));ft=i,i={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},jt===null?qe.memoizedState=jt=i:jt=jt.next=i}return jt}function Vc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ql(i){var a=jl;return jl+=1,ho===null&&(ho=[]),i=vy(ho,i,a),a=qe,(jt===null?a.memoizedState:jt.next)===null&&(a=a.alternate,Z.H=a===null||a.memoizedState===null?uv:Vh),i}function Oc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ql(i);if(i.$$typeof===B)return ln(i)}throw Error(s(438,String(i)))}function Ah(i){var a=null,l=qe.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=qe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Vc(),qe.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(i),c=0;c<i;c++)l[c]=w;return a.index++,l}function mi(i,a){return typeof a=="function"?a(i):a}function Uc(i){var a=kt();return Ch(a,ft,i)}function Ch(i,a,l){var c=i.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=l;var v=i.baseQueue,T=c.pending;if(T!==null){if(v!==null){var S=v.next;v.next=T.next,T.next=S}a.baseQueue=v=T,c.pending=null}if(T=i.baseState,v===null)i.memoizedState=T;else{a=v.next;var I=S=null,F=null,W=a,ie=!1;do{var oe=W.lane&-536870913;if(oe!==W.lane?(Ke&oe)===oe:(hi&oe)===oe){var ee=W.revertLane;if(ee===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),oe===ao&&(ie=!0);else if((hi&ee)===ee){W=W.next,ee===ao&&(ie=!0);continue}else oe={lane:0,revertLane:W.revertLane,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(I=F=oe,S=T):F=F.next=oe,qe.lanes|=ee,dr|=ee;oe=W.action,ma&&l(T,oe),T=W.hasEagerState?W.eagerState:l(T,oe)}else ee={lane:oe,revertLane:W.revertLane,gesture:W.gesture,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},F===null?(I=F=ee,S=T):F=F.next=ee,qe.lanes|=oe,dr|=oe;W=W.next}while(W!==null&&W!==a);if(F===null?S=T:F.next=I,!Vn(T,i.memoizedState)&&(qt=!0,ie&&(l=oo,l!==null)))throw l;i.memoizedState=T,i.baseState=S,i.baseQueue=F,c.lastRenderedState=T}return v===null&&(c.lanes=0),[i.memoizedState,c.dispatch]}function wh(i){var a=kt(),l=a.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=i;var c=l.dispatch,v=l.pending,T=a.memoizedState;if(v!==null){l.pending=null;var S=v=v.next;do T=i(T,S.action),S=S.next;while(S!==v);Vn(T,a.memoizedState)||(qt=!0),a.memoizedState=T,a.baseQueue===null&&(a.baseState=T),l.lastRenderedState=T}return[T,c]}function Ny(i,a,l){var c=qe,v=kt(),T=Ze;if(T){if(l===void 0)throw Error(s(407));l=l()}else l=a();var S=!Vn((ft||v).memoizedState,l);if(S&&(v.memoizedState=l,qt=!0),v=v.queue,Rh(My.bind(null,c,v,i),[i]),v.getSnapshot!==a||S||jt!==null&&jt.memoizedState.tag&1){if(c.flags|=2048,mo(9,{destroy:void 0},Dy.bind(null,c,v,l,a),null),pt===null)throw Error(s(349));T||(hi&127)!==0||Ry(c,a,l)}return l}function Ry(i,a,l){i.flags|=16384,i={getSnapshot:a,value:l},a=qe.updateQueue,a===null?(a=Vc(),qe.updateQueue=a,a.stores=[i]):(l=a.stores,l===null?a.stores=[i]:l.push(i))}function Dy(i,a,l,c){a.value=l,a.getSnapshot=c,Py(a)&&ky(i)}function My(i,a,l){return l(function(){Py(a)&&ky(i)})}function Py(i){var a=i.getSnapshot;i=i.value;try{var l=a();return!Vn(i,l)}catch{return!0}}function ky(i){var a=ra(i,2);a!==null&&Dn(a,i,2)}function Ih(i){var a=xn();if(typeof i=="function"){var l=i;if(i=l(),ma){ue(!0);try{l()}finally{ue(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:i},a}function Ly(i,a,l,c){return i.baseState=l,Ch(i,ft,typeof c=="function"?c:mi)}function xC(i,a,l,c,v){if(jc(i))throw Error(s(485));if(i=a.action,i!==null){var T={payload:v,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){T.listeners.push(S)}};Z.T!==null?l(!0):T.isTransition=!1,c(T),l=a.pending,l===null?(T.next=a.pending=T,Vy(a,T)):(T.next=l.next,a.pending=l.next=T)}}function Vy(i,a){var l=a.action,c=a.payload,v=i.state;if(a.isTransition){var T=Z.T,S={};Z.T=S;try{var I=l(v,c),F=Z.S;F!==null&&F(S,I),Oy(i,a,I)}catch(W){Nh(i,a,W)}finally{T!==null&&S.types!==null&&(T.types=S.types),Z.T=T}}else try{T=l(v,c),Oy(i,a,T)}catch(W){Nh(i,a,W)}}function Oy(i,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Uy(i,a,c)},function(c){return Nh(i,a,c)}):Uy(i,a,l)}function Uy(i,a,l){a.status="fulfilled",a.value=l,Fy(a),i.state=l,a=i.pending,a!==null&&(l=a.next,l===a?i.pending=null:(l=l.next,a.next=l,Vy(i,l)))}function Nh(i,a,l){var c=i.pending;if(i.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,Fy(a),a=a.next;while(a!==c)}i.action=null}function Fy(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function By(i,a){return a}function jy(i,a){if(Ze){var l=pt.formState;if(l!==null){e:{var c=qe;if(Ze){if(_t){t:{for(var v=_t,T=ts;v.nodeType!==8;){if(!T){v=null;break t}if(v=ss(v.nextSibling),v===null){v=null;break t}}T=v.data,v=T==="F!"||T==="F"?v:null}if(v){_t=ss(v.nextSibling),c=v.data==="F!";break e}}nr(c)}c=!1}c&&(a=l[0])}}return l=xn(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:By,lastRenderedState:a},l.queue=c,l=av.bind(null,qe,c),c.dispatch=l,c=Ih(!1),T=Lh.bind(null,qe,!1,c.queue),c=xn(),v={state:a,dispatch:null,action:i,pending:null},c.queue=v,l=xC.bind(null,qe,v,T,l),v.dispatch=l,c.memoizedState=i,[a,l,!1]}function qy(i){var a=kt();return Hy(a,ft,i)}function Hy(i,a,l){if(a=Ch(i,a,By)[0],i=Uc(mi)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=ql(a)}catch(S){throw S===lo?Ic:S}else c=a;a=kt();var v=a.queue,T=v.dispatch;return l!==a.memoizedState&&(qe.flags|=2048,mo(9,{destroy:void 0},EC.bind(null,v,l),null)),[c,T,i]}function EC(i,a){i.action=a}function zy(i){var a=kt(),l=ft;if(l!==null)return Hy(a,l,i);kt(),a=a.memoizedState,l=kt();var c=l.queue.dispatch;return l.memoizedState=i,[a,c,!1]}function mo(i,a,l,c){return i={tag:i,create:l,deps:c,inst:a,next:null},a=qe.updateQueue,a===null&&(a=Vc(),qe.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=i.next=i:(c=l.next,l.next=i,i.next=c,a.lastEffect=i),i}function Gy(){return kt().memoizedState}function Fc(i,a,l,c){var v=xn();qe.flags|=i,v.memoizedState=mo(1|a,{destroy:void 0},l,c===void 0?null:c)}function Bc(i,a,l,c){var v=kt();c=c===void 0?null:c;var T=v.memoizedState.inst;ft!==null&&c!==null&&Th(c,ft.memoizedState.deps)?v.memoizedState=mo(a,T,l,c):(qe.flags|=i,v.memoizedState=mo(1|a,T,l,c))}function $y(i,a){Fc(8390656,8,i,a)}function Rh(i,a){Bc(2048,8,i,a)}function SC(i){qe.flags|=4;var a=qe.updateQueue;if(a===null)a=Vc(),qe.updateQueue=a,a.events=[i];else{var l=a.events;l===null?a.events=[i]:l.push(i)}}function Ky(i){var a=kt().memoizedState;return SC({ref:a,nextImpl:i}),function(){if((at&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}function Yy(i,a){return Bc(4,2,i,a)}function Jy(i,a){return Bc(4,4,i,a)}function Qy(i,a){if(typeof a=="function"){i=i();var l=a(i);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function Xy(i,a,l){l=l!=null?l.concat([i]):null,Bc(4,4,Qy.bind(null,a,i),l)}function Dh(){}function Wy(i,a){var l=kt();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&Th(a,c[1])?c[0]:(l.memoizedState=[i,a],i)}function Zy(i,a){var l=kt();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&Th(a,c[1]))return c[0];if(c=i(),ma){ue(!0);try{i()}finally{ue(!1)}}return l.memoizedState=[c,a],c}function Mh(i,a,l){return l===void 0||(hi&1073741824)!==0&&(Ke&261930)===0?i.memoizedState=a:(i.memoizedState=l,i=e0(),qe.lanes|=i,dr|=i,l)}function ev(i,a,l,c){return Vn(l,a)?l:co.current!==null?(i=Mh(i,l,c),Vn(i,a)||(qt=!0),i):(hi&42)===0||(hi&1073741824)!==0&&(Ke&261930)===0?(qt=!0,i.memoizedState=l):(i=e0(),qe.lanes|=i,dr|=i,a)}function tv(i,a,l,c,v){var T=Q.p;Q.p=T!==0&&8>T?T:8;var S=Z.T,I={};Z.T=I,Lh(i,!1,a,l);try{var F=v(),W=Z.S;if(W!==null&&W(I,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var ie=_C(F,c);Hl(i,a,ie,qn(i))}else Hl(i,a,c,qn(i))}catch(oe){Hl(i,a,{then:function(){},status:"rejected",reason:oe},qn())}finally{Q.p=T,S!==null&&I.types!==null&&(S.types=I.types),Z.T=S}}function AC(){}function Ph(i,a,l,c){if(i.tag!==5)throw Error(s(476));var v=nv(i).queue;tv(i,v,a,he,l===null?AC:function(){return sv(i),l(c)})}function nv(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:he},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:l},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function sv(i){var a=nv(i);a.next===null&&(a=i.alternate.memoizedState),Hl(i,a.next.queue,{},qn())}function kh(){return ln(au)}function iv(){return kt().memoizedState}function rv(){return kt().memoizedState}function CC(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var l=qn();i=rr(l);var c=ar(a,i,l);c!==null&&(Dn(c,a,l),Ul(c,a,l)),a={cache:uh()},i.payload=a;return}a=a.return}}function wC(i,a,l){var c=qn();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},jc(i)?ov(a,l):(l=Wf(i,a,l,c),l!==null&&(Dn(l,i,c),lv(l,a,c)))}function av(i,a,l){var c=qn();Hl(i,a,l,c)}function Hl(i,a,l,c){var v={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(jc(i))ov(a,v);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=a.lastRenderedReducer,T!==null))try{var S=a.lastRenderedState,I=T(S,l);if(v.hasEagerState=!0,v.eagerState=I,Vn(I,S))return bc(i,a,v,0),pt===null&&Tc(),!1}catch{}finally{}if(l=Wf(i,a,v,c),l!==null)return Dn(l,i,c),lv(l,a,c),!0}return!1}function Lh(i,a,l,c){if(c={lane:2,revertLane:hm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jc(i)){if(a)throw Error(s(479))}else a=Wf(i,l,c,2),a!==null&&Dn(a,i,2)}function jc(i){var a=i.alternate;return i===qe||a!==null&&a===qe}function ov(i,a){fo=kc=!0;var l=i.pending;l===null?a.next=a:(a.next=l.next,l.next=a),i.pending=a}function lv(i,a,l){if((l&4194048)!==0){var c=a.lanes;c&=i.pendingLanes,l|=c,a.lanes=l,dl(i,l)}}var zl={readContext:ln,use:Oc,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};zl.useEffectEvent=Nt;var uv={readContext:ln,use:Oc,useCallback:function(i,a){return xn().memoizedState=[i,a===void 0?null:a],i},useContext:ln,useEffect:$y,useImperativeHandle:function(i,a,l){l=l!=null?l.concat([i]):null,Fc(4194308,4,Qy.bind(null,a,i),l)},useLayoutEffect:function(i,a){return Fc(4194308,4,i,a)},useInsertionEffect:function(i,a){Fc(4,2,i,a)},useMemo:function(i,a){var l=xn();a=a===void 0?null:a;var c=i();if(ma){ue(!0);try{i()}finally{ue(!1)}}return l.memoizedState=[c,a],c},useReducer:function(i,a,l){var c=xn();if(l!==void 0){var v=l(a);if(ma){ue(!0);try{l(a)}finally{ue(!1)}}}else v=a;return c.memoizedState=c.baseState=v,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:v},c.queue=i,i=i.dispatch=wC.bind(null,qe,i),[c.memoizedState,i]},useRef:function(i){var a=xn();return i={current:i},a.memoizedState=i},useState:function(i){i=Ih(i);var a=i.queue,l=av.bind(null,qe,a);return a.dispatch=l,[i.memoizedState,l]},useDebugValue:Dh,useDeferredValue:function(i,a){var l=xn();return Mh(l,i,a)},useTransition:function(){var i=Ih(!1);return i=tv.bind(null,qe,i.queue,!0,!1),xn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,l){var c=qe,v=xn();if(Ze){if(l===void 0)throw Error(s(407));l=l()}else{if(l=a(),pt===null)throw Error(s(349));(Ke&127)!==0||Ry(c,a,l)}v.memoizedState=l;var T={value:l,getSnapshot:a};return v.queue=T,$y(My.bind(null,c,T,i),[i]),c.flags|=2048,mo(9,{destroy:void 0},Dy.bind(null,c,T,l,a),null),l},useId:function(){var i=xn(),a=pt.identifierPrefix;if(Ze){var l=qs,c=js;l=(c&~(1<<32-ce(c)-1)).toString(32)+l,a="_"+a+"R_"+l,l=Lc++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=TC++,a="_"+a+"r_"+l.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:kh,useFormState:jy,useActionState:jy,useOptimistic:function(i){var a=xn();a.memoizedState=a.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Lh.bind(null,qe,!0,l),l.dispatch=a,[i,a]},useMemoCache:Ah,useCacheRefresh:function(){return xn().memoizedState=CC.bind(null,qe)},useEffectEvent:function(i){var a=xn(),l={impl:i};return a.memoizedState=l,function(){if((at&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Vh={readContext:ln,use:Oc,useCallback:Wy,useContext:ln,useEffect:Rh,useImperativeHandle:Xy,useInsertionEffect:Yy,useLayoutEffect:Jy,useMemo:Zy,useReducer:Uc,useRef:Gy,useState:function(){return Uc(mi)},useDebugValue:Dh,useDeferredValue:function(i,a){var l=kt();return ev(l,ft.memoizedState,i,a)},useTransition:function(){var i=Uc(mi)[0],a=kt().memoizedState;return[typeof i=="boolean"?i:ql(i),a]},useSyncExternalStore:Ny,useId:iv,useHostTransitionStatus:kh,useFormState:qy,useActionState:qy,useOptimistic:function(i,a){var l=kt();return Ly(l,ft,i,a)},useMemoCache:Ah,useCacheRefresh:rv};Vh.useEffectEvent=Ky;var cv={readContext:ln,use:Oc,useCallback:Wy,useContext:ln,useEffect:Rh,useImperativeHandle:Xy,useInsertionEffect:Yy,useLayoutEffect:Jy,useMemo:Zy,useReducer:wh,useRef:Gy,useState:function(){return wh(mi)},useDebugValue:Dh,useDeferredValue:function(i,a){var l=kt();return ft===null?Mh(l,i,a):ev(l,ft.memoizedState,i,a)},useTransition:function(){var i=wh(mi)[0],a=kt().memoizedState;return[typeof i=="boolean"?i:ql(i),a]},useSyncExternalStore:Ny,useId:iv,useHostTransitionStatus:kh,useFormState:zy,useActionState:zy,useOptimistic:function(i,a){var l=kt();return ft!==null?Ly(l,ft,i,a):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Ah,useCacheRefresh:rv};cv.useEffectEvent=Ky;function Oh(i,a,l,c){a=i.memoizedState,l=l(c,a),l=l==null?a:b({},a,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Uh={enqueueSetState:function(i,a,l){i=i._reactInternals;var c=qn(),v=rr(c);v.payload=a,l!=null&&(v.callback=l),a=ar(i,v,c),a!==null&&(Dn(a,i,c),Ul(a,i,c))},enqueueReplaceState:function(i,a,l){i=i._reactInternals;var c=qn(),v=rr(c);v.tag=1,v.payload=a,l!=null&&(v.callback=l),a=ar(i,v,c),a!==null&&(Dn(a,i,c),Ul(a,i,c))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var l=qn(),c=rr(l);c.tag=2,a!=null&&(c.callback=a),a=ar(i,c,l),a!==null&&(Dn(a,i,l),Ul(a,i,l))}};function dv(i,a,l,c,v,T,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,T,S):a.prototype&&a.prototype.isPureReactComponent?!Rl(l,c)||!Rl(v,T):!0}function fv(i,a,l,c){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==i&&Uh.enqueueReplaceState(a,a.state,null)}function pa(i,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(i=i.defaultProps){l===a&&(l=b({},l));for(var v in i)l[v]===void 0&&(l[v]=i[v])}return l}function hv(i){_c(i)}function mv(i){console.error(i)}function pv(i){_c(i)}function qc(i,a){try{var l=i.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function gv(i,a,l){try{var c=i.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Fh(i,a,l){return l=rr(l),l.tag=3,l.payload={element:null},l.callback=function(){qc(i,a)},l}function yv(i){return i=rr(i),i.tag=3,i}function vv(i,a,l,c){var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var T=c.value;i.payload=function(){return v(T)},i.callback=function(){gv(a,l,c)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){gv(a,l,c),typeof v!="function"&&(fr===null?fr=new Set([this]):fr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function IC(i,a,l,c,v){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&ro(a,l,v,!0),l=Un.current,l!==null){switch(l.tag){case 31:case 13:return ns===null?ed():l.alternate===null&&Rt===0&&(Rt=3),l.flags&=-257,l.flags|=65536,l.lanes=v,c===Nc?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),cm(i,c,v)),!1;case 22:return l.flags|=65536,c===Nc?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),cm(i,c,v)),!1}throw Error(s(435,l.tag))}return cm(i,c,v),ed(),!1}if(Ze)return a=Un.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,c!==ih&&(i=Error(s(422),{cause:c}),Pl(Wn(i,l)))):(c!==ih&&(a=Error(s(423),{cause:c}),Pl(Wn(a,l))),i=i.current.alternate,i.flags|=65536,v&=-v,i.lanes|=v,c=Wn(c,l),v=Fh(i.stateNode,c,v),ph(i,v),Rt!==4&&(Rt=2)),!1;var T=Error(s(520),{cause:c});if(T=Wn(T,l),Wl===null?Wl=[T]:Wl.push(T),Rt!==4&&(Rt=2),a===null)return!0;c=Wn(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,i=v&-v,l.lanes|=i,i=Fh(l.stateNode,c,i),ph(l,i),!1;case 1:if(a=l.type,T=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(fr===null||!fr.has(T))))return l.flags|=65536,v&=-v,l.lanes|=v,v=yv(v),vv(v,i,l,c),ph(l,v),!1}l=l.return}while(l!==null);return!1}var Bh=Error(s(461)),qt=!1;function un(i,a,l,c){a.child=i===null?xy(a,null,l,c):ha(a,i.child,l,c)}function _v(i,a,l,c,v){l=l.render;var T=a.ref;if("ref"in c){var S={};for(var I in c)I!=="ref"&&(S[I]=c[I])}else S=c;return ua(a),c=bh(i,a,l,S,T,v),I=xh(),i!==null&&!qt?(Eh(i,a,v),pi(i,a,v)):(Ze&&I&&nh(a),a.flags|=1,un(i,a,c,v),a.child)}function Tv(i,a,l,c,v){if(i===null){var T=l.type;return typeof T=="function"&&!Zf(T)&&T.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=T,bv(i,a,T,c,v)):(i=Ec(l.type,null,c,a,a.mode,v),i.ref=a.ref,i.return=a,a.child=i)}if(T=i.child,!Yh(i,v)){var S=T.memoizedProps;if(l=l.compare,l=l!==null?l:Rl,l(S,c)&&i.ref===a.ref)return pi(i,a,v)}return a.flags|=1,i=ui(T,c),i.ref=a.ref,i.return=a,a.child=i}function bv(i,a,l,c,v){if(i!==null){var T=i.memoizedProps;if(Rl(T,c)&&i.ref===a.ref)if(qt=!1,a.pendingProps=c=T,Yh(i,v))(i.flags&131072)!==0&&(qt=!0);else return a.lanes=i.lanes,pi(i,a,v)}return jh(i,a,l,c,v)}function xv(i,a,l,c){var v=c.children,T=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(T=T!==null?T.baseLanes|l:l,i!==null){for(c=a.child=i.child,v=0;c!==null;)v=v|c.lanes|c.childLanes,c=c.sibling;c=v&~T}else c=0,a.child=null;return Ev(i,a,T,l,c)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&wc(a,T!==null?T.cachePool:null),T!==null?Ay(a,T):yh(),Cy(a);else return c=a.lanes=536870912,Ev(i,a,T!==null?T.baseLanes|l:l,l,c)}else T!==null?(wc(a,T.cachePool),Ay(a,T),lr(),a.memoizedState=null):(i!==null&&wc(a,null),yh(),lr());return un(i,a,v,l),a.child}function Gl(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ev(i,a,l,c,v){var T=dh();return T=T===null?null:{parent:Bt._currentValue,pool:T},a.memoizedState={baseLanes:l,cachePool:T},i!==null&&wc(a,null),yh(),Cy(a),i!==null&&ro(i,a,c,!0),a.childLanes=v,null}function Hc(i,a){return a=Gc({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Sv(i,a,l){return ha(a,i.child,null,l),i=Hc(a,a.pendingProps),i.flags|=2,Fn(a),a.memoizedState=null,i}function NC(i,a,l){var c=a.pendingProps,v=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Ze){if(c.mode==="hidden")return i=Hc(a,c),a.lanes=536870912,Gl(null,i);if(_h(a),(i=_t)?(i=V0(i,ts),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:er!==null?{id:js,overflow:qs}:null,retryLane:536870912,hydrationErrors:null},l=oy(i),l.return=a,a.child=l,on=a,_t=null)):i=null,i===null)throw nr(a);return a.lanes=536870912,null}return Hc(a,c)}var T=i.memoizedState;if(T!==null){var S=T.dehydrated;if(_h(a),v)if(a.flags&256)a.flags&=-257,a=Sv(i,a,l);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(s(558));else if(qt||ro(i,a,l,!1),v=(l&i.childLanes)!==0,qt||v){if(c=pt,c!==null&&(S=fl(c,l),S!==0&&S!==T.retryLane))throw T.retryLane=S,ra(i,S),Dn(c,i,S),Bh;ed(),a=Sv(i,a,l)}else i=T.treeContext,_t=ss(S.nextSibling),on=a,Ze=!0,tr=null,ts=!1,i!==null&&cy(a,i),a=Hc(a,c),a.flags|=4096;return a}return i=ui(i.child,{mode:c.mode,children:c.children}),i.ref=a.ref,a.child=i,i.return=a,i}function zc(i,a){var l=a.ref;if(l===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(i===null||i.ref!==l)&&(a.flags|=4194816)}}function jh(i,a,l,c,v){return ua(a),l=bh(i,a,l,c,void 0,v),c=xh(),i!==null&&!qt?(Eh(i,a,v),pi(i,a,v)):(Ze&&c&&nh(a),a.flags|=1,un(i,a,l,v),a.child)}function Av(i,a,l,c,v,T){return ua(a),a.updateQueue=null,l=Iy(a,c,l,v),wy(i),c=xh(),i!==null&&!qt?(Eh(i,a,T),pi(i,a,T)):(Ze&&c&&nh(a),a.flags|=1,un(i,a,l,T),a.child)}function Cv(i,a,l,c,v){if(ua(a),a.stateNode===null){var T=to,S=l.contextType;typeof S=="object"&&S!==null&&(T=ln(S)),T=new l(c,T),a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Uh,a.stateNode=T,T._reactInternals=a,T=a.stateNode,T.props=c,T.state=a.memoizedState,T.refs={},hh(a),S=l.contextType,T.context=typeof S=="object"&&S!==null?ln(S):to,T.state=a.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(Oh(a,l,S,c),T.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(S=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),S!==T.state&&Uh.enqueueReplaceState(T,T.state,null),Bl(a,c,T,v),Fl(),T.state=a.memoizedState),typeof T.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(i===null){T=a.stateNode;var I=a.memoizedProps,F=pa(l,I);T.props=F;var W=T.context,ie=l.contextType;S=to,typeof ie=="object"&&ie!==null&&(S=ln(ie));var oe=l.getDerivedStateFromProps;ie=typeof oe=="function"||typeof T.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,ie||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(I||W!==S)&&fv(a,T,c,S),ir=!1;var ee=a.memoizedState;T.state=ee,Bl(a,c,T,v),Fl(),W=a.memoizedState,I||ee!==W||ir?(typeof oe=="function"&&(Oh(a,l,oe,c),W=a.memoizedState),(F=ir||dv(a,l,F,c,ee,W,S))?(ie||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(a.flags|=4194308)):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=W),T.props=c,T.state=W,T.context=S,c=F):(typeof T.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{T=a.stateNode,mh(i,a),S=a.memoizedProps,ie=pa(l,S),T.props=ie,oe=a.pendingProps,ee=T.context,W=l.contextType,F=to,typeof W=="object"&&W!==null&&(F=ln(W)),I=l.getDerivedStateFromProps,(W=typeof I=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(S!==oe||ee!==F)&&fv(a,T,c,F),ir=!1,ee=a.memoizedState,T.state=ee,Bl(a,c,T,v),Fl();var ne=a.memoizedState;S!==oe||ee!==ne||ir||i!==null&&i.dependencies!==null&&Ac(i.dependencies)?(typeof I=="function"&&(Oh(a,l,I,c),ne=a.memoizedState),(ie=ir||dv(a,l,ie,c,ee,ne,F)||i!==null&&i.dependencies!==null&&Ac(i.dependencies))?(W||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(c,ne,F),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(c,ne,F)),typeof T.componentDidUpdate=="function"&&(a.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof T.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ne),T.props=c,T.state=ne,T.context=F,c=ie):(typeof T.componentDidUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(a.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ee===i.memoizedState||(a.flags|=1024),c=!1)}return T=c,zc(i,a),c=(a.flags&128)!==0,T||c?(T=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:T.render(),a.flags|=1,i!==null&&c?(a.child=ha(a,i.child,null,v),a.child=ha(a,null,l,v)):un(i,a,l,v),a.memoizedState=T.state,i=a.child):i=pi(i,a,v),i}function wv(i,a,l,c){return oa(),a.flags|=256,un(i,a,l,c),a.child}var qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hh(i){return{baseLanes:i,cachePool:gy()}}function zh(i,a,l){return i=i!==null?i.childLanes&~l:0,a&&(i|=jn),i}function Iv(i,a,l){var c=a.pendingProps,v=!1,T=(a.flags&128)!==0,S;if((S=T)||(S=i!==null&&i.memoizedState===null?!1:(Pt.current&2)!==0),S&&(v=!0,a.flags&=-129),S=(a.flags&32)!==0,a.flags&=-33,i===null){if(Ze){if(v?or(a):lr(),(i=_t)?(i=V0(i,ts),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:er!==null?{id:js,overflow:qs}:null,retryLane:536870912,hydrationErrors:null},l=oy(i),l.return=a,a.child=l,on=a,_t=null)):i=null,i===null)throw nr(a);return Cm(i)?a.lanes=32:a.lanes=536870912,null}var I=c.children;return c=c.fallback,v?(lr(),v=a.mode,I=Gc({mode:"hidden",children:I},v),c=aa(c,v,l,null),I.return=a,c.return=a,I.sibling=c,a.child=I,c=a.child,c.memoizedState=Hh(l),c.childLanes=zh(i,S,l),a.memoizedState=qh,Gl(null,c)):(or(a),Gh(a,I))}var F=i.memoizedState;if(F!==null&&(I=F.dehydrated,I!==null)){if(T)a.flags&256?(or(a),a.flags&=-257,a=$h(i,a,l)):a.memoizedState!==null?(lr(),a.child=i.child,a.flags|=128,a=null):(lr(),I=c.fallback,v=a.mode,c=Gc({mode:"visible",children:c.children},v),I=aa(I,v,l,null),I.flags|=2,c.return=a,I.return=a,c.sibling=I,a.child=c,ha(a,i.child,null,l),c=a.child,c.memoizedState=Hh(l),c.childLanes=zh(i,S,l),a.memoizedState=qh,a=Gl(null,c));else if(or(a),Cm(I)){if(S=I.nextSibling&&I.nextSibling.dataset,S)var W=S.dgst;S=W,c=Error(s(419)),c.stack="",c.digest=S,Pl({value:c,source:null,stack:null}),a=$h(i,a,l)}else if(qt||ro(i,a,l,!1),S=(l&i.childLanes)!==0,qt||S){if(S=pt,S!==null&&(c=fl(S,l),c!==0&&c!==F.retryLane))throw F.retryLane=c,ra(i,c),Dn(S,i,c),Bh;Am(I)||ed(),a=$h(i,a,l)}else Am(I)?(a.flags|=192,a.child=i.child,a=null):(i=F.treeContext,_t=ss(I.nextSibling),on=a,Ze=!0,tr=null,ts=!1,i!==null&&cy(a,i),a=Gh(a,c.children),a.flags|=4096);return a}return v?(lr(),I=c.fallback,v=a.mode,F=i.child,W=F.sibling,c=ui(F,{mode:"hidden",children:c.children}),c.subtreeFlags=F.subtreeFlags&65011712,W!==null?I=ui(W,I):(I=aa(I,v,l,null),I.flags|=2),I.return=a,c.return=a,c.sibling=I,a.child=c,Gl(null,c),c=a.child,I=i.child.memoizedState,I===null?I=Hh(l):(v=I.cachePool,v!==null?(F=Bt._currentValue,v=v.parent!==F?{parent:F,pool:F}:v):v=gy(),I={baseLanes:I.baseLanes|l,cachePool:v}),c.memoizedState=I,c.childLanes=zh(i,S,l),a.memoizedState=qh,Gl(i.child,c)):(or(a),l=i.child,i=l.sibling,l=ui(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,i!==null&&(S=a.deletions,S===null?(a.deletions=[i],a.flags|=16):S.push(i)),a.child=l,a.memoizedState=null,l)}function Gh(i,a){return a=Gc({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Gc(i,a){return i=On(22,i,null,a),i.lanes=0,i}function $h(i,a,l){return ha(a,i.child,null,l),i=Gh(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Nv(i,a,l){i.lanes|=a;var c=i.alternate;c!==null&&(c.lanes|=a),oh(i.return,a,l)}function Kh(i,a,l,c,v,T){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:v,treeForkCount:T}:(S.isBackwards=a,S.rendering=null,S.renderingStartTime=0,S.last=c,S.tail=l,S.tailMode=v,S.treeForkCount=T)}function Rv(i,a,l){var c=a.pendingProps,v=c.revealOrder,T=c.tail;c=c.children;var S=Pt.current,I=(S&2)!==0;if(I?(S=S&1|2,a.flags|=128):S&=1,me(Pt,S),un(i,a,c,l),c=Ze?Ml:0,!I&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Nv(i,l,a);else if(i.tag===19)Nv(i,l,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(v){case"forwards":for(l=a.child,v=null;l!==null;)i=l.alternate,i!==null&&Pc(i)===null&&(v=l),l=l.sibling;l=v,l===null?(v=a.child,a.child=null):(v=l.sibling,l.sibling=null),Kh(a,!1,v,l,T,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,v=a.child,a.child=null;v!==null;){if(i=v.alternate,i!==null&&Pc(i)===null){a.child=v;break}i=v.sibling,v.sibling=l,l=v,v=i}Kh(a,!0,l,null,T,c);break;case"together":Kh(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function pi(i,a,l){if(i!==null&&(a.dependencies=i.dependencies),dr|=a.lanes,(l&a.childLanes)===0)if(i!==null){if(ro(i,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(s(153));if(a.child!==null){for(i=a.child,l=ui(i,i.pendingProps),a.child=l,l.return=a;i.sibling!==null;)i=i.sibling,l=l.sibling=ui(i,i.pendingProps),l.return=a;l.sibling=null}return a.child}function Yh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&Ac(i)))}function RC(i,a,l){switch(a.tag){case 3:vt(a,a.stateNode.containerInfo),sr(a,Bt,i.memoizedState.cache),oa();break;case 27:case 5:ei(a);break;case 4:vt(a,a.stateNode.containerInfo);break;case 10:sr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,_h(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(or(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Iv(i,a,l):(or(a),i=pi(i,a,l),i!==null?i.sibling:null);or(a);break;case 19:var v=(i.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(ro(i,a,l,!1),c=(l&a.childLanes)!==0),v){if(c)return Rv(i,a,l);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),me(Pt,Pt.current),c)break;return null;case 22:return a.lanes=0,xv(i,a,l,a.pendingProps);case 24:sr(a,Bt,i.memoizedState.cache)}return pi(i,a,l)}function Dv(i,a,l){if(i!==null)if(i.memoizedProps!==a.pendingProps)qt=!0;else{if(!Yh(i,l)&&(a.flags&128)===0)return qt=!1,RC(i,a,l);qt=(i.flags&131072)!==0}else qt=!1,Ze&&(a.flags&1048576)!==0&&uy(a,Ml,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(i=da(a.elementType),a.type=i,typeof i=="function")Zf(i)?(c=pa(i,c),a.tag=1,a=Cv(null,a,i,c,l)):(a.tag=0,a=jh(null,a,i,c,l));else{if(i!=null){var v=i.$$typeof;if(v===K){a.tag=11,a=_v(null,a,i,c,l);break e}else if(v===R){a.tag=14,a=Tv(null,a,i,c,l);break e}}throw a=Pe(i)||i,Error(s(306,a,""))}}return a;case 0:return jh(i,a,a.type,a.pendingProps,l);case 1:return c=a.type,v=pa(c,a.pendingProps),Cv(i,a,c,v,l);case 3:e:{if(vt(a,a.stateNode.containerInfo),i===null)throw Error(s(387));c=a.pendingProps;var T=a.memoizedState;v=T.element,mh(i,a),Bl(a,c,null,l);var S=a.memoizedState;if(c=S.cache,sr(a,Bt,c),c!==T.cache&&lh(a,[Bt],l,!0),Fl(),c=S.element,T.isDehydrated)if(T={element:c,isDehydrated:!1,cache:S.cache},a.updateQueue.baseState=T,a.memoizedState=T,a.flags&256){a=wv(i,a,c,l);break e}else if(c!==v){v=Wn(Error(s(424)),a),Pl(v),a=wv(i,a,c,l);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(_t=ss(i.firstChild),on=a,Ze=!0,tr=null,ts=!0,l=xy(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(oa(),c===v){a=pi(i,a,l);break e}un(i,a,c,l)}a=a.child}return a;case 26:return zc(i,a),i===null?(l=q0(a.type,null,a.pendingProps,null))?a.memoizedState=l:Ze||(l=a.type,i=a.pendingProps,c=od(Fe.current).createElement(l),c[Ot]=a,c[Wt]=i,cn(c,l,i),Ut(c),a.stateNode=c):a.memoizedState=q0(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return ei(a),i===null&&Ze&&(c=a.stateNode=F0(a.type,a.pendingProps,Fe.current),on=a,ts=!0,v=_t,gr(a.type)?(wm=v,_t=ss(c.firstChild)):_t=v),un(i,a,a.pendingProps.children,l),zc(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Ze&&((v=c=_t)&&(c=aw(c,a.type,a.pendingProps,ts),c!==null?(a.stateNode=c,on=a,_t=ss(c.firstChild),ts=!1,v=!0):v=!1),v||nr(a)),ei(a),v=a.type,T=a.pendingProps,S=i!==null?i.memoizedProps:null,c=T.children,xm(v,T)?c=null:S!==null&&xm(v,S)&&(a.flags|=32),a.memoizedState!==null&&(v=bh(i,a,bC,null,null,l),au._currentValue=v),zc(i,a),un(i,a,c,l),a.child;case 6:return i===null&&Ze&&((i=l=_t)&&(l=ow(l,a.pendingProps,ts),l!==null?(a.stateNode=l,on=a,_t=null,i=!0):i=!1),i||nr(a)),null;case 13:return Iv(i,a,l);case 4:return vt(a,a.stateNode.containerInfo),c=a.pendingProps,i===null?a.child=ha(a,null,c,l):un(i,a,c,l),a.child;case 11:return _v(i,a,a.type,a.pendingProps,l);case 7:return un(i,a,a.pendingProps,l),a.child;case 8:return un(i,a,a.pendingProps.children,l),a.child;case 12:return un(i,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,sr(a,a.type,c.value),un(i,a,c.children,l),a.child;case 9:return v=a.type._context,c=a.pendingProps.children,ua(a),v=ln(v),c=c(v),a.flags|=1,un(i,a,c,l),a.child;case 14:return Tv(i,a,a.type,a.pendingProps,l);case 15:return bv(i,a,a.type,a.pendingProps,l);case 19:return Rv(i,a,l);case 31:return NC(i,a,l);case 22:return xv(i,a,l,a.pendingProps);case 24:return ua(a),c=ln(Bt),i===null?(v=dh(),v===null&&(v=pt,T=uh(),v.pooledCache=T,T.refCount++,T!==null&&(v.pooledCacheLanes|=l),v=T),a.memoizedState={parent:c,cache:v},hh(a),sr(a,Bt,v)):((i.lanes&l)!==0&&(mh(i,a),Bl(a,null,null,l),Fl()),v=i.memoizedState,T=a.memoizedState,v.parent!==c?(v={parent:c,cache:c},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),sr(a,Bt,c)):(c=T.cache,sr(a,Bt,c),c!==v.cache&&lh(a,[Bt],l,!0))),un(i,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function gi(i){i.flags|=4}function Jh(i,a,l,c,v){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(v&335544128)===v)if(i.stateNode.complete)i.flags|=8192;else if(i0())i.flags|=8192;else throw fa=Nc,fh}else i.flags&=-16777217}function Mv(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!K0(a))if(i0())i.flags|=8192;else throw fa=Nc,fh}function $c(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?It():536870912,i.lanes|=a,vo|=a)}function $l(i,a){if(!Ze)switch(i.tailMode){case"hidden":a=i.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function Tt(i){var a=i.alternate!==null&&i.alternate.child===i.child,l=0,c=0;if(a)for(var v=i.child;v!==null;)l|=v.lanes|v.childLanes,c|=v.subtreeFlags&65011712,c|=v.flags&65011712,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)l|=v.lanes|v.childLanes,c|=v.subtreeFlags,c|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=c,i.childLanes=l,a}function DC(i,a,l){var c=a.pendingProps;switch(sh(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(a),null;case 1:return Tt(a),null;case 3:return l=a.stateNode,c=null,i!==null&&(c=i.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),fi(Bt),gt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(io(a)?gi(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,rh())),Tt(a),null;case 26:var v=a.type,T=a.memoizedState;return i===null?(gi(a),T!==null?(Tt(a),Mv(a,T)):(Tt(a),Jh(a,v,null,c,l))):T?T!==i.memoizedState?(gi(a),Tt(a),Mv(a,T)):(Tt(a),a.flags&=-16777217):(i=i.memoizedProps,i!==c&&gi(a),Tt(a),Jh(a,v,i,c,l)),null;case 27:if(qi(a),l=Fe.current,v=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==c&&gi(a);else{if(!c){if(a.stateNode===null)throw Error(s(166));return Tt(a),null}i=ye.current,io(a)?dy(a):(i=F0(v,c,l),a.stateNode=i,gi(a))}return Tt(a),null;case 5:if(qi(a),v=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==c&&gi(a);else{if(!c){if(a.stateNode===null)throw Error(s(166));return Tt(a),null}if(T=ye.current,io(a))dy(a);else{var S=od(Fe.current);switch(T){case 1:T=S.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:T=S.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":T=S.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":T=S.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":T=S.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof c.is=="string"?S.createElement("select",{is:c.is}):S.createElement("select"),c.multiple?T.multiple=!0:c.size&&(T.size=c.size);break;default:T=typeof c.is=="string"?S.createElement(v,{is:c.is}):S.createElement(v)}}T[Ot]=a,T[Wt]=c;e:for(S=a.child;S!==null;){if(S.tag===5||S.tag===6)T.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===a)break e;for(;S.sibling===null;){if(S.return===null||S.return===a)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}a.stateNode=T;e:switch(cn(T,v,c),v){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&gi(a)}}return Tt(a),Jh(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,l),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==c&&gi(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(s(166));if(i=Fe.current,io(a)){if(i=a.stateNode,l=a.memoizedProps,c=null,v=on,v!==null)switch(v.tag){case 27:case 5:c=v.memoizedProps}i[Ot]=a,i=!!(i.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||I0(i.nodeValue,l)),i||nr(a,!0)}else i=od(i).createTextNode(c),i[Ot]=a,a.stateNode=i}return Tt(a),null;case 31:if(l=a.memoizedState,i===null||i.memoizedState!==null){if(c=io(a),l!==null){if(i===null){if(!c)throw Error(s(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[Ot]=a}else oa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Tt(a),i=!1}else l=rh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return a.flags&256?(Fn(a),a):(Fn(a),null);if((a.flags&128)!==0)throw Error(s(558))}return Tt(a),null;case 13:if(c=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(v=io(a),c!==null&&c.dehydrated!==null){if(i===null){if(!v)throw Error(s(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(s(317));v[Ot]=a}else oa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Tt(a),v=!1}else v=rh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(Fn(a),a):(Fn(a),null)}return Fn(a),(a.flags&128)!==0?(a.lanes=l,a):(l=c!==null,i=i!==null&&i.memoizedState!==null,l&&(c=a.child,v=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(v=c.alternate.memoizedState.cachePool.pool),T=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(T=c.memoizedState.cachePool.pool),T!==v&&(c.flags|=2048)),l!==i&&l&&(a.child.flags|=8192),$c(a,a.updateQueue),Tt(a),null);case 4:return gt(),i===null&&ym(a.stateNode.containerInfo),Tt(a),null;case 10:return fi(a.type),Tt(a),null;case 19:if(re(Pt),c=a.memoizedState,c===null)return Tt(a),null;if(v=(a.flags&128)!==0,T=c.rendering,T===null)if(v)$l(c,!1);else{if(Rt!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(T=Pc(i),T!==null){for(a.flags|=128,$l(c,!1),i=T.updateQueue,a.updateQueue=i,$c(a,i),a.subtreeFlags=0,i=l,l=a.child;l!==null;)ay(l,i),l=l.sibling;return me(Pt,Pt.current&1|2),Ze&&ci(a,c.treeForkCount),a.child}i=i.sibling}c.tail!==null&&rn()>Xc&&(a.flags|=128,v=!0,$l(c,!1),a.lanes=4194304)}else{if(!v)if(i=Pc(T),i!==null){if(a.flags|=128,v=!0,i=i.updateQueue,a.updateQueue=i,$c(a,i),$l(c,!0),c.tail===null&&c.tailMode==="hidden"&&!T.alternate&&!Ze)return Tt(a),null}else 2*rn()-c.renderingStartTime>Xc&&l!==536870912&&(a.flags|=128,v=!0,$l(c,!1),a.lanes=4194304);c.isBackwards?(T.sibling=a.child,a.child=T):(i=c.last,i!==null?i.sibling=T:a.child=T,c.last=T)}return c.tail!==null?(i=c.tail,c.rendering=i,c.tail=i.sibling,c.renderingStartTime=rn(),i.sibling=null,l=Pt.current,me(Pt,v?l&1|2:l&1),Ze&&ci(a,c.treeForkCount),i):(Tt(a),null);case 22:case 23:return Fn(a),vh(),c=a.memoizedState!==null,i!==null?i.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Tt(a),a.subtreeFlags&6&&(a.flags|=8192)):Tt(a),l=a.updateQueue,l!==null&&$c(a,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),i!==null&&re(ca),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),fi(Bt),Tt(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function MC(i,a){switch(sh(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return fi(Bt),gt(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return qi(a),null;case 31:if(a.memoizedState!==null){if(Fn(a),a.alternate===null)throw Error(s(340));oa()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(Fn(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(s(340));oa()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return re(Pt),null;case 4:return gt(),null;case 10:return fi(a.type),null;case 22:case 23:return Fn(a),vh(),i!==null&&re(ca),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return fi(Bt),null;case 25:return null;default:return null}}function Pv(i,a){switch(sh(a),a.tag){case 3:fi(Bt),gt();break;case 26:case 27:case 5:qi(a);break;case 4:gt();break;case 31:a.memoizedState!==null&&Fn(a);break;case 13:Fn(a);break;case 19:re(Pt);break;case 10:fi(a.type);break;case 22:case 23:Fn(a),vh(),i!==null&&re(ca);break;case 24:fi(Bt)}}function Kl(i,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var v=c.next;l=v;do{if((l.tag&i)===i){c=void 0;var T=l.create,S=l.inst;c=T(),S.destroy=c}l=l.next}while(l!==v)}}catch(I){ct(a,a.return,I)}}function ur(i,a,l){try{var c=a.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var T=v.next;c=T;do{if((c.tag&i)===i){var S=c.inst,I=S.destroy;if(I!==void 0){S.destroy=void 0,v=a;var F=l,W=I;try{W()}catch(ie){ct(v,F,ie)}}}c=c.next}while(c!==T)}}catch(ie){ct(a,a.return,ie)}}function kv(i){var a=i.updateQueue;if(a!==null){var l=i.stateNode;try{Sy(a,l)}catch(c){ct(i,i.return,c)}}}function Lv(i,a,l){l.props=pa(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(c){ct(i,a,c)}}function Yl(i,a){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var c=i.stateNode;break;case 30:c=i.stateNode;break;default:c=i.stateNode}typeof l=="function"?i.refCleanup=l(c):l.current=c}}catch(v){ct(i,a,v)}}function Hs(i,a){var l=i.ref,c=i.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(v){ct(i,a,v)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(v){ct(i,a,v)}else l.current=null}function Vv(i){var a=i.type,l=i.memoizedProps,c=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(v){ct(i,i.return,v)}}function Qh(i,a,l){try{var c=i.stateNode;ew(c,i.type,l,a),c[Wt]=a}catch(v){ct(i,i.return,v)}}function Ov(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&gr(i.type)||i.tag===4}function Xh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ov(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&gr(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Wh(i,a,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(i),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=ds));else if(c!==4&&(c===27&&gr(i.type)&&(l=i.stateNode,a=null),i=i.child,i!==null))for(Wh(i,a,l),i=i.sibling;i!==null;)Wh(i,a,l),i=i.sibling}function Kc(i,a,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,a?l.insertBefore(i,a):l.appendChild(i);else if(c!==4&&(c===27&&gr(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Kc(i,a,l),i=i.sibling;i!==null;)Kc(i,a,l),i=i.sibling}function Uv(i){var a=i.stateNode,l=i.memoizedProps;try{for(var c=i.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);cn(a,c,l),a[Ot]=i,a[Wt]=l}catch(T){ct(i,i.return,T)}}var yi=!1,Ht=!1,Zh=!1,Fv=typeof WeakSet=="function"?WeakSet:Set,en=null;function PC(i,a){if(i=i.containerInfo,Tm=md,i=Xg(i),$f(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var v=c.anchorOffset,T=c.focusNode;c=c.focusOffset;try{l.nodeType,T.nodeType}catch{l=null;break e}var S=0,I=-1,F=-1,W=0,ie=0,oe=i,ee=null;t:for(;;){for(var ne;oe!==l||v!==0&&oe.nodeType!==3||(I=S+v),oe!==T||c!==0&&oe.nodeType!==3||(F=S+c),oe.nodeType===3&&(S+=oe.nodeValue.length),(ne=oe.firstChild)!==null;)ee=oe,oe=ne;for(;;){if(oe===i)break t;if(ee===l&&++W===v&&(I=S),ee===T&&++ie===c&&(F=S),(ne=oe.nextSibling)!==null)break;oe=ee,ee=oe.parentNode}oe=ne}l=I===-1||F===-1?null:{start:I,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(bm={focusedElem:i,selectionRange:l},md=!1,en=a;en!==null;)if(a=en,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,en=i;else for(;en!==null;){switch(a=en,T=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)v=i[l],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,l=a,v=T.memoizedProps,T=T.memoizedState,c=l.stateNode;try{var be=pa(l.type,v);i=c.getSnapshotBeforeUpdate(be,T),c.__reactInternalSnapshotBeforeUpdate=i}catch(Re){ct(l,l.return,Re)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,l=i.nodeType,l===9)Sm(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Sm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=a.sibling,i!==null){i.return=a.return,en=i;break}en=a.return}}function Bv(i,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:_i(i,l),c&4&&Kl(5,l);break;case 1:if(_i(i,l),c&4)if(i=l.stateNode,a===null)try{i.componentDidMount()}catch(S){ct(l,l.return,S)}else{var v=pa(l.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(v,a,i.__reactInternalSnapshotBeforeUpdate)}catch(S){ct(l,l.return,S)}}c&64&&kv(l),c&512&&Yl(l,l.return);break;case 3:if(_i(i,l),c&64&&(i=l.updateQueue,i!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Sy(i,a)}catch(S){ct(l,l.return,S)}}break;case 27:a===null&&c&4&&Uv(l);case 26:case 5:_i(i,l),a===null&&c&4&&Vv(l),c&512&&Yl(l,l.return);break;case 12:_i(i,l);break;case 31:_i(i,l),c&4&&Hv(i,l);break;case 13:_i(i,l),c&4&&zv(i,l),c&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=qC.bind(null,l),lw(i,l))));break;case 22:if(c=l.memoizedState!==null||yi,!c){a=a!==null&&a.memoizedState!==null||Ht,v=yi;var T=Ht;yi=c,(Ht=a)&&!T?Ti(i,l,(l.subtreeFlags&8772)!==0):_i(i,l),yi=v,Ht=T}break;case 30:break;default:_i(i,l)}}function jv(i){var a=i.alternate;a!==null&&(i.alternate=null,jv(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&ja(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var St=null,wn=!1;function vi(i,a,l){for(l=l.child;l!==null;)qv(i,a,l),l=l.sibling}function qv(i,a,l){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(Sn,l)}catch{}switch(l.tag){case 26:Ht||Hs(l,a),vi(i,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Ht||Hs(l,a);var c=St,v=wn;gr(l.type)&&(St=l.stateNode,wn=!1),vi(i,a,l),su(l.stateNode),St=c,wn=v;break;case 5:Ht||Hs(l,a);case 6:if(c=St,v=wn,St=null,vi(i,a,l),St=c,wn=v,St!==null)if(wn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(l.stateNode)}catch(T){ct(l,a,T)}else try{St.removeChild(l.stateNode)}catch(T){ct(l,a,T)}break;case 18:St!==null&&(wn?(i=St,k0(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),Co(i)):k0(St,l.stateNode));break;case 4:c=St,v=wn,St=l.stateNode.containerInfo,wn=!0,vi(i,a,l),St=c,wn=v;break;case 0:case 11:case 14:case 15:ur(2,l,a),Ht||ur(4,l,a),vi(i,a,l);break;case 1:Ht||(Hs(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&Lv(l,a,c)),vi(i,a,l);break;case 21:vi(i,a,l);break;case 22:Ht=(c=Ht)||l.memoizedState!==null,vi(i,a,l),Ht=c;break;default:vi(i,a,l)}}function Hv(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Co(i)}catch(l){ct(a,a.return,l)}}}function zv(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Co(i)}catch(l){ct(a,a.return,l)}}function kC(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new Fv),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new Fv),a;default:throw Error(s(435,i.tag))}}function Yc(i,a){var l=kC(i);a.forEach(function(c){if(!l.has(c)){l.add(c);var v=HC.bind(null,i,c);c.then(v,v)}})}function In(i,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var v=l[c],T=i,S=a,I=S;e:for(;I!==null;){switch(I.tag){case 27:if(gr(I.type)){St=I.stateNode,wn=!1;break e}break;case 5:St=I.stateNode,wn=!1;break e;case 3:case 4:St=I.stateNode.containerInfo,wn=!0;break e}I=I.return}if(St===null)throw Error(s(160));qv(T,S,v),St=null,wn=!1,T=v.alternate,T!==null&&(T.return=null),v.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Gv(a,i),a=a.sibling}var ys=null;function Gv(i,a){var l=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:In(a,i),Nn(i),c&4&&(ur(3,i,i.return),Kl(3,i),ur(5,i,i.return));break;case 1:In(a,i),Nn(i),c&512&&(Ht||l===null||Hs(l,l.return)),c&64&&yi&&(i=i.updateQueue,i!==null&&(c=i.callbacks,c!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var v=ys;if(In(a,i),Nn(i),c&512&&(Ht||l===null||Hs(l,l.return)),c&4){var T=l!==null?l.memoizedState:null;if(c=i.memoizedState,l===null)if(c===null)if(i.stateNode===null){e:{c=i.type,l=i.memoizedProps,v=v.ownerDocument||v;t:switch(c){case"title":T=v.getElementsByTagName("title")[0],(!T||T[Ns]||T[Ot]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=v.createElement(c),v.head.insertBefore(T,v.querySelector("head > title"))),cn(T,c,l),T[Ot]=i,Ut(T),c=T;break e;case"link":var S=G0("link","href",v).get(c+(l.href||""));if(S){for(var I=0;I<S.length;I++)if(T=S[I],T.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&T.getAttribute("rel")===(l.rel==null?null:l.rel)&&T.getAttribute("title")===(l.title==null?null:l.title)&&T.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(I,1);break t}}T=v.createElement(c),cn(T,c,l),v.head.appendChild(T);break;case"meta":if(S=G0("meta","content",v).get(c+(l.content||""))){for(I=0;I<S.length;I++)if(T=S[I],T.getAttribute("content")===(l.content==null?null:""+l.content)&&T.getAttribute("name")===(l.name==null?null:l.name)&&T.getAttribute("property")===(l.property==null?null:l.property)&&T.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&T.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(I,1);break t}}T=v.createElement(c),cn(T,c,l),v.head.appendChild(T);break;default:throw Error(s(468,c))}T[Ot]=i,Ut(T),c=T}i.stateNode=c}else $0(v,i.type,i.stateNode);else i.stateNode=z0(v,c,i.memoizedProps);else T!==c?(T===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):T.count--,c===null?$0(v,i.type,i.stateNode):z0(v,c,i.memoizedProps)):c===null&&i.stateNode!==null&&Qh(i,i.memoizedProps,l.memoizedProps)}break;case 27:In(a,i),Nn(i),c&512&&(Ht||l===null||Hs(l,l.return)),l!==null&&c&4&&Qh(i,i.memoizedProps,l.memoizedProps);break;case 5:if(In(a,i),Nn(i),c&512&&(Ht||l===null||Hs(l,l.return)),i.flags&32){v=i.stateNode;try{Cn(v,"")}catch(be){ct(i,i.return,be)}}c&4&&i.stateNode!=null&&(v=i.memoizedProps,Qh(i,v,l!==null?l.memoizedProps:v)),c&1024&&(Zh=!0);break;case 6:if(In(a,i),Nn(i),c&4){if(i.stateNode===null)throw Error(s(162));c=i.memoizedProps,l=i.stateNode;try{l.nodeValue=c}catch(be){ct(i,i.return,be)}}break;case 3:if(cd=null,v=ys,ys=ld(a.containerInfo),In(a,i),ys=v,Nn(i),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Co(a.containerInfo)}catch(be){ct(i,i.return,be)}Zh&&(Zh=!1,$v(i));break;case 4:c=ys,ys=ld(i.stateNode.containerInfo),In(a,i),Nn(i),ys=c;break;case 12:In(a,i),Nn(i);break;case 31:In(a,i),Nn(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Yc(i,c)));break;case 13:In(a,i),Nn(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Qc=rn()),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Yc(i,c)));break;case 22:v=i.memoizedState!==null;var F=l!==null&&l.memoizedState!==null,W=yi,ie=Ht;if(yi=W||v,Ht=ie||F,In(a,i),Ht=ie,yi=W,Nn(i),c&8192)e:for(a=i.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(l===null||F||yi||Ht||ga(i)),l=null,a=i;;){if(a.tag===5||a.tag===26){if(l===null){F=l=a;try{if(T=F.stateNode,v)S=T.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{I=F.stateNode;var oe=F.memoizedProps.style,ee=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;I.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(be){ct(F,F.return,be)}}}else if(a.tag===6){if(l===null){F=a;try{F.stateNode.nodeValue=v?"":F.memoizedProps}catch(be){ct(F,F.return,be)}}}else if(a.tag===18){if(l===null){F=a;try{var ne=F.stateNode;v?L0(ne,!0):L0(F.stateNode,!1)}catch(be){ct(F,F.return,be)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=i.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Yc(i,l))));break;case 19:In(a,i),Nn(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,Yc(i,c)));break;case 30:break;case 21:break;default:In(a,i),Nn(i)}}function Nn(i){var a=i.flags;if(a&2){try{for(var l,c=i.return;c!==null;){if(Ov(c)){l=c;break}c=c.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var v=l.stateNode,T=Xh(i);Kc(i,T,v);break;case 5:var S=l.stateNode;l.flags&32&&(Cn(S,""),l.flags&=-33);var I=Xh(i);Kc(i,I,S);break;case 3:case 4:var F=l.stateNode.containerInfo,W=Xh(i);Wh(i,W,F);break;default:throw Error(s(161))}}catch(ie){ct(i,i.return,ie)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function $v(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;$v(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function _i(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Bv(i,a.alternate,a),a=a.sibling}function ga(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:ur(4,a,a.return),ga(a);break;case 1:Hs(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Lv(a,a.return,l),ga(a);break;case 27:su(a.stateNode);case 26:case 5:Hs(a,a.return),ga(a);break;case 22:a.memoizedState===null&&ga(a);break;case 30:ga(a);break;default:ga(a)}i=i.sibling}}function Ti(i,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,v=i,T=a,S=T.flags;switch(T.tag){case 0:case 11:case 15:Ti(v,T,l),Kl(4,T);break;case 1:if(Ti(v,T,l),c=T,v=c.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(W){ct(c,c.return,W)}if(c=T,v=c.updateQueue,v!==null){var I=c.stateNode;try{var F=v.shared.hiddenCallbacks;if(F!==null)for(v.shared.hiddenCallbacks=null,v=0;v<F.length;v++)Ey(F[v],I)}catch(W){ct(c,c.return,W)}}l&&S&64&&kv(T),Yl(T,T.return);break;case 27:Uv(T);case 26:case 5:Ti(v,T,l),l&&c===null&&S&4&&Vv(T),Yl(T,T.return);break;case 12:Ti(v,T,l);break;case 31:Ti(v,T,l),l&&S&4&&Hv(v,T);break;case 13:Ti(v,T,l),l&&S&4&&zv(v,T);break;case 22:T.memoizedState===null&&Ti(v,T,l),Yl(T,T.return);break;case 30:break;default:Ti(v,T,l)}a=a.sibling}}function em(i,a){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&kl(l))}function tm(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&kl(i))}function vs(i,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Kv(i,a,l,c),a=a.sibling}function Kv(i,a,l,c){var v=a.flags;switch(a.tag){case 0:case 11:case 15:vs(i,a,l,c),v&2048&&Kl(9,a);break;case 1:vs(i,a,l,c);break;case 3:vs(i,a,l,c),v&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&kl(i)));break;case 12:if(v&2048){vs(i,a,l,c),i=a.stateNode;try{var T=a.memoizedProps,S=T.id,I=T.onPostCommit;typeof I=="function"&&I(S,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(F){ct(a,a.return,F)}}else vs(i,a,l,c);break;case 31:vs(i,a,l,c);break;case 13:vs(i,a,l,c);break;case 23:break;case 22:T=a.stateNode,S=a.alternate,a.memoizedState!==null?T._visibility&2?vs(i,a,l,c):Jl(i,a):T._visibility&2?vs(i,a,l,c):(T._visibility|=2,po(i,a,l,c,(a.subtreeFlags&10256)!==0||!1)),v&2048&&em(S,a);break;case 24:vs(i,a,l,c),v&2048&&tm(a.alternate,a);break;default:vs(i,a,l,c)}}function po(i,a,l,c,v){for(v=v&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var T=i,S=a,I=l,F=c,W=S.flags;switch(S.tag){case 0:case 11:case 15:po(T,S,I,F,v),Kl(8,S);break;case 23:break;case 22:var ie=S.stateNode;S.memoizedState!==null?ie._visibility&2?po(T,S,I,F,v):Jl(T,S):(ie._visibility|=2,po(T,S,I,F,v)),v&&W&2048&&em(S.alternate,S);break;case 24:po(T,S,I,F,v),v&&W&2048&&tm(S.alternate,S);break;default:po(T,S,I,F,v)}a=a.sibling}}function Jl(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=i,c=a,v=c.flags;switch(c.tag){case 22:Jl(l,c),v&2048&&em(c.alternate,c);break;case 24:Jl(l,c),v&2048&&tm(c.alternate,c);break;default:Jl(l,c)}a=a.sibling}}var Ql=8192;function go(i,a,l){if(i.subtreeFlags&Ql)for(i=i.child;i!==null;)Yv(i,a,l),i=i.sibling}function Yv(i,a,l){switch(i.tag){case 26:go(i,a,l),i.flags&Ql&&i.memoizedState!==null&&Tw(l,ys,i.memoizedState,i.memoizedProps);break;case 5:go(i,a,l);break;case 3:case 4:var c=ys;ys=ld(i.stateNode.containerInfo),go(i,a,l),ys=c;break;case 22:i.memoizedState===null&&(c=i.alternate,c!==null&&c.memoizedState!==null?(c=Ql,Ql=16777216,go(i,a,l),Ql=c):go(i,a,l));break;default:go(i,a,l)}}function Jv(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Xl(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];en=c,Xv(c,i)}Jv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Qv(i),i=i.sibling}function Qv(i){switch(i.tag){case 0:case 11:case 15:Xl(i),i.flags&2048&&ur(9,i,i.return);break;case 3:Xl(i);break;case 12:Xl(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,Jc(i)):Xl(i);break;default:Xl(i)}}function Jc(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];en=c,Xv(c,i)}Jv(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:ur(8,a,a.return),Jc(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Jc(a));break;default:Jc(a)}i=i.sibling}}function Xv(i,a){for(;en!==null;){var l=en;switch(l.tag){case 0:case 11:case 15:ur(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:kl(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,en=c;else e:for(l=i;en!==null;){c=en;var v=c.sibling,T=c.return;if(jv(c),c===l){en=null;break e}if(v!==null){v.return=T,en=v;break e}en=T}}}var LC={getCacheForType:function(i){var a=ln(Bt),l=a.data.get(i);return l===void 0&&(l=i(),a.data.set(i,l)),l},cacheSignal:function(){return ln(Bt).controller.signal}},VC=typeof WeakMap=="function"?WeakMap:Map,at=0,pt=null,Ge=null,Ke=0,ut=0,Bn=null,cr=!1,yo=!1,nm=!1,bi=0,Rt=0,dr=0,ya=0,sm=0,jn=0,vo=0,Wl=null,Rn=null,im=!1,Qc=0,Wv=0,Xc=1/0,Wc=null,fr=null,Yt=0,hr=null,_o=null,xi=0,rm=0,am=null,Zv=null,Zl=0,om=null;function qn(){return(at&2)!==0&&Ke!==0?Ke&-Ke:Z.T!==null?hm():Zu()}function e0(){if(jn===0)if((Ke&536870912)===0||Ze){var i=ls;ls<<=1,(ls&3932160)===0&&(ls=262144),jn=i}else jn=536870912;return i=Un.current,i!==null&&(i.flags|=32),jn}function Dn(i,a,l){(i===pt&&(ut===2||ut===9)||i.cancelPendingCommit!==null)&&(To(i,0),mr(i,Ke,jn,!1)),Xt(i,l),((at&2)===0||i!==pt)&&(i===pt&&((at&2)===0&&(ya|=l),Rt===4&&mr(i,Ke,jn,!1)),zs(i))}function t0(i,a,l){if((at&6)!==0)throw Error(s(327));var c=!l&&(a&127)===0&&(a&i.expiredLanes)===0||Pn(i,a),v=c?FC(i,a):um(i,a,!0),T=c;do{if(v===0){yo&&!c&&mr(i,a,0,!1);break}else{if(l=i.current.alternate,T&&!OC(l)){v=um(i,a,!1),T=!1;continue}if(v===2){if(T=a,i.errorRecoveryDisabledLanes&T)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){a=S;e:{var I=i;v=Wl;var F=I.current.memoizedState.isDehydrated;if(F&&(To(I,S).flags|=256),S=um(I,S,!1),S!==2){if(nm&&!F){I.errorRecoveryDisabledLanes|=T,ya|=T,v=4;break e}T=Rn,Rn=v,T!==null&&(Rn===null?Rn=T:Rn.push.apply(Rn,T))}v=S}if(T=!1,v!==2)continue}}if(v===1){To(i,0),mr(i,a,0,!0);break}e:{switch(c=i,T=v,T){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:mr(c,a,jn,!cr);break e;case 2:Rn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(v=Qc+300-rn(),10<v)){if(mr(c,a,jn,!cr),$n(c,0,!0)!==0)break e;xi=a,c.timeoutHandle=M0(n0.bind(null,c,l,Rn,Wc,im,a,jn,ya,vo,cr,T,"Throttled",-0,0),v);break e}n0(c,l,Rn,Wc,im,a,jn,ya,vo,cr,T,null,-0,0)}}break}while(!0);zs(i)}function n0(i,a,l,c,v,T,S,I,F,W,ie,oe,ee,ne){if(i.timeoutHandle=-1,oe=a.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ds},Yv(a,T,oe);var be=(T&62914560)===T?Qc-rn():(T&4194048)===T?Wv-rn():0;if(be=bw(oe,be),be!==null){xi=T,i.cancelPendingCommit=be(c0.bind(null,i,a,T,l,c,v,S,I,F,ie,oe,null,ee,ne)),mr(i,T,S,!W);return}}c0(i,a,T,l,c,v,S,I,F)}function OC(i){for(var a=i;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var v=l[c],T=v.getSnapshot;v=v.value;try{if(!Vn(T(),v))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function mr(i,a,l,c){a&=~sm,a&=~ya,i.suspendedLanes|=a,i.pingedLanes&=~a,c&&(i.warmLanes|=a),c=i.expirationTimes;for(var v=a;0<v;){var T=31-ce(v),S=1<<T;c[T]=-1,v&=~S}l!==0&&tt(i,l,a)}function Zc(){return(at&6)===0?(eu(0),!1):!0}function lm(){if(Ge!==null){if(ut===0)var i=Ge.return;else i=Ge,di=la=null,Sh(i),uo=null,Vl=0,i=Ge;for(;i!==null;)Pv(i.alternate,i),i=i.return;Ge=null}}function To(i,a){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,sw(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),xi=0,lm(),pt=i,Ge=l=ui(i.current,null),Ke=a,ut=0,Bn=null,cr=!1,yo=Pn(i,a),nm=!1,vo=jn=sm=ya=dr=Rt=0,Rn=Wl=null,im=!1,(a&8)!==0&&(a|=a&32);var c=i.entangledLanes;if(c!==0)for(i=i.entanglements,c&=a;0<c;){var v=31-ce(c),T=1<<v;a|=i[v],c&=~T}return bi=a,Tc(),l}function s0(i,a){qe=null,Z.H=zl,a===lo||a===Ic?(a=_y(),ut=3):a===fh?(a=_y(),ut=4):ut=a===Bh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Bn=a,Ge===null&&(Rt=1,qc(i,Wn(a,i.current)))}function i0(){var i=Un.current;return i===null?!0:(Ke&4194048)===Ke?ns===null:(Ke&62914560)===Ke||(Ke&536870912)!==0?i===ns:!1}function r0(){var i=Z.H;return Z.H=zl,i===null?zl:i}function a0(){var i=Z.A;return Z.A=LC,i}function ed(){Rt=4,cr||(Ke&4194048)!==Ke&&Un.current!==null||(yo=!0),(dr&134217727)===0&&(ya&134217727)===0||pt===null||mr(pt,Ke,jn,!1)}function um(i,a,l){var c=at;at|=2;var v=r0(),T=a0();(pt!==i||Ke!==a)&&(Wc=null,To(i,a)),a=!1;var S=Rt;e:do try{if(ut!==0&&Ge!==null){var I=Ge,F=Bn;switch(ut){case 8:lm(),S=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(a=!0);var W=ut;if(ut=0,Bn=null,bo(i,I,F,W),l&&yo){S=0;break e}break;default:W=ut,ut=0,Bn=null,bo(i,I,F,W)}}UC(),S=Rt;break}catch(ie){s0(i,ie)}while(!0);return a&&i.shellSuspendCounter++,di=la=null,at=c,Z.H=v,Z.A=T,Ge===null&&(pt=null,Ke=0,Tc()),S}function UC(){for(;Ge!==null;)o0(Ge)}function FC(i,a){var l=at;at|=2;var c=r0(),v=a0();pt!==i||Ke!==a?(Wc=null,Xc=rn()+500,To(i,a)):yo=Pn(i,a);e:do try{if(ut!==0&&Ge!==null){a=Ge;var T=Bn;t:switch(ut){case 1:ut=0,Bn=null,bo(i,a,T,1);break;case 2:case 9:if(yy(T)){ut=0,Bn=null,l0(a);break}a=function(){ut!==2&&ut!==9||pt!==i||(ut=7),zs(i)},T.then(a,a);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:yy(T)?(ut=0,Bn=null,l0(a)):(ut=0,Bn=null,bo(i,a,T,7));break;case 5:var S=null;switch(Ge.tag){case 26:S=Ge.memoizedState;case 5:case 27:var I=Ge;if(S?K0(S):I.stateNode.complete){ut=0,Bn=null;var F=I.sibling;if(F!==null)Ge=F;else{var W=I.return;W!==null?(Ge=W,td(W)):Ge=null}break t}}ut=0,Bn=null,bo(i,a,T,5);break;case 6:ut=0,Bn=null,bo(i,a,T,6);break;case 8:lm(),Rt=6;break e;default:throw Error(s(462))}}BC();break}catch(ie){s0(i,ie)}while(!0);return di=la=null,Z.H=c,Z.A=v,at=l,Ge!==null?0:(pt=null,Ke=0,Tc(),Rt)}function BC(){for(;Ge!==null&&!cl();)o0(Ge)}function o0(i){var a=Dv(i.alternate,i,bi);i.memoizedProps=i.pendingProps,a===null?td(i):Ge=a}function l0(i){var a=i,l=a.alternate;switch(a.tag){case 15:case 0:a=Av(l,a,a.pendingProps,a.type,void 0,Ke);break;case 11:a=Av(l,a,a.pendingProps,a.type.render,a.ref,Ke);break;case 5:Sh(a);default:Pv(l,a),a=Ge=ay(a,bi),a=Dv(l,a,bi)}i.memoizedProps=i.pendingProps,a===null?td(i):Ge=a}function bo(i,a,l,c){di=la=null,Sh(a),uo=null,Vl=0;var v=a.return;try{if(IC(i,v,a,l,Ke)){Rt=1,qc(i,Wn(l,i.current)),Ge=null;return}}catch(T){if(v!==null)throw Ge=v,T;Rt=1,qc(i,Wn(l,i.current)),Ge=null;return}a.flags&32768?(Ze||c===1?i=!0:yo||(Ke&536870912)!==0?i=!1:(cr=i=!0,(c===2||c===9||c===3||c===6)&&(c=Un.current,c!==null&&c.tag===13&&(c.flags|=16384))),u0(a,i)):td(a)}function td(i){var a=i;do{if((a.flags&32768)!==0){u0(a,cr);return}i=a.return;var l=DC(a.alternate,a,bi);if(l!==null){Ge=l;return}if(a=a.sibling,a!==null){Ge=a;return}Ge=a=i}while(a!==null);Rt===0&&(Rt=5)}function u0(i,a){do{var l=MC(i.alternate,i);if(l!==null){l.flags&=32767,Ge=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(i=i.sibling,i!==null)){Ge=i;return}Ge=i=l}while(i!==null);Rt=6,Ge=null}function c0(i,a,l,c,v,T,S,I,F){i.cancelPendingCommit=null;do nd();while(Yt!==0);if((at&6)!==0)throw Error(s(327));if(a!==null){if(a===i.current)throw Error(s(177));if(T=a.lanes|a.childLanes,T|=Xf,ii(i,l,T,S,I,F),i===pt&&(Ge=pt=null,Ke=0),_o=a,hr=i,xi=l,rm=T,am=v,Zv=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,zC(ws,function(){return p0(),null})):(i.callbackNode=null,i.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,v=Q.p,Q.p=2,S=at,at|=4;try{PC(i,a,l)}finally{at=S,Q.p=v,Z.T=c}}Yt=1,d0(),f0(),h0()}}function d0(){if(Yt===1){Yt=0;var i=hr,a=_o,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=Z.T,Z.T=null;var c=Q.p;Q.p=2;var v=at;at|=4;try{Gv(a,i);var T=bm,S=Xg(i.containerInfo),I=T.focusedElem,F=T.selectionRange;if(S!==I&&I&&I.ownerDocument&&Qg(I.ownerDocument.documentElement,I)){if(F!==null&&$f(I)){var W=F.start,ie=F.end;if(ie===void 0&&(ie=W),"selectionStart"in I)I.selectionStart=W,I.selectionEnd=Math.min(ie,I.value.length);else{var oe=I.ownerDocument||document,ee=oe&&oe.defaultView||window;if(ee.getSelection){var ne=ee.getSelection(),be=I.textContent.length,Re=Math.min(F.start,be),mt=F.end===void 0?Re:Math.min(F.end,be);!ne.extend&&Re>mt&&(S=mt,mt=Re,Re=S);var Y=Jg(I,Re),z=Jg(I,mt);if(Y&&z&&(ne.rangeCount!==1||ne.anchorNode!==Y.node||ne.anchorOffset!==Y.offset||ne.focusNode!==z.node||ne.focusOffset!==z.offset)){var X=oe.createRange();X.setStart(Y.node,Y.offset),ne.removeAllRanges(),Re>mt?(ne.addRange(X),ne.extend(z.node,z.offset)):(X.setEnd(z.node,z.offset),ne.addRange(X))}}}}for(oe=[],ne=I;ne=ne.parentNode;)ne.nodeType===1&&oe.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<oe.length;I++){var ae=oe[I];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}md=!!Tm,bm=Tm=null}finally{at=v,Q.p=c,Z.T=l}}i.current=a,Yt=2}}function f0(){if(Yt===2){Yt=0;var i=hr,a=_o,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=Z.T,Z.T=null;var c=Q.p;Q.p=2;var v=at;at|=4;try{Bv(i,a.alternate,a)}finally{at=v,Q.p=c,Z.T=l}}Yt=3}}function h0(){if(Yt===4||Yt===3){Yt=0,Ua();var i=hr,a=_o,l=xi,c=Zv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Yt=5:(Yt=0,_o=hr=null,m0(i,i.pendingLanes));var v=i.pendingLanes;if(v===0&&(fr=null),ri(l),a=a.stateNode,G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(Sn,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=Z.T,v=Q.p,Q.p=2,Z.T=null;try{for(var T=i.onRecoverableError,S=0;S<c.length;S++){var I=c[S];T(I.value,{componentStack:I.stack})}}finally{Z.T=a,Q.p=v}}(xi&3)!==0&&nd(),zs(i),v=i.pendingLanes,(l&261930)!==0&&(v&42)!==0?i===om?Zl++:(Zl=0,om=i):Zl=0,eu(0)}}function m0(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,kl(a)))}function nd(){return d0(),f0(),h0(),p0()}function p0(){if(Yt!==5)return!1;var i=hr,a=rm;rm=0;var l=ri(xi),c=Z.T,v=Q.p;try{Q.p=32>l?32:l,Z.T=null,l=am,am=null;var T=hr,S=xi;if(Yt=0,_o=hr=null,xi=0,(at&6)!==0)throw Error(s(331));var I=at;if(at|=4,Qv(T.current),Kv(T,T.current,S,l),at=I,eu(0,!1),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(Sn,T)}catch{}return!0}finally{Q.p=v,Z.T=c,m0(i,a)}}function g0(i,a,l){a=Wn(l,a),a=Fh(i.stateNode,a,2),i=ar(i,a,2),i!==null&&(Xt(i,2),zs(i))}function ct(i,a,l){if(i.tag===3)g0(i,i,l);else for(;a!==null;){if(a.tag===3){g0(a,i,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(fr===null||!fr.has(c))){i=Wn(l,i),l=yv(2),c=ar(a,l,2),c!==null&&(vv(l,c,a,i),Xt(c,2),zs(c));break}}a=a.return}}function cm(i,a,l){var c=i.pingCache;if(c===null){c=i.pingCache=new VC;var v=new Set;c.set(a,v)}else v=c.get(a),v===void 0&&(v=new Set,c.set(a,v));v.has(l)||(nm=!0,v.add(l),i=jC.bind(null,i,a,l),a.then(i,i))}function jC(i,a,l){var c=i.pingCache;c!==null&&c.delete(a),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,pt===i&&(Ke&l)===l&&(Rt===4||Rt===3&&(Ke&62914560)===Ke&&300>rn()-Qc?(at&2)===0&&To(i,0):sm|=l,vo===Ke&&(vo=0)),zs(i)}function y0(i,a){a===0&&(a=It()),i=ra(i,a),i!==null&&(Xt(i,a),zs(i))}function qC(i){var a=i.memoizedState,l=0;a!==null&&(l=a.retryLane),y0(i,l)}function HC(i,a){var l=0;switch(i.tag){case 31:case 13:var c=i.stateNode,v=i.memoizedState;v!==null&&(l=v.retryLane);break;case 19:c=i.stateNode;break;case 22:c=i.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(a),y0(i,l)}function zC(i,a){return Dt(i,a)}var sd=null,xo=null,dm=!1,id=!1,fm=!1,pr=0;function zs(i){i!==xo&&i.next===null&&(xo===null?sd=xo=i:xo=xo.next=i),id=!0,dm||(dm=!0,$C())}function eu(i,a){if(!fm&&id){fm=!0;do for(var l=!1,c=sd;c!==null;){if(i!==0){var v=c.pendingLanes;if(v===0)var T=0;else{var S=c.suspendedLanes,I=c.pingedLanes;T=(1<<31-ce(42|i)+1)-1,T&=v&~(S&~I),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(l=!0,b0(c,T))}else T=Ke,T=$n(c,c===pt?T:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(T&3)===0||Pn(c,T)||(l=!0,b0(c,T));c=c.next}while(l);fm=!1}}function GC(){v0()}function v0(){id=dm=!1;var i=0;pr!==0&&nw()&&(i=pr);for(var a=rn(),l=null,c=sd;c!==null;){var v=c.next,T=_0(c,a);T===0?(c.next=null,l===null?sd=v:l.next=v,v===null&&(xo=l)):(l=c,(i!==0||(T&3)!==0)&&(id=!0)),c=v}Yt!==0&&Yt!==5||eu(i),pr!==0&&(pr=0)}function _0(i,a){for(var l=i.suspendedLanes,c=i.pingedLanes,v=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var S=31-ce(T),I=1<<S,F=v[S];F===-1?((I&l)===0||(I&c)!==0)&&(v[S]=Te(I,a)):F<=a&&(i.expiredLanes|=I),T&=~I}if(a=pt,l=Ke,l=$n(i,i===a?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c=i.callbackNode,l===0||i===a&&(ut===2||ut===9)||i.cancelPendingCommit!==null)return c!==null&&c!==null&&Cs(c),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||Pn(i,l)){if(a=l&-l,a===i.callbackPriority)return a;switch(c!==null&&Cs(c),ri(l)){case 2:case 8:l=zi;break;case 32:l=ws;break;case 268435456:l=zr;break;default:l=ws}return c=T0.bind(null,i),l=Dt(l,c),i.callbackPriority=a,i.callbackNode=l,a}return c!==null&&c!==null&&Cs(c),i.callbackPriority=2,i.callbackNode=null,2}function T0(i,a){if(Yt!==0&&Yt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(nd()&&i.callbackNode!==l)return null;var c=Ke;return c=$n(i,i===pt?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c===0?null:(t0(i,c,a),_0(i,rn()),i.callbackNode!=null&&i.callbackNode===l?T0.bind(null,i):null)}function b0(i,a){if(nd())return null;t0(i,a,!0)}function $C(){iw(function(){(at&6)!==0?Dt(Hr,GC):v0()})}function hm(){if(pr===0){var i=ao;i===0&&(i=fn,fn<<=1,(fn&261888)===0&&(fn=256)),pr=i}return pr}function x0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ga(""+i)}function E0(i,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,i.id&&l.setAttribute("form",i.id),a.parentNode.insertBefore(l,a),i=new FormData(i),l.parentNode.removeChild(l),i}function KC(i,a,l,c,v){if(a==="submit"&&l&&l.stateNode===v){var T=x0((v[Wt]||null).action),S=c.submitter;S&&(a=(a=S[Wt]||null)?x0(a.formAction):S.getAttribute("formAction"),a!==null&&(T=a,S=null));var I=new Os("action","action",null,c,v);i.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(pr!==0){var F=S?E0(v,S):new FormData(v);Ph(l,{pending:!0,data:F,method:v.method,action:T},null,F)}}else typeof T=="function"&&(I.preventDefault(),F=S?E0(v,S):new FormData(v),Ph(l,{pending:!0,data:F,method:v.method,action:T},T,F))},currentTarget:v}]})}}for(var mm=0;mm<Qf.length;mm++){var pm=Qf[mm],YC=pm.toLowerCase(),JC=pm[0].toUpperCase()+pm.slice(1);gs(YC,"on"+JC)}gs(ey,"onAnimationEnd"),gs(ty,"onAnimationIteration"),gs(ny,"onAnimationStart"),gs("dblclick","onDoubleClick"),gs("focusin","onFocus"),gs("focusout","onBlur"),gs(dC,"onTransitionRun"),gs(fC,"onTransitionStart"),gs(hC,"onTransitionCancel"),gs(sy,"onTransitionEnd"),Ps("onMouseEnter",["mouseout","mouseover"]),Ps("onMouseLeave",["mouseout","mouseover"]),Ps("onPointerEnter",["pointerout","pointerover"]),Ps("onPointerLeave",["pointerout","pointerover"]),Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(tu));function S0(i,a){a=(a&4)!==0;for(var l=0;l<i.length;l++){var c=i[l],v=c.event;c=c.listeners;e:{var T=void 0;if(a)for(var S=c.length-1;0<=S;S--){var I=c[S],F=I.instance,W=I.currentTarget;if(I=I.listener,F!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=W;try{T(v)}catch(ie){_c(ie)}v.currentTarget=null,T=F}else for(S=0;S<c.length;S++){if(I=c[S],F=I.instance,W=I.currentTarget,I=I.listener,F!==T&&v.isPropagationStopped())break e;T=I,v.currentTarget=W;try{T(v)}catch(ie){_c(ie)}v.currentTarget=null,T=F}}}}function $e(i,a){var l=a[Ba];l===void 0&&(l=a[Ba]=new Set);var c=i+"__bubble";l.has(c)||(A0(a,i,2,!1),l.add(c))}function gm(i,a,l){var c=0;a&&(c|=4),A0(l,i,c,a)}var rd="_reactListening"+Math.random().toString(36).slice(2);function ym(i){if(!i[rd]){i[rd]=!0,hl.forEach(function(l){l!=="selectionchange"&&(QC.has(l)||gm(l,!1,i),gm(l,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[rd]||(a[rd]=!0,gm("selectionchange",!1,a))}}function A0(i,a,l,c){switch(e_(a)){case 2:var v=Sw;break;case 8:v=Aw;break;default:v=Mm}l=v.bind(null,a,l,i),v=void 0,!Xr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),c?v!==void 0?i.addEventListener(a,l,{capture:!0,passive:v}):i.addEventListener(a,l,!0):v!==void 0?i.addEventListener(a,l,{passive:v}):i.addEventListener(a,l,!1)}function vm(i,a,l,c,v){var T=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var I=c.stateNode.containerInfo;if(I===v)break;if(S===4)for(S=c.return;S!==null;){var F=S.tag;if((F===3||F===4)&&S.stateNode.containerInfo===v)return;S=S.return}for(;I!==null;){if(S=Rs(I),S===null)return;if(F=S.tag,F===5||F===6||F===26||F===27){c=T=S;continue e}I=I.parentNode}}c=c.return}Qi(function(){var W=T,ie=Yn(l),oe=[];e:{var ee=iy.get(i);if(ee!==void 0){var ne=Os,be=i;switch(i){case"keypress":if(Zr(l)===0)break e;case"keydown":case"keyup":ne=gc;break;case"focusin":be="focus",ne=ta;break;case"focusout":be="blur",ne=ta;break;case"beforeblur":case"afterblur":ne=ta;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=oc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=E;break;case ey:case ty:case ny:ne=uc;break;case sy:ne=P;break;case"scroll":case"scrollend":ne=Al;break;case"wheel":ne=te;break;case"copy":case"cut":case"paste":ne=cc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=li;break;case"toggle":case"beforetoggle":ne=je}var Re=(a&4)!==0,mt=!Re&&(i==="scroll"||i==="scrollend"),Y=Re?ee!==null?ee+"Capture":null:ee;Re=[];for(var z=W,X;z!==null;){var ae=z;if(X=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||X===null||Y===null||(ae=fs(z,Y),ae!=null&&Re.push(nu(z,ae,X))),mt)break;z=z.return}0<Re.length&&(ee=new ne(ee,be,null,l,ie),oe.push({event:ee,listeners:Re}))}}if((a&7)===0){e:{if(ee=i==="mouseover"||i==="pointerover",ne=i==="mouseout"||i==="pointerout",ee&&l!==xl&&(be=l.relatedTarget||l.fromElement)&&(Rs(be)||be[Is]))break e;if((ne||ee)&&(ee=ie.window===ie?ie:(ee=ie.ownerDocument)?ee.defaultView||ee.parentWindow:window,ne?(be=l.relatedTarget||l.toElement,ne=W,be=be?Rs(be):null,be!==null&&(mt=o(be),Re=be.tag,be!==mt||Re!==5&&Re!==27&&Re!==6)&&(be=null)):(ne=null,be=W),ne!==be)){if(Re=Cl,ae="onMouseLeave",Y="onMouseEnter",z="mouse",(i==="pointerout"||i==="pointerover")&&(Re=li,ae="onPointerLeave",Y="onPointerEnter",z="pointer"),mt=ne==null?ee:kn(ne),X=be==null?ee:kn(be),ee=new Re(ae,z+"leave",ne,l,ie),ee.target=mt,ee.relatedTarget=X,ae=null,Rs(ie)===W&&(Re=new Re(Y,z+"enter",be,l,ie),Re.target=X,Re.relatedTarget=mt,ae=Re),mt=ae,ne&&be)t:{for(Re=XC,Y=ne,z=be,X=0,ae=Y;ae;ae=Re(ae))X++;ae=0;for(var we=z;we;we=Re(we))ae++;for(;0<X-ae;)Y=Re(Y),X--;for(;0<ae-X;)z=Re(z),ae--;for(;X--;){if(Y===z||z!==null&&Y===z.alternate){Re=Y;break t}Y=Re(Y),z=Re(z)}Re=null}else Re=null;ne!==null&&C0(oe,ee,ne,Re,!1),be!==null&&mt!==null&&C0(oe,mt,be,Re,!0)}}e:{if(ee=W?kn(W):window,ne=ee.nodeName&&ee.nodeName.toLowerCase(),ne==="select"||ne==="input"&&ee.type==="file")var nt=Hg;else if(jg(ee))if(zg)nt=lC;else{nt=aC;var Se=rC}else ne=ee.nodeName,!ne||ne.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?W&&za(W.elementType)&&(nt=Hg):nt=oC;if(nt&&(nt=nt(i,W))){qg(oe,nt,l,ie);break e}Se&&Se(i,ee,W),i==="focusout"&&W&&ee.type==="number"&&W.memoizedProps.value!=null&&_l(ee,"number",ee.value)}switch(Se=W?kn(W):window,i){case"focusin":(jg(Se)||Se.contentEditable==="true")&&(Wa=Se,Kf=W,Dl=null);break;case"focusout":Dl=Kf=Wa=null;break;case"mousedown":Yf=!0;break;case"contextmenu":case"mouseup":case"dragend":Yf=!1,Wg(oe,l,ie);break;case"selectionchange":if(cC)break;case"keydown":case"keyup":Wg(oe,l,ie)}var He;if(rt)e:{switch(i){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else Xa?na(i,l)&&(Ye="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Ye="onCompositionStart");Ye&&(Bs&&l.locale!=="ko"&&(Xa||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&Xa&&(He=Sl()):(Vs=ie,El="value"in Vs?Vs.value:Vs.textContent,Xa=!0)),Se=ad(W,Ye),0<Se.length&&(Ye=new Fs(Ye,i,null,l,ie),oe.push({event:Ye,listeners:Se}),He?Ye.data=He:(He=Qa(l),He!==null&&(Ye.data=He)))),(He=Qn?tC(i,l):nC(i,l))&&(Ye=ad(W,"onBeforeInput"),0<Ye.length&&(Se=new Fs("onBeforeInput","beforeinput",null,l,ie),oe.push({event:Se,listeners:Ye}),Se.data=He)),KC(oe,i,W,l,ie)}S0(oe,a)})}function nu(i,a,l){return{instance:i,listener:a,currentTarget:l}}function ad(i,a){for(var l=a+"Capture",c=[];i!==null;){var v=i,T=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||T===null||(v=fs(i,l),v!=null&&c.unshift(nu(i,v,T)),v=fs(i,a),v!=null&&c.push(nu(i,v,T))),i.tag===3)return c;i=i.return}return[]}function XC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function C0(i,a,l,c,v){for(var T=a._reactName,S=[];l!==null&&l!==c;){var I=l,F=I.alternate,W=I.stateNode;if(I=I.tag,F!==null&&F===c)break;I!==5&&I!==26&&I!==27||W===null||(F=W,v?(W=fs(l,T),W!=null&&S.unshift(nu(l,W,F))):v||(W=fs(l,T),W!=null&&S.push(nu(l,W,F)))),l=l.return}S.length!==0&&i.push({event:a,listeners:S})}var WC=/\r\n?/g,ZC=/\u0000|\uFFFD/g;function w0(i){return(typeof i=="string"?i:""+i).replace(WC,`
`).replace(ZC,"")}function I0(i,a){return a=w0(a),w0(i)===a}function ht(i,a,l,c,v,T){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Cn(i,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Cn(i,""+c);break;case"className":Ln(i,"class",c);break;case"tabIndex":Ln(i,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Ln(i,l,c);break;case"style":bl(i,c,T);break;case"data":if(a!=="object"){Ln(i,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){i.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Ga(""+c),i.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(l==="formAction"?(a!=="input"&&ht(i,a,"name",v.name,v,null),ht(i,a,"formEncType",v.formEncType,v,null),ht(i,a,"formMethod",v.formMethod,v,null),ht(i,a,"formTarget",v.formTarget,v,null)):(ht(i,a,"encType",v.encType,v,null),ht(i,a,"method",v.method,v,null),ht(i,a,"target",v.target,v,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Ga(""+c),i.setAttribute(l,c);break;case"onClick":c!=null&&(i.onclick=ds);break;case"onScroll":c!=null&&$e("scroll",i);break;case"onScrollEnd":c!=null&&$e("scrollend",i);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(v.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"multiple":i.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":i.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){i.removeAttribute("xlink:href");break}l=Ga(""+c),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""+c):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":c===!0?i.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,c):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?i.setAttribute(l,c):i.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?i.removeAttribute(l):i.setAttribute(l,c);break;case"popover":$e("beforetoggle",i),$e("toggle",i),qa(i,"popover",c);break;case"xlinkActuate":Ft(i,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ft(i,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ft(i,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ft(i,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ft(i,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ft(i,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ft(i,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ft(i,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ft(i,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":qa(i,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=ac.get(l)||l,qa(i,l,c))}}function _m(i,a,l,c,v,T){switch(l){case"style":bl(i,c,T);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(v.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"children":typeof c=="string"?Cn(i,c):(typeof c=="number"||typeof c=="bigint")&&Cn(i,""+c);break;case"onScroll":c!=null&&$e("scroll",i);break;case"onScrollEnd":c!=null&&$e("scrollend",i);break;case"onClick":c!=null&&(i.onclick=ds);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ml.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(v=l.endsWith("Capture"),a=l.slice(2,v?l.length-7:void 0),T=i[Wt]||null,T=T!=null?T[l]:null,typeof T=="function"&&i.removeEventListener(a,T,v),typeof c=="function")){typeof T!="function"&&T!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(a,c,v);break e}l in i?i[l]=c:c===!0?i.setAttribute(l,""):qa(i,l,c)}}}function cn(i,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",i),$e("load",i);var c=!1,v=!1,T;for(T in l)if(l.hasOwnProperty(T)){var S=l[T];if(S!=null)switch(T){case"src":c=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:ht(i,a,T,S,l,null)}}v&&ht(i,a,"srcSet",l.srcSet,l,null),c&&ht(i,a,"src",l.src,l,null);return;case"input":$e("invalid",i);var I=T=S=v=null,F=null,W=null;for(c in l)if(l.hasOwnProperty(c)){var ie=l[c];if(ie!=null)switch(c){case"name":v=ie;break;case"type":S=ie;break;case"checked":F=ie;break;case"defaultChecked":W=ie;break;case"value":T=ie;break;case"defaultValue":I=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,a));break;default:ht(i,a,c,ie,l,null)}}sc(i,T,I,F,W,S,v,!1);return;case"select":$e("invalid",i),c=S=T=null;for(v in l)if(l.hasOwnProperty(v)&&(I=l[v],I!=null))switch(v){case"value":T=I;break;case"defaultValue":S=I;break;case"multiple":c=I;default:ht(i,a,v,I,l,null)}a=T,l=S,i.multiple=!!c,a!=null?$i(i,!!c,a,!1):l!=null&&$i(i,!!c,l,!0);return;case"textarea":$e("invalid",i),T=v=c=null;for(S in l)if(l.hasOwnProperty(S)&&(I=l[S],I!=null))switch(S){case"value":c=I;break;case"defaultValue":v=I;break;case"children":T=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(s(91));break;default:ht(i,a,S,I,l,null)}Ki(i,c,v,T);return;case"option":for(F in l)if(l.hasOwnProperty(F)&&(c=l[F],c!=null))switch(F){case"selected":i.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ht(i,a,F,c,l,null)}return;case"dialog":$e("beforetoggle",i),$e("toggle",i),$e("cancel",i),$e("close",i);break;case"iframe":case"object":$e("load",i);break;case"video":case"audio":for(c=0;c<tu.length;c++)$e(tu[c],i);break;case"image":$e("error",i),$e("load",i);break;case"details":$e("toggle",i);break;case"embed":case"source":case"link":$e("error",i),$e("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in l)if(l.hasOwnProperty(W)&&(c=l[W],c!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:ht(i,a,W,c,l,null)}return;default:if(za(a)){for(ie in l)l.hasOwnProperty(ie)&&(c=l[ie],c!==void 0&&_m(i,a,ie,c,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(c=l[I],c!=null&&ht(i,a,I,c,l,null))}function ew(i,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,T=null,S=null,I=null,F=null,W=null,ie=null;for(ne in l){var oe=l[ne];if(l.hasOwnProperty(ne)&&oe!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":F=oe;default:c.hasOwnProperty(ne)||ht(i,a,ne,null,c,oe)}}for(var ee in c){var ne=c[ee];if(oe=l[ee],c.hasOwnProperty(ee)&&(ne!=null||oe!=null))switch(ee){case"type":T=ne;break;case"name":v=ne;break;case"checked":W=ne;break;case"defaultChecked":ie=ne;break;case"value":S=ne;break;case"defaultValue":I=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(137,a));break;default:ne!==oe&&ht(i,a,ee,ne,c,oe)}}Ha(i,S,I,F,W,ie,T,v);return;case"select":ne=S=I=ee=null;for(T in l)if(F=l[T],l.hasOwnProperty(T)&&F!=null)switch(T){case"value":break;case"multiple":ne=F;default:c.hasOwnProperty(T)||ht(i,a,T,null,c,F)}for(v in c)if(T=c[v],F=l[v],c.hasOwnProperty(v)&&(T!=null||F!=null))switch(v){case"value":ee=T;break;case"defaultValue":I=T;break;case"multiple":S=T;default:T!==F&&ht(i,a,v,T,c,F)}a=I,l=S,c=ne,ee!=null?$i(i,!!l,ee,!1):!!c!=!!l&&(a!=null?$i(i,!!l,a,!0):$i(i,!!l,l?[]:"",!1));return;case"textarea":ne=ee=null;for(I in l)if(v=l[I],l.hasOwnProperty(I)&&v!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:ht(i,a,I,null,c,v)}for(S in c)if(v=c[S],T=l[S],c.hasOwnProperty(S)&&(v!=null||T!=null))switch(S){case"value":ee=v;break;case"defaultValue":ne=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(s(91));break;default:v!==T&&ht(i,a,S,v,c,T)}ic(i,ee,ne);return;case"option":for(var be in l)if(ee=l[be],l.hasOwnProperty(be)&&ee!=null&&!c.hasOwnProperty(be))switch(be){case"selected":i.selected=!1;break;default:ht(i,a,be,null,c,ee)}for(F in c)if(ee=c[F],ne=l[F],c.hasOwnProperty(F)&&ee!==ne&&(ee!=null||ne!=null))switch(F){case"selected":i.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:ht(i,a,F,ee,c,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in l)ee=l[Re],l.hasOwnProperty(Re)&&ee!=null&&!c.hasOwnProperty(Re)&&ht(i,a,Re,null,c,ee);for(W in c)if(ee=c[W],ne=l[W],c.hasOwnProperty(W)&&ee!==ne&&(ee!=null||ne!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(s(137,a));break;default:ht(i,a,W,ee,c,ne)}return;default:if(za(a)){for(var mt in l)ee=l[mt],l.hasOwnProperty(mt)&&ee!==void 0&&!c.hasOwnProperty(mt)&&_m(i,a,mt,void 0,c,ee);for(ie in c)ee=c[ie],ne=l[ie],!c.hasOwnProperty(ie)||ee===ne||ee===void 0&&ne===void 0||_m(i,a,ie,ee,c,ne);return}}for(var Y in l)ee=l[Y],l.hasOwnProperty(Y)&&ee!=null&&!c.hasOwnProperty(Y)&&ht(i,a,Y,null,c,ee);for(oe in c)ee=c[oe],ne=l[oe],!c.hasOwnProperty(oe)||ee===ne||ee==null&&ne==null||ht(i,a,oe,ee,c,ne)}function N0(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tw(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var v=l[c],T=v.transferSize,S=v.initiatorType,I=v.duration;if(T&&I&&N0(S)){for(S=0,I=v.responseEnd,c+=1;c<l.length;c++){var F=l[c],W=F.startTime;if(W>I)break;var ie=F.transferSize,oe=F.initiatorType;ie&&N0(oe)&&(F=F.responseEnd,S+=ie*(F<I?1:(I-W)/(F-W)))}if(--c,a+=8*(T+S)/(v.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Tm=null,bm=null;function od(i){return i.nodeType===9?i:i.ownerDocument}function R0(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function D0(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function xm(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Em=null;function nw(){var i=window.event;return i&&i.type==="popstate"?i===Em?!1:(Em=i,!0):(Em=null,!1)}var M0=typeof setTimeout=="function"?setTimeout:void 0,sw=typeof clearTimeout=="function"?clearTimeout:void 0,P0=typeof Promise=="function"?Promise:void 0,iw=typeof queueMicrotask=="function"?queueMicrotask:typeof P0<"u"?function(i){return P0.resolve(null).then(i).catch(rw)}:M0;function rw(i){setTimeout(function(){throw i})}function gr(i){return i==="head"}function k0(i,a){var l=a,c=0;do{var v=l.nextSibling;if(i.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"||l==="/&"){if(c===0){i.removeChild(v),Co(a);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")su(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,su(l);for(var T=l.firstChild;T;){var S=T.nextSibling,I=T.nodeName;T[Ns]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=S}}else l==="body"&&su(i.ownerDocument.body);l=v}while(l);Co(a)}function L0(i,a){var l=i;i=0;do{var c=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=c}while(l)}function Sm(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Sm(l),ja(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function aw(i,a,l,c){for(;i.nodeType===1;){var v=l;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(c){if(!i[Ns])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==v.rel||i.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||i.getAttribute("title")!==(v.title==null?null:v.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(v.src==null?null:v.src)||i.getAttribute("type")!==(v.type==null?null:v.type)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var T=v.name==null?null:""+v.name;if(v.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=ss(i.nextSibling),i===null)break}return null}function ow(i,a,l){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ss(i.nextSibling),i===null))return null;return i}function V0(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=ss(i.nextSibling),i===null))return null;return i}function Am(i){return i.data==="$?"||i.data==="$~"}function Cm(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function lw(i,a){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||l.readyState!=="loading")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),i._reactRetry=c}}function ss(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var wm=null;function O0(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(a===0)return ss(i.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}i=i.nextSibling}return null}function U0(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return i;a--}else l!=="/$"&&l!=="/&"||a++}i=i.previousSibling}return null}function F0(i,a,l){switch(a=od(l),i){case"html":if(i=a.documentElement,!i)throw Error(s(452));return i;case"head":if(i=a.head,!i)throw Error(s(453));return i;case"body":if(i=a.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function su(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);ja(i)}var is=new Map,B0=new Set;function ld(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ei=Q.d;Q.d={f:uw,r:cw,D:dw,C:fw,L:hw,m:mw,X:gw,S:pw,M:yw};function uw(){var i=Ei.f(),a=Zc();return i||a}function cw(i){var a=Kn(i);a!==null&&a.tag===5&&a.type==="form"?sv(a):Ei.r(i)}var Eo=typeof document>"u"?null:document;function j0(i,a,l){var c=Eo;if(c&&typeof a=="string"&&a){var v=An(a);v='link[rel="'+i+'"][href="'+v+'"]',typeof l=="string"&&(v+='[crossorigin="'+l+'"]'),B0.has(v)||(B0.add(v),i={rel:i,crossOrigin:l,href:a},c.querySelector(v)===null&&(a=c.createElement("link"),cn(a,"link",i),Ut(a),c.head.appendChild(a)))}}function dw(i){Ei.D(i),j0("dns-prefetch",i,null)}function fw(i,a){Ei.C(i,a),j0("preconnect",i,a)}function hw(i,a,l){Ei.L(i,a,l);var c=Eo;if(c&&i&&a){var v='link[rel="preload"][as="'+An(a)+'"]';a==="image"&&l&&l.imageSrcSet?(v+='[imagesrcset="'+An(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(v+='[imagesizes="'+An(l.imageSizes)+'"]')):v+='[href="'+An(i)+'"]';var T=v;switch(a){case"style":T=So(i);break;case"script":T=Ao(i)}is.has(T)||(i=b({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:i,as:a},l),is.set(T,i),c.querySelector(v)!==null||a==="style"&&c.querySelector(iu(T))||a==="script"&&c.querySelector(ru(T))||(a=c.createElement("link"),cn(a,"link",i),Ut(a),c.head.appendChild(a)))}}function mw(i,a){Ei.m(i,a);var l=Eo;if(l&&i){var c=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+An(c)+'"][href="'+An(i)+'"]',T=v;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Ao(i)}if(!is.has(T)&&(i=b({rel:"modulepreload",href:i},a),is.set(T,i),l.querySelector(v)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ru(T)))return}c=l.createElement("link"),cn(c,"link",i),Ut(c),l.head.appendChild(c)}}}function pw(i,a,l){Ei.S(i,a,l);var c=Eo;if(c&&i){var v=Ds(c).hoistableStyles,T=So(i);a=a||"default";var S=v.get(T);if(!S){var I={loading:0,preload:null};if(S=c.querySelector(iu(T)))I.loading=5;else{i=b({rel:"stylesheet",href:i,"data-precedence":a},l),(l=is.get(T))&&Im(i,l);var F=S=c.createElement("link");Ut(F),cn(F,"link",i),F._p=new Promise(function(W,ie){F.onload=W,F.onerror=ie}),F.addEventListener("load",function(){I.loading|=1}),F.addEventListener("error",function(){I.loading|=2}),I.loading|=4,ud(S,a,c)}S={type:"stylesheet",instance:S,count:1,state:I},v.set(T,S)}}}function gw(i,a){Ei.X(i,a);var l=Eo;if(l&&i){var c=Ds(l).hoistableScripts,v=Ao(i),T=c.get(v);T||(T=l.querySelector(ru(v)),T||(i=b({src:i,async:!0},a),(a=is.get(v))&&Nm(i,a),T=l.createElement("script"),Ut(T),cn(T,"link",i),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},c.set(v,T))}}function yw(i,a){Ei.M(i,a);var l=Eo;if(l&&i){var c=Ds(l).hoistableScripts,v=Ao(i),T=c.get(v);T||(T=l.querySelector(ru(v)),T||(i=b({src:i,async:!0,type:"module"},a),(a=is.get(v))&&Nm(i,a),T=l.createElement("script"),Ut(T),cn(T,"link",i),l.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},c.set(v,T))}}function q0(i,a,l,c){var v=(v=Fe.current)?ld(v):null;if(!v)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=So(l.href),l=Ds(v).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=So(l.href);var T=Ds(v).hoistableStyles,S=T.get(i);if(S||(v=v.ownerDocument||v,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,S),(T=v.querySelector(iu(i)))&&!T._p&&(S.instance=T,S.state.loading=5),is.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},is.set(i,l),T||vw(v,i,l,S.state))),a&&c===null)throw Error(s(528,""));return S}if(a&&c!==null)throw Error(s(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ao(l),l=Ds(v).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function So(i){return'href="'+An(i)+'"'}function iu(i){return'link[rel="stylesheet"]['+i+"]"}function H0(i){return b({},i,{"data-precedence":i.precedence,precedence:null})}function vw(i,a,l,c){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=i.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),cn(a,"link",l),Ut(a),i.head.appendChild(a))}function Ao(i){return'[src="'+An(i)+'"]'}function ru(i){return"script[async]"+i}function z0(i,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=i.querySelector('style[data-href~="'+An(l.href)+'"]');if(c)return a.instance=c,Ut(c),c;var v=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(i.ownerDocument||i).createElement("style"),Ut(c),cn(c,"style",v),ud(c,l.precedence,i),a.instance=c;case"stylesheet":v=So(l.href);var T=i.querySelector(iu(v));if(T)return a.state.loading|=4,a.instance=T,Ut(T),T;c=H0(l),(v=is.get(v))&&Im(c,v),T=(i.ownerDocument||i).createElement("link"),Ut(T);var S=T;return S._p=new Promise(function(I,F){S.onload=I,S.onerror=F}),cn(T,"link",c),a.state.loading|=4,ud(T,l.precedence,i),a.instance=T;case"script":return T=Ao(l.src),(v=i.querySelector(ru(T)))?(a.instance=v,Ut(v),v):(c=l,(v=is.get(T))&&(c=b({},l),Nm(c,v)),i=i.ownerDocument||i,v=i.createElement("script"),Ut(v),cn(v,"link",c),i.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(s(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,ud(c,l.precedence,i));return a.instance}function ud(i,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=c.length?c[c.length-1]:null,T=v,S=0;S<c.length;S++){var I=c[S];if(I.dataset.precedence===a)T=I;else if(T!==v)break}T?T.parentNode.insertBefore(i,T.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(i,a.firstChild))}function Im(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function Nm(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var cd=null;function G0(i,a,l){if(cd===null){var c=new Map,v=cd=new Map;v.set(l,c)}else v=cd,c=v.get(l),c||(c=new Map,v.set(l,c));if(c.has(i))return c;for(c.set(i,null),l=l.getElementsByTagName(i),v=0;v<l.length;v++){var T=l[v];if(!(T[Ns]||T[Ot]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var S=T.getAttribute(a)||"";S=i+S;var I=c.get(S);I?I.push(T):c.set(S,[T])}}return c}function $0(i,a,l){i=i.ownerDocument||i,i.head.insertBefore(l,a==="title"?i.querySelector("head > title"):null)}function _w(i,a,l){if(l===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function K0(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Tw(i,a,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var v=So(c.href),T=a.querySelector(iu(v));if(T){a=T._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=dd.bind(i),a.then(i,i)),l.state.loading|=4,l.instance=T,Ut(T);return}T=a.ownerDocument||a,c=H0(c),(v=is.get(v))&&Im(c,v),T=T.createElement("link"),Ut(T);var S=T;S._p=new Promise(function(I,F){S.onload=I,S.onerror=F}),cn(T,"link",c),l.instance=T}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=dd.bind(i),a.addEventListener("load",l),a.addEventListener("error",l))}}var Rm=0;function bw(i,a){return i.stylesheets&&i.count===0&&hd(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var c=setTimeout(function(){if(i.stylesheets&&hd(i,i.stylesheets),i.unsuspend){var T=i.unsuspend;i.unsuspend=null,T()}},6e4+a);0<i.imgBytes&&Rm===0&&(Rm=62500*tw());var v=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&hd(i,i.stylesheets),i.unsuspend)){var T=i.unsuspend;i.unsuspend=null,T()}},(i.imgBytes>Rm?50:800)+a);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(c),clearTimeout(v)}}:null}function dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var fd=null;function hd(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,fd=new Map,a.forEach(xw,i),fd=null,dd.call(i))}function xw(i,a){if(!(a.state.loading&4)){var l=fd.get(i);if(l)var c=l.get(null);else{l=new Map,fd.set(i,l);for(var v=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<v.length;T++){var S=v[T];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),c=S)}c&&l.set(null,c)}v=a.instance,S=v.getAttribute("data-precedence"),T=l.get(S)||c,T===c&&l.set(null,v),l.set(S,v),this.count++,c=dd.bind(this),v.addEventListener("load",c),v.addEventListener("error",c),T?T.parentNode.insertBefore(v,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(v,i.firstChild)),a.state.loading|=4}}var au={$$typeof:B,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function Ew(i,a,l,c,v,T,S,I,F){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Kt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kt(0),this.hiddenUpdates=Kt(null),this.identifierPrefix=c,this.onUncaughtError=v,this.onCaughtError=T,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function Y0(i,a,l,c,v,T,S,I,F,W,ie,oe){return i=new Ew(i,a,l,S,F,W,ie,oe,I),a=1,T===!0&&(a|=24),T=On(3,null,null,a),i.current=T,T.stateNode=i,a=uh(),a.refCount++,i.pooledCache=a,a.refCount++,T.memoizedState={element:c,isDehydrated:l,cache:a},hh(T),i}function J0(i){return i?(i=to,i):to}function Q0(i,a,l,c,v,T){v=J0(v),c.context===null?c.context=v:c.pendingContext=v,c=rr(a),c.payload={element:l},T=T===void 0?null:T,T!==null&&(c.callback=T),l=ar(i,c,a),l!==null&&(Dn(l,i,a),Ul(l,i,a))}function X0(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<a?l:a}}function Dm(i,a){X0(i,a),(i=i.alternate)&&X0(i,a)}function W0(i){if(i.tag===13||i.tag===31){var a=ra(i,67108864);a!==null&&Dn(a,i,67108864),Dm(i,67108864)}}function Z0(i){if(i.tag===13||i.tag===31){var a=qn();a=Kr(a);var l=ra(i,a);l!==null&&Dn(l,i,a),Dm(i,a)}}var md=!0;function Sw(i,a,l,c){var v=Z.T;Z.T=null;var T=Q.p;try{Q.p=2,Mm(i,a,l,c)}finally{Q.p=T,Z.T=v}}function Aw(i,a,l,c){var v=Z.T;Z.T=null;var T=Q.p;try{Q.p=8,Mm(i,a,l,c)}finally{Q.p=T,Z.T=v}}function Mm(i,a,l,c){if(md){var v=Pm(c);if(v===null)vm(i,a,c,pd,l),t_(i,c);else if(ww(v,i,a,l,c))c.stopPropagation();else if(t_(i,c),a&4&&-1<Cw.indexOf(i)){for(;v!==null;){var T=Kn(v);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var S=Gn(T.pendingLanes);if(S!==0){var I=T;for(I.pendingLanes|=2,I.entangledLanes|=2;S;){var F=1<<31-ce(S);I.entanglements[1]|=F,S&=~F}zs(T),(at&6)===0&&(Xc=rn()+500,eu(0))}}break;case 31:case 13:I=ra(T,2),I!==null&&Dn(I,T,2),Zc(),Dm(T,2)}if(T=Pm(c),T===null&&vm(i,a,c,pd,l),T===v)break;v=T}v!==null&&c.stopPropagation()}else vm(i,a,c,null,l)}}function Pm(i){return i=Yn(i),km(i)}var pd=null;function km(i){if(pd=null,i=Rs(i),i!==null){var a=o(i);if(a===null)i=null;else{var l=a.tag;if(l===13){if(i=u(a),i!==null)return i;i=null}else if(l===31){if(i=d(a),i!==null)return i;i=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return pd=i,null}function e_(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(si()){case Hr:return 2;case zi:return 8;case ws:case Fa:return 32;case zr:return 268435456;default:return 32}default:return 32}}var Lm=!1,yr=null,vr=null,_r=null,ou=new Map,lu=new Map,Tr=[],Cw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function t_(i,a){switch(i){case"focusin":case"focusout":yr=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":_r=null;break;case"pointerover":case"pointerout":ou.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":lu.delete(a.pointerId)}}function uu(i,a,l,c,v,T){return i===null||i.nativeEvent!==T?(i={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:T,targetContainers:[v]},a!==null&&(a=Kn(a),a!==null&&W0(a)),i):(i.eventSystemFlags|=c,a=i.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),i)}function ww(i,a,l,c,v){switch(a){case"focusin":return yr=uu(yr,i,a,l,c,v),!0;case"dragenter":return vr=uu(vr,i,a,l,c,v),!0;case"mouseover":return _r=uu(_r,i,a,l,c,v),!0;case"pointerover":var T=v.pointerId;return ou.set(T,uu(ou.get(T)||null,i,a,l,c,v)),!0;case"gotpointercapture":return T=v.pointerId,lu.set(T,uu(lu.get(T)||null,i,a,l,c,v)),!0}return!1}function n_(i){var a=Rs(i.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){i.blockedOn=a,us(i.priority,function(){Z0(l)});return}}else if(a===31){if(a=d(l),a!==null){i.blockedOn=a,us(i.priority,function(){Z0(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function gd(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var l=Pm(i.nativeEvent);if(l===null){l=i.nativeEvent;var c=new l.constructor(l.type,l);xl=c,l.target.dispatchEvent(c),xl=null}else return a=Kn(l),a!==null&&W0(a),i.blockedOn=l,!1;a.shift()}return!0}function s_(i,a,l){gd(i)&&l.delete(a)}function Iw(){Lm=!1,yr!==null&&gd(yr)&&(yr=null),vr!==null&&gd(vr)&&(vr=null),_r!==null&&gd(_r)&&(_r=null),ou.forEach(s_),lu.forEach(s_)}function yd(i,a){i.blockedOn===a&&(i.blockedOn=null,Lm||(Lm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Iw)))}var vd=null;function i_(i){vd!==i&&(vd=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){vd===i&&(vd=null);for(var a=0;a<i.length;a+=3){var l=i[a],c=i[a+1],v=i[a+2];if(typeof c!="function"){if(km(c||l)===null)continue;break}var T=Kn(l);T!==null&&(i.splice(a,3),a-=3,Ph(T,{pending:!0,data:v,method:l.method,action:c},c,v))}}))}function Co(i){function a(F){return yd(F,i)}yr!==null&&yd(yr,i),vr!==null&&yd(vr,i),_r!==null&&yd(_r,i),ou.forEach(a),lu.forEach(a);for(var l=0;l<Tr.length;l++){var c=Tr[l];c.blockedOn===i&&(c.blockedOn=null)}for(;0<Tr.length&&(l=Tr[0],l.blockedOn===null);)n_(l),l.blockedOn===null&&Tr.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var v=l[c],T=l[c+1],S=v[Wt]||null;if(typeof T=="function")S||i_(l);else if(S){var I=null;if(T&&T.hasAttribute("formAction")){if(v=T,S=T[Wt]||null)I=S.formAction;else if(km(v)!==null)continue}else I=S.action;typeof I=="function"?l[c+1]=I:(l.splice(c,3),c-=3),i_(l)}}}function r_(){function i(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(S){return v=S})},focusReset:"manual",scroll:"manual"})}function a(){v!==null&&(v(),v=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,v=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),v!==null&&(v(),v=null)}}}function Vm(i){this._internalRoot=i}_d.prototype.render=Vm.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(s(409));var l=a.current,c=qn();Q0(l,c,i,a,null,null)},_d.prototype.unmount=Vm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;Q0(i.current,2,null,i,null,null),Zc(),a[Is]=null}};function _d(i){this._internalRoot=i}_d.prototype.unstable_scheduleHydration=function(i){if(i){var a=Zu();i={blockedOn:null,target:i,priority:a};for(var l=0;l<Tr.length&&a!==0&&a<Tr[l].priority;l++);Tr.splice(l,0,i),l===0&&n_(i)}};var a_=e.version;if(a_!=="19.2.0")throw Error(s(527,a_,"19.2.0"));Q.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=f(a),i=i!==null?_(i):null,i=i===null?null:i.stateNode,i};var Nw={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{Sn=Td.inject(Nw),G=Td}catch{}}return du.createRoot=function(i,a){if(!r(i))throw Error(s(299));var l=!1,c="",v=hv,T=mv,S=pv;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(T=a.onCaughtError),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),a=Y0(i,1,!1,null,null,l,c,null,v,T,S,r_),i[Is]=a.current,ym(i),new Vm(a)},du.hydrateRoot=function(i,a,l){if(!r(i))throw Error(s(299));var c=!1,v="",T=hv,S=mv,I=pv,F=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(T=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(F=l.formState)),a=Y0(i,1,!0,a,l??null,c,v,F,T,S,I,r_),a.context=J0(null),l=a.current,c=qn(),c=Kr(c),v=rr(c),v.callback=null,ar(l,v,c),l=c,a.current.lanes=l,Xt(a,l),zs(a),i[Is]=a.current,ym(i),new _d(a)},du.version="19.2.0",du}var g_;function Fw(){if(g_)return Fm.exports;g_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fm.exports=Uw(),Fm.exports}var Bw=Fw();const jw=Ix(Bw),Nx=({darkMode:n,onToggle:e})=>p.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[p.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),p.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🌙":"☀️"})]}),qw={ar:{"app.title":"لوحة التحكم المالية | MASROF","developed.by":"Developed by K.A Team","add.transaction":"إضافة حركة",logout:"خروج","dark.mode":"الوضع المظلم",notifications:"الإشعارات","enable.notifications":"تفعيل الإشعارات",language:"العربية","tab.summary":"الملخص","tab.analysis":"التحليل","tab.transactions":"الحركات","tab.budget":"الميزانية","tab.investment":"الاستثمار","tab.ai.assistant":"المحلل الذكي","tab.settings":"الإعدادات","tab.cards":"إدارة البطاقات","tab.bank":"البنك","tab.installments":"الأقساط","tab.debts.loans":"الديون والقروض","card.debts.summary":"ملخص ديون البطاقات","card.bank.accounts":"ملخص الحسابات البنكية","card.financial.report":"تقرير مالي شامل","card.categories.summary":"ملخص الفئات",due:"المستحق",remaining:"المتبقي","total.debts":"إجمالي الديون","total.available":"إجمالي المتاح",deposits:"الإيداعات",withdrawals:"السحوبات","total.bank.balances":"إجمالي الأرصدة البنكية","total.income":"إجمالي الدخل","total.expenses":"إجمالي المصاريف",net:"الصافي",rent:"إيجار",groceries:"مواد تموينية",shopping:"تسوق",bills:"سداد فواتير",restaurants:"مطاعم",transport:"مواصلات",entertainment:"ترفيه",health:"صحة",education:"تعليم",other:"أخرى","al.ahli.snb":"الأهلي SNB","emirates.enbd":"الإمارات ENBD","al.ahli.bank":"البنك الاهلي","arab.bank":"البنك العربي",add:"إضافة",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",confirm:"تأكيد",close:"إغلاق",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",active:"نشط",inactive:"غير نشط",pending:"معلق",completed:"مكتمل",cancelled:"ملغي",january:"يناير",february:"فبراير",march:"مارس",april:"أبريل",may:"مايو",june:"يونيو",july:"يوليو",august:"أغسطس",september:"سبتمبر",october:"أكتوبر",november:"نوفمبر",december:"ديسمبر",sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت",sar:"ريال سعودي",usd:"دولار أمريكي",eur:"يورو",aed:"درهم إماراتي",today:"اليوم",yesterday:"أمس","this.week":"هذا الأسبوع","this.month":"هذا الشهر","this.year":"هذا العام","last.week":"الأسبوع الماضي","last.month":"الشهر الماضي","last.year":"العام الماضي",success:"نجح",error:"خطأ",warning:"تحذير",info:"معلومات",loading:"جاري التحميل...","no.data":"لا توجد بيانات","try.again":"حاول مرة أخرى","required.field":"هذا الحقل مطلوب","invalid.email":"البريد الإلكتروني غير صحيح","invalid.amount":"المبلغ غير صحيح","invalid.date":"التاريخ غير صحيح","debt.to.me":"ديون لي","debt.from.me":"ديون علي",loans:"قروض","add.debt":"إضافة دين","add.loan":"إضافة قرض",debtor:"المدين",creditor:"الدائن",lender:"المقرض",amount:"المبلغ",description:"الوصف",date:"التاريخ",status:"الحالة",source:"المصدر",reason:"السبب",installments:"أقساط","paid.installments":"أقساط مدفوعة","remaining.installments":"أقساط متبقية","next.payment":"الدفعة التالية","payment.date":"تاريخ الدفع","installment.amount":"مبلغ القسط","total.amount":"المبلغ الإجمالي",investment:"استثمار","current.value":"القيمة الحالية","initial.investment":"الاستثمار الأولي","profit.loss":"الربح/الخسارة","return.rate":"معدل العائد",budget:"ميزانية","budget.limit":"حد الميزانية",spent:"مصروف","remaining.budget":"الميزانية المتبقية","over.budget":"تجاوز الميزانية",reports:"تقارير","financial.report":"تقرير مالي","monthly.report":"تقرير شهري","yearly.report":"تقرير سنوي","category.report":"تقرير الفئات","income.report":"تقرير الدخل","expense.report":"تقرير المصروفات",settings:"الإعدادات",profile:"الملف الشخصي",account:"الحساب",privacy:"الخصوصية",security:"الأمان",backup:"نسخ احتياطي",restore:"استعادة","export.data":"تصدير البيانات","import.data":"استيراد البيانات","ai.assistant":"المساعد الذكي","ask.question":"اسأل سؤال","get.advice":"احصل على نصيحة","analyze.data":"تحليل البيانات","generate.report":"توليد تقرير",notification:"إشعار","payment.reminder":"تذكير دفع","budget.alert":"تنبيه الميزانية","low.balance":"رصيد منخفض","payment.due":"دفعة مستحقة","network.error":"خطأ في الشبكة","server.error":"خطأ في الخادم","auth.error":"خطأ في المصادقة","permission.error":"خطأ في الصلاحية","validation.error":"خطأ في التحقق","unknown.error":"خطأ غير معروف",details:"التفاصيل","cannot.delete":"لا يمكن الحذف","cannot.delete.category":"لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات","cannot.delete.transaction.type":"لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات","cannot.delete.payment.method":"لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات","restore.backup":"استعادة نسخة احتياطية","confirm.restore":"هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية","api.status":"حالة مفاتيح API"},en:{"app.title":"Financial Dashboard | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Add Transaction",logout:"Logout","dark.mode":"Dark Mode",notifications:"Notifications","enable.notifications":"Enable Notifications",language:"English","tab.summary":"Summary","tab.analysis":"Analysis","tab.transactions":"Transactions","tab.budget":"Budget","tab.investment":"Investment","tab.ai.assistant":"AI Assistant","tab.settings":"Settings","tab.cards":"Card Management","tab.bank":"Bank","tab.installments":"Installments","tab.debts.loans":"Debts & Loans","card.debts.summary":"Card Debts Summary","card.bank.accounts":"Bank Accounts Summary","card.financial.report":"Comprehensive Financial Report","card.categories.summary":"Categories Summary",due:"Due",remaining:"Remaining","total.debts":"Total Debts","total.available":"Total Available",deposits:"Deposits",withdrawals:"Withdrawals","total.bank.balances":"Total Bank Balances","total.income":"Total Income","total.expenses":"Total Expenses",net:"Net",rent:"Rent",groceries:"Groceries",shopping:"Shopping",bills:"Bill Payments",restaurants:"Restaurants",transport:"Transport",entertainment:"Entertainment",health:"Health",education:"Education",other:"Other","al.ahli.snb":"Al Ahli SNB","emirates.enbd":"Emirates ENBD","al.ahli.bank":"Al Ahli Bank","arab.bank":"Arab Bank",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",cancelled:"Cancelled",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sar:"Saudi Riyal",usd:"US Dollar",eur:"Euro",aed:"UAE Dirham",today:"Today",yesterday:"Yesterday","this.week":"This Week","this.month":"This Month","this.year":"This Year","last.week":"Last Week","last.month":"Last Month","last.year":"Last Year",success:"Success",error:"Error",warning:"Warning",info:"Info",loading:"Loading...","no.data":"No Data","try.again":"Try Again","required.field":"This field is required","invalid.email":"Invalid email address","invalid.amount":"Invalid amount","invalid.date":"Invalid date","debt.to.me":"Debts to Me","debt.from.me":"Debts from Me",loans:"Loans","add.debt":"Add Debt","add.loan":"Add Loan",debtor:"Debtor",creditor:"Creditor",lender:"Lender",amount:"Amount",description:"Description",date:"Date",status:"Status",source:"Source",reason:"Reason",installments:"Installments","paid.installments":"Paid Installments","remaining.installments":"Remaining Installments","next.payment":"Next Payment","payment.date":"Payment Date","installment.amount":"Installment Amount","total.amount":"Total Amount",investment:"Investment","current.value":"Current Value","initial.investment":"Initial Investment","profit.loss":"Profit/Loss","return.rate":"Return Rate",budget:"Budget","budget.limit":"Budget Limit",spent:"Spent","remaining.budget":"Remaining Budget","over.budget":"Over Budget",reports:"Reports","financial.report":"Financial Report","monthly.report":"Monthly Report","yearly.report":"Yearly Report","category.report":"Category Report","income.report":"Income Report","expense.report":"Expense Report",settings:"Settings",profile:"Profile",account:"Account",privacy:"Privacy",security:"Security",backup:"Backup",restore:"Restore","export.data":"Export Data","import.data":"Import Data","ai.assistant":"AI Assistant","ask.question":"Ask Question","get.advice":"Get Advice","analyze.data":"Analyze Data","generate.report":"Generate Report",notification:"Notification","payment.reminder":"Payment Reminder","budget.alert":"Budget Alert","low.balance":"Low Balance","payment.due":"Payment Due","network.error":"Network Error","server.error":"Server Error","auth.error":"Authentication Error","permission.error":"Permission Error","validation.error":"Validation Error","unknown.error":"Unknown Error",details:"Details","cannot.delete":"Cannot Delete","cannot.delete.category":"Cannot delete this category as it is used in some transactions","cannot.delete.transaction.type":"Cannot delete this transaction type as it is used in some transactions","cannot.delete.payment.method":"Cannot delete this payment method as it is used in some transactions","restore.backup":"Restore Backup","confirm.restore":"Are you sure? This will overwrite all your current data","api.status":"API Keys Status"}},Lt=(n,e="ar")=>qw[e][n]||n,Rx=({notifications:n,onToggle:e,language:t="ar"})=>{const[s,r]=fe.useState("default");fe.useEffect(()=>{"Notification"in window&&r(Notification.permission)},[]);const o=async()=>{if("Notification"in window){const u=await Notification.requestPermission();r(u)}};return p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"text-sm font-medium",children:Lt("notifications",t)}),p.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[p.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),p.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🔔":"🔕"})]}),s!=="granted"&&n&&p.jsx("button",{onClick:o,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:Lt("enable.notifications",t)})]})},ke=n=>typeof n=="string",fu=()=>{let n,e;const t=new Promise((s,r)=>{n=s,e=r});return t.resolve=n,t.reject=e,t},y_=n=>n==null?"":""+n,Hw=(n,e,t)=>{n.forEach(s=>{e[s]&&(t[s]=e[s])})},zw=/###/g,v_=n=>n&&n.indexOf("###")>-1?n.replace(zw,"."):n,__=n=>!n||ke(n),Tu=(n,e,t)=>{const s=ke(e)?e.split("."):e;let r=0;for(;r<s.length-1;){if(__(n))return{};const o=v_(s[r]);!n[o]&&t&&(n[o]=new t),Object.prototype.hasOwnProperty.call(n,o)?n=n[o]:n={},++r}return __(n)?{}:{obj:n,k:v_(s[r])}},T_=(n,e,t)=>{const{obj:s,k:r}=Tu(n,e,Object);if(s!==void 0||e.length===1){s[r]=t;return}let o=e[e.length-1],u=e.slice(0,e.length-1),d=Tu(n,u,Object);for(;d.obj===void 0&&u.length;)o=`${u[u.length-1]}.${o}`,u=u.slice(0,u.length-1),d=Tu(n,u,Object),d!=null&&d.obj&&typeof d.obj[`${d.k}.${o}`]<"u"&&(d.obj=void 0);d.obj[`${d.k}.${o}`]=t},Gw=(n,e,t,s)=>{const{obj:r,k:o}=Tu(n,e,Object);r[o]=r[o]||[],r[o].push(t)},qd=(n,e)=>{const{obj:t,k:s}=Tu(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,s))return t[s]},$w=(n,e,t)=>{const s=qd(n,t);return s!==void 0?s:qd(e,t)},Dx=(n,e,t)=>{for(const s in e)s!=="__proto__"&&s!=="constructor"&&(s in n?ke(n[s])||n[s]instanceof String||ke(e[s])||e[s]instanceof String?t&&(n[s]=e[s]):Dx(n[s],e[s],t):n[s]=e[s]);return n},wo=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Kw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Yw=n=>ke(n)?n.replace(/[&<>"'\/]/g,e=>Kw[e]):n;class Jw{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const s=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,s),this.regExpQueue.push(e),s}}const Qw=[" ",",","?","!",";"],Xw=new Jw(20),Ww=(n,e,t)=>{e=e||"",t=t||"";const s=Qw.filter(u=>e.indexOf(u)<0&&t.indexOf(u)<0);if(s.length===0)return!0;const r=Xw.getRegExp(`(${s.map(u=>u==="?"?"\\?":u).join("|")})`);let o=!r.test(n);if(!o){const u=n.indexOf(t);u>0&&!r.test(n.substring(0,u))&&(o=!0)}return o},op=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const s=e.split(t);let r=n;for(let o=0;o<s.length;){if(!r||typeof r!="object")return;let u,d="";for(let h=o;h<s.length;++h)if(h!==o&&(d+=t),d+=s[h],u=r[d],u!==void 0){if(["string","number","boolean"].indexOf(typeof u)>-1&&h<s.length-1)continue;o+=h-o+1;break}r=u}return r},Nu=n=>n==null?void 0:n.replace("_","-"),Zw={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,s;(s=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||s.call(t,console,e)}};let eI=class lp{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||Zw,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,s,r){return r&&!this.debug?null:(ke(e[0])&&(e[0]=`${s}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new lp(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new lp(this.logger,e)}};var $s=new eI;class pf{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(s=>{this.observers[s]||(this.observers[s]=new Map);const r=this.observers[s].get(t)||0;this.observers[s].set(t,r+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([r,o])=>{for(let u=0;u<o;u++)r(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([r,o])=>{for(let u=0;u<o;u++)r.apply(r,[e,...t])})}}class b_ extends pf{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,s,r={}){var f,_;const o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,u=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let d;e.indexOf(".")>-1?d=e.split("."):(d=[e,t],s&&(Array.isArray(s)?d.push(...s):ke(s)&&o?d.push(...s.split(o)):d.push(s)));const h=qd(this.data,d);return!h&&!t&&!s&&e.indexOf(".")>-1&&(e=d[0],t=d[1],s=d.slice(2).join(".")),h||!u||!ke(s)?h:op((_=(f=this.data)==null?void 0:f[e])==null?void 0:_[t],s,o)}addResource(e,t,s,r,o={silent:!1}){const u=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let d=[e,t];s&&(d=d.concat(u?s.split(u):s)),e.indexOf(".")>-1&&(d=e.split("."),r=t,t=d[1]),this.addNamespaces(t),T_(this.data,d,r),o.silent||this.emit("added",e,t,s,r)}addResources(e,t,s,r={silent:!1}){for(const o in s)(ke(s[o])||Array.isArray(s[o]))&&this.addResource(e,t,o,s[o],{silent:!0});r.silent||this.emit("added",e,t,s)}addResourceBundle(e,t,s,r,o,u={silent:!1,skipCopy:!1}){let d=[e,t];e.indexOf(".")>-1&&(d=e.split("."),r=s,s=t,t=d[1]),this.addNamespaces(t);let h=qd(this.data,d)||{};u.skipCopy||(s=JSON.parse(JSON.stringify(s))),r?Dx(h,s,o):h={...h,...s},T_(this.data,d,h),u.silent||this.emit("added",e,t,s)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(r=>t[r]&&Object.keys(t[r]).length>0)}toJSON(){return this.data}}var Mx={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,s,r){return n.forEach(o=>{var u;e=((u=this.processors[o])==null?void 0:u.process(e,t,s,r))??e}),e}};const Px=Symbol("i18next/PATH_KEY");function tI(){const n=[],e=Object.create(null);let t;return e.get=(s,r)=>{var o;return(o=t==null?void 0:t.revoke)==null||o.call(t),r===Px?n:(n.push(r),t=Proxy.revocable(s,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function up(n,e){const{[Px]:t}=n(tI());return t.join((e==null?void 0:e.keySeparator)??".")}const x_={},Hm=n=>!ke(n)&&typeof n!="boolean"&&typeof n!="number";class Hd extends pf{constructor(e,t={}){super(),Hw(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=$s.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const s={...t};if(e==null)return!1;const r=this.resolve(e,s);if((r==null?void 0:r.res)===void 0)return!1;const o=Hm(r.res);return!(s.returnObjects===!1&&o)}extractFromKey(e,t){let s=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const r=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const u=s&&e.indexOf(s)>-1,d=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Ww(e,s,r);if(u&&!d){const h=e.match(this.interpolator.nestingRegexp);if(h&&h.length>0)return{key:e,namespaces:ke(o)?[o]:o};const f=e.split(s);(s!==r||s===r&&this.options.ns.indexOf(f[0])>-1)&&(o=f.shift()),e=f.join(r)}return{key:e,namespaces:ke(o)?[o]:o}}translate(e,t,s){let r=typeof t=="object"?{...t}:t;if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),e==null)return"";typeof e=="function"&&(e=up(e,{...this.options,...r})),Array.isArray(e)||(e=[String(e)]);const o=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,u=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:d,namespaces:h}=this.extractFromKey(e[e.length-1],r),f=h[h.length-1];let _=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;_===void 0&&(_=":");const b=r.lng||this.language,x=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((b==null?void 0:b.toLowerCase())==="cimode")return x?o?{res:`${f}${_}${d}`,usedKey:d,exactUsedKey:d,usedLng:b,usedNS:f,usedParams:this.getUsedParamsDetails(r)}:`${f}${_}${d}`:o?{res:d,usedKey:d,exactUsedKey:d,usedLng:b,usedNS:f,usedParams:this.getUsedParamsDetails(r)}:d;const C=this.resolve(e,r);let M=C==null?void 0:C.res;const k=(C==null?void 0:C.usedKey)||d,V=(C==null?void 0:C.exactUsedKey)||d,$=["[object Number]","[object Function]","[object RegExp]"],U=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,B=!this.i18nFormat||this.i18nFormat.handleAsObject,K=r.count!==void 0&&!ke(r.count),se=Hd.hasDefaultValue(r),H=K?this.pluralResolver.getSuffix(b,r.count,r):"",R=r.ordinal&&K?this.pluralResolver.getSuffix(b,r.count,{ordinal:!1}):"",N=K&&!r.ordinal&&r.count===0,D=N&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${H}`]||r[`defaultValue${R}`]||r.defaultValue;let w=M;B&&!M&&se&&(w=D);const L=Hm(w),j=Object.prototype.toString.apply(w);if(B&&w&&L&&$.indexOf(j)<0&&!(ke(U)&&Array.isArray(w))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const O=this.options.returnedObjectHandler?this.options.returnedObjectHandler(k,w,{...r,ns:h}):`key '${d} (${this.language})' returned an object instead of string.`;return o?(C.res=O,C.usedParams=this.getUsedParamsDetails(r),C):O}if(u){const O=Array.isArray(w),Pe=O?[]:{},We=O?V:k;for(const Z in w)if(Object.prototype.hasOwnProperty.call(w,Z)){const Q=`${We}${u}${Z}`;se&&!M?Pe[Z]=this.translate(Q,{...r,defaultValue:Hm(D)?D[Z]:void 0,joinArrays:!1,ns:h}):Pe[Z]=this.translate(Q,{...r,joinArrays:!1,ns:h}),Pe[Z]===Q&&(Pe[Z]=w[Z])}M=Pe}}else if(B&&ke(U)&&Array.isArray(M))M=M.join(U),M&&(M=this.extendTranslation(M,e,r,s));else{let O=!1,Pe=!1;!this.isValidLookup(M)&&se&&(O=!0,M=D),this.isValidLookup(M)||(Pe=!0,M=d);const Z=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Pe?void 0:M,Q=se&&D!==M&&this.options.updateMissing;if(Pe||O||Q){if(this.logger.log(Q?"updateKey":"missingKey",b,f,d,Q?D:M),u){const q=this.resolve(d,{...r,keySeparator:!1});q&&q.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let he=[];const Ae=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Ae&&Ae[0])for(let q=0;q<Ae.length;q++)he.push(Ae[q]);else this.options.saveMissingTo==="all"?he=this.languageUtils.toResolveHierarchy(r.lng||this.language):he.push(r.lng||this.language);const Ce=(q,re,me)=>{var Ne;const ye=se&&me!==M?me:Z;this.options.missingKeyHandler?this.options.missingKeyHandler(q,f,re,ye,Q,r):(Ne=this.backendConnector)!=null&&Ne.saveMissing&&this.backendConnector.saveMissing(q,f,re,ye,Q,r),this.emit("missingKey",q,f,re,M)};this.options.saveMissing&&(this.options.saveMissingPlurals&&K?he.forEach(q=>{const re=this.pluralResolver.getSuffixes(q,r);N&&r[`defaultValue${this.options.pluralSeparator}zero`]&&re.indexOf(`${this.options.pluralSeparator}zero`)<0&&re.push(`${this.options.pluralSeparator}zero`),re.forEach(me=>{Ce([q],d+me,r[`defaultValue${me}`]||D)})}):Ce(he,d,D))}M=this.extendTranslation(M,e,r,C,s),Pe&&M===d&&this.options.appendNamespaceToMissingKey&&(M=`${f}${_}${d}`),(Pe||O)&&this.options.parseMissingKeyHandler&&(M=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${f}${_}${d}`:d,O?M:void 0,r))}return o?(C.res=M,C.usedParams=this.getUsedParamsDetails(r),C):M}extendTranslation(e,t,s,r,o){var h,f;if((h=this.i18nFormat)!=null&&h.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const _=ke(e)&&(((f=s==null?void 0:s.interpolation)==null?void 0:f.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let b;if(_){const C=e.match(this.interpolator.nestingRegexp);b=C&&C.length}let x=s.replace&&!ke(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(x={...this.options.interpolation.defaultVariables,...x}),e=this.interpolator.interpolate(e,x,s.lng||this.language||r.usedLng,s),_){const C=e.match(this.interpolator.nestingRegexp),M=C&&C.length;b<M&&(s.nest=!1)}!s.lng&&r&&r.res&&(s.lng=this.language||r.usedLng),s.nest!==!1&&(e=this.interpolator.nest(e,(...C)=>(o==null?void 0:o[0])===C[0]&&!s.context?(this.logger.warn(`It seems you are nesting recursively key: ${C[0]} in key: ${t[0]}`),null):this.translate(...C,t),s)),s.interpolation&&this.interpolator.reset()}const u=s.postProcess||this.options.postProcess,d=ke(u)?[u]:u;return e!=null&&(d!=null&&d.length)&&s.applyPostProcessor!==!1&&(e=Mx.handle(d,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),e}resolve(e,t={}){let s,r,o,u,d;return ke(e)&&(e=[e]),e.forEach(h=>{if(this.isValidLookup(s))return;const f=this.extractFromKey(h,t),_=f.key;r=_;let b=f.namespaces;this.options.fallbackNS&&(b=b.concat(this.options.fallbackNS));const x=t.count!==void 0&&!ke(t.count),C=x&&!t.ordinal&&t.count===0,M=t.context!==void 0&&(ke(t.context)||typeof t.context=="number")&&t.context!=="",k=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);b.forEach(V=>{var $,U;this.isValidLookup(s)||(d=V,!x_[`${k[0]}-${V}`]&&(($=this.utils)!=null&&$.hasLoadedNamespace)&&!((U=this.utils)!=null&&U.hasLoadedNamespace(d))&&(x_[`${k[0]}-${V}`]=!0,this.logger.warn(`key "${r}" for languages "${k.join(", ")}" won't get resolved as namespace "${d}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),k.forEach(B=>{var H;if(this.isValidLookup(s))return;u=B;const K=[_];if((H=this.i18nFormat)!=null&&H.addLookupKeys)this.i18nFormat.addLookupKeys(K,_,B,V,t);else{let R;x&&(R=this.pluralResolver.getSuffix(B,t.count,t));const N=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(t.ordinal&&R.indexOf(D)===0&&K.push(_+R.replace(D,this.options.pluralSeparator)),K.push(_+R),C&&K.push(_+N)),M){const w=`${_}${this.options.contextSeparator||"_"}${t.context}`;K.push(w),x&&(t.ordinal&&R.indexOf(D)===0&&K.push(w+R.replace(D,this.options.pluralSeparator)),K.push(w+R),C&&K.push(w+N))}}let se;for(;se=K.pop();)this.isValidLookup(s)||(o=se,s=this.getResource(B,V,se,t))}))})}),{res:s,usedKey:r,exactUsedKey:o,usedLng:u,usedNS:d}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,s,r={}){var o;return(o=this.i18nFormat)!=null&&o.getResource?this.i18nFormat.getResource(e,t,s,r):this.resourceStore.getResource(e,t,s,r)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=e.replace&&!ke(e.replace);let r=s?e.replace:e;if(s&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!s){r={...r};for(const o of t)delete r[o]}return r}static hasDefaultValue(e){const t="defaultValue";for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t===s.substring(0,t.length)&&e[s]!==void 0)return!0;return!1}}class E_{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=$s.create("languageUtils")}getScriptPartFromCode(e){if(e=Nu(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Nu(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(ke(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(s=>{if(t)return;const r=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(r))&&(t=r)}),!t&&this.options.supportedLngs&&e.forEach(s=>{if(t)return;const r=this.getScriptPartFromCode(s);if(this.isSupportedCode(r))return t=r;const o=this.getLanguagePartFromCode(s);if(this.isSupportedCode(o))return t=o;t=this.options.supportedLngs.find(u=>{if(u===o)return u;if(!(u.indexOf("-")<0&&o.indexOf("-")<0)&&(u.indexOf("-")>0&&o.indexOf("-")<0&&u.substring(0,u.indexOf("-"))===o||u.indexOf(o)===0&&o.length>1))return u})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),ke(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let s=e[t];return s||(s=e[this.getScriptPartFromCode(t)]),s||(s=e[this.formatLanguageCode(t)]),s||(s=e[this.getLanguagePartFromCode(t)]),s||(s=e.default),s||[]}toResolveHierarchy(e,t){const s=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),r=[],o=u=>{u&&(this.isSupportedCode(u)?r.push(u):this.logger.warn(`rejecting language code not found in supportedLngs: ${u}`))};return ke(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):ke(e)&&o(this.formatLanguageCode(e)),s.forEach(u=>{r.indexOf(u)<0&&o(this.formatLanguageCode(u))}),r}}const S_={zero:0,one:1,two:2,few:3,many:4,other:5},A_={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class nI{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=$s.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const s=Nu(e==="dev"?"en":e),r=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:s,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let u;try{u=new Intl.PluralRules(s,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),A_;if(!e.match(/-|_/))return A_;const h=this.languageUtils.getLanguagePartFromCode(e);u=this.getRule(h,t)}return this.pluralRulesCache[o]=u,u}needsPlural(e,t={}){let s=this.getRule(e,t);return s||(s=this.getRule("dev",t)),(s==null?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,s={}){return this.getSuffixes(e,s).map(r=>`${t}${r}`)}getSuffixes(e,t={}){let s=this.getRule(e,t);return s||(s=this.getRule("dev",t)),s?s.resolvedOptions().pluralCategories.sort((r,o)=>S_[r]-S_[o]).map(r=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,t,s={}){const r=this.getRule(e,s);return r?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,s))}}const C_=(n,e,t,s=".",r=!0)=>{let o=$w(n,e,t);return!o&&r&&ke(t)&&(o=op(n,t,s),o===void 0&&(o=op(e,t,s))),o},zm=n=>n.replace(/\$/g,"$$$$");class sI{constructor(e={}){var t;this.logger=$s.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(s=>s),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:s,useRawValueToEscape:r,prefix:o,prefixEscaped:u,suffix:d,suffixEscaped:h,formatSeparator:f,unescapeSuffix:_,unescapePrefix:b,nestingPrefix:x,nestingPrefixEscaped:C,nestingSuffix:M,nestingSuffixEscaped:k,nestingOptionsSeparator:V,maxReplaces:$,alwaysFormat:U}=e.interpolation;this.escape=t!==void 0?t:Yw,this.escapeValue=s!==void 0?s:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=o?wo(o):u||"{{",this.suffix=d?wo(d):h||"}}",this.formatSeparator=f||",",this.unescapePrefix=_?"":b||"-",this.unescapeSuffix=this.unescapePrefix?"":_||"",this.nestingPrefix=x?wo(x):C||wo("$t("),this.nestingSuffix=M?wo(M):k||wo(")"),this.nestingOptionsSeparator=V||",",this.maxReplaces=$||1e3,this.alwaysFormat=U!==void 0?U:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,s)=>(t==null?void 0:t.source)===s?(t.lastIndex=0,t):new RegExp(s,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,s,r){var C;let o,u,d;const h=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=M=>{if(M.indexOf(this.formatSeparator)<0){const U=C_(t,h,M,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(U,void 0,s,{...r,...t,interpolationkey:M}):U}const k=M.split(this.formatSeparator),V=k.shift().trim(),$=k.join(this.formatSeparator).trim();return this.format(C_(t,h,V,this.options.keySeparator,this.options.ignoreJSONStructure),$,s,{...r,...t,interpolationkey:V})};this.resetRegExp();const _=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,b=((C=r==null?void 0:r.interpolation)==null?void 0:C.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:M=>zm(M)},{regex:this.regexp,safeValue:M=>this.escapeValue?zm(this.escape(M)):zm(M)}].forEach(M=>{for(d=0;o=M.regex.exec(e);){const k=o[1].trim();if(u=f(k),u===void 0)if(typeof _=="function"){const $=_(e,o,r);u=ke($)?$:""}else if(r&&Object.prototype.hasOwnProperty.call(r,k))u="";else if(b){u=o[0];continue}else this.logger.warn(`missed to pass in variable ${k} for interpolating ${e}`),u="";else!ke(u)&&!this.useRawValueToEscape&&(u=y_(u));const V=M.safeValue(u);if(e=e.replace(o[0],V),b?(M.regex.lastIndex+=u.length,M.regex.lastIndex-=o[0].length):M.regex.lastIndex=0,d++,d>=this.maxReplaces)break}}),e}nest(e,t,s={}){let r,o,u;const d=(h,f)=>{const _=this.nestingOptionsSeparator;if(h.indexOf(_)<0)return h;const b=h.split(new RegExp(`${_}[ ]*{`));let x=`{${b[1]}`;h=b[0],x=this.interpolate(x,u);const C=x.match(/'/g),M=x.match(/"/g);(((C==null?void 0:C.length)??0)%2===0&&!M||M.length%2!==0)&&(x=x.replace(/'/g,'"'));try{u=JSON.parse(x),f&&(u={...f,...u})}catch(k){return this.logger.warn(`failed parsing options string in nesting for key ${h}`,k),`${h}${_}${x}`}return u.defaultValue&&u.defaultValue.indexOf(this.prefix)>-1&&delete u.defaultValue,h};for(;r=this.nestingRegexp.exec(e);){let h=[];u={...s},u=u.replace&&!ke(u.replace)?u.replace:u,u.applyPostProcessor=!1,delete u.defaultValue;const f=/{.*}/.test(r[1])?r[1].lastIndexOf("}")+1:r[1].indexOf(this.formatSeparator);if(f!==-1&&(h=r[1].slice(f).split(this.formatSeparator).map(_=>_.trim()).filter(Boolean),r[1]=r[1].slice(0,f)),o=t(d.call(this,r[1].trim(),u),u),o&&r[0]===e&&!ke(o))return o;ke(o)||(o=y_(o)),o||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),o=""),h.length&&(o=h.reduce((_,b)=>this.format(_,b,s.lng,{...s,interpolationkey:r[1].trim()}),o.trim())),e=e.replace(r[0],o),this.regexp.lastIndex=0}return e}}const iI=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const s=n.split("(");e=s[0].toLowerCase().trim();const r=s[1].substring(0,s[1].length-1);e==="currency"&&r.indexOf(":")<0?t.currency||(t.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?t.range||(t.range=r.trim()):r.split(";").forEach(u=>{if(u){const[d,...h]=u.split(":"),f=h.join(":").trim().replace(/^'+|'+$/g,""),_=d.trim();t[_]||(t[_]=f),f==="false"&&(t[_]=!1),f==="true"&&(t[_]=!0),isNaN(f)||(t[_]=parseInt(f,10))}})}return{formatName:e,formatOptions:t}},w_=n=>{const e={};return(t,s,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o={...o,[r.interpolationkey]:void 0});const u=s+JSON.stringify(o);let d=e[u];return d||(d=n(Nu(s),r),e[u]=d),d(t)}},rI=n=>(e,t,s)=>n(Nu(t),s)(e);class aI{constructor(e={}){this.logger=$s.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const s=t.cacheInBuiltFormats?w_:rI;this.formats={number:s((r,o)=>{const u=new Intl.NumberFormat(r,{...o});return d=>u.format(d)}),currency:s((r,o)=>{const u=new Intl.NumberFormat(r,{...o,style:"currency"});return d=>u.format(d)}),datetime:s((r,o)=>{const u=new Intl.DateTimeFormat(r,{...o});return d=>u.format(d)}),relativetime:s((r,o)=>{const u=new Intl.RelativeTimeFormat(r,{...o});return d=>u.format(d,o.range||"day")}),list:s((r,o)=>{const u=new Intl.ListFormat(r,{...o});return d=>u.format(d)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=w_(t)}format(e,t,s,r={}){const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(d=>d.indexOf(")")>-1)){const d=o.findIndex(h=>h.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,d)].join(this.formatSeparator)}return o.reduce((d,h)=>{var b;const{formatName:f,formatOptions:_}=iI(h);if(this.formats[f]){let x=d;try{const C=((b=r==null?void 0:r.formatParams)==null?void 0:b[r.interpolationkey])||{},M=C.locale||C.lng||r.locale||r.lng||s;x=this.formats[f](d,M,{..._,...r,...C})}catch(C){this.logger.warn(C)}return x}else this.logger.warn(`there was no format function for ${f}`);return d},e)}}const oI=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class lI extends pf{constructor(e,t,s,r={}){var o,u;super(),this.backend=e,this.store=t,this.services=s,this.languageUtils=s.languageUtils,this.options=r,this.logger=$s.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(u=(o=this.backend)==null?void 0:o.init)==null||u.call(o,s,r.backend,r)}queueLoad(e,t,s,r){const o={},u={},d={},h={};return e.forEach(f=>{let _=!0;t.forEach(b=>{const x=`${f}|${b}`;!s.reload&&this.store.hasResourceBundle(f,b)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?u[x]===void 0&&(u[x]=!0):(this.state[x]=1,_=!1,u[x]===void 0&&(u[x]=!0),o[x]===void 0&&(o[x]=!0),h[b]===void 0&&(h[b]=!0)))}),_||(d[f]=!0)}),(Object.keys(o).length||Object.keys(u).length)&&this.queue.push({pending:u,pendingCount:Object.keys(u).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(u),toLoadLanguages:Object.keys(d),toLoadNamespaces:Object.keys(h)}}loaded(e,t,s){const r=e.split("|"),o=r[0],u=r[1];t&&this.emit("failedLoading",o,u,t),!t&&s&&this.store.addResourceBundle(o,u,s,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&s&&(this.state[e]=0);const d={};this.queue.forEach(h=>{Gw(h.loaded,[o],u),oI(h,e),t&&h.errors.push(t),h.pendingCount===0&&!h.done&&(Object.keys(h.loaded).forEach(f=>{d[f]||(d[f]={});const _=h.loaded[f];_.length&&_.forEach(b=>{d[f][b]===void 0&&(d[f][b]=!0)})}),h.done=!0,h.errors.length?h.callback(h.errors):h.callback())}),this.emit("loaded",d),this.queue=this.queue.filter(h=>!h.done)}read(e,t,s,r=0,o=this.retryTimeout,u){if(!e.length)return u(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:s,tried:r,wait:o,callback:u});return}this.readingCalls++;const d=(f,_)=>{if(this.readingCalls--,this.waitingReads.length>0){const b=this.waitingReads.shift();this.read(b.lng,b.ns,b.fcName,b.tried,b.wait,b.callback)}if(f&&_&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,s,r+1,o*2,u)},o);return}u(f,_)},h=this.backend[s].bind(this.backend);if(h.length===2){try{const f=h(e,t);f&&typeof f.then=="function"?f.then(_=>d(null,_)).catch(d):d(null,f)}catch(f){d(f)}return}return h(e,t,d)}prepareLoading(e,t,s={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();ke(e)&&(e=this.languageUtils.toResolveHierarchy(e)),ke(t)&&(t=[t]);const o=this.queueLoad(e,t,s,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach(u=>{this.loadOne(u)})}load(e,t,s){this.prepareLoading(e,t,{},s)}reload(e,t,s){this.prepareLoading(e,t,{reload:!0},s)}loadOne(e,t=""){const s=e.split("|"),r=s[0],o=s[1];this.read(r,o,"read",void 0,void 0,(u,d)=>{u&&this.logger.warn(`${t}loading namespace ${o} for language ${r} failed`,u),!u&&d&&this.logger.log(`${t}loaded namespace ${o} for language ${r}`,d),this.loaded(e,u,d)})}saveMissing(e,t,s,r,o,u={},d=()=>{}){var h,f,_,b,x;if((f=(h=this.services)==null?void 0:h.utils)!=null&&f.hasLoadedNamespace&&!((b=(_=this.services)==null?void 0:_.utils)!=null&&b.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${s}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if((x=this.backend)!=null&&x.create){const C={...u,isUpdate:o},M=this.backend.create.bind(this.backend);if(M.length<6)try{let k;M.length===5?k=M(e,t,s,r,C):k=M(e,t,s,r),k&&typeof k.then=="function"?k.then(V=>d(null,V)).catch(d):d(null,k)}catch(k){d(k)}else M(e,t,s,r,d,C)}!e||!e[0]||this.store.addResource(e[0],t,s,r)}}}const I_=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),ke(n[1])&&(e.defaultValue=n[1]),ke(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(s=>{e[s]=t[s]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),N_=n=>{var e,t;return ke(n.ns)&&(n.ns=[n.ns]),ke(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),ke(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},bd=()=>{},uI=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class Ru extends pf{constructor(e={},t){if(super(),this.options=N_(e),this.services={},this.logger=$s,this.modules={external:[]},uI(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(ke(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const s=I_();this.options={...s,...this.options,...N_(e)},this.options.interpolation={...s.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?$s.init(r(this.modules.logger),this.options):$s.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=aI;const _=new E_(this.options);this.store=new b_(this.options.resources,this.options);const b=this.services;b.logger=$s,b.resourceStore=this.store,b.languageUtils=_,b.pluralResolver=new nI(_,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),f&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(b.formatter=r(f),b.formatter.init&&b.formatter.init(b,this.options),this.options.interpolation.format=b.formatter.format.bind(b.formatter)),b.interpolator=new sI(this.options),b.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},b.backendConnector=new lI(r(this.modules.backend),b.resourceStore,b,this.options),b.backendConnector.on("*",(C,...M)=>{this.emit(C,...M)}),this.modules.languageDetector&&(b.languageDetector=r(this.modules.languageDetector),b.languageDetector.init&&b.languageDetector.init(b,this.options.detection,this.options)),this.modules.i18nFormat&&(b.i18nFormat=r(this.modules.i18nFormat),b.i18nFormat.init&&b.i18nFormat.init(this)),this.translator=new Hd(this.services,this.options),this.translator.on("*",(C,...M)=>{this.emit(C,...M)}),this.modules.external.forEach(C=>{C.init&&C.init(this)})}if(this.format=this.options.interpolation.format,t||(t=bd),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=(..._)=>this.store[f](..._)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=(..._)=>(this.store[f](..._),this)});const d=fu(),h=()=>{const f=(_,b)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),d.resolve(b),t(_,b)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?h():setTimeout(h,0),d}loadResources(e,t=bd){var o,u;let s=t;const r=ke(e)?e:this.language;if(typeof e=="function"&&(s=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const d=[],h=f=>{if(!f||f==="cimode")return;this.services.languageUtils.toResolveHierarchy(f).forEach(b=>{b!=="cimode"&&d.indexOf(b)<0&&d.push(b)})};r?h(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(_=>h(_)),(u=(o=this.options.preload)==null?void 0:o.forEach)==null||u.call(o,f=>h(f)),this.services.backendConnector.load(d,this.options.ns,f=>{!f&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(f)})}else s(null)}reloadResources(e,t,s){const r=fu();return typeof e=="function"&&(s=e,e=void 0),typeof t=="function"&&(s=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),s||(s=bd),this.services.backendConnector.reload(e,t,o=>{r.resolve(),s(o)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Mx.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const s=this.languages[t];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const s=fu();this.emit("languageChanging",e);const r=d=>{this.language=d,this.languages=this.services.languageUtils.toResolveHierarchy(d),this.resolvedLanguage=void 0,this.setResolvedLanguage(d)},o=(d,h)=>{h?this.isLanguageChangingTo===e&&(r(h),this.translator.changeLanguage(h),this.isLanguageChangingTo=void 0,this.emit("languageChanged",h),this.logger.log("languageChanged",h)):this.isLanguageChangingTo=void 0,s.resolve((...f)=>this.t(...f)),t&&t(d,(...f)=>this.t(...f))},u=d=>{var _,b;!e&&!d&&this.services.languageDetector&&(d=[]);const h=ke(d)?d:d&&d[0],f=this.store.hasLanguageSomeTranslations(h)?h:this.services.languageUtils.getBestMatchFromCodes(ke(d)?[d]:d);f&&(this.language||r(f),this.translator.language||this.translator.changeLanguage(f),(b=(_=this.services.languageDetector)==null?void 0:_.cacheUserLanguage)==null||b.call(_,f)),this.loadResources(f,x=>{o(x,f)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?u(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(u):this.services.languageDetector.detect(u):u(e),s}getFixedT(e,t,s){const r=(o,u,...d)=>{let h;typeof u!="object"?h=this.options.overloadTranslationOptionHandler([o,u].concat(d)):h={...u},h.lng=h.lng||r.lng,h.lngs=h.lngs||r.lngs,h.ns=h.ns||r.ns,h.keyPrefix!==""&&(h.keyPrefix=h.keyPrefix||s||r.keyPrefix);const f=this.options.keySeparator||".";let _;return h.keyPrefix&&Array.isArray(o)?_=o.map(b=>(typeof b=="function"&&(b=up(b,{...this.options,...u})),`${h.keyPrefix}${f}${b}`)):(typeof o=="function"&&(o=up(o,{...this.options,...u})),_=h.keyPrefix?`${h.keyPrefix}${f}${o}`:o),this.t(_,h)};return ke(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=s,r}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=t.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const u=(d,h)=>{const f=this.services.backendConnector.state[`${d}|${h}`];return f===-1||f===0||f===2};if(t.precheck){const d=t.precheck(this,u);if(d!==void 0)return d}return!!(this.hasResourceBundle(s,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||u(s,e)&&(!r||u(o,e)))}loadNamespaces(e,t){const s=fu();return this.options.ns?(ke(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{s.resolve(),t&&t(r)}),s):(t&&t(),Promise.resolve())}loadLanguages(e,t){const s=fu();ke(e)&&(e=[e]);const r=this.options.preload||[],o=e.filter(u=>r.indexOf(u)<0&&this.services.languageUtils.isSupportedCode(u));return o.length?(this.options.preload=r.concat(o),this.loadResources(u=>{s.resolve(),t&&t(u)}),s):(t&&t(),Promise.resolve())}dir(e){var r,o;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const u=new Intl.Locale(e);if(u&&u.getTextInfo){const d=u.getTextInfo();if(d&&d.direction)return d.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=((o=this.services)==null?void 0:o.languageUtils)||new E_(I_());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(s.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new Ru(e,t)}cloneInstance(e={},t=bd){const s=e.forkResourceStore;s&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},o=new Ru(r);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(d=>{o[d]=this[d]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},s){const d=Object.keys(this.store.data).reduce((h,f)=>(h[f]={...this.store.data[f]},h[f]=Object.keys(h[f]).reduce((_,b)=>(_[b]={...h[f][b]},_),h[f]),h),{});o.store=new b_(d,r),o.services.resourceStore=o.store}return o.translator=new Hd(o.services,r),o.translator.on("*",(d,...h)=>{o.emit(d,...h)}),o.init(r,t),o.translator.options=r,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Tn=Ru.createInstance();Tn.createInstance=Ru.createInstance;Tn.createInstance;Tn.dir;Tn.init;Tn.loadResources;Tn.reloadResources;Tn.use;Tn.changeLanguage;Tn.getFixedT;Tn.t;Tn.exists;Tn.setDefaultNamespace;Tn.hasLoadedNamespace;Tn.loadNamespaces;Tn.loadLanguages;const cI=(n,e,t,s)=>{var o,u,d,h;const r=[t,{code:e,...s||{}}];if((u=(o=n==null?void 0:n.services)==null?void 0:o.logger)!=null&&u.forward)return n.services.logger.forward(r,"warn","react-i18next::",!0);xa(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(h=(d=n==null?void 0:n.services)==null?void 0:d.logger)!=null&&h.warn?n.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},R_={},cp=(n,e,t,s)=>{xa(t)&&R_[t]||(xa(t)&&(R_[t]=new Date),cI(n,e,t,s))},kx=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},dp=(n,e,t)=>{n.loadNamespaces(e,kx(n,t))},D_=(n,e,t,s)=>{if(xa(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return dp(n,t,s);t.forEach(r=>{n.options.ns.indexOf(r)<0&&n.options.ns.push(r)}),n.loadLanguages(e,kx(n,s))},dI=(n,e,t={})=>!e.languages||!e.languages.length?(cp(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(s,r)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!r(s.isLanguageChangingTo,n))return!1}}),xa=n=>typeof n=="string",fI=n=>typeof n=="object"&&n!==null,hI=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,mI={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},pI=n=>mI[n],gI=n=>n.replace(hI,pI);let fp={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:gI};const yI=(n={})=>{fp={...fp,...n}},vI=()=>fp;let Lx;const _I=n=>{Lx=n},TI=()=>Lx,bI={type:"3rdParty",init(n){yI(n.options.react),_I(n)}},xI=fe.createContext();class EI{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const SI=(n,e)=>{const t=fe.useRef();return fe.useEffect(()=>{t.current=n},[n,e]),t.current},Vx=(n,e,t,s)=>n.getFixedT(e,t,s),AI=(n,e,t,s)=>fe.useCallback(Vx(n,e,t,s),[n,e,t,s]),gf=(n,e={})=>{var K,se,H,R;const{i18n:t}=e,{i18n:s,defaultNS:r}=fe.useContext(xI)||{},o=t||s||TI();if(o&&!o.reportNamespaces&&(o.reportNamespaces=new EI),!o){cp(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const N=(w,L)=>xa(L)?L:fI(L)&&xa(L.defaultValue)?L.defaultValue:Array.isArray(w)?w[w.length-1]:w,D=[N,{},!1];return D.t=N,D.i18n={},D.ready=!1,D}(K=o.options.react)!=null&&K.wait&&cp(o,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const u={...vI(),...o.options.react,...e},{useSuspense:d,keyPrefix:h}=u;let f=r||((se=o.options)==null?void 0:se.defaultNS);f=xa(f)?[f]:f||["translation"],(R=(H=o.reportNamespaces).addUsedNamespaces)==null||R.call(H,f);const _=(o.isInitialized||o.initializedStoreOnce)&&f.every(N=>dI(N,o,u)),b=AI(o,e.lng||null,u.nsMode==="fallback"?f:f[0],h),x=()=>b,C=()=>Vx(o,e.lng||null,u.nsMode==="fallback"?f:f[0],h),[M,k]=fe.useState(x);let V=f.join();e.lng&&(V=`${e.lng}${V}`);const $=SI(V),U=fe.useRef(!0);fe.useEffect(()=>{const{bindI18n:N,bindI18nStore:D}=u;U.current=!0,!_&&!d&&(e.lng?D_(o,e.lng,f,()=>{U.current&&k(C)}):dp(o,f,()=>{U.current&&k(C)})),_&&$&&$!==V&&U.current&&k(C);const w=()=>{U.current&&k(C)};return N&&(o==null||o.on(N,w)),D&&(o==null||o.store.on(D,w)),()=>{U.current=!1,o&&N&&(N==null||N.split(" ").forEach(L=>o.off(L,w))),D&&o&&D.split(" ").forEach(L=>o.store.off(L,w))}},[o,V]),fe.useEffect(()=>{U.current&&_&&k(x)},[o,h,_]);const B=[M,o,_];if(B.t=M,B.i18n=o,B.ready=_,_||!_&&!d)return B;throw new Promise(N=>{e.lng?D_(o,e.lng,f,()=>N()):dp(o,f,()=>N())})},{slice:CI,forEach:wI}=[];function II(n){return wI.call(CI.call(arguments,1),e=>{if(e)for(const t in e)n[t]===void 0&&(n[t]=e[t])}),n}function NI(n){return typeof n!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(n))}const M_=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,RI=function(n,e){const s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},r=encodeURIComponent(e);let o=`${n}=${r}`;if(s.maxAge>0){const u=s.maxAge-0;if(Number.isNaN(u))throw new Error("maxAge should be a Number");o+=`; Max-Age=${Math.floor(u)}`}if(s.domain){if(!M_.test(s.domain))throw new TypeError("option domain is invalid");o+=`; Domain=${s.domain}`}if(s.path){if(!M_.test(s.path))throw new TypeError("option path is invalid");o+=`; Path=${s.path}`}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+=`; Expires=${s.expires.toUTCString()}`}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s.partitioned&&(o+="; Partitioned"),o},P_={create(n,e,t,s){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+t*60*1e3)),s&&(r.domain=s),document.cookie=RI(n,e,r)},read(n){const e=`${n}=`,t=document.cookie.split(";");for(let s=0;s<t.length;s++){let r=t[s];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return r.substring(e.length,r.length)}return null},remove(n,e){this.create(n,"",-1,e)}};var DI={name:"cookie",lookup(n){let{lookupCookie:e}=n;if(e&&typeof document<"u")return P_.read(e)||void 0},cacheUserLanguage(n,e){let{lookupCookie:t,cookieMinutes:s,cookieDomain:r,cookieOptions:o}=e;t&&typeof document<"u"&&P_.create(t,n,s,r,o)}},MI={name:"querystring",lookup(n){var s;let{lookupQuerystring:e}=n,t;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&((s=window.location.hash)==null?void 0:s.indexOf("?"))>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const u=r.substring(1).split("&");for(let d=0;d<u.length;d++){const h=u[d].indexOf("=");h>0&&u[d].substring(0,h)===e&&(t=u[d].substring(h+1))}}return t}},PI={name:"hash",lookup(n){var r;let{lookupHash:e,lookupFromHashIndex:t}=n,s;if(typeof window<"u"){const{hash:o}=window.location;if(o&&o.length>2){const u=o.substring(1);if(e){const d=u.split("&");for(let h=0;h<d.length;h++){const f=d[h].indexOf("=");f>0&&d[h].substring(0,f)===e&&(s=d[h].substring(f+1))}}if(s)return s;if(!s&&t>-1){const d=o.match(/\/([a-zA-Z-]*)/g);return Array.isArray(d)?(r=d[typeof t=="number"?t:0])==null?void 0:r.replace("/",""):void 0}}}return s}};let Io=null;const k_=()=>{if(Io!==null)return Io;try{if(Io=typeof window<"u"&&window.localStorage!==null,!Io)return!1;const n="i18next.translate.boo";window.localStorage.setItem(n,"foo"),window.localStorage.removeItem(n)}catch{Io=!1}return Io};var kI={name:"localStorage",lookup(n){let{lookupLocalStorage:e}=n;if(e&&k_())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupLocalStorage:t}=e;t&&k_()&&window.localStorage.setItem(t,n)}};let No=null;const L_=()=>{if(No!==null)return No;try{if(No=typeof window<"u"&&window.sessionStorage!==null,!No)return!1;const n="i18next.translate.boo";window.sessionStorage.setItem(n,"foo"),window.sessionStorage.removeItem(n)}catch{No=!1}return No};var LI={name:"sessionStorage",lookup(n){let{lookupSessionStorage:e}=n;if(e&&L_())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupSessionStorage:t}=e;t&&L_()&&window.sessionStorage.setItem(t,n)}},VI={name:"navigator",lookup(n){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:s,language:r}=navigator;if(t)for(let o=0;o<t.length;o++)e.push(t[o]);s&&e.push(s),r&&e.push(r)}return e.length>0?e:void 0}},OI={name:"htmlTag",lookup(n){let{htmlTag:e}=n,t;const s=e||(typeof document<"u"?document.documentElement:null);return s&&typeof s.getAttribute=="function"&&(t=s.getAttribute("lang")),t}},UI={name:"path",lookup(n){var r;let{lookupFromPathIndex:e}=n;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?(r=t[typeof e=="number"?e:0])==null?void 0:r.replace("/",""):void 0}},FI={name:"subdomain",lookup(n){var r,o;let{lookupFromSubdomainIndex:e}=n;const t=typeof e=="number"?e+1:1,s=typeof window<"u"&&((o=(r=window.location)==null?void 0:r.hostname)==null?void 0:o.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(s)return s[t]}};let Ox=!1;try{document.cookie,Ox=!0}catch{}const Ux=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Ox||Ux.splice(1,1);const BI=()=>({order:Ux,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:n=>n});class Fx{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=II(t,this.options||{},BI()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=r=>r.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(DI),this.addDetector(MI),this.addDetector(kI),this.addDetector(LI),this.addDetector(VI),this.addDetector(OI),this.addDetector(UI),this.addDetector(FI),this.addDetector(PI)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(s=>{if(this.detectors[s]){let r=this.detectors[s].lookup(this.options);r&&typeof r=="string"&&(r=[r]),r&&(t=t.concat(r))}}),t=t.filter(s=>s!=null&&!NI(s)).map(s=>this.options.convertDetectedLanguage(s)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(s=>{this.detectors[s]&&this.detectors[s].cacheUserLanguage(e,this.options)}))}}Fx.type="languageDetector";const jI={title:"لوحة التحكم المالية | MASROF",developedBy:"تم التطوير بواسطة فريق K.A",loading:"جاري التحميل...",saving:"جاري الحفظ...",error:"خطأ",success:"نجح",confirm:"تأكيد",cancel:"إلغاء",delete:"حذف",edit:"تعديل",add:"إضافة",save:"حفظ",close:"إغلاق",search:"بحث",filter:"تصفية",reset:"إعادة تعيين",export:"تصدير",import:"استيراد",backup:"نسخ احتياطي",restore:"استعادة",settings:"الإعدادات",details:"التفاصيل",total:"المجموع",remaining:"المتبقي",available:"المتاح",used:"المستخدم",limit:"الحد الأقصى",amount:"المبلغ",date:"التاريخ",time:"الوقت",description:"الوصف",category:"الفئة",type:"النوع",status:"الحالة",active:"نشط",inactive:"غير نشط",completed:"مكتمل",pending:"معلق",cancelled:"ملغي",yes:"نعم",no:"لا",ok:"موافق",warning:"تحذير",info:"معلومات"},qI={summary:"الملخص",transactions:"الحركات",analysis:"التحليل",budget:"الميزانية",investment:"الاستثمار",cards:"البطاقات",bank:"البنك",installments:"الأقساط",debtsLoans:"الديون والقروض",aiAssistant:"المساعد الذكي",settings:"الإعدادات"},HI={addTransaction:"إضافة حركة",darkMode:"الوضع المظلم",notifications:"الإشعارات",enableNotifications:"تفعيل الإشعارات",language:"العربية",logout:"تسجيل الخروج",profile:"الملف الشخصي"},zI={title:"الملخص المالي",totalBalance:"الرصيد الإجمالي",monthlyIncome:"الدخل الشهري",monthlyExpenses:"المصروفات الشهرية",savings:"المدخرات",cardSummary:"ملخص البطاقات",bankSummary:"ملخص الحسابات البنكية",recentTransactions:"الحركات الأخيرة",categoryBreakdown:"توزيع الفئات",monthlyTrend:"الاتجاه الشهري",cardDebt:"دين البطاقات",totalDebt:"إجمالي الدين",availableCredit:"الائتمان المتاح",usagePercentage:"نسبة الاستخدام",nextPayment:"الدفعة التالية",minimumPayment:"الحد الأدنى للدفع",bankBalance:"رصيد البنك",savingsAccount:"حساب التوفير",checkingAccount:"الحساب الجاري"},GI={title:"سجل المعاملات والتقارير",addTransaction:"إضافة حركة جديدة",editTransaction:"تعديل الحركة",deleteTransaction:"حذف الحركة",transactionDetails:"تفاصيل الحركة",transactionHistory:"تاريخ الحركات",filterByDate:"تصفية حسب التاريخ",filterByCategory:"تصفية حسب الفئة",filterByType:"تصفية حسب النوع",filterByPaymentMethod:"تصفية حسب طريقة الدفع",searchTransactions:"البحث في الحركات",noTransactions:"لا توجد حركات",noTransactionsFound:"لم يتم العثور على حركات",transactionType:"نوع الحركة",paymentMethod:"طريقة الدفع",transactionDate:"تاريخ الحركة",entryTime:"وقت الإدخال",income:"دخل",expense:"مصروف",transfer:"تحويل",investment:"استثمار",loan:"قرض",installment:"قسط",cash:"نقدي",creditCard:"بطاقة ائتمان",debitCard:"بطاقة خصم",bankTransfer:"تحويل بنكي",online:"أونلاين",check:"شيك",other:"أخرى"},$I={title:"التحليل المالي",monthlyAnalysis:"التحليل الشهري",categoryAnalysis:"تحليل الفئات",trendAnalysis:"تحليل الاتجاهات",spendingPatterns:"أنماط الإنفاق",incomeAnalysis:"تحليل الدخل",expenseAnalysis:"تحليل المصروفات",savingsRate:"معدل الادخار",budgetVsActual:"الميزانية مقابل الفعلي",monthlyComparison:"مقارنة شهرية",yearlyComparison:"مقارنة سنوية",topCategories:"أهم الفئات",spendingTrend:"اتجاه الإنفاق",incomeTrend:"اتجاه الدخل",savingsTrend:"اتجاه الادخار"},KI={title:"الميزانية الذكية",createBudget:"إنشاء ميزانية",editBudget:"تعديل الميزانية",deleteBudget:"حذف الميزانية",budgetPlan:"خطة الميزانية",smartSuggestion:"اقتراح ذكي",monthlyBudget:"الميزانية الشهرية",budgetCategories:"فئات الميزانية",allocatedAmount:"المبلغ المخصص",spentAmount:"المبلغ المنفق",remainingAmount:"المبلغ المتبقي",budgetProgress:"تقدم الميزانية",overBudget:"تجاوز الميزانية",underBudget:"تحت الميزانية",budgetAlert:"تنبيه الميزانية",suggestedBudget:"الميزانية المقترحة",budgetHistory:"تاريخ الميزانية"},YI={title:"الإدارة الاستثمارية",portfolio:"المحفظة",addInvestment:"إضافة استثمار",editInvestment:"تعديل الاستثمار",deleteInvestment:"حذف الاستثمار",investmentType:"نوع الاستثمار",stock:"سهم",bond:"سند",fund:"صندوق",crypto:"عملة رقمية",realEstate:"عقار",commodity:"سلعة",initialAmount:"المبلغ الأولي",currentValue:"القيمة الحالية",profitLoss:"الربح/الخسارة",returnRate:"معدل العائد",investmentDate:"تاريخ الاستثمار",maturityDate:"تاريخ الاستحقاق",riskLevel:"مستوى المخاطر",low:"منخفض",medium:"متوسط",high:"عالي"},JI={title:"إدارة البطاقات",addCard:"إضافة بطاقة",editCard:"تعديل البطاقة",deleteCard:"حذف البطاقة",cardDetails:"تفاصيل البطاقة",cardName:"اسم البطاقة",cardNumber:"رقم البطاقة",cardType:"نوع البطاقة",creditLimit:"حد الائتمان",currentBalance:"الرصيد الحالي",availableCredit:"الائتمان المتاح",minimumPayment:"الحد الأدنى للدفع",dueDate:"تاريخ الاستحقاق",interestRate:"معدل الفائدة",annualFee:"الرسوم السنوية",rewards:"المكافآت",cardStatus:"حالة البطاقة",active:"نشطة",inactive:"غير نشطة",blocked:"محظورة",expired:"منتهية الصلاحية"},QI={title:"الحسابات البنكية",addAccount:"إضافة حساب",editAccount:"تعديل الحساب",deleteAccount:"حذف الحساب",accountDetails:"تفاصيل الحساب",accountName:"اسم الحساب",accountNumber:"رقم الحساب",bankName:"اسم البنك",accountType:"نوع الحساب",currentBalance:"الرصيد الحالي",availableBalance:"الرصيد المتاح",accountStatus:"حالة الحساب",savings:"توفير",checking:"جاري",business:"تجاري",investment:"استثماري"},XI={title:"إدارة الأقساط",addInstallment:"إضافة قسط",editInstallment:"تعديل القسط",deleteInstallment:"حذف القسط",installmentPlan:"خطة الأقساط",installmentDetails:"تفاصيل القسط",installmentAmount:"مبلغ القسط",installmentDate:"تاريخ القسط",remainingInstallments:"الأقساط المتبقية",completedInstallments:"الأقساط المكتملة",totalInstallments:"إجمالي الأقساط",nextPayment:"الدفعة التالية",paymentHistory:"تاريخ المدفوعات",installmentStatus:"حالة القسط",paid:"مدفوع",unpaid:"غير مدفوع",overdue:"متأخر",installmentSummary:"ملخص الأقساط"},WI={title:"الديون والقروض",addLoan:"إضافة قرض",editLoan:"تعديل القرض",deleteLoan:"حذف القرض",addDebt:"إضافة دين",editDebt:"تعديل الدين",deleteDebt:"حذف الدين",loanDetails:"تفاصيل القرض",debtDetails:"تفاصيل الدين",loanAmount:"مبلغ القرض",debtAmount:"مبلغ الدين",interestRate:"معدل الفائدة",loanTerm:"مدة القرض",monthlyPayment:"الدفعة الشهرية",remainingBalance:"الرصيد المتبقي",loanStatus:"حالة القرض",debtStatus:"حالة الدين",creditor:"الدائن",debtor:"المدين",loanSource:"مصدر القرض",debtSource:"مصدر الدين",loanReason:"سبب القرض",debtReason:"سبب الدين",prepaidAmount:"المبلغ المدفوع مسبقاً",prepaidInstallments:"الأقساط المدفوعة مسبقاً",nextPaymentDate:"تاريخ الدفعة التالية",loanProgress:"تقدم القرض",debtProgress:"تقدم الدين"},ZI={title:"المساعد الذكي",askQuestion:"اطرح سؤالاً",getAdvice:"احصل على نصيحة",analyzeData:"تحليل البيانات",suggestBudget:"اقتراح ميزانية",investmentAdvice:"نصيحة استثمارية",debtManagement:"إدارة الديون",savingsTips:"نصائح الادخار",financialGoals:"الأهداف المالية",typeMessage:"اكتب رسالتك...",send:"إرسال",thinking:"جاري التفكير...",noResponse:"لم يتم الحصول على رد",errorOccurred:"حدث خطأ",tryAgain:"حاول مرة أخرى"},eN={title:"الإعدادات",general:"عام",privacy:"الخصوصية",notifications:"الإشعارات",data:"البيانات",appearance:"المظهر",language:"اللغة",theme:"المظهر",light:"فاتح",dark:"مظلم",auto:"تلقائي",enableNotifications:"تفعيل الإشعارات",notificationTypes:"أنواع الإشعارات",budgetAlerts:"تنبيهات الميزانية",paymentReminders:"تذكيرات الدفع",investmentUpdates:"تحديثات الاستثمار",dataBackup:"نسخ احتياطي للبيانات",exportData:"تصدير البيانات",importData:"استيراد البيانات",deleteAllData:"حذف جميع البيانات",confirmDelete:"تأكيد الحذف",deleteWarning:"هذا الإجراء لا يمكن التراجع عنه",apiKeys:"مفاتيح API",geminiApiKey:"مفتاح Gemini API",saveApiKey:"حفظ مفتاح API",apiKeySaved:"تم حفظ مفتاح API",apiKeyError:"خطأ في حفظ مفتاح API",about:"حول التطبيق",version:"الإصدار",developer:"المطور",support:"الدعم",feedback:"الملاحظات"},tN={required:"هذا الحقل مطلوب",invalidEmail:"البريد الإلكتروني غير صحيح",invalidAmount:"المبلغ غير صحيح",invalidDate:"التاريخ غير صحيح",invalidNumber:"الرقم غير صحيح",minLength:"يجب أن يكون {{min}} أحرف على الأقل",maxLength:"يجب أن يكون {{max}} أحرف على الأكثر",minValue:"يجب أن يكون {{min}} على الأقل",maxValue:"يجب أن يكون {{max}} على الأكثر",selectOption:"اختر خياراً",enterAmount:"أدخل المبلغ",enterDescription:"أدخل الوصف",selectCategory:"اختر الفئة",selectType:"اختر النوع",selectPaymentMethod:"اختر طريقة الدفع",selectDate:"اختر التاريخ",enterName:"أدخل الاسم",enterNumber:"أدخل الرقم",enterRate:"أدخل المعدل"},nN={dataSaved:"تم حفظ البيانات بنجاح",dataDeleted:"تم حذف البيانات بنجاح",dataUpdated:"تم تحديث البيانات بنجاح",dataRestored:"تم استعادة البيانات بنجاح",dataExported:"تم تصدير البيانات بنجاح",dataImported:"تم استيراد البيانات بنجاح",confirmDelete:"هل أنت متأكد من الحذف؟",confirmRestore:"هل أنت متأكد من الاستعادة؟",cannotDelete:"لا يمكن الحذف",cannotDeleteCategory:"لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات",cannotDeleteTransactionType:"لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات",cannotDeletePaymentMethod:"لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات",restoreBackup:"استعادة نسخة احتياطية",confirmRestoreBackup:"هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية",apiStatus:"حالة مفاتيح API",noDataFound:"لم يتم العثور على بيانات",loadingData:"جاري تحميل البيانات...",savingData:"جاري حفظ البيانات...",errorLoading:"خطأ في تحميل البيانات",errorSaving:"خطأ في حفظ البيانات",networkError:"خطأ في الشبكة",serverError:"خطأ في الخادم",unauthorized:"غير مصرح",forbidden:"ممنوع",notFound:"غير موجود",validationError:"خطأ في التحقق",unknownError:"خطأ غير معروف"},sN={january:"يناير",february:"فبراير",march:"مارس",april:"أبريل",may:"مايو",june:"يونيو",july:"يوليو",august:"أغسطس",september:"سبتمبر",october:"أكتوبر",november:"نوفمبر",december:"ديسمبر"},iN={sunday:"الأحد",monday:"الإثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت"},rN={app:jI,navigation:qI,header:HI,dashboard:zI,transactions:GI,analysis:$I,budget:KI,investment:YI,cards:JI,bank:QI,installments:XI,debtsLoans:WI,aiAssistant:ZI,settings:eN,forms:tN,messages:nN,months:sN,days:iN},aN={title:"Financial Dashboard | MASROF",developedBy:"Developed by K.A Team",loading:"Loading...",saving:"Saving...",error:"Error",success:"Success",confirm:"Confirm",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",save:"Save",close:"Close",search:"Search",filter:"Filter",reset:"Reset",export:"Export",import:"Import",backup:"Backup",restore:"Restore",settings:"Settings",details:"Details",total:"Total",remaining:"Remaining",available:"Available",used:"Used",limit:"Limit",amount:"Amount",date:"Date",time:"Time",description:"Description",category:"Category",type:"Type",status:"Status",active:"Active",inactive:"Inactive",completed:"Completed",pending:"Pending",cancelled:"Cancelled",yes:"Yes",no:"No",ok:"OK",warning:"Warning",info:"Info"},oN={summary:"Summary",transactions:"Transactions",analysis:"Analysis",budget:"Budget",investment:"Investment",cards:"Cards",bank:"Bank",installments:"Installments",debtsLoans:"Debts & Loans",aiAssistant:"AI Assistant",settings:"Settings"},lN={addTransaction:"Add Transaction",darkMode:"Dark Mode",notifications:"Notifications",enableNotifications:"Enable Notifications",language:"English",logout:"Logout",profile:"Profile"},uN={title:"Financial Summary",totalBalance:"Total Balance",monthlyIncome:"Monthly Income",monthlyExpenses:"Monthly Expenses",savings:"Savings",cardSummary:"Card Summary",bankSummary:"Bank Account Summary",recentTransactions:"Recent Transactions",categoryBreakdown:"Category Breakdown",monthlyTrend:"Monthly Trend",cardDebt:"Card Debt",totalDebt:"Total Debt",availableCredit:"Available Credit",usagePercentage:"Usage Percentage",nextPayment:"Next Payment",minimumPayment:"Minimum Payment",bankBalance:"Bank Balance",savingsAccount:"Savings Account",checkingAccount:"Checking Account"},cN={title:"Transaction Records & Reports",addTransaction:"Add New Transaction",editTransaction:"Edit Transaction",deleteTransaction:"Delete Transaction",transactionDetails:"Transaction Details",transactionHistory:"Transaction History",filterByDate:"Filter by Date",filterByCategory:"Filter by Category",filterByType:"Filter by Type",filterByPaymentMethod:"Filter by Payment Method",searchTransactions:"Search Transactions",noTransactions:"No transactions",noTransactionsFound:"No transactions found",transactionType:"Transaction Type",paymentMethod:"Payment Method",transactionDate:"Transaction Date",entryTime:"Entry Time",income:"Income",expense:"Expense",transfer:"Transfer",investment:"Investment",loan:"Loan",installment:"Installment",cash:"Cash",creditCard:"Credit Card",debitCard:"Debit Card",bankTransfer:"Bank Transfer",online:"Online",check:"Check",other:"Other"},dN={title:"Financial Analysis",monthlyAnalysis:"Monthly Analysis",categoryAnalysis:"Category Analysis",trendAnalysis:"Trend Analysis",spendingPatterns:"Spending Patterns",incomeAnalysis:"Income Analysis",expenseAnalysis:"Expense Analysis",savingsRate:"Savings Rate",budgetVsActual:"Budget vs Actual",monthlyComparison:"Monthly Comparison",yearlyComparison:"Yearly Comparison",topCategories:"Top Categories",spendingTrend:"Spending Trend",incomeTrend:"Income Trend",savingsTrend:"Savings Trend"},fN={title:"Smart Budget",createBudget:"Create Budget",editBudget:"Edit Budget",deleteBudget:"Delete Budget",budgetPlan:"Budget Plan",smartSuggestion:"Smart Suggestion",monthlyBudget:"Monthly Budget",budgetCategories:"Budget Categories",allocatedAmount:"Allocated Amount",spentAmount:"Spent Amount",remainingAmount:"Remaining Amount",budgetProgress:"Budget Progress",overBudget:"Over Budget",underBudget:"Under Budget",budgetAlert:"Budget Alert",suggestedBudget:"Suggested Budget",budgetHistory:"Budget History"},hN={title:"Investment Management",portfolio:"Portfolio",addInvestment:"Add Investment",editInvestment:"Edit Investment",deleteInvestment:"Delete Investment",investmentType:"Investment Type",stock:"Stock",bond:"Bond",fund:"Fund",crypto:"Cryptocurrency",realEstate:"Real Estate",commodity:"Commodity",initialAmount:"Initial Amount",currentValue:"Current Value",profitLoss:"Profit/Loss",returnRate:"Return Rate",investmentDate:"Investment Date",maturityDate:"Maturity Date",riskLevel:"Risk Level",low:"Low",medium:"Medium",high:"High"},mN={title:"Card Management",addCard:"Add Card",editCard:"Edit Card",deleteCard:"Delete Card",cardDetails:"Card Details",cardName:"Card Name",cardNumber:"Card Number",cardType:"Card Type",creditLimit:"Credit Limit",currentBalance:"Current Balance",availableCredit:"Available Credit",minimumPayment:"Minimum Payment",dueDate:"Due Date",interestRate:"Interest Rate",annualFee:"Annual Fee",rewards:"Rewards",cardStatus:"Card Status",active:"Active",inactive:"Inactive",blocked:"Blocked",expired:"Expired"},pN={title:"Bank Accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",accountName:"Account Name",accountNumber:"Account Number",bankName:"Bank Name",accountType:"Account Type",currentBalance:"Current Balance",availableBalance:"Available Balance",accountStatus:"Account Status",savings:"Savings",checking:"Checking",business:"Business",investment:"Investment"},gN={title:"Installment Management",addInstallment:"Add Installment",editInstallment:"Edit Installment",deleteInstallment:"Delete Installment",installmentPlan:"Installment Plan",installmentDetails:"Installment Details",installmentAmount:"Installment Amount",installmentDate:"Installment Date",remainingInstallments:"Remaining Installments",completedInstallments:"Completed Installments",totalInstallments:"Total Installments",nextPayment:"Next Payment",paymentHistory:"Payment History",installmentStatus:"Installment Status",paid:"Paid",unpaid:"Unpaid",overdue:"Overdue",installmentSummary:"Installment Summary"},yN={title:"Debts & Loans",addLoan:"Add Loan",editLoan:"Edit Loan",deleteLoan:"Delete Loan",addDebt:"Add Debt",editDebt:"Edit Debt",deleteDebt:"Delete Debt",loanDetails:"Loan Details",debtDetails:"Debt Details",loanAmount:"Loan Amount",debtAmount:"Debt Amount",interestRate:"Interest Rate",loanTerm:"Loan Term",monthlyPayment:"Monthly Payment",remainingBalance:"Remaining Balance",loanStatus:"Loan Status",debtStatus:"Debt Status",creditor:"Creditor",debtor:"Debtor",loanSource:"Loan Source",debtSource:"Debt Source",loanReason:"Loan Reason",debtReason:"Debt Reason",prepaidAmount:"Prepaid Amount",prepaidInstallments:"Prepaid Installments",nextPaymentDate:"Next Payment Date",loanProgress:"Loan Progress",debtProgress:"Debt Progress"},vN={title:"AI Assistant",askQuestion:"Ask a Question",getAdvice:"Get Advice",analyzeData:"Analyze Data",suggestBudget:"Suggest Budget",investmentAdvice:"Investment Advice",debtManagement:"Debt Management",savingsTips:"Savings Tips",financialGoals:"Financial Goals",typeMessage:"Type your message...",send:"Send",thinking:"Thinking...",noResponse:"No response received",errorOccurred:"An error occurred",tryAgain:"Try again"},_N={title:"Settings",general:"General",privacy:"Privacy",notifications:"Notifications",data:"Data",appearance:"Appearance",language:"Language",theme:"Theme",light:"Light",dark:"Dark",auto:"Auto",enableNotifications:"Enable Notifications",notificationTypes:"Notification Types",budgetAlerts:"Budget Alerts",paymentReminders:"Payment Reminders",investmentUpdates:"Investment Updates",dataBackup:"Data Backup",exportData:"Export Data",importData:"Import Data",deleteAllData:"Delete All Data",confirmDelete:"Confirm Delete",deleteWarning:"This action cannot be undone",apiKeys:"API Keys",geminiApiKey:"Gemini API Key",saveApiKey:"Save API Key",apiKeySaved:"API Key saved successfully",apiKeyError:"Error saving API Key",about:"About",version:"Version",developer:"Developer",support:"Support",feedback:"Feedback"},TN={required:"This field is required",invalidEmail:"Invalid email address",invalidAmount:"Invalid amount",invalidDate:"Invalid date",invalidNumber:"Invalid number",minLength:"Must be at least {{min}} characters",maxLength:"Must be at most {{max}} characters",minValue:"Must be at least {{min}}",maxValue:"Must be at most {{max}}",selectOption:"Select an option",enterAmount:"Enter amount",enterDescription:"Enter description",selectCategory:"Select category",selectType:"Select type",selectPaymentMethod:"Select payment method",selectDate:"Select date",enterName:"Enter name",enterNumber:"Enter number",enterRate:"Enter rate"},bN={dataSaved:"Data saved successfully",dataDeleted:"Data deleted successfully",dataUpdated:"Data updated successfully",dataRestored:"Data restored successfully",dataExported:"Data exported successfully",dataImported:"Data imported successfully",confirmDelete:"Are you sure you want to delete?",confirmRestore:"Are you sure you want to restore?",cannotDelete:"Cannot Delete",cannotDeleteCategory:"Cannot delete this category as it is used in some transactions",cannotDeleteTransactionType:"Cannot delete this transaction type as it is used in some transactions",cannotDeletePaymentMethod:"Cannot delete this payment method as it is used in some transactions",restoreBackup:"Restore Backup",confirmRestoreBackup:"Are you sure? This will overwrite all your current data",apiStatus:"API Keys Status",noDataFound:"No data found",loadingData:"Loading data...",savingData:"Saving data...",errorLoading:"Error loading data",errorSaving:"Error saving data",networkError:"Network error",serverError:"Server error",unauthorized:"Unauthorized",forbidden:"Forbidden",notFound:"Not found",validationError:"Validation error",unknownError:"Unknown error"},xN={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},EN={sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday"},SN={app:aN,navigation:oN,header:lN,dashboard:uN,transactions:cN,analysis:dN,budget:fN,investment:hN,cards:mN,bank:pN,installments:gN,debtsLoans:yN,aiAssistant:vN,settings:_N,forms:TN,messages:bN,months:xN,days:EN},AN={ar:{translation:rN},en:{translation:SN}};Tn.use(Fx).use(bI).init({resources:AN,lng:"ar",fallbackLng:"ar",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator","htmlTag"],caches:["localStorage"],lookupLocalStorage:"masrof-language"},react:{useSuspense:!1}});const xd=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let CN,wN;function IN(){return{geminiUrl:CN,vertexUrl:wN}}function NN(n,e,t,s){var r,o;if(!(n!=null&&n.baseUrl)){const u=IN();return e?(r=u.vertexUrl)!==null&&r!==void 0?r:t:(o=u.geminiUrl)!==null&&o!==void 0?o:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Da{}function xe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function y(n,e,t){for(let o=0;o<e.length-1;o++){const u=e[o];if(u.endsWith("[]")){const d=u.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[d])){const h=n[d];if(Array.isArray(t))for(let f=0;f<h.length;f++){const _=h[f];y(_,e.slice(o+1),t[f])}else for(const f of h)y(f,e.slice(o+1),t)}return}else if(u.endsWith("[0]")){const d=u.slice(0,-3);d in n||(n[d]=[{}]);const h=n[d];y(h[0],e.slice(o+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const s=e[e.length-1],r=n[s];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[s]=t}function m(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let s=0;s<e.length;s++){if(typeof n!="object"||n===null)return t;const r=e[s];if(r.endsWith("[]")){const o=r.slice(0,-2);if(o in n){const u=n[o];return Array.isArray(u)?u.map(d=>m(d,e.slice(s+1),t)):t}else return t}else n=n[r]}return n}catch(s){if(s instanceof TypeError)return t;throw s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jp(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RN(n){const e={},t=m(n,["operationName"]);t!=null&&y(e,["operationName"],t);const s=m(n,["resourceName"]);return s!=null&&y(e,["_url","resourceName"],s),e}function DN(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["metadata"]);s!=null&&y(e,["metadata"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);o!=null&&y(e,["error"],o);const u=m(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],PN(u)),e}function MN(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["metadata"]);s!=null&&y(e,["metadata"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);o!=null&&y(e,["error"],o);const u=m(n,["response"]);return u!=null&&y(e,["response"],kN(u)),e}function PN(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(u=>LN(u))),y(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&y(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&y(e,["raiMediaFilteredReasons"],r),e}function kN(n){const e={},t=m(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(u=>VN(u))),y(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&y(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&y(e,["raiMediaFilteredReasons"],r),e}function LN(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],FN(t)),e}function VN(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],BN(t)),e}function ON(n){const e={},t=m(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function UN(n){const e={},t=m(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function FN(n){const e={},t=m(n,["video","uri"]);t!=null&&y(e,["uri"],t);const s=m(n,["video","encodedVideo"]);s!=null&&y(e,["videoBytes"],Jp(s));const r=m(n,["encoding"]);return r!=null&&y(e,["mimeType"],r),e}function BN(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const s=m(n,["bytesBase64Encoded"]);s!=null&&y(e,["videoBytes"],Jp(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var V_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(V_||(V_={}));var O_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(O_||(O_={}));var Sr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Sr||(Sr={}));var U_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(U_||(U_={}));var F_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(F_||(F_={}));var B_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(B_||(B_={}));var j_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(j_||(j_={}));var q_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(q_||(q_={}));var H_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(H_||(H_={}));var z_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(z_||(z_={}));var G_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(G_||(G_={}));var $_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})($_||($_={}));var K_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(K_||(K_={}));var Y_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(Y_||(Y_={}));var J_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(J_||(J_={}));var zd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(zd||(zd={}));var Q_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Q_||(Q_={}));var hp;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(hp||(hp={}));var X_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(X_||(X_={}));var W_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(W_||(W_={}));var Z_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Z_||(Z_={}));var eT;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(eT||(eT={}));var tT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(tT||(tT={}));var nT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(nT||(nT={}));var sT;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(sT||(sT={}));var iT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(iT||(iT={}));var rT;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(rT||(rT={}));var aT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(aT||(aT={}));var oT;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(oT||(oT={}));var lT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(lT||(lT={}));var uT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(uT||(uT={}));var cT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(cT||(cT={}));var dT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dT||(dT={}));var fT;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(fT||(fT={}));var hT;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(hT||(hT={}));var mT;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(mT||(mT={}));var pT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(pT||(pT={}));var gT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(gT||(gT={}));var yT;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(yT||(yT={}));var vT;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(vT||(vT={}));var _T;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(_T||(_T={}));var TT;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(TT||(TT={}));var bT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(bT||(bT={}));var xT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(xT||(xT={}));var ET;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ET||(ET={}));var ST;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(ST||(ST={}));var AT;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(AT||(AT={}));var CT;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(CT||(CT={}));var ko;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(ko||(ko={}));class mp{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class hu{get text(){var e,t,s,r,o,u,d,h;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",_=!1;const b=[];for(const x of(h=(d=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&h!==void 0?h:[]){for(const[C,M]of Object.entries(x))C!=="text"&&C!=="thought"&&(M!==null||M!==void 0)&&b.push(C);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;_=!0,f+=x.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?f:void 0}get data(){var e,t,s,r,o,u,d,h;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const _=[];for(const b of(h=(d=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&h!==void 0?h:[]){for(const[x,C]of Object.entries(b))x!=="inlineData"&&(C!==null||C!==void 0)&&_.push(x);b.inlineData&&typeof b.inlineData.data=="string"&&(f+=atob(b.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,s,r,o,u,d,h;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(h=(d=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,t,s,r,o,u,d,h,f;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(h=(d=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((_==null?void 0:_.length)!==0)return(f=_==null?void 0:_[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,s,r,o,u,d,h,f;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(h=(d=(u=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((_==null?void 0:_.length)!==0)return(f=_==null?void 0:_[0])===null||f===void 0?void 0:f.output}}class wT{}class IT{}class jN{}class qN{}class HN{}class zN{}class NT{}class RT{}class DT{}class GN{}class Gd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const s=new Gd;let r;const o=e;return t?r=MN(o):r=DN(o),Object.assign(s,r),s}}class MT{}class PT{}class kT{}class $N{}class KN{}class YN{}class LT{}class JN{get text(){var e,t,s;let r="",o=!1;const u=[];for(const d of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[h,f]of Object.entries(d))h!=="text"&&h!=="thought"&&f!==null&&u.push(h);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,r+=d.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,s;let r="";const o=[];for(const u of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[d,h]of Object.entries(u))d!=="inlineData"&&h!==null&&o.push(d);u.inlineData&&typeof u.inlineData.data=="string"&&(r+=atob(u.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class QN{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function it(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Bx(n,e){const t=it(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function jx(n){return Array.isArray(n)?n.map(e=>$d(e)):[$d(n)]}function $d(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function qx(n){const e=$d(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Hx(n){const e=$d(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function VT(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function zx(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>VT(e)):[VT(n)]}function pp(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function OT(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function UT(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function vn(n){if(n==null)throw new Error("ContentUnion is required");return pp(n)?n:{role:"user",parts:zx(n)}}function Qp(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=vn(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=vn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>vn(t)):[vn(e)]}function os(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(OT(n)||UT(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[vn(n)]}const e=[],t=[],s=pp(n[0]);for(const r of n){const o=pp(r);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(OT(r)||UT(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return s||e.push({role:"user",parts:zx(t)}),e}function XN(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.values(Sr).includes(t[0].toUpperCase())?t[0].toUpperCase():Sr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.values(Sr).includes(s.toUpperCase())?s.toUpperCase():Sr.TYPE_UNSPECIFIED})}}function Oo(n){const e={},t=["items"],s=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&XN(n.type,e);for(const[u,d]of Object.entries(n))if(d!=null)if(u=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(Sr).includes(d.toUpperCase())?d.toUpperCase():Sr.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Oo(d);else if(s.includes(u)){const h=[];for(const f of d){if(f.type=="null"){e.nullable=!0;continue}h.push(Oo(f))}e[u]=h}else if(r.includes(u)){const h={};for(const[f,_]of Object.entries(d))h[f]=Oo(_);e[u]=h}else{if(u==="additionalProperties")continue;e[u]=d}return e}function Xp(n){return Oo(n)}function Wp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Zp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function el(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Oo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Oo(e.response));return n}function tl(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function WN(n,e,t,s=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Fi(n,e){if(typeof e!="string")throw new Error("name must be a string");return WN(n,e,"cachedContents")}function Gx(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Ur(n){return Jp(n)}function ZN(n){return n!=null&&typeof n=="object"&&"name"in n}function eR(n){return n!=null&&typeof n=="object"&&"video"in n}function tR(n){return n!=null&&typeof n=="object"&&"uri"in n}function $x(n){var e;let t;if(ZN(n)&&(t=n.name),!(tR(n)&&(t=n.uri,t===void 0))&&!(eR(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Kx(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Yx(n){for(const e of["models","tunedModels","publisherModels"])if(nR(n,e))return n[e];return[]}function nR(n,e){return n!==null&&typeof n=="object"&&e in n}function sR(n,e={}){const t=n,s={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(s.responseJsonSchema=t.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function iR(n,e={}){const t=[],s=new Set;for(const r of n){const o=r.name;if(s.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);s.add(o);const u=sR(r,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function Jx(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const s=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function rR(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Qx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let o=!1;for(const u of r){if(typeof u!="object"||u===null)continue;const h=u.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function nl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Xx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aR(n){const e={},t=m(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const s=m(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>VR(u))),y(e,["inlinedResponses"],o)}const r=m(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>u)),y(e,["inlinedEmbedContentResponses"],o)}return e}function oR(n){const e={},t=m(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const s=m(n,["gcsDestination","outputUriPrefix"]);s!=null&&y(e,["gcsUri"],s);const r=m(n,["bigqueryDestination","outputUri"]);return r!=null&&y(e,["bigqueryUri"],r),e}function lR(n){const e={},t=m(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const s=m(n,["gcsUri"]);s!=null&&y(e,["gcsDestination","outputUriPrefix"],s);const r=m(n,["bigqueryUri"]);if(r!=null&&y(e,["bigqueryDestination","outputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function mu(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["metadata","displayName"]);s!=null&&y(e,["displayName"],s);const r=m(n,["metadata","state"]);r!=null&&y(e,["state"],Xx(r));const o=m(n,["metadata","createTime"]);o!=null&&y(e,["createTime"],o);const u=m(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const d=m(n,["metadata","updateTime"]);d!=null&&y(e,["updateTime"],d);const h=m(n,["metadata","model"]);h!=null&&y(e,["model"],h);const f=m(n,["metadata","output"]);return f!=null&&y(e,["dest"],aR(Qx(f))),e}function gp(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["displayName"]);s!=null&&y(e,["displayName"],s);const r=m(n,["state"]);r!=null&&y(e,["state"],Xx(r));const o=m(n,["error"]);o!=null&&y(e,["error"],o);const u=m(n,["createTime"]);u!=null&&y(e,["createTime"],u);const d=m(n,["startTime"]);d!=null&&y(e,["startTime"],d);const h=m(n,["endTime"]);h!=null&&y(e,["endTime"],h);const f=m(n,["updateTime"]);f!=null&&y(e,["updateTime"],f);const _=m(n,["model"]);_!=null&&y(e,["model"],_);const b=m(n,["inputConfig"]);b!=null&&y(e,["src"],uR(b));const x=m(n,["outputConfig"]);return x!=null&&y(e,["dest"],oR(Qx(x))),e}function uR(n){const e={},t=m(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const s=m(n,["gcsSource","uris"]);s!=null&&y(e,["gcsUri"],s);const r=m(n,["bigquerySource","inputUri"]);return r!=null&&y(e,["bigqueryUri"],r),e}function cR(n,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=m(e,["fileName"]);s!=null&&y(t,["fileName"],s);const r=m(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>LR(n,u))),y(t,["requests","requests"],o)}return t}function dR(n){const e={},t=m(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const s=m(n,["gcsUri"]);s!=null&&y(e,["gcsSource","uris"],s);const r=m(n,["bigqueryUri"]);if(r!=null&&y(e,["bigquerySource","inputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function fR(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function hR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function mR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function pR(n){const e={},t=m(n,["content"]);t!=null&&y(e,["content"],t);const s=m(n,["citationMetadata"]);s!=null&&y(e,["citationMetadata"],gR(s));const r=m(n,["tokenCount"]);r!=null&&y(e,["tokenCount"],r);const o=m(n,["finishReason"]);o!=null&&y(e,["finishReason"],o);const u=m(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=m(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const h=m(n,["groundingMetadata"]);h!=null&&y(e,["groundingMetadata"],h);const f=m(n,["index"]);f!=null&&y(e,["index"],f);const _=m(n,["logprobsResult"]);_!=null&&y(e,["logprobsResult"],_);const b=m(n,["safetyRatings"]);if(b!=null){let x=b;Array.isArray(x)&&(x=x.map(C=>C)),y(e,["safetyRatings"],x)}return e}function gR(n){const e={},t=m(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>r)),y(e,["citations"],s)}return e}function Wx(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>HR(o))),y(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&y(e,["role"],s),e}function yR(n,e){const t={},s=m(n,["displayName"]);if(e!==void 0&&s!=null&&y(e,["batch","displayName"],s),m(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function vR(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const r=m(n,["dest"]);return e!==void 0&&r!=null&&y(e,["outputConfig"],lR(rR(r))),t}function FT(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["src"]);r!=null&&y(t,["batch","inputConfig"],cR(n,Jx(n,r)));const o=m(e,["config"]);return o!=null&&yR(o,t),t}function _R(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["model"],it(n,s));const r=m(e,["src"]);r!=null&&y(t,["inputConfig"],dR(Jx(n,r)));const o=m(e,["config"]);return o!=null&&vR(o,t),t}function TR(n,e){const t={},s=m(n,["displayName"]);return e!==void 0&&s!=null&&y(e,["batch","displayName"],s),t}function Gm(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["src"]);r!=null&&y(t,["batch","inputConfig"],wR(n,r));const o=m(e,["config"]);return o!=null&&TR(o,t),t}function bR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function xR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function ER(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);return o!=null&&y(e,["error"],o),e}function SR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);return o!=null&&y(e,["error"],o),e}function AR(n,e){const t={},s=m(e,["contents"]);if(s!=null){let o=Qp(n,s);Array.isArray(o)&&(o=o.map(u=>u)),y(t,["requests[]","request","content"],o)}const r=m(e,["config"]);return r!=null&&y(t,["_self"],CR(r,t)),t}function CR(n,e){const t={},s=m(n,["taskType"]);e!==void 0&&s!=null&&y(e,["requests[]","taskType"],s);const r=m(n,["title"]);e!==void 0&&r!=null&&y(e,["requests[]","title"],r);const o=m(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&y(e,["requests[]","outputDimensionality"],o),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function wR(n,e){const t={},s=m(e,["fileName"]);s!=null&&y(t,["file_name"],s);const r=m(e,["inlinedRequests"]);return r!=null&&y(t,["requests"],AR(n,r)),t}function IR(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function NR(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&y(t,["systemInstruction"],Wx(vn(r)));const o=m(e,["temperature"]);o!=null&&y(s,["temperature"],o);const u=m(e,["topP"]);u!=null&&y(s,["topP"],u);const d=m(e,["topK"]);d!=null&&y(s,["topK"],d);const h=m(e,["candidateCount"]);h!=null&&y(s,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&y(s,["maxOutputTokens"],f);const _=m(e,["stopSequences"]);_!=null&&y(s,["stopSequences"],_);const b=m(e,["responseLogprobs"]);b!=null&&y(s,["responseLogprobs"],b);const x=m(e,["logprobs"]);x!=null&&y(s,["logprobs"],x);const C=m(e,["presencePenalty"]);C!=null&&y(s,["presencePenalty"],C);const M=m(e,["frequencyPenalty"]);M!=null&&y(s,["frequencyPenalty"],M);const k=m(e,["seed"]);k!=null&&y(s,["seed"],k);const V=m(e,["responseMimeType"]);V!=null&&y(s,["responseMimeType"],V);const $=m(e,["responseSchema"]);$!=null&&y(s,["responseSchema"],Xp($));const U=m(e,["responseJsonSchema"]);if(U!=null&&y(s,["responseJsonSchema"],U),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const B=m(e,["safetySettings"]);if(t!==void 0&&B!=null){let j=B;Array.isArray(j)&&(j=j.map(O=>zR(O))),y(t,["safetySettings"],j)}const K=m(e,["tools"]);if(t!==void 0&&K!=null){let j=tl(K);Array.isArray(j)&&(j=j.map(O=>GR(el(O)))),y(t,["tools"],j)}const se=m(e,["toolConfig"]);if(t!==void 0&&se!=null&&y(t,["toolConfig"],se),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=m(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],Fi(n,H));const R=m(e,["responseModalities"]);R!=null&&y(s,["responseModalities"],R);const N=m(e,["mediaResolution"]);N!=null&&y(s,["mediaResolution"],N);const D=m(e,["speechConfig"]);if(D!=null&&y(s,["speechConfig"],Wp(D)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=m(e,["thinkingConfig"]);w!=null&&y(s,["thinkingConfig"],w);const L=m(e,["imageConfig"]);return L!=null&&y(s,["imageConfig"],L),s}function RR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(f=>pR(f))),y(e,["candidates"],h)}const r=m(n,["modelVersion"]);r!=null&&y(e,["modelVersion"],r);const o=m(n,["promptFeedback"]);o!=null&&y(e,["promptFeedback"],o);const u=m(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=m(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function DR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function MR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],nl(n,s)),t}function PR(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function kR(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function LR(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["request","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let d=os(r);Array.isArray(d)&&(d=d.map(h=>Wx(h))),y(t,["request","contents"],d)}const o=m(e,["metadata"]);o!=null&&y(t,["metadata"],o);const u=m(e,["config"]);return u!=null&&y(t,["request","generationConfig"],NR(n,u,m(t,["request"],{}))),t}function VR(n){const e={},t=m(n,["response"]);t!=null&&y(e,["response"],RR(t));const s=m(n,["error"]);return s!=null&&y(e,["error"],s),e}function OR(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);if(e!==void 0&&r!=null&&y(e,["_query","pageToken"],r),m(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function UR(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&y(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),t}function FR(n){const e={},t=m(n,["config"]);return t!=null&&OR(t,e),e}function BR(n){const e={},t=m(n,["config"]);return t!=null&&UR(t,e),e}function jR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>mu(u))),y(e,["batchJobs"],o)}return e}function qR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>gp(u))),y(e,["batchJobs"],o)}return e}function HR(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const s=m(n,["thought"]);s!=null&&y(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&y(e,["inlineData"],fR(r));const o=m(n,["fileData"]);o!=null&&y(e,["fileData"],IR(o));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=m(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const h=m(n,["codeExecutionResult"]);h!=null&&y(e,["codeExecutionResult"],h);const f=m(n,["executableCode"]);f!=null&&y(e,["executableCode"],f);const _=m(n,["functionResponse"]);_!=null&&y(e,["functionResponse"],_);const b=m(n,["text"]);return b!=null&&y(e,["text"],b),e}function zR(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&y(e,["category"],t);const s=m(n,["threshold"]);return s!=null&&y(e,["threshold"],s),e}function GR(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["functionDeclarations"],f)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&y(e,["googleSearch"],kR(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&y(e,["googleSearchRetrieval"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(n,["googleMaps"]);o!=null&&y(e,["googleMaps"],PR(o));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=m(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const h=m(n,["codeExecution"]);return h!=null&&y(e,["codeExecution"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sa;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Sa||(Sa={}));class Ou{constructor(e,t,s,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,r)}init(e,t,s){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!s||Object.keys(s).length===0?u={config:{}}:typeof s=="object"?u=Object.assign({},s):u=s,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(o=(r=u.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $R extends Da{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var s,r;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const d=this.createInlinedEmbedContentRequest(t),h=d.path,f=d.body,_=Gm(this.apiClient,t)._query||{};return this.apiClient.request({path:h,queryParams:_,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(x=>x.json()).then(x=>mu(x))},this.list=async(t={})=>new Ou(Sa.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=FT(this.apiClient,e),s=t._url,r=xe("{model}:batchGenerateContent",s),d=t.batch.inputConfig.requests,h=d.requests,f=[];for(const _ of h){const b=Object.assign({},_);if(b.systemInstruction){const x=b.systemInstruction;delete b.systemInstruction;const C=b.request;C.systemInstruction=x,b.request=C}f.push(b)}return d.requests=f,delete t.config,delete t._url,delete t._query,{path:r,body:t}}createInlinedEmbedContentRequest(e){const t=Gm(this.apiClient,e),s=t._url,r=xe("{model}:asyncBatchEmbedContent",s),d=t.batch.inputConfig.requests,h=d.requests,f=[];delete d.config;for(const _ of h){const b=Object.assign({},_),x=b.request;for(const C in b)C!=="request"&&(x[C]=b[C],delete b[C]);f.push(b)}return d.requests=f,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const s=t?Object.assign({},t):{},r=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${r}`),s.dest===void 0){const o=this.getGcsUri(e),u=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?s.dest=`${o.slice(0,-6)}/dest`:s.dest=`${o}_dest_${r}`;else if(u)s.dest=`${u}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=_R(this.apiClient,e);return d=xe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>gp(_))}else{const f=FT(this.apiClient,e);return d=xe("{model}:batchGenerateContent",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>mu(_))}}async createEmbeddingsInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Gm(this.apiClient,e);return o=xe("{model}:asyncBatchEmbedContent",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>mu(h))}}async get(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=MR(this.apiClient,e);return d=xe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>gp(_))}else{const f=DR(this.apiClient,e);return d=xe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>mu(_))}}async cancel(e){var t,s,r,o;let u="",d={};if(this.apiClient.isVertexAI()){const h=mR(this.apiClient,e);u=xe("batchPredictionJobs/{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const h=hR(this.apiClient,e);u=xe("batches/{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=BR(e);return d=xe("batchPredictionJobs",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=qR(_),x=new LT;return Object.assign(x,b),x})}else{const f=FR(e);return d=xe("batches",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=jR(_),x=new LT;return Object.assign(x,b),x})}}async delete(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=xR(this.apiClient,e);return d=xe("batchPredictionJobs/{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>SR(_))}else{const f=bR(this.apiClient,e);return d=xe("batches/{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>ER(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KR(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function BT(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>m1(o))),y(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&y(e,["role"],s),e}function YR(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&y(e,["ttl"],s);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&y(e,["expireTime"],r);const o=m(n,["displayName"]);e!==void 0&&o!=null&&y(e,["displayName"],o);const u=m(n,["contents"]);if(e!==void 0&&u!=null){let _=os(u);Array.isArray(_)&&(_=_.map(b=>BT(b))),y(e,["contents"],_)}const d=m(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],BT(vn(d)));const h=m(n,["tools"]);if(e!==void 0&&h!=null){let _=h;Array.isArray(_)&&(_=_.map(b=>p1(b))),y(e,["tools"],_)}const f=m(n,["toolConfig"]);if(e!==void 0&&f!=null&&y(e,["toolConfig"],f),m(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function JR(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&y(e,["ttl"],s);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&y(e,["expireTime"],r);const o=m(n,["displayName"]);e!==void 0&&o!=null&&y(e,["displayName"],o);const u=m(n,["contents"]);if(e!==void 0&&u!=null){let b=os(u);Array.isArray(b)&&(b=b.map(x=>x)),y(e,["contents"],b)}const d=m(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],vn(d));const h=m(n,["tools"]);if(e!==void 0&&h!=null){let b=h;Array.isArray(b)&&(b=b.map(x=>g1(x))),y(e,["tools"],b)}const f=m(n,["toolConfig"]);e!==void 0&&f!=null&&y(e,["toolConfig"],f);const _=m(n,["kmsKeyName"]);return e!==void 0&&_!=null&&y(e,["encryption_spec","kmsKeyName"],_),t}function QR(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["model"],Bx(n,s));const r=m(e,["config"]);return r!=null&&YR(r,t),t}function XR(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["model"],Bx(n,s));const r=m(e,["config"]);return r!=null&&JR(r,t),t}function WR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],Fi(n,s)),t}function ZR(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],Fi(n,s)),t}function e1(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function t1(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function n1(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function s1(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["parameters"]);r!=null&&y(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const d=m(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function i1(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],Fi(n,s)),t}function r1(n,e){const t={},s=m(e,["name"]);return s!=null&&y(t,["_url","name"],Fi(n,s)),t}function a1(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function o1(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function l1(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&y(e,["_query","pageToken"],r),t}function u1(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&y(e,["_query","pageToken"],r),t}function c1(n){const e={},t=m(n,["config"]);return t!=null&&l1(t,e),e}function d1(n){const e={},t=m(n,["config"]);return t!=null&&u1(t,e),e}function f1(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>u)),y(e,["cachedContents"],o)}return e}function h1(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>u)),y(e,["cachedContents"],o)}return e}function m1(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const s=m(n,["thought"]);s!=null&&y(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&y(e,["inlineData"],KR(r));const o=m(n,["fileData"]);o!=null&&y(e,["fileData"],n1(o));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=m(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const h=m(n,["codeExecutionResult"]);h!=null&&y(e,["codeExecutionResult"],h);const f=m(n,["executableCode"]);f!=null&&y(e,["executableCode"],f);const _=m(n,["functionResponse"]);_!=null&&y(e,["functionResponse"],_);const b=m(n,["text"]);return b!=null&&y(e,["text"],b),e}function p1(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["functionDeclarations"],f)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&y(e,["googleSearch"],o1(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&y(e,["googleSearchRetrieval"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(n,["googleMaps"]);o!=null&&y(e,["googleMaps"],a1(o));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=m(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const h=m(n,["codeExecution"]);return h!=null&&y(e,["codeExecution"],h),e}function g1(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let b=t;Array.isArray(b)&&(b=b.map(x=>s1(x))),y(e,["functionDeclarations"],b)}const s=m(n,["retrieval"]);s!=null&&y(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&y(e,["googleSearch"],r);const o=m(n,["googleSearchRetrieval"]);o!=null&&y(e,["googleSearchRetrieval"],o);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=m(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const h=m(n,["urlContext"]);h!=null&&y(e,["urlContext"],h);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const _=m(n,["codeExecution"]);return _!=null&&y(e,["codeExecution"],_),e}function y1(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&y(e,["ttl"],s);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&y(e,["expireTime"],r),t}function v1(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&y(e,["ttl"],s);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&y(e,["expireTime"],r),t}function _1(n,e){const t={},s=m(e,["name"]);s!=null&&y(t,["_url","name"],Fi(n,s));const r=m(e,["config"]);return r!=null&&y1(r,t),t}function T1(n,e){const t={},s=m(e,["name"]);s!=null&&y(t,["_url","name"],Fi(n,s));const r=m(e,["config"]);return r!=null&&v1(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class b1 extends Da{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ou(Sa.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=XR(this.apiClient,e);return d=xe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const f=QR(this.apiClient,e);return d=xe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async get(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=r1(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const f=i1(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async delete(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=ZR(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=t1(_),x=new PT;return Object.assign(x,b),x})}else{const f=WR(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=e1(_),x=new PT;return Object.assign(x,b),x})}}async update(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=T1(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const f=_1(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async listInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=d1(e);return d=xe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=h1(_),x=new kT;return Object.assign(x,b),x})}else{const f=c1(e);return d=xe("cachedContents",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=f1(_),x=new kT;return Object.assign(x,b),x})}}}function jT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bt(n){return this instanceof bt?(this.v=n,this):new bt(n)}function Uo(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",u),r[Symbol.asyncIterator]=function(){return this},r;function u(C){return function(M){return Promise.resolve(M).then(C,b)}}function d(C,M){s[C]&&(r[C]=function(k){return new Promise(function(V,$){o.push([C,k,V,$])>1||h(C,k)})},M&&(r[C]=M(r[C])))}function h(C,M){try{f(s[C](M))}catch(k){x(o[0][3],k)}}function f(C){C.value instanceof bt?Promise.resolve(C.value.v).then(_,b):x(o[0][2],C)}function _(C){h("next",C)}function b(C){h("throw",C)}function x(C,M){C(M),o.shift(),o.length&&h(o[0][0],o[0][1])}}function bu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof jT=="function"?jT(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(o){t[o]=n[o]&&function(u){return new Promise(function(d,h){u=n[o](u),r(d,h,u.done,u.value)})}}function r(o,u,d,h){Promise.resolve(h).then(function(f){o({value:f,done:d})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x1(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Zx(t)}function Zx(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function E1(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function qT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const r=[];let o=!0;for(;s<t&&n[s].role==="model";)r.push(n[s]),o&&!Zx(n[s])&&(o=!1),s++;o?e.push(...r):e.pop()}return e}class S1{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new A1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class A1{constructor(e,t,s,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),E1(o)}async sendMessage(e){var t;await this.sendPromise;const s=vn(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,u,d;const h=await r,f=(u=(o=h.candidates)===null||o===void 0?void 0:o[0])===null||u===void 0?void 0:u.content,_=h.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let x=[];_!=null&&(x=(d=_.slice(b))!==null&&d!==void 0?d:[]);const C=f?[f]:[];this.recordHistory(s,C,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const s=vn(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const o=await r;return this.processStreamResponse(o,s)}getHistory(e=!1){const t=e?qT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var s,r;return Uo(this,arguments,function*(){var u,d,h,f;const _=[];try{for(var b=!0,x=bu(e),C;C=yield bt(x.next()),u=C.done,!u;b=!0){f=C.value,b=!1;const M=f;if(x1(M)){const k=(r=(s=M.candidates)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.content;k!==void 0&&_.push(k)}yield yield bt(M)}}catch(M){d={error:M}}finally{try{!b&&!u&&(h=x.return)&&(yield bt(h.call(x)))}finally{if(d)throw d.error}}this.recordHistory(t,_)})}recordHistory(e,t,s){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...qT(s)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,yf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C1(n){const e={},t=m(n,["file"]);return t!=null&&y(e,["file"],t),e}function w1(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function I1(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","file"],$x(t)),e}function N1(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function R1(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","file"],$x(t)),e}function D1(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&y(e,["_query","pageToken"],r),t}function M1(n){const e={},t=m(n,["config"]);return t!=null&&D1(t,e),e}function P1(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>u)),y(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k1 extends Da{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ou(Sa.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=M1(e);return o=xe("files",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>{const f=P1(h),_=new $N;return Object.assign(_,f),_})}}async createInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=C1(e);return o=xe("upload/v1beta/files",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>{const f=w1(h),_=new KN;return Object.assign(_,f),_})}}async get(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=R1(e);return o=xe("files/{file}",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>h)}}async delete(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=I1(e);return o=xe("files/{file}",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>{const f=N1(h),_=new YN;return Object.assign(_,f),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Md(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function L1(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Q1(o))),y(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&y(e,["role"],s),e}function V1(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function O1(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["parameters"]);r!=null&&y(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const d=m(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function U1(n){const e={},t=m(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const s=m(n,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const r=m(n,["candidateCount"]);r!=null&&y(e,["candidateCount"],r);const o=m(n,["enableAffectiveDialog"]);o!=null&&y(e,["enableAffectiveDialog"],o);const u=m(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=m(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=m(n,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const f=m(n,["mediaResolution"]);f!=null&&y(e,["mediaResolution"],f);const _=m(n,["presencePenalty"]);_!=null&&y(e,["presencePenalty"],_);const b=m(n,["responseJsonSchema"]);b!=null&&y(e,["responseJsonSchema"],b);const x=m(n,["responseLogprobs"]);x!=null&&y(e,["responseLogprobs"],x);const C=m(n,["responseMimeType"]);C!=null&&y(e,["responseMimeType"],C);const M=m(n,["responseModalities"]);M!=null&&y(e,["responseModalities"],M);const k=m(n,["responseSchema"]);k!=null&&y(e,["responseSchema"],k);const V=m(n,["routingConfig"]);V!=null&&y(e,["routingConfig"],V);const $=m(n,["seed"]);$!=null&&y(e,["seed"],$);const U=m(n,["speechConfig"]);U!=null&&y(e,["speechConfig"],eE(U));const B=m(n,["stopSequences"]);B!=null&&y(e,["stopSequences"],B);const K=m(n,["temperature"]);K!=null&&y(e,["temperature"],K);const se=m(n,["thinkingConfig"]);se!=null&&y(e,["thinkingConfig"],se);const H=m(n,["topK"]);H!=null&&y(e,["topK"],H);const R=m(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function F1(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function B1(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function j1(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig"],s);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=m(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=m(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(n,["mediaResolution"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","mediaResolution"],f);const _=m(n,["seed"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","seed"],_);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","speechConfig"],Zp(b));const x=m(n,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const C=m(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const M=m(n,["systemInstruction"]);e!==void 0&&M!=null&&y(e,["setup","systemInstruction"],L1(vn(M)));const k=m(n,["tools"]);if(e!==void 0&&k!=null){let H=tl(k);Array.isArray(H)&&(H=H.map(R=>W1(el(R)))),y(e,["setup","tools"],H)}const V=m(n,["sessionResumption"]);e!==void 0&&V!=null&&y(e,["setup","sessionResumption"],X1(V));const $=m(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const U=m(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&y(e,["setup","outputAudioTranscription"],U);const B=m(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const K=m(n,["contextWindowCompression"]);e!==void 0&&K!=null&&y(e,["setup","contextWindowCompression"],K);const se=m(n,["proactivity"]);return e!==void 0&&se!=null&&y(e,["setup","proactivity"],se),t}function q1(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig"],U1(s));const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=m(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=m(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(n,["mediaResolution"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","mediaResolution"],f);const _=m(n,["seed"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","seed"],_);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","speechConfig"],eE(Zp(b)));const x=m(n,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const C=m(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const M=m(n,["systemInstruction"]);e!==void 0&&M!=null&&y(e,["setup","systemInstruction"],vn(M));const k=m(n,["tools"]);if(e!==void 0&&k!=null){let H=tl(k);Array.isArray(H)&&(H=H.map(R=>Z1(el(R)))),y(e,["setup","tools"],H)}const V=m(n,["sessionResumption"]);e!==void 0&&V!=null&&y(e,["setup","sessionResumption"],V);const $=m(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const U=m(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&y(e,["setup","outputAudioTranscription"],U);const B=m(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const K=m(n,["contextWindowCompression"]);e!==void 0&&K!=null&&y(e,["setup","contextWindowCompression"],K);const se=m(n,["proactivity"]);return e!==void 0&&se!=null&&y(e,["setup","proactivity"],se),t}function H1(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["setup","model"],it(n,s));const r=m(e,["config"]);return r!=null&&y(t,["config"],j1(r,t)),t}function z1(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["setup","model"],it(n,s));const r=m(e,["config"]);return r!=null&&y(t,["config"],q1(r,t)),t}function G1(n){const e={},t=m(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function $1(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>r)),y(e,["weightedPrompts"],s)}return e}function K1(n){const e={},t=m(n,["media"]);if(t!=null){let f=jx(t);Array.isArray(f)&&(f=f.map(_=>Md(_))),y(e,["mediaChunks"],f)}const s=m(n,["audio"]);s!=null&&y(e,["audio"],Md(Hx(s)));const r=m(n,["audioStreamEnd"]);r!=null&&y(e,["audioStreamEnd"],r);const o=m(n,["video"]);o!=null&&y(e,["video"],Md(qx(o)));const u=m(n,["text"]);u!=null&&y(e,["text"],u);const d=m(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const h=m(n,["activityEnd"]);return h!=null&&y(e,["activityEnd"],h),e}function Y1(n){const e={},t=m(n,["media"]);if(t!=null){let f=jx(t);Array.isArray(f)&&(f=f.map(_=>_)),y(e,["mediaChunks"],f)}const s=m(n,["audio"]);s!=null&&y(e,["audio"],Hx(s));const r=m(n,["audioStreamEnd"]);r!=null&&y(e,["audioStreamEnd"],r);const o=m(n,["video"]);o!=null&&y(e,["video"],qx(o));const u=m(n,["text"]);u!=null&&y(e,["text"],u);const d=m(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const h=m(n,["activityEnd"]);return h!=null&&y(e,["activityEnd"],h),e}function J1(n){const e={},t=m(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const s=m(n,["serverContent"]);s!=null&&y(e,["serverContent"],s);const r=m(n,["toolCall"]);r!=null&&y(e,["toolCall"],r);const o=m(n,["toolCallCancellation"]);o!=null&&y(e,["toolCallCancellation"],o);const u=m(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],eD(u));const d=m(n,["goAway"]);d!=null&&y(e,["goAway"],d);const h=m(n,["sessionResumptionUpdate"]);return h!=null&&y(e,["sessionResumptionUpdate"],h),e}function Q1(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const s=m(n,["thought"]);s!=null&&y(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&y(e,["inlineData"],Md(r));const o=m(n,["fileData"]);o!=null&&y(e,["fileData"],V1(o));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=m(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const h=m(n,["codeExecutionResult"]);h!=null&&y(e,["codeExecutionResult"],h);const f=m(n,["executableCode"]);f!=null&&y(e,["executableCode"],f);const _=m(n,["functionResponse"]);_!=null&&y(e,["functionResponse"],_);const b=m(n,["text"]);return b!=null&&y(e,["text"],b),e}function X1(n){const e={},t=m(n,["handle"]);if(t!=null&&y(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function eE(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=m(n,["languageCode"]);return s!=null&&y(e,["languageCode"],s),e}function W1(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["functionDeclarations"],f)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&y(e,["googleSearch"],B1(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&y(e,["googleSearchRetrieval"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(n,["googleMaps"]);o!=null&&y(e,["googleMaps"],F1(o));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=m(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const h=m(n,["codeExecution"]);return h!=null&&y(e,["codeExecution"],h),e}function Z1(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let b=t;Array.isArray(b)&&(b=b.map(x=>O1(x))),y(e,["functionDeclarations"],b)}const s=m(n,["retrieval"]);s!=null&&y(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&y(e,["googleSearch"],r);const o=m(n,["googleSearchRetrieval"]);o!=null&&y(e,["googleSearchRetrieval"],o);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=m(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const h=m(n,["urlContext"]);h!=null&&y(e,["urlContext"],h);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const _=m(n,["codeExecution"]);return _!=null&&y(e,["codeExecution"],_),e}function eD(n){const e={},t=m(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const s=m(n,["cachedContentTokenCount"]);s!=null&&y(e,["cachedContentTokenCount"],s);const r=m(n,["candidatesTokenCount"]);r!=null&&y(e,["responseTokenCount"],r);const o=m(n,["toolUsePromptTokenCount"]);o!=null&&y(e,["toolUsePromptTokenCount"],o);const u=m(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const d=m(n,["totalTokenCount"]);d!=null&&y(e,["totalTokenCount"],d);const h=m(n,["promptTokensDetails"]);if(h!=null){let C=h;Array.isArray(C)&&(C=C.map(M=>M)),y(e,["promptTokensDetails"],C)}const f=m(n,["cacheTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(M=>M)),y(e,["cacheTokensDetails"],C)}const _=m(n,["candidatesTokensDetails"]);if(_!=null){let C=_;Array.isArray(C)&&(C=C.map(M=>M)),y(e,["responseTokensDetails"],C)}const b=m(n,["toolUsePromptTokensDetails"]);if(b!=null){let C=b;Array.isArray(C)&&(C=C.map(M=>M)),y(e,["toolUsePromptTokensDetails"],C)}const x=m(n,["trafficType"]);return x!=null&&y(e,["trafficType"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tD(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function nD(n){const e={},t=m(n,["content"]);t!=null&&y(e,["content"],t);const s=m(n,["citationMetadata"]);s!=null&&y(e,["citationMetadata"],sD(s));const r=m(n,["tokenCount"]);r!=null&&y(e,["tokenCount"],r);const o=m(n,["finishReason"]);o!=null&&y(e,["finishReason"],o);const u=m(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=m(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const h=m(n,["groundingMetadata"]);h!=null&&y(e,["groundingMetadata"],h);const f=m(n,["index"]);f!=null&&y(e,["index"],f);const _=m(n,["logprobsResult"]);_!=null&&y(e,["logprobsResult"],_);const b=m(n,["safetyRatings"]);if(b!=null){let x=b;Array.isArray(x)&&(x=x.map(C=>C)),y(e,["safetyRatings"],x)}return e}function sD(n){const e={},t=m(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>r)),y(e,["citations"],s)}return e}function iD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let o=os(r);Array.isArray(o)&&(o=o.map(u=>u)),y(t,["contents"],o)}return t}function rD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["tokensInfo"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),y(e,["tokensInfo"],r)}return e}function aD(n){const e={},t=m(n,["values"]);t!=null&&y(e,["values"],t);const s=m(n,["statistics"]);return s!=null&&y(e,["statistics"],oD(s)),e}function oD(n){const e={},t=m(n,["truncated"]);t!=null&&y(e,["truncated"],t);const s=m(n,["token_count"]);return s!=null&&y(e,["tokenCount"],s),e}function vf(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>fM(o))),y(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&y(e,["role"],s),e}function lD(n){const e={},t=m(n,["controlType"]);t!=null&&y(e,["controlType"],t);const s=m(n,["enableControlImageComputation"]);return s!=null&&y(e,["computeControl"],s),e}function uD(n){const e={};if(m(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function cD(n,e){const t={},s=m(n,["systemInstruction"]);e!==void 0&&s!=null&&y(e,["systemInstruction"],vn(s));const r=m(n,["tools"]);if(e!==void 0&&r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>rE(d))),y(e,["tools"],u)}const o=m(n,["generationConfig"]);return e!==void 0&&o!=null&&y(e,["generationConfig"],ZD(o)),t}function dD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let u=os(r);Array.isArray(u)&&(u=u.map(d=>vf(d))),y(t,["contents"],u)}const o=m(e,["config"]);return o!=null&&uD(o),t}function fD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let u=os(r);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const o=m(e,["config"]);return o!=null&&cD(o,t),t}function hD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["totalTokens"]);s!=null&&y(e,["totalTokens"],s);const r=m(n,["cachedContentTokenCount"]);return r!=null&&y(e,["cachedContentTokenCount"],r),e}function mD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["totalTokens"]);return s!=null&&y(e,["totalTokens"],s),e}function pD(n,e){const t={},s=m(e,["model"]);return s!=null&&y(t,["_url","name"],it(n,s)),t}function gD(n,e){const t={},s=m(e,["model"]);return s!=null&&y(t,["_url","name"],it(n,s)),t}function yD(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function vD(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function _D(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const r=m(n,["negativePrompt"]);e!==void 0&&r!=null&&y(e,["parameters","negativePrompt"],r);const o=m(n,["numberOfImages"]);e!==void 0&&o!=null&&y(e,["parameters","sampleCount"],o);const u=m(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=m(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const h=m(n,["seed"]);e!==void 0&&h!=null&&y(e,["parameters","seed"],h);const f=m(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&y(e,["parameters","safetySetting"],f);const _=m(n,["personGeneration"]);e!==void 0&&_!=null&&y(e,["parameters","personGeneration"],_);const b=m(n,["includeSafetyAttributes"]);e!==void 0&&b!=null&&y(e,["parameters","includeSafetyAttributes"],b);const x=m(n,["includeRaiReason"]);e!==void 0&&x!=null&&y(e,["parameters","includeRaiReason"],x);const C=m(n,["language"]);e!==void 0&&C!=null&&y(e,["parameters","language"],C);const M=m(n,["outputMimeType"]);e!==void 0&&M!=null&&y(e,["parameters","outputOptions","mimeType"],M);const k=m(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&y(e,["parameters","outputOptions","compressionQuality"],k);const V=m(n,["addWatermark"]);e!==void 0&&V!=null&&y(e,["parameters","addWatermark"],V);const $=m(n,["labels"]);e!==void 0&&$!=null&&y(e,["labels"],$);const U=m(n,["editMode"]);e!==void 0&&U!=null&&y(e,["parameters","editMode"],U);const B=m(n,["baseSteps"]);return e!==void 0&&B!=null&&y(e,["parameters","editConfig","baseSteps"],B),t}function TD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["prompt"]);r!=null&&y(t,["instances[0]","prompt"],r);const o=m(e,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(h=>vM(h))),y(t,["instances[0]","referenceImages"],d)}const u=m(e,["config"]);return u!=null&&_D(u,t),t}function bD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>_f(o))),y(e,["generatedImages"],r)}return e}function xD(n,e){const t={},s=m(n,["taskType"]);e!==void 0&&s!=null&&y(e,["requests[]","taskType"],s);const r=m(n,["title"]);e!==void 0&&r!=null&&y(e,["requests[]","title"],r);const o=m(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&y(e,["requests[]","outputDimensionality"],o),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function ED(n,e){const t={},s=m(n,["taskType"]);e!==void 0&&s!=null&&y(e,["instances[]","task_type"],s);const r=m(n,["title"]);e!==void 0&&r!=null&&y(e,["instances[]","title"],r);const o=m(n,["outputDimensionality"]);e!==void 0&&o!=null&&y(e,["parameters","outputDimensionality"],o);const u=m(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const d=m(n,["autoTruncate"]);return e!==void 0&&d!=null&&y(e,["parameters","autoTruncate"],d),t}function SD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let d=Qp(n,r);Array.isArray(d)&&(d=d.map(h=>h)),y(t,["requests[]","content"],d)}const o=m(e,["config"]);o!=null&&xD(o,t);const u=m(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],it(n,u)),t}function AD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let u=Qp(n,r);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["instances[]","content"],u)}const o=m(e,["config"]);return o!=null&&ED(o,t),t}function CD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>u)),y(e,["embeddings"],o)}const r=m(n,["metadata"]);return r!=null&&y(e,["metadata"],r),e}function wD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["predictions[]","embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>aD(u))),y(e,["embeddings"],o)}const r=m(n,["metadata"]);return r!=null&&y(e,["metadata"],r),e}function ID(n){const e={},t=m(n,["endpoint"]);t!=null&&y(e,["name"],t);const s=m(n,["deployedModelId"]);return s!=null&&y(e,["deployedModelId"],s),e}function ND(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function RD(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["parameters"]);r!=null&&y(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const d=m(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function DD(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&y(t,["systemInstruction"],vf(vn(r)));const o=m(e,["temperature"]);o!=null&&y(s,["temperature"],o);const u=m(e,["topP"]);u!=null&&y(s,["topP"],u);const d=m(e,["topK"]);d!=null&&y(s,["topK"],d);const h=m(e,["candidateCount"]);h!=null&&y(s,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&y(s,["maxOutputTokens"],f);const _=m(e,["stopSequences"]);_!=null&&y(s,["stopSequences"],_);const b=m(e,["responseLogprobs"]);b!=null&&y(s,["responseLogprobs"],b);const x=m(e,["logprobs"]);x!=null&&y(s,["logprobs"],x);const C=m(e,["presencePenalty"]);C!=null&&y(s,["presencePenalty"],C);const M=m(e,["frequencyPenalty"]);M!=null&&y(s,["frequencyPenalty"],M);const k=m(e,["seed"]);k!=null&&y(s,["seed"],k);const V=m(e,["responseMimeType"]);V!=null&&y(s,["responseMimeType"],V);const $=m(e,["responseSchema"]);$!=null&&y(s,["responseSchema"],Xp($));const U=m(e,["responseJsonSchema"]);if(U!=null&&y(s,["responseJsonSchema"],U),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const B=m(e,["safetySettings"]);if(t!==void 0&&B!=null){let j=B;Array.isArray(j)&&(j=j.map(O=>_M(O))),y(t,["safetySettings"],j)}const K=m(e,["tools"]);if(t!==void 0&&K!=null){let j=tl(K);Array.isArray(j)&&(j=j.map(O=>AM(el(O)))),y(t,["tools"],j)}const se=m(e,["toolConfig"]);if(t!==void 0&&se!=null&&y(t,["toolConfig"],se),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=m(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],Fi(n,H));const R=m(e,["responseModalities"]);R!=null&&y(s,["responseModalities"],R);const N=m(e,["mediaResolution"]);N!=null&&y(s,["mediaResolution"],N);const D=m(e,["speechConfig"]);if(D!=null&&y(s,["speechConfig"],Wp(D)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=m(e,["thinkingConfig"]);w!=null&&y(s,["thinkingConfig"],w);const L=m(e,["imageConfig"]);return L!=null&&y(s,["imageConfig"],L),s}function MD(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&y(t,["systemInstruction"],vn(r));const o=m(e,["temperature"]);o!=null&&y(s,["temperature"],o);const u=m(e,["topP"]);u!=null&&y(s,["topP"],u);const d=m(e,["topK"]);d!=null&&y(s,["topK"],d);const h=m(e,["candidateCount"]);h!=null&&y(s,["candidateCount"],h);const f=m(e,["maxOutputTokens"]);f!=null&&y(s,["maxOutputTokens"],f);const _=m(e,["stopSequences"]);_!=null&&y(s,["stopSequences"],_);const b=m(e,["responseLogprobs"]);b!=null&&y(s,["responseLogprobs"],b);const x=m(e,["logprobs"]);x!=null&&y(s,["logprobs"],x);const C=m(e,["presencePenalty"]);C!=null&&y(s,["presencePenalty"],C);const M=m(e,["frequencyPenalty"]);M!=null&&y(s,["frequencyPenalty"],M);const k=m(e,["seed"]);k!=null&&y(s,["seed"],k);const V=m(e,["responseMimeType"]);V!=null&&y(s,["responseMimeType"],V);const $=m(e,["responseSchema"]);$!=null&&y(s,["responseSchema"],Xp($));const U=m(e,["responseJsonSchema"]);U!=null&&y(s,["responseJsonSchema"],U);const B=m(e,["routingConfig"]);B!=null&&y(s,["routingConfig"],B);const K=m(e,["modelSelectionConfig"]);K!=null&&y(s,["modelConfig"],K);const se=m(e,["safetySettings"]);if(t!==void 0&&se!=null){let Z=se;Array.isArray(Z)&&(Z=Z.map(Q=>Q)),y(t,["safetySettings"],Z)}const H=m(e,["tools"]);if(t!==void 0&&H!=null){let Z=tl(H);Array.isArray(Z)&&(Z=Z.map(Q=>rE(el(Q)))),y(t,["tools"],Z)}const R=m(e,["toolConfig"]);t!==void 0&&R!=null&&y(t,["toolConfig"],R);const N=m(e,["labels"]);t!==void 0&&N!=null&&y(t,["labels"],N);const D=m(e,["cachedContent"]);t!==void 0&&D!=null&&y(t,["cachedContent"],Fi(n,D));const w=m(e,["responseModalities"]);w!=null&&y(s,["responseModalities"],w);const L=m(e,["mediaResolution"]);L!=null&&y(s,["mediaResolution"],L);const j=m(e,["speechConfig"]);j!=null&&y(s,["speechConfig"],iE(Wp(j)));const O=m(e,["audioTimestamp"]);O!=null&&y(s,["audioTimestamp"],O);const Pe=m(e,["thinkingConfig"]);Pe!=null&&y(s,["thinkingConfig"],Pe);const We=m(e,["imageConfig"]);return We!=null&&y(s,["imageConfig"],We),s}function HT(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let u=os(r);Array.isArray(u)&&(u=u.map(d=>vf(d))),y(t,["contents"],u)}const o=m(e,["config"]);return o!=null&&y(t,["generationConfig"],DD(n,o,t)),t}function zT(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["contents"]);if(r!=null){let u=os(r);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const o=m(e,["config"]);return o!=null&&y(t,["generationConfig"],MD(n,o,t)),t}function GT(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(f=>nD(f))),y(e,["candidates"],h)}const r=m(n,["modelVersion"]);r!=null&&y(e,["modelVersion"],r);const o=m(n,["promptFeedback"]);o!=null&&y(e,["promptFeedback"],o);const u=m(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=m(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function $T(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["candidates"],f)}const r=m(n,["createTime"]);r!=null&&y(e,["createTime"],r);const o=m(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const u=m(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const d=m(n,["responseId"]);d!=null&&y(e,["responseId"],d);const h=m(n,["usageMetadata"]);return h!=null&&y(e,["usageMetadata"],h),e}function PD(n,e){const t={};if(m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=m(n,["numberOfImages"]);e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s);const r=m(n,["aspectRatio"]);e!==void 0&&r!=null&&y(e,["parameters","aspectRatio"],r);const o=m(n,["guidanceScale"]);if(e!==void 0&&o!=null&&y(e,["parameters","guidanceScale"],o),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=m(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const d=m(n,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const h=m(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&y(e,["parameters","includeSafetyAttributes"],h);const f=m(n,["includeRaiReason"]);e!==void 0&&f!=null&&y(e,["parameters","includeRaiReason"],f);const _=m(n,["language"]);e!==void 0&&_!=null&&y(e,["parameters","language"],_);const b=m(n,["outputMimeType"]);e!==void 0&&b!=null&&y(e,["parameters","outputOptions","mimeType"],b);const x=m(n,["outputCompressionQuality"]);if(e!==void 0&&x!=null&&y(e,["parameters","outputOptions","compressionQuality"],x),m(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=m(n,["imageSize"]);if(e!==void 0&&C!=null&&y(e,["parameters","sampleImageSize"],C),m(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function kD(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const r=m(n,["negativePrompt"]);e!==void 0&&r!=null&&y(e,["parameters","negativePrompt"],r);const o=m(n,["numberOfImages"]);e!==void 0&&o!=null&&y(e,["parameters","sampleCount"],o);const u=m(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=m(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const h=m(n,["seed"]);e!==void 0&&h!=null&&y(e,["parameters","seed"],h);const f=m(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&y(e,["parameters","safetySetting"],f);const _=m(n,["personGeneration"]);e!==void 0&&_!=null&&y(e,["parameters","personGeneration"],_);const b=m(n,["includeSafetyAttributes"]);e!==void 0&&b!=null&&y(e,["parameters","includeSafetyAttributes"],b);const x=m(n,["includeRaiReason"]);e!==void 0&&x!=null&&y(e,["parameters","includeRaiReason"],x);const C=m(n,["language"]);e!==void 0&&C!=null&&y(e,["parameters","language"],C);const M=m(n,["outputMimeType"]);e!==void 0&&M!=null&&y(e,["parameters","outputOptions","mimeType"],M);const k=m(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&y(e,["parameters","outputOptions","compressionQuality"],k);const V=m(n,["addWatermark"]);e!==void 0&&V!=null&&y(e,["parameters","addWatermark"],V);const $=m(n,["labels"]);e!==void 0&&$!=null&&y(e,["labels"],$);const U=m(n,["imageSize"]);e!==void 0&&U!=null&&y(e,["parameters","sampleImageSize"],U);const B=m(n,["enhancePrompt"]);return e!==void 0&&B!=null&&y(e,["parameters","enhancePrompt"],B),t}function LD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["prompt"]);r!=null&&y(t,["instances[0]","prompt"],r);const o=m(e,["config"]);return o!=null&&PD(o,t),t}function VD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["prompt"]);r!=null&&y(t,["instances[0]","prompt"],r);const o=m(e,["config"]);return o!=null&&kD(o,t),t}function OD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>JD(u))),y(e,["generatedImages"],o)}const r=m(n,["positivePromptSafetyAttributes"]);return r!=null&&y(e,["positivePromptSafetyAttributes"],nE(r)),e}function UD(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>_f(u))),y(e,["generatedImages"],o)}const r=m(n,["positivePromptSafetyAttributes"]);return r!=null&&y(e,["positivePromptSafetyAttributes"],sE(r)),e}function FD(n,e){const t={},s=m(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s),m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=m(n,["durationSeconds"]);if(e!==void 0&&r!=null&&y(e,["parameters","durationSeconds"],r),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const u=m(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const d=m(n,["personGeneration"]);if(e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d),m(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(n,["negativePrompt"]);e!==void 0&&h!=null&&y(e,["parameters","negativePrompt"],h);const f=m(n,["enhancePrompt"]);if(e!==void 0&&f!=null&&y(e,["parameters","enhancePrompt"],f),m(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=m(n,["lastFrame"]);e!==void 0&&_!=null&&y(e,["instances[0]","lastFrame"],Tf(_));const b=m(n,["referenceImages"]);if(e!==void 0&&b!=null){let x=b;Array.isArray(x)&&(x=x.map(C=>UM(C))),y(e,["instances[0]","referenceImages"],x)}if(m(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function BD(n,e){const t={},s=m(n,["numberOfVideos"]);e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s);const r=m(n,["outputGcsUri"]);e!==void 0&&r!=null&&y(e,["parameters","storageUri"],r);const o=m(n,["fps"]);e!==void 0&&o!=null&&y(e,["parameters","fps"],o);const u=m(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const d=m(n,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=m(n,["aspectRatio"]);e!==void 0&&h!=null&&y(e,["parameters","aspectRatio"],h);const f=m(n,["resolution"]);e!==void 0&&f!=null&&y(e,["parameters","resolution"],f);const _=m(n,["personGeneration"]);e!==void 0&&_!=null&&y(e,["parameters","personGeneration"],_);const b=m(n,["pubsubTopic"]);e!==void 0&&b!=null&&y(e,["parameters","pubsubTopic"],b);const x=m(n,["negativePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","negativePrompt"],x);const C=m(n,["enhancePrompt"]);e!==void 0&&C!=null&&y(e,["parameters","enhancePrompt"],C);const M=m(n,["generateAudio"]);e!==void 0&&M!=null&&y(e,["parameters","generateAudio"],M);const k=m(n,["lastFrame"]);e!==void 0&&k!=null&&y(e,["instances[0]","lastFrame"],As(k));const V=m(n,["referenceImages"]);if(e!==void 0&&V!=null){let B=V;Array.isArray(B)&&(B=B.map(K=>FM(K))),y(e,["instances[0]","referenceImages"],B)}const $=m(n,["mask"]);e!==void 0&&$!=null&&y(e,["instances[0]","mask"],OM($));const U=m(n,["compressionQuality"]);return e!==void 0&&U!=null&&y(e,["parameters","compressionQuality"],U),t}function jD(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["metadata"]);s!=null&&y(e,["metadata"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);o!=null&&y(e,["error"],o);const u=m(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],GD(u)),e}function qD(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["metadata"]);s!=null&&y(e,["metadata"],s);const r=m(n,["done"]);r!=null&&y(e,["done"],r);const o=m(n,["error"]);o!=null&&y(e,["error"],o);const u=m(n,["response"]);return u!=null&&y(e,["response"],$D(u)),e}function HD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["prompt"]);r!=null&&y(t,["instances[0]","prompt"],r);const o=m(e,["image"]);o!=null&&y(t,["instances[0]","image"],Tf(o));const u=m(e,["video"]);u!=null&&y(t,["instances[0]","video"],aE(u));const d=m(e,["source"]);d!=null&&KD(d,t);const h=m(e,["config"]);return h!=null&&FD(h,t),t}function zD(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["prompt"]);r!=null&&y(t,["instances[0]","prompt"],r);const o=m(e,["image"]);o!=null&&y(t,["instances[0]","image"],As(o));const u=m(e,["video"]);u!=null&&y(t,["instances[0]","video"],oE(u));const d=m(e,["source"]);d!=null&&YD(d,t);const h=m(e,["config"]);return h!=null&&BD(h,t),t}function GD(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(u=>XD(u))),y(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&y(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&y(e,["raiMediaFilteredReasons"],r),e}function $D(n){const e={},t=m(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(u=>WD(u))),y(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&y(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&y(e,["raiMediaFilteredReasons"],r),e}function KD(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&y(e,["instances[0]","prompt"],s);const r=m(n,["image"]);e!==void 0&&r!=null&&y(e,["instances[0]","image"],Tf(r));const o=m(n,["video"]);return e!==void 0&&o!=null&&y(e,["instances[0]","video"],aE(o)),t}function YD(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&y(e,["instances[0]","prompt"],s);const r=m(n,["image"]);e!==void 0&&r!=null&&y(e,["instances[0]","image"],As(r));const o=m(n,["video"]);return e!==void 0&&o!=null&&y(e,["instances[0]","video"],oE(o)),t}function JD(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["image"],iM(t));const s=m(n,["raiFilteredReason"]);s!=null&&y(e,["raiFilteredReason"],s);const r=m(n,["_self"]);return r!=null&&y(e,["safetyAttributes"],nE(r)),e}function _f(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["image"],tE(t));const s=m(n,["raiFilteredReason"]);s!=null&&y(e,["raiFilteredReason"],s);const r=m(n,["_self"]);r!=null&&y(e,["safetyAttributes"],sE(r));const o=m(n,["prompt"]);return o!=null&&y(e,["enhancedPrompt"],o),e}function QD(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["mask"],tE(t));const s=m(n,["labels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),y(e,["labels"],r)}return e}function XD(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],LM(t)),e}function WD(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],VM(t)),e}function ZD(n){const e={},t=m(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const s=m(n,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const r=m(n,["candidateCount"]);r!=null&&y(e,["candidateCount"],r);const o=m(n,["enableAffectiveDialog"]);o!=null&&y(e,["enableAffectiveDialog"],o);const u=m(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=m(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const h=m(n,["maxOutputTokens"]);h!=null&&y(e,["maxOutputTokens"],h);const f=m(n,["mediaResolution"]);f!=null&&y(e,["mediaResolution"],f);const _=m(n,["presencePenalty"]);_!=null&&y(e,["presencePenalty"],_);const b=m(n,["responseJsonSchema"]);b!=null&&y(e,["responseJsonSchema"],b);const x=m(n,["responseLogprobs"]);x!=null&&y(e,["responseLogprobs"],x);const C=m(n,["responseMimeType"]);C!=null&&y(e,["responseMimeType"],C);const M=m(n,["responseModalities"]);M!=null&&y(e,["responseModalities"],M);const k=m(n,["responseSchema"]);k!=null&&y(e,["responseSchema"],k);const V=m(n,["routingConfig"]);V!=null&&y(e,["routingConfig"],V);const $=m(n,["seed"]);$!=null&&y(e,["seed"],$);const U=m(n,["speechConfig"]);U!=null&&y(e,["speechConfig"],iE(U));const B=m(n,["stopSequences"]);B!=null&&y(e,["stopSequences"],B);const K=m(n,["temperature"]);K!=null&&y(e,["temperature"],K);const se=m(n,["thinkingConfig"]);se!=null&&y(e,["thinkingConfig"],se);const H=m(n,["topK"]);H!=null&&y(e,["topK"],H);const R=m(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function eM(n,e){const t={},s=m(e,["model"]);return s!=null&&y(t,["_url","name"],it(n,s)),t}function tM(n,e){const t={},s=m(e,["model"]);return s!=null&&y(t,["_url","name"],it(n,s)),t}function nM(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function sM(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iM(n){const e={},t=m(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Ur(t));const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function tE(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const s=m(n,["bytesBase64Encoded"]);s!=null&&y(e,["imageBytes"],Ur(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function Tf(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Ur(t));const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function As(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const s=m(n,["imageBytes"]);s!=null&&y(e,["bytesBase64Encoded"],Ur(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function rM(n,e,t){const s={},r=m(e,["pageSize"]);t!==void 0&&r!=null&&y(t,["_query","pageSize"],r);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&y(t,["_query","pageToken"],o);const u=m(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=m(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],Kx(n,d)),s}function aM(n,e,t){const s={},r=m(e,["pageSize"]);t!==void 0&&r!=null&&y(t,["_query","pageSize"],r);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&y(t,["_query","pageToken"],o);const u=m(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=m(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],Kx(n,d)),s}function oM(n,e){const t={},s=m(e,["config"]);return s!=null&&rM(n,s,t),t}function lM(n,e){const t={},s=m(e,["config"]);return s!=null&&aM(n,s,t),t}function uM(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["_self"]);if(r!=null){let o=Yx(r);Array.isArray(o)&&(o=o.map(u=>yp(u))),y(e,["models"],o)}return e}function cM(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["_self"]);if(r!=null){let o=Yx(r);Array.isArray(o)&&(o=o.map(u=>vp(u))),y(e,["models"],o)}return e}function dM(n){const e={},t=m(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const s=m(n,["segmentationClasses"]);s!=null&&y(e,["maskClasses"],s);const r=m(n,["maskDilation"]);return r!=null&&y(e,["dilation"],r),e}function yp(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["displayName"]);s!=null&&y(e,["displayName"],s);const r=m(n,["description"]);r!=null&&y(e,["description"],r);const o=m(n,["version"]);o!=null&&y(e,["version"],o);const u=m(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],CM(u));const d=m(n,["inputTokenLimit"]);d!=null&&y(e,["inputTokenLimit"],d);const h=m(n,["outputTokenLimit"]);h!=null&&y(e,["outputTokenLimit"],h);const f=m(n,["supportedGenerationMethods"]);return f!=null&&y(e,["supportedActions"],f),e}function vp(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const s=m(n,["displayName"]);s!=null&&y(e,["displayName"],s);const r=m(n,["description"]);r!=null&&y(e,["description"],r);const o=m(n,["versionId"]);o!=null&&y(e,["version"],o);const u=m(n,["deployedModels"]);if(u!=null){let b=u;Array.isArray(b)&&(b=b.map(x=>ID(x))),y(e,["endpoints"],b)}const d=m(n,["labels"]);d!=null&&y(e,["labels"],d);const h=m(n,["_self"]);h!=null&&y(e,["tunedModelInfo"],wM(h));const f=m(n,["defaultCheckpointId"]);f!=null&&y(e,["defaultCheckpointId"],f);const _=m(n,["checkpoints"]);if(_!=null){let b=_;Array.isArray(b)&&(b=b.map(x=>x)),y(e,["checkpoints"],b)}return e}function fM(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const s=m(n,["thought"]);s!=null&&y(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&y(e,["inlineData"],tD(r));const o=m(n,["fileData"]);o!=null&&y(e,["fileData"],ND(o));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=m(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const h=m(n,["codeExecutionResult"]);h!=null&&y(e,["codeExecutionResult"],h);const f=m(n,["executableCode"]);f!=null&&y(e,["executableCode"],f);const _=m(n,["functionResponse"]);_!=null&&y(e,["functionResponse"],_);const b=m(n,["text"]);return b!=null&&y(e,["text"],b),e}function hM(n){const e={},t=m(n,["productImage"]);return t!=null&&y(e,["image"],As(t)),e}function mM(n,e){const t={},s=m(n,["numberOfImages"]);e!==void 0&&s!=null&&y(e,["parameters","sampleCount"],s);const r=m(n,["baseSteps"]);e!==void 0&&r!=null&&y(e,["parameters","editConfig","baseSteps"],r);const o=m(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const u=m(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const d=m(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const h=m(n,["personGeneration"]);e!==void 0&&h!=null&&y(e,["parameters","personGeneration"],h);const f=m(n,["addWatermark"]);e!==void 0&&f!=null&&y(e,["parameters","addWatermark"],f);const _=m(n,["outputMimeType"]);e!==void 0&&_!=null&&y(e,["parameters","outputOptions","mimeType"],_);const b=m(n,["outputCompressionQuality"]);e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b);const x=m(n,["enhancePrompt"]);e!==void 0&&x!=null&&y(e,["parameters","enhancePrompt"],x);const C=m(n,["labels"]);return e!==void 0&&C!=null&&y(e,["labels"],C),t}function pM(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["source"]);r!=null&&yM(r,t);const o=m(e,["config"]);return o!=null&&mM(o,t),t}function gM(n){const e={},t=m(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>_f(r))),y(e,["generatedImages"],s)}return e}function yM(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&y(e,["instances[0]","prompt"],s);const r=m(n,["personImage"]);e!==void 0&&r!=null&&y(e,["instances[0]","personImage","image"],As(r));const o=m(n,["productImages"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>hM(d))),y(e,["instances[0]","productImages"],u)}return t}function vM(n){const e={},t=m(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],As(t));const s=m(n,["referenceId"]);s!=null&&y(e,["referenceId"],s);const r=m(n,["referenceType"]);r!=null&&y(e,["referenceType"],r);const o=m(n,["maskImageConfig"]);o!=null&&y(e,["maskImageConfig"],dM(o));const u=m(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],lD(u));const d=m(n,["styleImageConfig"]);d!=null&&y(e,["styleImageConfig"],d);const h=m(n,["subjectImageConfig"]);return h!=null&&y(e,["subjectImageConfig"],h),e}function nE(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const s=m(n,["safetyAttributes","scores"]);s!=null&&y(e,["scores"],s);const r=m(n,["contentType"]);return r!=null&&y(e,["contentType"],r),e}function sE(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const s=m(n,["safetyAttributes","scores"]);s!=null&&y(e,["scores"],s);const r=m(n,["contentType"]);return r!=null&&y(e,["contentType"],r),e}function _M(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&y(e,["category"],t);const s=m(n,["threshold"]);return s!=null&&y(e,["threshold"],s),e}function TM(n){const e={},t=m(n,["image"]);return t!=null&&y(e,["image"],As(t)),e}function bM(n,e){const t={},s=m(n,["mode"]);e!==void 0&&s!=null&&y(e,["parameters","mode"],s);const r=m(n,["maxPredictions"]);e!==void 0&&r!=null&&y(e,["parameters","maxPredictions"],r);const o=m(n,["confidenceThreshold"]);e!==void 0&&o!=null&&y(e,["parameters","confidenceThreshold"],o);const u=m(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const d=m(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&y(e,["parameters","binaryColorThreshold"],d);const h=m(n,["labels"]);return e!==void 0&&h!=null&&y(e,["labels"],h),t}function xM(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["source"]);r!=null&&SM(r,t);const o=m(e,["config"]);return o!=null&&bM(o,t),t}function EM(n){const e={},t=m(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>QD(r))),y(e,["generatedMasks"],s)}return e}function SM(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&y(e,["instances[0]","prompt"],s);const r=m(n,["image"]);e!==void 0&&r!=null&&y(e,["instances[0]","image"],As(r));const o=m(n,["scribbleImage"]);return e!==void 0&&o!=null&&y(e,["instances[0]","scribble"],TM(o)),t}function iE(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=m(n,["languageCode"]);return s!=null&&y(e,["languageCode"],s),e}function AM(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["functionDeclarations"],f)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&y(e,["googleSearch"],sM(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&y(e,["googleSearchRetrieval"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(n,["googleMaps"]);o!=null&&y(e,["googleMaps"],nM(o));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=m(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const h=m(n,["codeExecution"]);return h!=null&&y(e,["codeExecution"],h),e}function rE(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let b=t;Array.isArray(b)&&(b=b.map(x=>RD(x))),y(e,["functionDeclarations"],b)}const s=m(n,["retrieval"]);s!=null&&y(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&y(e,["googleSearch"],r);const o=m(n,["googleSearchRetrieval"]);o!=null&&y(e,["googleSearchRetrieval"],o);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=m(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const h=m(n,["urlContext"]);h!=null&&y(e,["urlContext"],h);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const _=m(n,["codeExecution"]);return _!=null&&y(e,["codeExecution"],_),e}function CM(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const s=m(n,["createTime"]);s!=null&&y(e,["createTime"],s);const r=m(n,["updateTime"]);return r!=null&&y(e,["updateTime"],r),e}function wM(n){const e={},t=m(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const s=m(n,["createTime"]);s!=null&&y(e,["createTime"],s);const r=m(n,["updateTime"]);return r!=null&&y(e,["updateTime"],r),e}function IM(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const r=m(n,["description"]);e!==void 0&&r!=null&&y(e,["description"],r);const o=m(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&y(e,["defaultCheckpointId"],o),t}function NM(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const r=m(n,["description"]);e!==void 0&&r!=null&&y(e,["description"],r);const o=m(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&y(e,["defaultCheckpointId"],o),t}function RM(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","name"],it(n,s));const r=m(e,["config"]);return r!=null&&IM(r,t),t}function DM(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["config"]);return r!=null&&NM(r,t),t}function MM(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const r=m(n,["includeRaiReason"]);e!==void 0&&r!=null&&y(e,["parameters","includeRaiReason"],r);const o=m(n,["outputMimeType"]);e!==void 0&&o!=null&&y(e,["parameters","outputOptions","mimeType"],o);const u=m(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const d=m(n,["enhanceInputImage"]);e!==void 0&&d!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],d);const h=m(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const f=m(n,["labels"]);e!==void 0&&f!=null&&y(e,["labels"],f);const _=m(n,["numberOfImages"]);e!==void 0&&_!=null&&y(e,["parameters","sampleCount"],_);const b=m(n,["mode"]);return e!==void 0&&b!=null&&y(e,["parameters","mode"],b),t}function PM(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["_url","model"],it(n,s));const r=m(e,["image"]);r!=null&&y(t,["instances[0]","image"],As(r));const o=m(e,["upscaleFactor"]);o!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],o);const u=m(e,["config"]);return u!=null&&MM(u,t),t}function kM(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>_f(o))),y(e,["generatedImages"],r)}return e}function LM(n){const e={},t=m(n,["video","uri"]);t!=null&&y(e,["uri"],t);const s=m(n,["video","encodedVideo"]);s!=null&&y(e,["videoBytes"],Ur(s));const r=m(n,["encoding"]);return r!=null&&y(e,["mimeType"],r),e}function VM(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const s=m(n,["bytesBase64Encoded"]);s!=null&&y(e,["videoBytes"],Ur(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}function OM(n){const e={},t=m(n,["image"]);t!=null&&y(e,["_self"],As(t));const s=m(n,["maskMode"]);return s!=null&&y(e,["maskMode"],s),e}function UM(n){const e={},t=m(n,["image"]);t!=null&&y(e,["image"],Tf(t));const s=m(n,["referenceType"]);return s!=null&&y(e,["referenceType"],s),e}function FM(n){const e={},t=m(n,["image"]);t!=null&&y(e,["image"],As(t));const s=m(n,["referenceType"]);return s!=null&&y(e,["referenceType"],s),e}function aE(n){const e={},t=m(n,["uri"]);t!=null&&y(e,["video","uri"],t);const s=m(n,["videoBytes"]);s!=null&&y(e,["video","encodedVideo"],Ur(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["encoding"],r),e}function oE(n){const e={},t=m(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const s=m(n,["videoBytes"]);s!=null&&y(e,["bytesBase64Encoded"],Ur(s));const r=m(n,["mimeType"]);return r!=null&&y(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BM="Content-Type",jM="X-Server-Timeout",qM="User-Agent",_p="x-goog-api-client",HM="1.24.0",zM=`google-genai-sdk/${HM}`,GM="v1beta1",$M="v1beta",KT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class KM{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:GM,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:$M,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const r=[this.getRequestUrlInternal(t)];return s&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[u,d]of Object.entries(e.queryParams))r.searchParams.append(u,String(d));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[r,o]of Object.entries(t))typeof o=="object"?s[r]=Object.assign(Object.assign({},s[r]),o):o!==void 0&&(s[r]=o);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s){if(t&&t.timeout||s){const r=new AbortController,o=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>r.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=o}return t&&t.extraBody!==null&&YM(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await YT(r),new mp(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await YT(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Uo(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let u="";for(;;){const{done:d,value:h}=yield bt(r.read());if(d){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=o.decode(h,{stream:!0});try{const b=JSON.parse(f);if("error"in b){const x=JSON.parse(JSON.stringify(b.error)),C=x.status,M=x.code,k=`got status: ${C}. ${JSON.stringify(b)}`;if(M>=400&&M<600)throw new yf({message:k,status:M})}}catch(b){if(b.name==="ApiError")throw b}u+=f;let _=u.match(KT);for(;_;){const b=_[1];try{const x=new Response(b,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield bt(new mp(x)),u=u.slice(_[0].length),_=u.match(KT)}catch(x){throw new Error(`exception parsing stream chunk ${b}. ${x}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=zM+" "+this.clientOptions.userAgentExtra;return e[qM]=t,e[_p]=t,e[BM]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))t.append(s,r);e.timeout&&e.timeout>0&&t.append(jM,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var s;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,u=await o.stat(e);r.sizeBytes=String(u.size);const d=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:u.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=d;const h=await this.fetchUploadUrl(r,t);return o.upload(e,h,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var s;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},u=await this.request({path:xe("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:r});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(s=u==null?void 0:u.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function YT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(s);throw t>=400&&t<600?new yf({message:r,status:t}):new Error(r)}}function YM(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(o,u){const d=Object.assign({},o);for(const h in u)if(Object.prototype.hasOwnProperty.call(u,h)){const f=u[h],_=d[h];f&&typeof f=="object"&&!Array.isArray(f)&&_&&typeof _=="object"&&!Array.isArray(_)?d[h]=s(_,f):(_&&f&&typeof _!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof _}, New type: ${typeof f}. Overwriting.`),d[h]=f)}return d}const r=s(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JM="mcp_used/unknown";let QM=!1;function lE(n){for(const e of n)if(XM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return QM}function uE(n){var e;const t=(e=n[_p])!==null&&e!==void 0?e:"";n[_p]=(t+` ${JM}`).trimStart()}function XM(n){return n!==null&&typeof n=="object"&&n instanceof eg}function WM(n,e=100){return Uo(this,arguments,function*(){let s,r=0;for(;r<e;){const o=yield bt(n.listTools({cursor:s}));for(const u of o.tools)yield yield bt(u),r++;if(!o.nextCursor)break;s=o.nextCursor}})}class eg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new eg(e,t)}async initialize(){var e,t,s,r;if(this.mcpTools.length>0)return;const o={},u=[];for(const _ of this.mcpClients)try{for(var d=!0,h=(t=void 0,bu(WM(_))),f;f=await h.next(),e=f.done,!e;d=!0){r=f.value,d=!1;const b=r;u.push(b);const x=b.name;if(o[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);o[x]=_}}catch(b){t={error:b}}finally{try{!d&&!e&&(s=h.return)&&await s.call(h)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),iR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[s.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const u=await r.callTool({name:s.name,arguments:s.args},void 0,o);t.push({functionResponse:{name:s.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function ZM(n,e,t){const s=new QN;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(s,r),e(s)}class eP{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),u=sP(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),h=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${d}`;let f=()=>{};const _=new Promise(B=>{f=B}),b=e.callbacks,x=function(){f({})},C=this.apiClient,M={onopen:x,onmessage:B=>{ZM(C,b.onmessage,B)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(B){},onclose:(s=b==null?void 0:b.onclose)!==null&&s!==void 0?s:function(B){}},k=this.webSocketFactory.create(h,nP(u),M);k.connect(),await _;const U={setup:{model:it(this.apiClient,e.model)}};return k.send(JSON.stringify(U)),new tP(k,this.apiClient)}}class tP{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=$1(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=G1(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(ko.PLAY)}pause(){this.sendPlaybackControl(ko.PAUSE)}stop(){this.sendPlaybackControl(ko.STOP)}resetContext(){this.sendPlaybackControl(ko.RESET_CONTEXT)}close(){this.conn.close()}}function nP(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function sP(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const iP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function rP(n,e,t){const s=new JN;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const o=JSON.parse(r);if(n.isVertexAI()){const u=J1(o);Object.assign(s,u)}else Object.assign(s,o);e(s)}class aP{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new eP(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,r,o,u,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let _;const b=this.apiClient.getHeaders();e.config&&e.config.tools&&lE(e.config.tools)&&uE(b);const x=cP(b);if(this.apiClient.isVertexAI())_=`${h}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const D=this.apiClient.getApiKey();let w="BidiGenerateContent",L="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),w="BidiGenerateContentConstrained",L="access_token"),_=`${h}/ws/google.ai.generativelanguage.${f}.GenerativeService.${w}?${L}=${D}`}let C=()=>{};const M=new Promise(D=>{C=D}),k=e.callbacks,V=function(){var D;(D=k==null?void 0:k.onopen)===null||D===void 0||D.call(k),C({})},$=this.apiClient,U={onopen:V,onmessage:D=>{rP($,k.onmessage,D)},onerror:(t=k==null?void 0:k.onerror)!==null&&t!==void 0?t:function(D){},onclose:(s=k==null?void 0:k.onclose)!==null&&s!==void 0?s:function(D){}},B=this.webSocketFactory.create(_,uP(x),U);B.connect(),await M;let K=it(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&K.startsWith("publishers/")){const D=this.apiClient.getProject(),w=this.apiClient.getLocation();K=`projects/${D}/locations/${w}/`+K}let se={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[zd.AUDIO]}:e.config.responseModalities=[zd.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(d=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[],R=[];for(const D of H)if(this.isCallableTool(D)){const w=D;R.push(await w.tool())}else R.push(D);R.length>0&&(e.config.tools=R);const N={model:K,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?se=z1(this.apiClient,N):se=H1(this.apiClient,N),delete se.config,B.send(JSON.stringify(se)),new lP(B,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const oP={turnComplete:!0};class lP{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=os(t.turns),e.isVertexAI()||(s=s.map(r=>vf(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const o of s){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(iP)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},oP),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Y1(e)}:t={realtimeInput:K1(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function uP(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function cP(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JT=10;function QT(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Fo(u)){r=!0;break}if(!r)return!0;const o=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Fo(n){return"callTool"in n&&typeof n.callTool=="function"}function dP(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Fo(r)))!==null&&s!==void 0?s:!1}function fP(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!Fo(r)))!==null&&s!==void 0?s:!1}function XT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hP extends Da{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,r,o,u,d;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!dP(t)||QT(t.config))return await this.generateContentInternal(h);if(fP(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,_;const b=os(h.contents),x=(o=(r=(s=h.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:JT;let C=0;for(;C<x&&(f=await this.generateContentInternal(h),!(!f.functionCalls||f.functionCalls.length===0));){const M=f.candidates[0].content,k=[];for(const V of(d=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[])if(Fo(V)){const U=await V.callTool(f.functionCalls);k.push(...U)}C++,_={role:"user",parts:k},h.contents=os(h.contents),h.contents.push(M),h.contents.push(_),XT(h.config)&&(b.push(M),b.push(_))}return XT(h.config)&&(f.automaticFunctionCallingHistory=b),f},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),QT(t.config)){const s=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var r;let o;const u=[];if(s!=null&&s.generatedImages)for(const h of s.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((r=h==null?void 0:h.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=h==null?void 0:h.safetyAttributes:u.push(h);let d;return o?d={generatedImages:u,positivePromptSafetyAttributes:o,sdkHttpResponse:s.sdkHttpResponse}:d={generatedImages:u,sdkHttpResponse:s.sdkHttpResponse},d}),this.list=async t=>{var s;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((s=u.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Ou(Sa.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(u),u)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,s,r;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const u=await Promise.all(o.map(async h=>Fo(h)?await h.tool():h)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(d.config.tools=u,e.config&&e.config.tools&&lE(e.config.tools)){const h=(r=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&r!==void 0?r:{};let f=Object.assign({},h);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),uE(f),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return d}async initAfcToolsMap(e){var t,s,r;const o=new Map;for(const u of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(Fo(u)){const d=u,h=await d.tool();for(const f of(r=h.functionDeclarations)!==null&&r!==void 0?r:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,d)}}return o}async processAfcStream(e){var t,s,r;const o=(r=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:JT;let u=!1,d=0;const h=await this.initAfcToolsMap(e);return(function(f,_,b){var x,C;return Uo(this,arguments,function*(){for(var M,k,V,$;d<o;){u&&(d++,u=!1);const se=yield bt(f.processParamsMaybeAddMcpUsage(b)),H=yield bt(f.generateContentStreamInternal(se)),R=[],N=[];try{for(var U=!0,B=(k=void 0,bu(H)),K;K=yield bt(B.next()),M=K.done,!M;U=!0){$=K.value,U=!1;const D=$;if(yield yield bt(D),D.candidates&&(!((x=D.candidates[0])===null||x===void 0)&&x.content)){N.push(D.candidates[0].content);for(const w of(C=D.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(d<o&&w.functionCall){if(!w.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(w.functionCall.name)){const L=yield bt(_.get(w.functionCall.name).callTool([w.functionCall]));R.push(...L)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${w.functionCall.name}`)}}}}catch(D){k={error:D}}finally{try{!U&&!M&&(V=B.return)&&(yield bt(V.call(B)))}finally{if(k)throw k.error}}if(R.length>0){u=!0;const D=new hu;D.candidates=[{content:{role:"user",parts:R}}],yield yield bt(D);const w=[];w.push(...N),w.push({role:"user",parts:R});const L=os(b.contents).concat(w);b.contents=L}else break}})})(this,h,e)}async generateContentInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=zT(this.apiClient,e);return d=xe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=$T(_),x=new hu;return Object.assign(x,b),x})}else{const f=HT(this.apiClient,e);return d=xe("{model}:generateContent",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=GT(_),x=new hu;return Object.assign(x,b),x})}}async generateContentStreamInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=zT(this.apiClient,e);return d=xe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.requestStream({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),u.then(function(b){return Uo(this,arguments,function*(){var x,C,M,k;try{for(var V=!0,$=bu(b),U;U=yield bt($.next()),x=U.done,!x;V=!0){k=U.value,V=!1;const B=k,K=$T(yield bt(B.json()));K.sdkHttpResponse={headers:B.headers};const se=new hu;Object.assign(se,K),yield yield bt(se)}}catch(B){C={error:B}}finally{try{!V&&!x&&(M=$.return)&&(yield bt(M.call($)))}finally{if(C)throw C.error}}})})}else{const f=HT(this.apiClient,e);return d=xe("{model}:streamGenerateContent?alt=sse",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.requestStream({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),u.then(function(b){return Uo(this,arguments,function*(){var x,C,M,k;try{for(var V=!0,$=bu(b),U;U=yield bt($.next()),x=U.done,!x;V=!0){k=U.value,V=!1;const B=k,K=GT(yield bt(B.json()));K.sdkHttpResponse={headers:B.headers};const se=new hu;Object.assign(se,K),yield yield bt(se)}}catch(B){C={error:B}}finally{try{!V&&!x&&(M=$.return)&&(yield bt(M.call($)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=AD(this.apiClient,e);return d=xe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=wD(_),x=new wT;return Object.assign(x,b),x})}else{const f=SD(this.apiClient,e);return d=xe("{model}:batchEmbedContents",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=CD(_),x=new wT;return Object.assign(x,b),x})}}async generateImagesInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=VD(this.apiClient,e);return d=xe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=UD(_),x=new IT;return Object.assign(x,b),x})}else{const f=LD(this.apiClient,e);return d=xe("{model}:predict",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=OD(_),x=new IT;return Object.assign(x,b),x})}}async editImageInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=TD(this.apiClient,e);return o=xe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>{const f=bD(h),_=new jN;return Object.assign(_,f),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=PM(this.apiClient,e);return o=xe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>{const f=kM(h),_=new qN;return Object.assign(_,f),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=pM(this.apiClient,e);return o=xe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>{const f=gM(h),_=new HN;return Object.assign(_,f),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=xM(this.apiClient,e);return o=xe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>{const f=EM(h),_=new zN;return Object.assign(_,f),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=tM(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>vp(_))}else{const f=eM(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>yp(_))}}async listInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=lM(this.apiClient,e);return d=xe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=cM(_),x=new NT;return Object.assign(x,b),x})}else{const f=oM(this.apiClient,e);return d=xe("{models_url}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=uM(_),x=new NT;return Object.assign(x,b),x})}}async update(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=DM(this.apiClient,e);return d=xe("{model}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>vp(_))}else{const f=RM(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>yp(_))}}async delete(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=gD(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=vD(_),x=new RT;return Object.assign(x,b),x})}else{const f=pD(this.apiClient,e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=yD(_),x=new RT;return Object.assign(x,b),x})}}async countTokens(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=fD(this.apiClient,e);return d=xe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=mD(_),x=new DT;return Object.assign(x,b),x})}else{const f=dD(this.apiClient,e);return d=xe("{model}:countTokens",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=hD(_),x=new DT;return Object.assign(x,b),x})}}async computeTokens(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=iD(this.apiClient,e);return o=xe("{model}:computeTokens",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>{const f=rD(h),_=new GN;return Object.assign(_,f),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=zD(this.apiClient,e);return d=xe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u.then(_=>{const b=qD(_),x=new Gd;return Object.assign(x,b),x})}else{const f=HD(this.apiClient,e);return d=xe("{model}:predictLongRunning",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u.then(_=>{const b=jD(_),x=new Gd;return Object.assign(x,b),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mP extends Da{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;s&&"httpOptions"in s&&(o=s.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;s&&"httpOptions"in s&&(o=s.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=UN(e);return d=xe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),u}else{const f=ON(e);return d=xe("{operationName}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json()),u}}async fetchPredictVideosOperationInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=RN(e);return o=xe("{resourceName}:fetchPredictOperation",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pP(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function gP(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>SP(o))),y(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&y(e,["role"],s),e}function yP(n,e,t){const s={},r=m(e,["expireTime"]);t!==void 0&&r!=null&&y(t,["expireTime"],r);const o=m(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&y(t,["newSessionExpireTime"],o);const u=m(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const d=m(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&y(t,["bidiGenerateContentSetup"],EP(n,d));const h=m(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&y(t,["fieldMask"],h),s}function vP(n,e){const t={},s=m(e,["config"]);return s!=null&&y(t,["config"],yP(n,s,t)),t}function _P(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function TP(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function bP(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function xP(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig"],s);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&y(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=m(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=m(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const f=m(n,["mediaResolution"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","mediaResolution"],f);const _=m(n,["seed"]);e!==void 0&&_!=null&&y(e,["setup","generationConfig","seed"],_);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","speechConfig"],Zp(b));const x=m(n,["thinkingConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","thinkingConfig"],x);const C=m(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],C);const M=m(n,["systemInstruction"]);e!==void 0&&M!=null&&y(e,["setup","systemInstruction"],gP(vn(M)));const k=m(n,["tools"]);if(e!==void 0&&k!=null){let H=tl(k);Array.isArray(H)&&(H=H.map(R=>CP(el(R)))),y(e,["setup","tools"],H)}const V=m(n,["sessionResumption"]);e!==void 0&&V!=null&&y(e,["setup","sessionResumption"],AP(V));const $=m(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const U=m(n,["outputAudioTranscription"]);e!==void 0&&U!=null&&y(e,["setup","outputAudioTranscription"],U);const B=m(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const K=m(n,["contextWindowCompression"]);e!==void 0&&K!=null&&y(e,["setup","contextWindowCompression"],K);const se=m(n,["proactivity"]);return e!==void 0&&se!=null&&y(e,["setup","proactivity"],se),t}function EP(n,e){const t={},s=m(e,["model"]);s!=null&&y(t,["setup","model"],it(n,s));const r=m(e,["config"]);return r!=null&&y(t,["config"],xP(r,t)),t}function SP(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const s=m(n,["thought"]);s!=null&&y(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&y(e,["inlineData"],pP(r));const o=m(n,["fileData"]);o!=null&&y(e,["fileData"],_P(o));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=m(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const h=m(n,["codeExecutionResult"]);h!=null&&y(e,["codeExecutionResult"],h);const f=m(n,["executableCode"]);f!=null&&y(e,["executableCode"],f);const _=m(n,["functionResponse"]);_!=null&&y(e,["functionResponse"],_);const b=m(n,["text"]);return b!=null&&y(e,["text"],b),e}function AP(n){const e={},t=m(n,["handle"]);if(t!=null&&y(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function CP(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(_=>_)),y(e,["functionDeclarations"],f)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&y(e,["googleSearch"],bP(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&y(e,["googleSearchRetrieval"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=m(n,["googleMaps"]);o!=null&&y(e,["googleMaps"],TP(o));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=m(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const h=m(n,["codeExecution"]);return h!=null&&y(e,["codeExecution"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wP(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const r=Object.keys(s).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function IP(n,e){let t=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const o=s.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const o=wP(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?n.fieldMask=o:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];r.length>0&&(d=r.map(f=>u.includes(f)?`generationConfig.${f}`:f));const h=[];o&&h.push(o),d.length>0&&h.push(...d),h.length>0?n.fieldMask=h.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class NP extends Da{constructor(e){super(),this.apiClient=e}async create(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=vP(this.apiClient,e);o=xe("auth_tokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const h=IP(d,e.config);return r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RP(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function DP(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function MP(n,e){const t={};if(m(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&y(e,["displayName"],s),m(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=m(n,["epochCount"]);e!==void 0&&r!=null&&y(e,["tuningTask","hyperparameters","epochCount"],r);const o=m(n,["learningRateMultiplier"]);if(o!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],o),m(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=m(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const d=m(n,["learningRate"]);if(e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","learningRate"],d),m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function PP(n,e){const t={},s=m(n,["validationDataset"]);e!==void 0&&s!=null&&y(e,["supervisedTuningSpec"],YP(s,t));const r=m(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&y(e,["tunedModelDisplayName"],r);const o=m(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const u=m(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=m(n,["learningRateMultiplier"]);e!==void 0&&d!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const h=m(n,["exportLastCheckpointOnly"]);e!==void 0&&h!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],h);const f=m(n,["adapterSize"]);if(e!==void 0&&f!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),m(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const _=m(n,["labels"]);return e!==void 0&&_!=null&&y(e,["labels"],_),t}function kP(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const s=m(n,["preTunedModel"]);s!=null&&y(e,["preTunedModel"],s);const r=m(n,["trainingDataset"]);r!=null&&y(e,["tuningTask","trainingData"],GP(r));const o=m(n,["config"]);return o!=null&&MP(o,e),e}function LP(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const s=m(n,["preTunedModel"]);s!=null&&y(e,["preTunedModel"],s);const r=m(n,["trainingDataset"]);r!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],$P(r,e));const o=m(n,["config"]);return o!=null&&PP(o,e),e}function VP(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function OP(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function UP(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&y(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),t}function FP(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&y(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),t}function BP(n){const e={},t=m(n,["config"]);return t!=null&&UP(t,e),e}function jP(n){const e={},t=m(n,["config"]);return t!=null&&FP(t,e),e}function qP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>cE(u))),y(e,["tuningJobs"],o)}return e}function HP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&y(e,["nextPageToken"],s);const r=m(n,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(u=>Tp(u))),y(e,["tuningJobs"],o)}return e}function zP(n){const e={},t=m(n,["name"]);t!=null&&y(e,["model"],t);const s=m(n,["name"]);return s!=null&&y(e,["endpoint"],s),e}function GP(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=m(n,["examples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>r)),y(e,["examples","examples"],s)}return e}function $P(n,e){const t={},s=m(n,["gcsUri"]);e!==void 0&&s!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],s);const r=m(n,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],r),m(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function cE(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["state"]);r!=null&&y(e,["state"],Gx(r));const o=m(n,["createTime"]);o!=null&&y(e,["createTime"],o);const u=m(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const d=m(n,["tuningTask","completeTime"]);d!=null&&y(e,["endTime"],d);const h=m(n,["updateTime"]);h!=null&&y(e,["updateTime"],h);const f=m(n,["description"]);f!=null&&y(e,["description"],f);const _=m(n,["baseModel"]);_!=null&&y(e,["baseModel"],_);const b=m(n,["_self"]);b!=null&&y(e,["tunedModel"],zP(b));const x=m(n,["customBaseModel"]);x!=null&&y(e,["customBaseModel"],x);const C=m(n,["experiment"]);C!=null&&y(e,["experiment"],C);const M=m(n,["labels"]);M!=null&&y(e,["labels"],M);const k=m(n,["outputUri"]);k!=null&&y(e,["outputUri"],k);const V=m(n,["pipelineJob"]);V!=null&&y(e,["pipelineJob"],V);const $=m(n,["serviceAccount"]);$!=null&&y(e,["serviceAccount"],$);const U=m(n,["tunedModelDisplayName"]);U!=null&&y(e,["tunedModelDisplayName"],U);const B=m(n,["veoTuningSpec"]);return B!=null&&y(e,["veoTuningSpec"],B),e}function Tp(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["state"]);r!=null&&y(e,["state"],Gx(r));const o=m(n,["createTime"]);o!=null&&y(e,["createTime"],o);const u=m(n,["startTime"]);u!=null&&y(e,["startTime"],u);const d=m(n,["endTime"]);d!=null&&y(e,["endTime"],d);const h=m(n,["updateTime"]);h!=null&&y(e,["updateTime"],h);const f=m(n,["error"]);f!=null&&y(e,["error"],f);const _=m(n,["description"]);_!=null&&y(e,["description"],_);const b=m(n,["baseModel"]);b!=null&&y(e,["baseModel"],b);const x=m(n,["tunedModel"]);x!=null&&y(e,["tunedModel"],x);const C=m(n,["preTunedModel"]);C!=null&&y(e,["preTunedModel"],C);const M=m(n,["supervisedTuningSpec"]);M!=null&&y(e,["supervisedTuningSpec"],M);const k=m(n,["tuningDataStats"]);k!=null&&y(e,["tuningDataStats"],k);const V=m(n,["encryptionSpec"]);V!=null&&y(e,["encryptionSpec"],V);const $=m(n,["partnerModelTuningSpec"]);$!=null&&y(e,["partnerModelTuningSpec"],$);const U=m(n,["customBaseModel"]);U!=null&&y(e,["customBaseModel"],U);const B=m(n,["experiment"]);B!=null&&y(e,["experiment"],B);const K=m(n,["labels"]);K!=null&&y(e,["labels"],K);const se=m(n,["outputUri"]);se!=null&&y(e,["outputUri"],se);const H=m(n,["pipelineJob"]);H!=null&&y(e,["pipelineJob"],H);const R=m(n,["serviceAccount"]);R!=null&&y(e,["serviceAccount"],R);const N=m(n,["tunedModelDisplayName"]);N!=null&&y(e,["tunedModelDisplayName"],N);const D=m(n,["veoTuningSpec"]);return D!=null&&y(e,["veoTuningSpec"],D),e}function KP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&y(e,["name"],s);const r=m(n,["metadata"]);r!=null&&y(e,["metadata"],r);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const u=m(n,["error"]);return u!=null&&y(e,["error"],u),e}function YP(n,e){const t={},s=m(n,["gcsUri"]);s!=null&&y(t,["validationDatasetUri"],s);const r=m(n,["vertexDatasetResource"]);return e!==void 0&&r!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JP extends Da{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ou(Sa.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.tune=async t=>{var s;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((s=t.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:r});return o.baseModel=void 0,await this.tuneInternal(o)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),o=await this.tuneMldevInternal(r);let u="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?u=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(u=o.name.split("/operations/")[0]),{name:u,state:hp.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=OP(e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>Tp(_))}else{const f=VP(e);return d=xe("{name}",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>cE(_))}}async listInternal(e){var t,s,r,o;let u,d="",h={};if(this.apiClient.isVertexAI()){const f=jP(e);return d=xe("tuningJobs",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=HP(_),x=new MT;return Object.assign(x,b),x})}else{const f=BP(e);return d=xe("tunedModels",f._url),h=f._query,delete f._url,delete f._query,u=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(_=>_.json().then(b=>{const x=b;return x.sdkHttpResponse={headers:_.headers},x})),u.then(_=>{const b=qP(_),x=new MT;return Object.assign(x,b),x})}}async cancel(e){var t,s,r,o;let u="",d={};if(this.apiClient.isVertexAI()){const h=DP(e);u=xe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const h=RP(e);u=xe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI()){const d=LP(e);return o=xe("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>Tp(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let r,o="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=kP(e);return o=xe("tunedModels",d._url),u=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json().then(f=>{const _=f;return _.sdkHttpResponse={headers:h.headers},_})),r.then(h=>KP(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QP{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const XP=1024*1024*8,WP=3,ZP=1e3,e2=2,$m="x-goog-upload-status";async function t2(n,e,t){var s,r,o;let u=0,d=0,h=new mp(new Response),f="upload";for(u=n.size;d<u;){const b=Math.min(XP,u-d),x=n.slice(d,d+b);d+b>=u&&(f+=", finalize");let C=0,M=ZP;for(;C<WP&&(h=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(d),"Content-Length":String(b)}}}),!(!((s=h==null?void 0:h.headers)===null||s===void 0)&&s[$m]));)C++,await s2(M),M=M*e2;if(d+=b,((r=h==null?void 0:h.headers)===null||r===void 0?void 0:r[$m])!=="active")break;if(u<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const _=await(h==null?void 0:h.json());if(((o=h==null?void 0:h.headers)===null||o===void 0?void 0:o[$m])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return _.file}async function n2(n){return{size:n.size,type:n.type}}function s2(n){return new Promise(e=>setTimeout(e,n))}class i2{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await t2(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await n2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class r2{create(e,t,s){return new a2(e,t,s)}}class a2{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WT="x-goog-api-key";class o2{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(WT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(WT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const l2="gl-node/";class u2{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=NN(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const r=new o2(this.apiKey);this.apiClient=new KM({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:l2+"web",uploader:new i2,downloader:new QP}),this.models=new hP(this.apiClient),this.live=new aP(this.apiClient,r,new r2),this.batches=new $R(this.apiClient),this.chats=new S1(this.models,this.apiClient),this.caches=new b1(this.apiClient),this.files=new k1(this.apiClient),this.operations=new mP(this.apiClient),this.authTokens=new NP(this.apiClient),this.tunings=new JP(this.apiClient)}}const dE={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},gn={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:gn.app.environment,firebaseApiKey:gn.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:gn.firebase.authDomain||"❌ مفقود",firebaseProjectId:gn.firebase.projectId||"❌ مفقود",firebaseStorageBucket:gn.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:gn.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:gn.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(dE).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(dE).filter(n=>n.startsWith("VITE_")));const tg=()=>{const n=[];return gn.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),gn.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),gn.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),gn.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),gn.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),gn.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!gn.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=tg();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Kd;const c2="gemini-2.5-flash",d2=()=>{if(Kd)return;const n=tg();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Kd=new u2({apiKey:gn.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},Uu={FINANCIAL_ANALYST:`You are an expert financial analyst assistant, "المحلل الذكي". You have full access to the user's financial data for a specific period. Your purpose is to provide detailed, insightful analysis and answer complex questions in Arabic based ONLY on the data provided for that period.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- Analyze the user's provided financial state (transactions, card details, bank balance, investments, installments) for the specified period to answer their query.
- Be thorough. Connect different parts of their financial data to give holistic answers.
- DO NOT just state data, INTERPRET it. Provide insights, identify trends, and offer observations.
- Be friendly, professional, and act as a true financial advisor.`,INVESTMENT_COACH:`You are an educational investment coach named "المستشار الذكي". Your primary role is to educate the user about investment concepts and strategies, particularly within the context of the Saudi stock market (Tadawul).
- You MUST NOT give direct financial advice. Do not recommend buying or selling specific stocks (e.g., "Buy Aramco").
- When asked for a recommendation, you MUST politely decline and instead explain HOW the user can research and make their own informed decisions.
- Your tone should be encouraging, educational, and responsible.
- Keep your answers clear, concise, and in Arabic.`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`},Fu=async(n,e,t=!1)=>{if(!Kd)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Kd.models.generateContent({model:c2,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(s){console.error("Gemini API Error:",s);let r="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw s instanceof Error&&"message"in s&&s.message.includes("403")&&(r="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(r)}},f2=(n,e)=>Fu(Uu.FINANCIAL_ANALYST,`User Query: "${n}"

Financial Data: ${JSON.stringify(e)}`),h2=(n,e,t,s)=>{const r=Object.keys(t),o=Object.keys(s);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...o,...r].map(h=>`'${h}'`).join(", ")}].
`;Object.values(s).forEach(h=>{const f=[h.name.split(" ")[0],...h.smsSamples||[]].filter(Boolean);f.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${f.join("', '")}', use '${h.id}'.
`)}),Object.values(t).forEach(h=>{const f=[h.name.split(" ")[0],...h.smsSamples||[]].filter(Boolean);f.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${f.join("', '")}', use '${h.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const d=Uu.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return Fu(d,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${o[0]}'`,!0)},m2=n=>Fu(Uu.INVESTMENT_COACH,n),p2=(n,e,t)=>Fu(Uu.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),g2=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,s=await Fu(Uu.EXCHANGE_RATE,t,!0);try{const r=JSON.parse(s);return{rate:parseFloat(r.rate),fromCurrency:r.fromCurrency,toCurrency:r.toCurrency,lastUpdated:r.lastUpdated}}catch(r){throw console.error("Error parsing exchange rate:",r),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},y2="modulepreload",v2=function(n){return"/fd/"+n},ZT={},xr=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let u=function(f){return Promise.all(f.map(_=>Promise.resolve(_).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=u(t.map(f=>{if(f=v2(f),f in ZT)return;ZT[f]=!0;const _=f.endsWith(".css"),b=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${b}`))return;const x=document.createElement("link");if(x.rel=_?"stylesheet":y2,_||(x.as="script"),x.crossOrigin="",x.href=f,h&&x.setAttribute("nonce",h),document.head.appendChild(x),_)return new Promise((C,M)=>{x.addEventListener("load",C),x.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return r.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})},_2=()=>{};var eb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},T2=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const o=n[t++];e[s++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=n[t++],u=n[t++],d=n[t++],h=((r&7)<<18|(o&63)<<12|(u&63)<<6|d&63)-65536;e[s++]=String.fromCharCode(55296+(h>>10)),e[s++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],u=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(o&63)<<6|u&63)}}return e.join("")},hE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const o=n[r],u=r+1<n.length,d=u?n[r+1]:0,h=r+2<n.length,f=h?n[r+2]:0,_=o>>2,b=(o&3)<<4|d>>4;let x=(d&15)<<2|f>>6,C=f&63;h||(C=64,u||(x=64)),s.push(t[_],t[b],t[x],t[C])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(fE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):T2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const o=t[n.charAt(r++)],d=r<n.length?t[n.charAt(r)]:0;++r;const f=r<n.length?t[n.charAt(r)]:64;++r;const b=r<n.length?t[n.charAt(r)]:64;if(++r,o==null||d==null||f==null||b==null)throw new b2;const x=o<<2|d>>4;if(s.push(x),f!==64){const C=d<<4&240|f>>2;if(s.push(C),b!==64){const M=f<<6&192|b;s.push(M)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class b2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const x2=function(n){const e=fE(n);return hE.encodeByteArray(e,!0)},Yd=function(n){return x2(n).replace(/\./g,"")},mE=function(n){try{return hE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S2=()=>E2().__FIREBASE_DEFAULTS__,A2=()=>{if(typeof process>"u"||typeof eb>"u")return;const n=eb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},C2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&mE(n[1]);return e&&JSON.parse(e)},bf=()=>{try{return _2()||S2()||A2()||C2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},pE=n=>{var e,t;return(t=(e=bf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},w2=n=>{const e=pE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},gE=()=>{var n;return(n=bf())==null?void 0:n.config},yE=n=>{var e;return(e=bf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",r=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yd(JSON.stringify(t)),Yd(JSON.stringify(u)),""].join(".")}const xu={};function R2(){const n={prod:[],emulator:[]};for(const e of Object.keys(xu))xu[e]?n.emulator.push(e):n.prod.push(e);return n}function D2(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let tb=!1;function _E(n,e){if(typeof window>"u"||typeof document>"u"||!sl(window.location.host)||xu[n]===e||xu[n]||tb)return;xu[n]=e;function t(x){return`__firebase__banner__${x}`}const s="__firebase__banner",o=R2().prod.length>0;function u(){const x=document.getElementById(s);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function h(x,C){x.setAttribute("width","24"),x.setAttribute("id",C),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function f(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{tb=!0,u()},x}function _(x,C){x.setAttribute("id",C),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function b(){const x=D2(s),C=t("text"),M=document.getElementById(C)||document.createElement("span"),k=t("learnmore"),V=document.getElementById(k)||document.createElement("a"),$=t("preprendIcon"),U=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const B=x.element;d(B),_(V,k);const K=f();h(U,$),B.append(U,M,V,K),document.body.appendChild(B)}o?(M.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function M2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function P2(){var e;const n=(e=bf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function k2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function L2(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function V2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function O2(){const n=_n();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function U2(){return!P2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F2(){try{return typeof indexedDB=="object"}catch{return!1}}function B2(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var o;e(((o=r.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="FirebaseError";class Bi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=j2,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,o=this.errors[e],u=o?q2(o,s):"Error",d=`${this.serviceName}: ${u} (${r}).`;return new Bi(r,d,s)}}function q2(n,e){return n.replace(H2,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const H2=/\{\$([^}]+)}/g;function z2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Aa(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const o=n[r],u=e[r];if(nb(o)&&nb(u)){if(!Aa(o,u))return!1}else if(o!==u)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function nb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function pu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,o]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function gu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function G2(n,e){const t=new $2(n,e);return t.subscribe.bind(t)}class $2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");K2(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=Km),r.error===void 0&&(r.error=Km),r.complete===void 0&&(r.complete=Km);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function K2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Km(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(n){return n&&n._delegate?n._delegate:n}class Ca{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new I2;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Q2(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});s.resolve(o)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[o,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(o);s===d&&u.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:J2(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function J2(n){return n===_a?void 0:n}function Q2(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Y2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Je||(Je={}));const W2={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},Z2=Je.INFO,ek={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},tk=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=ek[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ng{constructor(e){this.name=e,this._logLevel=Z2,this._logHandler=tk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const nk=(n,e)=>e.some(t=>n instanceof t);let sb,ib;function sk(){return sb||(sb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ik(){return ib||(ib=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const TE=new WeakMap,bp=new WeakMap,bE=new WeakMap,Ym=new WeakMap,sg=new WeakMap;function rk(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",u)},o=()=>{t(Cr(n.result)),r()},u=()=>{s(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&TE.set(t,n)}).catch(()=>{}),sg.set(e,n),e}function ak(n){if(bp.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",u),n.removeEventListener("abort",u)},o=()=>{t(),r()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",u),n.addEventListener("abort",u)});bp.set(n,e)}let xp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return bp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||bE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Cr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ok(n){xp=n(xp)}function lk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Jm(this),e,...t);return bE.set(s,e.sort?e.sort():[e]),Cr(s)}:ik().includes(n)?function(...e){return n.apply(Jm(this),e),Cr(TE.get(this))}:function(...e){return Cr(n.apply(Jm(this),e))}}function uk(n){return typeof n=="function"?lk(n):(n instanceof IDBTransaction&&ak(n),nk(n,sk())?new Proxy(n,xp):n)}function Cr(n){if(n instanceof IDBRequest)return rk(n);if(Ym.has(n))return Ym.get(n);const e=uk(n);return e!==n&&(Ym.set(n,e),sg.set(e,n)),e}const Jm=n=>sg.get(n);function ck(n,e,{blocked:t,upgrade:s,blocking:r,terminated:o}={}){const u=indexedDB.open(n,e),d=Cr(u);return s&&u.addEventListener("upgradeneeded",h=>{s(Cr(u.result),h.oldVersion,h.newVersion,Cr(u.transaction),h)}),t&&u.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{o&&h.addEventListener("close",()=>o()),r&&h.addEventListener("versionchange",f=>r(f.oldVersion,f.newVersion,f))}).catch(()=>{}),d}const dk=["get","getKey","getAll","getAllKeys","count"],fk=["put","add","delete","clear"],Qm=new Map;function rb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Qm.get(e))return Qm.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=fk.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||dk.includes(t)))return;const o=async function(u,...d){const h=this.transaction(u,r?"readwrite":"readonly");let f=h.store;return s&&(f=f.index(d.shift())),(await Promise.all([f[t](...d),r&&h.done]))[0]};return Qm.set(e,o),o}ok(n=>({...n,get:(e,t,s)=>rb(e,t)||n.get(e,t,s),has:(e,t)=>!!rb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mk(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function mk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ep="@firebase/app",ab="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=new ng("@firebase/app"),pk="@firebase/app-compat",gk="@firebase/analytics-compat",yk="@firebase/analytics",vk="@firebase/app-check-compat",_k="@firebase/app-check",Tk="@firebase/auth",bk="@firebase/auth-compat",xk="@firebase/database",Ek="@firebase/data-connect",Sk="@firebase/database-compat",Ak="@firebase/functions",Ck="@firebase/functions-compat",wk="@firebase/installations",Ik="@firebase/installations-compat",Nk="@firebase/messaging",Rk="@firebase/messaging-compat",Dk="@firebase/performance",Mk="@firebase/performance-compat",Pk="@firebase/remote-config",kk="@firebase/remote-config-compat",Lk="@firebase/storage",Vk="@firebase/storage-compat",Ok="@firebase/firestore",Uk="@firebase/ai",Fk="@firebase/firestore-compat",Bk="firebase",jk="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="[DEFAULT]",qk={[Ep]:"fire-core",[pk]:"fire-core-compat",[yk]:"fire-analytics",[gk]:"fire-analytics-compat",[_k]:"fire-app-check",[vk]:"fire-app-check-compat",[Tk]:"fire-auth",[bk]:"fire-auth-compat",[xk]:"fire-rtdb",[Ek]:"fire-data-connect",[Sk]:"fire-rtdb-compat",[Ak]:"fire-fn",[Ck]:"fire-fn-compat",[wk]:"fire-iid",[Ik]:"fire-iid-compat",[Nk]:"fire-fcm",[Rk]:"fire-fcm-compat",[Dk]:"fire-perf",[Mk]:"fire-perf-compat",[Pk]:"fire-rc",[kk]:"fire-rc-compat",[Lk]:"fire-gcs",[Vk]:"fire-gcs-compat",[Ok]:"fire-fst",[Fk]:"fire-fst-compat",[Uk]:"fire-vertex","fire-js":"fire-js",[Bk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new Map,Hk=new Map,Ap=new Map;function ob(n,e){try{n.container.addComponent(e)}catch(t){ki.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Go(n){const e=n.name;if(Ap.has(e))return ki.debug(`There were multiple attempts to register component ${e}.`),!1;Ap.set(e,n);for(const t of Jd.values())ob(t,n);for(const t of Hk.values())ob(t,n);return!0}function ig(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rs(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wr=new Bu("app","Firebase",zk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ca("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=jk;function xE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Sp,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw wr.create("bad-app-name",{appName:String(r)});if(t||(t=gE()),!t)throw wr.create("no-options");const o=Jd.get(r);if(o){if(Aa(t,o.options)&&Aa(s,o.config))return o;throw wr.create("duplicate-app",{appName:r})}const u=new X2(r);for(const h of Ap.values())u.addComponent(h);const d=new Gk(t,s,u);return Jd.set(r,d),d}function EE(n=Sp){const e=Jd.get(n);if(!e&&n===Sp&&gE())return xE();if(!e)throw wr.create("no-app",{appName:n});return e}function Ir(n,e,t){let s=qk[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const u=[`Unable to register library "${s}" with version "${e}":`];r&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ki.warn(u.join(" "));return}Go(new Ca(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k="firebase-heartbeat-database",Kk=1,Du="firebase-heartbeat-store";let Xm=null;function SE(){return Xm||(Xm=ck($k,Kk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Du)}catch(t){console.warn(t)}}}}).catch(n=>{throw wr.create("idb-open",{originalErrorMessage:n.message})})),Xm}async function Yk(n){try{const t=(await SE()).transaction(Du),s=await t.objectStore(Du).get(AE(n));return await t.done,s}catch(e){if(e instanceof Bi)ki.warn(e.message);else{const t=wr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ki.warn(t.message)}}}async function lb(n,e){try{const s=(await SE()).transaction(Du,"readwrite");await s.objectStore(Du).put(e,AE(n)),await s.done}catch(t){if(t instanceof Bi)ki.warn(t.message);else{const s=wr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ki.warn(s.message)}}}function AE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk=1024,Qk=30;class Xk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Zk(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ub();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats.length>Qk){const u=eL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){ki.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ub(),{heartbeatsToSend:s,unsentEntries:r}=Wk(this._heartbeatsCache.heartbeats),o=Yd(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ki.warn(t),""}}}function ub(){return new Date().toISOString().substring(0,10)}function Wk(n,e=Jk){const t=[];let s=n.slice();for(const r of n){const o=t.find(u=>u.agent===r.agent);if(o){if(o.dates.push(r.date),cb(t)>e){o.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),cb(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class Zk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F2()?B2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Yk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return lb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return lb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cb(n){return Yd(JSON.stringify({version:2,heartbeats:n})).length}function eL(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(n){Go(new Ca("platform-logger",e=>new hk(e),"PRIVATE")),Go(new Ca("heartbeat",e=>new Xk(e),"PRIVATE")),Ir(Ep,ab,n),Ir(Ep,ab,"esm2020"),Ir("fire-js","")}tL("");var nL="firebase",sL="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ir(nL,sL,"app");var db=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nr,CE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,N){function D(){}D.prototype=N.prototype,R.F=N.prototype,R.prototype=new D,R.prototype.constructor=R,R.D=function(w,L,j){for(var O=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)O[Pe-2]=arguments[Pe];return N.prototype[L].apply(w,O)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,N,D){D||(D=0);const w=Array(16);if(typeof N=="string")for(var L=0;L<16;++L)w[L]=N.charCodeAt(D++)|N.charCodeAt(D++)<<8|N.charCodeAt(D++)<<16|N.charCodeAt(D++)<<24;else for(L=0;L<16;++L)w[L]=N[D++]|N[D++]<<8|N[D++]<<16|N[D++]<<24;N=R.g[0],D=R.g[1],L=R.g[2];let j=R.g[3],O;O=N+(j^D&(L^j))+w[0]+3614090360&4294967295,N=D+(O<<7&4294967295|O>>>25),O=j+(L^N&(D^L))+w[1]+3905402710&4294967295,j=N+(O<<12&4294967295|O>>>20),O=L+(D^j&(N^D))+w[2]+606105819&4294967295,L=j+(O<<17&4294967295|O>>>15),O=D+(N^L&(j^N))+w[3]+3250441966&4294967295,D=L+(O<<22&4294967295|O>>>10),O=N+(j^D&(L^j))+w[4]+4118548399&4294967295,N=D+(O<<7&4294967295|O>>>25),O=j+(L^N&(D^L))+w[5]+1200080426&4294967295,j=N+(O<<12&4294967295|O>>>20),O=L+(D^j&(N^D))+w[6]+2821735955&4294967295,L=j+(O<<17&4294967295|O>>>15),O=D+(N^L&(j^N))+w[7]+4249261313&4294967295,D=L+(O<<22&4294967295|O>>>10),O=N+(j^D&(L^j))+w[8]+1770035416&4294967295,N=D+(O<<7&4294967295|O>>>25),O=j+(L^N&(D^L))+w[9]+2336552879&4294967295,j=N+(O<<12&4294967295|O>>>20),O=L+(D^j&(N^D))+w[10]+4294925233&4294967295,L=j+(O<<17&4294967295|O>>>15),O=D+(N^L&(j^N))+w[11]+2304563134&4294967295,D=L+(O<<22&4294967295|O>>>10),O=N+(j^D&(L^j))+w[12]+1804603682&4294967295,N=D+(O<<7&4294967295|O>>>25),O=j+(L^N&(D^L))+w[13]+4254626195&4294967295,j=N+(O<<12&4294967295|O>>>20),O=L+(D^j&(N^D))+w[14]+2792965006&4294967295,L=j+(O<<17&4294967295|O>>>15),O=D+(N^L&(j^N))+w[15]+1236535329&4294967295,D=L+(O<<22&4294967295|O>>>10),O=N+(L^j&(D^L))+w[1]+4129170786&4294967295,N=D+(O<<5&4294967295|O>>>27),O=j+(D^L&(N^D))+w[6]+3225465664&4294967295,j=N+(O<<9&4294967295|O>>>23),O=L+(N^D&(j^N))+w[11]+643717713&4294967295,L=j+(O<<14&4294967295|O>>>18),O=D+(j^N&(L^j))+w[0]+3921069994&4294967295,D=L+(O<<20&4294967295|O>>>12),O=N+(L^j&(D^L))+w[5]+3593408605&4294967295,N=D+(O<<5&4294967295|O>>>27),O=j+(D^L&(N^D))+w[10]+38016083&4294967295,j=N+(O<<9&4294967295|O>>>23),O=L+(N^D&(j^N))+w[15]+3634488961&4294967295,L=j+(O<<14&4294967295|O>>>18),O=D+(j^N&(L^j))+w[4]+3889429448&4294967295,D=L+(O<<20&4294967295|O>>>12),O=N+(L^j&(D^L))+w[9]+568446438&4294967295,N=D+(O<<5&4294967295|O>>>27),O=j+(D^L&(N^D))+w[14]+3275163606&4294967295,j=N+(O<<9&4294967295|O>>>23),O=L+(N^D&(j^N))+w[3]+4107603335&4294967295,L=j+(O<<14&4294967295|O>>>18),O=D+(j^N&(L^j))+w[8]+1163531501&4294967295,D=L+(O<<20&4294967295|O>>>12),O=N+(L^j&(D^L))+w[13]+2850285829&4294967295,N=D+(O<<5&4294967295|O>>>27),O=j+(D^L&(N^D))+w[2]+4243563512&4294967295,j=N+(O<<9&4294967295|O>>>23),O=L+(N^D&(j^N))+w[7]+1735328473&4294967295,L=j+(O<<14&4294967295|O>>>18),O=D+(j^N&(L^j))+w[12]+2368359562&4294967295,D=L+(O<<20&4294967295|O>>>12),O=N+(D^L^j)+w[5]+4294588738&4294967295,N=D+(O<<4&4294967295|O>>>28),O=j+(N^D^L)+w[8]+2272392833&4294967295,j=N+(O<<11&4294967295|O>>>21),O=L+(j^N^D)+w[11]+1839030562&4294967295,L=j+(O<<16&4294967295|O>>>16),O=D+(L^j^N)+w[14]+4259657740&4294967295,D=L+(O<<23&4294967295|O>>>9),O=N+(D^L^j)+w[1]+2763975236&4294967295,N=D+(O<<4&4294967295|O>>>28),O=j+(N^D^L)+w[4]+1272893353&4294967295,j=N+(O<<11&4294967295|O>>>21),O=L+(j^N^D)+w[7]+4139469664&4294967295,L=j+(O<<16&4294967295|O>>>16),O=D+(L^j^N)+w[10]+3200236656&4294967295,D=L+(O<<23&4294967295|O>>>9),O=N+(D^L^j)+w[13]+681279174&4294967295,N=D+(O<<4&4294967295|O>>>28),O=j+(N^D^L)+w[0]+3936430074&4294967295,j=N+(O<<11&4294967295|O>>>21),O=L+(j^N^D)+w[3]+3572445317&4294967295,L=j+(O<<16&4294967295|O>>>16),O=D+(L^j^N)+w[6]+76029189&4294967295,D=L+(O<<23&4294967295|O>>>9),O=N+(D^L^j)+w[9]+3654602809&4294967295,N=D+(O<<4&4294967295|O>>>28),O=j+(N^D^L)+w[12]+3873151461&4294967295,j=N+(O<<11&4294967295|O>>>21),O=L+(j^N^D)+w[15]+530742520&4294967295,L=j+(O<<16&4294967295|O>>>16),O=D+(L^j^N)+w[2]+3299628645&4294967295,D=L+(O<<23&4294967295|O>>>9),O=N+(L^(D|~j))+w[0]+4096336452&4294967295,N=D+(O<<6&4294967295|O>>>26),O=j+(D^(N|~L))+w[7]+1126891415&4294967295,j=N+(O<<10&4294967295|O>>>22),O=L+(N^(j|~D))+w[14]+2878612391&4294967295,L=j+(O<<15&4294967295|O>>>17),O=D+(j^(L|~N))+w[5]+4237533241&4294967295,D=L+(O<<21&4294967295|O>>>11),O=N+(L^(D|~j))+w[12]+1700485571&4294967295,N=D+(O<<6&4294967295|O>>>26),O=j+(D^(N|~L))+w[3]+2399980690&4294967295,j=N+(O<<10&4294967295|O>>>22),O=L+(N^(j|~D))+w[10]+4293915773&4294967295,L=j+(O<<15&4294967295|O>>>17),O=D+(j^(L|~N))+w[1]+2240044497&4294967295,D=L+(O<<21&4294967295|O>>>11),O=N+(L^(D|~j))+w[8]+1873313359&4294967295,N=D+(O<<6&4294967295|O>>>26),O=j+(D^(N|~L))+w[15]+4264355552&4294967295,j=N+(O<<10&4294967295|O>>>22),O=L+(N^(j|~D))+w[6]+2734768916&4294967295,L=j+(O<<15&4294967295|O>>>17),O=D+(j^(L|~N))+w[13]+1309151649&4294967295,D=L+(O<<21&4294967295|O>>>11),O=N+(L^(D|~j))+w[4]+4149444226&4294967295,N=D+(O<<6&4294967295|O>>>26),O=j+(D^(N|~L))+w[11]+3174756917&4294967295,j=N+(O<<10&4294967295|O>>>22),O=L+(N^(j|~D))+w[2]+718787259&4294967295,L=j+(O<<15&4294967295|O>>>17),O=D+(j^(L|~N))+w[9]+3951481745&4294967295,R.g[0]=R.g[0]+N&4294967295,R.g[1]=R.g[1]+(L+(O<<21&4294967295|O>>>11))&4294967295,R.g[2]=R.g[2]+L&4294967295,R.g[3]=R.g[3]+j&4294967295}s.prototype.v=function(R,N){N===void 0&&(N=R.length);const D=N-this.blockSize,w=this.C;let L=this.h,j=0;for(;j<N;){if(L==0)for(;j<=D;)r(this,R,j),j+=this.blockSize;if(typeof R=="string"){for(;j<N;)if(w[L++]=R.charCodeAt(j++),L==this.blockSize){r(this,w),L=0;break}}else for(;j<N;)if(w[L++]=R[j++],L==this.blockSize){r(this,w),L=0;break}}this.h=L,this.o+=N},s.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var N=1;N<R.length-8;++N)R[N]=0;N=this.o*8;for(var D=R.length-8;D<R.length;++D)R[D]=N&255,N/=256;for(this.v(R),R=Array(16),N=0,D=0;D<4;++D)for(let w=0;w<32;w+=8)R[N++]=this.g[D]>>>w&255;return R};function o(R,N){var D=d;return Object.prototype.hasOwnProperty.call(D,R)?D[R]:D[R]=N(R)}function u(R,N){this.h=N;const D=[];let w=!0;for(let L=R.length-1;L>=0;L--){const j=R[L]|0;w&&j==N||(D[L]=j,w=!1)}this.g=D}var d={};function h(R){return-128<=R&&R<128?o(R,function(N){return new u([N|0],N<0?-1:0)}):new u([R|0],R<0?-1:0)}function f(R){if(isNaN(R)||!isFinite(R))return b;if(R<0)return V(f(-R));const N=[];let D=1;for(let w=0;R>=D;w++)N[w]=R/D|0,D*=4294967296;return new u(N,0)}function _(R,N){if(R.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(R.charAt(0)=="-")return V(_(R.substring(1),N));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=f(Math.pow(N,8));let w=b;for(let j=0;j<R.length;j+=8){var L=Math.min(8,R.length-j);const O=parseInt(R.substring(j,j+L),N);L<8?(L=f(Math.pow(N,L)),w=w.j(L).add(f(O))):(w=w.j(D),w=w.add(f(O)))}return w}var b=h(0),x=h(1),C=h(16777216);n=u.prototype,n.m=function(){if(k(this))return-V(this).m();let R=0,N=1;for(let D=0;D<this.g.length;D++){const w=this.i(D);R+=(w>=0?w:4294967296+w)*N,N*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(M(this))return"0";if(k(this))return"-"+V(this).toString(R);const N=f(Math.pow(R,6));var D=this;let w="";for(;;){const L=K(D,N).g;D=$(D,L.j(N));let j=((D.g.length>0?D.g[0]:D.h)>>>0).toString(R);if(D=L,M(D))return j+w;for(;j.length<6;)j="0"+j;w=j+w}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function M(R){if(R.h!=0)return!1;for(let N=0;N<R.g.length;N++)if(R.g[N]!=0)return!1;return!0}function k(R){return R.h==-1}n.l=function(R){return R=$(this,R),k(R)?-1:M(R)?0:1};function V(R){const N=R.g.length,D=[];for(let w=0;w<N;w++)D[w]=~R.g[w];return new u(D,~R.h).add(x)}n.abs=function(){return k(this)?V(this):this},n.add=function(R){const N=Math.max(this.g.length,R.g.length),D=[];let w=0;for(let L=0;L<=N;L++){let j=w+(this.i(L)&65535)+(R.i(L)&65535),O=(j>>>16)+(this.i(L)>>>16)+(R.i(L)>>>16);w=O>>>16,j&=65535,O&=65535,D[L]=O<<16|j}return new u(D,D[D.length-1]&-2147483648?-1:0)};function $(R,N){return R.add(V(N))}n.j=function(R){if(M(this)||M(R))return b;if(k(this))return k(R)?V(this).j(V(R)):V(V(this).j(R));if(k(R))return V(this.j(V(R)));if(this.l(C)<0&&R.l(C)<0)return f(this.m()*R.m());const N=this.g.length+R.g.length,D=[];for(var w=0;w<2*N;w++)D[w]=0;for(w=0;w<this.g.length;w++)for(let L=0;L<R.g.length;L++){const j=this.i(w)>>>16,O=this.i(w)&65535,Pe=R.i(L)>>>16,We=R.i(L)&65535;D[2*w+2*L]+=O*We,U(D,2*w+2*L),D[2*w+2*L+1]+=j*We,U(D,2*w+2*L+1),D[2*w+2*L+1]+=O*Pe,U(D,2*w+2*L+1),D[2*w+2*L+2]+=j*Pe,U(D,2*w+2*L+2)}for(R=0;R<N;R++)D[R]=D[2*R+1]<<16|D[2*R];for(R=N;R<2*N;R++)D[R]=0;return new u(D,0)};function U(R,N){for(;(R[N]&65535)!=R[N];)R[N+1]+=R[N]>>>16,R[N]&=65535,N++}function B(R,N){this.g=R,this.h=N}function K(R,N){if(M(N))throw Error("division by zero");if(M(R))return new B(b,b);if(k(R))return N=K(V(R),N),new B(V(N.g),V(N.h));if(k(N))return N=K(R,V(N)),new B(V(N.g),N.h);if(R.g.length>30){if(k(R)||k(N))throw Error("slowDivide_ only works with positive integers.");for(var D=x,w=N;w.l(R)<=0;)D=se(D),w=se(w);var L=H(D,1),j=H(w,1);for(w=H(w,2),D=H(D,2);!M(w);){var O=j.add(w);O.l(R)<=0&&(L=L.add(D),j=O),w=H(w,1),D=H(D,1)}return N=$(R,L.j(N)),new B(L,N)}for(L=b;R.l(N)>=0;){for(D=Math.max(1,Math.floor(R.m()/N.m())),w=Math.ceil(Math.log(D)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),j=f(D),O=j.j(N);k(O)||O.l(R)>0;)D-=w,j=f(D),O=j.j(N);M(j)&&(j=x),L=L.add(j),R=$(R,O)}return new B(L,R)}n.B=function(R){return K(this,R).h},n.and=function(R){const N=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<N;w++)D[w]=this.i(w)&R.i(w);return new u(D,this.h&R.h)},n.or=function(R){const N=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<N;w++)D[w]=this.i(w)|R.i(w);return new u(D,this.h|R.h)},n.xor=function(R){const N=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<N;w++)D[w]=this.i(w)^R.i(w);return new u(D,this.h^R.h)};function se(R){const N=R.g.length+1,D=[];for(let w=0;w<N;w++)D[w]=R.i(w)<<1|R.i(w-1)>>>31;return new u(D,R.h)}function H(R,N){const D=N>>5;N%=32;const w=R.g.length-D,L=[];for(let j=0;j<w;j++)L[j]=N>0?R.i(j+D)>>>N|R.i(j+D+1)<<32-N:R.i(j+D);return new u(L,R.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,CE=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=f,u.fromString=_,Nr=u}).apply(typeof db<"u"?db:typeof self<"u"?self:typeof window<"u"?window:{});var Ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wE,yu,IE,Pd,Cp,NE,RE,DE;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ed=="object"&&Ed];for(var E=0;E<g.length;++E){var A=g[E];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var s=t(this);function r(g,E){if(E)e:{var A=s;g=g.split(".");for(var P=0;P<g.length-1;P++){var J=g[P];if(!(J in A))break e;A=A[J]}g=g[g.length-1],P=A[g],E=E(P),E!=P&&E!=null&&e(A,g,{configurable:!0,writable:!0,value:E})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(E){var A=[],P;for(P in E)Object.prototype.hasOwnProperty.call(E,P)&&A.push([P,E[P]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function d(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function h(g,E,A){return g.call.apply(g.bind,arguments)}function f(g,E,A){return f=h,f.apply(null,arguments)}function _(g,E){var A=Array.prototype.slice.call(arguments,1);return function(){var P=A.slice();return P.push.apply(P,arguments),g.apply(this,P)}}function b(g,E){function A(){}A.prototype=E.prototype,g.Z=E.prototype,g.prototype=new A,g.prototype.constructor=g,g.Ob=function(P,J,te){for(var pe=Array(arguments.length-2),je=2;je<arguments.length;je++)pe[je-2]=arguments[je];return E.prototype[J].apply(P,pe)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function C(g){const E=g.length;if(E>0){const A=Array(E);for(let P=0;P<E;P++)A[P]=g[P];return A}return[]}function M(g,E){for(let P=1;P<arguments.length;P++){const J=arguments[P];var A=typeof J;if(A=A!="object"?A:J?Array.isArray(J)?"array":A:"null",A=="array"||A=="object"&&typeof J.length=="number"){A=g.length||0;const te=J.length||0;g.length=A+te;for(let pe=0;pe<te;pe++)g[A+pe]=J[pe]}else g.push(J)}}class k{constructor(E,A){this.i=E,this.j=A,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function V(g){u.setTimeout(()=>{throw g},0)}function $(){var g=R;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class U{constructor(){this.h=this.g=null}add(E,A){const P=B.get();P.set(E,A),this.h?this.h.next=P:this.g=P,this.h=P}}var B=new k(()=>new K,g=>g.reset());class K{constructor(){this.next=this.g=this.h=null}set(E,A){this.h=E,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let se,H=!1,R=new U,N=()=>{const g=Promise.resolve(void 0);se=()=>{g.then(D)}};function D(){for(var g;g=$();){try{g.h.call(g.g)}catch(A){V(A)}var E=B;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}H=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const A=()=>{};u.addEventListener("test",A,E),u.removeEventListener("test",A,E)}catch{}return g})();function O(g){return/^[\s\xa0]*$/.test(g)}function Pe(g,E){L.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}b(Pe,L),Pe.prototype.init=function(g,E){const A=this.type=g.type,P=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(A=="mouseover"?E=g.fromElement:A=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Pe.Z.h.call(this)},Pe.prototype.h=function(){Pe.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var We="closure_listenable_"+(Math.random()*1e6|0),Z=0;function Q(g,E,A,P,J){this.listener=g,this.proxy=null,this.src=E,this.type=A,this.capture=!!P,this.ha=J,this.key=++Z,this.da=this.fa=!1}function he(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ae(g,E,A){for(const P in g)E.call(A,g[P],P,g)}function Ce(g,E){for(const A in g)E.call(void 0,g[A],A,g)}function q(g){const E={};for(const A in g)E[A]=g[A];return E}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(g,E){let A,P;for(let J=1;J<arguments.length;J++){P=arguments[J];for(A in P)g[A]=P[A];for(let te=0;te<re.length;te++)A=re[te],Object.prototype.hasOwnProperty.call(P,A)&&(g[A]=P[A])}}function ye(g){this.src=g,this.g={},this.h=0}ye.prototype.add=function(g,E,A,P,J){const te=g.toString();g=this.g[te],g||(g=this.g[te]=[],this.h++);const pe=Fe(g,E,P,J);return pe>-1?(E=g[pe],A||(E.fa=!1)):(E=new Q(E,this.src,te,!!P,J),E.fa=A,g.push(E)),E};function Ne(g,E){const A=E.type;if(A in g.g){var P=g.g[A],J=Array.prototype.indexOf.call(P,E,void 0),te;(te=J>=0)&&Array.prototype.splice.call(P,J,1),te&&(he(E),g.g[A].length==0&&(delete g.g[A],g.h--))}}function Fe(g,E,A,P){for(let J=0;J<g.length;++J){const te=g[J];if(!te.da&&te.listener==E&&te.capture==!!A&&te.ha==P)return J}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),vt={};function gt(g,E,A,P,J){if(Array.isArray(E)){for(let te=0;te<E.length;te++)gt(g,E[te],A,P,J);return null}return A=qr(A),g&&g[We]?g.J(E,A,d(P)?!!P.capture:!1,J):ei(g,E,A,!1,P,J)}function ei(g,E,A,P,J,te){if(!E)throw Error("Invalid event type");const pe=d(J)?!!J.capture:!!J;let je=ni(g);if(je||(g[Be]=je=new ye(g)),A=je.add(E,A,P,pe,te),A.proxy)return A;if(P=qi(),A.proxy=P,P.src=g,P.listener=A,g.addEventListener)j||(J=pe),J===void 0&&(J=!1),g.addEventListener(E.toString(),P,J);else if(g.attachEvent)g.attachEvent(zn(E.toString()),P);else if(g.addListener&&g.removeListener)g.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return A}function qi(){function g(A){return E.call(g.src,g.listener,A)}const E=Br;return g}function ti(g,E,A,P,J){if(Array.isArray(E))for(var te=0;te<E.length;te++)ti(g,E[te],A,P,J);else P=d(P)?!!P.capture:!!P,A=qr(A),g&&g[We]?(g=g.i,te=String(E).toString(),te in g.g&&(E=g.g[te],A=Fe(E,A,P,J),A>-1&&(he(E[A]),Array.prototype.splice.call(E,A,1),E.length==0&&(delete g.g[te],g.h--)))):g&&(g=ni(g))&&(E=g.g[E.toString()],g=-1,E&&(g=Fe(E,A,P,J)),(A=g>-1?E[g]:null)&&Hi(A))}function Hi(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[We])Ne(E.i,g);else{var A=g.type,P=g.proxy;E.removeEventListener?E.removeEventListener(A,P,g.capture):E.detachEvent?E.detachEvent(zn(A),P):E.addListener&&E.removeListener&&E.removeListener(P),(A=ni(E))?(Ne(A,g),A.h==0&&(A.src=null,E[Be]=null)):he(g)}}}function zn(g){return g in vt?vt[g]:vt[g]="on"+g}function Br(g,E){if(g.da)g=!0;else{E=new Pe(E,this);const A=g.listener,P=g.ha||g.src;g.fa&&Hi(g),g=A.call(P,E)}return g}function ni(g){return g=g[Be],g instanceof ye?g:null}var jr="__closure_events_fn_"+(Math.random()*1e9>>>0);function qr(g){return typeof g=="function"?g:(g[jr]||(g[jr]=function(E){return g.handleEvent(E)}),g[jr])}function Ct(){w.call(this),this.i=new ye(this),this.M=this,this.G=null}b(Ct,w),Ct.prototype[We]=!0,Ct.prototype.removeEventListener=function(g,E,A,P){ti(this,g,E,A,P)};function Dt(g,E){var A,P=g.G;if(P)for(A=[];P;P=P.G)A.push(P);if(g=g.M,P=E.type||E,typeof E=="string")E=new L(E,g);else if(E instanceof L)E.target=E.target||g;else{var J=E;E=new L(P,g),me(E,J)}J=!0;let te,pe;if(A)for(pe=A.length-1;pe>=0;pe--)te=E.g=A[pe],J=Cs(te,P,!0,E)&&J;if(te=E.g=g,J=Cs(te,P,!0,E)&&J,J=Cs(te,P,!1,E)&&J,A)for(pe=0;pe<A.length;pe++)te=E.g=A[pe],J=Cs(te,P,!1,E)&&J}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const A=g.g[E];for(let P=0;P<A.length;P++)he(A[P]);delete g.g[E],g.h--}}this.G=null},Ct.prototype.J=function(g,E,A,P){return this.i.add(String(g),E,!1,A,P)},Ct.prototype.K=function(g,E,A,P){return this.i.add(String(g),E,!0,A,P)};function Cs(g,E,A,P){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let J=!0;for(let te=0;te<E.length;++te){const pe=E[te];if(pe&&!pe.da&&pe.capture==A){const je=pe.listener,Mt=pe.ha||pe.src;pe.fa&&Ne(g.i,pe),J=je.call(Mt,P)!==!1&&J}}return J&&!P.defaultPrevented}function cl(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=f(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:u.setTimeout(g,E||0)}function Ua(g){g.g=cl(()=>{g.g=null,g.i&&(g.i=!1,Ua(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class rn extends w{constructor(E,A){super(),this.m=E,this.l=A,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Ua(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function si(g){w.call(this),this.h=g,this.g={}}b(si,w);var Hr=[];function zi(g){Ae(g.g,function(E,A){this.g.hasOwnProperty(A)&&Hi(E)},g),g.g={}}si.prototype.N=function(){si.Z.N.call(this),zi(this)},si.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ws=u.JSON.stringify,Fa=u.JSON.parse,zr=class{stringify(g){return u.JSON.stringify(g,void 0)}parse(g){return u.JSON.parse(g,void 0)}};function Gr(){}function $r(){}var Sn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function G(){L.call(this,"d")}b(G,L);function ue(){L.call(this,"c")}b(ue,L);var ce={},ge=null;function _e(){return ge=ge||new Ct}ce.Ia="serverreachability";function ze(g){L.call(this,ce.Ia,g)}b(ze,L);function fn(g){const E=_e();Dt(E,new ze(E))}ce.STAT_EVENT="statevent";function ls(g,E){L.call(this,ce.STAT_EVENT,g),this.stat=E}b(ls,L);function wt(g){const E=_e();Dt(E,new ls(E,g))}ce.Ja="timingevent";function Gn(g,E){L.call(this,ce.Ja,g),this.size=E}b(Gn,L);function $n(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){g()},E)}function Pn(){this.g=!0}Pn.prototype.ua=function(){this.g=!1};function Te(g,E,A,P,J,te){g.info(function(){if(g.g)if(te){var pe="",je=te.split("&");for(let rt=0;rt<je.length;rt++){var Mt=je[rt].split("=");if(Mt.length>1){const Et=Mt[0];Mt=Mt[1];const Qn=Et.split("_");pe=Qn.length>=2&&Qn[1]=="type"?pe+(Et+"="+Mt+"&"):pe+(Et+"=redacted&")}}}else pe=null;else pe=te;return"XMLHTTP REQ ("+P+") [attempt "+J+"]: "+E+`
`+A+`
`+pe})}function It(g,E,A,P,J,te,pe){g.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+J+"]: "+E+`
`+A+`
`+te+" "+pe})}function Kt(g,E,A,P){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+ii(g,A)+(P?" "+P:"")})}function Xt(g,E){g.info(function(){return"TIMEOUT: "+E})}Pn.prototype.info=function(){};function ii(g,E){if(!g.g)return E;if(!E)return null;try{const te=JSON.parse(E);if(te){for(g=0;g<te.length;g++)if(Array.isArray(te[g])){var A=te[g];if(!(A.length<2)){var P=A[1];if(Array.isArray(P)&&!(P.length<1)){var J=P[0];if(J!="noop"&&J!="stop"&&J!="close")for(let pe=1;pe<P.length;pe++)P[pe]=""}}}}return ws(te)}catch{return E}}var tt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},dl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},fl;function Kr(){}b(Kr,Gr),Kr.prototype.g=function(){return new XMLHttpRequest},fl=new Kr;function ri(g){return encodeURIComponent(String(g))}function Zu(g){var E=1;g=g.split(":");const A=[];for(;E>0&&g.length;)A.push(g.shift()),E--;return g.length&&A.push(g.join(":")),A}function us(g,E,A,P){this.j=g,this.i=E,this.l=A,this.S=P||1,this.V=new si(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cs}function cs(){this.i=null,this.g="",this.h=!1}var Ot={},Wt={};function Is(g,E,A){g.M=1,g.A=Yr(Ft(E)),g.u=A,g.R=!0,Ba(g,null)}function Ba(g,E){g.F=Date.now(),Ns(g),g.B=Ft(g.A);var A=g.B,P=g.S;Array.isArray(P)||(P=[String(P)]),za(A.i,"t",P),g.C=0,A=g.j.L,g.h=new cs,g.g=mc(g.j,A?E:null,!g.u),g.P>0&&(g.O=new rn(f(g.Y,g,g.g),g.P)),E=g.V,A=g.g,P=g.ba;var J="readystatechange";Array.isArray(J)||(J&&(Hr[0]=J.toString()),J=Hr);for(let te=0;te<J.length;te++){const pe=gt(A,J[te],P||E.handleEvent,!1,E.h||E);if(!pe)break;E.g[pe.key]=pe}E=g.J?q(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),fn(),Te(g.i,g.v,g.B,g.l,g.S,g.u)}us.prototype.ba=function(g){g=g.target;const E=this.O;E&&hs(g)==3?E.j():this.Y(g)},us.prototype.Y=function(g){try{if(g==this.g)e:{const je=hs(this.g),Mt=this.g.ya(),rt=this.g.ca();if(!(je<3)&&(je!=3||this.g&&(this.h.h||this.g.la()||an(this.g)))){this.K||je!=4||Mt==7||(Mt==8||rt<=0?fn(3):fn(2)),Rs(this);var E=this.g.ca();this.X=E;var A=Hf(this);if(this.o=E==200,It(this.i,this.v,this.B,this.l,this.S,je,E),this.o){if(this.U&&!this.L){t:{if(this.g){var P,J=this.g;if((P=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(P)){var te=P;break t}}te=null}if(g=te)Kt(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ds(this,g);else{this.o=!1,this.m=3,wt(12),kn(this),Kn(this);break e}}if(this.R){g=!0;let Et;for(;!this.K&&this.C<A.length;)if(Et=tc(this,A),Et==Wt){je==4&&(this.m=4,wt(14),g=!1),Kt(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Ot){this.m=4,wt(15),Kt(this.i,this.l,A,"[Invalid Chunk]"),g=!1;break}else Kt(this.i,this.l,Et,null),Ds(this,Et);if(ec(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||A.length!=0||this.h.h||(this.m=1,wt(16),g=!1),this.o=this.o&&g,!g)Kt(this.i,this.l,A,"[Invalid Chunked Response]"),kn(this),Kn(this);else if(A.length>0&&!this.W){this.W=!0;var pe=this.j;pe.g==this&&pe.aa&&!pe.P&&(pe.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),wl(pe),pe.P=!0,wt(11))}}else Kt(this.i,this.l,A,null),Ds(this,A);je==4&&kn(this),this.o&&!this.K&&(je==4?cc(this.j,this):(this.o=!1,Ns(this)))}else oi(this.g),E==400&&A.indexOf("Unknown SID")>0?(this.m=3,wt(12)):(this.m=0,wt(13)),kn(this),Kn(this)}}}catch{}finally{}};function Hf(g){if(!ec(g))return g.g.la();const E=an(g.g);if(E==="")return"";let A="";const P=E.length,J=hs(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return kn(g),Kn(g),"";g.h.i=new u.TextDecoder}for(let te=0;te<P;te++)g.h.h=!0,A+=g.h.i.decode(E[te],{stream:!(J&&te==P-1)});return E.length=0,g.h.g+=A,g.C=0,g.h.g}function ec(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function tc(g,E){var A=g.C,P=E.indexOf(`
`,A);return P==-1?Wt:(A=Number(E.substring(A,P)),isNaN(A)?Ot:(P+=1,P+A>E.length?Wt:(E=E.slice(P,P+A),g.C=P+A,E)))}us.prototype.cancel=function(){this.K=!0,kn(this)};function Ns(g){g.T=Date.now()+g.H,ja(g,g.H)}function ja(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=$n(f(g.aa,g),E)}function Rs(g){g.D&&(u.clearTimeout(g.D),g.D=null)}us.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Xt(this.i,this.B),this.M!=2&&(fn(),wt(17)),kn(this),this.m=2,Kn(this)):ja(this,this.T-g)};function Kn(g){g.j.I==0||g.K||cc(g.j,g)}function kn(g){Rs(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,zi(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function Ds(g,E){try{var A=g.j;if(A.I!=0&&(A.g==g||Ps(A.h,g))){if(!g.L&&Ps(A.h,g)&&A.I==3){try{var P=A.Ba.g.parse(E)}catch{P=null}if(Array.isArray(P)&&P.length==3){var J=P;if(J[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<g.F)Ja(A),Wi(A);else break e;ta(A),wt(18)}}else A.xa=J[1],0<A.xa-A.K&&J[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=$n(f(A.Va,A),6e3));Ms(A.h)<=1&&A.ta&&(A.ta=void 0)}else Fs(A,11)}else if((g.L||A.g==g)&&Ja(A),!O(E))for(J=A.Ba.g.parse(E),E=0;E<J.length;E++){let rt=J[E];const Et=rt[0];if(!(Et<=A.K))if(A.K=Et,rt=rt[1],A.I==2)if(rt[0]=="c"){A.M=rt[1],A.ba=rt[2];const Qn=rt[3];Qn!=null&&(A.ka=Qn,A.j.info("VER="+A.ka));const Bs=rt[4];Bs!=null&&(A.za=Bs,A.j.info("SVER="+A.za));const ms=rt[5];ms!=null&&typeof ms=="number"&&ms>0&&(P=1.5*ms,A.O=P,A.j.info("backChannelRequestTimeoutMs_="+P)),P=A;const ps=g.g;if(ps){const na=ps.g?ps.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(na){var te=P.h;te.g||na.indexOf("spdy")==-1&&na.indexOf("quic")==-1&&na.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(pl(te,te.h),te.h=null))}if(P.G){const Qa=ps.g?ps.g.getResponseHeader("X-HTTP-Session-Id"):null;Qa&&(P.wa=Qa,lt(P.J,P.G,Qa))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-g.F,A.j.info("Handshake RTT: "+A.T+"ms")),P=A;var pe=g;if(P.na=hc(P,P.L?P.ba:null,P.W),pe.L){gl(P.h,pe);var je=pe,Mt=P.O;Mt&&(je.H=Mt),je.D&&(Rs(je),Ns(je)),P.g=pe}else lc(P);A.i.length>0&&Us(A)}else rt[0]!="stop"&&rt[0]!="close"||Fs(A,7);else A.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Fs(A,7):Al(A):rt[0]!="noop"&&A.l&&A.l.qa(rt),A.A=0)}}fn(4)}catch{}}var Ut=class{constructor(g,E){this.g=g,this.map=E}};function hl(g){this.l=g||10,u.PerformanceNavigationTiming?(g=u.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ml(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Ms(g){return g.h?1:g.g?g.g.size:0}function Ps(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function pl(g,E){g.g?g.g.add(E):g.h=E}function gl(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}hl.prototype.cancel=function(){if(this.i=yl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function yl(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const A of g.g.values())E=E.concat(A.G);return E}return C(g.i)}var nc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qa(g,E){if(g){g=g.split("&");for(let A=0;A<g.length;A++){const P=g[A].indexOf("=");let J,te=null;P>=0?(J=g[A].substring(0,P),te=g[A].substring(P+1)):J=g[A],E(J,te?decodeURIComponent(te.replace(/\+/g," ")):"")}}}function Ln(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof Ln?(this.l=g.l,Zt(this,g.j),this.o=g.o,this.g=g.g,Gi(this,g.u),this.h=g.h,vl(this,ac(g.i)),this.m=g.m):g&&(E=String(g).match(nc))?(this.l=!1,Zt(this,E[1]||"",!0),this.o=ks(E[2]||""),this.g=ks(E[3]||"",!0),Gi(this,E[4]),this.h=ks(E[5]||"",!0),vl(this,E[6]||"",!0),this.m=ks(E[7]||"")):(this.l=!1,this.i=new Ki(null,this.l))}Ln.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(Jr(E,Ha,!0),":");var A=this.g;return(A||E=="file")&&(g.push("//"),(E=this.o)&&g.push(Jr(E,Ha,!0),"@"),g.push(ri(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&g.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&g.push("/"),g.push(Jr(A,A.charAt(0)=="/"?_l:sc,!0))),(A=this.i.toString())&&g.push("?",A),(A=this.m)&&g.push("#",Jr(A,ic)),g.join("")},Ln.prototype.resolve=function(g){const E=Ft(this);let A=!!g.j;A?Zt(E,g.j):A=!!g.o,A?E.o=g.o:A=!!g.g,A?E.g=g.g:A=g.u!=null;var P=g.h;if(A)Gi(E,g.u);else if(A=!!g.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var J=E.h.lastIndexOf("/");J!=-1&&(P=E.h.slice(0,J+1)+P)}if(J=P,J==".."||J==".")P="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){P=J.lastIndexOf("/",0)==0,J=J.split("/");const te=[];for(let pe=0;pe<J.length;){const je=J[pe++];je=="."?P&&pe==J.length&&te.push(""):je==".."?((te.length>1||te.length==1&&te[0]!="")&&te.pop(),P&&pe==J.length&&te.push("")):(te.push(je),P=!0)}P=te.join("/")}else P=J}return A?E.h=P:A=g.i.toString()!=="",A?vl(E,ac(g.i)):A=!!g.m,A&&(E.m=g.m),E};function Ft(g){return new Ln(g)}function Zt(g,E,A){g.j=A?ks(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Gi(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function vl(g,E,A){E instanceof Ki?(g.i=E,Ga(g.i,g.l)):(A||(E=Jr(E,$i)),g.i=new Ki(E,g.l))}function lt(g,E,A){g.i.set(E,A)}function Yr(g){return lt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ks(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Jr(g,E,A){return typeof g=="string"?(g=encodeURI(g).replace(E,An),A&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function An(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Ha=/[#\/\?@]/g,sc=/[#\?:]/g,_l=/[#\?]/g,$i=/[#\?@]/g,ic=/#/g;function Ki(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Cn(g){g.g||(g.g=new Map,g.h=0,g.i&&qa(g.i,function(E,A){g.add(decodeURIComponent(E.replace(/\+/g," ")),A)}))}n=Ki.prototype,n.add=function(g,E){Cn(this),this.i=null,g=Yi(this,g);let A=this.g.get(g);return A||this.g.set(g,A=[]),A.push(E),this.h+=1,this};function rc(g,E){Cn(g),E=Yi(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Tl(g,E){return Cn(g),E=Yi(g,E),g.g.has(E)}n.forEach=function(g,E){Cn(this),this.g.forEach(function(A,P){A.forEach(function(J){g.call(E,J,P,this)},this)},this)};function bl(g,E){Cn(g);let A=[];if(typeof E=="string")Tl(g,E)&&(A=A.concat(g.g.get(Yi(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)A=A.concat(g[E]);return A}n.set=function(g,E){return Cn(this),this.i=null,g=Yi(this,g),Tl(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},n.get=function(g,E){return g?(g=bl(this,g),g.length>0?String(g[0]):E):E};function za(g,E,A){rc(g,E),A.length>0&&(g.i=null,g.g.set(Yi(g,E),C(A)),g.h+=A.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let P=0;P<E.length;P++){var A=E[P];const J=ri(A);A=bl(this,A);for(let te=0;te<A.length;te++){let pe=J;A[te]!==""&&(pe+="="+ri(A[te])),g.push(pe)}}return this.i=g.join("&")};function ac(g){const E=new Ki;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function Yi(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function Ga(g,E){E&&!g.j&&(Cn(g),g.i=null,g.g.forEach(function(A,P){const J=P.toLowerCase();P!=J&&(rc(this,P),za(this,J,A))},g)),g.j=E}function ds(g,E){const A=new Pn;if(u.Image){const P=new Image;P.onload=_(Yn,A,"TestLoadImage: loaded",!0,E,P),P.onerror=_(Yn,A,"TestLoadImage: error",!1,E,P),P.onabort=_(Yn,A,"TestLoadImage: abort",!1,E,P),P.ontimeout=_(Yn,A,"TestLoadImage: timeout",!1,E,P),u.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=g}else E(!1)}function xl(g,E){const A=new Pn,P=new AbortController,J=setTimeout(()=>{P.abort(),Yn(A,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:P.signal}).then(te=>{clearTimeout(J),te.ok?Yn(A,"TestPingServer: ok",!0,E):Yn(A,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(J),Yn(A,"TestPingServer: error",!1,E)})}function Yn(g,E,A,P,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),P(A)}catch{}}function Ji(){this.g=new zr}function Ls(g){this.i=g.Sb||null,this.h=g.ab||!1}b(Ls,Gr),Ls.prototype.g=function(){return new Qr(this.i,this.h)};function Qr(g,E){Ct.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(Qr,Ct),n=Qr.prototype,n.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,fs(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||u).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Qi(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,fs(this)),this.g&&(this.readyState=3,fs(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$a(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function $a(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?Qi(this):fs(this),this.readyState==3&&$a(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,Qi(this))},n.Na=function(g){this.g&&(this.response=g,Qi(this))},n.ga=function(){this.g&&Qi(this)};function Qi(g){g.readyState=4,g.l=null,g.j=null,g.B=null,fs(g)}n.setRequestHeader=function(g,E){this.A.append(g,E)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var A=E.next();!A.done;)A=A.value,g.push(A[0]+": "+A[1]),A=E.next();return g.join(`\r
`)};function fs(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Qr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Jn(g){let E="";return Ae(g,function(A,P){E+=P,E+=":",E+=A,E+=`\r
`}),E}function Xr(g,E,A){e:{for(P in A){var P=!1;break e}P=!0}P||(A=Jn(A),typeof g=="string"?A!=null&&ri(A):lt(g,E,A))}function dt(g){Ct.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(dt,Ct);var Vs=/^https?$/i,El=["POST","PUT"];n=dt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,E,A,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():fl.g(),this.g.onreadystatechange=x(f(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(te){Wr(this,te);return}if(g=A||"",A=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var J in P)A.set(J,P[J]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const te of P.keys())A.set(te,P.get(te));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(A.keys()).find(te=>te.toLowerCase()=="content-type"),J=u.FormData&&g instanceof u.FormData,!(Array.prototype.indexOf.call(El,E,void 0)>=0)||P||J||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,pe]of A)this.g.setRequestHeader(te,pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(te){Wr(this,te)}};function Wr(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,Sl(g),ai(g)}function Sl(g){g.A||(g.A=!0,Dt(g,"complete"),Dt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Dt(this,"complete"),Dt(this,"abort"),ai(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),dt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Zr(this):this.Xa())},n.Xa=function(){Zr(this)};function Zr(g){if(g.h&&typeof o<"u"){if(g.v&&hs(g)==4)setTimeout(g.Ca.bind(g),0);else if(Dt(g,"readystatechange"),hs(g)==4){g.h=!1;try{const te=g.ca();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var A;if(!(A=E)){var P;if(P=te===0){let pe=String(g.D).match(nc)[1]||null;!pe&&u.self&&u.self.location&&(pe=u.self.location.protocol.slice(0,-1)),P=!Vs.test(pe?pe.toLowerCase():"")}A=P}if(A)Dt(g,"complete"),Dt(g,"success");else{g.o=6;try{var J=hs(g)>2?g.g.statusText:""}catch{J=""}g.l=J+" ["+g.ca()+"]",Sl(g)}}finally{ai(g)}}}}function ai(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const A=g.g;g.g=null,E||Dt(g,"ready");try{A.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function hs(g){return g.g?g.g.readyState:0}n.ca=function(){try{return hs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),Fa(E)}};function an(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function oi(g){const E={};g=(g.g&&hs(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<g.length;P++){if(O(g[P]))continue;var A=Zu(g[P]);const J=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const te=E[J]||[];E[J]=te,te.push(A)}Ce(E,function(P){return P.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Os(g,E,A){return A&&A.internalChannelParams&&A.internalChannelParams[g]||E}function Xi(g){this.za=0,this.i=[],this.j=new Pn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Os("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Os("baseRetryDelayMs",5e3,g),this.Za=Os("retryDelaySeedMs",1e4,g),this.Ta=Os("forwardChannelMaxRetries",2,g),this.va=Os("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new hl(g&&g.concurrentRequestLimit),this.Ba=new Ji,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Xi.prototype,n.ka=8,n.I=1,n.connect=function(g,E,A,P){wt(0),this.W=g,this.H=E||{},A&&P!==void 0&&(this.H.OSID=A,this.H.OAID=P),this.F=this.X,this.J=hc(this,null,this.W),Us(this)};function Al(g){if(Ka(g),g.I==3){var E=g.V++,A=Ft(g.J);if(lt(A,"SID",g.M),lt(A,"RID",E),lt(A,"TYPE","terminate"),ea(g,A),E=new us(g,g.j,E),E.M=2,E.A=Yr(Ft(A)),A=!1,u.navigator&&u.navigator.sendBeacon)try{A=u.navigator.sendBeacon(E.A.toString(),"")}catch{}!A&&u.Image&&(new Image().src=E.A,A=!0),A||(E.g=mc(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Ns(E)}fc(g)}function Wi(g){g.g&&(wl(g),g.g.cancel(),g.g=null)}function Ka(g){Wi(g),g.v&&(u.clearTimeout(g.v),g.v=null),Ja(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&u.clearTimeout(g.m),g.m=null)}function Us(g){if(!ml(g.h)&&!g.m){g.m=!0;var E=g.Ea;se||N(),H||(se(),H=!0),R.add(E,g),g.D=0}}function Ya(g,E){return Ms(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=$n(f(g.Ea,g,E),dc(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const J=new us(this,this.j,g);let te=this.o;if(this.U&&(te?(te=q(te),me(te,this.U)):te=this.U),this.u!==null||this.R||(J.J=te,te=null),this.S)e:{for(var E=0,A=0;A<this.i.length;A++){t:{var P=this.i[A];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(E+=P,E>4096){E=A;break e}if(E===4096||A===this.i.length-1){E=A+1;break e}}E=1e3}else E=1e3;E=oc(this,J,E),A=Ft(this.J),lt(A,"RID",g),lt(A,"CVER",22),this.G&&lt(A,"X-HTTP-Session-Id",this.G),ea(this,A),te&&(this.R?E="headers="+ri(Jn(te))+"&"+E:this.u&&Xr(A,this.u,te)),pl(this.h,J),this.Ra&&lt(A,"TYPE","init"),this.S?(lt(A,"$req",E),lt(A,"SID","null"),J.U=!0,Is(J,A,null)):Is(J,A,E),this.I=2}}else this.I==3&&(g?Cl(this,g):this.i.length==0||ml(this.h)||Cl(this))};function Cl(g,E){var A;E?A=E.l:A=g.V++;const P=Ft(g.J);lt(P,"SID",g.M),lt(P,"RID",A),lt(P,"AID",g.K),ea(g,P),g.u&&g.o&&Xr(P,g.u,g.o),A=new us(g,g.j,A,g.D+1),g.u===null&&(A.J=g.o),E&&(g.i=E.G.concat(g.i)),E=oc(g,A,1e3),A.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),pl(g.h,A),Is(A,P,E)}function ea(g,E){g.H&&Ae(g.H,function(A,P){lt(E,P,A)}),g.l&&Ae({},function(A,P){lt(E,P,A)})}function oc(g,E,A){A=Math.min(g.i.length,A);const P=g.l?f(g.l.Ka,g.l,g):null;e:{var J=g.i;let je=-1;for(;;){const Mt=["count="+A];je==-1?A>0?(je=J[0].g,Mt.push("ofs="+je)):je=0:Mt.push("ofs="+je);let rt=!0;for(let Et=0;Et<A;Et++){var te=J[Et].g;const Qn=J[Et].map;if(te-=je,te<0)je=Math.max(0,J[Et].g-100),rt=!1;else try{te="req"+te+"_"||"";try{var pe=Qn instanceof Map?Qn:Object.entries(Qn);for(const[Bs,ms]of pe){let ps=ms;d(ms)&&(ps=ws(ms)),Mt.push(te+Bs+"="+encodeURIComponent(ps))}}catch(Bs){throw Mt.push(te+"type="+encodeURIComponent("_badmap")),Bs}}catch{P&&P(Qn)}}if(rt){pe=Mt.join("&");break e}}pe=void 0}return g=g.i.splice(0,A),E.G=g,pe}function lc(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;se||N(),H||(se(),H=!0),R.add(E,g),g.A=0}}function ta(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=$n(f(g.Da,g),dc(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,uc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=$n(f(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,wt(10),Wi(this),uc(this))};function wl(g){g.B!=null&&(u.clearTimeout(g.B),g.B=null)}function uc(g){g.g=new us(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=Ft(g.na);lt(E,"RID","rpc"),lt(E,"SID",g.M),lt(E,"AID",g.K),lt(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&lt(E,"TO",g.ia),lt(E,"TYPE","xmlhttp"),ea(g,E),g.u&&g.o&&Xr(E,g.u,g.o),g.O&&(g.g.H=g.O);var A=g.g;g=g.ba,A.M=1,A.A=Yr(Ft(E)),A.u=null,A.R=!0,Ba(A,g)}n.Va=function(){this.C!=null&&(this.C=null,Wi(this),ta(this),wt(19))};function Ja(g){g.C!=null&&(u.clearTimeout(g.C),g.C=null)}function cc(g,E){var A=null;if(g.g==E){Ja(g),wl(g),g.g=null;var P=2}else if(Ps(g.h,E))A=E.G,gl(g.h,E),P=1;else return;if(g.I!=0){if(E.o)if(P==1){A=E.u?E.u.length:0,E=Date.now()-E.F;var J=g.D;P=_e(),Dt(P,new Gn(P,A)),Us(g)}else lc(g);else if(J=E.m,J==3||J==0&&E.X>0||!(P==1&&Ya(g,E)||P==2&&ta(g)))switch(A&&A.length>0&&(E=g.h,E.i=E.i.concat(A)),J){case 1:Fs(g,5);break;case 4:Fs(g,10);break;case 3:Fs(g,6);break;default:Fs(g,2)}}}function dc(g,E){let A=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(A*=2),A*E}function Fs(g,E){if(g.j.info("Error code "+E),E==2){var A=f(g.bb,g),P=g.Ua;const J=!P;P=new Ln(P||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Zt(P,"https"),Yr(P),J?ds(P.toString(),A):xl(P.toString(),A)}else wt(2);g.I=0,g.l&&g.l.pa(E),fc(g),Ka(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function fc(g){if(g.I=0,g.ja=[],g.l){const E=yl(g.h);(E.length!=0||g.i.length!=0)&&(M(g.ja,E),M(g.ja,g.i),g.h.i.length=0,C(g.i),g.i.length=0),g.l.oa()}}function hc(g,E,A){var P=A instanceof Ln?Ft(A):new Ln(A);if(P.g!="")E&&(P.g=E+"."+P.g),Gi(P,P.u);else{var J=u.location;P=J.protocol,E=E?E+"."+J.hostname:J.hostname,J=+J.port;const te=new Ln(null);P&&Zt(te,P),E&&(te.g=E),J&&Gi(te,J),A&&(te.h=A),P=te}return A=g.G,E=g.wa,A&&E&&lt(P,A,E),lt(P,"VER",g.ka),ea(g,P),P}function mc(g,E,A){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new dt(new Ls({ab:A})):new dt(g.ma),E.Fa(g.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pc(){}n=pc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zi(){}Zi.prototype.g=function(g,E){return new bn(g,E)};function bn(g,E){Ct.call(this),this.g=new Xi(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!O(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new li(this)}b(bn,Ct),bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){Al(this.g)},bn.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var A={};A.__data__=g,g=A}else this.v&&(A={},A.__data__=ws(g),g=A);E.i.push(new Ut(E.Ya++,g)),E.I==3&&Us(E)},bn.prototype.N=function(){this.g.l=null,delete this.j,Al(this.g),delete this.g,bn.Z.N.call(this)};function gc(g){G.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const A in E){g=A;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}b(gc,G);function yc(){ue.call(this),this.status=1}b(yc,ue);function li(g){this.g=g}b(li,pc),li.prototype.ra=function(){Dt(this.g,"a")},li.prototype.qa=function(g){Dt(this.g,new gc(g))},li.prototype.pa=function(g){Dt(this.g,new yc)},li.prototype.oa=function(){Dt(this.g,"b")},Zi.prototype.createWebChannel=Zi.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,DE=function(){return new Zi},RE=function(){return _e()},NE=ce,Cp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},tt.NO_ERROR=0,tt.TIMEOUT=8,tt.HTTP_ERROR=6,Pd=tt,dl.COMPLETE="complete",IE=dl,$r.EventType=Sn,Sn.OPEN="a",Sn.CLOSE="b",Sn.ERROR="c",Sn.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,yu=$r,dt.prototype.listenOnce=dt.prototype.K,dt.prototype.getLastError=dt.prototype.Ha,dt.prototype.getLastErrorCode=dt.prototype.ya,dt.prototype.getStatus=dt.prototype.ca,dt.prototype.getResponseJson=dt.prototype.La,dt.prototype.getResponseText=dt.prototype.la,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Fa,wE=dt}).apply(typeof Ed<"u"?Ed:typeof self<"u"?self:typeof window<"u"?window:{});const fb="@firebase/firestore",hb="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new ng("@firebase/firestore");function Ro(){return wa.logLevel}function ve(n,...e){if(wa.logLevel<=Je.DEBUG){const t=e.map(rg);wa.debug(`Firestore (${rl}): ${n}`,...t)}}function Li(n,...e){if(wa.logLevel<=Je.ERROR){const t=e.map(rg);wa.error(`Firestore (${rl}): ${n}`,...t)}}function Ia(n,...e){if(wa.logLevel<=Je.WARN){const t=e.map(rg);wa.warn(`Firestore (${rl}): ${n}`,...t)}}function rg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,ME(n,s,t)}function ME(n,e,t){let s=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Li(s),new Error(s)}function ot(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||ME(e,r,s)}function Ue(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends Bi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(pn.UNAUTHENTICATED)))}shutdown(){}}class iL{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class rL{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ot(this.o===void 0,42304);let s=this.i;const r=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve();let o=new Di;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Di,e.enqueueRetryable((()=>r(this.currentUser)))};const u=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await r(this.currentUser)}))},d=h=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((h=>d(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Di)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ot(typeof s.accessToken=="string",31837,{l:s}),new PE(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new pn(e)}}class aL{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class oL{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new aL(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(pn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lL{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ot(this.o===void 0,3512);const s=o=>{o.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,ve("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>s(o)))};const r=o=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>r(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?r(o):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ot(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new mb(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=uL(40);for(let o=0;o<r.length;++o)s.length<20&&r[o]<t&&(s+=e.charAt(r[o]%62))}return s}}function Qe(n,e){return n<e?-1:n>e?1:0}function wp(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),o=e.charAt(s);if(r!==o)return Wm(r)===Wm(o)?Qe(r,o):Wm(r)?1:-1}return Qe(n.length,e.length)}const cL=55296,dL=57343;function Wm(n){const e=n.charCodeAt(0);return e>=cL&&e<=dL}function $o(n,e,t){return n.length===e.length&&n.every(((s,r)=>t(s,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="__name__";class Gs{constructor(e,t,s){t===void 0?t=0:t>e.length&&Me(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Me(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Gs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Gs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const o=Gs.compareSegments(e.get(r),t.get(r));if(o!==0)return o}return Qe(e.length,t.length)}static compareSegments(e,t){const s=Gs.isNumericId(e),r=Gs.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Gs.extractNumericId(e).compare(Gs.extractNumericId(t)):wp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Nr.fromString(e.substring(4,e.length-2))}}class xt extends Gs{construct(e,t,s){return new xt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ee(de.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((r=>r.length>0)))}return new xt(t)}static emptyPath(){return new xt([])}}const fL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nn extends Gs{construct(e,t,s){return new nn(e,t,s)}static isValidIdentifier(e){return fL.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pb}static keyField(){return new nn([pb])}static fromServerFormat(e){const t=[];let s="",r=0;const o=()=>{if(s.length===0)throw new Ee(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;r<e.length;){const d=e[r];if(d==="\\"){if(r+1===e.length)throw new Ee(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[r+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Ee(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=h,r+=2}else d==="`"?(u=!u,r++):d!=="."||u?(s+=d,r++):(o(),r++)}if(o(),u)throw new Ee(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nn(t)}static emptyPath(){return new nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(xt.fromString(e))}static fromName(e){return new Ie(xt.fromString(e).popFirst(5))}static empty(){return new Ie(xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(n,e,t){if(!t)throw new Ee(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VE(n,e,t,s){if(e===!0&&s===!0)throw new Ee(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gb(n){if(!Ie.isDocumentKey(n))throw new Ee(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yb(n){if(Ie.isDocumentKey(n))throw new Ee(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function OE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ag(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Me(12329,{type:typeof n})}function Vi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ee(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ag(n);throw new Ee(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(n,e){const t={typeString:n};return e&&(t.value=e),t}function qu(n,e){if(!OE(n))throw new Ee(de.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,o="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(r&&typeof u!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(o!==void 0&&u!==o.value){t=`Expected '${s}' field to equal '${o.value}'`;break}}if(t)throw new Ee(de.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=-62135596800,_b=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*_b);return new yt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<vb)throw new Ee(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_b}_compareTo(e){return this.seconds===e.seconds?Qe(this.nanoseconds,e.nanoseconds):Qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qu(e,yt._jsonSchema))return new yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-vb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Gt("string",yt._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new yt(0,0))}static max(){return new Ve(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=-1;function hL(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=Ve.fromTimestamp(s===1e9?new yt(t+1,0):new yt(t,s));return new Dr(r,Ie.empty(),e)}function mL(n){return new Dr(n.readTime,n.key,Mu)}class Dr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Dr(Ve.min(),Ie.empty(),Mu)}static max(){return new Dr(Ve.max(),Ie.empty(),Mu)}}function pL(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ie.comparator(n.documentKey,e.documentKey),t!==0?t:Qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function al(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==gL)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((s,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(s,r)},this.catchCallback=o=>{this.wrapFailure(t,o).next(s,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,s)=>{t(e)}))}static reject(e){return new le(((t,s)=>{s(e)}))}static waitFor(e){return new le(((t,s)=>{let r=0,o=0,u=!1;e.forEach((d=>{++r,d.next((()=>{++o,u&&o===r&&t()}),(h=>s(h)))})),u=!0,o===r&&t()}))}static or(e){let t=le.resolve(!1);for(const s of e)t=t.next((r=>r?le.resolve(r):s()));return t}static forEach(e,t){const s=[];return e.forEach(((r,o)=>{s.push(t.call(this,r,o))})),this.waitFor(s)}static mapArray(e,t){return new le(((s,r)=>{const o=e.length,u=new Array(o);let d=0;for(let h=0;h<o;h++){const f=h;t(e[f]).next((_=>{u[f]=_,++d,d===o&&s(u)}),(_=>r(_)))}}))}static doWhile(e,t){return new le(((s,r)=>{const o=()=>{e()===!0?t().next((()=>{o()}),r):s()};o()}))}}function vL(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ol(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ef.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=-1;function Sf(n){return n==null}function Qd(n){return n===0&&1/n==-1/0}function _L(n){return typeof n=="number"&&Number.isInteger(n)&&!Qd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE="";function TL(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tb(e)),e=bL(n.get(t),e);return Tb(e)}function bL(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const o=n.charAt(r);switch(o){case"\0":t+="";break;case UE:t+="";break;default:t+=o}}return t}function Tb(n){return n+UE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ma(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t){this.comparator=e,this.root=t||dn.EMPTY}insert(e,t){return new At(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sd(this.root,e,this.comparator,!0)}}class Sd{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?s(e.key,t):1,t&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dn{constructor(e,t,s,r,o){this.key=e,this.value=t,this.color=s??dn.RED,this.left=r??dn.EMPTY,this.right=o??dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,o){return new dn(e??this.key,t??this.value,s??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const o=s(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,s),null):o===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return dn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}dn.EMPTY=null,dn.RED=!0,dn.BLACK=!1;dn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,t,s,r,o){return this}insert(e,t,s){return new dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xb(this.data.getIterator())}getIteratorFrom(e){return new xb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=s.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qt(this.comparator);return t.data=e,t}}class xb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(nn.comparator)}static empty(){return new Ts([])}unionWith(e){let t=new Qt(nn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $o(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new BE("Invalid base64 string: "+o):o}})(e);return new sn(t)}static fromUint8Array(e){const t=(function(r){let o="";for(let u=0;u<r.length;++u)o+=String.fromCharCode(r[u]);return o})(e);return new sn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const xL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(n){if(ot(!!n,39018),typeof n=="string"){let e=0;const t=xL.exec(n);if(ot(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Pr(n){return typeof n=="string"?sn.fromBase64String(n):sn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE="server_timestamp",qE="__type__",HE="__previous_value__",zE="__local_write_time__";function lg(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[qE])==null?void 0:s.stringValue)===jE}function Af(n){const e=n.mapValue.fields[HE];return lg(e)?Af(e):e}function Pu(n){const e=Mr(n.mapValue.fields[zE].timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL{constructor(e,t,s,r,o,u,d,h,f,_){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=_}}const Xd="(default)";class Ko{constructor(e,t){this.projectId=e,this.database=t||Xd}static empty(){return new Ko("","")}get isDefaultDatabase(){return this.database===Xd}isEqual(e){return e instanceof Ko&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE="__type__",SL="__max__",Ad={mapValue:{}},$E="__vector__",Wd="value";function kr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?lg(n)?4:CL(n)?9007199254740991:AL(n)?10:11:Me(28295,{value:n})}function Ws(n,e){if(n===e)return!0;const t=kr(n);if(t!==kr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Pu(n).isEqual(Pu(e));case 3:return(function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const u=Mr(r.timestampValue),d=Mr(o.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,o){return Pr(r.bytesValue).isEqual(Pr(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,o){return Vt(r.geoPointValue.latitude)===Vt(o.geoPointValue.latitude)&&Vt(r.geoPointValue.longitude)===Vt(o.geoPointValue.longitude)})(n,e);case 2:return(function(r,o){if("integerValue"in r&&"integerValue"in o)return Vt(r.integerValue)===Vt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const u=Vt(r.doubleValue),d=Vt(o.doubleValue);return u===d?Qd(u)===Qd(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return $o(n.arrayValue.values||[],e.arrayValue.values||[],Ws);case 10:case 11:return(function(r,o){const u=r.mapValue.fields||{},d=o.mapValue.fields||{};if(bb(u)!==bb(d))return!1;for(const h in u)if(u.hasOwnProperty(h)&&(d[h]===void 0||!Ws(u[h],d[h])))return!1;return!0})(n,e);default:return Me(52216,{left:n})}}function ku(n,e){return(n.values||[]).find((t=>Ws(t,e)))!==void 0}function Yo(n,e){if(n===e)return 0;const t=kr(n),s=kr(e);if(t!==s)return Qe(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Qe(n.booleanValue,e.booleanValue);case 2:return(function(o,u){const d=Vt(o.integerValue||o.doubleValue),h=Vt(u.integerValue||u.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1})(n,e);case 3:return Eb(n.timestampValue,e.timestampValue);case 4:return Eb(Pu(n),Pu(e));case 5:return wp(n.stringValue,e.stringValue);case 6:return(function(o,u){const d=Pr(o),h=Pr(u);return d.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,u){const d=o.split("/"),h=u.split("/");for(let f=0;f<d.length&&f<h.length;f++){const _=Qe(d[f],h[f]);if(_!==0)return _}return Qe(d.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,u){const d=Qe(Vt(o.latitude),Vt(u.latitude));return d!==0?d:Qe(Vt(o.longitude),Vt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Sb(n.arrayValue,e.arrayValue);case 10:return(function(o,u){var x,C,M,k;const d=o.fields||{},h=u.fields||{},f=(x=d[Wd])==null?void 0:x.arrayValue,_=(C=h[Wd])==null?void 0:C.arrayValue,b=Qe(((M=f==null?void 0:f.values)==null?void 0:M.length)||0,((k=_==null?void 0:_.values)==null?void 0:k.length)||0);return b!==0?b:Sb(f,_)})(n.mapValue,e.mapValue);case 11:return(function(o,u){if(o===Ad.mapValue&&u===Ad.mapValue)return 0;if(o===Ad.mapValue)return 1;if(u===Ad.mapValue)return-1;const d=o.fields||{},h=Object.keys(d),f=u.fields||{},_=Object.keys(f);h.sort(),_.sort();for(let b=0;b<h.length&&b<_.length;++b){const x=wp(h[b],_[b]);if(x!==0)return x;const C=Yo(d[h[b]],f[_[b]]);if(C!==0)return C}return Qe(h.length,_.length)})(n.mapValue,e.mapValue);default:throw Me(23264,{he:t})}}function Eb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Qe(n,e);const t=Mr(n),s=Mr(e),r=Qe(t.seconds,s.seconds);return r!==0?r:Qe(t.nanos,s.nanos)}function Sb(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const o=Yo(t[r],s[r]);if(o)return o}return Qe(t.length,s.length)}function Jo(n){return Ip(n)}function Ip(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Mr(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Pr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ie.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",r=!0;for(const o of t.values||[])r?r=!1:s+=",",s+=Ip(o);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let r="{",o=!0;for(const u of s)o?o=!1:r+=",",r+=`${u}:${Ip(t.fields[u])}`;return r+"}"})(n.mapValue):Me(61005,{value:n})}function kd(n){switch(kr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Af(n);return e?16+kd(e):16;case 5:return 2*n.stringValue.length;case 6:return Pr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,o)=>r+kd(o)),0)})(n.arrayValue);case 10:case 11:return(function(s){let r=0;return Ma(s.fields,((o,u)=>{r+=o.length+kd(u)})),r})(n.mapValue);default:throw Me(13486,{value:n})}}function Np(n){return!!n&&"integerValue"in n}function ug(n){return!!n&&"arrayValue"in n}function Ab(n){return!!n&&"nullValue"in n}function Cb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ld(n){return!!n&&"mapValue"in n}function AL(n){var t,s;return((s=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[GE])==null?void 0:s.stringValue)===$E}function Eu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ma(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Eu(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Eu(n.arrayValue.values[t]);return e}return{...n}}function CL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===SL}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.value=e}static empty(){return new as({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ld(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Eu(t)}setAll(e){let t=nn.emptyPath(),s={},r=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,s,r),s={},r=[],t=d.popLast()}u?s[d.lastSegment()]=Eu(u):r.push(d.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,s,r)}delete(e){const t=this.field(e.popLast());Ld(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ws(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Ld(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Ma(t,((r,o)=>e[r]=o));for(const r of s)delete e[r]}clone(){return new as(Eu(this.value))}}function KE(n){const e=[];return Ma(n.fields,((t,s)=>{const r=new nn([t]);if(Ld(s)){const o=KE(s.mapValue).fields;if(o.length===0)e.push(r);else for(const u of o)e.push(r.child(u))}else e.push(r)})),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,t,s,r,o,u,d){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=o,this.data=u,this.documentState=d}static newInvalidDocument(e){return new yn(e,0,Ve.min(),Ve.min(),Ve.min(),as.empty(),0)}static newFoundDocument(e,t,s,r){return new yn(e,1,t,Ve.min(),s,r,0)}static newNoDocument(e,t){return new yn(e,2,t,Ve.min(),Ve.min(),as.empty(),0)}static newUnknownDocument(e,t){return new yn(e,3,t,Ve.min(),Ve.min(),as.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=as.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=as.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t){this.position=e,this.inclusive=t}}function wb(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const o=e[r],u=n.position[r];if(o.field.isKeyField()?s=Ie.comparator(Ie.fromName(u.referenceValue),t.key):s=Yo(u,t.data.field(o.field)),o.dir==="desc"&&(s*=-1),s!==0)break}return s}function Ib(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ws(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t="asc"){this.field=e,this.dir=t}}function wL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{}class Jt extends YE{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new NL(e,t,s):t==="array-contains"?new ML(e,s):t==="in"?new PL(e,s):t==="not-in"?new kL(e,s):t==="array-contains-any"?new LL(e,s):new Jt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new RL(e,s):new DL(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yo(t,this.value)):t!==null&&kr(this.value)===kr(t)&&this.matchesComparison(Yo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zs extends YE{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Zs(e,t)}matches(e){return JE(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function JE(n){return n.op==="and"}function QE(n){return IL(n)&&JE(n)}function IL(n){for(const e of n.filters)if(e instanceof Zs)return!1;return!0}function Rp(n){if(n instanceof Jt)return n.field.canonicalString()+n.op.toString()+Jo(n.value);if(QE(n))return n.filters.map((e=>Rp(e))).join(",");{const e=n.filters.map((t=>Rp(t))).join(",");return`${n.op}(${e})`}}function XE(n,e){return n instanceof Jt?(function(s,r){return r instanceof Jt&&s.op===r.op&&s.field.isEqual(r.field)&&Ws(s.value,r.value)})(n,e):n instanceof Zs?(function(s,r){return r instanceof Zs&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((o,u,d)=>o&&XE(u,r.filters[d])),!0):!1})(n,e):void Me(19439)}function WE(n){return n instanceof Jt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Jo(t.value)}`})(n):n instanceof Zs?(function(t){return t.op.toString()+" {"+t.getFilters().map(WE).join(" ,")+"}"})(n):"Filter"}class NL extends Jt{constructor(e,t,s){super(e,t,s),this.key=Ie.fromName(s.referenceValue)}matches(e){const t=Ie.comparator(e.key,this.key);return this.matchesComparison(t)}}class RL extends Jt{constructor(e,t){super(e,"in",t),this.keys=ZE("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class DL extends Jt{constructor(e,t){super(e,"not-in",t),this.keys=ZE("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ZE(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((s=>Ie.fromName(s.referenceValue)))}class ML extends Jt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ug(t)&&ku(t.arrayValue,this.value)}}class PL extends Jt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ku(this.value.arrayValue,t)}}class kL extends Jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ku(this.value.arrayValue,t)}}class LL extends Jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ug(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>ku(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(e,t=null,s=[],r=[],o=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=o,this.startAt=u,this.endAt=d,this.Te=null}}function Nb(n,e=null,t=[],s=[],r=null,o=null,u=null){return new VL(n,e,t,s,r,o,u)}function cg(n){const e=Ue(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Rp(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(o){return o.field.canonicalString()+o.dir})(s))).join(","),Sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Jo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Jo(s))).join(",")),e.Te=t}return e.Te}function dg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!XE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ib(n.startAt,e.startAt)&&Ib(n.endAt,e.endAt)}function Dp(n){return Ie.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t=null,s=[],r=[],o=null,u="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=o,this.limitType=u,this.startAt=d,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function OL(n,e,t,s,r,o,u,d){return new Cf(n,e,t,s,r,o,u,d)}function fg(n){return new Cf(n)}function Rb(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function UL(n){return n.collectionGroup!==null}function Su(n){const e=Ue(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Qt(nn.comparator);return u.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(d=d.add(f.field))}))})),d})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ef(o,s))})),t.has(nn.keyField().canonicalString())||e.Ie.push(new ef(nn.keyField(),s))}return e.Ie}function Ks(n){const e=Ue(n);return e.Ee||(e.Ee=FL(e,Su(n))),e.Ee}function FL(n,e){if(n.limitType==="F")return Nb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const o=r.dir==="desc"?"asc":"desc";return new ef(r.field,o)}));const t=n.endAt?new Zd(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Zd(n.startAt.position,n.startAt.inclusive):null;return Nb(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Mp(n,e,t){return new Cf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wf(n,e){return dg(Ks(n),Ks(e))&&n.limitType===e.limitType}function eS(n){return`${cg(Ks(n))}|lt:${n.limitType}`}function Do(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((r=>WE(r))).join(", ")}]`),Sf(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((r=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(r))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((r=>Jo(r))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((r=>Jo(r))).join(",")),`Target(${s})`})(Ks(n))}; limitType=${n.limitType})`}function If(n,e){return e.isFoundDocument()&&(function(s,r){const o=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):Ie.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o)})(n,e)&&(function(s,r){for(const o of Su(s))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(s,r){for(const o of s.filters)if(!o.matches(r))return!1;return!0})(n,e)&&(function(s,r){return!(s.startAt&&!(function(u,d,h){const f=wb(u,d,h);return u.inclusive?f<=0:f<0})(s.startAt,Su(s),r)||s.endAt&&!(function(u,d,h){const f=wb(u,d,h);return u.inclusive?f>=0:f>0})(s.endAt,Su(s),r))})(n,e)}function BL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tS(n){return(e,t)=>{let s=!1;for(const r of Su(n)){const o=jL(r,e,t);if(o!==0)return o;s=s||r.field.isKeyField()}return 0}}function jL(n,e,t){const s=n.field.isKeyField()?Ie.comparator(e.key,t.key):(function(o,u,d){const h=u.data.field(o),f=d.data.field(o);return h!==null&&f!==null?Yo(h,f):Me(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Me(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,o]of s)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ma(this.inner,((t,s)=>{for(const[r,o]of s)e(r,o)}))}isEmpty(){return FE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=new At(Ie.comparator);function Oi(){return qL}const nS=new At(Ie.comparator);function vu(...n){let e=nS;for(const t of n)e=e.insert(t.key,t);return e}function sS(n){let e=nS;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function ba(){return Au()}function iS(){return Au()}function Au(){return new Pa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const HL=new At(Ie.comparator),zL=new Qt(Ie.comparator);function Xe(...n){let e=zL;for(const t of n)e=e.add(t);return e}const GL=new Qt(Qe);function $L(){return GL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qd(e)?"-0":e}}function rS(n){return{integerValue:""+n}}function KL(n,e){return _L(e)?rS(e):hg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this._=void 0}}function YL(n,e,t){return n instanceof tf?(function(r,o){const u={fields:{[qE]:{stringValue:jE},[zE]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&lg(o)&&(o=Af(o)),o&&(u.fields[HE]=o),{mapValue:u}})(t,e):n instanceof Lu?oS(n,e):n instanceof Vu?lS(n,e):(function(r,o){const u=aS(r,o),d=Db(u)+Db(r.Ae);return Np(u)&&Np(r.Ae)?rS(d):hg(r.serializer,d)})(n,e)}function JL(n,e,t){return n instanceof Lu?oS(n,e):n instanceof Vu?lS(n,e):t}function aS(n,e){return n instanceof nf?(function(s){return Np(s)||(function(o){return!!o&&"doubleValue"in o})(s)})(e)?e:{integerValue:0}:null}class tf extends Nf{}class Lu extends Nf{constructor(e){super(),this.elements=e}}function oS(n,e){const t=uS(e);for(const s of n.elements)t.some((r=>Ws(r,s)))||t.push(s);return{arrayValue:{values:t}}}class Vu extends Nf{constructor(e){super(),this.elements=e}}function lS(n,e){let t=uS(e);for(const s of n.elements)t=t.filter((r=>!Ws(r,s)));return{arrayValue:{values:t}}}class nf extends Nf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Db(n){return Vt(n.integerValue||n.doubleValue)}function uS(n){return ug(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function QL(n,e){return n.field.isEqual(e.field)&&(function(s,r){return s instanceof Lu&&r instanceof Lu||s instanceof Vu&&r instanceof Vu?$o(s.elements,r.elements,Ws):s instanceof nf&&r instanceof nf?Ws(s.Ae,r.Ae):s instanceof tf&&r instanceof tf})(n.transform,e.transform)}class XL{constructor(e,t){this.version=e,this.transformResults=t}}class Ys{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ys}static exists(e){return new Ys(void 0,e)}static updateTime(e){return new Ys(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Rf{}function cS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mg(n.key,Ys.none()):new Hu(n.key,n.data,Ys.none());{const t=n.data,s=as.empty();let r=new Qt(nn.comparator);for(let o of e.fields)if(!r.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?s.delete(o):s.set(o,u),r=r.add(o)}return new ka(n.key,s,new Ts(r.toArray()),Ys.none())}}function WL(n,e,t){n instanceof Hu?(function(r,o,u){const d=r.value.clone(),h=Pb(r.fieldTransforms,o,u.transformResults);d.setAll(h),o.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof ka?(function(r,o,u){if(!Vd(r.precondition,o))return void o.convertToUnknownDocument(u.version);const d=Pb(r.fieldTransforms,o,u.transformResults),h=o.data;h.setAll(dS(r)),h.setAll(d),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(n,e,t):(function(r,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Cu(n,e,t,s){return n instanceof Hu?(function(o,u,d,h){if(!Vd(o.precondition,u))return d;const f=o.value.clone(),_=kb(o.fieldTransforms,h,u);return f.setAll(_),u.convertToFoundDocument(u.version,f).setHasLocalMutations(),null})(n,e,t,s):n instanceof ka?(function(o,u,d,h){if(!Vd(o.precondition,u))return d;const f=kb(o.fieldTransforms,h,u),_=u.data;return _.setAll(dS(o)),_.setAll(f),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),d===null?null:d.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((b=>b.field)))})(n,e,t,s):(function(o,u,d){return Vd(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function ZL(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),o=aS(s.transform,r||null);o!=null&&(t===null&&(t=as.empty()),t.set(s.field,o))}return t||null}function Mb(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&$o(s,r,((o,u)=>QL(o,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hu extends Rf{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ka extends Rf{constructor(e,t,s,r,o=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function dS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function Pb(n,e,t){const s=new Map;ot(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const o=n[r],u=o.transform,d=e.data.field(o.field);s.set(o.field,JL(u,d,t[r]))}return s}function kb(n,e,t){const s=new Map;for(const r of n){const o=r.transform,u=t.data.field(r.field);s.set(r.field,YL(o,u,e))}return s}class mg extends Rf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eV extends Rf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&WL(o,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Cu(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Cu(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=iS();return this.mutations.forEach((r=>{const o=e.get(r.key),u=o.overlayedDocument;let d=this.applyToLocalView(u,o.mutatedFields);d=t.has(r.key)?null:d;const h=cS(u,d);h!==null&&s.set(r.key,h),u.isValidDocument()||u.convertToNoDocument(Ve.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Xe())}isEqual(e){return this.batchId===e.batchId&&$o(this.mutations,e.mutations,((t,s)=>Mb(t,s)))&&$o(this.baseMutations,e.baseMutations,((t,s)=>Mb(t,s)))}}class pg{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){ot(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return HL})();const o=e.mutations;for(let u=0;u<o.length;u++)r=r.insert(o[u].key,s[u].version);return new pg(e,t,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt,et;function iV(n){switch(n){case de.OK:return Me(64938);case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0;default:return Me(15467,{code:n})}}function fS(n){if(n===void 0)return Li("GRPC error has no .code"),de.UNKNOWN;switch(n){case zt.OK:return de.OK;case zt.CANCELLED:return de.CANCELLED;case zt.UNKNOWN:return de.UNKNOWN;case zt.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case zt.INTERNAL:return de.INTERNAL;case zt.UNAVAILABLE:return de.UNAVAILABLE;case zt.UNAUTHENTICATED:return de.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case zt.NOT_FOUND:return de.NOT_FOUND;case zt.ALREADY_EXISTS:return de.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return de.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case zt.ABORTED:return de.ABORTED;case zt.OUT_OF_RANGE:return de.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return de.UNIMPLEMENTED;case zt.DATA_LOSS:return de.DATA_LOSS;default:return Me(39323,{code:n})}}(et=zt||(zt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=new Nr([4294967295,4294967295],0);function Lb(n){const e=rV().encode(n),t=new CE;return t.update(e),new Uint8Array(t.digest())}function Vb(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Nr([t,s],0),new Nr([r,o],0)]}class gg{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new _u(`Invalid padding: ${t}`);if(s<0)throw new _u(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new _u(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new _u(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Nr.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply(Nr.fromNumber(s)));return r.compare(aV)===1&&(r=new Nr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Lb(e),[s,r]=Vb(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,r,o);if(!this.we(u))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new gg(o,r,t);return s.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=Lb(e),[s,r]=Vb(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,r,o);this.Se(u)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class _u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,t,s,r,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,zu.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Df(Ve.min(),r,new At(Qe),Oi(),Xe())}}class zu{constructor(e,t,s,r,o){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new zu(s,t,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class hS{constructor(e,t){this.targetId=e,this.Ce=t}}class mS{constructor(e,t,s=sn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Ob{constructor(){this.ve=0,this.Fe=Ub(),this.Me=sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),t=Xe(),s=Xe();return this.Fe.forEach(((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:Me(38017,{changeType:o})}})),new zu(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Ub()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class oV{constructor(e){this.Ge=e,this.ze=new Map,this.je=Oi(),this.Je=Cd(),this.He=Cd(),this.Ye=new At(Qe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const o=r.target;if(Dp(o))if(s===0){const u=new Ie(o.path);this.et(t,u,yn.newNoDocument(u,Ve.min()))}else ot(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const d=this.ut(e),h=d?this.ct(d,e,u):1;if(h!==0){this.it(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,f)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:o=0}=t;let u,d;try{u=Pr(s).toUint8Array()}catch(h){if(h instanceof BE)return Ia("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new gg(u,r,o)}catch(h){return Ia(h instanceof _u?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.ge===0?null:d}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach((o=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(d)||(this.et(t,o,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((o,u)=>{const d=this.ot(u);if(d){if(o.current&&Dp(d.target)){const h=new Ie(d.target.path);this.It(h).has(u)||this.Et(u,h)||this.et(u,h,yn.newNoDocument(h,e))}o.Be&&(t.set(u,o.ke()),o.qe())}}));let s=Xe();this.He.forEach(((o,u)=>{let d=!0;u.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(s=s.add(o))})),this.je.forEach(((o,u)=>u.setReadTime(e)));const r=new Df(e,t,this.Ye,this.je,s);return this.je=Oi(),this.Je=Cd(),this.He=Cd(),this.Ye=new At(Qe),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Ob,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qt(Qe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qt(Qe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ob),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Cd(){return new At(Ie.comparator)}function Ub(){return new At(Ie.comparator)}const lV={asc:"ASCENDING",desc:"DESCENDING"},uV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cV={and:"AND",or:"OR"};class dV{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Pp(n,e){return n.useProto3Json||Sf(e)?e:{value:e}}function sf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pS(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function fV(n,e){return sf(n,e.toTimestamp())}function Js(n){return ot(!!n,49232),Ve.fromTimestamp((function(t){const s=Mr(t);return new yt(s.seconds,s.nanos)})(n))}function yg(n,e){return kp(n,e).canonicalString()}function kp(n,e){const t=(function(r){return new xt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function gS(n){const e=xt.fromString(n);return ot(bS(e),10190,{key:e.toString()}),e}function Lp(n,e){return yg(n.databaseId,e.path)}function Zm(n,e){const t=gS(e);if(t.get(1)!==n.databaseId.projectId)throw new Ee(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ee(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ie(vS(t))}function yS(n,e){return yg(n.databaseId,e)}function hV(n){const e=gS(n);return e.length===4?xt.emptyPath():vS(e)}function Vp(n){return new xt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function vS(n){return ot(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Fb(n,e,t){return{name:Lp(n,e),fields:t.value.mapValue.fields}}function mV(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Me(39313,{state:f})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=(function(f,_){return f.useProto3Json?(ot(_===void 0||typeof _=="string",58123),sn.fromBase64String(_||"")):(ot(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),sn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(f){const _=f.code===void 0?de.UNKNOWN:fS(f.code);return new Ee(_,f.message||"")})(u);t=new mS(s,r,o,d||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Zm(n,s.document.name),o=Js(s.document.updateTime),u=s.document.createTime?Js(s.document.createTime):Ve.min(),d=new as({mapValue:{fields:s.document.fields}}),h=yn.newFoundDocument(r,o,u,d),f=s.targetIds||[],_=s.removedTargetIds||[];t=new Od(f,_,h.key,h)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Zm(n,s.document),o=s.readTime?Js(s.readTime):Ve.min(),u=yn.newNoDocument(r,o),d=s.removedTargetIds||[];t=new Od([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Zm(n,s.document),o=s.removedTargetIds||[];t=new Od([],o,r,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:o}=s,u=new sV(r,o),d=s.targetId;t=new hS(d,u)}}return t}function pV(n,e){let t;if(e instanceof Hu)t={update:Fb(n,e.key,e.value)};else if(e instanceof mg)t={delete:Lp(n,e.key)};else if(e instanceof ka)t={update:Fb(n,e.key,e.data),updateMask:SV(e.fieldMask)};else{if(!(e instanceof eV))return Me(16599,{Vt:e.type});t={verify:Lp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(o,u){const d=u.transform;if(d instanceof tf)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Lu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Vu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof nf)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw Me(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(r,o){return o.updateTime!==void 0?{updateTime:fV(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Me(27497)})(n,e.precondition)),t}function gV(n,e){return n&&n.length>0?(ot(e!==void 0,14353),n.map((t=>(function(r,o){let u=r.updateTime?Js(r.updateTime):Js(o);return u.isEqual(Ve.min())&&(u=Js(o)),new XL(u,r.transformResults||[])})(t,e)))):[]}function yV(n,e){return{documents:[yS(n,e.path)]}}function vV(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=yS(n,r);const o=(function(f){if(f.length!==0)return TS(Zs.create(f,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const u=(function(f){if(f.length!==0)return f.map((_=>(function(x){return{field:Mo(x.field),direction:bV(x.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=Pp(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(e.endAt)),{ft:t,parent:r}}function _V(n){let e=hV(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){ot(s===1,65062);const _=t.from[0];_.allDescendants?r=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=(function(b){const x=_S(b);return x instanceof Zs&&QE(x)?x.getFilters():[x]})(t.where));let u=[];t.orderBy&&(u=(function(b){return b.map((x=>(function(M){return new ef(Po(M.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(b){let x;return x=typeof b=="object"?b.value:b,Sf(x)?null:x})(t.limit));let h=null;t.startAt&&(h=(function(b){const x=!!b.before,C=b.values||[];return new Zd(C,x)})(t.startAt));let f=null;return t.endAt&&(f=(function(b){const x=!b.before,C=b.values||[];return new Zd(C,x)})(t.endAt)),OL(e,r,u,o,d,"F",h,f)}function TV(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _S(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Po(t.unaryFilter.field);return Jt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Po(t.unaryFilter.field);return Jt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Po(t.unaryFilter.field);return Jt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Po(t.unaryFilter.field);return Jt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Jt.create(Po(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Zs.create(t.compositeFilter.filters.map((s=>_S(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Me(1026)}})(t.compositeFilter.op))})(n):Me(30097,{filter:n})}function bV(n){return lV[n]}function xV(n){return uV[n]}function EV(n){return cV[n]}function Mo(n){return{fieldPath:n.canonicalString()}}function Po(n){return nn.fromServerFormat(n.fieldPath)}function TS(n){return n instanceof Jt?(function(t){if(t.op==="=="){if(Cb(t.value))return{unaryFilter:{field:Mo(t.field),op:"IS_NAN"}};if(Ab(t.value))return{unaryFilter:{field:Mo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Cb(t.value))return{unaryFilter:{field:Mo(t.field),op:"IS_NOT_NAN"}};if(Ab(t.value))return{unaryFilter:{field:Mo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mo(t.field),op:xV(t.op),value:t.value}}})(n):n instanceof Zs?(function(t){const s=t.getFilters().map((r=>TS(r)));return s.length===1?s[0]:{compositeFilter:{op:EV(t.op),filters:s}}})(n):Me(54877,{filter:n})}function SV(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function bS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,t,s,r,o=Ve.min(),u=Ve.min(),d=sn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new Ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e){this.yt=e}}function CV(n){const e=_V({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Mp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(){this.Cn=new IV}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Dr.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Dr.min())}updateCollectionGroup(e,t,s){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class IV{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Qt(xt.comparator),o=!r.has(s);return this.index[t]=r.add(s),o}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Qt(xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xS=41943040;class Mn{static withCacheSize(e){return new Mn(e,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn.DEFAULT_COLLECTION_PERCENTILE=10,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mn.DEFAULT=new Mn(xS,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mn.DISABLED=new Mn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Qo(0)}static cr(){return new Qo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb="LruGarbageCollector",NV=1048576;function qb([n,e],[t,s]){const r=Qe(n,t);return r===0?Qe(e,s):r}class RV{constructor(e){this.Ir=e,this.buffer=new Qt(qb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();qb(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class DV{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ve(jb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ol(t)?ve(jb,"Ignoring IndexedDB error during garbage collection: ",t):await al(t)}await this.Vr(3e5)}))}}class MV{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(Ef.ce);const s=new RV(t);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(Bb)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,o,u,d,h,f;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),r=this.params.maximumSequenceNumbersToCollect):r=b,u=Date.now(),this.nthSequenceNumber(e,r)))).next((b=>(s=b,d=Date.now(),this.removeTargets(e,s,t)))).next((b=>(o=b,h=Date.now(),this.removeOrphanedDocuments(e,s)))).next((b=>(f=Date.now(),Ro()<=Je.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${r} in `+(d-u)+`ms
	Removed ${o} targets in `+(h-d)+`ms
	Removed ${b} documents in `+(f-h)+`ms
Total Duration: ${f-_}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:b}))))}}function PV(n,e){return new MV(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(){this.changes=new Pa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?le.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(s!==null&&Cu(s.mutation,r,Ts.empty(),yt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Xe()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Xe()){const r=ba();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,s).next((o=>{let u=vu();return o.forEach(((d,h)=>{u=u.insert(d,h.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=ba();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Xe())))}populateOverlays(e,t,s){const r=[];return s.forEach((o=>{t.has(o)||r.push(o)})),this.documentOverlayCache.getOverlays(e,r).next((o=>{o.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,s,r){let o=Oi();const u=Au(),d=(function(){return Au()})();return t.forEach(((h,f)=>{const _=s.get(f.key);r.has(f.key)&&(_===void 0||_.mutation instanceof ka)?o=o.insert(f.key,f):_!==void 0?(u.set(f.key,_.mutation.getFieldMask()),Cu(_.mutation,f,_.mutation.getFieldMask(),yt.now())):u.set(f.key,Ts.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((f,_)=>u.set(f,_))),t.forEach(((f,_)=>d.set(f,new LV(_,u.get(f)??null)))),d)))}recalculateAndSaveOverlays(e,t){const s=Au();let r=new At(((u,d)=>u-d)),o=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((h=>{const f=t.get(h);if(f===null)return;let _=s.get(h)||Ts.empty();_=d.applyToLocalView(f,_),s.set(h,_);const b=(r.get(d.batchId)||Xe()).add(h);r=r.insert(d.batchId,b)}))})).next((()=>{const u=[],d=r.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),f=h.key,_=h.value,b=iS();_.forEach((x=>{if(!o.has(x)){const C=cS(t.get(x),s.get(x));C!==null&&b.set(x,C),o=o.add(x)}})),u.push(this.documentOverlayCache.saveOverlays(e,f,b))}return le.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,r){return(function(u){return Ie.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next((o=>{const u=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-o.size):le.resolve(ba());let d=Mu,h=o;return u.next((f=>le.forEach(f,((_,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),o.get(_)?le.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{h=h.insert(_,x)}))))).next((()=>this.populateOverlays(e,f,o))).next((()=>this.computeViews(e,h,f,Xe()))).next((_=>({batchId:d,changes:sS(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ie(t)).next((s=>{let r=vu();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const o=t.collectionGroup;let u=vu();return this.indexManager.getCollectionParents(e,o).next((d=>le.forEach(d,(h=>{const f=(function(b,x){return new Cf(x,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,s,r).next((_=>{_.forEach(((b,x)=>{u=u.insert(b,x)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,o,r)))).next((u=>{o.forEach(((h,f)=>{const _=f.getKey();u.get(_)===null&&(u=u.insert(_,yn.newInvalidDocument(_)))}));let d=vu();return u.forEach(((h,f)=>{const _=o.get(h);_!==void 0&&Cu(_.mutation,f,Ts.empty(),yt.now()),If(t,f)&&(d=d.insert(h,f))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return le.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Js(r.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:CV(r.bundledQuery),readTime:Js(r.readTime)}})(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(){this.overlays=new At(Ie.comparator),this.qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const s=ba();return le.forEach(t,(r=>this.getOverlay(e,r).next((o=>{o!==null&&s.set(r,o)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((r,o)=>{this.St(e,t,o)})),le.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(s)),le.resolve()}getOverlaysForCollection(e,t,s){const r=ba(),o=t.length+1,u=new Ie(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const h=d.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>s&&r.set(h.getKey(),h)}return le.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let o=new At(((f,_)=>f-_));const u=this.overlays.getIterator();for(;u.hasNext();){const f=u.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>s){let _=o.get(f.largestBatchId);_===null&&(_=ba(),o=o.insert(f.largestBatchId,_)),_.set(f.getKey(),f)}}const d=ba(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,_)=>d.set(f,_))),!(d.size()>=r)););return le.resolve(d)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const u=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new nV(t,s));let o=this.qr.get(t);o===void 0&&(o=Xe(),this.qr.set(t,o)),this.qr.set(t,o.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(){this.Qr=new Qt(tn.$r),this.Ur=new Qt(tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new tn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new tn(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new Ie(new xt([])),s=new tn(t,e),r=new tn(t,e+1),o=[];return this.Ur.forEachInRange([s,r],(u=>{this.Gr(u),o.push(u.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ie(new xt([])),s=new tn(t,e),r=new tn(t,e+1);let o=Xe();return this.Ur.forEachInRange([s,r],(u=>{o=o.add(u.key)})),o}containsKey(e){const t=new tn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class tn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ie.comparator(e.key,t.key)||Qe(e.Yr,t.Yr)}static Kr(e,t){return Qe(e.Yr,t.Yr)||Ie.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(tn.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new tV(o,t,s,r);this.mutationQueue.push(u);for(const d of r)this.Zr=this.Zr.add(new tn(d.key,o)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return le.resolve(u)}lookupMutationBatch(e,t){return le.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),o=r<0?0:r;return le.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?og:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new tn(t,0),r=new tn(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([s,r],(u=>{const d=this.Xr(u.Yr);o.push(d)})),le.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qt(Qe);return t.forEach((r=>{const o=new tn(r,0),u=new tn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,u],(d=>{s=s.add(d.Yr)}))})),le.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let o=s;Ie.isDocumentKey(o)||(o=o.child(""));const u=new tn(new Ie(o),0);let d=new Qt(Qe);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!s.isPrefixOf(f)&&(f.length===r&&(d=d.add(h.Yr)),!0)}),u),le.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){ot(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return le.forEach(t.mutations,(r=>{const o=new tn(r.key,t.batchId);return s=s.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new tn(t,0),r=this.Zr.firstAfterOrEqual(s);return le.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e){this.ri=e,this.docs=(function(){return new At(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),o=r?r.size:0,u=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return le.resolve(s?s.document.mutableCopy():yn.newInvalidDocument(t))}getEntries(e,t){let s=Oi();return t.forEach((r=>{const o=this.docs.get(r);s=s.insert(r,o?o.document.mutableCopy():yn.newInvalidDocument(r))})),le.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let o=Oi();const u=t.path,d=new Ie(u.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:f,value:{document:_}}=h.getNext();if(!u.isPrefixOf(f.path))break;f.path.length>u.length+1||pL(mL(_),s)<=0||(r.has(_.key)||If(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return le.resolve(o)}getAllFromCollectionGroup(e,t,s,r){Me(9500)}ii(e,t){return le.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new qV(this)}getSize(e){return le.resolve(this.size)}}class qV extends kV{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),le.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e){this.persistence=e,this.si=new Pa((t=>cg(t)),dg),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new vg,this.targetCount=0,this.ai=Qo.ur()}forEachTarget(e,t){return this.si.forEach(((s,r)=>t(r))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),le.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Qo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Pr(t),le.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,s){let r=0;const o=[];return this.si.forEach(((u,d)=>{d.sequenceNumber<=t&&s.get(d.targetId)===null&&(this.si.delete(u),o.push(this.removeMatchingKeysForTargetId(e,d.targetId)),r++)})),le.waitFor(o).next((()=>r))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return le.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),le.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,o=[];return r&&t.forEach((u=>{o.push(r.markPotentiallyOrphaned(e,u))})),le.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return le.resolve(s)}containsKey(e,t){return le.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ef(0),this.li=!1,this.li=!0,this.hi=new FV,this.referenceDelegate=e(this),this.Pi=new HV(this),this.indexManager=new wV,this.remoteDocumentCache=(function(r){return new jV(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new AV(t),this.Ii=new OV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new BV(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){ve("MemoryPersistence","Starting transaction:",e);const r=new zV(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((o=>this.referenceDelegate.di(r).next((()=>o)))).toPromise().then((o=>(r.raiseOnCommittedEvent(),o)))}Ai(e,t){return le.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class zV extends yL{constructor(e){super(),this.currentSequenceNumber=e}}class _g{constructor(e){this.persistence=e,this.Ri=new vg,this.Vi=null}static mi(e){return new _g(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),le.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((o=>this.fi.add(o.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(s=>{const r=Ie.fromPath(s);return this.gi(e,r).next((o=>{o||t.removeEntry(r,Ve.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class rf{constructor(e,t){this.persistence=e,this.pi=new Pa((s=>TL(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=PV(this,t)}static mi(e,t){return new rf(e,t)}Ei(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return le.forEach(this.pi,((s,r)=>this.br(e,s,r).next((o=>o?le.resolve():t(r)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ii(e,(u=>this.br(e,u,t).next((d=>{d||(s++,o.removeEntry(u,Ve.min()))})))).next((()=>o.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),le.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=kd(e.data.value)),t}br(e,t,s){return le.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return le.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=Xe(),r=Xe();for(const o of t.docChanges)switch(o.type){case 0:s=s.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new Tg(e,t.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return U2()?8:vL(_n())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const o={result:null};return this.ys(e,t).next((u=>{o.result=u})).next((()=>{if(!o.result)return this.ws(e,t,r,s).next((u=>{o.result=u}))})).next((()=>{if(o.result)return;const u=new GV;return this.Ss(e,t,u).next((d=>{if(o.result=d,this.Vs)return this.bs(e,t,u,d.size)}))})).next((()=>o.result))}bs(e,t,s,r){return s.documentReadCount<this.fs?(Ro()<=Je.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Do(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(Ro()<=Je.DEBUG&&ve("QueryEngine","Query:",Do(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Ro()<=Je.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Do(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):le.resolve())}ys(e,t){if(Rb(t))return le.resolve(null);let s=Ks(t);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=Mp(t,null,"F"),s=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((o=>{const u=Xe(...o);return this.ps.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,s).next((h=>{const f=this.Ds(t,d);return this.Cs(t,f,u,h.readTime)?this.ys(e,Mp(t,null,"F")):this.vs(e,f,t,h)}))))})))))}ws(e,t,s,r){return Rb(t)||r.isEqual(Ve.min())?le.resolve(null):this.ps.getDocuments(e,s).next((o=>{const u=this.Ds(t,o);return this.Cs(t,u,s,r)?le.resolve(null):(Ro()<=Je.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Do(t)),this.vs(e,u,t,hL(r,Mu)).next((d=>d)))}))}Ds(e,t){let s=new Qt(tS(e));return t.forEach(((r,o)=>{If(e,o)&&(s=s.add(o))})),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Ss(e,t,s){return Ro()<=Je.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Do(t)),this.ps.getDocumentsMatchingQuery(e,t,Dr.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((o=>(t.forEach((u=>{o=o.insert(u.key,u)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg="LocalStore",KV=3e8;class YV{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new At(Qe),this.xs=new Pa((o=>cg(o)),dg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function JV(n,e,t,s){return new YV(n,e,t,s)}async function SS(n,e){const t=Ue(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next((o=>(r=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((o=>{const u=[],d=[];let h=Xe();for(const f of r){u.push(f.batchId);for(const _ of f.mutations)h=h.add(_.key)}for(const f of o){d.push(f.batchId);for(const _ of f.mutations)h=h.add(_.key)}return t.localDocuments.getDocuments(s,h).next((f=>({Ls:f,removedBatchIds:u,addedBatchIds:d})))}))}))}function QV(n,e){const t=Ue(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,h,f,_){const b=f.batch,x=b.keys();let C=le.resolve();return x.forEach((M=>{C=C.next((()=>_.getEntry(h,M))).next((k=>{const V=f.docVersions.get(M);ot(V!==null,48541),k.version.compareTo(V)<0&&(b.applyToRemoteDocument(k,f),k.isValidDocument()&&(k.setReadTime(f.commitVersion),_.addEntry(k)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(h,b)))})(t,s,e,o).next((()=>o.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(d){let h=Xe();for(let f=0;f<d.mutationResults.length;++f)d.mutationResults[f].transformResults.length>0&&(h=h.add(d.batch.mutations[f].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(s,r)))}))}function AS(n){const e=Ue(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function XV(n,e){const t=Ue(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const d=[];e.targetChanges.forEach(((_,b)=>{const x=r.get(b);if(!x)return;d.push(t.Pi.removeMatchingKeys(o,_.removedDocuments,b).next((()=>t.Pi.addMatchingKeys(o,_.addedDocuments,b))));let C=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?C=C.withResumeToken(sn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,s)),r=r.insert(b,C),(function(k,V,$){return k.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=KV?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(x,C,_)&&d.push(t.Pi.updateTargetData(o,C))}));let h=Oi(),f=Xe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(o,_))})),d.push(WV(o,u,e.documentUpdates).next((_=>{h=_.ks,f=_.qs}))),!s.isEqual(Ve.min())){const _=t.Pi.getLastRemoteSnapshotVersion(o).next((b=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,s)));d.push(_)}return le.waitFor(d).next((()=>u.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,f))).next((()=>h))})).then((o=>(t.Ms=r,o)))}function WV(n,e,t){let s=Xe(),r=Xe();return t.forEach((o=>s=s.add(o))),e.getEntries(n,s).next((o=>{let u=Oi();return t.forEach(((d,h)=>{const f=o.get(d);h.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(d)),h.isNoDocument()&&h.version.isEqual(Ve.min())?(e.removeEntry(d,h.readTime),u=u.insert(d,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),u=u.insert(d,h)):ve(bg,"Ignoring outdated watch update for ",d,". Current version:",f.version," Watch version:",h.version)})),{ks:u,qs:r}}))}function ZV(n,e){const t=Ue(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=og),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function eO(n,e){const t=Ue(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return t.Pi.getTargetData(s,e).next((o=>o?(r=o,le.resolve(r)):t.Pi.allocateTargetId(s).next((u=>(r=new Ar(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Op(n,e,t){const s=Ue(n),r=s.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",o,(u=>s.persistence.referenceDelegate.removeTarget(u,r)))}catch(u){if(!ol(u))throw u;ve(bg,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Hb(n,e,t){const s=Ue(n);let r=Ve.min(),o=Xe();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(h,f,_){const b=Ue(h),x=b.xs.get(_);return x!==void 0?le.resolve(b.Ms.get(x)):b.Pi.getTargetData(f,_)})(s,u,Ks(e)).next((d=>{if(d)return r=d.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(u,d.targetId).next((h=>{o=h}))})).next((()=>s.Fs.getDocumentsMatchingQuery(u,e,t?r:Ve.min(),t?o:Xe()))).next((d=>(tO(s,BL(e),d),{documents:d,Qs:o})))))}function tO(n,e,t){let s=n.Os.get(e)||Ve.min();t.forEach(((r,o)=>{o.readTime.compareTo(s)>0&&(s=o.readTime)})),n.Os.set(e,s)}class zb{constructor(){this.activeTargetIds=$L()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nO{constructor(){this.Mo=new zb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zb,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb="ConnectivityMonitor";class $b{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ve(Gb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ve(Gb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd=null;function Up(){return wd===null?wd=(function(){return 268435456+Math.round(2147483648*Math.random())})():wd++,"0x"+wd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="RestConnection",iO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Xd?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,o){const u=Up(),d=this.zo(e,t.toUriEncodedString());ve(ep,`Sending RPC '${e}' ${u}:`,d,s);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,r,o);const{host:f}=new URL(d),_=sl(f);return this.Jo(e,d,h,s,_).then((b=>(ve(ep,`Received RPC '${e}' ${u}: `,b),b)),(b=>{throw Ia(ep,`RPC '${e}' ${u} failed with error: `,b,"url: ",d,"request:",s),b}))}Ho(e,t,s,r,o,u){return this.Go(e,t,s,r,o)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+rl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,o)=>e[o]=r)),s&&s.headers.forEach(((r,o)=>e[o]=r))}zo(e,t){const s=iO[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn="WebChannelConnection";class oO extends rO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,o){const u=Up();return new Promise(((d,h)=>{const f=new wE;f.setWithCredentials(!0),f.listenOnce(IE.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case Pd.NO_ERROR:const b=f.getResponseJson();ve(mn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(b)),d(b);break;case Pd.TIMEOUT:ve(mn,`RPC '${e}' ${u} timed out`),h(new Ee(de.DEADLINE_EXCEEDED,"Request time out"));break;case Pd.HTTP_ERROR:const x=f.getStatus();if(ve(mn,`RPC '${e}' ${u} failed with status:`,x,"response text:",f.getResponseText()),x>0){let C=f.getResponseJson();Array.isArray(C)&&(C=C[0]);const M=C==null?void 0:C.error;if(M&&M.status&&M.message){const k=(function($){const U=$.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(U)>=0?U:de.UNKNOWN})(M.status);h(new Ee(k,M.message))}else h(new Ee(de.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new Ee(de.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:u,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{ve(mn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(r);ve(mn,`RPC '${e}' ${u} sending request:`,r),f.send(t,"POST",_,s,15)}))}T_(e,t,s){const r=Up(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=DE(),d=RE(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,s),h.encodeInitMessageHeaders=!0;const _=o.join("");ve(mn,`Creating RPC '${e}' stream ${r}: ${_}`,h);const b=u.createWebChannel(_,h);this.I_(b);let x=!1,C=!1;const M=new aO({Yo:V=>{C?ve(mn,`Not sending because RPC '${e}' stream ${r} is closed:`,V):(x||(ve(mn,`Opening RPC '${e}' stream ${r} transport.`),b.open(),x=!0),ve(mn,`RPC '${e}' stream ${r} sending:`,V),b.send(V))},Zo:()=>b.close()}),k=(V,$,U)=>{V.listen($,(B=>{try{U(B)}catch(K){setTimeout((()=>{throw K}),0)}}))};return k(b,yu.EventType.OPEN,(()=>{C||(ve(mn,`RPC '${e}' stream ${r} transport opened.`),M.o_())})),k(b,yu.EventType.CLOSE,(()=>{C||(C=!0,ve(mn,`RPC '${e}' stream ${r} transport closed`),M.a_(),this.E_(b))})),k(b,yu.EventType.ERROR,(V=>{C||(C=!0,Ia(mn,`RPC '${e}' stream ${r} transport errored. Name:`,V.name,"Message:",V.message),M.a_(new Ee(de.UNAVAILABLE,"The operation could not be completed")))})),k(b,yu.EventType.MESSAGE,(V=>{var $;if(!C){const U=V.data[0];ot(!!U,16349);const B=U,K=(B==null?void 0:B.error)||(($=B[0])==null?void 0:$.error);if(K){ve(mn,`RPC '${e}' stream ${r} received error:`,K);const se=K.status;let H=(function(D){const w=zt[D];if(w!==void 0)return fS(w)})(se),R=K.message;H===void 0&&(H=de.INTERNAL,R="Unknown error status: "+se+" with message "+K.message),C=!0,M.a_(new Ee(H,R)),b.close()}else ve(mn,`RPC '${e}' stream ${r} received:`,U),M.u_(U)}})),k(d,NE.STAT_EVENT,(V=>{V.stat===Cp.PROXY?ve(mn,`RPC '${e}' stream ${r} detected buffering proxy`):V.stat===Cp.NOPROXY&&ve(mn,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{M.__()}),0),M}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function tp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(n){return new dV(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,t,s=1e3,r=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&ve("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb="PersistentStream";class wS{constructor(e,t,s,r,o,u,d,h){this.Mi=e,this.S_=s,this.b_=r,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new CS(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(Li(t.toString()),Li("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===t&&this.G_(s,r)}),(s=>{e((()=>{const r=new Ee(de.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ve(Kb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ve(Kb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lO extends wS{constructor(e,t,s,r,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,u),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=mV(this.serializer,e),s=(function(o){if(!("targetChange"in o))return Ve.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?Ve.min():u.readTime?Js(u.readTime):Ve.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Vp(this.serializer),t.addTarget=(function(o,u){let d;const h=u.target;if(d=Dp(h)?{documents:yV(o,h)}:{query:vV(o,h).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=pS(o,u.resumeToken);const f=Pp(o,u.expectedCount);f!==null&&(d.expectedCount=f)}else if(u.snapshotVersion.compareTo(Ve.min())>0){d.readTime=sf(o,u.snapshotVersion.toTimestamp());const f=Pp(o,u.expectedCount);f!==null&&(d.expectedCount=f)}return d})(this.serializer,e);const s=TV(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Vp(this.serializer),t.removeTarget=e,this.q_(t)}}class uO extends wS{constructor(e,t,s,r,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,u),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=gV(e.writeResults,e.commitTime),s=Js(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Vp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>pV(this.serializer,s)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{}class dO extends cO{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ee(de.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Go(e,kp(t,s),r,o,u))).catch((o=>{throw o.name==="FirebaseError"?(o.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ee(de.UNKNOWN,o.toString())}))}Ho(e,t,s,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Ho(e,kp(t,s),r,u,d,o))).catch((u=>{throw u.name==="FirebaseError"?(u.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ee(de.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class fO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Li(t),this.aa=!1):ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="RemoteStore";class hO{constructor(e,t,s,r,o){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((u=>{s.enqueueAndForget((async()=>{La(this)&&(ve(Na,"Restarting streams for network reachability change."),await(async function(h){const f=Ue(h);f.Ea.add(4),await Gu(f),f.Ra.set("Unknown"),f.Ea.delete(4),await Pf(f)})(this))}))})),this.Ra=new fO(s,r)}}async function Pf(n){if(La(n))for(const e of n.da)await e(!0)}async function Gu(n){for(const e of n.da)await e(!1)}function IS(n,e){const t=Ue(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ag(t)?Sg(t):ll(t).O_()&&Eg(t,e))}function xg(n,e){const t=Ue(n),s=ll(t);t.Ia.delete(e),s.O_()&&NS(t,e),t.Ia.size===0&&(s.O_()?s.L_():La(t)&&t.Ra.set("Unknown"))}function Eg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ll(n).Y_(e)}function NS(n,e){n.Va.Ue(e),ll(n).Z_(e)}function Sg(n){n.Va=new oV({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ll(n).start(),n.Ra.ua()}function Ag(n){return La(n)&&!ll(n).x_()&&n.Ia.size>0}function La(n){return Ue(n).Ea.size===0}function RS(n){n.Va=void 0}async function mO(n){n.Ra.set("Online")}async function pO(n){n.Ia.forEach(((e,t)=>{Eg(n,e)}))}async function gO(n,e){RS(n),Ag(n)?(n.Ra.ha(e),Sg(n)):n.Ra.set("Unknown")}async function yO(n,e,t){if(n.Ra.set("Online"),e instanceof mS&&e.state===2&&e.cause)try{await(async function(r,o){const u=o.cause;for(const d of o.targetIds)r.Ia.has(d)&&(await r.remoteSyncer.rejectListen(d,u),r.Ia.delete(d),r.Va.removeTarget(d))})(n,e)}catch(s){ve(Na,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await af(n,s)}else if(e instanceof Od?n.Va.Ze(e):e instanceof hS?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ve.min()))try{const s=await AS(n.localStore);t.compareTo(s)>=0&&await(function(o,u){const d=o.Va.Tt(u);return d.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const _=o.Ia.get(f);_&&o.Ia.set(f,_.withResumeToken(h.resumeToken,u))}})),d.targetMismatches.forEach(((h,f)=>{const _=o.Ia.get(h);if(!_)return;o.Ia.set(h,_.withResumeToken(sn.EMPTY_BYTE_STRING,_.snapshotVersion)),NS(o,h);const b=new Ar(_.target,h,f,_.sequenceNumber);Eg(o,b)})),o.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(s){ve(Na,"Failed to raise snapshot:",s),await af(n,s)}}async function af(n,e,t){if(!ol(e))throw e;n.Ea.add(1),await Gu(n),n.Ra.set("Offline"),t||(t=()=>AS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ve(Na,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Pf(n)}))}function DS(n,e){return e().catch((t=>af(n,t,e)))}async function kf(n){const e=Ue(n),t=Lr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:og;for(;vO(e);)try{const r=await ZV(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,_O(e,r)}catch(r){await af(e,r)}MS(e)&&PS(e)}function vO(n){return La(n)&&n.Ta.length<10}function _O(n,e){n.Ta.push(e);const t=Lr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function MS(n){return La(n)&&!Lr(n).x_()&&n.Ta.length>0}function PS(n){Lr(n).start()}async function TO(n){Lr(n).ra()}async function bO(n){const e=Lr(n);for(const t of n.Ta)e.ea(t.mutations)}async function xO(n,e,t){const s=n.Ta.shift(),r=pg.from(s,e,t);await DS(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await kf(n)}async function EO(n,e){e&&Lr(n).X_&&await(async function(s,r){if((function(u){return iV(u)&&u!==de.ABORTED})(r.code)){const o=s.Ta.shift();Lr(s).B_(),await DS(s,(()=>s.remoteSyncer.rejectFailedWrite(o.batchId,r))),await kf(s)}})(n,e),MS(n)&&PS(n)}async function Yb(n,e){const t=Ue(n);t.asyncQueue.verifyOperationInProgress(),ve(Na,"RemoteStore received new credentials");const s=La(t);t.Ea.add(3),await Gu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Pf(t)}async function SO(n,e){const t=Ue(n);e?(t.Ea.delete(2),await Pf(t)):e||(t.Ea.add(2),await Gu(t),t.Ra.set("Unknown"))}function ll(n){return n.ma||(n.ma=(function(t,s,r){const o=Ue(t);return o.sa(),new lO(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Xo:mO.bind(null,n),t_:pO.bind(null,n),r_:gO.bind(null,n),H_:yO.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Ag(n)?Sg(n):n.Ra.set("Unknown")):(await n.ma.stop(),RS(n))}))),n.ma}function Lr(n){return n.fa||(n.fa=(function(t,s,r){const o=Ue(t);return o.sa(),new uO(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:TO.bind(null,n),r_:EO.bind(null,n),ta:bO.bind(null,n),na:xO.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await kf(n)):(await n.fa.stop(),n.Ta.length>0&&(ve(Na,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e,t,s,r,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=o,this.deferred=new Di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,o){const u=Date.now()+s,d=new Cg(e,t,u,r,o);return d.start(s),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wg(n,e){if(Li("AsyncQueue",`${e}: ${n}`),ol(n))return new Ee(de.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{static emptySet(e){return new Bo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ie.comparator(t.key,s.key):(t,s)=>Ie.comparator(t.key,s.key),this.keyedMap=vu(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,o=s.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Bo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(){this.ga=new At(Ie.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Xo{constructor(e,t,s,r,o,u,d,h,f){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,s,r,o){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new Xo(e,t,Bo.emptySet(t),u,s,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class CO{constructor(){this.queries=Qb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=Ue(t),o=r.queries;r.queries=Qb(),o.forEach(((u,d)=>{for(const h of d.Sa)h.onError(s)}))})(this,new Ee(de.ABORTED,"Firestore shutting down"))}}function Qb(){return new Pa((n=>eS(n)),wf)}async function kS(n,e){const t=Ue(n);let s=3;const r=e.query;let o=t.queries.get(r);o?!o.ba()&&e.Da()&&(s=2):(o=new AO,s=e.Da()?0:1);try{switch(s){case 0:o.wa=await t.onListen(r,!0);break;case 1:o.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(u){const d=wg(u,`Initialization of query '${Do(e.query)}' failed`);return void e.onError(d)}t.queries.set(r,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&Ig(t)}async function LS(n,e){const t=Ue(n),s=e.query;let r=3;const o=t.queries.get(s);if(o){const u=o.Sa.indexOf(e);u>=0&&(o.Sa.splice(u,1),o.Sa.length===0?r=e.Da()?0:1:!o.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function wO(n,e){const t=Ue(n);let s=!1;for(const r of e){const o=r.query,u=t.queries.get(o);if(u){for(const d of u.Sa)d.Fa(r)&&(s=!0);u.wa=r}}s&&Ig(t)}function IO(n,e,t){const s=Ue(n),r=s.queries.get(e);if(r)for(const o of r.Sa)o.onError(t);s.queries.delete(e)}function Ig(n){n.Ca.forEach((e=>{e.next()}))}var Fp,Xb;(Xb=Fp||(Fp={})).Ma="default",Xb.Cache="cache";class VS{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Xo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.key=e}}class US{constructor(e){this.key=e}}class NO{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=tS(e),this.tu=new Bo(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new Jb,r=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,u=r,d=!1;const h=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,f=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((_,b)=>{const x=r.get(_),C=If(this.query,b)?b:null,M=!!x&&this.mutatedKeys.has(x.key),k=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let V=!1;x&&C?x.data.isEqual(C.data)?M!==k&&(s.track({type:3,doc:C}),V=!0):this.su(x,C)||(s.track({type:2,doc:C}),V=!0,(h&&this.eu(C,h)>0||f&&this.eu(C,f)<0)&&(d=!0)):!x&&C?(s.track({type:0,doc:C}),V=!0):x&&!C&&(s.track({type:1,doc:x}),V=!0,(h||f)&&(d=!0)),V&&(C?(u=u.add(C),o=k?o.add(_):o.delete(_)):(u=u.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),o=o.delete(_.key),s.track({type:1,doc:_})}return{tu:u,iu:s,Cs:d,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,b)=>(function(C,M){const k=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:V})}};return k(C)-k(M)})(_.type,b.type)||this.eu(_.doc,b.doc))),this.ou(s),r=r??!1;const d=t&&!r?this._u():[],h=this.Xa.size===0&&this.current&&!r?1:0,f=h!==this.Za;return this.Za=h,u.length!==0||f?{snapshot:new Xo(this.query,e.tu,o,u,e.mutatedKeys,h===0,f,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new US(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new OS(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Xe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ng="SyncEngine";class RO{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class DO{constructor(e){this.key=e,this.hu=!1}}class MO{constructor(e,t,s,r,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Pa((d=>eS(d)),wf),this.Iu=new Map,this.Eu=new Set,this.du=new At(Ie.comparator),this.Au=new Map,this.Ru=new vg,this.Vu={},this.mu=new Map,this.fu=Qo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function PO(n,e,t=!0){const s=zS(n);let r;const o=s.Tu.get(e);return o?(s.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await FS(s,e,t,!0),r}async function kO(n,e){const t=zS(n);await FS(t,e,!0,!1)}async function FS(n,e,t,s){const r=await eO(n.localStore,Ks(e)),o=r.targetId,u=n.sharedClientState.addLocalQueryTarget(o,t);let d;return s&&(d=await LO(n,e,o,u==="current",r.resumeToken)),n.isPrimaryClient&&t&&IS(n.remoteStore,r),d}async function LO(n,e,t,s,r){n.pu=(b,x,C)=>(async function(k,V,$,U){let B=V.view.ru($);B.Cs&&(B=await Hb(k.localStore,V.query,!1).then((({documents:R})=>V.view.ru(R,B))));const K=U&&U.targetChanges.get(V.targetId),se=U&&U.targetMismatches.get(V.targetId)!=null,H=V.view.applyChanges(B,k.isPrimaryClient,K,se);return Zb(k,V.targetId,H.au),H.snapshot})(n,b,x,C);const o=await Hb(n.localStore,e,!0),u=new NO(e,o.Qs),d=u.ru(o.documents),h=zu.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),f=u.applyChanges(d,n.isPrimaryClient,h);Zb(n,t,f.au);const _=new RO(e,t,u);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),f.snapshot}async function VO(n,e,t){const s=Ue(n),r=s.Tu.get(e),o=s.Iu.get(r.targetId);if(o.length>1)return s.Iu.set(r.targetId,o.filter((u=>!wf(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Op(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),t&&xg(s.remoteStore,r.targetId),Bp(s,r.targetId)})).catch(al)):(Bp(s,r.targetId),await Op(s.localStore,r.targetId,!0))}async function OO(n,e){const t=Ue(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),xg(t.remoteStore,s.targetId))}async function UO(n,e,t){const s=GO(n);try{const r=await(function(u,d){const h=Ue(u),f=yt.now(),_=d.reduce(((C,M)=>C.add(M.key)),Xe());let b,x;return h.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let M=Oi(),k=Xe();return h.Ns.getEntries(C,_).next((V=>{M=V,M.forEach((($,U)=>{U.isValidDocument()||(k=k.add($))}))})).next((()=>h.localDocuments.getOverlayedDocuments(C,M))).next((V=>{b=V;const $=[];for(const U of d){const B=ZL(U,b.get(U.key).overlayedDocument);B!=null&&$.push(new ka(U.key,B,KE(B.value.mapValue),Ys.exists(!0)))}return h.mutationQueue.addMutationBatch(C,f,$,d)})).next((V=>{x=V;const $=V.applyToLocalDocumentSet(b,k);return h.documentOverlayCache.saveOverlays(C,V.batchId,$)}))})).then((()=>({batchId:x.batchId,changes:sS(b)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(u,d,h){let f=u.Vu[u.currentUser.toKey()];f||(f=new At(Qe)),f=f.insert(d,h),u.Vu[u.currentUser.toKey()]=f})(s,r.batchId,t),await $u(s,r.changes),await kf(s.remoteStore)}catch(r){const o=wg(r,"Failed to persist write");t.reject(o)}}async function BS(n,e){const t=Ue(n);try{const s=await XV(t.localStore,e);e.targetChanges.forEach(((r,o)=>{const u=t.Au.get(o);u&&(ot(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?u.hu=!0:r.modifiedDocuments.size>0?ot(u.hu,14607):r.removedDocuments.size>0&&(ot(u.hu,42227),u.hu=!1))})),await $u(t,s,e)}catch(s){await al(s)}}function Wb(n,e,t){const s=Ue(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach(((o,u)=>{const d=u.view.va(e);d.snapshot&&r.push(d.snapshot)})),(function(u,d){const h=Ue(u);h.onlineState=d;let f=!1;h.queries.forEach(((_,b)=>{for(const x of b.Sa)x.va(d)&&(f=!0)})),f&&Ig(h)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function FO(n,e,t){const s=Ue(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),o=r&&r.key;if(o){let u=new At(Ie.comparator);u=u.insert(o,yn.newNoDocument(o,Ve.min()));const d=Xe().add(o),h=new Df(Ve.min(),new Map,new At(Qe),u,d);await BS(s,h),s.du=s.du.remove(o),s.Au.delete(e),Rg(s)}else await Op(s.localStore,e,!1).then((()=>Bp(s,e,t))).catch(al)}async function BO(n,e){const t=Ue(n),s=e.batch.batchId;try{const r=await QV(t.localStore,e);qS(t,s,null),jS(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await $u(t,r)}catch(r){await al(r)}}async function jO(n,e,t){const s=Ue(n);try{const r=await(function(u,d){const h=Ue(u);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let _;return h.mutationQueue.lookupMutationBatch(f,d).next((b=>(ot(b!==null,37113),_=b.keys(),h.mutationQueue.removeMutationBatch(f,b)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,_,d))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,_))).next((()=>h.localDocuments.getDocuments(f,_)))}))})(s.localStore,e);qS(s,e,t),jS(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await $u(s,r)}catch(r){await al(r)}}function jS(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function qS(n,e,t){const s=Ue(n);let r=s.Vu[s.currentUser.toKey()];if(r){const o=r.get(e);o&&(t?o.reject(t):o.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Bp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||HS(n,s)}))}function HS(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(xg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Rg(n))}function Zb(n,e,t){for(const s of t)s instanceof OS?(n.Ru.addReference(s.key,e),qO(n,s)):s instanceof US?(ve(Ng,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||HS(n,s.key)):Me(19791,{wu:s})}function qO(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(ve(Ng,"New document in limbo: "+t),n.Eu.add(s),Rg(n))}function Rg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ie(xt.fromString(e)),s=n.fu.next();n.Au.set(s,new DO(t)),n.du=n.du.insert(t,s),IS(n.remoteStore,new Ar(Ks(fg(t.path)),s,"TargetPurposeLimboResolution",Ef.ce))}}async function $u(n,e,t){const s=Ue(n),r=[],o=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((d,h)=>{u.push(s.pu(h,e,t).then((f=>{var _;if((f||t)&&s.isPrimaryClient){const b=f?!f.fromCache:(_=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:_.current;s.sharedClientState.updateQueryState(h.targetId,b?"current":"not-current")}if(f){r.push(f);const b=Tg.As(h.targetId,f);o.push(b)}})))})),await Promise.all(u),s.Pu.H_(r),await(async function(h,f){const _=Ue(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>le.forEach(f,(x=>le.forEach(x.Es,(C=>_.persistence.referenceDelegate.addReference(b,x.targetId,C))).next((()=>le.forEach(x.ds,(C=>_.persistence.referenceDelegate.removeReference(b,x.targetId,C)))))))))}catch(b){if(!ol(b))throw b;ve(bg,"Failed to update sequence numbers: "+b)}for(const b of f){const x=b.targetId;if(!b.fromCache){const C=_.Ms.get(x),M=C.snapshotVersion,k=C.withLastLimboFreeSnapshotVersion(M);_.Ms=_.Ms.insert(x,k)}}})(s.localStore,o))}async function HO(n,e){const t=Ue(n);if(!t.currentUser.isEqual(e)){ve(Ng,"User change. New user:",e.toKey());const s=await SS(t.localStore,e);t.currentUser=e,(function(o,u){o.mu.forEach((d=>{d.forEach((h=>{h.reject(new Ee(de.CANCELLED,u))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await $u(t,s.Ls)}}function zO(n,e){const t=Ue(n),s=t.Au.get(e);if(s&&s.hu)return Xe().add(s.key);{let r=Xe();const o=t.Iu.get(e);if(!o)return r;for(const u of o){const d=t.Tu.get(u);r=r.unionWith(d.view.nu)}return r}}function zS(n){const e=Ue(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=BS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FO.bind(null,e),e.Pu.H_=wO.bind(null,e.eventManager),e.Pu.yu=IO.bind(null,e.eventManager),e}function GO(n){const e=Ue(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jO.bind(null,e),e}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Mf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return JV(this.persistence,new $V,e.initialUser,this.serializer)}Cu(e){return new ES(_g.mi,this.serializer)}Du(e){return new nO}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class $O extends of{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ot(this.persistence.referenceDelegate instanceof rf,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new DV(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Mn.withCacheSize(this.cacheSizeBytes):Mn.DEFAULT;return new ES((s=>rf.mi(s,t)),this.serializer)}}class jp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Wb(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=HO.bind(null,this.syncEngine),await SO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new CO})()}createDatastore(e){const t=Mf(e.databaseInfo.databaseId),s=(function(o){return new oO(o)})(e.databaseInfo);return(function(o,u,d,h){return new dO(o,u,d,h)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,r,o,u,d){return new hO(s,r,o,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>Wb(this.syncEngine,t,0)),(function(){return $b.v()?new $b:new sO})())}createSyncEngine(e,t){return(function(r,o,u,d,h,f,_){const b=new MO(r,o,u,d,h,f);return _&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const o=Ue(r);ve(Na,"RemoteStore shutting down."),o.Ea.add(5),await Gu(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}jp.provider={build:()=>new jp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Li("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="FirestoreClient";class KO{constructor(e,t,s,r,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=pn.UNAUTHENTICATED,this.clientId=xf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(s,(async u=>{ve(Vr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(ve(Vr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=wg(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function np(n,e){n.asyncQueue.verifyOperationInProgress(),ve(Vr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async r=>{s.isEqual(r)||(await SS(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ex(n,e){n.asyncQueue.verifyOperationInProgress();const t=await YO(n);ve(Vr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Yb(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,r)=>Yb(e.remoteStore,r))),n._onlineComponents=e}async function YO(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(Vr,"Using user provided OfflineComponentProvider");try{await np(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===de.FAILED_PRECONDITION||r.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Ia("Error using user provided cache. Falling back to memory cache: "+t),await np(n,new of)}}else ve(Vr,"Using default OfflineComponentProvider"),await np(n,new $O(void 0));return n._offlineComponents}async function $S(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(Vr,"Using user provided OnlineComponentProvider"),await ex(n,n._uninitializedComponentsProvider._online)):(ve(Vr,"Using default OnlineComponentProvider"),await ex(n,new jp))),n._onlineComponents}function JO(n){return $S(n).then((e=>e.syncEngine))}async function KS(n){const e=await $S(n),t=e.eventManager;return t.onListen=PO.bind(null,e.syncEngine),t.onUnlisten=VO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=kO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=OO.bind(null,e.syncEngine),t}function QO(n,e,t={}){const s=new Di;return n.asyncQueue.enqueueAndForget((async()=>(function(o,u,d,h,f){const _=new GS({next:x=>{_.Nu(),u.enqueueAndForget((()=>LS(o,b)));const C=x.docs.has(d);!C&&x.fromCache?f.reject(new Ee(de.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&x.fromCache&&h&&h.source==="server"?f.reject(new Ee(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(x)},error:x=>f.reject(x)}),b=new VS(fg(d.path),_,{includeMetadataChanges:!0,qa:!0});return kS(o,b)})(await KS(n),n.asyncQueue,e,t,s))),s.promise}function XO(n,e,t={}){const s=new Di;return n.asyncQueue.enqueueAndForget((async()=>(function(o,u,d,h,f){const _=new GS({next:x=>{_.Nu(),u.enqueueAndForget((()=>LS(o,b))),x.fromCache&&h.source==="server"?f.reject(new Ee(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(x)},error:x=>f.reject(x)}),b=new VS(d,_,{includeMetadataChanges:!0,qa:!0});return kS(o,b)})(await KS(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="firestore.googleapis.com",nx=!0;class sx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JS,this.ssl=nx}else this.host=e.host,this.ssl=e.ssl??nx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NV)throw new Ee(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YS(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ee(de.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ee(de.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ee(de.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Lf{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new kE;switch(s.type){case"firstParty":return new oL(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ee(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=tx.get(t);s&&(ve("ComponentProvider","Removing Datastore"),tx.delete(t),s.terminate())})(this),Promise.resolve()}}function QS(n,e,t,s={}){var f;n=Vi(n,Lf);const r=sl(e),o=n._getSettings(),u={...o,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;r&&(vE(`https://${d}`),_E("Firestore",!0)),o.host!==JS&&o.host!==d&&Ia("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:d,ssl:r,emulatorOptions:s};if(!Aa(h,u)&&(n._setSettings(h),s.mockUserToken)){let _,b;if(typeof s.mockUserToken=="string")_=s.mockUserToken,b=pn.MOCK_USER;else{_=N2(s.mockUserToken,(f=n._app)==null?void 0:f.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new Ee(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new pn(x)}n._authCredentials=new iL(new PE(_,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Ku(this.firestore,e,this._query)}}class $t{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $t(this.firestore,e,this._key)}toJSON(){return{type:$t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(qu(t,$t._jsonSchema))return new $t(e,s||null,new Ie(xt.fromString(t.referencePath)))}}$t._jsonSchemaVersion="firestore/documentReference/1.0",$t._jsonSchema={type:Gt("string",$t._jsonSchemaVersion),referencePath:Gt("string")};class Mi extends Ku{constructor(e,t,s){super(e,t,fg(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $t(this.firestore,null,new Ie(e))}withConverter(e){return new Mi(this.firestore,e,this._path)}}function WO(n,e,...t){if(n=En(n),LE("collection","path",e),n instanceof Lf){const s=xt.fromString(e,...t);return yb(s),new Mi(n,null,s)}{if(!(n instanceof $t||n instanceof Mi))throw new Ee(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(xt.fromString(e,...t));return yb(s),new Mi(n.firestore,null,s)}}function ZO(n,e,...t){if(n=En(n),arguments.length===1&&(e=xf.newId()),LE("doc","path",e),n instanceof Lf){const s=xt.fromString(e,...t);return gb(s),new $t(n,null,new Ie(s))}{if(!(n instanceof $t||n instanceof Mi))throw new Ee(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(xt.fromString(e,...t));return gb(s),new $t(n.firestore,n instanceof Mi?n.converter:null,new Ie(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="AsyncQueue";class rx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new CS(this,"async_queue_retry"),this._c=()=>{const s=tp();s&&ve(ix,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=tp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Di;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ol(e))throw e;ve(ix,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Li("INTERNAL UNHANDLED ERROR: ",ax(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Cg.createAndSchedule(this,e,t,s,(o=>this.hc(o)));return this.tc.push(r),r}uc(){this.nc&&Me(47125,{Pc:ax(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ax(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ul extends Lf{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new rx,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rx(e),this._firestoreClient=void 0,await e}}}function XS(n,e){const t=typeof n=="object"?n:EE(),s=typeof n=="string"?n:Xd,r=ig(t,"firestore").getImmediate({identifier:s});if(!r._initialized){const o=w2("firestore");o&&QS(r,...o)}return r}function Vf(n){if(n._terminated)throw new Ee(de.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||eU(n),n._firestoreClient}function eU(n){var s,r,o;const e=n._freezeSettings(),t=(function(d,h,f,_){return new EL(d,h,f,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,YS(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((s=n._app)==null?void 0:s.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new KO(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hn(sn.fromBase64String(e))}catch(t){throw new Ee(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Hn(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Hn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qu(e,Hn._jsonSchema))return Hn.fromBase64String(e.bytes)}}Hn._jsonSchemaVersion="firestore/bytes/1.0",Hn._jsonSchema={type:Gt("string",Hn._jsonSchemaVersion),bytes:Gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Qe(this._lat,e._lat)||Qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xs._jsonSchemaVersion}}static fromJSON(e){if(qu(e,xs._jsonSchema))return new xs(e.latitude,e.longitude)}}xs._jsonSchemaVersion="firestore/geoPoint/1.0",xs._jsonSchema={type:Gt("string",xs._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let o=0;o<s.length;++o)if(s[o]!==r[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Es._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qu(e,Es._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Es(e.vectorValues);throw new Ee(de.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Es._jsonSchemaVersion="firestore/vectorValue/1.0",Es._jsonSchema={type:Gt("string",Es._jsonSchemaVersion),vectorValues:Gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU=/^__.*__$/;class nU{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ka(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hu(e,this.data,t,this.fieldTransforms)}}function WS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:n})}}class Mg{constructor(e,t,s,r,o,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Mg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(WS(this.Ac)&&tU.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class sU{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Mf(e)}Cc(e,t,s,r=!1){return new Mg({Ac:e,methodName:t,Dc:s,path:nn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iU(n){const e=n._freezeSettings(),t=Mf(n._databaseId);return new sU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function rU(n,e,t,s,r,o={}){const u=n.Cc(o.merge||o.mergeFields?2:0,e,t,r);nA("Data must be an object, but it was:",u,s);const d=eA(s,u);let h,f;if(o.merge)h=new Ts(u.fieldMask),f=u.fieldTransforms;else if(o.mergeFields){const _=[];for(const b of o.mergeFields){const x=aU(e,b,t);if(!u.contains(x))throw new Ee(de.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);lU(_,x)||_.push(x)}h=new Ts(_),f=u.fieldTransforms.filter((b=>h.covers(b.field)))}else h=null,f=u.fieldTransforms;return new nU(new as(d),h,f)}function ZS(n,e){if(tA(n=En(n)))return nA("Unsupported field value:",e,n),eA(n,e);if(n instanceof Dg)return(function(s,r){if(!WS(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const o=s._toFieldTransform(r);o&&r.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const o=[];let u=0;for(const d of s){let h=ZS(d,r.wc(u));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),u++}return{arrayValue:{values:o}}})(n,e)}return(function(s,r){if((s=En(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return KL(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const o=yt.fromDate(s);return{timestampValue:sf(r.serializer,o)}}if(s instanceof yt){const o=new yt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:sf(r.serializer,o)}}if(s instanceof xs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Hn)return{bytesValue:pS(r.serializer,s._byteString)};if(s instanceof $t){const o=r.databaseId,u=s.firestore._databaseId;if(!u.isEqual(o))throw r.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:yg(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Es)return(function(u,d){return{mapValue:{fields:{[GE]:{stringValue:$E},[Wd]:{arrayValue:{values:u.toArray().map((f=>{if(typeof f!="number")throw d.Sc("VectorValues must only contain numeric values.");return hg(d.serializer,f)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${ag(s)}`)})(n,e)}function eA(n,e){const t={};return FE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ma(n,((s,r)=>{const o=ZS(r,e.mc(s));o!=null&&(t[s]=o)})),{mapValue:{fields:t}}}function tA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof yt||n instanceof xs||n instanceof Hn||n instanceof $t||n instanceof Dg||n instanceof Es)}function nA(n,e,t){if(!tA(t)||!OE(t)){const s=ag(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function aU(n,e,t){if((e=En(e))instanceof Of)return e._internalPath;if(typeof e=="string")return sA(n,e);throw lf("Field path arguments must be of type string or ",n,!1,void 0,t)}const oU=new RegExp("[~\\*/\\[\\]]");function sA(n,e,t){if(e.search(oU)>=0)throw lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Of(...e.split("."))._internalPath}catch{throw lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lf(n,e,t,s,r){const o=s&&!s.isEmpty(),u=r!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(o||u)&&(h+=" (found",o&&(h+=` in field ${s}`),u&&(h+=` in document ${r}`),h+=")"),new Ee(de.INVALID_ARGUMENT,d+n+h)}function lU(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e,t,s,r,o){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new $t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new uU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class uU extends iA{data(){return super.data()}}function rA(n,e){return typeof e=="string"?sA(n,e):e instanceof Of?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cU(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ee(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class aA{convertValue(e,t="none"){switch(kr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Pr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Ma(e,((r,o)=>{s[r]=this.convertValue(o,t)})),s}convertVectorValue(e){var s,r,o;const t=(o=(r=(s=e.fields)==null?void 0:s[Wd].arrayValue)==null?void 0:r.values)==null?void 0:o.map((u=>Vt(u.doubleValue)));return new Es(t)}convertGeoPoint(e){return new xs(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Af(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){const t=Mr(e);return new yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=xt.fromString(e);ot(bS(s),9688,{name:e});const r=new Ko(s.get(1),s.get(3)),o=new Ie(s.popFirst(5));return r.isEqual(t)||Li(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dU(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Lo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rr extends iA{constructor(e,t,s,r,o,u){super(e,t,s,r,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(rA("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(de.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Rr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Rr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Rr._jsonSchema={type:Gt("string",Rr._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class wu extends Rr{data(e={}){return super.data(e)}}class Ea{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Lo(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new wu(this._firestore,this._userDataWriter,s.key,s,new Lo(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,o){if(r._snapshot.oldDocs.isEmpty()){let u=0;return r._snapshot.docChanges.map((d=>{const h=new wu(r._firestore,r._userDataWriter,d.doc.key,d.doc,new Lo(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:u++}}))}{let u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((d=>o||d.type!==3)).map((d=>{const h=new wu(r._firestore,r._userDataWriter,d.doc.key,d.doc,new Lo(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,_=-1;return d.type!==0&&(f=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),_=u.indexOf(d.doc.key)),{type:fU(d.type),doc:h,oldIndex:f,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(de.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ea._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),s.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hU(n){n=Vi(n,$t);const e=Vi(n.firestore,ul);return QO(Vf(e),n._key).then((t=>yU(e,n,t)))}Ea._jsonSchemaVersion="firestore/querySnapshot/1.0",Ea._jsonSchema={type:Gt("string",Ea._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class oA extends aA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $t(this.firestore,null,t)}}function mU(n){n=Vi(n,Ku);const e=Vi(n.firestore,ul),t=Vf(e),s=new oA(e);return cU(n._query),XO(t,n._query).then((r=>new Ea(e,s,n,r)))}function pU(n,e,t){n=Vi(n,$t);const s=Vi(n.firestore,ul),r=dU(n.converter,e,t);return Pg(s,[rU(iU(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Ys.none())])}function gU(n){return Pg(Vi(n.firestore,ul),[new mg(n._key,Ys.none())])}function Pg(n,e){return(function(s,r){const o=new Di;return s.asyncQueue.enqueueAndForget((async()=>UO(await JO(s),r,o))),o.promise})(Vf(n),e)}function yU(n,e,t){const s=t.docs.get(e._key),r=new oA(n);return new Rr(n,r,e._key,s,new Lo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){rl=r})(il),Go(new Ca("firestore",((s,{instanceIdentifier:r,options:o})=>{const u=s.getProvider("app").getImmediate(),d=new ul(new rL(s.getProvider("auth-internal")),new lL(u,s.getProvider("app-check-internal")),(function(f,_){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Ee(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ko(f.options.projectId,_)})(u,r),u);return o={useFetchStreams:t,...o},d._setSettings(o),d}),"PUBLIC").setMultipleInstances(!0)),Ir(fb,hb,e),Ir(fb,hb,"esm2020")})();const Id=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:aA,Bytes:Hn,CollectionReference:Mi,DocumentReference:$t,DocumentSnapshot:Rr,FieldPath:Of,FieldValue:Dg,Firestore:ul,FirestoreError:Ee,GeoPoint:xs,Query:Ku,QueryDocumentSnapshot:wu,QuerySnapshot:Ea,SnapshotMetadata:Lo,Timestamp:yt,VectorValue:Es,_AutoId:xf,_ByteString:sn,_DatabaseId:Ko,_DocumentKey:Ie,_EmptyAuthCredentialsProvider:kE,_FieldPath:nn,_cast:Vi,_logWarn:Ia,_validateIsNotUsedTogether:VE,collection:WO,connectFirestoreEmulator:QS,deleteDoc:gU,doc:ZO,ensureFirestoreConfigured:Vf,executeWrite:Pg,getDoc:hU,getDocs:mU,getFirestore:XS,setDoc:pU},Symbol.toStringTag,{value:"Module"}));function lA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uA=lA,cA=new Bu("auth","Firebase",lA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf=new ng("@firebase/auth");function vU(n,...e){uf.logLevel<=Je.WARN&&uf.warn(`Auth (${il}): ${n}`,...e)}function Ud(n,...e){uf.logLevel<=Je.ERROR&&uf.error(`Auth (${il}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(n,...e){throw kg(n,...e)}function Qs(n,...e){return kg(n,...e)}function dA(n,e,t){const s={...uA(),[e]:t};return new Bu("auth","Firebase",s).create(e,{appName:n.name})}function Pi(n){return dA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kg(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return cA.create(n,...e)}function De(n,e,...t){if(!n)throw kg(e,...t)}function Ni(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ud(e),new Error(e)}function Ui(n,e){n||Ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function _U(){return ox()==="http:"||ox()==="https:"}function ox(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_U()||L2()||"connection"in navigator)?navigator.onLine:!0}function bU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ui(t>e,"Short delay should be less than long delay!"),this.isMobile=M2()||V2()}get(){return TU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(n,e){Ui(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],SU=new Yu(3e4,6e4);function Fr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ji(n,e,t,s,r={}){return hA(n,r,async()=>{let o={},u={};s&&(e==="GET"?u=s:o={body:JSON.stringify(s)});const d=ju({key:n.config.apiKey,...u}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const f={method:e,headers:h,...o};return k2()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&sl(n.emulatorConfig.host)&&(f.credentials="include"),fA.fetch()(await mA(n,n.config.apiHost,t,d),f)})}async function hA(n,e,t){n._canInitEmulator=!1;const s={...xU,...e};try{const r=new CU(n),o=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const u=await o.json();if("needConfirmation"in u)throw Nd(n,"account-exists-with-different-credential",u);if(o.ok&&!("errorMessage"in u))return u;{const d=o.ok?u.errorMessage:u.error.message,[h,f]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nd(n,"credential-already-in-use",u);if(h==="EMAIL_EXISTS")throw Nd(n,"email-already-in-use",u);if(h==="USER_DISABLED")throw Nd(n,"user-disabled",u);const _=s[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw dA(n,_,f);Ss(n,_)}}catch(r){if(r instanceof Bi)throw r;Ss(n,"network-request-failed",{message:String(r)})}}async function Ju(n,e,t,s,r={}){const o=await ji(n,e,t,s,r);return"mfaPendingCredential"in o&&Ss(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function mA(n,e,t,s){const r=`${e}${t}?${s}`,o=n,u=o.config.emulator?Lg(n.config,r):`${n.config.apiScheme}://${r}`;return EU.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(u).toString():u}function AU(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class CU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Qs(this.auth,"network-request-failed")),SU.get())})}}function Nd(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=Qs(n,e,s);return r.customData._tokenResponse=t,r}function lx(n){return n!==void 0&&n.enterprise!==void 0}class wU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return AU(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function IU(n,e){return ji(n,"GET","/v2/recaptchaConfig",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NU(n,e){return ji(n,"POST","/v1/accounts:delete",e)}async function cf(n,e){return ji(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pA(n,e=!1){const t=En(n),s=await t.getIdToken(e),r=Vg(s);De(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,u=o==null?void 0:o.sign_in_provider;return{claims:r,token:s,authTime:Iu(sp(r.auth_time)),issuedAtTime:Iu(sp(r.iat)),expirationTime:Iu(sp(r.exp)),signInProvider:u||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function sp(n){return Number(n)*1e3}function Vg(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Ud("JWT malformed, contained fewer than 3 sections"),null;try{const r=mE(t);return r?JSON.parse(r):(Ud("Failed to decode base64 JWT payload"),null)}catch(r){return Ud("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function ux(n){const e=Vg(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Bi&&RU(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function RU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Iu(this.lastLoginAt),this.creationTime=Iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(n){var b;const e=n.auth,t=await n.getIdToken(),s=await Wo(n,cf(e,{idToken:t}));De(s==null?void 0:s.users.length,e,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const o=(b=r.providerUserInfo)!=null&&b.length?yA(r.providerUserInfo):[],u=MU(n.providerData,o),d=n.isAnonymous,h=!(n.email&&r.passwordHash)&&!(u!=null&&u.length),f=d?h:!1,_={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:u,metadata:new Hp(r.createdAt,r.lastLoginAt),isAnonymous:f};Object.assign(n,_)}async function gA(n){const e=En(n);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MU(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function yA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PU(n,e){const t=await hA(n,{},async()=>{const s=ju({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=n.config,u=await mA(n,r,"/v1/token",`key=${o}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:s};return n.emulatorConfig&&sl(n.emulatorConfig.host)&&(h.credentials="include"),fA.fetch()(u,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kU(n,e){return ji(n,"POST","/v2/accounts:revokeToken",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ux(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=ux(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:o}=await PU(e,t);this.updateTokensAndExpiration(s,r,Number(o))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:o}=t,u=new jo;return s&&(De(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),r&&(De(typeof r=="string","internal-error",{appName:e}),u.accessToken=r),o&&(De(typeof o=="number","internal-error",{appName:e}),u.expirationTime=o),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jo,this.toJSON())}_performRefresh(){return Ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor({uid:e,auth:t,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new DU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Hp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Wo(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return pA(this,e)}reload(){return gA(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await df(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rs(this.auth.app))return Promise.reject(Pi(this.auth));const e=await this.getIdToken();return await Wo(this,NU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,r=t.email??void 0,o=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:b,emailVerified:x,isAnonymous:C,providerData:M,stsTokenManager:k}=t;De(b&&k,e,"internal-error");const V=jo.fromJSON(this.name,k);De(typeof b=="string",e,"internal-error"),Er(s,e.name),Er(r,e.name),De(typeof x=="boolean",e,"internal-error"),De(typeof C=="boolean",e,"internal-error"),Er(o,e.name),Er(u,e.name),Er(d,e.name),Er(h,e.name),Er(f,e.name),Er(_,e.name);const $=new bs({uid:b,auth:e,email:r,emailVerified:x,displayName:s,isAnonymous:C,photoURL:u,phoneNumber:o,tenantId:d,stsTokenManager:V,createdAt:f,lastLoginAt:_});return M&&Array.isArray(M)&&($.providerData=M.map(U=>({...U}))),h&&($._redirectEventId=h),$}static async _fromIdTokenResponse(e,t,s=!1){const r=new jo;r.updateFromServerResponse(t);const o=new bs({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await df(o),o}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];De(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?yA(r.providerUserInfo):[],u=!(r.email&&r.passwordHash)&&!(o!=null&&o.length),d=new jo;d.updateFromIdToken(s);const h=new bs({uid:r.localId,auth:e,stsTokenManager:d,isAnonymous:u}),f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Hp(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx=new Map;function Ri(n){Ui(n instanceof Function,"Expected a class definition");let e=cx.get(n);return e?(Ui(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,cx.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vA.type="NONE";const zp=vA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(n,e,t){return`firebase:${n}:${e}:${t}`}class qo{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:o}=this.auth;this.fullUserKey=Fd(this.userKey,r.apiKey,o),this.fullPersistenceKey=Fd("persistence",r.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await cf(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new qo(Ri(zp),e,s);const r=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=r[0]||Ri(zp);const u=Fd(s,e.config.apiKey,e.name);let d=null;for(const f of t)try{const _=await f._get(u);if(_){let b;if(typeof _=="string"){const x=await cf(e,{idToken:_}).catch(()=>{});if(!x)break;b=await bs._fromGetAccountInfoResponse(e,x,_)}else b=bs._fromJSON(e,_);f!==o&&(d=b),o=f;break}}catch{}const h=r.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new qo(o,e,s):(o=h[0],d&&await o._set(u,d.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(u)}catch{}})),new qo(o,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_A(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(SA(e))return"Blackberry";if(AA(e))return"Webos";if(TA(e))return"Safari";if((e.includes("chrome/")||bA(e))&&!e.includes("edge/"))return"Chrome";if(EA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function _A(n=_n()){return/firefox\//i.test(n)}function TA(n=_n()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bA(n=_n()){return/crios\//i.test(n)}function xA(n=_n()){return/iemobile/i.test(n)}function EA(n=_n()){return/android/i.test(n)}function SA(n=_n()){return/blackberry/i.test(n)}function AA(n=_n()){return/webos/i.test(n)}function Og(n=_n()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function LU(n=_n()){var e;return Og(n)&&!!((e=window.navigator)!=null&&e.standalone)}function VU(){return O2()&&document.documentMode===10}function CA(n=_n()){return Og(n)||EA(n)||AA(n)||SA(n)||/windows phone/i.test(n)||xA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(n,e=[]){let t;switch(n){case"Browser":t=dx(_n());break;case"Worker":t=`${dx(_n())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${il}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=o=>new Promise((u,d)=>{try{const h=e(o);u(h)}catch(h){d(h)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UU(n,e={}){return ji(n,"GET","/v2/passwordPolicy",Fr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=6;class BU{constructor(e){var s;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??FU,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fx(this),this.idTokenSubscription=new fx(this),this.beforeStateQueue=new OU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ri(t)),this._initializationPromise=this.queue(async()=>{var s,r,o;if(!this._deleted&&(this.persistenceManager=await qo.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await cf(this,{idToken:e}),s=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(rs(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(o=this.redirectUser)==null?void 0:o._redirectEventId,d=s==null?void 0:s._redirectEventId,h=await this.tryRedirectSignIn(e);(!u||u===d)&&(h!=null&&h.user)&&(s=h.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(u){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await df(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rs(this.app))return Promise.reject(Pi(this));const t=e?En(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rs(this.app)?Promise.reject(Pi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rs(this.app)?Promise.reject(Pi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UU(this),t=new BU(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await kU(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ri(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await qo.create(this,[Ri(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(d,this,"internal-error"),d.then(()=>{u||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,s,r);return()=>{u=!0,h()}}else{const h=e.addObserver(t);return()=>{u=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var t;if(rs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&vU(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Va(n){return En(n)}class fx{constructor(e){this.auth=e,this.observer=null,this.addObserver=G2(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qU(n){Uf=n}function IA(n){return Uf.loadJS(n)}function HU(){return Uf.recaptchaEnterpriseScript}function zU(){return Uf.gapiScript}function GU(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class $U{constructor(){this.enterprise=new KU}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class KU{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const YU="recaptcha-enterprise",NA="NO_RECAPTCHA";class JU{constructor(e){this.type=YU,this.auth=Va(e)}async verify(e="verify",t=!1){async function s(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(u,d)=>{IU(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const f=new wU(h);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,u(f.siteKey)}}).catch(h=>{d(h)})})}function r(o,u,d){const h=window.grecaptcha;lx(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(f=>{u(f)}).catch(()=>{u(NA)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $U().execute("siteKey",{action:"verify"}):new Promise((o,u)=>{s(this.auth).then(d=>{if(!t&&lx(window.grecaptcha))r(d,o,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let h=HU();h.length!==0&&(h+=d),IA(h).then(()=>{r(d,o,u)}).catch(f=>{u(f)})}}).catch(d=>{u(d)})})}}async function hx(n,e,t,s=!1,r=!1){const o=new JU(n);let u;if(r)u=NA;else try{u=await o.verify(t)}catch{u=await o.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const h=d.phoneEnrollmentInfo.phoneNumber,f=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const h=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return s?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Gp(n,e,t,s,r){var o;if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await hx(n,e,t,t==="getOobCode");return s(n,u)}else return s(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await hx(n,e,t,t==="getOobCode");return s(n,d)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(n,e){const t=ig(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),o=t.getOptions();if(Aa(o,e??{}))return r;Ss(r,"already-initialized")}return t.initialize({options:e})}function QU(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(Ri);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function DA(n,e,t){const s=Va(n);De(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,o=MA(e),{host:u,port:d}=XU(e),h=d===null?"":`:${d}`,f={url:`${o}//${u}${h}/`},_=Object.freeze({host:u,port:d,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){De(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),De(Aa(f,s.config.emulator)&&Aa(_,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=f,s.emulatorConfig=_,s.settings.appVerificationDisabledForTesting=!0,sl(u)?(vE(`${o}//${u}${h}`),_E("Auth",!0)):WU()}function MA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function XU(n){const e=MA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const o=r[1];return{host:o,port:mx(s.substr(o.length+1))}}else{const[o,u]=s.split(":");return{host:o,port:mx(u)}}}function mx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function WU(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,t){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}}async function ZU(n,e){return ji(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e4(n,e){return Ju(n,"POST","/v1/accounts:signInWithPassword",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t4(n,e){return Ju(n,"POST","/v1/accounts:signInWithEmailLink",Fr(n,e))}async function n4(n,e){return Ju(n,"POST","/v1/accounts:signInWithEmailLink",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo extends Ff{constructor(e,t,s,r=null){super("password",s),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Zo(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Zo(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,t,"signInWithPassword",e4);case"emailLink":return t4(e,{email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gp(e,s,"signUpPassword",ZU);case"emailLink":return n4(e,{idToken:t,email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(n,e){return Ju(n,"POST","/v1/accounts:signInWithIdp",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="http://localhost";class Or extends Ff{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Or(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ss("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...o}=t;if(!s||!r)return null;const u=new Or(s,r);return u.idToken=o.idToken||void 0,u.accessToken=o.accessToken||void 0,u.secret=o.secret,u.nonce=o.nonce,u.pendingToken=o.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Ho(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Ho(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ho(e,t)}buildRequest(){const e={requestUri:s4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ju(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function r4(n){const e=pu(gu(n)).link,t=e?pu(gu(e)).deep_link_id:null,s=pu(gu(n)).deep_link_id;return(s?pu(gu(s)).link:null)||s||t||e||n}class Bf{constructor(e){const t=pu(gu(e)),s=t.apiKey??null,r=t.oobCode??null,o=i4(t.mode??null);De(s&&r&&o,"argument-error"),this.apiKey=s,this.operation=o,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=r4(e);try{return new Bf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(){this.providerId=Oa.PROVIDER_ID}static credential(e,t){return Zo._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Bf.parseLink(t);return De(s,"argument-error"),Zo._fromEmailAndCode(e,s.code,s.tenantId)}}Oa.PROVIDER_ID="password";Oa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Oa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu extends PA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends Qu{constructor(){super("facebook.com")}static credential(e){return Or._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ai.credential(e.oauthAccessToken)}catch{return null}}}Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ai.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Qu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Or._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Ci.credential(t,s)}catch{return null}}}Ci.GOOGLE_SIGN_IN_METHOD="google.com";Ci.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Qu{constructor(){super("github.com")}static credential(e){return Or._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wi.credential(e.oauthAccessToken)}catch{return null}}}wi.GITHUB_SIGN_IN_METHOD="github.com";wi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Qu{constructor(){super("twitter.com")}static credential(e,t){return Or._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Ii.credential(t,s)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a4(n,e){return Ju(n,"POST","/v1/accounts:signUp",Fr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const o=await bs._fromIdTokenResponse(e,s,r),u=px(s);return new Ra({user:o,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=px(s);return new Ra({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function px(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Bi{constructor(e,t,s,r){super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,ff.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new ff(e,t,s,r)}}function kA(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?ff._fromErrorAndOperation(n,o,e,s):o})}async function o4(n,e,t=!1){const s=await Wo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ra._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(n,e,t=!1){const{auth:s}=n;if(rs(s.app))return Promise.reject(Pi(s));const r="reauthenticate";try{const o=await Wo(n,kA(s,r,e,n),t);De(o.idToken,s,"internal-error");const u=Vg(o.idToken);De(u,s,"internal-error");const{sub:d}=u;return De(n.uid===d,s,"user-mismatch"),Ra._forOperation(n,r,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Ss(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LA(n,e,t=!1){if(rs(n.app))return Promise.reject(Pi(n));const s="signIn",r=await kA(n,s,e),o=await Ra._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(o.user),o}async function VA(n,e){return LA(Va(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OA(n){const e=Va(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function u4(n,e,t){if(rs(n.app))return Promise.reject(Pi(n));const s=Va(n),u=await Gp(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",a4).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&OA(n),h}),d=await Ra._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(d.user),d}function c4(n,e,t){return rs(n.app)?Promise.reject(Pi(n)):VA(En(n),Oa.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&OA(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(n,e){return ji(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=En(n),o={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Wo(s,d4(s.auth,o));s.displayName=u.displayName||null,s.photoURL=u.photoUrl||null;const d=s.providerData.find(({providerId:h})=>h==="password");d&&(d.displayName=s.displayName,d.photoURL=s.photoURL),await s._updateTokensIfNecessary(u)}function UA(n,e,t,s){return En(n).onIdTokenChanged(e,t,s)}function FA(n,e,t){return En(n).beforeAuthStateChanged(e,t)}function h4(n,e,t,s){return En(n).onAuthStateChanged(e,t,s)}function m4(n){return En(n).signOut()}const hf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hf,"1"),this.storage.removeItem(hf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4=1e3,g4=10;class jA extends BA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=CA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,h)=>{this.notifyListeners(u,h)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},o=this.storage.getItem(s);VU()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,g4):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},p4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}jA.type="LOCAL";const qA=jA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA extends BA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}HA.type="SESSION";const Ug=HA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new jf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:o}=t.data,u=this.handlersMap[r];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const d=Array.from(u).map(async f=>f(t.origin,o)),h=await y4(d);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,u;return new Promise((d,h)=>{const f=Fg("",20);r.port1.start();const _=setTimeout(()=>{h(new Error("unsupported_event"))},s);u={messageChannel:r,onMessage(b){const x=b;if(x.data.eventId===f)switch(x.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),d(x.data.response);break;default:clearTimeout(_),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(u),r.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[r.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xs(){return window}function _4(n){Xs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(){return typeof Xs().WorkerGlobalScope<"u"&&typeof Xs().importScripts=="function"}async function T4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function b4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function x4(){return zA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="firebaseLocalStorageDb",E4=1,mf="firebaseLocalStorage",$A="fbase_key";class Xu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function qf(n,e){return n.transaction([mf],e?"readwrite":"readonly").objectStore(mf)}function S4(){const n=indexedDB.deleteDatabase(GA);return new Xu(n).toPromise()}function $p(){const n=indexedDB.open(GA,E4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(mf,{keyPath:$A})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(mf)?e(s):(s.close(),await S4(),e(await $p()))})})}async function gx(n,e,t){const s=qf(n,!0).put({[$A]:e,value:t});return new Xu(s).toPromise()}async function A4(n,e){const t=qf(n,!1).get(e),s=await new Xu(t).toPromise();return s===void 0?null:s.value}function yx(n,e){const t=qf(n,!0).delete(e);return new Xu(t).toPromise()}const C4=800,w4=3;class KA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $p(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>w4)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jf._getInstance(x4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,s;if(this.activeServiceWorker=await T4(),!this.activeServiceWorker)return;this.sender=new v4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||b4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $p();return await gx(e,hf,"1"),await yx(e,hf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>gx(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>A4(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>yx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=qf(r,!1).getAll();return new Xu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),C4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KA.type="LOCAL";const YA=KA;new Yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(n,e){return e?Ri(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends Ff{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ho(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ho(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function N4(n){return LA(n.auth,new Bg(n),n.bypassAuthState)}function R4(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),l4(t,new Bg(n),n.bypassAuthState)}async function D4(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),o4(t,new Bg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t,s,r,o=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:o,error:u,type:d}=e;if(u){this.reject(u);return}const h={auth:this.auth,requestUri:t,sessionId:s,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return N4;case"linkViaPopup":case"linkViaRedirect":return D4;case"reauthViaPopup":case"reauthViaRedirect":return R4;default:Ss(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=new Yu(2e3,1e4);class Vo extends JA{constructor(e,t,s,r,o){super(e,t,r,o),this.provider=s,this.authWindow=null,this.pollId=null,Vo.currentPopupAction&&Vo.currentPopupAction.cancel(),Vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=Fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if((s=(t=this.authWindow)==null?void 0:t.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,M4.get())};e()}}Vo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="pendingRedirect",Bd=new Map;class k4 extends JA{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Bd.get(this.auth._key());if(!e){try{const s=await L4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Bd.set(this.auth._key(),e)}return this.bypassAuthState||Bd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function L4(n,e){const t=U4(e),s=O4(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function V4(n,e){Bd.set(n._key(),e)}function O4(n){return Ri(n._redirectPersistence)}function U4(n){return Fd(P4,n.config.apiKey,n.name)}async function F4(n,e,t=!1){if(rs(n.app))return Promise.reject(Pi(n));const s=Va(n),r=I4(s,e),u=await new k4(s,r,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=600*1e3;class j4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!q4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!QA(e)){const r=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";t.onError(Qs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=B4&&this.cachedEventUids.clear(),this.cachedEventUids.has(vx(e))}saveEventToCache(e){this.cachedEventUids.add(vx(e)),this.lastProcessedEventTime=Date.now()}}function vx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function QA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function q4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return QA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(n,e={}){return ji(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G4=/^https?/;async function $4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await H4(n);for(const t of e)try{if(K4(t))return}catch{}Ss(n,"unauthorized-domain")}function K4(n){const e=qp(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!G4.test(t))return!1;if(z4.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=new Yu(3e4,6e4);function _x(){const n=Xs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function J4(n){return new Promise((e,t)=>{var r,o,u;function s(){_x(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_x(),t(Qs(n,"network-request-failed"))},timeout:Y4.get()})}if((o=(r=Xs().gapi)==null?void 0:r.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((u=Xs().gapi)!=null&&u.load)s();else{const d=GU("iframefcb");return Xs()[d]=()=>{gapi.load?s():t(Qs(n,"network-request-failed"))},IA(`${zU()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw jd=null,e})}let jd=null;function Q4(n){return jd=jd||J4(n),jd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=new Yu(5e3,15e3),W4="__/auth/iframe",Z4="emulator/auth/iframe",e6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},t6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function n6(n){const e=n.config;De(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Lg(e,Z4):`https://${n.config.authDomain}/${W4}`,s={apiKey:e.apiKey,appName:n.name,v:il},r=t6.get(n.config.apiHost);r&&(s.eid=r);const o=n._getFrameworks();return o.length&&(s.fw=o.join(",")),`${t}?${ju(s).slice(1)}`}async function s6(n){const e=await Q4(n),t=Xs().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:n6(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:e6,dontclear:!0},s=>new Promise(async(r,o)=>{await s.restyle({setHideOnLeave:!1});const u=Qs(n,"network-request-failed"),d=Xs().setTimeout(()=>{o(u)},X4.get());function h(){Xs().clearTimeout(d),r(s)}s.ping(h).then(h,()=>{o(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r6=500,a6=600,o6="_blank",l6="http://localhost";class Tx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u6(n,e,t,s=r6,r=a6){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let d="";const h={...i6,width:s.toString(),height:r.toString(),top:o,left:u},f=_n().toLowerCase();t&&(d=bA(f)?o6:t),_A(f)&&(e=e||l6,h.scrollbars="yes");const _=Object.entries(h).reduce((x,[C,M])=>`${x}${C}=${M},`,"");if(LU(f)&&d!=="_self")return c6(e||"",d),new Tx(null);const b=window.open(e||"",d,_);De(b,n,"popup-blocked");try{b.focus()}catch{}return new Tx(b)}function c6(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6="__/auth/handler",f6="emulator/auth/handler",h6=encodeURIComponent("fac");async function bx(n,e,t,s,r,o){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:il,eventId:r};if(e instanceof PA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",z2(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))u[_]=b}if(e instanceof Qu){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const h=await n._getAppCheckToken(),f=h?`#${h6}=${encodeURIComponent(h)}`:"";return`${m6(n)}?${ju(d).slice(1)}${f}`}function m6({config:n}){return n.emulator?Lg(n,f6):`https://${n.authDomain}/${d6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="webStorageSupport";class p6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ug,this._completeRedirectFn=F4,this._overrideRedirectResult=V4}async _openPopup(e,t,s,r){var u;Ui((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const o=await bx(e,t,s,qp(),r);return u6(e,o,Fg())}async _openRedirect(e,t,s,r){await this._originValidation(e);const o=await bx(e,t,s,qp(),r);return _4(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:o}=this.eventManagers[t];return r?Promise.resolve(r):(Ui(o,"If manager is not set, promise should be"),o)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await s6(e),s=new j4(e);return t.register("authEvent",r=>(De(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ip,{type:ip},r=>{var u;const o=(u=r==null?void 0:r[0])==null?void 0:u[ip];o!==void 0&&t(!!o),Ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return CA()||TA()||Og()}}const XA=p6;var xx="@firebase/auth",Ex="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y6(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function v6(n){Go(new Ca("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=s.options;De(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const h={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wA(n)},f=new jU(s,r,o,h);return QU(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Go(new Ca("auth-internal",e=>{const t=Va(e.getProvider("auth").getImmediate());return(s=>new g6(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ir(xx,Ex,y6(n)),Ir(xx,Ex,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=300,T6=yE("authIdTokenMaxAge")||_6;let Sx=null;const b6=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>T6)return;const r=t==null?void 0:t.token;Sx!==r&&(Sx=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function WA(n=EE()){const e=ig(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RA(n,{popupRedirectResolver:XA,persistence:[YA,qA,Ug]}),s=yE("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(s,location.origin);if(location.origin===o.origin){const u=b6(o.toString());FA(t,u,()=>u(t.currentUser)),UA(t,d=>u(d))}}const r=pE("auth");return r&&DA(t,`http://${r}`),t}function x6(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}qU({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const o=Qs("internal-error");o.customData=r,t(o)},s.type="text/javascript",s.charset="UTF-8",x6().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});v6("Browser");const Rd=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Bf,AuthCredential:Ff,EmailAuthCredential:Zo,EmailAuthProvider:Oa,FacebookAuthProvider:Ai,GithubAuthProvider:wi,GoogleAuthProvider:Ci,OAuthCredential:Or,TwitterAuthProvider:Ii,beforeAuthStateChanged:FA,browserLocalPersistence:qA,browserPopupRedirectResolver:XA,browserSessionPersistence:Ug,connectAuthEmulator:DA,createUserWithEmailAndPassword:u4,getAuth:WA,getIdTokenResult:pA,inMemoryPersistence:zp,indexedDBLocalPersistence:YA,initializeAuth:RA,onAuthStateChanged:h4,onIdTokenChanged:UA,prodErrorMap:uA,reload:gA,signInWithCredential:VA,signInWithEmailAndPassword:c4,signOut:m4,updateProfile:f4},Symbol.toStringTag,{value:"Module"}));let rp=null,Si=null,_s=null;const E6=()=>{try{return tg().hasFirebase?(rp=xE(gn.firebase),Si=XS(rp),_s=WA(rp),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};E6();const Ta={async signUp(n,e,t){if(!_s)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:s,updateProfile:r}=await xr(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:d}=await Promise.resolve().then(()=>Rd);return{createUserWithEmailAndPassword:u,updateProfile:d}},void 0),o=await s(_s,n,e);return await r(o.user,{displayName:t}),await this.saveData("users",o.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:o.user}}catch(s){return console.error("خطأ في التسجيل:",s),{success:!1,error:s instanceof Error?s.message:"خطأ غير معروف"}}},async signIn(n,e){if(!_s)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await xr(async()=>{const{signInWithEmailAndPassword:r}=await Promise.resolve().then(()=>Rd);return{signInWithEmailAndPassword:r}},void 0);return{success:!0,user:(await t(_s,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!_s)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await xr(async()=>{const{signOut:e}=await Promise.resolve().then(()=>Rd);return{signOut:e}},void 0);return await n(_s),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return _s?_s.currentUser:null},async onAuthStateChanged(n){if(!_s)return n(null),()=>{};try{const{onAuthStateChanged:e}=await xr(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>Rd);return{onAuthStateChanged:t}},void 0);return e(_s,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:s,setDoc:r}=await xr(async()=>{const{doc:u,setDoc:d}=await Promise.resolve().then(()=>Id);return{doc:u,setDoc:d}},void 0),o=s(Si,n,e);return await r(o,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(s){return console.error("خطأ في حفظ البيانات:",s),{success:!1,error:s instanceof Error?s.message:"خطأ غير معروف"}}},async getData(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:s}=await xr(async()=>{const{doc:u,getDoc:d}=await Promise.resolve().then(()=>Id);return{doc:u,getDoc:d}},void 0),r=t(Si,n,e),o=await s(r);return o.exists()?{success:!0,data:o.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await xr(async()=>{const{collection:o,getDocs:u}=await Promise.resolve().then(()=>Id);return{collection:o,getDocs:u}},void 0),s=await t(e(Si,n)),r=[];return s.forEach(o=>{r.push({id:o.id,...o.data()})}),{success:!0,data:r}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:s}=await xr(async()=>{const{doc:o,deleteDoc:u}=await Promise.resolve().then(()=>Id);return{doc:o,deleteDoc:u}},void 0),r=t(Si,n,e);return await s(r),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},Ax=({onSuccess:n,onClose:e,hideCloseButton:t=!1,darkMode:s=!1,language:r="ar"})=>{const[o,u]=fe.useState(!0),[d,h]=fe.useState({email:"",password:"",displayName:""}),[f,_]=fe.useState(!1),[b,x]=fe.useState(""),C=async k=>{k.preventDefault(),_(!0),x("");try{let V;if(o)V=await Ta.signIn(d.email,d.password);else{if(!d.displayName.trim()){x("الاسم مطلوب"),_(!1);return}V=await Ta.signUp(d.email,d.password,d.displayName)}V.success?n(V.user):x(V.error||"حدث خطأ غير متوقع")}catch{x("حدث خطأ في الاتصال")}finally{_(!1)}},M=k=>{h(V=>({...V,[k.target.name]:k.target.value}))};return p.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:o?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&p.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),p.jsxs("form",{onSubmit:C,className:"space-y-4",children:[!o&&p.jsxs("div",{children:[p.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),p.jsx("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName,onChange:M,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!o})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),p.jsx("input",{type:"email",id:"email",name:"email",value:d.email,onChange:M,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),p.jsx("input",{type:"password",id:"password",name:"password",value:d.password,onChange:M,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),b&&p.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:p.jsx("p",{className:"text-red-600 text-sm",children:b})}),p.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:f?"⏳ جاري المعالجة...":o?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("button",{onClick:()=>u(!o),className:"text-blue-600 hover:text-blue-700 font-medium",children:o?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},ZA=()=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),p.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),zo=()=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[p.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),p.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),S6=()=>p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[p.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),p.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),A6=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),C6=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),w6=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),I6=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),N6=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Wu=({className:n})=>p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),R6=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:s,onAddTransaction:r,currentUser:o,onSignOut:u,language:d="ar"})=>{const{t:h}=gf(),f=fe.useMemo(()=>{const b=new Date().getFullYear(),x=[];for(let C=b+1;C>=2020;C--)x.push(C);return x},[]),_=fe.useMemo(()=>[{value:"all",label:d==="ar"?"كل الشهور":"All Months"},{value:1,label:h("months.january")},{value:2,label:h("months.february")},{value:3,label:h("months.march")},{value:4,label:h("months.april")},{value:5,label:h("months.may")},{value:6,label:h("months.june")},{value:7,label:h("months.july")},{value:8,label:h("months.august")},{value:9,label:h("months.september")},{value:10,label:h("months.october")},{value:11,label:h("months.november")},{value:12,label:h("months.december")}],[d,h]);return p.jsx("header",{className:"bg-slate-50/95 backdrop-blur-lg border-b border-slate-200 py-3 shadow-sm",children:p.jsx("div",{className:"container mx-auto px-4",children:p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-wide",children:h("app.title")}),p.jsx("p",{className:"text-xs text-slate-500",children:h("app.developedBy")})]})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 p-1.5 rounded-lg",children:[p.jsx("select",{value:n,onChange:b=>t(parseInt(b.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:f.map(b=>p.jsx("option",{value:b,children:b},b))}),p.jsx("select",{value:e,onChange:b=>s(b.target.value==="all"?"all":parseInt(b.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:_.map(b=>p.jsx("option",{value:b.value,children:b.label},b.value))})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:o.displayName||"المستخدم"}),p.jsx("p",{className:"text-xs text-slate-500",children:o.email})]}),p.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(o.displayName||o.email||"U").charAt(0).toUpperCase()})}),p.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),p.jsxs("button",{onClick:r,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[p.jsx(N6,{className:"w-5 h-5"}),p.jsx("span",{children:h("header.addTransaction")})]})]})]})})})},D6=()=>{const{t:n}=gf();return[{id:"summary",label:`📊 ${n("navigation.summary")}`,icon:A6},{id:"analysis",label:`📈 ${n("navigation.analysis")}`,icon:C6},{id:"transactions",label:`💳 ${n("navigation.transactions")}`,icon:w6},{id:"budget",label:`✨ ${n("navigation.budget")}`},{id:"investment",label:`💹 ${n("navigation.investment")}`},{id:"ai-assistant",label:`🤖 ${n("navigation.aiAssistant")}`},{id:"cards",label:`💳 ${n("navigation.cards")}`},{id:"bank",label:`🏦 ${n("navigation.bank")}`},{id:"installments",label:`📱 ${n("navigation.installments")}`},{id:"debts-loans",label:`📊 ${n("navigation.debtsLoans")}`},{id:"settings",label:`⚙️ ${n("navigation.settings")}`}]},Cx=["summary","analysis","transactions"],M6=({activeTab:n,setActiveTab:e,language:t="ar"})=>{const[s,r]=fe.useState(!1),o=D6(),u=f=>{e(f),r(!1)},d=o.filter(f=>Cx.includes(f.id)),h=o.filter(f=>!Cx.includes(f.id));return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:o.map(f=>p.jsx("button",{onClick:()=>u(f.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===f.id?"active":""}`,children:f.label},f.id))}),p.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[d.map(f=>{const _=f.icon;return p.jsxs("button",{onClick:()=>u(f.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===f.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[_&&p.jsx(_,{}),p.jsx("span",{className:"text-xs",children:f.label.split(" ")[1]})]},f.id)}),p.jsxs("button",{onClick:()=>r(!s),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${s?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[p.jsx(I6,{}),p.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),s&&p.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>r(!1),children:p.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:f=>f.stopPropagation(),children:[p.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),p.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:h.map(f=>p.jsxs("button",{onClick:()=>u(f.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===f.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[p.jsx("span",{className:"text-2xl",children:f.label.split(" ")[0]}),p.jsx("span",{className:"text-xs font-semibold",children:f.label.split(" ")[1]})]},f.id))})]})})]})},P6=({className:n,darkMode:e=!1})=>p.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-${e?"slate-700/80":"slate-200/80"} to-transparent ${n}`}),ap=({darkMode:n=!1})=>p.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[p.jsx("div",{className:`h-6 w-1/2 rounded mb-6 ${n?"bg-slate-700":"bg-slate-200"}`}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),p.jsx("div",{className:`h-4 w-5/6 rounded ${n?"bg-slate-700":"bg-slate-200"}`}),p.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),p.jsx("div",{className:`h-4 w-3/4 rounded ${n?"bg-slate-700":"bg-slate-200"}`})]}),p.jsx(P6,{darkMode:n})]}),k6=({darkMode:n=!1})=>p.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[p.jsx("div",{className:"h-16 mb-3"}),p.jsx("div",{className:`flex flex-wrap justify-center mb-8 rounded-xl p-2 h-14 ${n?"bg-slate-700":"bg-slate-100"}`}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[p.jsx(ap,{}),p.jsx(ap,{}),p.jsx(ap,{})]})]}),Le=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),L6=({title:n,details:e,barColor:t,darkMode:s=!1,language:r="ar"})=>p.jsxs("div",{className:`p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between ${s?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("h4",{className:`font-bold text-sm ${s?"text-slate-200":"text-slate-800"}`,children:n}),p.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),p.jsxs("div",{className:`p-2 rounded-lg border ${s?"bg-slate-700 border-slate-600":"bg-slate-50 border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[p.jsxs("span",{className:s?"text-slate-400":"text-slate-600",children:[Lt("due",r),":"]}),p.jsx("span",{className:`font-semibold number-display text-xs ${s?"text-slate-200":"text-slate-900"}`,children:Le(e.balance)})]}),p.jsxs("div",{className:"flex justify-between text-xs",children:[p.jsxs("span",{className:s?"text-slate-400":"text-slate-600",children:[Lt("remaining",r),":"]}),p.jsx("span",{className:`font-semibold number-display text-xs ${s?"text-slate-200":"text-emerald-700"}`,children:Le(e.available)})]})]}),p.jsx("div",{className:`rounded-full h-1.5 overflow-hidden ${s?"bg-slate-600":"bg-slate-200"}`,children:p.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),V6=({calculations:n,categories:e,darkMode:t=!1,language:s="ar"})=>{const r=Object.values(n.expensesByCategory).reduce((u,d)=>u+Number(d),0);if(r===0)return p.jsx("p",{className:`text-center p-4 text-sm ${t?"text-slate-400":"text-slate-500"}`,children:Lt("no.data",s)});const o=Object.entries(n.expensesByCategory).sort(([,u],[,d])=>d-u);return p.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:o.map(([u,d])=>{const h=e.find(_=>_.id===u);h?`${h.icon}${h.name}`:Lt("other",s);const f=Number(d)/r*100;return p.jsxs("div",{className:`p-3 rounded-lg border shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between ${t?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"text-base",children:(h==null?void 0:h.icon)||"📊"}),p.jsx("span",{className:`font-medium truncate text-sm ${t?"text-slate-300":"text-slate-700"}`,title:h==null?void 0:h.name,children:(h==null?void 0:h.name)||Lt("other",s)})]}),p.jsx("span",{className:`font-semibold number-display text-sm px-2 py-1 rounded border ${t?"text-slate-200 bg-slate-700 border-slate-600":"text-slate-900 bg-slate-50 border-gray-200"}`,children:Le(d)})]}),p.jsx("div",{className:`mt-2 rounded-full h-1.5 overflow-hidden ${t?"bg-slate-600":"bg-slate-200"}`,children:p.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${f.toFixed(1)}%`}})}),p.jsxs("div",{className:`text-xs mt-1 text-center ${t?"text-slate-400":"text-slate-500"}`,children:[f.toFixed(1),"%"]})]},u)})})},O6=({calculations:n,categories:e,state:t,darkMode:s=!1,language:r="ar"})=>{const{totalIncome:o,totalExpenses:u,cardPayments:d,bankAccountDetails:h,totalBankBalance:f}=n,_=o-u,b=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"],x=fe.useMemo(()=>{const V={};return Object.values(t.cards).forEach(U=>{let B=t.transactions.filter(K=>K.paymentMethod===U.id&&(K.type==="expense"||K.type==="bnpl-payment")).reduce((K,se)=>K+se.amount,0);t.transactions.forEach(K=>{K.type===`${U.id}-payment`&&(B-=K.amount)}),V[U.id]={...U,balance:B,available:U.limit-B,usagePercentage:U.limit>0?B/U.limit*100:0}}),V},[t.transactions,t.cards]),C=Object.values(x).reduce((V,$)=>V+$.balance,0),M=Object.values(x).reduce((V,$)=>V+$.available,0),k=Object.values(x).reduce((V,$)=>V+$.limit,0);return p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[p.jsxs("div",{className:"card-consistent xl:col-span-1",children:[p.jsxs("h3",{className:`font-semibold text-lg mb-4 ${s?"text-slate-200":"text-slate-800"}`,children:["💳 ",Lt("card.debts.summary",r)]}),p.jsx("div",{className:"space-y-4",children:Object.values(x).map((V,$)=>p.jsx(L6,{title:V.name,details:V,barColor:b[$%b.length],darkMode:s,language:r},V.id))}),p.jsx("div",{className:`mt-4 p-3 rounded-lg ${s?"bg-slate-700":"bg-slate-100"}`,children:p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[p.jsx("p",{className:`font-semibold text-xs mb-2 ${s?"text-red-400":"text-red-600"}`,children:Lt("total.debts",r)}),p.jsx("p",{className:`font-bold text-sm number-display ${s?"text-red-400":"text-red-600"}`,children:Le(C)})]}),p.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[p.jsx("p",{className:`font-semibold text-xs mb-2 ${s?"text-emerald-400":"text-emerald-600"}`,children:Lt("total.available",r)}),p.jsx("p",{className:`font-bold text-sm number-display ${s?"text-emerald-400":"text-emerald-600"}`,children:Le(M)})]}),p.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[p.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),p.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:Le(k)})]})]})})]}),p.jsxs("div",{className:"card-consistent xl:col-span-1",children:[p.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),p.jsx("div",{className:"space-y-3",children:Object.values(h).map(V=>{const $=V.balance>0?"bank-card-positive":V.balance<0?"bank-card-negative":"bank-card-neutral";return p.jsxs("div",{className:`card-consistent ${$} h-32 flex flex-col justify-between`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:V.name}),p.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),p.jsx("div",{className:"text-center",children:p.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:Le(V.balance)})}),p.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),p.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",Le(V.deposits)]})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),p.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",Le(V.withdrawals)]})]})]})]},V.id)})}),p.jsxs("div",{className:"mt-4 card-consistent text-center",children:[p.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-2",children:"🏦 إجمالي الأرصدة البنكية"}),p.jsx("p",{className:"font-bold text-xl text-blue-900 number-display",children:Le(f)})]})]}),p.jsxs("div",{className:"card-consistent xl:col-span-1",children:[p.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),p.jsxs("div",{className:"space-y-2 text-sm",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"إجمالي الدخل:"}),p.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:Le(o)})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{children:"إجمالي المصاريف:"}),p.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:Le(u)})]}),p.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(x).map((V,$)=>p.jsxs("div",{className:"flex justify-between text-xs",children:[p.jsxs("span",{className:"text-slate-500",children:["مصاريف ",V.name,":"]}),p.jsx("span",{className:`font-semibold ${b[$%b.length].replace("bg-","text-")} number-display`,children:Le(V.balance+(d[V.id]||0))})]},V.id)),p.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(d).map(([V,$])=>{var U;return p.jsxs("div",{className:"flex justify-between text-xs",children:[p.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(U=x[V])==null?void 0:U.name,":"]}),p.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:Le($)})]},V)}),p.jsx("hr",{className:"my-2 border-slate-200"}),p.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[p.jsx("span",{children:"الصافي:"}),p.jsx("span",{className:`number-display ${_>=0?"text-emerald-500":"text-red-500"}`,children:Le(_)})]})]})]}),p.jsxs("div",{className:"card-consistent xl:col-span-1",children:[p.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),p.jsx(V6,{calculations:n,categories:e})]})]})},U6=({transactions:n,allTransactions:e,categories:t,deleteTransaction:s,editTransaction:r,state:o,darkMode:u=!1,language:d="ar"})=>{const[h,f]=fe.useState(""),[_,b]=fe.useState(""),[x,C]=fe.useState(""),[M,k]=fe.useState(""),[V,$]=fe.useState(""),U=H=>{const R={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return R[H]?R[H]:o.cards[H]?`💳 ${o.cards[H].name}`:o.bankAccounts[H]?`🏦 ${o.bankAccounts[H].name}`:H},B=H=>{const R={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(R[H])return R[H];if(H.endsWith("-payment")){const N=H.replace("-payment","");if(o.cards[N])return`💳 سداد ${o.cards[N].name}`}return H},K=fe.useMemo(()=>{let H=e;if(M&&V){const R=new Date(M),N=new Date(V);N.setHours(23,59,59,999),H=e.filter(D=>{const w=new Date(D.date);return w>=R&&w<=N})}return H=H.filter(R=>{const N=h.toLowerCase(),D=t.find(O=>O.id===R.categoryId),w=R.description.toLowerCase().includes(N)||(D==null?void 0:D.name.toLowerCase().includes(N)),L=!_||R.paymentMethod===_,j=!x||R.categoryId===x;return w&&L&&j}),H.sort((R,N)=>{const D=new Date(R.date),L=new Date(N.date).getTime()-D.getTime();if(L===0){const j=parseInt(R.id.replace("trans-","").split("-")[0]);return parseInt(N.id.replace("trans-","").split("-")[0])-j}return L})},[n,e,h,_,x,M,V,t]),se=fe.useMemo(()=>K.reduce((H,R)=>(R.type==="income"||R.type.toString().includes("payment")||R.type==="investment-withdrawal"?H.positive+=R.amount:H.negative+=R.amount,H),{positive:0,negative:0}),[K]);return p.jsx("div",{className:"space-y-6 animate-fade-in",children:p.jsxs("div",{className:"glass-card p-6",children:[p.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),p.jsx("input",{type:"date",id:"dateFrom",value:M,onChange:H=>k(H.target.value),className:"w-full p-2"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),p.jsx("input",{type:"date",id:"dateTo",value:V,onChange:H=>$(H.target.value),className:"w-full p-2"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),p.jsxs("select",{id:"filterMethod",value:_,onChange:H=>b(H.target.value),className:"p-2 w-full",children:[p.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(o.bankAccounts).map(H=>p.jsxs("option",{value:H.id,children:["🏦 ",H.name]},H.id)),p.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(o.cards).map(H=>p.jsxs("option",{value:H.id,children:["💳 ",H.name]},H.id)),p.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),p.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),p.jsxs("select",{id:"filterCategory",value:x,onChange:H=>C(H.target.value),className:"p-2 w-full",children:[p.jsx("option",{value:"",children:"كل الفئات"}),t.map(H=>p.jsx("option",{value:H.id,children:H.name},H.id))]})]}),p.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[p.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),p.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:h,onChange:H=>f(H.target.value),className:"p-2 w-full"})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[p.jsxs("div",{className:"card-consistent",children:[p.jsxs("div",{className:"flex justify-between items-start mb-3",children:[p.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),p.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),p.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:p.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:Le(se.positive)})})]}),p.jsxs("div",{className:"card-consistent",children:[p.jsxs("div",{className:"flex justify-between items-start mb-3",children:[p.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),p.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),p.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:p.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:Le(se.negative)})})]}),p.jsxs("div",{className:"card-consistent",children:[p.jsxs("div",{className:"flex justify-between items-start mb-3",children:[p.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),p.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),p.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:p.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:Le(se.positive-se.negative)})})]})]}),p.jsxs("div",{className:"overflow-x-auto",children:[p.jsxs("table",{className:"w-full text-sm",children:[p.jsx("thead",{className:"border-b border-gray-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),p.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),p.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),p.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),p.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),p.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),p.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),p.jsx("tbody",{children:K.map(H=>{const R=t.find(D=>D.id===H.categoryId),N=H.type==="income"||H.type.toString().includes("payment")||H.type==="investment-withdrawal";return p.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[p.jsx("td",{className:"p-3",children:H.date}),p.jsx("td",{className:"p-3",children:U(H.paymentMethod)}),p.jsx("td",{className:"p-3",children:B(H.type)}),p.jsxs("td",{className:`p-3 font-semibold number-display ${N?"text-emerald-500":"text-red-500"}`,children:[N?"+":"-"," ",Le(H.amount)]}),p.jsx("td",{className:"p-3",children:R?`${R.icon} ${R.name}`:"غير محدد"}),p.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:H.description||"-"}),p.jsx("td",{className:"p-3 text-center",children:p.jsxs("div",{className:"flex gap-2 justify-center",children:[p.jsx("button",{onClick:()=>r(H.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),p.jsx("button",{onClick:()=>s(H.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:p.jsx(zo,{})})]})})]},H.id)})})]}),K.length===0&&p.jsxs("div",{className:"text-center p-8 text-slate-500",children:[p.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),p.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},F6=()=>p.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),B6=({calculations:n,filteredTransactions:e,darkMode:t=!1,language:s="ar"})=>{const[r,o]=fe.useState([{id:"1",text:'أهلاً بك! أنا مساعدك المالي الشامل. يمكنك أن تسألني أسئلة تفصيلية عن وضعك المالي، مثل "ما هو إجمالي ديوني؟" أو "هل إنفاقي هذا الشهر يتوافق مع أهدافي؟"',sender:"ai"}]),[u,d]=fe.useState(""),[h,f]=fe.useState(!1),_=fe.useRef(null);fe.useEffect(()=>{var x;(x=_.current)==null||x.scrollTo(0,_.current.scrollHeight)},[r,h]);const b=async x=>{x.preventDefault();const C=u.trim();if(!C||h)return;const M={id:Date.now().toString(),text:C,sender:"user"};o(k=>[...k,M]),d(""),f(!0);try{const V=await f2(C,{periodSummary:n,transactions:e}),$={id:(Date.now()+1).toString(),text:V,sender:"ai"};o(U=>[...U,$])}catch(k){const V={id:(Date.now()+1).toString(),text:k instanceof Error?k.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};o($=>[...$,V])}finally{f(!1)}};return p.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[p.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل المالي الذكي"}),p.jsx("p",{className:"text-sm text-slate-500",children:"اسأل أي شيء عن بياناتك المالية للشهر المحدد"})]}),p.jsxs("div",{ref:_,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[r.map(x=>p.jsx("div",{className:`chat-bubble ${x.sender==="user"?"user-bubble":"ai-bubble"}`,children:p.jsx("p",{dangerouslySetInnerHTML:{__html:x.text.replace(/\n/g,"<br />")}})},x.id)),h&&p.jsx(F6,{})]}),p.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:p.jsxs("form",{onSubmit:b,className:"flex gap-2",children:[p.jsx("input",{type:"text",value:u,onChange:x=>d(x.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:h}),p.jsx("button",{type:"submit",disabled:h,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:p.jsx(ZA,{})})]})})]})},j6=({calculations:n,categories:e,allTransactions:t,darkMode:s=!1,language:r="ar"})=>{const o=fe.useRef(null),u=fe.useRef(null),d=fe.useRef({}),h=fe.useMemo(()=>Object.entries(n.expensesByCategory).map(([_,b])=>{const x=e.find(C=>C.id===_);return{name:x?`${x.icon} ${x.name}`:"غير محدد",value:b}}).sort((_,b)=>b.value-_.value),[n.expensesByCategory,e]),f=fe.useMemo(()=>{const _={},b=new Date;for(let x=5;x>=0;x--){const M=new Date(b.getFullYear(),b.getMonth()-x,1).toLocaleString("en-US",{month:"short",year:"numeric"});_[M]={income:0,expenses:0}}return t.forEach(x=>{const M=new Date(x.date).toLocaleString("en-US",{month:"short",year:"numeric"});_[M]&&(x.type==="income"&&(_[M].income+=x.amount),(x.type==="expense"||x.type==="bnpl-payment")&&(_[M].expenses+=x.amount))}),{labels:Object.keys(_),incomeData:Object.values(_).map(x=>x.income),expensesData:Object.values(_).map(x=>x.expenses)}},[t]);return fe.useEffect(()=>{var b,x;const _=window.Chart;if(_){if((b=d.current.pie)==null||b.destroy(),(x=d.current.bar)==null||x.destroy(),o.current&&h.length>0){const C=o.current.getContext("2d");C&&(d.current.pie=new _(C,{type:"doughnut",data:{labels:h.map(M=>M.name),datasets:[{data:h.map(M=>M.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(u.current&&f.labels.length>0){const C=u.current.getContext("2d");C&&(d.current.bar=new _(C,{type:"bar",data:{labels:f.labels,datasets:[{label:"الدخل",data:f.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:f.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var C,M;(C=d.current.pie)==null||C.destroy(),(M=d.current.bar)==null||M.destroy()}}},[h,f]),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[p.jsxs("div",{className:"glass-card p-6",children:[p.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📊 توزيع مصاريف الفترة"}),p.jsx("div",{className:"h-80",children:h.length>0?p.jsx("canvas",{ref:o}):p.jsx("p",{className:"text-center text-slate-500 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),p.jsxs("div",{className:"glass-card p-6",children:[p.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),p.jsx("div",{className:"h-80",children:p.jsx("canvas",{ref:u})})]})]})},q6=({state:n,setLoading:e,setModal:t,darkMode:s=!1,language:r="ar"})=>{const[o,u]=fe.useState(""),[d,h]=fe.useState(""),f=async()=>{const _=parseFloat(o);if(isNaN(_)||_<=0){t({title:Lt("error",r),body:`<p>${Lt("invalid.amount",r)}</p>`,confirmText:Lt("confirm",r),hideCancel:!0});return}e(!0,Lt("loading",r)),h("");try{const b=new Date;b.setDate(b.getDate()-60);const x=n.transactions.filter(M=>new Date(M.date)>=b&&M.type==="expense");if(x.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const C=await p2(_,n.categories,x);h(C)}catch(b){const x=b instanceof Error?b.message:"حدث خطأ غير متوقع.";t({title:Lt("error",r),body:`<p>${x}</p>`,confirmText:Lt("confirm",r),hideCancel:!0})}finally{e(!1)}};return p.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[p.jsxs("h3",{className:`text-xl font-bold mb-4 ${s?"text-slate-200":"text-slate-900"}`,children:["✨ ",Lt("budget",r)]}),p.jsxs("div",{className:`flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 rounded-lg ${s?"bg-slate-700":"bg-slate-100"}`,children:[p.jsxs("div",{className:"flex-grow",children:[p.jsx("label",{htmlFor:"monthly-budget-input",className:`block text-sm font-medium mb-1 ${s?"text-slate-300":"text-slate-600"}`,children:Lt("budget.limit",r)}),p.jsx("input",{type:"number",id:"monthly-budget-input",className:`w-full p-2 ${s?"bg-slate-600 text-slate-200 border-slate-500":"bg-white text-slate-900 border-gray-300"} border rounded`,placeholder:"5000",value:o,onChange:_=>u(_.target.value)})]}),p.jsxs("button",{onClick:f,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:["✨ ",Lt("generate.report",r)]})]}),p.jsx("div",{className:"prose max-w-none",children:d?p.jsx("div",{className:s?"text-slate-200":"text-slate-900",dangerouslySetInnerHTML:{__html:d.replace(/### (.*)/g,`<h4 class="text-lg font-bold ${s?"text-slate-200":"text-slate-900"} mt-3 mb-2">$1</h4>`).replace(/\n/g,"<br />")}}):p.jsx("p",{className:`text-center ${s?"text-slate-400":"text-slate-500"}`,children:Lt("no.data",r)})})]})},H6=({state:n,setState:e,calculations:t,setModal:s,darkMode:r=!1,language:o="ar"})=>{const[u,d]=fe.useState([{id:"1",text:'أهلاً بك! أنا مرشدك لفهم عالم الاستثمار. يمكنك سؤالي عن استراتيجيات، أو مفاهيم مثل "ما هو الاستثمار طويل الأجل؟". تذكر، أنا لا أقدم نصائح مباشرة لشراء أسهم معينة.',sender:"ai"}]),[h,f]=fe.useState(""),[_,b]=fe.useState(!1),x=fe.useRef(null);fe.useEffect(()=>{var V;(V=x.current)==null||V.scrollTo(0,x.current.scrollHeight)},[u,_]);const C=V=>{V.preventDefault();const $=V.target,U=parseFloat($.elements.namedItem("investment-amount").value),B=$.elements.namedItem("investment-type").value,K=$.elements.namedItem("payment-method").value;if(isNaN(U)||U<=0){s({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const se={amount:U,date:new Date().toISOString().split("T")[0],description:B==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:K,type:B==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(H=>({...H,transactions:[...H.transactions,{...se,id:`trans-${Date.now()}`}]})),$.reset()},M=async V=>{V.preventDefault();const $=h.trim();if(!(!$||_)){d(U=>[...U,{id:Date.now().toString(),text:$,sender:"user"}]),f(""),b(!0);try{const U=await m2($);d(B=>[...B,{id:(Date.now()+1).toString(),text:U,sender:"ai"}])}catch(U){d(B=>[...B,{id:(Date.now()+1).toString(),text:U instanceof Error?U.message:"عذراً، حدث خطأ.",sender:"ai"}])}finally{b(!1)}}},k=()=>{const V=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;s({show:!0,title:"تحديث قيمة المحفظة",body:V,confirmText:"حفظ",onConfirm:()=>{const $=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN($)||$<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(U=>({...U,investments:{...U.investments,currentValue:$}}))}})};return p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[p.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[p.jsxs("div",{className:"glass-card p-6 text-center",children:[p.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),p.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:Le(n.investments.currentValue)}),p.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",p.jsx("span",{className:"font-semibold number-display text-slate-600",children:Le(t.totalInvestmentDeposits)})]}),p.jsx("button",{onClick:k,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),p.jsxs("div",{className:"glass-card p-6",children:[p.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),p.jsxs("form",{onSubmit:C,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),p.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),p.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[p.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),p.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),p.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(V=>p.jsxs("option",{value:V.id,children:["🏦 ",V.name]},V.id))})]}),p.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),p.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[p.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 مستشارك الاستثماري الذكي"}),p.jsx("p",{className:"text-sm text-slate-500",children:"اسأل عن المفاهيم والاستراتيجيات لاتخاذ قرارات أفضل"})]}),p.jsxs("div",{ref:x,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[u.map(V=>p.jsx("div",{className:`chat-bubble ${V.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:V.text.replace(/\n/g,"<br/>")}},V.id)),_&&p.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),p.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),p.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:p.jsxs("form",{onSubmit:M,className:"flex gap-2",children:[p.jsx("input",{type:"text",value:h,onChange:V=>f(V.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:_}),p.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:_,children:p.jsx(ZA,{})})]})})]})]})},z6=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:s})=>{const r=o=>!o||o.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':o.map(u=>`
            <tr class="hover:bg-slate-50">
                <td class="p-2">${u.postingDate||u.date}</td>
                <td class="p-2 truncate" title="${u.description}">${u.description}</td>
                <td class="p-2 number-display text-red-500">${Le(u.amount)}</td>
            </tr>
        `).join("");return p.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[p.jsxs("div",{className:"flex items-start justify-between mb-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),p.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),p.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[p.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),p.jsx("button",{onClick:()=>s(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:p.jsx(zo,{})})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),p.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),p.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:p.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[Le(e.statementDueAmount)," ريال"]})}),p.jsxs("div",{className:"flex justify-between items-center text-xs",children:[p.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),p.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),p.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:p.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[p.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[p.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),p.jsxs("p",{className:"font-bold text-red-800 number-display",children:[Le(n.balance)," ريال"]})]}),p.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[p.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),p.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[Le(n.limit)," ريال"]})]}),p.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[p.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),p.jsxs("p",{className:"font-bold text-green-800 number-display",children:[Le(n.available)," ريال"]})]}),p.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[p.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),p.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),p.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[p.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),p.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:p.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${r(e.upcomingTransactions)}</tbody>`}})})]})]})},G6=({state:n,openCardFormModal:e,deleteCard:t})=>{const s=fe.useMemo(()=>{const o={};return Object.values(n.cards).forEach(u=>{const d=new Date,h=d.getDate(),f=d.getMonth(),_=d.getFullYear();let b,x,C;h>u.statementDay?b=new Date(_,f,u.statementDay):b=new Date(_,f-1,u.statementDay),x=new Date(b.getFullYear(),b.getMonth()-1,u.statementDay+1);let M=b.getMonth()+1,k=b.getFullYear();M>11&&(M=0,k+=1),C=new Date(k,M,u.dueDay);const V=n.transactions.filter(B=>{const K=new Date(B.postingDate||B.date);return B.paymentMethod===u.id&&(B.type==="expense"||B.type==="bnpl-payment")&&K>=x&&K<=b}),$=n.transactions.filter(B=>{const K=new Date(B.postingDate||B.date);return B.paymentMethod===u.id&&(B.type==="expense"||B.type==="bnpl-payment")&&K>b}),U=V.reduce((B,K)=>B+K.amount,0);o[u.id]={statementDueAmount:U,dueDate:C,totalOutstanding:0,upcomingTransactions:$}}),o},[n.transactions,n.cards]),r=Object.values(n.cards);return p.jsxs("div",{className:"space-y-6 animate-fade-in",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),p.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(o=>{let u=n.transactions.filter(h=>h.paymentMethod===o.id&&(h.type==="expense"||h.type==="bnpl-payment")).reduce((h,f)=>h+f.amount,0);n.transactions.forEach(h=>{h.type===`${o.id}-payment`&&(u-=h.amount)});const d={...o,balance:u,available:o.limit-u,usagePercentage:o.limit>0?u/o.limit*100:0};return p.jsx(z6,{card:d,statementDetails:s[d.id],openCardFormModal:e,deleteCard:t},d.id)})})]})},$6=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const s=n.replace("-payment","");if(e.cards[s])return`💳 سداد ${e.cards[s].name}`}return n},K6=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>p.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),p.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),p.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[p.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),p.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:p.jsx(zo,{})})]})]}),p.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[p.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),p.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:Le(n.balance)})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[p.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),p.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:Le(n.deposits)})]}),p.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[p.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),p.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:Le(n.withdrawals)})]})]})]}),Y6=({state:n,setState:e,calculations:t,filteredTransactions:s,categories:r,setModal:o,openBankAccountFormModal:u,deleteBankAccount:d,openTransferModal:h})=>p.jsxs("div",{className:"space-y-6 animate-fade-in",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),p.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&p.jsx("button",{onClick:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),p.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(f=>p.jsx(K6,{account:f,openBankAccountFormModal:u,deleteBankAccount:d},f.id))}),p.jsxs("div",{className:"glass-card p-6",children:[p.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full text-sm",children:[p.jsx("thead",{className:"border-b border-gray-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),p.jsx("tbody",{children:s.filter(f=>n.bankAccounts[f.paymentMethod]).sort((f,_)=>new Date(_.date).getTime()-new Date(f.date).getTime()).map(f=>{var C;const _=["income","investment-withdrawal"].includes(f.type),b=_?"text-emerald-500":"text-red-500",x=r.find(M=>M.id===f.categoryId);return p.jsxs("tr",{className:"border-b border-gray-200/50",children:[p.jsx("td",{className:"p-3",children:f.date}),p.jsx("td",{className:"p-3",children:(C=n.bankAccounts[f.paymentMethod])==null?void 0:C.name}),p.jsx("td",{className:"p-3",children:$6(f.type,n)}),p.jsxs("td",{className:`p-3 font-semibold ${b} number-display`,children:[_?"+":"-",Le(f.amount)]}),p.jsx("td",{className:"p-3",children:x?`${x.icon} ${x.name}`:"-"}),p.jsx("td",{className:"p-3 text-slate-500",children:f.description||"-"})]},f.id)})})]})})]})]}),Dd=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},J6=({state:n,setState:e,filteredTransactions:t,setModal:s})=>{const[r,o]=Yp.useState(!1),u=()=>{const U=n.installments.filter(N=>N.paid<N.total),B=U.filter(N=>N.provider==="tabby-bnpl"),K=U.filter(N=>N.provider==="tamara-bnpl"),se=B.reduce((N,D)=>{const w=D.total-D.paid;return N+D.installmentAmount*w},0),H=K.reduce((N,D)=>{const w=D.total-D.paid;return N+D.installmentAmount*w},0),R=se+H;return{tabbyTotal:se,tamaraTotal:H,grandTotal:R,activeCount:U.length,completedCount:n.installments.filter(N=>N.paid>=N.total).length}},d=()=>{const U=n.installments.filter(se=>se.paid<se.total);if(U.length===0)return null;const B=n.transactions.filter(se=>se.isInstallmentPayment);if(B.length===0){const se=U.sort((N,D)=>new Date(N.createdAt).getTime()-new Date(D.createdAt).getTime())[0],H=new Date(se.createdAt),R=new Date(H);return R.setDate(R.getDate()+30),R.toISOString().split("T")[0]}let K=null;for(const se of U){const H=B.filter(R=>R.installmentId===se.id).sort((R,N)=>new Date(N.date).getTime()-new Date(R.date).getTime());if(H.length>0){const R=H[0],N=new Date(R.date),D=new Date(N);D.setDate(D.getDate()+30),(!K||D<new Date(K))&&(K=D.toISOString().split("T")[0])}else{const R=new Date(se.createdAt),N=new Date(R);N.setDate(N.getDate()+30),(!K||N<new Date(K))&&(K=N.toISOString().split("T")[0])}}return K},h=()=>n.installments.filter(B=>B.paid<B.total).reduce((B,K)=>B+K.installmentAmount,0),f=()=>{const U=n.installments.filter(K=>K.paid<K.total),B=n.transactions.filter(K=>K.isInstallmentPayment);return U.map(K=>{const se=B.filter(R=>R.installmentId===K.id).sort((R,N)=>new Date(N.date).getTime()-new Date(R.date).getTime());let H;if(se.length>0){const R=se[0],N=new Date(R.date),D=new Date(N);D.setDate(D.getDate()+30),H=D.toISOString().split("T")[0]}else{const R=new Date(K.createdAt),N=new Date(R);N.setDate(N.getDate()+30),H=N.toISOString().split("T")[0]}return{installment:K,nextPaymentDate:H}}).sort((K,se)=>new Date(K.nextPaymentDate).getTime()-new Date(se.nextPaymentDate).getTime())},_=U=>{const B=n.transactions.find(H=>H.id===U);if(!B||!B.isInstallmentPayment||!n.installments.find(H=>H.id===B.installmentId))return;const se=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${B.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${B.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${B.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(H=>`<option value="${H.id}" ${B.paymentMethod===H.id?"selected":""}>🏦 ${H.name}</option>`).join("")}
                        <option value="cash" ${B.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(H=>`<option value="${H.id}" ${B.paymentMethod===H.id?"selected":""}>💳 ${H.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;s({show:!0,title:"تعديل حركة القسط",body:se,confirmText:"حفظ التعديلات",onConfirm:()=>{const H=parseFloat(document.getElementById("edit-amount").value),R=document.getElementById("edit-date").value,N=document.getElementById("edit-description").value,D=document.getElementById("edit-payment-method").value;e(w=>({...w,transactions:w.transactions.map(L=>L.id===U?{...L,amount:H,date:R,description:N,paymentMethod:D}:L)})),s({show:!1})}})},b=U=>{const B=n.transactions.find(se=>se.id===U);if(!B||!B.isInstallmentPayment)return;s({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const se=B.installmentId;e(H=>({...H,transactions:H.transactions.filter(R=>R.id!==U),installments:H.installments.map(R=>R.id===se?{...R,paid:Math.max(0,R.paid-1)}:R)})),s({show:!1})}})},x=U=>{const B=n.installments.find(se=>se.id===U);if(!B)return;const K=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${B.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${B.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${B.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${B.paid}" min="0" max="${B.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;s({show:!0,title:"تعديل خطة القسط",body:K,confirmText:"حفظ التعديلات",onConfirm:()=>{const se=document.getElementById("edit-description").value,H=parseFloat(document.getElementById("edit-amount").value),R=parseInt(document.getElementById("edit-total").value),N=parseInt(document.getElementById("edit-paid").value);e(D=>({...D,installments:D.installments.map(w=>w.id===U?{...w,description:se,installmentAmount:H,total:R,paid:N}:w)})),s({show:!1})}})},C=U=>{const B=n.installments.find(se=>se.id===U);if(!B)return;const K=`<p>هل أنت متأكد من حذف خطة القسط "${B.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;s({show:!0,title:"حذف خطة القسط",body:K,confirmText:"حذف",onConfirm:()=>{e(se=>({...se,installments:se.installments.filter(H=>H.id!==U),transactions:se.transactions.filter(H=>H.installmentId!==U)})),s({show:!1})}})},M=U=>{const B=n.installments.find(H=>H.id===U);if(!B||B.paid>=B.total)return;let K="";Object.values(n.bankAccounts).forEach(H=>{K+=`<option value="${H.id}">🏦 ${H.name}</option>`}),K+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(H=>{K+=`<option value="${H.id}">💳 ${H.name}</option>`});const se=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${B.description}" بقيمة ${Le(B.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${K}</select></div>`;s({show:!0,title:"سداد قسط",body:se,confirmText:"تأكيد الدفع",onConfirm:()=>{var w;const H=document.getElementById("installment-payment-source").value,R=n.categories.find(L=>L.name==="سداد فواتير"||L.name==="💳 سداد فواتير"),N=(R==null?void 0:R.id)||((w=n.categories.find(L=>L.name==="أخرى"))==null?void 0:w.id)||"",D={id:"trans-"+Date.now(),amount:B.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${B.paid+1} لـ: ${B.description}`,paymentMethod:H,type:"bnpl-payment",categoryId:N,isInstallmentPayment:!0,installmentId:U};e(L=>{const j=L.installments.map(O=>{if(O.id===U){const Pe={...O,paid:O.paid+1};return console.log("🔄 تحديث قسط:",{id:O.id,paid:O.paid,newPaid:Pe.paid,total:O.total}),Pe}return O});return{...L,transactions:[...L.transactions,D],installments:j}})}})},k=n.installments.filter(U=>U.paid<U.total),V=n.transactions.filter(U=>U.isInstallmentPayment),$=u();return d(),h(),p.jsxs("div",{className:"animate-fade-in",children:[p.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[p.jsx("div",{className:"flex justify-between items-start mb-4",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"ملخص الأقساط"}),p.jsx("p",{className:"text-sm text-slate-600",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[p.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx("span",{className:"text-2xl",children:"🎯"}),p.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),p.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Le($.grandTotal)})]}),p.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx("span",{className:"text-2xl",children:"📱"}),p.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),p.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le($.tabbyTotal)})]}),p.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsx("span",{className:"text-2xl",children:"📱"}),p.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),p.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le($.tamaraTotal)})]})]}),f().length>0&&p.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[p.jsx("span",{className:"text-2xl",children:"⏰"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),p.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),p.jsx("div",{className:"space-y-2",children:f().slice(0,3).map((U,B)=>p.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-medium text-slate-700",children:U.installment.description}),p.jsx("p",{className:"text-xs text-slate-500",children:Dd(U.installment.provider,n)})]}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(U.nextPaymentDate).toLocaleDateString("en-GB")}),p.jsx("p",{className:"text-xs text-slate-600",children:Le(U.installment.installmentAmount)})]})]},U.installment.id))})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{className:"flex gap-6",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-2xl font-bold text-blue-900",children:$.activeCount}),p.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),p.jsx("div",{className:"text-center",children:p.jsxs("button",{onClick:()=>o(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[p.jsx("p",{className:"text-2xl font-bold text-green-600",children:$.completedCount}),p.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),f().length>0&&p.jsx("button",{onClick:()=>{n.installments.filter(B=>B.paid<B.total).forEach(B=>{M(B.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),p.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900",children:"📱 خطط الأقساط النشطة"}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:k.length>0?k.map(U=>{const B=U.paid/U.total*100;return console.log("📊 عرض قسط:",{id:U.id,paid:U.paid,total:U.total,progress:B}),p.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"flex justify-between items-start mb-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-slate-900",children:U.description}),p.jsx("p",{className:"text-sm text-slate-500",children:Dd(U.provider,n)})]})]}),p.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:p.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[Le(U.installmentAmount),"/شهر"]})})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-gray-200 mb-3",children:[p.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:p.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${B}%`}})}),p.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[p.jsxs("span",{className:"font-medium",children:[U.paid," / ",U.total," مدفوع"]}),p.jsxs("span",{className:"font-medium",children:["متبقي: ",U.total-U.paid]})]}),p.jsx("div",{className:"text-center mt-2",children:p.jsxs("span",{className:"text-xs text-slate-500",children:[B.toFixed(1),"% مكتمل"]})})]}),p.jsxs("div",{className:"flex gap-2 mt-3",children:[p.jsx("button",{onClick:()=>M(U.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),p.jsx("button",{onClick:()=>x(U.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),p.jsx("button",{onClick:()=>C(U.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},U.id)}):p.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:p.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),p.jsxs("div",{className:"glass-card p-6 mt-8",children:[p.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 سجل دفعات الأقساط"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full text-sm",children:[p.jsx("thead",{className:"border-b border-gray-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"المصدر"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),p.jsx("th",{className:"text-right p-3 font-semibold",children:"الإجراءات"})]})}),p.jsx("tbody",{children:V.sort((U,B)=>new Date(B.date).getTime()-new Date(U.date).getTime()).map(U=>p.jsxs("tr",{className:"border-b border-gray-200/50",children:[p.jsx("td",{className:"p-3",children:new Date(U.date).toLocaleDateString("en-GB")}),p.jsx("td",{className:"p-3 text-slate-600",children:U.description}),p.jsx("td",{className:"p-3",children:Dd(U.paymentMethod,n)}),p.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:Le(U.amount)}),p.jsx("td",{className:"p-3",children:p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>_(U.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),p.jsx("button",{onClick:()=>b(U.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},U.id))})]})})]}),r&&p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:U=>U.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),p.jsx("button",{onClick:()=>o(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),p.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(U=>U.paid>=U.total).map(U=>p.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[p.jsxs("div",{className:"flex justify-between items-start mb-2",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-green-800",children:U.description}),p.jsx("p",{className:"text-sm text-green-600",children:Dd(U.provider,n)})]}),p.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[p.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[p.jsx("p",{className:"text-green-700 font-bold text-lg",children:U.total}),p.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),p.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[p.jsx("p",{className:"text-green-700 font-bold text-lg",children:Le(U.installmentAmount)}),p.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),p.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[p.jsx("p",{className:"text-green-700 font-bold text-lg",children:Le(U.total*U.installmentAmount)}),p.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},U.id)),Object.values(n.installments).filter(U=>U.paid>=U.total).length===0&&p.jsxs("div",{className:"text-center py-12 text-slate-500",children:[p.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),p.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),p.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),p.jsx("div",{className:"flex justify-end mt-6",children:p.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},wx=({onClose:n,onSave:e,initialData:t,type:s,darkMode:r=!1,language:o="ar"})=>{const[u,d]=fe.useState({[s==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[h,f]=fe.useState({});Yp.useEffect(()=>{t&&d(t)},[t]);const _=M=>{const{name:k,value:V}=M.target;d($=>({...$,[k]:k==="amount"?parseFloat(V)||0:V})),h[k]&&f($=>({...$,[k]:""}))},b=()=>{const M={};return u[s==="toMe"?"debtor":"creditor"]||(M[s==="toMe"?"debtor":"creditor"]="اسم المدين/الدائن مطلوب"),u.amount<=0&&(M.amount="المبلغ يجب أن يكون أكبر من صفر"),u.description.trim()||(M.description="وصف الدين مطلوب"),u.date||(M.date="تاريخ الدين مطلوب"),f(M),Object.keys(M).length===0},x=M=>{M.preventDefault(),b()&&e(u,t==null?void 0:t.id)},C=s==="toMe";return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:p.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:M=>M.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:C?"إضافة دين لي":"إضافة دين علي"}),p.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:p.jsx(Wu,{})})]}),p.jsxs("form",{onSubmit:x,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:C?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:C?"اسم المدين":"اسم الدائن"}),p.jsx("input",{type:"text",id:C?"debtor":"creditor",name:C?"debtor":"creditor",value:u[C?"debtor":"creditor"],onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:C?"اسم الشخص الذي يدين لي":"اسم الشخص الذي أدين له",required:!0}),h[C?"debtor":"creditor"]&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h[C?"debtor":"creditor"]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ"}),p.jsx("input",{type:"number",id:"amount",name:"amount",value:u.amount,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),h.amount&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.amount})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:C?"من أين دينني":"أين أضفت الدين"}),p.jsx("input",{type:"text",id:"source",name:"source",value:u.source,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:C?"مثال: بنك الراجحي، تطبيق ستور":"مثال: بنك الأهلي، تطبيق تابي"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"السبب (اختياري)"}),p.jsx("textarea",{id:"reason",name:"reason",value:u.reason,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"سبب الدين أو تفاصيل إضافية..."})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"وصف الدين"}),p.jsx("input",{type:"text",id:"description",name:"description",value:u.description,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف مختصر للدين",required:!0}),h.description&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.description})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ الدين"}),p.jsx("input",{type:"date",id:"date",name:"date",value:u.date,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),h.date&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.date})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"الحالة"}),p.jsxs("select",{id:"status",name:"status",value:u.status,onChange:_,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[p.jsx("option",{value:"pending",children:"معلق"}),p.jsx("option",{value:"partial",children:"جزئي"}),p.jsx("option",{value:"paid",children:"مدفوع"})]})]}),p.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[p.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),p.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"إضافة الدين"})]})]})]})})})},Q6=({state:n,setState:e,setModal:t,openLoanFormModal:s,darkMode:r=!1,language:o="ar"})=>{const[u,d]=fe.useState("loans"),[h,f]=fe.useState(!1),[_,b]=fe.useState(!1),[x,C]=fe.useState(!1),M=w=>{switch(w){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},k=w=>{switch(w){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},V=w=>{switch(w){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},$=w=>{switch(w){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},U=w=>{e(L=>({...L,loans:Object.fromEntries(Object.entries(L.loans).filter(([j])=>j!==w))}))},B=w=>{const L={...w,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(j=>({...j,debtsToMe:{...j.debtsToMe,[L.id]:L}})),b(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين من "${L.debtor}" بقيمة ${Le(L.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},K=w=>{const L={...w,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(j=>({...j,debtsFromMe:{...j.debtsFromMe,[L.id]:L}})),C(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين لـ "${L.creditor}" بقيمة ${Le(L.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},se=w=>{e(L=>({...L,debtsToMe:Object.fromEntries(Object.entries(L.debtsToMe).filter(([j])=>j!==w))}))},H=w=>{e(L=>({...L,debtsFromMe:Object.fromEntries(Object.entries(L.debtsFromMe).filter(([j])=>j!==w))}))},R=Object.values(n.loans).filter(w=>w.status==="active").length,N=Object.values(n.debtsToMe).filter(w=>w.status!=="paid").length,D=Object.values(n.debtsFromMe).filter(w=>w.status!=="paid").length;return p.jsxs("div",{className:"space-y-6 animate-fade-in",children:[p.jsx("div",{className:"flex justify-between items-center",children:p.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"📊 الديون والقروض"})}),p.jsxs("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[p.jsxs("button",{onClick:()=>d("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="loans"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["🏦 القروض (",R,")"]}),p.jsxs("button",{onClick:()=>d("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-to-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💰 الديون لي (",N,")"]}),p.jsxs("button",{onClick:()=>d("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-from-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💸 الديون علي (",D,")"]})]}),u==="loans"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),p.jsx("button",{onClick:()=>s(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?p.jsxs("div",{className:"text-center py-12 text-slate-500",children:[p.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),p.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),p.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(w=>p.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:p.jsx("span",{className:"text-blue-600 text-xl",children:M(w.type)})}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-lg font-bold text-slate-900",children:w.name}),p.jsxs("p",{className:"text-sm text-slate-500",children:[k(w.type)," - ",w.lender]})]})]}),p.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[p.jsx("button",{onClick:()=>s(w.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${w.name}`,children:"✏️"}),p.jsx("button",{onClick:()=>U(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${w.name}`,children:p.jsx(zo,{})})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),p.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le(w.totalAmount)})]}),(w.prepaidAmount||0)>0&&p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[p.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[p.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),p.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((w.prepaidAmount||0)/w.totalAmount*100),"%"]})]}),p.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:p.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(w.prepaidAmount||0)/w.totalAmount*100}%`}})}),p.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[p.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[p.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((w.prepaidAmount||0)/w.monthlyPayment)}),p.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),p.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[p.jsx("p",{className:"text-blue-700 font-bold text-sm",children:w.totalMonths-Math.floor((w.prepaidAmount||0)/w.monthlyPayment)}),p.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),p.jsx("p",{className:"font-semibold text-slate-800",children:Le(w.monthlyPayment)})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),p.jsxs("p",{className:"font-semibold text-slate-800",children:[w.remainingMonths||0," شهر"]})]})]}),(w.prepaidAmount||0)>0&&p.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),p.jsx("p",{className:"text-orange-900 font-bold text-lg",children:Le(w.prepaidAmount||0)})]}),p.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),p.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(w.status)}`,children:$(w.status)}),p.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(w.startDate).toLocaleDateString("en-GB")]})]})]})]},w.id))})]}),u==="debts-to-me"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),p.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?p.jsxs("div",{className:"text-center py-12 text-slate-500",children:[p.jsx("div",{className:"text-6xl mb-4",children:"💰"}),p.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),p.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(w=>p.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"text-lg font-bold text-slate-900",children:w.debtor}),p.jsx("p",{className:"text-sm text-slate-500",children:w.description})]}),p.jsx("button",{onClick:()=>se(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${w.debtor}`,children:p.jsx(zo,{})})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),p.jsx("p",{className:"text-xl font-bold text-green-900",children:Le(w.amount)})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(w.status)}`,children:$(w.status)}),p.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(w.date).toLocaleDateString("ar-SA")]})]})]})]},w.id))})]}),u==="debts-from-me"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),p.jsx("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?p.jsxs("div",{className:"text-center py-12 text-slate-500",children:[p.jsx("div",{className:"text-6xl mb-4",children:"💸"}),p.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),p.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(w=>p.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"text-lg font-bold text-slate-900",children:w.creditor}),p.jsx("p",{className:"text-sm text-slate-500",children:w.description})]}),p.jsx("button",{onClick:()=>H(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${w.creditor}`,children:p.jsx(zo,{})})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[p.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),p.jsx("p",{className:"text-xl font-bold text-red-900",children:Le(w.amount)})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(w.status)}`,children:$(w.status)}),p.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(w.date).toLocaleDateString("ar-SA")]})]})]})]},w.id))})]}),_&&p.jsx(wx,{onClose:()=>b(!1),onSave:B,type:"toMe"}),x&&p.jsx(wx,{onClose:()=>C(!1),onSave:K,type:"fromMe"})]})},X6=(n,e="ar")=>({ar:{add:"إضافة",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",close:"إغلاق",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",backup:"نسخ احتياطي",restore:"استعادة","toggle-dark-mode":"تبديل الوضع المظلم","toggle-language":"تبديل اللغة","toggle-notifications":"تبديل الإشعارات","open-menu":"فتح القائمة","close-menu":"إغلاق القائمة","next-page":"الصفحة التالية","previous-page":"الصفحة السابقة","sort-ascending":"ترتيب تصاعدي","sort-descending":"ترتيب تنازلي",expand:"توسيع",collapse:"طي","show-details":"إظهار التفاصيل","hide-details":"إخفاء التفاصيل"},en:{add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",backup:"Backup",restore:"Restore","toggle-dark-mode":"Toggle dark mode","toggle-language":"Toggle language","toggle-notifications":"Toggle notifications","open-menu":"Open menu","close-menu":"Close menu","next-page":"Next page","previous-page":"Previous page","sort-ascending":"Sort ascending","sort-descending":"Sort descending",expand:"Expand",collapse:"Collapse","show-details":"Show details","hide-details":"Hide details"}})[e][n]||n,va=({children:n,action:e,language:t="ar",variant:s="primary",size:r="md",loading:o=!1,icon:u,iconPosition:d="left",className:h="",disabled:f,..._})=>{const b="inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",x={sm:"px-3 py-1.5 text-sm min-h-[36px]",md:"px-4 py-2 text-base min-h-[44px]",lg:"px-6 py-3 text-lg min-h-[52px]"},C={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-md hover:shadow-lg",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500 shadow-sm hover:shadow-md",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-md hover:shadow-lg",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500"},M=`${b} ${x[r]} ${C[s]} ${h}`;return p.jsx("button",{className:M,"aria-label":X6(e,t),disabled:f||o,..._,children:o?p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent"}):p.jsxs(p.Fragment,{children:[u&&d==="left"&&p.jsx("span",{className:"mr-2",children:u}),n,u&&d==="right"&&p.jsx("span",{className:"ml-2",children:u})]})})},W6=({label:n,error:e,helperText:t,language:s="ar",icon:r,className:o="",id:u,...d})=>{const h=u||`input-${Math.random().toString(36).substr(2,9)}`,f=e?`${h}-error`:void 0,_=t?`${h}-helper`:void 0,b="block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:text-gray-500",x=e?"border-red-300 focus:ring-red-500 focus:border-red-500":"",C=r?"pl-10":"";return p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700",children:n}),p.jsxs("div",{className:"relative",children:[r&&p.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:p.jsx("span",{className:"text-gray-400",children:r})}),p.jsx("input",{id:h,className:`${b} ${x} ${C} ${o}`,"aria-invalid":e?"true":"false","aria-describedby":[f,_].filter(Boolean).join(" ")||void 0,...d})]}),e&&p.jsx("p",{id:f,className:"text-sm text-red-600",role:"alert",children:e}),t&&!e&&p.jsx("p",{id:_,className:"text-sm text-gray-500",children:t})]})},Z6=({state:n,setState:e,darkMode:t,language:s})=>{const{t:r}=gf(),[o,u]=fe.useState(""),[d,h]=fe.useState(!1),[f,_]=fe.useState("idle");fe.useEffect(()=>{const K=localStorage.getItem("gemini-api-key");K&&u(K)},[]);const b=async()=>{_("loading");try{localStorage.setItem("gemini-api-key",o),_("success"),o&&setTimeout(()=>_("idle"),2e3)}catch{_("error"),setTimeout(()=>_("idle"),3e3)}},x=()=>{localStorage.removeItem("gemini-api-key"),u(""),h(!1)},C=()=>{const K=JSON.stringify(n,null,2),se=new Blob([K],{type:"application/json"}),H=URL.createObjectURL(se),R=document.createElement("a");R.href=H,R.download=`masrof-backup-${new Date().toISOString().split("T")[0]}.json`,R.click(),URL.revokeObjectURL(H)},M=K=>{var R;const se=(R=K.target.files)==null?void 0:R[0];if(!se)return;const H=new FileReader;H.onload=N=>{var D;try{const w=JSON.parse((D=N.target)==null?void 0:D.result);e(w),alert(r("messages.dataImported"))}catch{alert(r("messages.errorLoading"))}},H.readAsText(se)},k=()=>{confirm(r("messages.confirmDelete"))&&(localStorage.clear(),window.location.reload())},V=()=>{e(K=>({...K,settings:{...K.settings,darkMode:!K.settings.darkMode}}))},$=()=>{e(K=>({...K,settings:{...K.settings,language:K.settings.language==="ar"?"en":"ar"}}))},U=()=>{e(K=>({...K,settings:{...K.settings,notifications:!K.settings.notifications}}))},B=o?"*".repeat(Math.min(o.length,20))+o.slice(-4):"";return p.jsx("div",{className:`p-6 space-y-8 ${t?"bg-slate-900 text-slate-100":"bg-white text-slate-900"}`,children:p.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[p.jsxs("div",{className:"text-center",children:[p.jsx("h1",{className:"text-3xl font-bold mb-2",children:r("settings.title")}),p.jsxs("p",{className:"text-slate-600 dark:text-slate-400",children:[r("settings.general")," - ",r("settings.appearance")," - ",r("settings.data")]})]}),p.jsxs("div",{className:`glass-card p-6 ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:r("settings.appearance")}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium",children:r("header.darkMode")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r(t?"settings.dark":"settings.light")})]}),p.jsx(Nx,{darkMode:t,onToggle:V})]}),p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium",children:r("settings.language")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:s==="ar"?"العربية":"English"})]}),p.jsx(va,{action:"toggle-language",language:s,variant:"secondary",onClick:$,className:"min-w-[120px]",children:s==="ar"?"English":"العربية"})]})]})]}),p.jsxs("div",{className:`glass-card p-6 ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:r("settings.notifications")}),p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium",children:r("header.enableNotifications")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r("settings.notificationTypes")})]}),p.jsx(Rx,{enabled:n.settings.notifications,onToggle:U,language:s})]})})]}),p.jsxs("div",{className:`glass-card p-6 ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:r("settings.apiKeys")}),p.jsx("div",{className:"space-y-6",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium mb-2",children:r("settings.geminiApiKey")}),p.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:[r("settings.apiStatus"),": ",o?"✅ "+r("app.active"):"❌ "+r("app.inactive")]})]}),p.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[p.jsx("div",{className:"flex-1",children:d?p.jsx(W6,{label:r("settings.geminiApiKey"),type:"password",value:o,onChange:K=>u(K.target.value),placeholder:r("forms.enterAmount"),language:s}):p.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[p.jsx("span",{className:"font-mono text-sm bg-slate-100 dark:bg-slate-700 px-3 py-2 rounded border",children:B||r("app.no")}),p.jsx(va,{action:"show-details",language:s,variant:"ghost",size:"sm",onClick:()=>h(!d),children:r(d?"app.hide":"app.show")})]})}),p.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[p.jsx(va,{action:"save",language:s,variant:"primary",onClick:b,loading:f==="loading",disabled:!o.trim(),children:r("settings.saveApiKey")}),o&&p.jsx(va,{action:"delete",language:s,variant:"danger",onClick:x,children:r("app.delete")})]})]}),f==="success"&&p.jsx("p",{className:"text-green-600 text-sm",children:r("settings.apiKeySaved")}),f==="error"&&p.jsx("p",{className:"text-red-600 text-sm",children:r("settings.apiKeyError")})]})})]}),p.jsxs("div",{className:`glass-card p-6 ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:r("settings.data")}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium",children:r("settings.exportData")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r("settings.dataBackup")})]}),p.jsx(va,{action:"export",language:s,variant:"secondary",onClick:C,children:r("settings.exportData")})]}),p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium",children:r("settings.importData")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r("messages.confirmRestore")})]}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"file",accept:".json",onChange:M,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer","aria-label":r("settings.importData")}),p.jsx(va,{action:"import",language:s,variant:"secondary",children:r("settings.importData")})]})]}),p.jsxs("div",{className:"flex items-center justify-between border-t pt-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-red-600",children:r("settings.deleteAllData")}),p.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:r("settings.deleteWarning")})]}),p.jsx(va,{action:"delete",language:s,variant:"danger",onClick:k,children:r("settings.deleteAllData")})]})]})]}),p.jsxs("div",{className:`glass-card p-6 ${t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"}`,children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:r("settings.about")}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:r("settings.version")}),p.jsx("span",{className:"font-medium",children:"1.0.0"})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:r("settings.developer")}),p.jsx("span",{className:"font-medium",children:"K.A Team"})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:r("settings.support")}),p.jsx("span",{className:"font-medium",children:"support@masrof.com"})]})]})]})]})})},e3=({onClose:n,onSave:e,initialData:t,categories:s,cards:r,bankAccounts:o,loans:u,setModalConfig:d,darkMode:h=!1,language:f="ar"})=>{var Z;const[_,b]=fe.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(o)[0]||"cash",type:"expense",categoryId:((Z=s.find(Q=>Q.name==="أخرى"))==null?void 0:Z.id)||null}),[x,C]=fe.useState(!1),[M,k]=fe.useState(""),[V,$]=fe.useState({isOpen:!1,text:""}),[U,B]=fe.useState(!1),[K,se]=fe.useState(!1),[H,R]=fe.useState(4),[N,D]=fe.useState(Object.keys(o)[0]||"cash");fe.useEffect(()=>{var Q;t?b(t):(Q=navigator.clipboard)!=null&&Q.readText&&(async()=>{try{const he=await navigator.clipboard.readText();he&&he.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==he&&$({isOpen:!0,text:he})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const w=Q=>{const{name:he,value:Ae}=Q.target;if(he==="paymentMethod"){const Ce=Ae.includes("bnpl");se(Ce),Ce&&b(q=>({...q,type:"expense"}))}b(Ce=>({...Ce,[he]:he==="amount"?parseFloat(Ae):Ae}))},L=Q=>{if(Q.preventDefault(),_.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(Ae=>Ae.status==="active").length>0){B(!0);return}K&&_.paymentMethod.includes("bnpl")?e({..._,bnplData:{installmentsCount:H,initialPaymentSource:N,installmentAmount:_.amount/H}},t==null?void 0:t.id):e(_,t==null?void 0:t.id)},j=async Q=>{if(Q.trim()){C(!0),k("");try{const he=await h2(Q,s,r,o),Ae=JSON.parse(he);Ae.error?k(Ae.error):b(Ce=>({...Ce,amount:Ae.amount||Ce.amount,date:Ae.date||Ce.date,description:Ae.merchant||Ce.description,paymentMethod:Ae.paymentMethod||Ce.paymentMethod,categoryId:Ae.categoryId||Ce.categoryId}))}catch(he){k(he instanceof Error?he.message:Lt("unknown.error",f)),console.error(he)}finally{C(!1)}}},O=async()=>{k("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){k("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const Q=await navigator.clipboard.readText();Q&&Q.trim().length>0?j(Q):k("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(Q){console.error("Clipboard operation failed: ",Q),k("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},Pe=fe.useMemo(()=>{const Q=[{value:"cash",label:"💵 نقدي"}];return Object.values(o).forEach(he=>Q.push({value:he.id,label:`🏦 ${he.name}`})),Object.values(r).forEach(he=>Q.push({value:he.id,label:`💳 ${he.name}`})),Q.push({value:"tabby-bnpl",label:"📱 تابي"}),Q.push({value:"tamara-bnpl",label:"📱 تمارا"}),Q},[o,r]),We=fe.useMemo(()=>{const Q=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(r).forEach(he=>Q.push({value:`${he.id}-payment`,label:`💳 سداد ${he.name}`})),Q},[r]);return p.jsxs(p.Fragment,{children:[V.isOpen&&p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>$({isOpen:!1,text:""}),children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Q=>Q.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),p.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),p.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:V.text}),p.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[p.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",V.text),$({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),p.jsx("button",{onClick:()=>{$({isOpen:!1,text:""}),j(V.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Q=>Q.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),p.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:p.jsx(Wu,{})})]}),p.jsxs("button",{type:"button",onClick:O,disabled:x,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[p.jsx(S6,{}),p.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),x&&p.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[p.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),p.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),M&&p.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:M}),p.jsxs("form",{onSubmit:L,className:"space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),p.jsx("input",{type:"number",name:"amount",value:_.amount,onChange:w,className:"w-full",required:!0,step:"0.01"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),p.jsx("input",{type:"date",name:"date",value:_.date,onChange:w,className:"w-full",required:!0})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),p.jsx("input",{type:"text",name:"description",value:_.description,onChange:w,className:"w-full",required:!0})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),p.jsx("select",{name:"type",value:_.type,onChange:w,className:"w-full",children:We.map(Q=>p.jsx("option",{value:Q.value,children:Q.label},Q.value))})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),p.jsx("select",{name:"paymentMethod",value:_.paymentMethod,onChange:w,className:"w-full",children:Pe.map(Q=>p.jsx("option",{value:Q.value,children:Q.label},Q.value))})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),p.jsxs("select",{name:"categoryId",value:_.categoryId||"",onChange:w,className:"w-full",children:[p.jsx("option",{value:"",children:"-- اختر فئة --"}),s.map(Q=>p.jsxs("option",{value:Q.id,children:[Q.icon," ",Q.name]},Q.id))]})]}),K&&p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[p.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),p.jsxs("select",{value:H,onChange:Q=>R(parseInt(Q.target.value)),className:"w-full",children:[p.jsx("option",{value:2,children:"قسطين (2)"}),p.jsx("option",{value:3,children:"3 أقساط"}),p.jsx("option",{value:4,children:"4 أقساط"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),p.jsx("select",{value:N,onChange:Q=>D(Q.target.value),className:"w-full",children:Pe.filter(Q=>!Q.value.includes("bnpl")).map(Q=>p.jsx("option",{value:Q.value,children:Q.label},Q.value))})]})]}),p.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:p.jsxs("p",{className:"text-sm text-blue-700",children:[p.jsx("strong",{children:"الدفعة الأولى:"})," ",(_.amount/H).toFixed(2)," ريال",p.jsx("br",{}),p.jsx("strong",{children:"المبلغ المتبقي:"})," ",(_.amount*(H-1)/H).toFixed(2)," ريال"]})})]}),p.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),U&&p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Q=>Q.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),p.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),p.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(Q=>Q.status==="active").map(Q=>p.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:p.jsx("div",{className:"flex justify-between items-center",children:p.jsxs("div",{children:[p.jsx("p",{className:"font-semibold text-blue-800",children:Q.name}),p.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",Q.monthlyPayment.toLocaleString()," ريال"]})]})})},Q.id))}),p.jsxs("div",{className:"flex justify-end gap-3",children:[p.jsx("button",{onClick:()=>{B(!1),e(_,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),p.jsx("button",{onClick:()=>{B(!1);const Q=Object.values(u).filter(Ce=>Ce.status==="active"),he=Q.reduce((Ce,q)=>Ce+q.monthlyPayment,0),Ae={..._};Q.map(Ce=>({id:`trans-${Date.now()}-loan-${Ce.id}`,amount:Ce.monthlyPayment,date:_.date,description:`قسط شهري - ${Ce.name}`,paymentMethod:_.paymentMethod,type:"expense",categoryId:null})),e(Ae,t==null?void 0:t.id),d({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${he.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},t3=({onClose:n,onSave:e,initialData:t,darkMode:s=!1,language:r="ar"})=>{var f;const[o,u]=fe.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});fe.useEffect(()=>{t&&u(t)},[t]);const d=_=>{const{name:b,value:x,type:C}=_.target;u(b==="smsSamples"?M=>({...M,smsSamples:x.split(",").map(k=>k.trim()).filter(Boolean)}):M=>({...M,[b]:C==="number"?parseFloat(x)||0:x}))},h=_=>{_.preventDefault(),e(o,t==null?void 0:t.id)};return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:_=>_.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),p.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:p.jsx(Wu,{})})]}),p.jsxs("form",{onSubmit:h,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),p.jsx("input",{type:"text",name:"name",value:o.name,onChange:d,className:"w-full p-2",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),p.jsx("input",{type:"number",name:"limit",value:o.limit,onChange:d,className:"w-full p-2",required:!0,step:"100"})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),p.jsx("input",{type:"number",name:"statementDay",value:o.statementDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),p.jsx("input",{type:"number",name:"dueDay",value:o.dueDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),p.jsx("input",{type:"text",name:"smsSamples",value:((f=o.smsSamples)==null?void 0:f.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),p.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),p.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},n3=({onClose:n,onSave:e,initialData:t,darkMode:s=!1,language:r="ar"})=>{var f;const[o,u]=fe.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});fe.useEffect(()=>{t&&u(t)},[t]);const d=_=>{const{name:b,value:x,type:C}=_.target;u(b==="smsSamples"?M=>({...M,smsSamples:x.split(",").map(k=>k.trim()).filter(Boolean)}):M=>({...M,[b]:C==="number"?parseFloat(x)||0:x}))},h=_=>{_.preventDefault(),e(o,t==null?void 0:t.id)};return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:p.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:_=>_.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),p.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:p.jsx(Wu,{})})]}),p.jsxs("form",{onSubmit:h,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),p.jsx("input",{type:"text",name:"name",value:o.name,onChange:d,className:"w-full p-2",required:!0})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),p.jsx("input",{type:"number",name:"balance",value:o.balance,onChange:d,className:"w-full p-2",required:!0,step:"10"})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),p.jsxs("select",{name:"currency",value:o.currency||"SAR",onChange:d,className:"w-full p-2",required:!0,children:[p.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),p.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),p.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),p.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),p.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),p.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),p.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),p.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),p.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),p.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),p.jsx("input",{type:"text",name:"smsSamples",value:((f=o.smsSamples)==null?void 0:f.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),p.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),p.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},s3=({onClose:n,onSave:e,initialData:t,bankAccounts:s,darkMode:r=!1,language:o="ar"})=>{const[u,d]=fe.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[h,f]=fe.useState({});fe.useEffect(()=>{t&&d(t)},[t]),fe.useEffect(()=>{if(u.totalAmount>0&&u.downPayment>=0&&u.finalPayment>=0&&u.monthlyPayment>0){const k=u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0);if(k>0){const V=Math.ceil(k/u.monthlyPayment),$=new Date(u.startDate),U=new Date($);U.setMonth(U.getMonth()+V),d(B=>({...B,totalMonths:V,endDate:U.toISOString().split("T")[0],remainingMonths:V}))}}},[u.totalAmount,u.downPayment,u.finalPayment,u.monthlyPayment,u.startDate,u.prepaidAmount]),fe.useEffect(()=>{if(u.prepaidAmount&&u.monthlyPayment>0){const k=Math.floor(u.prepaidAmount/u.monthlyPayment);d(V=>({...V,prepaidInstallments:k}))}else d(k=>({...k,prepaidInstallments:0}))},[u.prepaidAmount,u.monthlyPayment]);const _=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],b=k=>{const{name:V,value:$}=k.target;d(U=>({...U,[V]:V.includes("Amount")||V.includes("Payment")||V.includes("Months")?parseFloat($)||0:$})),h[V]&&f(U=>({...U,[V]:""}))},x=()=>{const k={};return u.name.trim()||(k.name="اسم القرض مطلوب"),u.totalAmount<=0&&(k.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),u.downPayment<0&&(k.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),u.finalPayment<0&&(k.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),u.monthlyPayment<=0&&(k.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),u.lender.trim()||(k.lender="اسم البنك أو المؤسسة مطلوب"),u.startDate||(k.startDate="تاريخ بداية القرض مطلوب"),u.downPayment+u.finalPayment>=u.totalAmount&&(k.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),f(k),Object.keys(k).length===0},C=k=>{if(k.preventDefault(),!x())return;const V={...u,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(V)},M=Object.values(s).map(k=>({value:k.id,label:`${k.name} (${k.currency})`}));return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:p.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),p.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:p.jsx(Wu,{})})]}),p.jsxs("form",{onSubmit:C,className:"space-y-6",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),p.jsx("select",{id:"type",name:"type",value:u.type,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:_.map(k=>p.jsxs("option",{value:k.value,children:[k.icon," ",k.label]},k.value))})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),p.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),h.name&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.name})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),p.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:u.totalAmount,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),h.totalAmount&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.totalAmount})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),p.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:u.downPayment,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),h.downPayment&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.downPayment})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),p.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:u.finalPayment,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),h.finalPayment&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.finalPayment})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),p.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:u.monthlyPayment,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),h.monthlyPayment&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.monthlyPayment})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),p.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:u.prepaidAmount||0,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),p.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(u.prepaidAmount||0)>0&&p.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[p.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",u.prepaidInstallments||0," قسط"]}),p.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0))," ريال"]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),p.jsx("input",{type:"date",id:"startDate",name:"startDate",value:u.startDate,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),h.startDate&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.startDate})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),p.jsx("input",{type:"date",id:"endDate",name:"endDate",value:u.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),p.jsx("input",{type:"text",id:"lender",name:"lender",value:u.lender,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),h.lender&&p.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.lender})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),p.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:u.linkedAccount,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[p.jsx("option",{value:"",children:"اختر حساب بنكي"}),M.map(k=>p.jsx("option",{value:k.value,children:k.label},k.value))]})]})]}),u.totalMonths>0&&p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[p.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),p.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.totalMonths," شهر"]})]}),p.jsxs("div",{children:[p.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),p.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.remainingMonths," شهر"]})]})]})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[p.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),p.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},i3=()=>{var Fa,zr,Gr,$r,Sn;const{t:n,i18n:e}=gf(),[t,s]=fe.useState(!1),[r,o]=fe.useState(xd),[u,d]=fe.useState(new Date().getFullYear()),[h,f]=fe.useState(new Date().getMonth()+1),[_,b]=fe.useState("summary"),[x,C]=fe.useState({isLoading:!1,text:""}),[M,k]=fe.useState(null),[V,$]=fe.useState({isOpen:!1}),[U,B]=fe.useState({isOpen:!1}),[K,se]=fe.useState({isOpen:!1}),[H,R]=fe.useState({isOpen:!1}),[N,D]=fe.useState({isOpen:!1}),[w,L]=fe.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[j,O]=fe.useState(!1),[Pe,We]=fe.useState(""),[Z,Q]=fe.useState(null),[he,Ae]=fe.useState(!1),[Ce,q]=fe.useState(!0);fe.useEffect(()=>{(async()=>{d2();const ue=await Ta.onAuthStateChanged(async ce=>{try{ce?(console.log("✅ تم تسجيل دخول المستخدم:",ce.email),Q(ce),await re(ce.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),Q(null),await me())}catch(ge){console.error("خطأ في تحميل بيانات المستخدم:",ge),await me()}finally{q(!1),s(!0)}});return()=>{typeof ue=="function"&&ue()}})()},[]),fe.useEffect(()=>(V.isOpen||U.isOpen||K.isOpen||H.isOpen||N.isOpen||M||x.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[V.isOpen,U.isOpen,K.isOpen,H.isOpen,N.isOpen,M,x.isLoading]),fe.useEffect(()=>{r.settings.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const G=document.documentElement;r.settings.language==="ar"?(G.setAttribute("lang","ar"),G.setAttribute("dir","rtl")):(G.setAttribute("lang","en"),G.setAttribute("dir","ltr")),e.changeLanguage(r.settings.language)},[r.settings.darkMode,r.settings.language,e]),fe.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(G=>{console.log("Service Worker registered successfully:",G)}).catch(G=>{console.log("Service Worker registration failed:",G)})},[]),fe.useEffect(()=>{var G,ue;N.isOpen&&w.fromAccount&&w.toAccount&&((G=r.bankAccounts[w.fromAccount])==null?void 0:G.currency)!==((ue=r.bankAccounts[w.toAccount])==null?void 0:ue.currency)&&zi()},[w.fromAccount,w.toAccount,N.isOpen]);const re=async G=>{var ue;try{const ce=await Ta.getData("users",G);if(ce.success&&ce.data){const ge=xd(),_e={...ge,...ce.data,cards:{...ge.cards,...ce.data.cards||{}},bankAccounts:{...ge.bankAccounts,...ce.data.bankAccounts||{}},investments:{...ge.investments,...ce.data.investments||{}}};o(_e),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else ce.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",ce.error),(ue=ce.error)!=null&&ue.includes("الأذونات")&&k({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(ce){console.error("خطأ في تحميل بيانات المستخدم:",ce)}},me=async()=>{try{const G=["financial_dashboard_state","financial_dashboard_backup_1","financial_dashboard_backup_2"];for(let ge=0;ge<7;ge++){const _e=new Date;_e.setDate(_e.getDate()-ge);const ze=_e.toISOString().split("T")[0];G.push(`financial_dashboard_${ze}`)}let ue=null,ce="";for(const ge of G){const _e=localStorage.getItem(ge);if(_e)try{JSON.parse(_e),ue=_e,ce=ge;break}catch{console.warn(`⚠️ بيانات تالفة في ${ge}`)}}if(ue){const ge=JSON.parse(ue),_e=xd(),ze={..._e,...ge,cards:{..._e.cards,...ge.cards||{}},bankAccounts:{..._e.bankAccounts,...ge.bankAccounts||{}},investments:{..._e.investments,...ge.investments||{}}};o(ze),console.log(`✅ تم تحميل البيانات بنجاح من: ${ce}`)}else console.log("ℹ️ لم توجد بيانات محفوظة، سيتم استخدام البيانات الافتراضية")}catch(G){console.error("❌ خطأ في تحميل البيانات المحلية:",G)}};fe.useEffect(()=>{if(t&&!Ce){try{const G=JSON.stringify(r);localStorage.setItem("financial_dashboard_state",G),localStorage.setItem("financial_dashboard_backup_1",G),localStorage.setItem("financial_dashboard_backup_2",G);const ue=new Date().toISOString();localStorage.setItem(`financial_dashboard_${ue.split("T")[0]}`,G),console.log("✅ تم حفظ البيانات في localStorage مع نسخ احتياطية متعددة")}catch(G){console.error("❌ خطأ في حفظ البيانات:",G)}if(Z){const ue=setTimeout(async()=>{try{const ce=await Ta.saveData("users",Z.uid,r);ce.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",ce.error)}catch(ce){console.error("❌ خطأ في حفظ البيانات في Firebase:",ce)}},2e3);return()=>clearTimeout(ue)}}},[r,t,Z,Ce]);const ye=(G,ue="")=>C({isLoading:G,text:ue}),Ne=fe.useCallback(()=>r.transactions?r.transactions.filter(ue=>{const ce=new Date(ue.date),ge=ce.getFullYear()===u,_e=h==="all"||ce.getMonth()+1===h;return ge&&_e}).sort((ue,ce)=>{const ge=new Date(ue.date),ze=new Date(ce.date).getTime()-ge.getTime();if(ze===0){const fn=parseInt(ue.id.replace("trans-","").split("-")[0]);return parseInt(ce.id.replace("trans-","").split("-")[0])-fn}return ze}):[],[r.transactions,u,h]),Fe=fe.useMemo(()=>r.transactions?[...r.transactions].sort((G,ue)=>{const ce=new Date(G.date),_e=new Date(ue.date).getTime()-ce.getTime();if(_e===0){const ze=parseInt(G.id.replace("trans-","").split("-")[0]);return parseInt(ue.id.replace("trans-","").split("-")[0])-ze}return _e}):[],[r.transactions]),Be=fe.useMemo(()=>Ne(),[Ne]),vt=fe.useMemo(()=>{const G={},ue={},ce={},ge={};r.cards&&typeof r.cards=="object"&&Object.values(r.cards).forEach(Te=>{Te&&Te.id&&(ce[Te.id]={...Te,balance:0,available:Te.limit,usagePercentage:0})}),r.bankAccounts&&typeof r.bankAccounts=="object"&&Object.values(r.bankAccounts).forEach(Te=>{Te&&Te.id&&(ge[Te.id]={...Te,deposits:0,withdrawals:0})});let _e=0,ze=0,fn=0,ls=0;Be.forEach(Te=>{if(Te.type==="income")_e+=Te.amount;else if(Te.type==="expense")ze+=Te.amount,Te.categoryId&&(G[Te.categoryId]=(G[Te.categoryId]||0)+Te.amount);else if(Te.type==="bnpl-payment")ze+=Te.amount,Te.categoryId&&(G[Te.categoryId]=(G[Te.categoryId]||0)+Te.amount);else if(Te.type==="investment-deposit")fn+=Te.amount,ze+=Te.amount;else if(Te.type==="investment-withdrawal")ls+=Te.amount,_e+=Te.amount;else if(Te.type.endsWith("-payment")){const It=Te.type.replace("-payment","");ue[It]?ue[It]+=Te.amount:ue[It]=Te.amount}}),Object.keys(r.cards).forEach(Te=>{const It=r.cards[Te];let Kt=0;r.transactions.forEach(Xt=>{Xt.paymentMethod===Te&&Xt.type==="expense"&&(Kt+=Xt.amount),Xt.type===`${Te}-payment`&&(Kt-=Xt.amount)}),ce[Te].balance=Kt,ce[Te].available=It.limit-Kt,ce[Te].usagePercentage=It.limit>0?Kt/It.limit*100:0}),Object.keys(r.bankAccounts).forEach(Te=>{const It=r.bankAccounts[Te];let Kt=0,Xt=0,ii=It.balance;r.transactions.forEach(tt=>{tt.paymentMethod===Te&&(["income","investment-withdrawal"].includes(tt.type)?ii+=tt.amount:["expense","investment-deposit"].includes(tt.type)&&(ii-=tt.amount)),tt.type.endsWith("-payment")&&tt.paymentMethod===Te&&(ii-=tt.amount),tt.type==="expense"&&tt.isInstallmentPayment&&tt.paymentMethod===Te&&(ii-=tt.amount)}),Be.forEach(tt=>{tt.paymentMethod===Te&&(["income","investment-withdrawal"].includes(tt.type)?Kt+=tt.amount:["expense","investment-deposit"].includes(tt.type)&&(Xt+=tt.amount)),tt.type.endsWith("-payment")&&tt.paymentMethod===Te&&(Xt+=tt.amount),tt.type==="expense"&&tt.isInstallmentPayment&&tt.paymentMethod===Te&&(Xt+=tt.amount)}),ge[Te].balance=ii,ge[Te].deposits=Kt,ge[Te].withdrawals=Xt});const wt=Object.values(ce).reduce((Te,It)=>Te+It.balance,0),Gn=Object.values(ce).reduce((Te,It)=>Te+It.available,0),$n=Object.values(ce).reduce((Te,It)=>Te+It.limit,0),Pn=Object.values(ge).reduce((Te,It)=>Te+It.balance,0);return{totalIncome:_e,totalExpenses:ze,cardDetails:ce,cardPayments:ue,bankAccountDetails:ge,totalDebt:wt,totalAvailable:Gn,totalLimits:$n,totalBankBalance:Pn,totalInvestmentDeposits:fn,totalInvestmentWithdrawals:ls,expensesByCategory:G}},[Be,r.transactions,r.cards,r.bankAccounts]),gt=(G,ue)=>{o(ce=>{if(ue){const ge=ce.transactions.map(_e=>_e.id===ue?{..._e,...G}:_e);return{...ce,transactions:ge}}else if(G.bnplData&&G.paymentMethod.includes("bnpl")){const ge={id:`installment-${Date.now()}`,provider:G.paymentMethod,description:G.description,totalAmount:G.amount,installmentAmount:G.bnplData.installmentAmount,total:G.bnplData.installmentsCount,paid:1,createdAt:G.date},_e={id:`trans-${Date.now()}-1`,amount:G.bnplData.installmentAmount,date:G.date,description:`الدفعة الأولى لـ: ${G.description}`,paymentMethod:G.bnplData.initialPaymentSource,type:"expense",categoryId:G.categoryId,isInstallmentPayment:!0,installmentId:ge.id};return{...ce,transactions:[...ce.transactions,_e],installments:[...ce.installments,ge]}}else{const ge={id:`trans-${Date.now()}`,...G};return{...ce,transactions:[...ce.transactions,ge]}}}),$({isOpen:!1})},ei=G=>{k({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{o(ue=>{const ce=ue.transactions.find(ze=>ze.id===G);if(!ce)return ue;const ge=ue.transactions.filter(ze=>ze.id!==G);let _e=ue.installments;return ce.isInstallmentPayment&&ce.installmentId&&(_e=ue.installments.map(ze=>ze.id===ce.installmentId?{...ze,paid:Math.max(0,ze.paid-1)}:ze)),{...ue,transactions:ge,installments:_e}}),k(null)}})},qi=G=>{const ue=r.transactions.find(ce=>ce.id===G);ue&&$({isOpen:!0,initialData:ue})},ti=async G=>{Q(G),Ae(!1),await re(G.uid)},Hi=async()=>{try{const G=await Ta.signOut();G.success?(console.log("✅ تم تسجيل الخروج بنجاح"),Q(null),await me()):console.error("❌ خطأ في تسجيل الخروج:",G.error)}catch(G){console.error("❌ خطأ في تسجيل الخروج:",G)}},zn=(G,ue)=>{o(ce=>{const ge={...ce.cards};if(ue)ge[ue]={...ge[ue],...G,id:ue};else{const _e=`card-${Date.now()}`;ge[_e]={...G,id:_e}}return{...ce,cards:ge}}),B({isOpen:!1})},Br=G=>{var ue;r.transactions.some(ce=>ce.paymentMethod===G||ce.type===`${G}-payment`)?k({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):k({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(ue=r.cards[G])==null?void 0:ue.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{o(ce=>{const ge={...ce.cards};return delete ge[G],{...ce,cards:ge}}),k(null)}})},ni=(G,ue)=>{o(ce=>{const ge={...ce.bankAccounts};if(ue)ge[ue]={...ge[ue],...G,id:ue};else{const _e=`bank-${Date.now()}`;ge[_e]={...G,id:_e}}return{...ce,bankAccounts:ge}}),se({isOpen:!1})},jr=G=>{var ue;r.transactions.some(ce=>ce.paymentMethod===G)?k({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):k({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(ue=r.bankAccounts[G])==null?void 0:ue.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{o(ce=>{const ge={...ce.bankAccounts};return delete ge[G],{...ce,bankAccounts:ge}}),k(null)}})},qr=G=>{k({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const ue=xd();if(G.creditCards&&!G.cards){const ge={};Object.entries(G.creditCards).forEach(([_e,ze])=>{ge[_e]={id:_e,name:_e.toUpperCase(),limit:ze.creditLimit||0,balance:ze.currentBalance||0,dueDay:ze.dueDay||1,smsSamples:[],keywords:[]}}),G.cards=ge}if(G.cards&&typeof G.cards=="object"&&(G.cards.snb||G.cards.enbd)){const ge={};G.cards.snb&&(ge["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:G.cards.snb.limit||0,dueDay:G.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),G.cards.enbd&&(ge["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:G.cards.enbd.limit||0,dueDay:G.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),G.cards=ge}G.bank&&!G.bankAccounts&&(G.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:G.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),G.transactions&&Array.isArray(G.transactions)&&(G.transactions=G.transactions.map(ge=>ge.paymentMethod==="mada-bank"?{...ge,paymentMethod:"bank-default"}:ge));const ce={...ue,...G};o(ce),Z&&(async()=>{try{const _e=await Ta.saveData("users",Z.uid,ce);_e.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",_e.error)}catch(_e){console.error("❌ خطأ في حفظ البيانات في Firebase:",_e)}})(),k({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{k({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},Ct=G=>B({isOpen:!0,initialData:G?r.cards[G]:null}),Dt=G=>se({isOpen:!0,initialData:G?r.bankAccounts[G]:null}),Cs=G=>R({isOpen:!0,initialData:G?r.loans[G]:null}),cl=()=>{o(G=>({...G,settings:{...G.settings,darkMode:!G.settings.darkMode}}))},Ua=()=>{o(G=>({...G,settings:{...G.settings,notifications:!G.settings.notifications}}))},rn=()=>{const G=r.settings.language==="ar"?"en":"ar";o(ue=>({...ue,settings:{...ue.settings,language:G}})),e.changeLanguage(G)},si=()=>{if(!w.fromAccount||!w.toAccount||w.amount<=0){k({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(w.fromAccount===w.toAccount){k({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const G=r.bankAccounts[w.fromAccount],ue=r.bankAccounts[w.toAccount],ce=w.amount*w.exchangeRate,ge={id:`trans-${Date.now()}-withdrawal`,amount:w.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(ue==null?void 0:ue.name)||"حساب آخر"}: ${w.description}${w.exchangeRate!==1?` (معدل: ${w.exchangeRate})`:""}`,paymentMethod:w.fromAccount,type:"expense",categoryId:null},_e={id:`trans-${Date.now()}-deposit`,amount:ce,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(G==null?void 0:G.name)||"حساب آخر"}: ${w.description}${w.exchangeRate!==1?` (معدل: ${w.exchangeRate})`:""}`,paymentMethod:w.toAccount,type:"income",categoryId:null};o(ze=>({...ze,transactions:[...ze.transactions,ge,_e]})),D({isOpen:!1}),L({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),We(""),k({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Hr=G=>{if(o(ue=>({...ue,loans:{...ue.loans,[G.id]:G}})),!G.id.includes("edit")){const ue=[];G.downPayment>0&&ue.push({id:`trans-${Date.now()}-down-payment`,amount:G.downPayment,date:G.startDate,description:`دفعة أولى - ${G.name}`,paymentMethod:G.linkedAccount||"cash",type:"expense",categoryId:null}),ue.push({id:`trans-${Date.now()}-loan-deposit`,amount:G.totalAmount,date:G.startDate,description:`إيداع قرض - ${G.name} من ${G.lender}`,paymentMethod:G.linkedAccount||"cash",type:"income",categoryId:null}),G.finalPayment>0&&G.endDate&&ue.push({id:`trans-${Date.now()}-final-payment`,amount:G.finalPayment,date:G.endDate,description:`دفعة أخيرة - ${G.name}`,paymentMethod:G.linkedAccount||"cash",type:"expense",categoryId:null}),o(ce=>({...ce,transactions:[...ce.transactions,...ue]}))}R({isOpen:!1}),k({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},zi=async()=>{if(!w.fromAccount||!w.toAccount)return;const G=r.bankAccounts[w.fromAccount],ue=r.bankAccounts[w.toAccount];if(!G||!ue)return;const ce=G.currency||"SAR",ge=ue.currency||"SAR";if(ce===ge){L(_e=>({..._e,exchangeRate:1})),We("");return}O(!0),We("");try{const _e=await g2(ce,ge);L(ze=>({...ze,exchangeRate:_e.rate}))}catch(_e){We(_e instanceof Error?_e.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",_e)}finally{O(!1)}};if(!t||Ce)return p.jsx(k6,{});if(!Z)return p.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:p.jsxs("div",{className:"w-full max-w-md px-4",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),p.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),p.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),p.jsx(Ax,{onSuccess:ti,onClose:()=>{},hideCloseButton:!0})]})});`${u}${h==="all"?"كل الشهور":new Date(u,h-1).toLocaleString("ar-SA",{month:"long"})}`;const ws=()=>{switch(_){case"summary":return p.jsx(O6,{calculations:vt,categories:r.categories,state:r,darkMode:r.settings.darkMode,language:r.settings.language});case"transactions":return p.jsx(U6,{transactions:Be,allTransactions:Fe,categories:r.categories,deleteTransaction:ei,editTransaction:qi,state:r,darkMode:r.settings.darkMode,language:r.settings.language});case"ai-assistant":return p.jsx(B6,{calculations:vt,filteredTransactions:Be,darkMode:r.settings.darkMode,language:r.settings.language});case"analysis":return p.jsx(j6,{calculations:vt,categories:r.categories,allTransactions:r.transactions,darkMode:r.settings.darkMode,language:r.settings.language});case"budget":return p.jsx(q6,{state:r,setLoading:ye,setModal:k,darkMode:r.settings.darkMode,language:r.settings.language});case"investment":return p.jsx(H6,{state:r,setState:o,calculations:vt,setModal:k,darkMode:r.settings.darkMode,language:r.settings.language});case"cards":return p.jsx(G6,{state:r,openCardFormModal:Ct,deleteCard:Br,darkMode:r.settings.darkMode,language:r.settings.language});case"bank":return p.jsx(Y6,{state:r,setState:o,calculations:vt,filteredTransactions:Be,categories:r.categories,setModal:k,openBankAccountFormModal:Dt,deleteBankAccount:jr,openTransferModal:()=>D({isOpen:!0}),darkMode:r.settings.darkMode,language:r.settings.language});case"installments":return p.jsx(J6,{state:r,setState:o,filteredTransactions:Be,setModal:k,darkMode:r.settings.darkMode,language:r.settings.language});case"debts-loans":return p.jsx(Q6,{state:r,setState:o,setModal:k,openLoanFormModal:Cs,darkMode:r.settings.darkMode,language:r.settings.language});case"settings":return p.jsx(Z6,{state:r,setState:o,setModal:k,setLoading:ye,onRestore:qr,darkMode:r.settings.darkMode,language:r.settings.language});default:return p.jsx("div",{children:"Tab not found"})}};return p.jsxs("div",{className:`min-h-screen font-sans ${r.settings.darkMode?"dark":""}`,children:[p.jsx(R6,{selectedYear:u,selectedMonth:h,onYearChange:d,onMonthChange:G=>f(G),onAddTransaction:()=>$({isOpen:!0}),currentUser:Z,onSignOut:Hi,language:r.settings.language}),p.jsx("div",{className:`backdrop-blur-sm border-b p-4 ${r.settings.darkMode?"bg-slate-800/80 border-slate-700":"bg-white/80 border-slate-200"}`,children:p.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:`text-sm font-medium ${r.settings.darkMode?"text-slate-200":"text-slate-700"}`,children:n("dark.mode",r.settings.language)}),p.jsx(Nx,{darkMode:r.settings.darkMode,onToggle:cl})]}),p.jsx(Rx,{notifications:r.settings.notifications,onToggle:Ua,language:r.settings.language})]}),p.jsx("div",{className:"flex items-center gap-3",children:p.jsxs("button",{onClick:rn,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${r.settings.darkMode?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-blue-100 hover:bg-blue-200 text-slate-700"}`,children:[p.jsx("span",{className:"text-sm font-medium",children:n("language",r.settings.language)}),p.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${r.settings.darkMode?"bg-blue-500":"bg-blue-600"}`,children:p.jsx("span",{className:"text-white font-bold text-xs",children:r.settings.language==="ar"?"A":"E"})})]})})]})}),p.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[p.jsx(M6,{activeTab:_,setActiveTab:b,language:r.settings.language}),ws()]}),p.jsx("button",{onClick:()=>$({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),V.isOpen&&p.jsx(e3,{onClose:()=>$({isOpen:!1}),onSave:gt,initialData:V.initialData,categories:r.categories,cards:r.cards,bankAccounts:r.bankAccounts,loans:r.loans,setModalConfig:k,darkMode:r.settings.darkMode,language:r.settings.language}),U.isOpen&&p.jsx(t3,{onClose:()=>B({isOpen:!1}),onSave:zn,initialData:U.initialData}),K.isOpen&&p.jsx(n3,{onClose:()=>se({isOpen:!1}),onSave:ni,initialData:K.initialData}),H.isOpen&&p.jsx(s3,{onClose:()=>R({isOpen:!1}),onSave:Hr,initialData:H.initialData,bankAccounts:r.bankAccounts}),N.isOpen&&p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{D({isOpen:!1}),L({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),We("")},children:p.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:G=>G.stopPropagation(),children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"💸 تحويل بين الحسابات"}),p.jsx("button",{onClick:()=>{D({isOpen:!1}),L({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),We("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),p.jsxs("select",{id:"fromAccount",name:"fromAccount",value:w.fromAccount,onChange:G=>L(ue=>({...ue,fromAccount:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[p.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(r.bankAccounts).map(([G,ue])=>p.jsx("option",{value:G,children:ue.name},G))]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),p.jsxs("select",{id:"toAccount",name:"toAccount",value:w.toAccount,onChange:G=>L(ue=>({...ue,toAccount:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[p.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(r.bankAccounts).filter(([G])=>G!==w.fromAccount).map(([G,ue])=>p.jsx("option",{value:G,children:ue.name},G))]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),p.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:w.amount,onChange:G=>L(ue=>({...ue,amount:parseFloat(G.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),w.fromAccount&&w.toAccount&&((Fa=r.bankAccounts[w.fromAccount])==null?void 0:Fa.currency)!==((zr=r.bankAccounts[w.toAccount])==null?void 0:zr.currency)&&p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(Gr=r.bankAccounts[w.fromAccount])==null?void 0:Gr.currency," → ",($r=r.bankAccounts[w.toAccount])==null?void 0:$r.currency,")"]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"number",step:"0.0001",value:w.exchangeRate,onChange:G=>L(ue=>({...ue,exchangeRate:parseFloat(G.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),p.jsxs("button",{type:"button",onClick:zi,disabled:j,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[j?p.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",p.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),Pe&&p.jsx("p",{className:"text-red-500 text-xs mt-1",children:Pe}),p.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(w.amount*w.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(Sn=r.bankAccounts[w.toAccount])==null?void 0:Sn.currency]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),p.jsx("input",{type:"text",id:"description",name:"description",value:w.description,onChange:G=>L(ue=>({...ue,description:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),p.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[p.jsx("button",{type:"button",onClick:()=>{D({isOpen:!1}),L({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),We("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),p.jsx("button",{type:"button",onClick:si,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),M&&p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>k(null),children:p.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:G=>G.stopPropagation(),children:[p.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:M.title}),p.jsx("div",{className:"text-slate-600",dangerouslySetInnerHTML:{__html:M.body}}),p.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!M.hideCancel&&p.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),p.jsx("button",{onClick:()=>{(!M.onConfirm||M.onConfirm()!==!1)&&k(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:M.confirmText||"موافق"})]})]})}),x.isLoading&&p.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),p.jsx("p",{className:"text-white mt-4",children:x.text||"جاري التحميل..."})]}),he&&Z&&p.jsx(Ax,{onSuccess:ti,onClose:()=>Ae(!1)})]})},eC=document.getElementById("root");if(!eC)throw new Error("Could not find root element");const r3=jw.createRoot(eC);r3.render(p.jsx(Yp.StrictMode,{children:p.jsx(i3,{})}));
