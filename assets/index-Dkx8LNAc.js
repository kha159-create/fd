(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function qE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Tm={exports:{}},su={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function jC(){if(jv)return su;jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var f in o)f!=="key"&&(l[f]=o[f])}else l=o;return o=l.ref,{$$typeof:n,type:i,key:u,ref:o!==void 0?o:null,props:l}}return su.Fragment=e,su.jsx=t,su.jsxs=t,su}var Fv;function FC(){return Fv||(Fv=1,Tm.exports=jC()),Tm.exports}var d=FC(),Em={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function qC(){if(qv)return Oe;qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),b=Symbol.iterator;function w(q){return q===null||typeof q!="object"?null:(q=b&&q[b]||q["@@iterator"],typeof q=="function"?q:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,H={};function ne(q,re,ye){this.props=q,this.context=re,this.refs=H,this.updater=ye||P}ne.prototype.isReactComponent={},ne.prototype.setState=function(q,re){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,re,"setState")},ne.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function F(){}F.prototype=ne.prototype;function O(q,re,ye){this.props=q,this.context=re,this.refs=H,this.updater=ye||P}var z=O.prototype=new F;z.constructor=O,U(z,ne.prototype),z.isPureReactComponent=!0;var Z=Array.isArray;function W(){}var R={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function N(q,re,ye){var _e=ye.ref;return{$$typeof:n,type:q,key:re,ref:_e!==void 0?_e:null,props:ye}}function k(q,re){return N(q.type,re,q.props)}function V(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function j(q){var re={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ye){return re[ye]})}var D=/\/+/g;function Le(q,re){return typeof q=="object"&&q!==null&&q.key!=null?j(""+q.key):re.toString(36)}function he(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(W,W):(q.status="pending",q.then(function(re){q.status==="pending"&&(q.status="fulfilled",q.value=re)},function(re){q.status==="pending"&&(q.status="rejected",q.reason=re)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function $(q,re,ye,_e,ie){var ce=typeof q;(ce==="undefined"||ce==="boolean")&&(q=null);var be=!1;if(q===null)be=!0;else switch(ce){case"bigint":case"string":case"number":be=!0;break;case"object":switch(q.$$typeof){case n:case e:be=!0;break;case T:return be=q._init,$(be(q._payload),re,ye,_e,ie)}}if(be)return ie=ie(q),be=_e===""?"."+Le(q,0):_e,Z(ie)?(ye="",be!=null&&(ye=be.replace(D,"$&/")+"/"),$(ie,re,ye,"",function(Tn){return Tn})):ie!=null&&(V(ie)&&(ie=k(ie,ye+(ie.key==null||q&&q.key===ie.key?"":(""+ie.key).replace(D,"$&/")+"/")+be)),re.push(ie)),1;be=0;var et=_e===""?".":_e+":";if(Z(q))for(var nt=0;nt<q.length;nt++)_e=q[nt],ce=et+Le(_e,nt),be+=$(_e,re,ye,ce,ie);else if(nt=w(q),typeof nt=="function")for(q=nt.call(q),nt=0;!(_e=q.next()).done;)_e=_e.value,ce=et+Le(_e,nt++),be+=$(_e,re,ye,ce,ie);else if(ce==="object"){if(typeof q.then=="function")return $(he(q),re,ye,_e,ie);throw re=String(q),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return be}function de(q,re,ye){if(q==null)return q;var _e=[],ie=0;return $(q,_e,"","",function(ce){return re.call(ye,ce,ie++)}),_e}function ve(q){if(q._status===-1){var re=q._result;re=re(),re.then(function(ye){(q._status===0||q._status===-1)&&(q._status=1,q._result=ye)},function(ye){(q._status===0||q._status===-1)&&(q._status=2,q._result=ye)}),q._status===-1&&(q._status=0,q._result=re)}if(q._status===1)return q._result.default;throw q._result}var Be=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Ze={map:de,forEach:function(q,re,ye){de(q,function(){re.apply(this,arguments)},ye)},count:function(q){var re=0;return de(q,function(){re++}),re},toArray:function(q){return de(q,function(re){return re})||[]},only:function(q){if(!V(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Oe.Activity=E,Oe.Children=Ze,Oe.Component=ne,Oe.Fragment=t,Oe.Profiler=o,Oe.PureComponent=O,Oe.StrictMode=i,Oe.Suspense=g,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return R.H.useMemoCache(q)}},Oe.cache=function(q){return function(){return q.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(q,re,ye){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var _e=U({},q.props),ie=q.key;if(re!=null)for(ce in re.key!==void 0&&(ie=""+re.key),re)!C.call(re,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&re.ref===void 0||(_e[ce]=re[ce]);var ce=arguments.length-2;if(ce===1)_e.children=ye;else if(1<ce){for(var be=Array(ce),et=0;et<ce;et++)be[et]=arguments[et+2];_e.children=be}return N(q.type,ie,_e)},Oe.createContext=function(q){return q={$$typeof:u,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},Oe.createElement=function(q,re,ye){var _e,ie={},ce=null;if(re!=null)for(_e in re.key!==void 0&&(ce=""+re.key),re)C.call(re,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(ie[_e]=re[_e]);var be=arguments.length-2;if(be===1)ie.children=ye;else if(1<be){for(var et=Array(be),nt=0;nt<be;nt++)et[nt]=arguments[nt+2];ie.children=et}if(q&&q.defaultProps)for(_e in be=q.defaultProps,be)ie[_e]===void 0&&(ie[_e]=be[_e]);return N(q,ce,ie)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(q){return{$$typeof:f,render:q}},Oe.isValidElement=V,Oe.lazy=function(q){return{$$typeof:T,_payload:{_status:-1,_result:q},_init:ve}},Oe.memo=function(q,re){return{$$typeof:h,type:q,compare:re===void 0?null:re}},Oe.startTransition=function(q){var re=R.T,ye={};R.T=ye;try{var _e=q(),ie=R.S;ie!==null&&ie(ye,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(W,Be)}catch(ce){Be(ce)}finally{re!==null&&ye.types!==null&&(re.types=ye.types),R.T=re}},Oe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Oe.use=function(q){return R.H.use(q)},Oe.useActionState=function(q,re,ye){return R.H.useActionState(q,re,ye)},Oe.useCallback=function(q,re){return R.H.useCallback(q,re)},Oe.useContext=function(q){return R.H.useContext(q)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(q,re){return R.H.useDeferredValue(q,re)},Oe.useEffect=function(q,re){return R.H.useEffect(q,re)},Oe.useEffectEvent=function(q){return R.H.useEffectEvent(q)},Oe.useId=function(){return R.H.useId()},Oe.useImperativeHandle=function(q,re,ye){return R.H.useImperativeHandle(q,re,ye)},Oe.useInsertionEffect=function(q,re){return R.H.useInsertionEffect(q,re)},Oe.useLayoutEffect=function(q,re){return R.H.useLayoutEffect(q,re)},Oe.useMemo=function(q,re){return R.H.useMemo(q,re)},Oe.useOptimistic=function(q,re){return R.H.useOptimistic(q,re)},Oe.useReducer=function(q,re,ye){return R.H.useReducer(q,re,ye)},Oe.useRef=function(q){return R.H.useRef(q)},Oe.useState=function(q){return R.H.useState(q)},Oe.useSyncExternalStore=function(q,re,ye){return R.H.useSyncExternalStore(q,re,ye)},Oe.useTransition=function(){return R.H.useTransition()},Oe.version="19.2.0",Oe}var Bv;function Cp(){return Bv||(Bv=1,Em.exports=qC()),Em.exports}var fe=Cp();const wp=qE(fe);var xm={exports:{}},iu={},bm={exports:{}},Am={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function BC(){return zv||(zv=1,(function(n){function e($,de){var ve=$.length;$.push(de);e:for(;0<ve;){var Be=ve-1>>>1,Ze=$[Be];if(0<o(Ze,de))$[Be]=de,$[ve]=Ze,ve=Be;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var de=$[0],ve=$.pop();if(ve!==de){$[0]=ve;e:for(var Be=0,Ze=$.length,q=Ze>>>1;Be<q;){var re=2*(Be+1)-1,ye=$[re],_e=re+1,ie=$[_e];if(0>o(ye,ve))_e<Ze&&0>o(ie,ye)?($[Be]=ie,$[_e]=ve,Be=_e):($[Be]=ye,$[re]=ve,Be=re);else if(_e<Ze&&0>o(ie,ve))$[Be]=ie,$[_e]=ve,Be=_e;else break e}}return de}function o($,de){var ve=$.sortIndex-de.sortIndex;return ve!==0?ve:$.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var g=[],h=[],T=1,E=null,b=3,w=!1,P=!1,U=!1,H=!1,ne=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function z($){for(var de=t(h);de!==null;){if(de.callback===null)i(h);else if(de.startTime<=$)i(h),de.sortIndex=de.expirationTime,e(g,de);else break;de=t(h)}}function Z($){if(U=!1,z($),!P)if(t(g)!==null)P=!0,W||(W=!0,j());else{var de=t(h);de!==null&&he(Z,de.startTime-$)}}var W=!1,R=-1,C=5,N=-1;function k(){return H?!0:!(n.unstable_now()-N<C)}function V(){if(H=!1,W){var $=n.unstable_now();N=$;var de=!0;try{e:{P=!1,U&&(U=!1,F(R),R=-1),w=!0;var ve=b;try{t:{for(z($),E=t(g);E!==null&&!(E.expirationTime>$&&k());){var Be=E.callback;if(typeof Be=="function"){E.callback=null,b=E.priorityLevel;var Ze=Be(E.expirationTime<=$);if($=n.unstable_now(),typeof Ze=="function"){E.callback=Ze,z($),de=!0;break t}E===t(g)&&i(g),z($)}else i(g);E=t(g)}if(E!==null)de=!0;else{var q=t(h);q!==null&&he(Z,q.startTime-$),de=!1}}break e}finally{E=null,b=ve,w=!1}de=void 0}}finally{de?j():W=!1}}}var j;if(typeof O=="function")j=function(){O(V)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,Le=D.port2;D.port1.onmessage=V,j=function(){Le.postMessage(null)}}else j=function(){ne(V,0)};function he($,de){R=ne(function(){$(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function($){switch(b){case 1:case 2:case 3:var de=3;break;default:de=b}var ve=b;b=de;try{return $()}finally{b=ve}},n.unstable_requestPaint=function(){H=!0},n.unstable_runWithPriority=function($,de){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ve=b;b=$;try{return de()}finally{b=ve}},n.unstable_scheduleCallback=function($,de,ve){var Be=n.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Be+ve:Be):ve=Be,$){case 1:var Ze=-1;break;case 2:Ze=250;break;case 5:Ze=1073741823;break;case 4:Ze=1e4;break;default:Ze=5e3}return Ze=ve+Ze,$={id:T++,callback:de,priorityLevel:$,startTime:ve,expirationTime:Ze,sortIndex:-1},ve>Be?($.sortIndex=ve,e(h,$),t(g)===null&&$===t(h)&&(U?(F(R),R=-1):U=!0,he(Z,ve-Be))):($.sortIndex=Ze,e(g,$),P||w||(P=!0,W||(W=!0,j()))),$},n.unstable_shouldYield=k,n.unstable_wrapCallback=function($){var de=b;return function(){var ve=b;b=de;try{return $.apply(this,arguments)}finally{b=ve}}}})(Am)),Am}var Hv;function zC(){return Hv||(Hv=1,bm.exports=BC()),bm.exports}var Sm={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function HC(){if(Gv)return dn;Gv=1;var n=Cp();function e(g){var h="https://react.dev/errors/"+g;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)h+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+g+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(g,h,T){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:E==null?null:""+E,children:g,containerInfo:h,implementation:T}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(g,h){if(g==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(g,h){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(g,h,null,T)},dn.flushSync=function(g){var h=u.T,T=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=h,i.p=T,i.d.f()}},dn.preconnect=function(g,h){typeof g=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(g,h))},dn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},dn.preinit=function(g,h){if(typeof g=="string"&&h&&typeof h.as=="string"){var T=h.as,E=f(T,h.crossOrigin),b=typeof h.integrity=="string"?h.integrity:void 0,w=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;T==="style"?i.d.S(g,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:E,integrity:b,fetchPriority:w}):T==="script"&&i.d.X(g,{crossOrigin:E,integrity:b,fetchPriority:w,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},dn.preinitModule=function(g,h){if(typeof g=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var T=f(h.as,h.crossOrigin);i.d.M(g,{crossOrigin:T,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(g)},dn.preload=function(g,h){if(typeof g=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var T=h.as,E=f(T,h.crossOrigin);i.d.L(g,T,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},dn.preloadModule=function(g,h){if(typeof g=="string")if(h){var T=f(h.as,h.crossOrigin);i.d.m(g,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:T,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(g)},dn.requestFormReset=function(g){i.d.r(g)},dn.unstable_batchedUpdates=function(g,h){return g(h)},dn.useFormState=function(g,h,T){return u.H.useFormState(g,h,T)},dn.useFormStatus=function(){return u.H.useHostTransitionStatus()},dn.version="19.2.0",dn}var Yv;function GC(){if(Yv)return Sm.exports;Yv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sm.exports=HC(),Sm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v;function YC(){if($v)return iu;$v=1;var n=zC(),e=Cp(),t=GC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,a=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(a=r.return),s=r.return;while(s)}return r.tag===3?a:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function h(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var a=s,c=r;;){var v=a.return;if(v===null)break;var _=v.alternate;if(_===null){if(c=v.return,c!==null){a=c;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===a)return g(v),s;if(_===c)return g(v),r;_=_.sibling}throw Error(i(188))}if(a.return!==c.return)a=v,c=_;else{for(var A=!1,I=v.child;I;){if(I===a){A=!0,a=v,c=_;break}if(I===c){A=!0,c=v,a=_;break}I=I.sibling}if(!A){for(I=_.child;I;){if(I===a){A=!0,a=_,c=v;break}if(I===c){A=!0,c=_,a=v;break}I=I.sibling}if(!A)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?s:r}function T(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=T(s),r!==null)return r;s=s.sibling}return null}var E=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case U:return"Fragment";case ne:return"Profiler";case H:return"StrictMode";case Z:return"Suspense";case W:return"SuspenseList";case N:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case P:return"Portal";case O:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case z:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:Le(s.type)||"Memo";case C:r=s._payload,s=s._init;try{return Le(s(r))}catch{}}return null}var he=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},Be=[],Ze=-1;function q(s){return{current:s}}function re(s){0>Ze||(s.current=Be[Ze],Be[Ze]=null,Ze--)}function ye(s,r){Ze++,Be[Ze]=s.current,s.current=r}var _e=q(null),ie=q(null),ce=q(null),be=q(null);function et(s,r){switch(ye(ce,r),ye(ie,s),ye(_e,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?lv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=lv(r),s=uv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(_e),ye(_e,s)}function nt(){re(_e),re(ie),re(ce)}function Tn(s){s.memoizedState!==null&&ye(be,s);var r=_e.current,a=uv(r,s.type);r!==a&&(ye(ie,s),ye(_e,a))}function St(s){ie.current===s&&(re(_e),re(ie)),be.current===s&&(re(be),Zl._currentValue=ve)}var Es,Oi;function Fn(s){if(Es===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);Es=r&&r[1]||"",Oi=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Es+s+Oi}var Vr=!1;function Ks(s,r){if(!s||Vr)return"";Vr=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(te){var X=te}Reflect.construct(s,[],ae)}else{try{ae.call()}catch(te){X=te}s.call(ae.prototype)}}else{try{throw Error()}catch(te){X=te}(ae=s())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(te){if(te&&X&&typeof te.stack=="string")return[te.stack,X.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=c.DetermineComponentFrameRoot(),A=_[0],I=_[1];if(A&&I){var L=A.split(`
`),Q=I.split(`
`);for(v=c=0;c<L.length&&!L[c].includes("DetermineComponentFrameRoot");)c++;for(;v<Q.length&&!Q[v].includes("DetermineComponentFrameRoot");)v++;if(c===L.length||v===Q.length)for(c=L.length-1,v=Q.length-1;1<=c&&0<=v&&L[c]!==Q[v];)v--;for(;1<=c&&0<=v;c--,v--)if(L[c]!==Q[v]){if(c!==1||v!==1)do if(c--,v--,0>v||L[c]!==Q[v]){var se=`
`+L[c].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=c&&0<=v);break}}}finally{Vr=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?Fn(a):""}function Lr(s,r){switch(s.tag){case 26:case 27:case 5:return Fn(s.type);case 16:return Fn("Lazy");case 13:return s.child!==r&&r!==null?Fn("Suspense Fallback"):Fn("Suspense");case 19:return Fn("SuspenseList");case 0:case 15:return Ks(s.type,!1);case 11:return Ks(s.type.render,!1);case 1:return Ks(s.type,!0);case 31:return Fn("Activity");default:return""}}function Ur(s){try{var r="",a=null;do r+=Lr(s,a),a=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var wt=Object.prototype.hasOwnProperty,Mt=n.unstable_scheduleCallback,xs=n.unstable_cancelCallback,sl=n.unstable_shouldYield,Mo=n.unstable_requestPaint,Xt=n.unstable_now,Qs=n.unstable_getCurrentPriorityLevel,ji=n.unstable_ImmediatePriority,Fi=n.unstable_UserBlockingPriority,ss=n.unstable_NormalPriority,Do=n.unstable_LowPriority,Or=n.unstable_IdlePriority,Y=n.log,pe=n.unstable_setDisableYieldValue,me=null,Te=null;function Re(s){if(typeof Y=="function"&&pe(s),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(me,s)}catch{}}var Ue=Math.clz32?Math.clz32:Po,jr=Math.log,Xs=Math.LN2;function Po(s){return s>>>=0,s===0?32:31-(jr(s)/Xs|0)|0}var qn=256,Ws=262144,It=4194304;function Ee(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ft(s,r,a){var c=s.pendingLanes;if(c===0)return 0;var v=0,_=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var I=c&134217727;return I!==0?(c=I&~_,c!==0?v=Ee(c):(A&=I,A!==0?v=Ee(A):a||(a=I&~s,a!==0&&(v=Ee(a))))):(I=c&~_,I!==0?v=Ee(I):A!==0?v=Ee(A):a||(a=c&~s,a!==0&&(v=Ee(a)))),v===0?0:r!==0&&r!==v&&(r&_)===0&&(_=v&-v,a=r&-r,_>=a||_===32&&(a&4194048)!==0)?r:v}function Ut(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function En(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bs(){var s=It;return It<<=1,(It&62914560)===0&&(It=4194304),s}function Ye(s){for(var r=[],a=0;31>a;a++)r.push(s);return r}function Fr(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Sf(s,r,a,c,v,_){var A=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var I=s.entanglements,L=s.expirationTimes,Q=s.hiddenUpdates;for(a=A&~a;0<a;){var se=31-Ue(a),ae=1<<se;I[se]=0,L[se]=-1;var X=Q[se];if(X!==null)for(Q[se]=null,se=0;se<X.length;se++){var te=X[se];te!==null&&(te.lane&=-536870913)}a&=~ae}c!==0&&qr(s,c,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(A&~r))}function qr(s,r,a){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-Ue(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|a&261930}function il(s,r){var a=s.entangledLanes|=r;for(s=s.entanglements;a;){var c=31-Ue(a),v=1<<c;v&r|s[c]&r&&(s[c]|=r),a&=~v}}function rl(s,r){var a=r&-r;return a=(a&42)!==0?1:Br(a),(a&(s.suspendedLanes|r))!==0?0:a}function Br(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Zs(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Fu(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:Dv(s.type))}function is(s,r){var a=de.p;try{return de.p=s,r()}finally{de.p=a}}var rs=Math.random().toString(36).slice(2),Ot="__reactFiber$"+rs,Wt="__reactProps$"+rs,As="__reactContainer$"+rs,ko="__reactEvents$"+rs,Cf="__reactListeners$"+rs,qu="__reactHandles$"+rs,Bu="__reactResources$"+rs,Ss="__reactMarker$"+rs;function Vo(s){delete s[Ot],delete s[Wt],delete s[ko],delete s[Cf],delete s[qu]}function Cs(s){var r=s[Ot];if(r)return r;for(var a=s.parentNode;a;){if(r=a[As]||a[Ot]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(s=gv(s);s!==null;){if(a=s[Ot])return a;s=gv(s)}return r}s=a,a=s.parentNode}return null}function Bn(s){if(s=s[Ot]||s[As]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Rn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function ws(s){var r=s[Bu];return r||(r=s[Bu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function jt(s){s[Ss]=!0}var ol=new Set,al={};function Is(s,r){Ns(s,r),Ns(s+"Capture",r)}function Ns(s,r){for(al[s]=r,s=0;s<r.length;s++)ol.add(r[s])}var ll=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ul={},cl={};function zu(s){return wt.call(cl,s)?!0:wt.call(ul,s)?!1:ll.test(s)?cl[s]=!0:(ul[s]=!0,!1)}function Lo(s,r,a){if(zu(r))if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+a)}}function Mn(s,r,a){if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+a)}}function Ft(s,r,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(r,a,""+c)}}function Zt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function qi(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function dl(s,r,a){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,_=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return v.call(this)},set:function(A){a=""+A,_.call(this,A)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(A){a=""+A},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function ut(s){if(!s._valueTracker){var r=qi(s)?"checked":"value";s._valueTracker=dl(s,r,""+s[r])}}function zr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return s&&(c=qi(s)?s.checked?"true":"false":s.value),s=c,s!==a?(r.setValue(s),!0):!1}function Rs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Hr=/[\n"\\]/g;function xn(s){return s.replace(Hr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Uo(s,r,a,c,v,_,A,I){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),r!=null?A==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Zt(r)):s.value!==""+Zt(r)&&(s.value=""+Zt(r)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),r!=null?fl(s,A,Zt(r)):a!=null?fl(s,A,Zt(a)):c!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+Zt(I):s.removeAttribute("name")}function Hu(s,r,a,c,v,_,A,I){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),r!=null||a!=null){if(!(_!=="submit"&&_!=="reset"||r!=null)){ut(s);return}a=a!=null?""+Zt(a):"",r=r!=null?""+Zt(r):a,I||r===s.value||(s.value=r),s.defaultValue=r}c=c??v,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=I?s.checked:!!c,s.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),ut(s)}function fl(s,r,a){r==="number"&&Rs(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function Bi(s,r,a,c){if(s=s.options,r){r={};for(var v=0;v<a.length;v++)r["$"+a[v]]=!0;for(a=0;a<s.length;a++)v=r.hasOwnProperty("$"+s[a].value),s[a].selected!==v&&(s[a].selected=v),v&&c&&(s[a].defaultSelected=!0)}else{for(a=""+Zt(a),r=null,v=0;v<s.length;v++){if(s[v].value===a){s[v].selected=!0,c&&(s[v].defaultSelected=!0);return}r!==null||s[v].disabled||(r=s[v])}r!==null&&(r.selected=!0)}}function Gu(s,r,a){if(r!=null&&(r=""+Zt(r),r!==s.value&&(s.value=r),a==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=a!=null?""+Zt(a):""}function zi(s,r,a,c){if(r==null){if(c!=null){if(a!=null)throw Error(i(92));if(he(c)){if(1<c.length)throw Error(i(93));c=c[0]}a=c}a==null&&(a=""),r=a}a=Zt(r),s.defaultValue=a,c=s.textContent,c===a&&c!==""&&c!==null&&(s.value=c),ut(s)}function bn(s,r){if(r){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=r;return}}s.textContent=r}var Yu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hl(s,r,a){var c=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,a):typeof a!="number"||a===0||Yu.has(r)?r==="float"?s.cssFloat=a:s[r]=(""+a).trim():s[r]=a+"px"}function ml(s,r,a){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var v in r)c=r[v],r.hasOwnProperty(v)&&a[v]!==c&&hl(s,v,c)}else for(var _ in r)r.hasOwnProperty(_)&&hl(s,_,r[_])}function Oo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $u=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jo(s){return Hi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function os(){}var pl=null;function zn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gi=null,Ms=null;function Gr(s){var r=Bn(s);if(r&&(s=r.stateNode)){var a=s[Wt]||null;e:switch(s=r.stateNode,r.type){case"input":if(Uo(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+xn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==s&&c.form===s.form){var v=c[Wt]||null;if(!v)throw Error(i(90));Uo(c,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(r=0;r<a.length;r++)c=a[r],c.form===s.form&&zr(c)}break e;case"textarea":Gu(s,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Bi(s,!!a.multiple,r,!1)}}}var Fo=!1;function Yi(s,r,a){if(Fo)return s(r,a);Fo=!0;try{var c=s(r);return c}finally{if(Fo=!1,(Gi!==null||Ms!==null)&&(Fc(),Gi&&(r=Gi,s=Ms,Ms=Gi=null,Gr(r),s)))for(r=0;r<s.length;r++)Gr(s[r])}}function as(s,r){var a=s.stateNode;if(a===null)return null;var c=a[Wt]||null;if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yr=!1;if(Hn)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){Yr=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{Yr=!1}var Ds=null,gl=null,$r=null;function yl(){if($r)return $r;var s,r=gl,a=r.length,c,v="value"in Ds?Ds.value:Ds.textContent,_=v.length;for(s=0;s<a&&r[s]===v[s];s++);var A=a-s;for(c=1;c<=A&&r[a-c]===v[_-c];c++);return $r=v.slice(s,1<c?1-c:void 0)}function Jr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function ei(){return!0}function ls(){return!1}function rn(s){function r(a,c,v,_,A){this._reactName=a,this._targetInst=v,this.type=c,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(a=s[I],this[I]=a?a(_):_[I]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ei:ls,this.isPropagationStopped=ls,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ei)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ei)},persist:function(){},isPersistent:ei}),r}var ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ps=rn(ti),$i=E({},ti,{view:0,detail:0}),vl=rn($i),Ji,qo,ks,Bo=E({},$i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ki,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ks&&(ks&&s.type==="mousemove"?(Ji=s.screenX-ks.screenX,qo=s.screenY-ks.screenY):qo=Ji=0,ks=s),Ji)},movementY:function(s){return"movementY"in s?s.movementY:qo}}),_l=rn(Bo),Kr=E({},Bo,{dataTransfer:0}),Ju=rn(Kr),Ku=E({},$i,{relatedTarget:0}),Qr=rn(Ku),Tl=E({},ti,{animationName:0,elapsedTime:0,pseudoElement:0}),Qu=rn(Tl),zo=E({},ti,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Xu=rn(zo),Wu=E({},ti,{data:0}),Vs=rn(Wu),Zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ec={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nc(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=tc[s])?!!r[s]:!1}function Ki(){return nc}var yn=E({},$i,{key:function(s){if(s.key){var r=Zu[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Jr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ec[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ki,charCode:function(s){return s.type==="keypress"?Jr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),sc=rn(yn),ic=E({},Bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ni=rn(ic),p=E({},$i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ki}),x=rn(p),S=E({},ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=rn(S),J=E({},Bo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ee=rn(J),ge=E({},ti,{newState:0,oldState:0}),Fe=rn(ge),Dt=[9,13,27,32],ot=Hn&&"CompositionEvent"in window,bt=null;Hn&&"documentMode"in document&&(bt=document.documentMode);var Gn=Hn&&"TextEvent"in window&&!bt,Ls=Hn&&(!ot||bt&&8<bt&&11>=bt),us=" ",cs=!1;function Xr(s,r){switch(s){case"keyup":return Dt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ho(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Go=!1;function uS(s,r){switch(s){case"compositionend":return Ho(r);case"keypress":return r.which!==32?null:(cs=!0,us);case"textInput":return s=r.data,s===us&&cs?null:s;default:return null}}function cS(s,r){if(Go)return s==="compositionend"||!ot&&Xr(s,r)?(s=yl(),$r=gl=Ds=null,Go=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ls&&r.locale!=="ko"?null:r.data;default:return null}}var dS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!dS[s.type]:r==="textarea"}function Tg(s,r,a,c){Gi?Ms?Ms.push(c):Ms=[c]:Gi=c,r=$c(r,"onChange"),0<r.length&&(a=new Ps("onChange","change",null,a,c),s.push({event:a,listeners:r}))}var El=null,xl=null;function fS(s){nv(s,0)}function rc(s){var r=Rn(s);if(zr(r))return s}function Eg(s,r){if(s==="change")return r}var xg=!1;if(Hn){var wf;if(Hn){var If="oninput"in document;if(!If){var bg=document.createElement("div");bg.setAttribute("oninput","return;"),If=typeof bg.oninput=="function"}wf=If}else wf=!1;xg=wf&&(!document.documentMode||9<document.documentMode)}function Ag(){El&&(El.detachEvent("onpropertychange",Sg),xl=El=null)}function Sg(s){if(s.propertyName==="value"&&rc(xl)){var r=[];Tg(r,xl,s,zn(s)),Yi(fS,r)}}function hS(s,r,a){s==="focusin"?(Ag(),El=r,xl=a,El.attachEvent("onpropertychange",Sg)):s==="focusout"&&Ag()}function mS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return rc(xl)}function pS(s,r){if(s==="click")return rc(r)}function gS(s,r){if(s==="input"||s==="change")return rc(r)}function yS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Dn=typeof Object.is=="function"?Object.is:yS;function bl(s,r){if(Dn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var a=Object.keys(s),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var v=a[c];if(!wt.call(r,v)||!Dn(s[v],r[v]))return!1}return!0}function Cg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function wg(s,r){var a=Cg(s);s=0;for(var c;a;){if(a.nodeType===3){if(c=s+a.textContent.length,s<=r&&c>=r)return{node:a,offset:r-s};s=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Cg(a)}}function Ig(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Ig(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ng(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Rs(s.document);r instanceof s.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)s=r.contentWindow;else break;r=Rs(s.document)}return r}function Nf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var vS=Hn&&"documentMode"in document&&11>=document.documentMode,Yo=null,Rf=null,Al=null,Mf=!1;function Rg(s,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Mf||Yo==null||Yo!==Rs(c)||(c=Yo,"selectionStart"in c&&Nf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Al&&bl(Al,c)||(Al=c,c=$c(Rf,"onSelect"),0<c.length&&(r=new Ps("onSelect","select",null,r,a),s.push({event:r,listeners:c}),r.target=Yo)))}function Wr(s,r){var a={};return a[s.toLowerCase()]=r.toLowerCase(),a["Webkit"+s]="webkit"+r,a["Moz"+s]="moz"+r,a}var $o={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionrun:Wr("Transition","TransitionRun"),transitionstart:Wr("Transition","TransitionStart"),transitioncancel:Wr("Transition","TransitionCancel"),transitionend:Wr("Transition","TransitionEnd")},Df={},Mg={};Hn&&(Mg=document.createElement("div").style,"AnimationEvent"in window||(delete $o.animationend.animation,delete $o.animationiteration.animation,delete $o.animationstart.animation),"TransitionEvent"in window||delete $o.transitionend.transition);function Zr(s){if(Df[s])return Df[s];if(!$o[s])return s;var r=$o[s],a;for(a in r)if(r.hasOwnProperty(a)&&a in Mg)return Df[s]=r[a];return s}var Dg=Zr("animationend"),Pg=Zr("animationiteration"),kg=Zr("animationstart"),_S=Zr("transitionrun"),TS=Zr("transitionstart"),ES=Zr("transitioncancel"),Vg=Zr("transitionend"),Lg=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function ds(s,r){Lg.set(s,r),Is(r,[s])}var oc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Yn=[],Jo=0,kf=0;function ac(){for(var s=Jo,r=kf=Jo=0;r<s;){var a=Yn[r];Yn[r++]=null;var c=Yn[r];Yn[r++]=null;var v=Yn[r];Yn[r++]=null;var _=Yn[r];if(Yn[r++]=null,c!==null&&v!==null){var A=c.pending;A===null?v.next=v:(v.next=A.next,A.next=v),c.pending=v}_!==0&&Ug(a,v,_)}}function lc(s,r,a,c){Yn[Jo++]=s,Yn[Jo++]=r,Yn[Jo++]=a,Yn[Jo++]=c,kf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Vf(s,r,a,c){return lc(s,r,a,c),uc(s)}function eo(s,r){return lc(s,null,null,r),uc(s)}function Ug(s,r,a){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a);for(var v=!1,_=s.return;_!==null;)_.childLanes|=a,c=_.alternate,c!==null&&(c.childLanes|=a),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&r!==null&&(v=31-Ue(a),s=_.hiddenUpdates,c=s[v],c===null?s[v]=[r]:c.push(r),r.lane=a|536870912),_):null}function uc(s){if(50<Yl)throw Yl=0,Hh=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Ko={};function xS(s,r,a,c){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(s,r,a,c){return new xS(s,r,a,c)}function Lf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function si(s,r){var a=s.alternate;return a===null?(a=Pn(s.tag,r,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=r,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,r=s.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function Og(s,r){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,r=a.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function cc(s,r,a,c,v,_){var A=0;if(c=s,typeof s=="function")Lf(s)&&(A=1);else if(typeof s=="string")A=wC(s,a,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case N:return s=Pn(31,a,r,v),s.elementType=N,s.lanes=_,s;case U:return to(a.children,v,_,r);case H:A=8,v|=24;break;case ne:return s=Pn(12,a,r,v|2),s.elementType=ne,s.lanes=_,s;case Z:return s=Pn(13,a,r,v),s.elementType=Z,s.lanes=_,s;case W:return s=Pn(19,a,r,v),s.elementType=W,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:A=10;break e;case F:A=9;break e;case z:A=11;break e;case R:A=14;break e;case C:A=16,c=null;break e}A=29,a=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=Pn(A,a,r,v),r.elementType=s,r.type=c,r.lanes=_,r}function to(s,r,a,c){return s=Pn(7,s,c,r),s.lanes=a,s}function Uf(s,r,a){return s=Pn(6,s,null,r),s.lanes=a,s}function jg(s){var r=Pn(18,null,null,0);return r.stateNode=s,r}function Of(s,r,a){return r=Pn(4,s.children!==null?s.children:[],s.key,r),r.lanes=a,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Fg=new WeakMap;function $n(s,r){if(typeof s=="object"&&s!==null){var a=Fg.get(s);return a!==void 0?a:(r={value:s,source:r,stack:Ur(r)},Fg.set(s,r),r)}return{value:s,source:r,stack:Ur(r)}}var Qo=[],Xo=0,dc=null,Sl=0,Jn=[],Kn=0,Qi=null,Us=1,Os="";function ii(s,r){Qo[Xo++]=Sl,Qo[Xo++]=dc,dc=s,Sl=r}function qg(s,r,a){Jn[Kn++]=Us,Jn[Kn++]=Os,Jn[Kn++]=Qi,Qi=s;var c=Us;s=Os;var v=32-Ue(c)-1;c&=~(1<<v),a+=1;var _=32-Ue(r)+v;if(30<_){var A=v-v%5;_=(c&(1<<A)-1).toString(32),c>>=A,v-=A,Us=1<<32-Ue(r)+v|a<<v|c,Os=_+s}else Us=1<<_|a<<v|c,Os=s}function jf(s){s.return!==null&&(ii(s,1),qg(s,1,0))}function Ff(s){for(;s===dc;)dc=Qo[--Xo],Qo[Xo]=null,Sl=Qo[--Xo],Qo[Xo]=null;for(;s===Qi;)Qi=Jn[--Kn],Jn[Kn]=null,Os=Jn[--Kn],Jn[Kn]=null,Us=Jn[--Kn],Jn[Kn]=null}function Bg(s,r){Jn[Kn++]=Us,Jn[Kn++]=Os,Jn[Kn++]=Qi,Us=r.id,Os=r.overflow,Qi=s}var on=null,_t=null,We=!1,Xi=null,Qn=!1,qf=Error(i(519));function Wi(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Cl($n(r,s)),qf}function zg(s){var r=s.stateNode,a=s.type,c=s.memoizedProps;switch(r[Ot]=s,r[Wt]=c,a){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(a=0;a<Jl.length;a++)Ge(Jl[a],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":Ge("invalid",r),Hu(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ge("invalid",r);break;case"textarea":Ge("invalid",r),zi(r,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||c.suppressHydrationWarning===!0||ov(r.textContent,a)?(c.popover!=null&&(Ge("beforetoggle",r),Ge("toggle",r)),c.onScroll!=null&&Ge("scroll",r),c.onScrollEnd!=null&&Ge("scrollend",r),c.onClick!=null&&(r.onclick=os),r=!0):r=!1,r||Wi(s,!0)}function Hg(s){for(on=s.return;on;)switch(on.tag){case 5:case 31:case 13:Qn=!1;return;case 27:case 3:Qn=!0;return;default:on=on.return}}function Wo(s){if(s!==on)return!1;if(!We)return Hg(s),We=!0,!1;var r=s.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||rm(s.type,s.memoizedProps)),a=!a),a&&_t&&Wi(s),Hg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));_t=pv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));_t=pv(s)}else r===27?(r=_t,fr(s.type)?(s=cm,cm=null,_t=s):_t=r):_t=on?Wn(s.stateNode.nextSibling):null;return!0}function no(){_t=on=null,We=!1}function Bf(){var s=Xi;return s!==null&&(wn===null?wn=s:wn.push.apply(wn,s),Xi=null),s}function Cl(s){Xi===null?Xi=[s]:Xi.push(s)}var zf=q(null),so=null,ri=null;function Zi(s,r,a){ye(zf,r._currentValue),r._currentValue=a}function oi(s){s._currentValue=zf.current,re(zf)}function Hf(s,r,a){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===a)break;s=s.return}}function Gf(s,r,a,c){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var A=v.child;_=_.firstContext;e:for(;_!==null;){var I=_;_=v;for(var L=0;L<r.length;L++)if(I.context===r[L]){_.lanes|=a,I=_.alternate,I!==null&&(I.lanes|=a),Hf(_.return,a,s),c||(A=null);break e}_=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(i(341));A.lanes|=a,_=A.alternate,_!==null&&(_.lanes|=a),Hf(A,a,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function Zo(s,r,a,c){s=null;for(var v=r,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var I=v.type;Dn(v.pendingProps.value,A.value)||(s!==null?s.push(I):s=[I])}}else if(v===be.current){if(A=v.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Zl):s=[Zl])}v=v.return}s!==null&&Gf(r,s,a,c),r.flags|=262144}function fc(s){for(s=s.firstContext;s!==null;){if(!Dn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function io(s){so=s,ri=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function an(s){return Gg(so,s)}function hc(s,r){return so===null&&io(s),Gg(s,r)}function Gg(s,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},ri===null){if(s===null)throw Error(i(308));ri=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ri=ri.next=r;return a}var bS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(a,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(a){return a()})}},AS=n.unstable_scheduleCallback,SS=n.unstable_NormalPriority,qt={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new bS,data:new Map,refCount:0}}function wl(s){s.refCount--,s.refCount===0&&AS(SS,function(){s.controller.abort()})}var Il=null,$f=0,ea=0,ta=null;function CS(s,r){if(Il===null){var a=Il=[];$f=0,ea=Qh(),ta={status:"pending",value:void 0,then:function(c){a.push(c)}}}return $f++,r.then(Yg,Yg),r}function Yg(){if(--$f===0&&Il!==null){ta!==null&&(ta.status="fulfilled");var s=Il;Il=null,ea=0,ta=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function wS(s,r){var a=[],c={status:"pending",value:null,reason:null,then:function(v){a.push(v)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var v=0;v<a.length;v++)(0,a[v])(r)},function(v){for(c.status="rejected",c.reason=v,v=0;v<a.length;v++)(0,a[v])(void 0)}),c}var $g=$.S;$.S=function(s,r){R0=Xt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&CS(s,r),$g!==null&&$g(s,r)};var ro=q(null);function Jf(){var s=ro.current;return s!==null?s:yt.pooledCache}function mc(s,r){r===null?ye(ro,ro.current):ye(ro,r.pool)}function Jg(){var s=Jf();return s===null?null:{parent:qt._currentValue,pool:s}}var na=Error(i(460)),Kf=Error(i(474)),pc=Error(i(542)),gc={then:function(){}};function Kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Qg(s,r,a){switch(a=s[a],a===void 0?s.push(r):a!==r&&(r.then(os,os),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s;default:if(typeof r.status=="string")r.then(os,os);else{if(s=yt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var v=r;v.status="fulfilled",v.value=c}},function(c){if(r.status==="pending"){var v=r;v.status="rejected",v.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s}throw ao=r,na}}function oo(s){try{var r=s._init;return r(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(ao=a,na):a}}var ao=null;function Xg(){if(ao===null)throw Error(i(459));var s=ao;return ao=null,s}function Wg(s){if(s===na||s===pc)throw Error(i(483))}var sa=null,Nl=0;function yc(s){var r=Nl;return Nl+=1,sa===null&&(sa=[]),Qg(sa,s,r)}function Rl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function vc(s,r){throw r.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Zg(s){function r(G,B){if(s){var K=G.deletions;K===null?(G.deletions=[B],G.flags|=16):K.push(B)}}function a(G,B){if(!s)return null;for(;B!==null;)r(G,B),B=B.sibling;return null}function c(G){for(var B=new Map;G!==null;)G.key!==null?B.set(G.key,G):B.set(G.index,G),G=G.sibling;return B}function v(G,B){return G=si(G,B),G.index=0,G.sibling=null,G}function _(G,B,K){return G.index=K,s?(K=G.alternate,K!==null?(K=K.index,K<B?(G.flags|=67108866,B):K):(G.flags|=67108866,B)):(G.flags|=1048576,B)}function A(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function I(G,B,K,oe){return B===null||B.tag!==6?(B=Uf(K,G.mode,oe),B.return=G,B):(B=v(B,K),B.return=G,B)}function L(G,B,K,oe){var Ie=K.type;return Ie===U?se(G,B,K.props.children,oe,K.key):B!==null&&(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===C&&oo(Ie)===B.type)?(B=v(B,K.props),Rl(B,K),B.return=G,B):(B=cc(K.type,K.key,K.props,null,G.mode,oe),Rl(B,K),B.return=G,B)}function Q(G,B,K,oe){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=Of(K,G.mode,oe),B.return=G,B):(B=v(B,K.children||[]),B.return=G,B)}function se(G,B,K,oe,Ie){return B===null||B.tag!==7?(B=to(K,G.mode,oe,Ie),B.return=G,B):(B=v(B,K),B.return=G,B)}function ae(G,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Uf(""+B,G.mode,K),B.return=G,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case w:return K=cc(B.type,B.key,B.props,null,G.mode,K),Rl(K,B),K.return=G,K;case P:return B=Of(B,G.mode,K),B.return=G,B;case C:return B=oo(B),ae(G,B,K)}if(he(B)||j(B))return B=to(B,G.mode,K,null),B.return=G,B;if(typeof B.then=="function")return ae(G,yc(B),K);if(B.$$typeof===O)return ae(G,hc(G,B),K);vc(G,B)}return null}function X(G,B,K,oe){var Ie=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Ie!==null?null:I(G,B,""+K,oe);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return K.key===Ie?L(G,B,K,oe):null;case P:return K.key===Ie?Q(G,B,K,oe):null;case C:return K=oo(K),X(G,B,K,oe)}if(he(K)||j(K))return Ie!==null?null:se(G,B,K,oe,null);if(typeof K.then=="function")return X(G,B,yc(K),oe);if(K.$$typeof===O)return X(G,B,hc(G,K),oe);vc(G,K)}return null}function te(G,B,K,oe,Ie){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return G=G.get(K)||null,I(B,G,""+oe,Ie);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case w:return G=G.get(oe.key===null?K:oe.key)||null,L(B,G,oe,Ie);case P:return G=G.get(oe.key===null?K:oe.key)||null,Q(B,G,oe,Ie);case C:return oe=oo(oe),te(G,B,K,oe,Ie)}if(he(oe)||j(oe))return G=G.get(K)||null,se(B,G,oe,Ie,null);if(typeof oe.then=="function")return te(G,B,K,yc(oe),Ie);if(oe.$$typeof===O)return te(G,B,K,hc(B,oe),Ie);vc(B,oe)}return null}function Ae(G,B,K,oe){for(var Ie=null,st=null,we=B,ze=B=0,Je=null;we!==null&&ze<K.length;ze++){we.index>ze?(Je=we,we=null):Je=we.sibling;var it=X(G,we,K[ze],oe);if(it===null){we===null&&(we=Je);break}s&&we&&it.alternate===null&&r(G,we),B=_(it,B,ze),st===null?Ie=it:st.sibling=it,st=it,we=Je}if(ze===K.length)return a(G,we),We&&ii(G,ze),Ie;if(we===null){for(;ze<K.length;ze++)we=ae(G,K[ze],oe),we!==null&&(B=_(we,B,ze),st===null?Ie=we:st.sibling=we,st=we);return We&&ii(G,ze),Ie}for(we=c(we);ze<K.length;ze++)Je=te(we,G,ze,K[ze],oe),Je!==null&&(s&&Je.alternate!==null&&we.delete(Je.key===null?ze:Je.key),B=_(Je,B,ze),st===null?Ie=Je:st.sibling=Je,st=Je);return s&&we.forEach(function(yr){return r(G,yr)}),We&&ii(G,ze),Ie}function Me(G,B,K,oe){if(K==null)throw Error(i(151));for(var Ie=null,st=null,we=B,ze=B=0,Je=null,it=K.next();we!==null&&!it.done;ze++,it=K.next()){we.index>ze?(Je=we,we=null):Je=we.sibling;var yr=X(G,we,it.value,oe);if(yr===null){we===null&&(we=Je);break}s&&we&&yr.alternate===null&&r(G,we),B=_(yr,B,ze),st===null?Ie=yr:st.sibling=yr,st=yr,we=Je}if(it.done)return a(G,we),We&&ii(G,ze),Ie;if(we===null){for(;!it.done;ze++,it=K.next())it=ae(G,it.value,oe),it!==null&&(B=_(it,B,ze),st===null?Ie=it:st.sibling=it,st=it);return We&&ii(G,ze),Ie}for(we=c(we);!it.done;ze++,it=K.next())it=te(we,G,ze,it.value,oe),it!==null&&(s&&it.alternate!==null&&we.delete(it.key===null?ze:it.key),B=_(it,B,ze),st===null?Ie=it:st.sibling=it,st=it);return s&&we.forEach(function(OC){return r(G,OC)}),We&&ii(G,ze),Ie}function gt(G,B,K,oe){if(typeof K=="object"&&K!==null&&K.type===U&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case w:e:{for(var Ie=K.key;B!==null;){if(B.key===Ie){if(Ie=K.type,Ie===U){if(B.tag===7){a(G,B.sibling),oe=v(B,K.props.children),oe.return=G,G=oe;break e}}else if(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===C&&oo(Ie)===B.type){a(G,B.sibling),oe=v(B,K.props),Rl(oe,K),oe.return=G,G=oe;break e}a(G,B);break}else r(G,B);B=B.sibling}K.type===U?(oe=to(K.props.children,G.mode,oe,K.key),oe.return=G,G=oe):(oe=cc(K.type,K.key,K.props,null,G.mode,oe),Rl(oe,K),oe.return=G,G=oe)}return A(G);case P:e:{for(Ie=K.key;B!==null;){if(B.key===Ie)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){a(G,B.sibling),oe=v(B,K.children||[]),oe.return=G,G=oe;break e}else{a(G,B);break}else r(G,B);B=B.sibling}oe=Of(K,G.mode,oe),oe.return=G,G=oe}return A(G);case C:return K=oo(K),gt(G,B,K,oe)}if(he(K))return Ae(G,B,K,oe);if(j(K)){if(Ie=j(K),typeof Ie!="function")throw Error(i(150));return K=Ie.call(K),Me(G,B,K,oe)}if(typeof K.then=="function")return gt(G,B,yc(K),oe);if(K.$$typeof===O)return gt(G,B,hc(G,K),oe);vc(G,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(a(G,B.sibling),oe=v(B,K),oe.return=G,G=oe):(a(G,B),oe=Uf(K,G.mode,oe),oe.return=G,G=oe),A(G)):a(G,B)}return function(G,B,K,oe){try{Nl=0;var Ie=gt(G,B,K,oe);return sa=null,Ie}catch(we){if(we===na||we===pc)throw we;var st=Pn(29,we,null,G.mode);return st.lanes=oe,st.return=G,st}finally{}}}var lo=Zg(!0),ey=Zg(!1),er=!1;function Qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function tr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function nr(s,r,a){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var v=c.pending;return v===null?r.next=r:(r.next=v.next,v.next=r),c.pending=r,r=uc(s),Ug(s,null,a),r}return lc(s,c,r,a),uc(s)}function Ml(s,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,il(s,a)}}function Wf(s,r){var a=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var v=null,_=null;if(a=a.firstBaseUpdate,a!==null){do{var A={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};_===null?v=_=A:_=_.next=A,a=a.next}while(a!==null);_===null?v=_=r:_=_.next=r}else v=_=r;a={baseState:c.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:c.shared,callbacks:c.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=r:s.next=r,a.lastBaseUpdate=r}var Zf=!1;function Dl(){if(Zf){var s=ta;if(s!==null)throw s}}function Pl(s,r,a,c){Zf=!1;var v=s.updateQueue;er=!1;var _=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var L=I,Q=L.next;L.next=null,A===null?_=Q:A.next=Q,A=L;var se=s.alternate;se!==null&&(se=se.updateQueue,I=se.lastBaseUpdate,I!==A&&(I===null?se.firstBaseUpdate=Q:I.next=Q,se.lastBaseUpdate=L))}if(_!==null){var ae=v.baseState;A=0,se=Q=L=null,I=_;do{var X=I.lane&-536870913,te=X!==I.lane;if(te?($e&X)===X:(c&X)===X){X!==0&&X===ea&&(Zf=!0),se!==null&&(se=se.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Ae=s,Me=I;X=r;var gt=a;switch(Me.tag){case 1:if(Ae=Me.payload,typeof Ae=="function"){ae=Ae.call(gt,ae,X);break e}ae=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Me.payload,X=typeof Ae=="function"?Ae.call(gt,ae,X):Ae,X==null)break e;ae=E({},ae,X);break e;case 2:er=!0}}X=I.callback,X!==null&&(s.flags|=64,te&&(s.flags|=8192),te=v.callbacks,te===null?v.callbacks=[X]:te.push(X))}else te={lane:X,tag:I.tag,payload:I.payload,callback:I.callback,next:null},se===null?(Q=se=te,L=ae):se=se.next=te,A|=X;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;te=I,I=te.next,te.next=null,v.lastBaseUpdate=te,v.shared.pending=null}}while(!0);se===null&&(L=ae),v.baseState=L,v.firstBaseUpdate=Q,v.lastBaseUpdate=se,_===null&&(v.shared.lanes=0),ar|=A,s.lanes=A,s.memoizedState=ae}}function ty(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function ny(s,r){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)ty(a[s],r)}var ia=q(null),_c=q(0);function sy(s,r){s=pi,ye(_c,s),ye(ia,r),pi=s|r.baseLanes}function eh(){ye(_c,pi),ye(ia,ia.current)}function th(){pi=_c.current,re(ia),re(_c)}var kn=q(null),Xn=null;function sr(s){var r=s.alternate;ye(Pt,Pt.current&1),ye(kn,s),Xn===null&&(r===null||ia.current!==null||r.memoizedState!==null)&&(Xn=s)}function nh(s){ye(Pt,Pt.current),ye(kn,s),Xn===null&&(Xn=s)}function iy(s){s.tag===22?(ye(Pt,Pt.current),ye(kn,s),Xn===null&&(Xn=s)):ir()}function ir(){ye(Pt,Pt.current),ye(kn,kn.current)}function Vn(s){re(kn),Xn===s&&(Xn=null),re(Pt)}var Pt=q(0);function Tc(s){for(var r=s;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||lm(a)||um(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ai=0,qe=null,mt=null,Bt=null,Ec=!1,ra=!1,uo=!1,xc=0,kl=0,oa=null,IS=0;function Nt(){throw Error(i(321))}function sh(s,r){if(r===null)return!1;for(var a=0;a<r.length&&a<s.length;a++)if(!Dn(s[a],r[a]))return!1;return!0}function ih(s,r,a,c,v,_){return ai=_,qe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,$.H=s===null||s.memoizedState===null?qy:_h,uo=!1,_=a(c,v),uo=!1,ra&&(_=oy(r,a,c,v)),ry(s),_}function ry(s){$.H=Ul;var r=mt!==null&&mt.next!==null;if(ai=0,Bt=mt=qe=null,Ec=!1,kl=0,oa=null,r)throw Error(i(300));s===null||zt||(s=s.dependencies,s!==null&&fc(s)&&(zt=!0))}function oy(s,r,a,c){qe=s;var v=0;do{if(ra&&(oa=null),kl=0,ra=!1,25<=v)throw Error(i(301));if(v+=1,Bt=mt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}$.H=By,_=r(a,c)}while(ra);return _}function NS(){var s=$.H,r=s.useState()[0];return r=typeof r.then=="function"?Vl(r):r,s=s.useState()[0],(mt!==null?mt.memoizedState:null)!==s&&(qe.flags|=1024),r}function rh(){var s=xc!==0;return xc=0,s}function oh(s,r,a){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~a}function ah(s){if(Ec){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Ec=!1}ai=0,Bt=mt=qe=null,ra=!1,kl=xc=0,oa=null}function vn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?qe.memoizedState=Bt=s:Bt=Bt.next=s,Bt}function kt(){if(mt===null){var s=qe.alternate;s=s!==null?s.memoizedState:null}else s=mt.next;var r=Bt===null?qe.memoizedState:Bt.next;if(r!==null)Bt=r,mt=s;else{if(s===null)throw qe.alternate===null?Error(i(467)):Error(i(310));mt=s,s={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Bt===null?qe.memoizedState=Bt=s:Bt=Bt.next=s}return Bt}function bc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vl(s){var r=kl;return kl+=1,oa===null&&(oa=[]),s=Qg(oa,s,r),r=qe,(Bt===null?r.memoizedState:Bt.next)===null&&(r=r.alternate,$.H=r===null||r.memoizedState===null?qy:_h),s}function Ac(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Vl(s);if(s.$$typeof===O)return an(s)}throw Error(i(438,String(s)))}function lh(s){var r=null,a=qe.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var c=qe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(v){return v.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=bc(),qe.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(s),c=0;c<s;c++)a[c]=k;return r.index++,a}function li(s,r){return typeof r=="function"?r(s):r}function Sc(s){var r=kt();return uh(r,mt,s)}function uh(s,r,a){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var v=s.baseQueue,_=c.pending;if(_!==null){if(v!==null){var A=v.next;v.next=_.next,_.next=A}r.baseQueue=v=_,c.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{r=v.next;var I=A=null,L=null,Q=r,se=!1;do{var ae=Q.lane&-536870913;if(ae!==Q.lane?($e&ae)===ae:(ai&ae)===ae){var X=Q.revertLane;if(X===0)L!==null&&(L=L.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ae===ea&&(se=!0);else if((ai&X)===X){Q=Q.next,X===ea&&(se=!0);continue}else ae={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},L===null?(I=L=ae,A=_):L=L.next=ae,qe.lanes|=X,ar|=X;ae=Q.action,uo&&a(_,ae),_=Q.hasEagerState?Q.eagerState:a(_,ae)}else X={lane:ae,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},L===null?(I=L=X,A=_):L=L.next=X,qe.lanes|=ae,ar|=ae;Q=Q.next}while(Q!==null&&Q!==r);if(L===null?A=_:L.next=I,!Dn(_,s.memoizedState)&&(zt=!0,se&&(a=ta,a!==null)))throw a;s.memoizedState=_,s.baseState=A,s.baseQueue=L,c.lastRenderedState=_}return v===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function ch(s){var r=kt(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=s;var c=a.dispatch,v=a.pending,_=r.memoizedState;if(v!==null){a.pending=null;var A=v=v.next;do _=s(_,A.action),A=A.next;while(A!==v);Dn(_,r.memoizedState)||(zt=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),a.lastRenderedState=_}return[_,c]}function ay(s,r,a){var c=qe,v=kt(),_=We;if(_){if(a===void 0)throw Error(i(407));a=a()}else a=r();var A=!Dn((mt||v).memoizedState,a);if(A&&(v.memoizedState=a,zt=!0),v=v.queue,hh(cy.bind(null,c,v,s),[s]),v.getSnapshot!==r||A||Bt!==null&&Bt.memoizedState.tag&1){if(c.flags|=2048,aa(9,{destroy:void 0},uy.bind(null,c,v,a,r),null),yt===null)throw Error(i(349));_||(ai&127)!==0||ly(c,r,a)}return a}function ly(s,r,a){s.flags|=16384,s={getSnapshot:r,value:a},r=qe.updateQueue,r===null?(r=bc(),qe.updateQueue=r,r.stores=[s]):(a=r.stores,a===null?r.stores=[s]:a.push(s))}function uy(s,r,a,c){r.value=a,r.getSnapshot=c,dy(r)&&fy(s)}function cy(s,r,a){return a(function(){dy(r)&&fy(s)})}function dy(s){var r=s.getSnapshot;s=s.value;try{var a=r();return!Dn(s,a)}catch{return!0}}function fy(s){var r=eo(s,2);r!==null&&In(r,s,2)}function dh(s){var r=vn();if(typeof s=="function"){var a=s;if(s=a(),uo){Re(!0);try{a()}finally{Re(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:s},r}function hy(s,r,a,c){return s.baseState=a,uh(s,mt,typeof c=="function"?c:li)}function RS(s,r,a,c,v){if(Ic(s))throw Error(i(485));if(s=r.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};$.T!==null?a(!0):_.isTransition=!1,c(_),a=r.pending,a===null?(_.next=r.pending=_,my(r,_)):(_.next=a.next,r.pending=a.next=_)}}function my(s,r){var a=r.action,c=r.payload,v=s.state;if(r.isTransition){var _=$.T,A={};$.T=A;try{var I=a(v,c),L=$.S;L!==null&&L(A,I),py(s,r,I)}catch(Q){fh(s,r,Q)}finally{_!==null&&A.types!==null&&(_.types=A.types),$.T=_}}else try{_=a(v,c),py(s,r,_)}catch(Q){fh(s,r,Q)}}function py(s,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){gy(s,r,c)},function(c){return fh(s,r,c)}):gy(s,r,a)}function gy(s,r,a){r.status="fulfilled",r.value=a,yy(r),s.state=a,r=s.pending,r!==null&&(a=r.next,a===r?s.pending=null:(a=a.next,r.next=a,my(s,a)))}function fh(s,r,a){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=a,yy(r),r=r.next;while(r!==c)}s.action=null}function yy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function vy(s,r){return r}function _y(s,r){if(We){var a=yt.formState;if(a!==null){e:{var c=qe;if(We){if(_t){t:{for(var v=_t,_=Qn;v.nodeType!==8;){if(!_){v=null;break t}if(v=Wn(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){_t=Wn(v.nextSibling),c=v.data==="F!";break e}}Wi(c)}c=!1}c&&(r=a[0])}}return a=vn(),a.memoizedState=a.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vy,lastRenderedState:r},a.queue=c,a=Oy.bind(null,qe,c),c.dispatch=a,c=dh(!1),_=vh.bind(null,qe,!1,c.queue),c=vn(),v={state:r,dispatch:null,action:s,pending:null},c.queue=v,a=RS.bind(null,qe,v,_,a),v.dispatch=a,c.memoizedState=s,[r,a,!1]}function Ty(s){var r=kt();return Ey(r,mt,s)}function Ey(s,r,a){if(r=uh(s,r,vy)[0],s=Sc(li)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Vl(r)}catch(A){throw A===na?pc:A}else c=r;r=kt();var v=r.queue,_=v.dispatch;return a!==r.memoizedState&&(qe.flags|=2048,aa(9,{destroy:void 0},MS.bind(null,v,a),null)),[c,_,s]}function MS(s,r){s.action=r}function xy(s){var r=kt(),a=mt;if(a!==null)return Ey(r,a,s);kt(),r=r.memoizedState,a=kt();var c=a.queue.dispatch;return a.memoizedState=s,[r,c,!1]}function aa(s,r,a,c){return s={tag:s,create:a,deps:c,inst:r,next:null},r=qe.updateQueue,r===null&&(r=bc(),qe.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=s.next=s:(c=a.next,a.next=s,s.next=c,r.lastEffect=s),s}function by(){return kt().memoizedState}function Cc(s,r,a,c){var v=vn();qe.flags|=s,v.memoizedState=aa(1|r,{destroy:void 0},a,c===void 0?null:c)}function wc(s,r,a,c){var v=kt();c=c===void 0?null:c;var _=v.memoizedState.inst;mt!==null&&c!==null&&sh(c,mt.memoizedState.deps)?v.memoizedState=aa(r,_,a,c):(qe.flags|=s,v.memoizedState=aa(1|r,_,a,c))}function Ay(s,r){Cc(8390656,8,s,r)}function hh(s,r){wc(2048,8,s,r)}function DS(s){qe.flags|=4;var r=qe.updateQueue;if(r===null)r=bc(),qe.updateQueue=r,r.events=[s];else{var a=r.events;a===null?r.events=[s]:a.push(s)}}function Sy(s){var r=kt().memoizedState;return DS({ref:r,nextImpl:s}),function(){if((at&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Cy(s,r){return wc(4,2,s,r)}function wy(s,r){return wc(4,4,s,r)}function Iy(s,r){if(typeof r=="function"){s=s();var a=r(s);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Ny(s,r,a){a=a!=null?a.concat([s]):null,wc(4,4,Iy.bind(null,r,s),a)}function mh(){}function Ry(s,r){var a=kt();r=r===void 0?null:r;var c=a.memoizedState;return r!==null&&sh(r,c[1])?c[0]:(a.memoizedState=[s,r],s)}function My(s,r){var a=kt();r=r===void 0?null:r;var c=a.memoizedState;if(r!==null&&sh(r,c[1]))return c[0];if(c=s(),uo){Re(!0);try{s()}finally{Re(!1)}}return a.memoizedState=[c,r],c}function ph(s,r,a){return a===void 0||(ai&1073741824)!==0&&($e&261930)===0?s.memoizedState=r:(s.memoizedState=a,s=D0(),qe.lanes|=s,ar|=s,a)}function Dy(s,r,a,c){return Dn(a,r)?a:ia.current!==null?(s=ph(s,a,c),Dn(s,r)||(zt=!0),s):(ai&42)===0||(ai&1073741824)!==0&&($e&261930)===0?(zt=!0,s.memoizedState=a):(s=D0(),qe.lanes|=s,ar|=s,r)}function Py(s,r,a,c,v){var _=de.p;de.p=_!==0&&8>_?_:8;var A=$.T,I={};$.T=I,vh(s,!1,r,a);try{var L=v(),Q=$.S;if(Q!==null&&Q(I,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var se=wS(L,c);Ll(s,r,se,On(s))}else Ll(s,r,c,On(s))}catch(ae){Ll(s,r,{then:function(){},status:"rejected",reason:ae},On())}finally{de.p=_,A!==null&&I.types!==null&&(A.types=I.types),$.T=A}}function PS(){}function gh(s,r,a,c){if(s.tag!==5)throw Error(i(476));var v=ky(s).queue;Py(s,v,r,ve,a===null?PS:function(){return Vy(s),a(c)})}function ky(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:ve},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:a},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Vy(s){var r=ky(s);r.next===null&&(r=s.alternate.memoizedState),Ll(s,r.next.queue,{},On())}function yh(){return an(Zl)}function Ly(){return kt().memoizedState}function Uy(){return kt().memoizedState}function kS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var a=On();s=tr(a);var c=nr(r,s,a);c!==null&&(In(c,r,a),Ml(c,r,a)),r={cache:Yf()},s.payload=r;return}r=r.return}}function VS(s,r,a){var c=On();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Ic(s)?jy(r,a):(a=Vf(s,r,a,c),a!==null&&(In(a,s,c),Fy(a,r,c)))}function Oy(s,r,a){var c=On();Ll(s,r,a,c)}function Ll(s,r,a,c){var v={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ic(s))jy(r,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var A=r.lastRenderedState,I=_(A,a);if(v.hasEagerState=!0,v.eagerState=I,Dn(I,A))return lc(s,r,v,0),yt===null&&ac(),!1}catch{}finally{}if(a=Vf(s,r,v,c),a!==null)return In(a,s,c),Fy(a,r,c),!0}return!1}function vh(s,r,a,c){if(c={lane:2,revertLane:Qh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ic(s)){if(r)throw Error(i(479))}else r=Vf(s,a,c,2),r!==null&&In(r,s,2)}function Ic(s){var r=s.alternate;return s===qe||r!==null&&r===qe}function jy(s,r){ra=Ec=!0;var a=s.pending;a===null?r.next=r:(r.next=a.next,a.next=r),s.pending=r}function Fy(s,r,a){if((a&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,il(s,a)}}var Ul={readContext:an,use:Ac,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};Ul.useEffectEvent=Nt;var qy={readContext:an,use:Ac,useCallback:function(s,r){return vn().memoizedState=[s,r===void 0?null:r],s},useContext:an,useEffect:Ay,useImperativeHandle:function(s,r,a){a=a!=null?a.concat([s]):null,Cc(4194308,4,Iy.bind(null,r,s),a)},useLayoutEffect:function(s,r){return Cc(4194308,4,s,r)},useInsertionEffect:function(s,r){Cc(4,2,s,r)},useMemo:function(s,r){var a=vn();r=r===void 0?null:r;var c=s();if(uo){Re(!0);try{s()}finally{Re(!1)}}return a.memoizedState=[c,r],c},useReducer:function(s,r,a){var c=vn();if(a!==void 0){var v=a(r);if(uo){Re(!0);try{a(r)}finally{Re(!1)}}}else v=r;return c.memoizedState=c.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},c.queue=s,s=s.dispatch=VS.bind(null,qe,s),[c.memoizedState,s]},useRef:function(s){var r=vn();return s={current:s},r.memoizedState=s},useState:function(s){s=dh(s);var r=s.queue,a=Oy.bind(null,qe,r);return r.dispatch=a,[s.memoizedState,a]},useDebugValue:mh,useDeferredValue:function(s,r){var a=vn();return ph(a,s,r)},useTransition:function(){var s=dh(!1);return s=Py.bind(null,qe,s.queue,!0,!1),vn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,a){var c=qe,v=vn();if(We){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),yt===null)throw Error(i(349));($e&127)!==0||ly(c,r,a)}v.memoizedState=a;var _={value:a,getSnapshot:r};return v.queue=_,Ay(cy.bind(null,c,_,s),[s]),c.flags|=2048,aa(9,{destroy:void 0},uy.bind(null,c,_,a,r),null),a},useId:function(){var s=vn(),r=yt.identifierPrefix;if(We){var a=Os,c=Us;a=(c&~(1<<32-Ue(c)-1)).toString(32)+a,r="_"+r+"R_"+a,a=xc++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=IS++,r="_"+r+"r_"+a.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:yh,useFormState:_y,useActionState:_y,useOptimistic:function(s){var r=vn();r.memoizedState=r.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=vh.bind(null,qe,!0,a),a.dispatch=r,[s,r]},useMemoCache:lh,useCacheRefresh:function(){return vn().memoizedState=kS.bind(null,qe)},useEffectEvent:function(s){var r=vn(),a={impl:s};return r.memoizedState=a,function(){if((at&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}},_h={readContext:an,use:Ac,useCallback:Ry,useContext:an,useEffect:hh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:My,useReducer:Sc,useRef:by,useState:function(){return Sc(li)},useDebugValue:mh,useDeferredValue:function(s,r){var a=kt();return Dy(a,mt.memoizedState,s,r)},useTransition:function(){var s=Sc(li)[0],r=kt().memoizedState;return[typeof s=="boolean"?s:Vl(s),r]},useSyncExternalStore:ay,useId:Ly,useHostTransitionStatus:yh,useFormState:Ty,useActionState:Ty,useOptimistic:function(s,r){var a=kt();return hy(a,mt,s,r)},useMemoCache:lh,useCacheRefresh:Uy};_h.useEffectEvent=Sy;var By={readContext:an,use:Ac,useCallback:Ry,useContext:an,useEffect:hh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:My,useReducer:ch,useRef:by,useState:function(){return ch(li)},useDebugValue:mh,useDeferredValue:function(s,r){var a=kt();return mt===null?ph(a,s,r):Dy(a,mt.memoizedState,s,r)},useTransition:function(){var s=ch(li)[0],r=kt().memoizedState;return[typeof s=="boolean"?s:Vl(s),r]},useSyncExternalStore:ay,useId:Ly,useHostTransitionStatus:yh,useFormState:xy,useActionState:xy,useOptimistic:function(s,r){var a=kt();return mt!==null?hy(a,mt,s,r):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:lh,useCacheRefresh:Uy};By.useEffectEvent=Sy;function Th(s,r,a,c){r=s.memoizedState,a=a(c,r),a=a==null?r:E({},r,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Eh={enqueueSetState:function(s,r,a){s=s._reactInternals;var c=On(),v=tr(c);v.payload=r,a!=null&&(v.callback=a),r=nr(s,v,c),r!==null&&(In(r,s,c),Ml(r,s,c))},enqueueReplaceState:function(s,r,a){s=s._reactInternals;var c=On(),v=tr(c);v.tag=1,v.payload=r,a!=null&&(v.callback=a),r=nr(s,v,c),r!==null&&(In(r,s,c),Ml(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var a=On(),c=tr(a);c.tag=2,r!=null&&(c.callback=r),r=nr(s,c,a),r!==null&&(In(r,s,a),Ml(r,s,a))}};function zy(s,r,a,c,v,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,_,A):r.prototype&&r.prototype.isPureReactComponent?!bl(a,c)||!bl(v,_):!0}function Hy(s,r,a,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==s&&Eh.enqueueReplaceState(r,r.state,null)}function co(s,r){var a=r;if("ref"in r){a={};for(var c in r)c!=="ref"&&(a[c]=r[c])}if(s=s.defaultProps){a===r&&(a=E({},a));for(var v in s)a[v]===void 0&&(a[v]=s[v])}return a}function Gy(s){oc(s)}function Yy(s){console.error(s)}function $y(s){oc(s)}function Nc(s,r){try{var a=s.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jy(s,r,a){try{var c=s.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function xh(s,r,a){return a=tr(a),a.tag=3,a.payload={element:null},a.callback=function(){Nc(s,r)},a}function Ky(s){return s=tr(s),s.tag=3,s}function Qy(s,r,a,c){var v=a.type.getDerivedStateFromError;if(typeof v=="function"){var _=c.value;s.payload=function(){return v(_)},s.callback=function(){Jy(r,a,c)}}var A=a.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){Jy(r,a,c),typeof v!="function"&&(lr===null?lr=new Set([this]):lr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function LS(s,r,a,c,v){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=a.alternate,r!==null&&Zo(r,a,v,!0),a=kn.current,a!==null){switch(a.tag){case 31:case 13:return Xn===null?qc():a.alternate===null&&Rt===0&&(Rt=3),a.flags&=-257,a.flags|=65536,a.lanes=v,c===gc?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([c]):r.add(c),$h(s,c,v)),!1;case 22:return a.flags|=65536,c===gc?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([c]):a.add(c)),$h(s,c,v)),!1}throw Error(i(435,a.tag))}return $h(s,c,v),qc(),!1}if(We)return r=kn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=v,c!==qf&&(s=Error(i(422),{cause:c}),Cl($n(s,a)))):(c!==qf&&(r=Error(i(423),{cause:c}),Cl($n(r,a))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,c=$n(c,a),v=xh(s.stateNode,c,v),Wf(s,v),Rt!==4&&(Rt=2)),!1;var _=Error(i(520),{cause:c});if(_=$n(_,a),Gl===null?Gl=[_]:Gl.push(_),Rt!==4&&(Rt=2),r===null)return!0;c=$n(c,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,s=v&-v,a.lanes|=s,s=xh(a.stateNode,c,s),Wf(a,s),!1;case 1:if(r=a.type,_=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(lr===null||!lr.has(_))))return a.flags|=65536,v&=-v,a.lanes|=v,v=Ky(v),Qy(v,s,a,c),Wf(a,v),!1}a=a.return}while(a!==null);return!1}var bh=Error(i(461)),zt=!1;function ln(s,r,a,c){r.child=s===null?ey(r,null,a,c):lo(r,s.child,a,c)}function Xy(s,r,a,c,v){a=a.render;var _=r.ref;if("ref"in c){var A={};for(var I in c)I!=="ref"&&(A[I]=c[I])}else A=c;return io(r),c=ih(s,r,a,A,_,v),I=rh(),s!==null&&!zt?(oh(s,r,v),ui(s,r,v)):(We&&I&&jf(r),r.flags|=1,ln(s,r,c,v),r.child)}function Wy(s,r,a,c,v){if(s===null){var _=a.type;return typeof _=="function"&&!Lf(_)&&_.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=_,Zy(s,r,_,c,v)):(s=cc(a.type,null,c,r,r.mode,v),s.ref=r.ref,s.return=r,r.child=s)}if(_=s.child,!Mh(s,v)){var A=_.memoizedProps;if(a=a.compare,a=a!==null?a:bl,a(A,c)&&s.ref===r.ref)return ui(s,r,v)}return r.flags|=1,s=si(_,c),s.ref=r.ref,s.return=r,r.child=s}function Zy(s,r,a,c,v){if(s!==null){var _=s.memoizedProps;if(bl(_,c)&&s.ref===r.ref)if(zt=!1,r.pendingProps=c=_,Mh(s,v))(s.flags&131072)!==0&&(zt=!0);else return r.lanes=s.lanes,ui(s,r,v)}return Ah(s,r,a,c,v)}function e0(s,r,a,c){var v=c.children,_=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(_=_!==null?_.baseLanes|a:a,s!==null){for(c=r.child=s.child,v=0;c!==null;)v=v|c.lanes|c.childLanes,c=c.sibling;c=v&~_}else c=0,r.child=null;return t0(s,r,_,a,c)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&mc(r,_!==null?_.cachePool:null),_!==null?sy(r,_):eh(),iy(r);else return c=r.lanes=536870912,t0(s,r,_!==null?_.baseLanes|a:a,a,c)}else _!==null?(mc(r,_.cachePool),sy(r,_),ir(),r.memoizedState=null):(s!==null&&mc(r,null),eh(),ir());return ln(s,r,v,a),r.child}function Ol(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function t0(s,r,a,c,v){var _=Jf();return _=_===null?null:{parent:qt._currentValue,pool:_},r.memoizedState={baseLanes:a,cachePool:_},s!==null&&mc(r,null),eh(),iy(r),s!==null&&Zo(s,r,c,!0),r.childLanes=v,null}function Rc(s,r){return r=Dc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function n0(s,r,a){return lo(r,s.child,null,a),s=Rc(r,r.pendingProps),s.flags|=2,Vn(r),r.memoizedState=null,s}function US(s,r,a){var c=r.pendingProps,v=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(We){if(c.mode==="hidden")return s=Rc(r,c),r.lanes=536870912,Ol(null,s);if(nh(r),(s=_t)?(s=mv(s,Qn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Qi!==null?{id:Us,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},a=jg(s),a.return=r,r.child=a,on=r,_t=null)):s=null,s===null)throw Wi(r);return r.lanes=536870912,null}return Rc(r,c)}var _=s.memoizedState;if(_!==null){var A=_.dehydrated;if(nh(r),v)if(r.flags&256)r.flags&=-257,r=n0(s,r,a);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(zt||Zo(s,r,a,!1),v=(a&s.childLanes)!==0,zt||v){if(c=yt,c!==null&&(A=rl(c,a),A!==0&&A!==_.retryLane))throw _.retryLane=A,eo(s,A),In(c,s,A),bh;qc(),r=n0(s,r,a)}else s=_.treeContext,_t=Wn(A.nextSibling),on=r,We=!0,Xi=null,Qn=!1,s!==null&&Bg(r,s),r=Rc(r,c),r.flags|=4096;return r}return s=si(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Mc(s,r){var a=r.ref;if(a===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(s===null||s.ref!==a)&&(r.flags|=4194816)}}function Ah(s,r,a,c,v){return io(r),a=ih(s,r,a,c,void 0,v),c=rh(),s!==null&&!zt?(oh(s,r,v),ui(s,r,v)):(We&&c&&jf(r),r.flags|=1,ln(s,r,a,v),r.child)}function s0(s,r,a,c,v,_){return io(r),r.updateQueue=null,a=oy(r,c,a,v),ry(s),c=rh(),s!==null&&!zt?(oh(s,r,_),ui(s,r,_)):(We&&c&&jf(r),r.flags|=1,ln(s,r,a,_),r.child)}function i0(s,r,a,c,v){if(io(r),r.stateNode===null){var _=Ko,A=a.contextType;typeof A=="object"&&A!==null&&(_=an(A)),_=new a(c,_),r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Eh,r.stateNode=_,_._reactInternals=r,_=r.stateNode,_.props=c,_.state=r.memoizedState,_.refs={},Qf(r),A=a.contextType,_.context=typeof A=="object"&&A!==null?an(A):Ko,_.state=r.memoizedState,A=a.getDerivedStateFromProps,typeof A=="function"&&(Th(r,a,A,c),_.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&Eh.enqueueReplaceState(_,_.state,null),Pl(r,c,_,v),Dl(),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){_=r.stateNode;var I=r.memoizedProps,L=co(a,I);_.props=L;var Q=_.context,se=a.contextType;A=Ko,typeof se=="object"&&se!==null&&(A=an(se));var ae=a.getDerivedStateFromProps;se=typeof ae=="function"||typeof _.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,se||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I||Q!==A)&&Hy(r,_,c,A),er=!1;var X=r.memoizedState;_.state=X,Pl(r,c,_,v),Dl(),Q=r.memoizedState,I||X!==Q||er?(typeof ae=="function"&&(Th(r,a,ae,c),Q=r.memoizedState),(L=er||zy(r,a,L,c,X,Q,A))?(se||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(r.flags|=4194308)):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=Q),_.props=c,_.state=Q,_.context=A,c=L):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{_=r.stateNode,Xf(s,r),A=r.memoizedProps,se=co(a,A),_.props=se,ae=r.pendingProps,X=_.context,Q=a.contextType,L=Ko,typeof Q=="object"&&Q!==null&&(L=an(Q)),I=a.getDerivedStateFromProps,(Q=typeof I=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==ae||X!==L)&&Hy(r,_,c,L),er=!1,X=r.memoizedState,_.state=X,Pl(r,c,_,v),Dl();var te=r.memoizedState;A!==ae||X!==te||er||s!==null&&s.dependencies!==null&&fc(s.dependencies)?(typeof I=="function"&&(Th(r,a,I,c),te=r.memoizedState),(se=er||zy(r,a,se,c,X,te,L)||s!==null&&s.dependencies!==null&&fc(s.dependencies))?(Q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,te,L),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,te,L)),typeof _.componentDidUpdate=="function"&&(r.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),_.props=c,_.state=te,_.context=L,c=se):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),c=!1)}return _=c,Mc(s,r),c=(r.flags&128)!==0,_||c?(_=r.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:_.render(),r.flags|=1,s!==null&&c?(r.child=lo(r,s.child,null,v),r.child=lo(r,null,a,v)):ln(s,r,a,v),r.memoizedState=_.state,s=r.child):s=ui(s,r,v),s}function r0(s,r,a,c){return no(),r.flags|=256,ln(s,r,a,c),r.child}var Sh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ch(s){return{baseLanes:s,cachePool:Jg()}}function wh(s,r,a){return s=s!==null?s.childLanes&~a:0,r&&(s|=Un),s}function o0(s,r,a){var c=r.pendingProps,v=!1,_=(r.flags&128)!==0,A;if((A=_)||(A=s!==null&&s.memoizedState===null?!1:(Pt.current&2)!==0),A&&(v=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,s===null){if(We){if(v?sr(r):ir(),(s=_t)?(s=mv(s,Qn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Qi!==null?{id:Us,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},a=jg(s),a.return=r,r.child=a,on=r,_t=null)):s=null,s===null)throw Wi(r);return um(s)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,v?(ir(),v=r.mode,I=Dc({mode:"hidden",children:I},v),c=to(c,v,a,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=Ch(a),c.childLanes=wh(s,A,a),r.memoizedState=Sh,Ol(null,c)):(sr(r),Ih(r,I))}var L=s.memoizedState;if(L!==null&&(I=L.dehydrated,I!==null)){if(_)r.flags&256?(sr(r),r.flags&=-257,r=Nh(s,r,a)):r.memoizedState!==null?(ir(),r.child=s.child,r.flags|=128,r=null):(ir(),I=c.fallback,v=r.mode,c=Dc({mode:"visible",children:c.children},v),I=to(I,v,a,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,lo(r,s.child,null,a),c=r.child,c.memoizedState=Ch(a),c.childLanes=wh(s,A,a),r.memoizedState=Sh,r=Ol(null,c));else if(sr(r),um(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var Q=A.dgst;A=Q,c=Error(i(419)),c.stack="",c.digest=A,Cl({value:c,source:null,stack:null}),r=Nh(s,r,a)}else if(zt||Zo(s,r,a,!1),A=(a&s.childLanes)!==0,zt||A){if(A=yt,A!==null&&(c=rl(A,a),c!==0&&c!==L.retryLane))throw L.retryLane=c,eo(s,c),In(A,s,c),bh;lm(I)||qc(),r=Nh(s,r,a)}else lm(I)?(r.flags|=192,r.child=s.child,r=null):(s=L.treeContext,_t=Wn(I.nextSibling),on=r,We=!0,Xi=null,Qn=!1,s!==null&&Bg(r,s),r=Ih(r,c.children),r.flags|=4096);return r}return v?(ir(),I=c.fallback,v=r.mode,L=s.child,Q=L.sibling,c=si(L,{mode:"hidden",children:c.children}),c.subtreeFlags=L.subtreeFlags&65011712,Q!==null?I=si(Q,I):(I=to(I,v,a,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,Ol(null,c),c=r.child,I=s.child.memoizedState,I===null?I=Ch(a):(v=I.cachePool,v!==null?(L=qt._currentValue,v=v.parent!==L?{parent:L,pool:L}:v):v=Jg(),I={baseLanes:I.baseLanes|a,cachePool:v}),c.memoizedState=I,c.childLanes=wh(s,A,a),r.memoizedState=Sh,Ol(s.child,c)):(sr(r),a=s.child,s=a.sibling,a=si(a,{mode:"visible",children:c.children}),a.return=r,a.sibling=null,s!==null&&(A=r.deletions,A===null?(r.deletions=[s],r.flags|=16):A.push(s)),r.child=a,r.memoizedState=null,a)}function Ih(s,r){return r=Dc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Dc(s,r){return s=Pn(22,s,null,r),s.lanes=0,s}function Nh(s,r,a){return lo(r,s.child,null,a),s=Ih(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function a0(s,r,a){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Hf(s.return,r,a)}function Rh(s,r,a,c,v,_){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:v,treeForkCount:_}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=a,A.tailMode=v,A.treeForkCount=_)}function l0(s,r,a){var c=r.pendingProps,v=c.revealOrder,_=c.tail;c=c.children;var A=Pt.current,I=(A&2)!==0;if(I?(A=A&1|2,r.flags|=128):A&=1,ye(Pt,A),ln(s,r,c,a),c=We?Sl:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&a0(s,a,r);else if(s.tag===19)a0(s,a,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(a=r.child,v=null;a!==null;)s=a.alternate,s!==null&&Tc(s)===null&&(v=a),a=a.sibling;a=v,a===null?(v=r.child,r.child=null):(v=a.sibling,a.sibling=null),Rh(r,!1,v,a,_,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,v=r.child,r.child=null;v!==null;){if(s=v.alternate,s!==null&&Tc(s)===null){r.child=v;break}s=v.sibling,v.sibling=a,a=v,v=s}Rh(r,!0,a,null,_,c);break;case"together":Rh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ui(s,r,a){if(s!==null&&(r.dependencies=s.dependencies),ar|=r.lanes,(a&r.childLanes)===0)if(s!==null){if(Zo(s,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,a=si(s,s.pendingProps),r.child=a,a.return=r;s.sibling!==null;)s=s.sibling,a=a.sibling=si(s,s.pendingProps),a.return=r;a.sibling=null}return r.child}function Mh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&fc(s)))}function OS(s,r,a){switch(r.tag){case 3:et(r,r.stateNode.containerInfo),Zi(r,qt,s.memoizedState.cache),no();break;case 27:case 5:Tn(r);break;case 4:et(r,r.stateNode.containerInfo);break;case 10:Zi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,nh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(sr(r),r.flags|=128,null):(a&r.child.childLanes)!==0?o0(s,r,a):(sr(r),s=ui(s,r,a),s!==null?s.sibling:null);sr(r);break;case 19:var v=(s.flags&128)!==0;if(c=(a&r.childLanes)!==0,c||(Zo(s,r,a,!1),c=(a&r.childLanes)!==0),v){if(c)return l0(s,r,a);r.flags|=128}if(v=r.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),ye(Pt,Pt.current),c)break;return null;case 22:return r.lanes=0,e0(s,r,a,r.pendingProps);case 24:Zi(r,qt,s.memoizedState.cache)}return ui(s,r,a)}function u0(s,r,a){if(s!==null)if(s.memoizedProps!==r.pendingProps)zt=!0;else{if(!Mh(s,a)&&(r.flags&128)===0)return zt=!1,OS(s,r,a);zt=(s.flags&131072)!==0}else zt=!1,We&&(r.flags&1048576)!==0&&qg(r,Sl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=oo(r.elementType),r.type=s,typeof s=="function")Lf(s)?(c=co(s,c),r.tag=1,r=i0(null,r,s,c,a)):(r.tag=0,r=Ah(null,r,s,c,a));else{if(s!=null){var v=s.$$typeof;if(v===z){r.tag=11,r=Xy(null,r,s,c,a);break e}else if(v===R){r.tag=14,r=Wy(null,r,s,c,a);break e}}throw r=Le(s)||s,Error(i(306,r,""))}}return r;case 0:return Ah(s,r,r.type,r.pendingProps,a);case 1:return c=r.type,v=co(c,r.pendingProps),i0(s,r,c,v,a);case 3:e:{if(et(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var _=r.memoizedState;v=_.element,Xf(s,r),Pl(r,c,null,a);var A=r.memoizedState;if(c=A.cache,Zi(r,qt,c),c!==_.cache&&Gf(r,[qt],a,!0),Dl(),c=A.element,_.isDehydrated)if(_={element:c,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){r=r0(s,r,c,a);break e}else if(c!==v){v=$n(Error(i(424)),r),Cl(v),r=r0(s,r,c,a);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(_t=Wn(s.firstChild),on=r,We=!0,Xi=null,Qn=!0,a=ey(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(no(),c===v){r=ui(s,r,a);break e}ln(s,r,c,a)}r=r.child}return r;case 26:return Mc(s,r),s===null?(a=Tv(r.type,null,r.pendingProps,null))?r.memoizedState=a:We||(a=r.type,s=r.pendingProps,c=Jc(ce.current).createElement(a),c[Ot]=r,c[Wt]=s,un(c,a,s),jt(c),r.stateNode=c):r.memoizedState=Tv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Tn(r),s===null&&We&&(c=r.stateNode=yv(r.type,r.pendingProps,ce.current),on=r,Qn=!0,v=_t,fr(r.type)?(cm=v,_t=Wn(c.firstChild)):_t=v),ln(s,r,r.pendingProps.children,a),Mc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&We&&((v=c=_t)&&(c=mC(c,r.type,r.pendingProps,Qn),c!==null?(r.stateNode=c,on=r,_t=Wn(c.firstChild),Qn=!1,v=!0):v=!1),v||Wi(r)),Tn(r),v=r.type,_=r.pendingProps,A=s!==null?s.memoizedProps:null,c=_.children,rm(v,_)?c=null:A!==null&&rm(v,A)&&(r.flags|=32),r.memoizedState!==null&&(v=ih(s,r,NS,null,null,a),Zl._currentValue=v),Mc(s,r),ln(s,r,c,a),r.child;case 6:return s===null&&We&&((s=a=_t)&&(a=pC(a,r.pendingProps,Qn),a!==null?(r.stateNode=a,on=r,_t=null,s=!0):s=!1),s||Wi(r)),null;case 13:return o0(s,r,a);case 4:return et(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=lo(r,null,c,a):ln(s,r,c,a),r.child;case 11:return Xy(s,r,r.type,r.pendingProps,a);case 7:return ln(s,r,r.pendingProps,a),r.child;case 8:return ln(s,r,r.pendingProps.children,a),r.child;case 12:return ln(s,r,r.pendingProps.children,a),r.child;case 10:return c=r.pendingProps,Zi(r,r.type,c.value),ln(s,r,c.children,a),r.child;case 9:return v=r.type._context,c=r.pendingProps.children,io(r),v=an(v),c=c(v),r.flags|=1,ln(s,r,c,a),r.child;case 14:return Wy(s,r,r.type,r.pendingProps,a);case 15:return Zy(s,r,r.type,r.pendingProps,a);case 19:return l0(s,r,a);case 31:return US(s,r,a);case 22:return e0(s,r,a,r.pendingProps);case 24:return io(r),c=an(qt),s===null?(v=Jf(),v===null&&(v=yt,_=Yf(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=a),v=_),r.memoizedState={parent:c,cache:v},Qf(r),Zi(r,qt,v)):((s.lanes&a)!==0&&(Xf(s,r),Pl(r,null,null,a),Dl()),v=s.memoizedState,_=r.memoizedState,v.parent!==c?(v={parent:c,cache:c},r.memoizedState=v,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=v),Zi(r,qt,c)):(c=_.cache,Zi(r,qt,c),c!==v.cache&&Gf(r,[qt],a,!0))),ln(s,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function ci(s){s.flags|=4}function Dh(s,r,a,c,v){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(L0())s.flags|=8192;else throw ao=gc,Kf}else s.flags&=-16777217}function c0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Sv(r))if(L0())s.flags|=8192;else throw ao=gc,Kf}function Pc(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?bs():536870912,s.lanes|=r,da|=r)}function jl(s,r){if(!We)switch(s.tailMode){case"hidden":r=s.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function Tt(s){var r=s.alternate!==null&&s.alternate.child===s.child,a=0,c=0;if(r)for(var v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags&65011712,c|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags,c|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=c,s.childLanes=a,r}function jS(s,r,a){var c=r.pendingProps;switch(Ff(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(r),null;case 1:return Tt(r),null;case 3:return a=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),oi(qt),nt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(Wo(r)?ci(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Bf())),Tt(r),null;case 26:var v=r.type,_=r.memoizedState;return s===null?(ci(r),_!==null?(Tt(r),c0(r,_)):(Tt(r),Dh(r,v,null,c,a))):_?_!==s.memoizedState?(ci(r),Tt(r),c0(r,_)):(Tt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&ci(r),Tt(r),Dh(r,v,s,c,a)),null;case 27:if(St(r),a=ce.current,v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&ci(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Tt(r),null}s=_e.current,Wo(r)?zg(r):(s=yv(v,c,a),r.stateNode=s,ci(r))}return Tt(r),null;case 5:if(St(r),v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&ci(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Tt(r),null}if(_=_e.current,Wo(r))zg(r);else{var A=Jc(ce.current);switch(_){case 1:_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=A.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?_.multiple=!0:c.size&&(_.size=c.size);break;default:_=typeof c.is=="string"?A.createElement(v,{is:c.is}):A.createElement(v)}}_[Ot]=r,_[Wt]=c;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=_;e:switch(un(_,v,c),v){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ci(r)}}return Tt(r),Dh(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,a),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&ci(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=ce.current,Wo(r)){if(s=r.stateNode,a=r.memoizedProps,c=null,v=on,v!==null)switch(v.tag){case 27:case 5:c=v.memoizedProps}s[Ot]=r,s=!!(s.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||ov(s.nodeValue,a)),s||Wi(r,!0)}else s=Jc(s).createTextNode(c),s[Ot]=r,r.stateNode=s}return Tt(r),null;case 31:if(a=r.memoizedState,s===null||s.memoizedState!==null){if(c=Wo(r),a!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ot]=r}else no(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Tt(r),s=!1}else a=Bf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return r.flags&256?(Vn(r),r):(Vn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Tt(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Wo(r),c!==null&&c.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[Ot]=r}else no(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Tt(r),v=!1}else v=Bf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return r.flags&256?(Vn(r),r):(Vn(r),null)}return Vn(r),(r.flags&128)!==0?(r.lanes=a,r):(a=c!==null,s=s!==null&&s.memoizedState!==null,a&&(c=r.child,v=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(v=c.alternate.memoizedState.cachePool.pool),_=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(_=c.memoizedState.cachePool.pool),_!==v&&(c.flags|=2048)),a!==s&&a&&(r.child.flags|=8192),Pc(r,r.updateQueue),Tt(r),null);case 4:return nt(),s===null&&em(r.stateNode.containerInfo),Tt(r),null;case 10:return oi(r.type),Tt(r),null;case 19:if(re(Pt),c=r.memoizedState,c===null)return Tt(r),null;if(v=(r.flags&128)!==0,_=c.rendering,_===null)if(v)jl(c,!1);else{if(Rt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(_=Tc(s),_!==null){for(r.flags|=128,jl(c,!1),s=_.updateQueue,r.updateQueue=s,Pc(r,s),r.subtreeFlags=0,s=a,a=r.child;a!==null;)Og(a,s),a=a.sibling;return ye(Pt,Pt.current&1|2),We&&ii(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&Xt()>Oc&&(r.flags|=128,v=!0,jl(c,!1),r.lanes=4194304)}else{if(!v)if(s=Tc(_),s!==null){if(r.flags|=128,v=!0,s=s.updateQueue,r.updateQueue=s,Pc(r,s),jl(c,!0),c.tail===null&&c.tailMode==="hidden"&&!_.alternate&&!We)return Tt(r),null}else 2*Xt()-c.renderingStartTime>Oc&&a!==536870912&&(r.flags|=128,v=!0,jl(c,!1),r.lanes=4194304);c.isBackwards?(_.sibling=r.child,r.child=_):(s=c.last,s!==null?s.sibling=_:r.child=_,c.last=_)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Xt(),s.sibling=null,a=Pt.current,ye(Pt,v?a&1|2:a&1),We&&ii(r,c.treeForkCount),s):(Tt(r),null);case 22:case 23:return Vn(r),th(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(a&536870912)!==0&&(r.flags&128)===0&&(Tt(r),r.subtreeFlags&6&&(r.flags|=8192)):Tt(r),a=r.updateQueue,a!==null&&Pc(r,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==a&&(r.flags|=2048),s!==null&&re(ro),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),oi(qt),Tt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function FS(s,r){switch(Ff(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return oi(qt),nt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return St(r),null;case 31:if(r.memoizedState!==null){if(Vn(r),r.alternate===null)throw Error(i(340));no()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Vn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));no()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return re(Pt),null;case 4:return nt(),null;case 10:return oi(r.type),null;case 22:case 23:return Vn(r),th(),s!==null&&re(ro),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return oi(qt),null;case 25:return null;default:return null}}function d0(s,r){switch(Ff(r),r.tag){case 3:oi(qt),nt();break;case 26:case 27:case 5:St(r);break;case 4:nt();break;case 31:r.memoizedState!==null&&Vn(r);break;case 13:Vn(r);break;case 19:re(Pt);break;case 10:oi(r.type);break;case 22:case 23:Vn(r),th(),s!==null&&re(ro);break;case 24:oi(qt)}}function Fl(s,r){try{var a=r.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var v=c.next;a=v;do{if((a.tag&s)===s){c=void 0;var _=a.create,A=a.inst;c=_(),A.destroy=c}a=a.next}while(a!==v)}}catch(I){dt(r,r.return,I)}}function rr(s,r,a){try{var c=r.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var _=v.next;c=_;do{if((c.tag&s)===s){var A=c.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=r;var L=a,Q=I;try{Q()}catch(se){dt(v,L,se)}}}c=c.next}while(c!==_)}}catch(se){dt(r,r.return,se)}}function f0(s){var r=s.updateQueue;if(r!==null){var a=s.stateNode;try{ny(r,a)}catch(c){dt(s,s.return,c)}}}function h0(s,r,a){a.props=co(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(c){dt(s,r,c)}}function ql(s,r){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof a=="function"?s.refCleanup=a(c):a.current=c}}catch(v){dt(s,r,v)}}function js(s,r){var a=s.ref,c=s.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(v){dt(s,r,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(v){dt(s,r,v)}else a.current=null}function m0(s){var r=s.type,a=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(v){dt(s,s.return,v)}}function Ph(s,r,a){try{var c=s.stateNode;lC(c,s.type,a,r),c[Wt]=r}catch(v){dt(s,s.return,v)}}function p0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&fr(s.type)||s.tag===4}function kh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||p0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&fr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vh(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(s),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=os));else if(c!==4&&(c===27&&fr(s.type)&&(a=s.stateNode,r=null),s=s.child,s!==null))for(Vh(s,r,a),s=s.sibling;s!==null;)Vh(s,r,a),s=s.sibling}function kc(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?a.insertBefore(s,r):a.appendChild(s);else if(c!==4&&(c===27&&fr(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(kc(s,r,a),s=s.sibling;s!==null;)kc(s,r,a),s=s.sibling}function g0(s){var r=s.stateNode,a=s.memoizedProps;try{for(var c=s.type,v=r.attributes;v.length;)r.removeAttributeNode(v[0]);un(r,c,a),r[Ot]=s,r[Wt]=a}catch(_){dt(s,s.return,_)}}var di=!1,Ht=!1,Lh=!1,y0=typeof WeakSet=="function"?WeakSet:Set,en=null;function qS(s,r){if(s=s.containerInfo,sm=td,s=Ng(s),Nf(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var v=c.anchorOffset,_=c.focusNode;c=c.focusOffset;try{a.nodeType,_.nodeType}catch{a=null;break e}var A=0,I=-1,L=-1,Q=0,se=0,ae=s,X=null;t:for(;;){for(var te;ae!==a||v!==0&&ae.nodeType!==3||(I=A+v),ae!==_||c!==0&&ae.nodeType!==3||(L=A+c),ae.nodeType===3&&(A+=ae.nodeValue.length),(te=ae.firstChild)!==null;)X=ae,ae=te;for(;;){if(ae===s)break t;if(X===a&&++Q===v&&(I=A),X===_&&++se===c&&(L=A),(te=ae.nextSibling)!==null)break;ae=X,X=ae.parentNode}ae=te}a=I===-1||L===-1?null:{start:I,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(im={focusedElem:s,selectionRange:a},td=!1,en=r;en!==null;)if(r=en,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,en=s;else for(;en!==null;){switch(r=en,_=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)v=s[a],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,a=r,v=_.memoizedProps,_=_.memoizedState,c=a.stateNode;try{var Ae=co(a.type,v);s=c.getSnapshotBeforeUpdate(Ae,_),c.__reactInternalSnapshotBeforeUpdate=s}catch(Me){dt(a,a.return,Me)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,a=s.nodeType,a===9)am(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":am(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,en=s;break}en=r.return}}function v0(s,r,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:hi(s,a),c&4&&Fl(5,a);break;case 1:if(hi(s,a),c&4)if(s=a.stateNode,r===null)try{s.componentDidMount()}catch(A){dt(a,a.return,A)}else{var v=co(a.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(v,r,s.__reactInternalSnapshotBeforeUpdate)}catch(A){dt(a,a.return,A)}}c&64&&f0(a),c&512&&ql(a,a.return);break;case 3:if(hi(s,a),c&64&&(s=a.updateQueue,s!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{ny(s,r)}catch(A){dt(a,a.return,A)}}break;case 27:r===null&&c&4&&g0(a);case 26:case 5:hi(s,a),r===null&&c&4&&m0(a),c&512&&ql(a,a.return);break;case 12:hi(s,a);break;case 31:hi(s,a),c&4&&E0(s,a);break;case 13:hi(s,a),c&4&&x0(s,a),c&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=QS.bind(null,a),gC(s,a))));break;case 22:if(c=a.memoizedState!==null||di,!c){r=r!==null&&r.memoizedState!==null||Ht,v=di;var _=Ht;di=c,(Ht=r)&&!_?mi(s,a,(a.subtreeFlags&8772)!==0):hi(s,a),di=v,Ht=_}break;case 30:break;default:hi(s,a)}}function _0(s){var r=s.alternate;r!==null&&(s.alternate=null,_0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Vo(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var At=null,An=!1;function fi(s,r,a){for(a=a.child;a!==null;)T0(s,r,a),a=a.sibling}function T0(s,r,a){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(me,a)}catch{}switch(a.tag){case 26:Ht||js(a,r),fi(s,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Ht||js(a,r);var c=At,v=An;fr(a.type)&&(At=a.stateNode,An=!1),fi(s,r,a),Ql(a.stateNode),At=c,An=v;break;case 5:Ht||js(a,r);case 6:if(c=At,v=An,At=null,fi(s,r,a),At=c,An=v,At!==null)if(An)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(a.stateNode)}catch(_){dt(a,r,_)}else try{At.removeChild(a.stateNode)}catch(_){dt(a,r,_)}break;case 18:At!==null&&(An?(s=At,fv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),_a(s)):fv(At,a.stateNode));break;case 4:c=At,v=An,At=a.stateNode.containerInfo,An=!0,fi(s,r,a),At=c,An=v;break;case 0:case 11:case 14:case 15:rr(2,a,r),Ht||rr(4,a,r),fi(s,r,a);break;case 1:Ht||(js(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"&&h0(a,r,c)),fi(s,r,a);break;case 21:fi(s,r,a);break;case 22:Ht=(c=Ht)||a.memoizedState!==null,fi(s,r,a),Ht=c;break;default:fi(s,r,a)}}function E0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{_a(s)}catch(a){dt(r,r.return,a)}}}function x0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{_a(s)}catch(a){dt(r,r.return,a)}}function BS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new y0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new y0),r;default:throw Error(i(435,s.tag))}}function Vc(s,r){var a=BS(s);r.forEach(function(c){if(!a.has(c)){a.add(c);var v=XS.bind(null,s,c);c.then(v,v)}})}function Sn(s,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var v=a[c],_=s,A=r,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(fr(I.type)){At=I.stateNode,An=!1;break e}break;case 5:At=I.stateNode,An=!1;break e;case 3:case 4:At=I.stateNode.containerInfo,An=!0;break e}I=I.return}if(At===null)throw Error(i(160));T0(_,A,v),At=null,An=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)b0(r,s),r=r.sibling}var fs=null;function b0(s,r){var a=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Sn(r,s),Cn(s),c&4&&(rr(3,s,s.return),Fl(3,s),rr(5,s,s.return));break;case 1:Sn(r,s),Cn(s),c&512&&(Ht||a===null||js(a,a.return)),c&64&&di&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var v=fs;if(Sn(r,s),Cn(s),c&512&&(Ht||a===null||js(a,a.return)),c&4){var _=a!==null?a.memoizedState:null;if(c=s.memoizedState,a===null)if(c===null)if(s.stateNode===null){e:{c=s.type,a=s.memoizedProps,v=v.ownerDocument||v;t:switch(c){case"title":_=v.getElementsByTagName("title")[0],(!_||_[Ss]||_[Ot]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(c),v.head.insertBefore(_,v.querySelector("head > title"))),un(_,c,a),_[Ot]=s,jt(_),c=_;break e;case"link":var A=bv("link","href",v).get(c+(a.href||""));if(A){for(var I=0;I<A.length;I++)if(_=A[I],_.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&_.getAttribute("rel")===(a.rel==null?null:a.rel)&&_.getAttribute("title")===(a.title==null?null:a.title)&&_.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){A.splice(I,1);break t}}_=v.createElement(c),un(_,c,a),v.head.appendChild(_);break;case"meta":if(A=bv("meta","content",v).get(c+(a.content||""))){for(I=0;I<A.length;I++)if(_=A[I],_.getAttribute("content")===(a.content==null?null:""+a.content)&&_.getAttribute("name")===(a.name==null?null:a.name)&&_.getAttribute("property")===(a.property==null?null:a.property)&&_.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&_.getAttribute("charset")===(a.charSet==null?null:a.charSet)){A.splice(I,1);break t}}_=v.createElement(c),un(_,c,a),v.head.appendChild(_);break;default:throw Error(i(468,c))}_[Ot]=s,jt(_),c=_}s.stateNode=c}else Av(v,s.type,s.stateNode);else s.stateNode=xv(v,c,s.memoizedProps);else _!==c?(_===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):_.count--,c===null?Av(v,s.type,s.stateNode):xv(v,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Ph(s,s.memoizedProps,a.memoizedProps)}break;case 27:Sn(r,s),Cn(s),c&512&&(Ht||a===null||js(a,a.return)),a!==null&&c&4&&Ph(s,s.memoizedProps,a.memoizedProps);break;case 5:if(Sn(r,s),Cn(s),c&512&&(Ht||a===null||js(a,a.return)),s.flags&32){v=s.stateNode;try{bn(v,"")}catch(Ae){dt(s,s.return,Ae)}}c&4&&s.stateNode!=null&&(v=s.memoizedProps,Ph(s,v,a!==null?a.memoizedProps:v)),c&1024&&(Lh=!0);break;case 6:if(Sn(r,s),Cn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,a=s.stateNode;try{a.nodeValue=c}catch(Ae){dt(s,s.return,Ae)}}break;case 3:if(Xc=null,v=fs,fs=Kc(r.containerInfo),Sn(r,s),fs=v,Cn(s),c&4&&a!==null&&a.memoizedState.isDehydrated)try{_a(r.containerInfo)}catch(Ae){dt(s,s.return,Ae)}Lh&&(Lh=!1,A0(s));break;case 4:c=fs,fs=Kc(s.stateNode.containerInfo),Sn(r,s),Cn(s),fs=c;break;case 12:Sn(r,s),Cn(s);break;case 31:Sn(r,s),Cn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Vc(s,c)));break;case 13:Sn(r,s),Cn(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Uc=Xt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Vc(s,c)));break;case 22:v=s.memoizedState!==null;var L=a!==null&&a.memoizedState!==null,Q=di,se=Ht;if(di=Q||v,Ht=se||L,Sn(r,s),Ht=se,di=Q,Cn(s),c&8192)e:for(r=s.stateNode,r._visibility=v?r._visibility&-2:r._visibility|1,v&&(a===null||L||di||Ht||fo(s)),a=null,r=s;;){if(r.tag===5||r.tag===26){if(a===null){L=a=r;try{if(_=L.stateNode,v)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=L.stateNode;var ae=L.memoizedProps.style,X=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;I.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(Ae){dt(L,L.return,Ae)}}}else if(r.tag===6){if(a===null){L=r;try{L.stateNode.nodeValue=v?"":L.memoizedProps}catch(Ae){dt(L,L.return,Ae)}}}else if(r.tag===18){if(a===null){L=r;try{var te=L.stateNode;v?hv(te,!0):hv(L.stateNode,!1)}catch(Ae){dt(L,L.return,Ae)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,Vc(s,a))));break;case 19:Sn(r,s),Cn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Vc(s,c)));break;case 30:break;case 21:break;default:Sn(r,s),Cn(s)}}function Cn(s){var r=s.flags;if(r&2){try{for(var a,c=s.return;c!==null;){if(p0(c)){a=c;break}c=c.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var v=a.stateNode,_=kh(s);kc(s,_,v);break;case 5:var A=a.stateNode;a.flags&32&&(bn(A,""),a.flags&=-33);var I=kh(s);kc(s,I,A);break;case 3:case 4:var L=a.stateNode.containerInfo,Q=kh(s);Vh(s,Q,L);break;default:throw Error(i(161))}}catch(se){dt(s,s.return,se)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function A0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;A0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function hi(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)v0(s,r.alternate,r),r=r.sibling}function fo(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:rr(4,r,r.return),fo(r);break;case 1:js(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&h0(r,r.return,a),fo(r);break;case 27:Ql(r.stateNode);case 26:case 5:js(r,r.return),fo(r);break;case 22:r.memoizedState===null&&fo(r);break;case 30:fo(r);break;default:fo(r)}s=s.sibling}}function mi(s,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,v=s,_=r,A=_.flags;switch(_.tag){case 0:case 11:case 15:mi(v,_,a),Fl(4,_);break;case 1:if(mi(v,_,a),c=_,v=c.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(Q){dt(c,c.return,Q)}if(c=_,v=c.updateQueue,v!==null){var I=c.stateNode;try{var L=v.shared.hiddenCallbacks;if(L!==null)for(v.shared.hiddenCallbacks=null,v=0;v<L.length;v++)ty(L[v],I)}catch(Q){dt(c,c.return,Q)}}a&&A&64&&f0(_),ql(_,_.return);break;case 27:g0(_);case 26:case 5:mi(v,_,a),a&&c===null&&A&4&&m0(_),ql(_,_.return);break;case 12:mi(v,_,a);break;case 31:mi(v,_,a),a&&A&4&&E0(v,_);break;case 13:mi(v,_,a),a&&A&4&&x0(v,_);break;case 22:_.memoizedState===null&&mi(v,_,a),ql(_,_.return);break;case 30:break;default:mi(v,_,a)}r=r.sibling}}function Uh(s,r){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&wl(a))}function Oh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&wl(s))}function hs(s,r,a,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)S0(s,r,a,c),r=r.sibling}function S0(s,r,a,c){var v=r.flags;switch(r.tag){case 0:case 11:case 15:hs(s,r,a,c),v&2048&&Fl(9,r);break;case 1:hs(s,r,a,c);break;case 3:hs(s,r,a,c),v&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&wl(s)));break;case 12:if(v&2048){hs(s,r,a,c),s=r.stateNode;try{var _=r.memoizedProps,A=_.id,I=_.onPostCommit;typeof I=="function"&&I(A,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(L){dt(r,r.return,L)}}else hs(s,r,a,c);break;case 31:hs(s,r,a,c);break;case 13:hs(s,r,a,c);break;case 23:break;case 22:_=r.stateNode,A=r.alternate,r.memoizedState!==null?_._visibility&2?hs(s,r,a,c):Bl(s,r):_._visibility&2?hs(s,r,a,c):(_._visibility|=2,la(s,r,a,c,(r.subtreeFlags&10256)!==0||!1)),v&2048&&Uh(A,r);break;case 24:hs(s,r,a,c),v&2048&&Oh(r.alternate,r);break;default:hs(s,r,a,c)}}function la(s,r,a,c,v){for(v=v&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var _=s,A=r,I=a,L=c,Q=A.flags;switch(A.tag){case 0:case 11:case 15:la(_,A,I,L,v),Fl(8,A);break;case 23:break;case 22:var se=A.stateNode;A.memoizedState!==null?se._visibility&2?la(_,A,I,L,v):Bl(_,A):(se._visibility|=2,la(_,A,I,L,v)),v&&Q&2048&&Uh(A.alternate,A);break;case 24:la(_,A,I,L,v),v&&Q&2048&&Oh(A.alternate,A);break;default:la(_,A,I,L,v)}r=r.sibling}}function Bl(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=s,c=r,v=c.flags;switch(c.tag){case 22:Bl(a,c),v&2048&&Uh(c.alternate,c);break;case 24:Bl(a,c),v&2048&&Oh(c.alternate,c);break;default:Bl(a,c)}r=r.sibling}}var zl=8192;function ua(s,r,a){if(s.subtreeFlags&zl)for(s=s.child;s!==null;)C0(s,r,a),s=s.sibling}function C0(s,r,a){switch(s.tag){case 26:ua(s,r,a),s.flags&zl&&s.memoizedState!==null&&IC(a,fs,s.memoizedState,s.memoizedProps);break;case 5:ua(s,r,a);break;case 3:case 4:var c=fs;fs=Kc(s.stateNode.containerInfo),ua(s,r,a),fs=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=zl,zl=16777216,ua(s,r,a),zl=c):ua(s,r,a));break;default:ua(s,r,a)}}function w0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Hl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];en=c,N0(c,s)}w0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)I0(s),s=s.sibling}function I0(s){switch(s.tag){case 0:case 11:case 15:Hl(s),s.flags&2048&&rr(9,s,s.return);break;case 3:Hl(s);break;case 12:Hl(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Lc(s)):Hl(s);break;default:Hl(s)}}function Lc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];en=c,N0(c,s)}w0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:rr(8,r,r.return),Lc(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,Lc(r));break;default:Lc(r)}s=s.sibling}}function N0(s,r){for(;en!==null;){var a=en;switch(a.tag){case 0:case 11:case 15:rr(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:wl(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,en=c;else e:for(a=s;en!==null;){c=en;var v=c.sibling,_=c.return;if(_0(c),c===a){en=null;break e}if(v!==null){v.return=_,en=v;break e}en=_}}}var zS={getCacheForType:function(s){var r=an(qt),a=r.data.get(s);return a===void 0&&(a=s(),r.data.set(s,a)),a},cacheSignal:function(){return an(qt).controller.signal}},HS=typeof WeakMap=="function"?WeakMap:Map,at=0,yt=null,He=null,$e=0,ct=0,Ln=null,or=!1,ca=!1,jh=!1,pi=0,Rt=0,ar=0,ho=0,Fh=0,Un=0,da=0,Gl=null,wn=null,qh=!1,Uc=0,R0=0,Oc=1/0,jc=null,lr=null,Jt=0,ur=null,fa=null,gi=0,Bh=0,zh=null,M0=null,Yl=0,Hh=null;function On(){return(at&2)!==0&&$e!==0?$e&-$e:$.T!==null?Qh():Fu()}function D0(){if(Un===0)if(($e&536870912)===0||We){var s=Ws;Ws<<=1,(Ws&3932160)===0&&(Ws=262144),Un=s}else Un=536870912;return s=kn.current,s!==null&&(s.flags|=32),Un}function In(s,r,a){(s===yt&&(ct===2||ct===9)||s.cancelPendingCommit!==null)&&(ha(s,0),cr(s,$e,Un,!1)),Fr(s,a),((at&2)===0||s!==yt)&&(s===yt&&((at&2)===0&&(ho|=a),Rt===4&&cr(s,$e,Un,!1)),Fs(s))}function P0(s,r,a){if((at&6)!==0)throw Error(i(327));var c=!a&&(r&127)===0&&(r&s.expiredLanes)===0||Ut(s,r),v=c?$S(s,r):Yh(s,r,!0),_=c;do{if(v===0){ca&&!c&&cr(s,r,0,!1);break}else{if(a=s.current.alternate,_&&!GS(a)){v=Yh(s,r,!1),_=!1;continue}if(v===2){if(_=r,s.errorRecoveryDisabledLanes&_)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var I=s;v=Gl;var L=I.current.memoizedState.isDehydrated;if(L&&(ha(I,A).flags|=256),A=Yh(I,A,!1),A!==2){if(jh&&!L){I.errorRecoveryDisabledLanes|=_,ho|=_,v=4;break e}_=wn,wn=v,_!==null&&(wn===null?wn=_:wn.push.apply(wn,_))}v=A}if(_=!1,v!==2)continue}}if(v===1){ha(s,0),cr(s,r,0,!0);break}e:{switch(c=s,_=v,_){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:cr(c,r,Un,!or);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(v=Uc+300-Xt(),10<v)){if(cr(c,r,Un,!or),ft(c,0,!0)!==0)break e;gi=r,c.timeoutHandle=cv(k0.bind(null,c,a,wn,jc,qh,r,Un,ho,da,or,_,"Throttled",-0,0),v);break e}k0(c,a,wn,jc,qh,r,Un,ho,da,or,_,null,-0,0)}}break}while(!0);Fs(s)}function k0(s,r,a,c,v,_,A,I,L,Q,se,ae,X,te){if(s.timeoutHandle=-1,ae=r.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},C0(r,_,ae);var Ae=(_&62914560)===_?Uc-Xt():(_&4194048)===_?R0-Xt():0;if(Ae=NC(ae,Ae),Ae!==null){gi=_,s.cancelPendingCommit=Ae(B0.bind(null,s,r,_,a,c,v,A,I,L,se,ae,null,X,te)),cr(s,_,A,!Q);return}}B0(s,r,_,a,c,v,A,I,L)}function GS(s){for(var r=s;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var v=a[c],_=v.getSnapshot;v=v.value;try{if(!Dn(_(),v))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function cr(s,r,a,c){r&=~Fh,r&=~ho,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var v=r;0<v;){var _=31-Ue(v),A=1<<_;c[_]=-1,v&=~A}a!==0&&qr(s,a,r)}function Fc(){return(at&6)===0?($l(0),!1):!0}function Gh(){if(He!==null){if(ct===0)var s=He.return;else s=He,ri=so=null,ah(s),sa=null,Nl=0,s=He;for(;s!==null;)d0(s.alternate,s),s=s.return;He=null}}function ha(s,r){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,dC(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),gi=0,Gh(),yt=s,He=a=si(s.current,null),$e=r,ct=0,Ln=null,or=!1,ca=Ut(s,r),jh=!1,da=Un=Fh=ho=ar=Rt=0,wn=Gl=null,qh=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var v=31-Ue(c),_=1<<v;r|=s[v],c&=~_}return pi=r,ac(),a}function V0(s,r){qe=null,$.H=Ul,r===na||r===pc?(r=Xg(),ct=3):r===Kf?(r=Xg(),ct=4):ct=r===bh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ln=r,He===null&&(Rt=1,Nc(s,$n(r,s.current)))}function L0(){var s=kn.current;return s===null?!0:($e&4194048)===$e?Xn===null:($e&62914560)===$e||($e&536870912)!==0?s===Xn:!1}function U0(){var s=$.H;return $.H=Ul,s===null?Ul:s}function O0(){var s=$.A;return $.A=zS,s}function qc(){Rt=4,or||($e&4194048)!==$e&&kn.current!==null||(ca=!0),(ar&134217727)===0&&(ho&134217727)===0||yt===null||cr(yt,$e,Un,!1)}function Yh(s,r,a){var c=at;at|=2;var v=U0(),_=O0();(yt!==s||$e!==r)&&(jc=null,ha(s,r)),r=!1;var A=Rt;e:do try{if(ct!==0&&He!==null){var I=He,L=Ln;switch(ct){case 8:Gh(),A=6;break e;case 3:case 2:case 9:case 6:kn.current===null&&(r=!0);var Q=ct;if(ct=0,Ln=null,ma(s,I,L,Q),a&&ca){A=0;break e}break;default:Q=ct,ct=0,Ln=null,ma(s,I,L,Q)}}YS(),A=Rt;break}catch(se){V0(s,se)}while(!0);return r&&s.shellSuspendCounter++,ri=so=null,at=c,$.H=v,$.A=_,He===null&&(yt=null,$e=0,ac()),A}function YS(){for(;He!==null;)j0(He)}function $S(s,r){var a=at;at|=2;var c=U0(),v=O0();yt!==s||$e!==r?(jc=null,Oc=Xt()+500,ha(s,r)):ca=Ut(s,r);e:do try{if(ct!==0&&He!==null){r=He;var _=Ln;t:switch(ct){case 1:ct=0,Ln=null,ma(s,r,_,1);break;case 2:case 9:if(Kg(_)){ct=0,Ln=null,F0(r);break}r=function(){ct!==2&&ct!==9||yt!==s||(ct=7),Fs(s)},_.then(r,r);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:Kg(_)?(ct=0,Ln=null,F0(r)):(ct=0,Ln=null,ma(s,r,_,7));break;case 5:var A=null;switch(He.tag){case 26:A=He.memoizedState;case 5:case 27:var I=He;if(A?Sv(A):I.stateNode.complete){ct=0,Ln=null;var L=I.sibling;if(L!==null)He=L;else{var Q=I.return;Q!==null?(He=Q,Bc(Q)):He=null}break t}}ct=0,Ln=null,ma(s,r,_,5);break;case 6:ct=0,Ln=null,ma(s,r,_,6);break;case 8:Gh(),Rt=6;break e;default:throw Error(i(462))}}JS();break}catch(se){V0(s,se)}while(!0);return ri=so=null,$.H=c,$.A=v,at=a,He!==null?0:(yt=null,$e=0,ac(),Rt)}function JS(){for(;He!==null&&!sl();)j0(He)}function j0(s){var r=u0(s.alternate,s,pi);s.memoizedProps=s.pendingProps,r===null?Bc(s):He=r}function F0(s){var r=s,a=r.alternate;switch(r.tag){case 15:case 0:r=s0(a,r,r.pendingProps,r.type,void 0,$e);break;case 11:r=s0(a,r,r.pendingProps,r.type.render,r.ref,$e);break;case 5:ah(r);default:d0(a,r),r=He=Og(r,pi),r=u0(a,r,pi)}s.memoizedProps=s.pendingProps,r===null?Bc(s):He=r}function ma(s,r,a,c){ri=so=null,ah(r),sa=null,Nl=0;var v=r.return;try{if(LS(s,v,r,a,$e)){Rt=1,Nc(s,$n(a,s.current)),He=null;return}}catch(_){if(v!==null)throw He=v,_;Rt=1,Nc(s,$n(a,s.current)),He=null;return}r.flags&32768?(We||c===1?s=!0:ca||($e&536870912)!==0?s=!1:(or=s=!0,(c===2||c===9||c===3||c===6)&&(c=kn.current,c!==null&&c.tag===13&&(c.flags|=16384))),q0(r,s)):Bc(r)}function Bc(s){var r=s;do{if((r.flags&32768)!==0){q0(r,or);return}s=r.return;var a=jS(r.alternate,r,pi);if(a!==null){He=a;return}if(r=r.sibling,r!==null){He=r;return}He=r=s}while(r!==null);Rt===0&&(Rt=5)}function q0(s,r){do{var a=FS(s.alternate,s);if(a!==null){a.flags&=32767,He=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(s=s.sibling,s!==null)){He=s;return}He=s=a}while(s!==null);Rt=6,He=null}function B0(s,r,a,c,v,_,A,I,L){s.cancelPendingCommit=null;do zc();while(Jt!==0);if((at&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(_=r.lanes|r.childLanes,_|=kf,Sf(s,a,_,A,I,L),s===yt&&(He=yt=null,$e=0),fa=r,ur=s,gi=a,Bh=_,zh=v,M0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,WS(ss,function(){return $0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,v=de.p,de.p=2,A=at,at|=4;try{qS(s,r,a)}finally{at=A,de.p=v,$.T=c}}Jt=1,z0(),H0(),G0()}}function z0(){if(Jt===1){Jt=0;var s=ur,r=fa,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=$.T,$.T=null;var c=de.p;de.p=2;var v=at;at|=4;try{b0(r,s);var _=im,A=Ng(s.containerInfo),I=_.focusedElem,L=_.selectionRange;if(A!==I&&I&&I.ownerDocument&&Ig(I.ownerDocument.documentElement,I)){if(L!==null&&Nf(I)){var Q=L.start,se=L.end;if(se===void 0&&(se=Q),"selectionStart"in I)I.selectionStart=Q,I.selectionEnd=Math.min(se,I.value.length);else{var ae=I.ownerDocument||document,X=ae&&ae.defaultView||window;if(X.getSelection){var te=X.getSelection(),Ae=I.textContent.length,Me=Math.min(L.start,Ae),gt=L.end===void 0?Me:Math.min(L.end,Ae);!te.extend&&Me>gt&&(A=gt,gt=Me,Me=A);var G=wg(I,Me),B=wg(I,gt);if(G&&B&&(te.rangeCount!==1||te.anchorNode!==G.node||te.anchorOffset!==G.offset||te.focusNode!==B.node||te.focusOffset!==B.offset)){var K=ae.createRange();K.setStart(G.node,G.offset),te.removeAllRanges(),Me>gt?(te.addRange(K),te.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),te.addRange(K))}}}}for(ae=[],te=I;te=te.parentNode;)te.nodeType===1&&ae.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ae.length;I++){var oe=ae[I];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}td=!!sm,im=sm=null}finally{at=v,de.p=c,$.T=a}}s.current=r,Jt=2}}function H0(){if(Jt===2){Jt=0;var s=ur,r=fa,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=$.T,$.T=null;var c=de.p;de.p=2;var v=at;at|=4;try{v0(s,r.alternate,r)}finally{at=v,de.p=c,$.T=a}}Jt=3}}function G0(){if(Jt===4||Jt===3){Jt=0,Mo();var s=ur,r=fa,a=gi,c=M0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Jt=5:(Jt=0,fa=ur=null,Y0(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(lr=null),Zs(a),r=r.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(me,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=$.T,v=de.p,de.p=2,$.T=null;try{for(var _=s.onRecoverableError,A=0;A<c.length;A++){var I=c[A];_(I.value,{componentStack:I.stack})}}finally{$.T=r,de.p=v}}(gi&3)!==0&&zc(),Fs(s),v=s.pendingLanes,(a&261930)!==0&&(v&42)!==0?s===Hh?Yl++:(Yl=0,Hh=s):Yl=0,$l(0)}}function Y0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,wl(r)))}function zc(){return z0(),H0(),G0(),$0()}function $0(){if(Jt!==5)return!1;var s=ur,r=Bh;Bh=0;var a=Zs(gi),c=$.T,v=de.p;try{de.p=32>a?32:a,$.T=null,a=zh,zh=null;var _=ur,A=gi;if(Jt=0,fa=ur=null,gi=0,(at&6)!==0)throw Error(i(331));var I=at;if(at|=4,I0(_.current),S0(_,_.current,A,a),at=I,$l(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(me,_)}catch{}return!0}finally{de.p=v,$.T=c,Y0(s,r)}}function J0(s,r,a){r=$n(a,r),r=xh(s.stateNode,r,2),s=nr(s,r,2),s!==null&&(Fr(s,2),Fs(s))}function dt(s,r,a){if(s.tag===3)J0(s,s,a);else for(;r!==null;){if(r.tag===3){J0(r,s,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(lr===null||!lr.has(c))){s=$n(a,s),a=Ky(2),c=nr(r,a,2),c!==null&&(Qy(a,c,r,s),Fr(c,2),Fs(c));break}}r=r.return}}function $h(s,r,a){var c=s.pingCache;if(c===null){c=s.pingCache=new HS;var v=new Set;c.set(r,v)}else v=c.get(r),v===void 0&&(v=new Set,c.set(r,v));v.has(a)||(jh=!0,v.add(a),s=KS.bind(null,s,r,a),r.then(s,s))}function KS(s,r,a){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,yt===s&&($e&a)===a&&(Rt===4||Rt===3&&($e&62914560)===$e&&300>Xt()-Uc?(at&2)===0&&ha(s,0):Fh|=a,da===$e&&(da=0)),Fs(s)}function K0(s,r){r===0&&(r=bs()),s=eo(s,r),s!==null&&(Fr(s,r),Fs(s))}function QS(s){var r=s.memoizedState,a=0;r!==null&&(a=r.retryLane),K0(s,a)}function XS(s,r){var a=0;switch(s.tag){case 31:case 13:var c=s.stateNode,v=s.memoizedState;v!==null&&(a=v.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),K0(s,a)}function WS(s,r){return Mt(s,r)}var Hc=null,pa=null,Jh=!1,Gc=!1,Kh=!1,dr=0;function Fs(s){s!==pa&&s.next===null&&(pa===null?Hc=pa=s:pa=pa.next=s),Gc=!0,Jh||(Jh=!0,eC())}function $l(s,r){if(!Kh&&Gc){Kh=!0;do for(var a=!1,c=Hc;c!==null;){if(s!==0){var v=c.pendingLanes;if(v===0)var _=0;else{var A=c.suspendedLanes,I=c.pingedLanes;_=(1<<31-Ue(42|s)+1)-1,_&=v&~(A&~I),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(a=!0,Z0(c,_))}else _=$e,_=ft(c,c===yt?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(_&3)===0||Ut(c,_)||(a=!0,Z0(c,_));c=c.next}while(a);Kh=!1}}function ZS(){Q0()}function Q0(){Gc=Jh=!1;var s=0;dr!==0&&cC()&&(s=dr);for(var r=Xt(),a=null,c=Hc;c!==null;){var v=c.next,_=X0(c,r);_===0?(c.next=null,a===null?Hc=v:a.next=v,v===null&&(pa=a)):(a=c,(s!==0||(_&3)!==0)&&(Gc=!0)),c=v}Jt!==0&&Jt!==5||$l(s),dr!==0&&(dr=0)}function X0(s,r){for(var a=s.suspendedLanes,c=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var A=31-Ue(_),I=1<<A,L=v[A];L===-1?((I&a)===0||(I&c)!==0)&&(v[A]=En(I,r)):L<=r&&(s.expiredLanes|=I),_&=~I}if(r=yt,a=$e,a=ft(s,s===r?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,a===0||s===r&&(ct===2||ct===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&xs(c),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||Ut(s,a)){if(r=a&-a,r===s.callbackPriority)return r;switch(c!==null&&xs(c),Zs(a)){case 2:case 8:a=Fi;break;case 32:a=ss;break;case 268435456:a=Or;break;default:a=ss}return c=W0.bind(null,s),a=Mt(a,c),s.callbackPriority=r,s.callbackNode=a,r}return c!==null&&c!==null&&xs(c),s.callbackPriority=2,s.callbackNode=null,2}function W0(s,r){if(Jt!==0&&Jt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(zc()&&s.callbackNode!==a)return null;var c=$e;return c=ft(s,s===yt?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(P0(s,c,r),X0(s,Xt()),s.callbackNode!=null&&s.callbackNode===a?W0.bind(null,s):null)}function Z0(s,r){if(zc())return null;P0(s,r,!0)}function eC(){fC(function(){(at&6)!==0?Mt(ji,ZS):Q0()})}function Qh(){if(dr===0){var s=ea;s===0&&(s=qn,qn<<=1,(qn&261888)===0&&(qn=256)),dr=s}return dr}function ev(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:jo(""+s)}function tv(s,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,s.id&&a.setAttribute("form",s.id),r.parentNode.insertBefore(a,r),s=new FormData(s),a.parentNode.removeChild(a),s}function tC(s,r,a,c,v){if(r==="submit"&&a&&a.stateNode===v){var _=ev((v[Wt]||null).action),A=c.submitter;A&&(r=(r=A[Wt]||null)?ev(r.formAction):A.getAttribute("formAction"),r!==null&&(_=r,A=null));var I=new Ps("action","action",null,c,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(dr!==0){var L=A?tv(v,A):new FormData(v);gh(a,{pending:!0,data:L,method:v.method,action:_},null,L)}}else typeof _=="function"&&(I.preventDefault(),L=A?tv(v,A):new FormData(v),gh(a,{pending:!0,data:L,method:v.method,action:_},_,L))},currentTarget:v}]})}}for(var Xh=0;Xh<Pf.length;Xh++){var Wh=Pf[Xh],nC=Wh.toLowerCase(),sC=Wh[0].toUpperCase()+Wh.slice(1);ds(nC,"on"+sC)}ds(Dg,"onAnimationEnd"),ds(Pg,"onAnimationIteration"),ds(kg,"onAnimationStart"),ds("dblclick","onDoubleClick"),ds("focusin","onFocus"),ds("focusout","onBlur"),ds(_S,"onTransitionRun"),ds(TS,"onTransitionStart"),ds(ES,"onTransitionCancel"),ds(Vg,"onTransitionEnd"),Ns("onMouseEnter",["mouseout","mouseover"]),Ns("onMouseLeave",["mouseout","mouseover"]),Ns("onPointerEnter",["pointerout","pointerover"]),Ns("onPointerLeave",["pointerout","pointerover"]),Is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Is("onBeforeInput",["compositionend","keypress","textInput","paste"]),Is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jl));function nv(s,r){r=(r&4)!==0;for(var a=0;a<s.length;a++){var c=s[a],v=c.event;c=c.listeners;e:{var _=void 0;if(r)for(var A=c.length-1;0<=A;A--){var I=c[A],L=I.instance,Q=I.currentTarget;if(I=I.listener,L!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=Q;try{_(v)}catch(se){oc(se)}v.currentTarget=null,_=L}else for(A=0;A<c.length;A++){if(I=c[A],L=I.instance,Q=I.currentTarget,I=I.listener,L!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=Q;try{_(v)}catch(se){oc(se)}v.currentTarget=null,_=L}}}}function Ge(s,r){var a=r[ko];a===void 0&&(a=r[ko]=new Set);var c=s+"__bubble";a.has(c)||(sv(r,s,2,!1),a.add(c))}function Zh(s,r,a){var c=0;r&&(c|=4),sv(a,s,c,r)}var Yc="_reactListening"+Math.random().toString(36).slice(2);function em(s){if(!s[Yc]){s[Yc]=!0,ol.forEach(function(a){a!=="selectionchange"&&(iC.has(a)||Zh(a,!1,s),Zh(a,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Yc]||(r[Yc]=!0,Zh("selectionchange",!1,r))}}function sv(s,r,a,c){switch(Dv(r)){case 2:var v=DC;break;case 8:v=PC;break;default:v=pm}a=v.bind(null,r,a,s),v=void 0,!Yr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(v=!0),c?v!==void 0?s.addEventListener(r,a,{capture:!0,passive:v}):s.addEventListener(r,a,!0):v!==void 0?s.addEventListener(r,a,{passive:v}):s.addEventListener(r,a,!1)}function tm(s,r,a,c,v){var _=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var I=c.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=c.return;A!==null;){var L=A.tag;if((L===3||L===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=Cs(I),A===null)return;if(L=A.tag,L===5||L===6||L===26||L===27){c=_=A;continue e}I=I.parentNode}}c=c.return}Yi(function(){var Q=_,se=zn(a),ae=[];e:{var X=Lg.get(s);if(X!==void 0){var te=Ps,Ae=s;switch(s){case"keypress":if(Jr(a)===0)break e;case"keydown":case"keyup":te=sc;break;case"focusin":Ae="focus",te=Qr;break;case"focusout":Ae="blur",te=Qr;break;case"beforeblur":case"afterblur":te=Qr;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=_l;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=x;break;case Dg:case Pg:case kg:te=Qu;break;case Vg:te=M;break;case"scroll":case"scrollend":te=vl;break;case"wheel":te=ee;break;case"copy":case"cut":case"paste":te=Xu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=ni;break;case"toggle":case"beforetoggle":te=Fe}var Me=(r&4)!==0,gt=!Me&&(s==="scroll"||s==="scrollend"),G=Me?X!==null?X+"Capture":null:X;Me=[];for(var B=Q,K;B!==null;){var oe=B;if(K=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||K===null||G===null||(oe=as(B,G),oe!=null&&Me.push(Kl(B,oe,K))),gt)break;B=B.return}0<Me.length&&(X=new te(X,Ae,null,a,se),ae.push({event:X,listeners:Me}))}}if((r&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",X&&a!==pl&&(Ae=a.relatedTarget||a.fromElement)&&(Cs(Ae)||Ae[As]))break e;if((te||X)&&(X=se.window===se?se:(X=se.ownerDocument)?X.defaultView||X.parentWindow:window,te?(Ae=a.relatedTarget||a.toElement,te=Q,Ae=Ae?Cs(Ae):null,Ae!==null&&(gt=l(Ae),Me=Ae.tag,Ae!==gt||Me!==5&&Me!==27&&Me!==6)&&(Ae=null)):(te=null,Ae=Q),te!==Ae)){if(Me=_l,oe="onMouseLeave",G="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Me=ni,oe="onPointerLeave",G="onPointerEnter",B="pointer"),gt=te==null?X:Rn(te),K=Ae==null?X:Rn(Ae),X=new Me(oe,B+"leave",te,a,se),X.target=gt,X.relatedTarget=K,oe=null,Cs(se)===Q&&(Me=new Me(G,B+"enter",Ae,a,se),Me.target=K,Me.relatedTarget=gt,oe=Me),gt=oe,te&&Ae)t:{for(Me=rC,G=te,B=Ae,K=0,oe=G;oe;oe=Me(oe))K++;oe=0;for(var Ie=B;Ie;Ie=Me(Ie))oe++;for(;0<K-oe;)G=Me(G),K--;for(;0<oe-K;)B=Me(B),oe--;for(;K--;){if(G===B||B!==null&&G===B.alternate){Me=G;break t}G=Me(G),B=Me(B)}Me=null}else Me=null;te!==null&&iv(ae,X,te,Me,!1),Ae!==null&&gt!==null&&iv(ae,gt,Ae,Me,!0)}}e:{if(X=Q?Rn(Q):window,te=X.nodeName&&X.nodeName.toLowerCase(),te==="select"||te==="input"&&X.type==="file")var st=Eg;else if(_g(X))if(xg)st=gS;else{st=mS;var we=hS}else te=X.nodeName,!te||te.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&Oo(Q.elementType)&&(st=Eg):st=pS;if(st&&(st=st(s,Q))){Tg(ae,st,a,se);break e}we&&we(s,X,Q),s==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&fl(X,"number",X.value)}switch(we=Q?Rn(Q):window,s){case"focusin":(_g(we)||we.contentEditable==="true")&&(Yo=we,Rf=Q,Al=null);break;case"focusout":Al=Rf=Yo=null;break;case"mousedown":Mf=!0;break;case"contextmenu":case"mouseup":case"dragend":Mf=!1,Rg(ae,a,se);break;case"selectionchange":if(vS)break;case"keydown":case"keyup":Rg(ae,a,se)}var ze;if(ot)e:{switch(s){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else Go?Xr(s,a)&&(Je="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(Je="onCompositionStart");Je&&(Ls&&a.locale!=="ko"&&(Go||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&Go&&(ze=yl()):(Ds=se,gl="value"in Ds?Ds.value:Ds.textContent,Go=!0)),we=$c(Q,Je),0<we.length&&(Je=new Vs(Je,s,null,a,se),ae.push({event:Je,listeners:we}),ze?Je.data=ze:(ze=Ho(a),ze!==null&&(Je.data=ze)))),(ze=Gn?uS(s,a):cS(s,a))&&(Je=$c(Q,"onBeforeInput"),0<Je.length&&(we=new Vs("onBeforeInput","beforeinput",null,a,se),ae.push({event:we,listeners:Je}),we.data=ze)),tC(ae,s,Q,a,se)}nv(ae,r)})}function Kl(s,r,a){return{instance:s,listener:r,currentTarget:a}}function $c(s,r){for(var a=r+"Capture",c=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=as(s,a),v!=null&&c.unshift(Kl(s,v,_)),v=as(s,r),v!=null&&c.push(Kl(s,v,_))),s.tag===3)return c;s=s.return}return[]}function rC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function iv(s,r,a,c,v){for(var _=r._reactName,A=[];a!==null&&a!==c;){var I=a,L=I.alternate,Q=I.stateNode;if(I=I.tag,L!==null&&L===c)break;I!==5&&I!==26&&I!==27||Q===null||(L=Q,v?(Q=as(a,_),Q!=null&&A.unshift(Kl(a,Q,L))):v||(Q=as(a,_),Q!=null&&A.push(Kl(a,Q,L)))),a=a.return}A.length!==0&&s.push({event:r,listeners:A})}var oC=/\r\n?/g,aC=/\u0000|\uFFFD/g;function rv(s){return(typeof s=="string"?s:""+s).replace(oC,`
`).replace(aC,"")}function ov(s,r){return r=rv(r),rv(s)===r}function pt(s,r,a,c,v,_){switch(a){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||bn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&bn(s,""+c);break;case"className":Mn(s,"class",c);break;case"tabIndex":Mn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Mn(s,a,c);break;case"style":ml(s,c,_);break;case"data":if(r!=="object"){Mn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||a!=="href")){s.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=jo(""+c),s.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(a==="formAction"?(r!=="input"&&pt(s,r,"name",v.name,v,null),pt(s,r,"formEncType",v.formEncType,v,null),pt(s,r,"formMethod",v.formMethod,v,null),pt(s,r,"formTarget",v.formTarget,v,null)):(pt(s,r,"encType",v.encType,v,null),pt(s,r,"method",v.method,v,null),pt(s,r,"target",v.target,v,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=jo(""+c),s.setAttribute(a,c);break;case"onClick":c!=null&&(s.onclick=os);break;case"onScroll":c!=null&&Ge("scroll",s);break;case"onScrollEnd":c!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}a=jo(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""+c):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":c===!0?s.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,c):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(a,c):s.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(a):s.setAttribute(a,c);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Lo(s,"popover",c);break;case"xlinkActuate":Ft(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ft(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ft(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ft(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ft(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ft(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ft(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ft(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ft(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Lo(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=$u.get(a)||a,Lo(s,a,c))}}function nm(s,r,a,c,v,_){switch(a){case"style":ml(s,c,_);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"children":typeof c=="string"?bn(s,c):(typeof c=="number"||typeof c=="bigint")&&bn(s,""+c);break;case"onScroll":c!=null&&Ge("scroll",s);break;case"onScrollEnd":c!=null&&Ge("scrollend",s);break;case"onClick":c!=null&&(s.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!al.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(v=a.endsWith("Capture"),r=a.slice(2,v?a.length-7:void 0),_=s[Wt]||null,_=_!=null?_[a]:null,typeof _=="function"&&s.removeEventListener(r,_,v),typeof c=="function")){typeof _!="function"&&_!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(r,c,v);break e}a in s?s[a]=c:c===!0?s.setAttribute(a,""):Lo(s,a,c)}}}function un(s,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var c=!1,v=!1,_;for(_ in a)if(a.hasOwnProperty(_)){var A=a[_];if(A!=null)switch(_){case"src":c=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:pt(s,r,_,A,a,null)}}v&&pt(s,r,"srcSet",a.srcSet,a,null),c&&pt(s,r,"src",a.src,a,null);return;case"input":Ge("invalid",s);var I=_=A=v=null,L=null,Q=null;for(c in a)if(a.hasOwnProperty(c)){var se=a[c];if(se!=null)switch(c){case"name":v=se;break;case"type":A=se;break;case"checked":L=se;break;case"defaultChecked":Q=se;break;case"value":_=se;break;case"defaultValue":I=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:pt(s,r,c,se,a,null)}}Hu(s,_,I,L,Q,A,v,!1);return;case"select":Ge("invalid",s),c=A=_=null;for(v in a)if(a.hasOwnProperty(v)&&(I=a[v],I!=null))switch(v){case"value":_=I;break;case"defaultValue":A=I;break;case"multiple":c=I;default:pt(s,r,v,I,a,null)}r=_,a=A,s.multiple=!!c,r!=null?Bi(s,!!c,r,!1):a!=null&&Bi(s,!!c,a,!0);return;case"textarea":Ge("invalid",s),_=v=c=null;for(A in a)if(a.hasOwnProperty(A)&&(I=a[A],I!=null))switch(A){case"value":c=I;break;case"defaultValue":v=I;break;case"children":_=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:pt(s,r,A,I,a,null)}zi(s,c,v,_);return;case"option":for(L in a)if(a.hasOwnProperty(L)&&(c=a[L],c!=null))switch(L){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:pt(s,r,L,c,a,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(c=0;c<Jl.length;c++)Ge(Jl[c],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in a)if(a.hasOwnProperty(Q)&&(c=a[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:pt(s,r,Q,c,a,null)}return;default:if(Oo(r)){for(se in a)a.hasOwnProperty(se)&&(c=a[se],c!==void 0&&nm(s,r,se,c,a,void 0));return}}for(I in a)a.hasOwnProperty(I)&&(c=a[I],c!=null&&pt(s,r,I,c,a,null))}function lC(s,r,a,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,A=null,I=null,L=null,Q=null,se=null;for(te in a){var ae=a[te];if(a.hasOwnProperty(te)&&ae!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":L=ae;default:c.hasOwnProperty(te)||pt(s,r,te,null,c,ae)}}for(var X in c){var te=c[X];if(ae=a[X],c.hasOwnProperty(X)&&(te!=null||ae!=null))switch(X){case"type":_=te;break;case"name":v=te;break;case"checked":Q=te;break;case"defaultChecked":se=te;break;case"value":A=te;break;case"defaultValue":I=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,r));break;default:te!==ae&&pt(s,r,X,te,c,ae)}}Uo(s,A,I,L,Q,se,_,v);return;case"select":te=A=I=X=null;for(_ in a)if(L=a[_],a.hasOwnProperty(_)&&L!=null)switch(_){case"value":break;case"multiple":te=L;default:c.hasOwnProperty(_)||pt(s,r,_,null,c,L)}for(v in c)if(_=c[v],L=a[v],c.hasOwnProperty(v)&&(_!=null||L!=null))switch(v){case"value":X=_;break;case"defaultValue":I=_;break;case"multiple":A=_;default:_!==L&&pt(s,r,v,_,c,L)}r=I,a=A,c=te,X!=null?Bi(s,!!a,X,!1):!!c!=!!a&&(r!=null?Bi(s,!!a,r,!0):Bi(s,!!a,a?[]:"",!1));return;case"textarea":te=X=null;for(I in a)if(v=a[I],a.hasOwnProperty(I)&&v!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:pt(s,r,I,null,c,v)}for(A in c)if(v=c[A],_=a[A],c.hasOwnProperty(A)&&(v!=null||_!=null))switch(A){case"value":X=v;break;case"defaultValue":te=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==_&&pt(s,r,A,v,c,_)}Gu(s,X,te);return;case"option":for(var Ae in a)if(X=a[Ae],a.hasOwnProperty(Ae)&&X!=null&&!c.hasOwnProperty(Ae))switch(Ae){case"selected":s.selected=!1;break;default:pt(s,r,Ae,null,c,X)}for(L in c)if(X=c[L],te=a[L],c.hasOwnProperty(L)&&X!==te&&(X!=null||te!=null))switch(L){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:pt(s,r,L,X,c,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in a)X=a[Me],a.hasOwnProperty(Me)&&X!=null&&!c.hasOwnProperty(Me)&&pt(s,r,Me,null,c,X);for(Q in c)if(X=c[Q],te=a[Q],c.hasOwnProperty(Q)&&X!==te&&(X!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,r));break;default:pt(s,r,Q,X,c,te)}return;default:if(Oo(r)){for(var gt in a)X=a[gt],a.hasOwnProperty(gt)&&X!==void 0&&!c.hasOwnProperty(gt)&&nm(s,r,gt,void 0,c,X);for(se in c)X=c[se],te=a[se],!c.hasOwnProperty(se)||X===te||X===void 0&&te===void 0||nm(s,r,se,X,c,te);return}}for(var G in a)X=a[G],a.hasOwnProperty(G)&&X!=null&&!c.hasOwnProperty(G)&&pt(s,r,G,null,c,X);for(ae in c)X=c[ae],te=a[ae],!c.hasOwnProperty(ae)||X===te||X==null&&te==null||pt(s,r,ae,X,c,te)}function av(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var v=a[c],_=v.transferSize,A=v.initiatorType,I=v.duration;if(_&&I&&av(A)){for(A=0,I=v.responseEnd,c+=1;c<a.length;c++){var L=a[c],Q=L.startTime;if(Q>I)break;var se=L.transferSize,ae=L.initiatorType;se&&av(ae)&&(L=L.responseEnd,A+=se*(L<I?1:(I-Q)/(L-Q)))}if(--c,r+=8*(_+A)/(v.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var sm=null,im=null;function Jc(s){return s.nodeType===9?s:s.ownerDocument}function lv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function rm(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var om=null;function cC(){var s=window.event;return s&&s.type==="popstate"?s===om?!1:(om=s,!0):(om=null,!1)}var cv=typeof setTimeout=="function"?setTimeout:void 0,dC=typeof clearTimeout=="function"?clearTimeout:void 0,dv=typeof Promise=="function"?Promise:void 0,fC=typeof queueMicrotask=="function"?queueMicrotask:typeof dv<"u"?function(s){return dv.resolve(null).then(s).catch(hC)}:cv;function hC(s){setTimeout(function(){throw s})}function fr(s){return s==="head"}function fv(s,r){var a=r,c=0;do{var v=a.nextSibling;if(s.removeChild(a),v&&v.nodeType===8)if(a=v.data,a==="/$"||a==="/&"){if(c===0){s.removeChild(v),_a(r);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")Ql(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,Ql(a);for(var _=a.firstChild;_;){var A=_.nextSibling,I=_.nodeName;_[Ss]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&_.rel.toLowerCase()==="stylesheet"||a.removeChild(_),_=A}}else a==="body"&&Ql(s.ownerDocument.body);a=v}while(a);_a(r)}function hv(s,r){var a=s;s=0;do{var c=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=c}while(a)}function am(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":am(a),Vo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function mC(s,r,a,c){for(;s.nodeType===1;){var v=a;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[Ss])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=Wn(s.nextSibling),s===null)break}return null}function pC(s,r,a){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Wn(s.nextSibling),s===null))return null;return s}function mv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Wn(s.nextSibling),s===null))return null;return s}function lm(s){return s.data==="$?"||s.data==="$~"}function um(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function gC(s,r){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||a.readyState!=="loading")r();else{var c=function(){r(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function Wn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var cm=null;function pv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(r===0)return Wn(s.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}s=s.nextSibling}return null}function gv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return s;r--}else a!=="/$"&&a!=="/&"||r++}s=s.previousSibling}return null}function yv(s,r,a){switch(r=Jc(a),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Ql(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Vo(s)}var Zn=new Map,vv=new Set;function Kc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var yi=de.d;de.d={f:yC,r:vC,D:_C,C:TC,L:EC,m:xC,X:AC,S:bC,M:SC};function yC(){var s=yi.f(),r=Fc();return s||r}function vC(s){var r=Bn(s);r!==null&&r.tag===5&&r.type==="form"?Vy(r):yi.r(s)}var ga=typeof document>"u"?null:document;function _v(s,r,a){var c=ga;if(c&&typeof r=="string"&&r){var v=xn(r);v='link[rel="'+s+'"][href="'+v+'"]',typeof a=="string"&&(v+='[crossorigin="'+a+'"]'),vv.has(v)||(vv.add(v),s={rel:s,crossOrigin:a,href:r},c.querySelector(v)===null&&(r=c.createElement("link"),un(r,"link",s),jt(r),c.head.appendChild(r)))}}function _C(s){yi.D(s),_v("dns-prefetch",s,null)}function TC(s,r){yi.C(s,r),_v("preconnect",s,r)}function EC(s,r,a){yi.L(s,r,a);var c=ga;if(c&&s&&r){var v='link[rel="preload"][as="'+xn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(v+='[imagesrcset="'+xn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(v+='[imagesizes="'+xn(a.imageSizes)+'"]')):v+='[href="'+xn(s)+'"]';var _=v;switch(r){case"style":_=ya(s);break;case"script":_=va(s)}Zn.has(_)||(s=E({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:s,as:r},a),Zn.set(_,s),c.querySelector(v)!==null||r==="style"&&c.querySelector(Xl(_))||r==="script"&&c.querySelector(Wl(_))||(r=c.createElement("link"),un(r,"link",s),jt(r),c.head.appendChild(r)))}}function xC(s,r){yi.m(s,r);var a=ga;if(a&&s){var c=r&&typeof r.as=="string"?r.as:"script",v='link[rel="modulepreload"][as="'+xn(c)+'"][href="'+xn(s)+'"]',_=v;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=va(s)}if(!Zn.has(_)&&(s=E({rel:"modulepreload",href:s},r),Zn.set(_,s),a.querySelector(v)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Wl(_)))return}c=a.createElement("link"),un(c,"link",s),jt(c),a.head.appendChild(c)}}}function bC(s,r,a){yi.S(s,r,a);var c=ga;if(c&&s){var v=ws(c).hoistableStyles,_=ya(s);r=r||"default";var A=v.get(_);if(!A){var I={loading:0,preload:null};if(A=c.querySelector(Xl(_)))I.loading=5;else{s=E({rel:"stylesheet",href:s,"data-precedence":r},a),(a=Zn.get(_))&&dm(s,a);var L=A=c.createElement("link");jt(L),un(L,"link",s),L._p=new Promise(function(Q,se){L.onload=Q,L.onerror=se}),L.addEventListener("load",function(){I.loading|=1}),L.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Qc(A,r,c)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(_,A)}}}function AC(s,r){yi.X(s,r);var a=ga;if(a&&s){var c=ws(a).hoistableScripts,v=va(s),_=c.get(v);_||(_=a.querySelector(Wl(v)),_||(s=E({src:s,async:!0},r),(r=Zn.get(v))&&fm(s,r),_=a.createElement("script"),jt(_),un(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function SC(s,r){yi.M(s,r);var a=ga;if(a&&s){var c=ws(a).hoistableScripts,v=va(s),_=c.get(v);_||(_=a.querySelector(Wl(v)),_||(s=E({src:s,async:!0,type:"module"},r),(r=Zn.get(v))&&fm(s,r),_=a.createElement("script"),jt(_),un(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function Tv(s,r,a,c){var v=(v=ce.current)?Kc(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=ya(a.href),a=ws(v).hoistableStyles,c=a.get(r),c||(c={type:"style",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=ya(a.href);var _=ws(v).hoistableStyles,A=_.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,A),(_=v.querySelector(Xl(s)))&&!_._p&&(A.instance=_,A.state.loading=5),Zn.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Zn.set(s,a),_||CC(v,s,a,A.state))),r&&c===null)throw Error(i(528,""));return A}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=va(a),a=ws(v).hoistableScripts,c=a.get(r),c||(c={type:"script",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function ya(s){return'href="'+xn(s)+'"'}function Xl(s){return'link[rel="stylesheet"]['+s+"]"}function Ev(s){return E({},s,{"data-precedence":s.precedence,precedence:null})}function CC(s,r,a,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),un(r,"link",a),jt(r),s.head.appendChild(r))}function va(s){return'[src="'+xn(s)+'"]'}function Wl(s){return"script[async]"+s}function xv(s,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+xn(a.href)+'"]');if(c)return r.instance=c,jt(c),c;var v=E({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),jt(c),un(c,"style",v),Qc(c,a.precedence,s),r.instance=c;case"stylesheet":v=ya(a.href);var _=s.querySelector(Xl(v));if(_)return r.state.loading|=4,r.instance=_,jt(_),_;c=Ev(a),(v=Zn.get(v))&&dm(c,v),_=(s.ownerDocument||s).createElement("link"),jt(_);var A=_;return A._p=new Promise(function(I,L){A.onload=I,A.onerror=L}),un(_,"link",c),r.state.loading|=4,Qc(_,a.precedence,s),r.instance=_;case"script":return _=va(a.src),(v=s.querySelector(Wl(_)))?(r.instance=v,jt(v),v):(c=a,(v=Zn.get(_))&&(c=E({},a),fm(c,v)),s=s.ownerDocument||s,v=s.createElement("script"),jt(v),un(v,"link",c),s.head.appendChild(v),r.instance=v);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Qc(c,a.precedence,s));return r.instance}function Qc(s,r,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=c.length?c[c.length-1]:null,_=v,A=0;A<c.length;A++){var I=c[A];if(I.dataset.precedence===r)_=I;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(s,r.firstChild))}function dm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function fm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Xc=null;function bv(s,r,a){if(Xc===null){var c=new Map,v=Xc=new Map;v.set(a,c)}else v=Xc,c=v.get(a),c||(c=new Map,v.set(a,c));if(c.has(s))return c;for(c.set(s,null),a=a.getElementsByTagName(s),v=0;v<a.length;v++){var _=a[v];if(!(_[Ss]||_[Ot]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(r)||"";A=s+A;var I=c.get(A);I?I.push(_):c.set(A,[_])}}return c}function Av(s,r,a){s=s.ownerDocument||s,s.head.insertBefore(a,r==="title"?s.querySelector("head > title"):null)}function wC(s,r,a){if(a===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Sv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function IC(s,r,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var v=ya(c.href),_=r.querySelector(Xl(v));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Wc.bind(s),r.then(s,s)),a.state.loading|=4,a.instance=_,jt(_);return}_=r.ownerDocument||r,c=Ev(c),(v=Zn.get(v))&&dm(c,v),_=_.createElement("link"),jt(_);var A=_;A._p=new Promise(function(I,L){A.onload=I,A.onerror=L}),un(_,"link",c),a.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=Wc.bind(s),r.addEventListener("load",a),r.addEventListener("error",a))}}var hm=0;function NC(s,r){return s.stylesheets&&s.count===0&&ed(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var c=setTimeout(function(){if(s.stylesheets&&ed(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+r);0<s.imgBytes&&hm===0&&(hm=62500*uC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&ed(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>hm?50:800)+r);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(v)}}:null}function Wc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ed(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Zc=null;function ed(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Zc=new Map,r.forEach(RC,s),Zc=null,Wc.call(s))}function RC(s,r){if(!(r.state.loading&4)){var a=Zc.get(s);if(a)var c=a.get(null);else{a=new Map,Zc.set(s,a);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var A=v[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(a.set(A.dataset.precedence,A),c=A)}c&&a.set(null,c)}v=r.instance,A=v.getAttribute("data-precedence"),_=a.get(A)||c,_===c&&a.set(null,v),a.set(A,v),this.count++,c=Wc.bind(this),v.addEventListener("load",c),v.addEventListener("error",c),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),r.state.loading|=4}}var Zl={$$typeof:O,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function MC(s,r,a,c,v,_,A,I,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ye(0),this.hiddenUpdates=Ye(null),this.identifierPrefix=c,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function Cv(s,r,a,c,v,_,A,I,L,Q,se,ae){return s=new MC(s,r,a,A,L,Q,se,ae,I),r=1,_===!0&&(r|=24),_=Pn(3,null,null,r),s.current=_,_.stateNode=s,r=Yf(),r.refCount++,s.pooledCache=r,r.refCount++,_.memoizedState={element:c,isDehydrated:a,cache:r},Qf(_),s}function wv(s){return s?(s=Ko,s):Ko}function Iv(s,r,a,c,v,_){v=wv(v),c.context===null?c.context=v:c.pendingContext=v,c=tr(r),c.payload={element:a},_=_===void 0?null:_,_!==null&&(c.callback=_),a=nr(s,c,r),a!==null&&(In(a,s,r),Ml(a,s,r))}function Nv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<r?a:r}}function mm(s,r){Nv(s,r),(s=s.alternate)&&Nv(s,r)}function Rv(s){if(s.tag===13||s.tag===31){var r=eo(s,67108864);r!==null&&In(r,s,67108864),mm(s,67108864)}}function Mv(s){if(s.tag===13||s.tag===31){var r=On();r=Br(r);var a=eo(s,r);a!==null&&In(a,s,r),mm(s,r)}}var td=!0;function DC(s,r,a,c){var v=$.T;$.T=null;var _=de.p;try{de.p=2,pm(s,r,a,c)}finally{de.p=_,$.T=v}}function PC(s,r,a,c){var v=$.T;$.T=null;var _=de.p;try{de.p=8,pm(s,r,a,c)}finally{de.p=_,$.T=v}}function pm(s,r,a,c){if(td){var v=gm(c);if(v===null)tm(s,r,c,nd,a),Pv(s,c);else if(VC(v,s,r,a,c))c.stopPropagation();else if(Pv(s,c),r&4&&-1<kC.indexOf(s)){for(;v!==null;){var _=Bn(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=Ee(_.pendingLanes);if(A!==0){var I=_;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var L=1<<31-Ue(A);I.entanglements[1]|=L,A&=~L}Fs(_),(at&6)===0&&(Oc=Xt()+500,$l(0))}}break;case 31:case 13:I=eo(_,2),I!==null&&In(I,_,2),Fc(),mm(_,2)}if(_=gm(c),_===null&&tm(s,r,c,nd,a),_===v)break;v=_}v!==null&&c.stopPropagation()}else tm(s,r,c,null,a)}}function gm(s){return s=zn(s),ym(s)}var nd=null;function ym(s){if(nd=null,s=Cs(s),s!==null){var r=l(s);if(r===null)s=null;else{var a=r.tag;if(a===13){if(s=u(r),s!==null)return s;s=null}else if(a===31){if(s=f(r),s!==null)return s;s=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return nd=s,null}function Dv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qs()){case ji:return 2;case Fi:return 8;case ss:case Do:return 32;case Or:return 268435456;default:return 32}default:return 32}}var vm=!1,hr=null,mr=null,pr=null,eu=new Map,tu=new Map,gr=[],kC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pv(s,r){switch(s){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":mr=null;break;case"mouseover":case"mouseout":pr=null;break;case"pointerover":case"pointerout":eu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":tu.delete(r.pointerId)}}function nu(s,r,a,c,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:_,targetContainers:[v]},r!==null&&(r=Bn(r),r!==null&&Rv(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,v!==null&&r.indexOf(v)===-1&&r.push(v),s)}function VC(s,r,a,c,v){switch(r){case"focusin":return hr=nu(hr,s,r,a,c,v),!0;case"dragenter":return mr=nu(mr,s,r,a,c,v),!0;case"mouseover":return pr=nu(pr,s,r,a,c,v),!0;case"pointerover":var _=v.pointerId;return eu.set(_,nu(eu.get(_)||null,s,r,a,c,v)),!0;case"gotpointercapture":return _=v.pointerId,tu.set(_,nu(tu.get(_)||null,s,r,a,c,v)),!0}return!1}function kv(s){var r=Cs(s.target);if(r!==null){var a=l(r);if(a!==null){if(r=a.tag,r===13){if(r=u(a),r!==null){s.blockedOn=r,is(s.priority,function(){Mv(a)});return}}else if(r===31){if(r=f(a),r!==null){s.blockedOn=r,is(s.priority,function(){Mv(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function sd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var a=gm(s.nativeEvent);if(a===null){a=s.nativeEvent;var c=new a.constructor(a.type,a);pl=c,a.target.dispatchEvent(c),pl=null}else return r=Bn(a),r!==null&&Rv(r),s.blockedOn=a,!1;r.shift()}return!0}function Vv(s,r,a){sd(s)&&a.delete(r)}function LC(){vm=!1,hr!==null&&sd(hr)&&(hr=null),mr!==null&&sd(mr)&&(mr=null),pr!==null&&sd(pr)&&(pr=null),eu.forEach(Vv),tu.forEach(Vv)}function id(s,r){s.blockedOn===r&&(s.blockedOn=null,vm||(vm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,LC)))}var rd=null;function Lv(s){rd!==s&&(rd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){rd===s&&(rd=null);for(var r=0;r<s.length;r+=3){var a=s[r],c=s[r+1],v=s[r+2];if(typeof c!="function"){if(ym(c||a)===null)continue;break}var _=Bn(a);_!==null&&(s.splice(r,3),r-=3,gh(_,{pending:!0,data:v,method:a.method,action:c},c,v))}}))}function _a(s){function r(L){return id(L,s)}hr!==null&&id(hr,s),mr!==null&&id(mr,s),pr!==null&&id(pr,s),eu.forEach(r),tu.forEach(r);for(var a=0;a<gr.length;a++){var c=gr[a];c.blockedOn===s&&(c.blockedOn=null)}for(;0<gr.length&&(a=gr[0],a.blockedOn===null);)kv(a),a.blockedOn===null&&gr.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var v=a[c],_=a[c+1],A=v[Wt]||null;if(typeof _=="function")A||Lv(a);else if(A){var I=null;if(_&&_.hasAttribute("formAction")){if(v=_,A=_[Wt]||null)I=A.formAction;else if(ym(v)!==null)continue}else I=A.action;typeof I=="function"?a[c+1]=I:(a.splice(c,3),c-=3),Lv(a)}}}function Uv(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function r(){v!==null&&(v(),v=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),v!==null&&(v(),v=null)}}}function _m(s){this._internalRoot=s}od.prototype.render=_m.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var a=r.current,c=On();Iv(a,c,s,r,null,null)},od.prototype.unmount=_m.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Iv(s.current,2,null,s,null,null),Fc(),r[As]=null}};function od(s){this._internalRoot=s}od.prototype.unstable_scheduleHydration=function(s){if(s){var r=Fu();s={blockedOn:null,target:s,priority:r};for(var a=0;a<gr.length&&r!==0&&r<gr[a].priority;a++);gr.splice(a,0,s),a===0&&kv(s)}};var Ov=e.version;if(Ov!=="19.2.0")throw Error(i(527,Ov,"19.2.0"));de.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=h(r),s=s!==null?T(s):null,s=s===null?null:s.stateNode,s};var UC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{me=ad.inject(UC),Te=ad}catch{}}return iu.createRoot=function(s,r){if(!o(s))throw Error(i(299));var a=!1,c="",v=Gy,_=Yy,A=$y;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(v=r.onUncaughtError),r.onCaughtError!==void 0&&(_=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=Cv(s,1,!1,null,null,a,c,null,v,_,A,Uv),s[As]=r.current,em(s),new _m(r)},iu.hydrateRoot=function(s,r,a){if(!o(s))throw Error(i(299));var c=!1,v="",_=Gy,A=Yy,I=$y,L=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(A=a.onCaughtError),a.onRecoverableError!==void 0&&(I=a.onRecoverableError),a.formState!==void 0&&(L=a.formState)),r=Cv(s,1,!0,r,a??null,c,v,L,_,A,I,Uv),r.context=wv(null),a=r.current,c=On(),c=Br(c),v=tr(c),v.callback=null,nr(a,v,c),a=c,r.current.lanes=a,Fr(r,a),Fs(r),s[As]=r.current,em(s),new od(r)},iu.version="19.2.0",iu}var Jv;function $C(){if(Jv)return xm.exports;Jv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xm.exports=YC(),xm.exports}var JC=$C();const KC=qE(JC),QC=({darkMode:n,onToggle:e})=>d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🌙":"☀️"})]}),XC=({notifications:n,onToggle:e,language:t="ar"})=>{const[i,o]=fe.useState("default");fe.useEffect(()=>{"Notification"in window&&o(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();o(u)}};return d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"text-sm font-medium",children:t==="ar"?"الإشعارات":"Notifications"}),d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🔔":"🔕"})]}),i!=="granted"&&n&&d.jsx("button",{onClick:l,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:t==="ar"?"تفعيل الإشعارات":"Enable Notifications"})]})},ld=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let WC,ZC;function ew(){return{geminiUrl:WC,vertexUrl:ZC}}function tw(n,e,t,i){var o,l;if(!(n!=null&&n.baseUrl)){const u=ew();return e?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(l=u.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ao{}function Se(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const l=e[o];return l!=null?String(l):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function y(n,e,t){for(let l=0;l<e.length-1;l++){const u=e[l];if(u.endsWith("[]")){const f=u.slice(0,-2);if(!(f in n))if(Array.isArray(t))n[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[f])){const g=n[f];if(Array.isArray(t))for(let h=0;h<g.length;h++){const T=g[h];y(T,e.slice(l+1),t[h])}else for(const h of g)y(h,e.slice(l+1),t)}return}else if(u.endsWith("[0]")){const f=u.slice(0,-3);f in n||(n[f]=[{}]);const g=n[f];y(g[0],e.slice(l+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function m(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(l in n){const u=n[l];return Array.isArray(u)?u.map(f=>m(f,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ip(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nw(n){const e={},t=m(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=m(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function sw(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);l!=null&&y(e,["error"],l);const u=m(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],rw(u)),e}function iw(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);l!=null&&y(e,["error"],l);const u=m(n,["response"]);return u!=null&&y(e,["response"],ow(u)),e}function rw(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>aw(u))),y(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=m(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function ow(n){const e={},t=m(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>lw(u))),y(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=m(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function aw(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],dw(t)),e}function lw(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],fw(t)),e}function uw(n){const e={},t=m(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function cw(n){const e={},t=m(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function dw(n){const e={},t=m(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=m(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Ip(i));const o=m(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function fw(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=m(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Ip(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kv||(Kv={}));var Qv;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Qv||(Qv={}));var _r;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(_r||(_r={}));var Xv;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Xv||(Xv={}));var Wv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Wv||(Wv={}));var Zv;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Zv||(Zv={}));var e_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(e_||(e_={}));var t_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(t_||(t_={}));var n_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(n_||(n_={}));var s_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(s_||(s_={}));var i_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(i_||(i_={}));var r_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(r_||(r_={}));var o_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(o_||(o_={}));var a_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(a_||(a_={}));var l_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(l_||(l_={}));var Id;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Id||(Id={}));var u_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(u_||(u_={}));var Gm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Gm||(Gm={}));var c_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(c_||(c_={}));var d_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(d_||(d_={}));var f_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(f_||(f_={}));var h_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(h_||(h_={}));var m_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(m_||(m_={}));var p_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(p_||(p_={}));var g_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(g_||(g_={}));var y_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(y_||(y_={}));var v_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(v_||(v_={}));var __;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(__||(__={}));var T_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(T_||(T_={}));var E_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(E_||(E_={}));var x_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(x_||(x_={}));var b_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(b_||(b_={}));var A_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(A_||(A_={}));var S_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(S_||(S_={}));var C_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(C_||(C_={}));var w_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(w_||(w_={}));var I_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(I_||(I_={}));var N_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(N_||(N_={}));var R_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(R_||(R_={}));var M_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(M_||(M_={}));var D_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(D_||(D_={}));var P_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(P_||(P_={}));var k_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(k_||(k_={}));var V_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(V_||(V_={}));var L_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(L_||(L_={}));var U_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(U_||(U_={}));var O_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(O_||(O_={}));var j_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(j_||(j_={}));var Aa;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Aa||(Aa={}));class Ym{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ru{get text(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",T=!1;const E=[];for(const b of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[w,P]of Object.entries(b))w!=="text"&&w!=="thought"&&(P!==null||P!==void 0)&&E.push(w);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;T=!0,h+=b.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?h:void 0}get data(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const T=[];for(const E of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[b,w]of Object.entries(E))b!=="inlineData"&&(w!==null||w!==void 0)&&T.push(b);E.inlineData&&typeof E.inlineData.data=="string"&&(h+=atob(E.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,i,o,l,u,f,g,h;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(h=T==null?void 0:T[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,i,o,l,u,f,g,h;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(h=T==null?void 0:T[0])===null||h===void 0?void 0:h.output}}class F_{}class q_{}class hw{}class mw{}class pw{}class gw{}class B_{}class z_{}class H_{}class yw{}class Nd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Nd;let o;const l=e;return t?o=iw(l):o=sw(l),Object.assign(i,o),i}}class G_{}class Y_{}class $_{}class vw{}class _w{}class Tw{}class J_{}class Ew{get text(){var e,t,i;let o="",l=!1;const u=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,h]of Object.entries(f))g!=="text"&&g!=="thought"&&h!==null&&u.push(g);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,o+=f.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var e,t,i;let o="";const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,g]of Object.entries(u))f!=="inlineData"&&g!==null&&l.push(f);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class xw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function BE(n,e){const t=rt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function zE(n){return Array.isArray(n)?n.map(e=>Rd(e)):[Rd(n)]}function Rd(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function HE(n){const e=Rd(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function GE(n){const e=Rd(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function K_(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function YE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>K_(e)):[K_(n)]}function $m(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Q_(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function X_(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function pn(n){if(n==null)throw new Error("ContentUnion is required");return $m(n)?n:{role:"user",parts:YE(n)}}function Np(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=pn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=pn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>pn(t)):[pn(e)]}function ns(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Q_(n)||X_(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[pn(n)]}const e=[],t=[],i=$m(n[0]);for(const o of n){const l=$m(o);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(o);else{if(Q_(o)||X_(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:YE(t)}),e}function bw(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(_r).includes(t[0].toUpperCase())?t[0].toUpperCase():_r.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(_r).includes(i.toUpperCase())?i.toUpperCase():_r.TYPE_UNSPECIFIED})}}function wa(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&bw(n.type,e);for(const[u,f]of Object.entries(n))if(f!=null)if(u=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(_r).includes(f.toUpperCase())?f.toUpperCase():_r.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=wa(f);else if(i.includes(u)){const g=[];for(const h of f){if(h.type=="null"){e.nullable=!0;continue}g.push(wa(h))}e[u]=g}else if(o.includes(u)){const g={};for(const[h,T]of Object.entries(f))g[h]=wa(T);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=f}return e}function Rp(n){return wa(n)}function Mp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Dp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Ga(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=wa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=wa(e.response));return n}function Ya(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Aw(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Vi(n,e){if(typeof e!="string")throw new Error("name must be a string");return Aw(n,e,"cachedContents")}function $E(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Pr(n){return Ip(n)}function Sw(n){return n!=null&&typeof n=="object"&&"name"in n}function Cw(n){return n!=null&&typeof n=="object"&&"video"in n}function ww(n){return n!=null&&typeof n=="object"&&"uri"in n}function JE(n){var e;let t;if(Sw(n)&&(t=n.name),!(ww(n)&&(t=n.uri,t===void 0))&&!(Cw(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function KE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function QE(n){for(const e of["models","tunedModels","publisherModels"])if(Iw(n,e))return n[e];return[]}function Iw(n,e){return n!==null&&typeof n=="object"&&e in n}function Nw(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Rw(n,e={}){const t=[],i=new Set;for(const o of n){const l=o.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const u=Nw(o,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function XE(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Mw(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function WE(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let l=!1;for(const u of o){if(typeof u!="object"||u===null)continue;const g=u.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function $a(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function ZE(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dw(n){const e={},t=m(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=m(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>lI(u))),y(e,["inlinedResponses"],l)}const o=m(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["inlinedEmbedContentResponses"],l)}return e}function Pw(n){const e={},t=m(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=m(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const o=m(n,["bigqueryDestination","outputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function kw(n){const e={},t=m(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=m(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const o=m(n,["bigqueryUri"]);if(o!=null&&y(e,["bigqueryDestination","outputUri"],o),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ou(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const o=m(n,["metadata","state"]);o!=null&&y(e,["state"],ZE(o));const l=m(n,["metadata","createTime"]);l!=null&&y(e,["createTime"],l);const u=m(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const f=m(n,["metadata","updateTime"]);f!=null&&y(e,["updateTime"],f);const g=m(n,["metadata","model"]);g!=null&&y(e,["model"],g);const h=m(n,["metadata","output"]);return h!=null&&y(e,["dest"],Dw(WE(h))),e}function Jm(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=m(n,["state"]);o!=null&&y(e,["state"],ZE(o));const l=m(n,["error"]);l!=null&&y(e,["error"],l);const u=m(n,["createTime"]);u!=null&&y(e,["createTime"],u);const f=m(n,["startTime"]);f!=null&&y(e,["startTime"],f);const g=m(n,["endTime"]);g!=null&&y(e,["endTime"],g);const h=m(n,["updateTime"]);h!=null&&y(e,["updateTime"],h);const T=m(n,["model"]);T!=null&&y(e,["model"],T);const E=m(n,["inputConfig"]);E!=null&&y(e,["src"],Vw(E));const b=m(n,["outputConfig"]);return b!=null&&y(e,["dest"],Pw(WE(b))),e}function Vw(n){const e={},t=m(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=m(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const o=m(n,["bigquerySource","inputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Lw(n,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=m(e,["fileName"]);i!=null&&y(t,["fileName"],i);const o=m(e,["inlinedRequests"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>aI(n,u))),y(t,["requests","requests"],l)}return t}function Uw(n){const e={},t=m(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=m(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const o=m(n,["bigqueryUri"]);if(o!=null&&y(e,["bigquerySource","inputUri"],o),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Ow(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function jw(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function Fw(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function qw(n){const e={},t=m(n,["content"]);t!=null&&y(e,["content"],t);const i=m(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],Bw(i));const o=m(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=m(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=m(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=m(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=m(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const h=m(n,["index"]);h!=null&&y(e,["index"],h);const T=m(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=m(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function Bw(n){const e={},t=m(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function ex(n){const e={},t=m(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>pI(l))),y(e,["parts"],o)}const i=m(n,["role"]);return i!=null&&y(e,["role"],i),e}function zw(n,e){const t={},i=m(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),m(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Hw(n,e){const t={},i=m(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=m(n,["dest"]);return e!==void 0&&o!=null&&y(e,["outputConfig"],kw(Mw(o))),t}function W_(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["src"]);o!=null&&y(t,["batch","inputConfig"],Lw(n,XE(n,o)));const l=m(e,["config"]);return l!=null&&zw(l,t),t}function Gw(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["model"],rt(n,i));const o=m(e,["src"]);o!=null&&y(t,["inputConfig"],Uw(XE(n,o)));const l=m(e,["config"]);return l!=null&&Hw(l,t),t}function Yw(n,e){const t={},i=m(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function Cm(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["src"]);o!=null&&y(t,["batch","inputConfig"],Zw(n,o));const l=m(e,["config"]);return l!=null&&Yw(l,t),t}function $w(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function Jw(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function Kw(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);return l!=null&&y(e,["error"],l),e}function Qw(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);return l!=null&&y(e,["error"],l),e}function Xw(n,e){const t={},i=m(e,["contents"]);if(i!=null){let l=Np(n,i);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["requests[]","request","content"],l)}const o=m(e,["config"]);return o!=null&&y(t,["_self"],Ww(o,t)),t}function Ww(n,e){const t={},i=m(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=m(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=m(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Zw(n,e){const t={},i=m(e,["fileName"]);i!=null&&y(t,["file_name"],i);const o=m(e,["inlinedRequests"]);return o!=null&&y(t,["requests"],Xw(n,o)),t}function eI(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function tI(n,e,t){const i={},o=m(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],ex(pn(o)));const l=m(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=m(e,["topP"]);u!=null&&y(i,["topP"],u);const f=m(e,["topK"]);f!=null&&y(i,["topK"],f);const g=m(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const h=m(e,["maxOutputTokens"]);h!=null&&y(i,["maxOutputTokens"],h);const T=m(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=m(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=m(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=m(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const P=m(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const U=m(e,["seed"]);U!=null&&y(i,["seed"],U);const H=m(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const ne=m(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Rp(ne));const F=m(e,["responseJsonSchema"]);if(F!=null&&y(i,["responseJsonSchema"],F),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const O=m(e,["safetySettings"]);if(t!==void 0&&O!=null){let j=O;Array.isArray(j)&&(j=j.map(D=>gI(D))),y(t,["safetySettings"],j)}const z=m(e,["tools"]);if(t!==void 0&&z!=null){let j=Ya(z);Array.isArray(j)&&(j=j.map(D=>yI(Ga(D)))),y(t,["tools"],j)}const Z=m(e,["toolConfig"]);if(t!==void 0&&Z!=null&&y(t,["toolConfig"],Z),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const W=m(e,["cachedContent"]);t!==void 0&&W!=null&&y(t,["cachedContent"],Vi(n,W));const R=m(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=m(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const N=m(e,["speechConfig"]);if(N!=null&&y(i,["speechConfig"],Mp(N)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=m(e,["thinkingConfig"]);k!=null&&y(i,["thinkingConfig"],k);const V=m(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function nI(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(h=>qw(h))),y(e,["candidates"],g)}const o=m(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=m(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=m(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=m(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function sI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function iI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],$a(n,i)),t}function rI(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function oI(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function aI(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["request","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let f=ns(o);Array.isArray(f)&&(f=f.map(g=>ex(g))),y(t,["request","contents"],f)}const l=m(e,["metadata"]);l!=null&&y(t,["metadata"],l);const u=m(e,["config"]);return u!=null&&y(t,["request","generationConfig"],tI(n,u,m(t,["request"],{}))),t}function lI(n){const e={},t=m(n,["response"]);t!=null&&y(e,["response"],nI(t));const i=m(n,["error"]);return i!=null&&y(e,["error"],i),e}function uI(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);if(e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),m(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function cI(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=m(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function dI(n){const e={},t=m(n,["config"]);return t!=null&&uI(t,e),e}function fI(n){const e={},t=m(n,["config"]);return t!=null&&cI(t,e),e}function hI(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["operations"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>ou(u))),y(e,["batchJobs"],l)}return e}function mI(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["batchPredictionJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Jm(u))),y(e,["batchJobs"],l)}return e}function pI(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=m(n,["thought"]);i!=null&&y(e,["thought"],i);const o=m(n,["inlineData"]);o!=null&&y(e,["inlineData"],Ow(o));const l=m(n,["fileData"]);l!=null&&y(e,["fileData"],eI(l));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=m(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=m(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const h=m(n,["executableCode"]);h!=null&&y(e,["executableCode"],h);const T=m(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=m(n,["text"]);return E!=null&&y(e,["text"],E),e}function gI(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&y(e,["category"],t);const i=m(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function yI(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["functionDeclarations"],h)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],oI(i));const o=m(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],rI(l));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=m(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var yo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(yo||(yo={}));class Cu{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vI extends Ao{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var i,o;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const f=this.createInlinedEmbedContentRequest(t),g=f.path,h=f.body,T=Cm(this.apiClient,t)._query||{};return this.apiClient.request({path:g,queryParams:T,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(b=>b.json()).then(b=>ou(b))},this.list=async(t={})=>new Cu(yo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=W_(this.apiClient,e),i=t._url,o=Se("{model}:batchGenerateContent",i),f=t.batch.inputConfig.requests,g=f.requests,h=[];for(const T of g){const E=Object.assign({},T);if(E.systemInstruction){const b=E.systemInstruction;delete E.systemInstruction;const w=E.request;w.systemInstruction=b,E.request=w}h.push(E)}return f.requests=h,delete t.config,delete t._url,delete t._query,{path:o,body:t}}createInlinedEmbedContentRequest(e){const t=Cm(this.apiClient,e),i=t._url,o=Se("{model}:asyncBatchEmbedContent",i),f=t.batch.inputConfig.requests,g=f.requests,h=[];delete f.config;for(const T of g){const E=Object.assign({},T),b=E.request;for(const w in E)w!=="request"&&(b[w]=E[w],delete E[w]);h.push(E)}return f.requests=h,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const l=this.getGcsUri(e),u=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${o}`;else if(u)i.dest=`${u}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=Gw(this.apiClient,e);return f=Se("batchPredictionJobs",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const h=W_(this.apiClient,e);return f=Se("{model}:batchGenerateContent",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>ou(T))}}async createEmbeddingsInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Cm(this.apiClient,e);return l=Se("{model}:asyncBatchEmbedContent",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>ou(g))}}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=iI(this.apiClient,e);return f=Se("batchPredictionJobs/{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const h=sI(this.apiClient,e);return f=Se("batches/{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>ou(T))}}async cancel(e){var t,i,o,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=Fw(this.apiClient,e);u=Se("batchPredictionJobs/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=jw(this.apiClient,e);u=Se("batches/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=fI(e);return f=Se("batchPredictionJobs",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=mI(T),b=new J_;return Object.assign(b,E),b})}else{const h=dI(e);return f=Se("batches",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=hI(T),b=new J_;return Object.assign(b,E),b})}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=Jw(this.apiClient,e);return f=Se("batchPredictionJobs/{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Qw(T))}else{const h=$w(this.apiClient,e);return f=Se("batches/{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Kw(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _I(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Z_(n){const e={},t=m(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>FI(l))),y(e,["parts"],o)}const i=m(n,["role"]);return i!=null&&y(e,["role"],i),e}function TI(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=m(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=m(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=m(n,["contents"]);if(e!==void 0&&u!=null){let T=ns(u);Array.isArray(T)&&(T=T.map(E=>Z_(E))),y(e,["contents"],T)}const f=m(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],Z_(pn(f)));const g=m(n,["tools"]);if(e!==void 0&&g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>qI(E))),y(e,["tools"],T)}const h=m(n,["toolConfig"]);if(e!==void 0&&h!=null&&y(e,["toolConfig"],h),m(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function EI(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=m(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=m(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=m(n,["contents"]);if(e!==void 0&&u!=null){let E=ns(u);Array.isArray(E)&&(E=E.map(b=>b)),y(e,["contents"],E)}const f=m(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],pn(f));const g=m(n,["tools"]);if(e!==void 0&&g!=null){let E=g;Array.isArray(E)&&(E=E.map(b=>BI(b))),y(e,["tools"],E)}const h=m(n,["toolConfig"]);e!==void 0&&h!=null&&y(e,["toolConfig"],h);const T=m(n,["kmsKeyName"]);return e!==void 0&&T!=null&&y(e,["encryption_spec","kmsKeyName"],T),t}function xI(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["model"],BE(n,i));const o=m(e,["config"]);return o!=null&&TI(o,t),t}function bI(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["model"],BE(n,i));const o=m(e,["config"]);return o!=null&&EI(o,t),t}function AI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],Vi(n,i)),t}function SI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],Vi(n,i)),t}function CI(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function wI(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function II(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function NI(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=m(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const f=m(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function RI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],Vi(n,i)),t}function MI(n,e){const t={},i=m(e,["name"]);return i!=null&&y(t,["_url","name"],Vi(n,i)),t}function DI(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function PI(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function kI(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function VI(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function LI(n){const e={},t=m(n,["config"]);return t!=null&&kI(t,e),e}function UI(n){const e={},t=m(n,["config"]);return t!=null&&VI(t,e),e}function OI(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function jI(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function FI(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=m(n,["thought"]);i!=null&&y(e,["thought"],i);const o=m(n,["inlineData"]);o!=null&&y(e,["inlineData"],_I(o));const l=m(n,["fileData"]);l!=null&&y(e,["fileData"],II(l));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=m(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=m(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const h=m(n,["executableCode"]);h!=null&&y(e,["executableCode"],h);const T=m(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=m(n,["text"]);return E!=null&&y(e,["text"],E),e}function qI(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["functionDeclarations"],h)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],PI(i));const o=m(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],DI(l));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=m(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function BI(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>NI(b))),y(e,["functionDeclarations"],E)}const i=m(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=m(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=m(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=m(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=m(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const h=m(n,["computerUse"]);h!=null&&y(e,["computerUse"],h);const T=m(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function zI(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=m(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function HI(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=m(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function GI(n,e){const t={},i=m(e,["name"]);i!=null&&y(t,["_url","name"],Vi(n,i));const o=m(e,["config"]);return o!=null&&zI(o,t),t}function YI(n,e){const t={},i=m(e,["name"]);i!=null&&y(t,["_url","name"],Vi(n,i));const o=m(e,["config"]);return o!=null&&HI(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $I extends Ao{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Cu(yo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=bI(this.apiClient,e);return f=Se("cachedContents",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const h=xI(this.apiClient,e);return f=Se("cachedContents",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=MI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const h=RI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=SI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=wI(T),b=new Y_;return Object.assign(b,E),b})}else{const h=AI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=CI(T),b=new Y_;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=YI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const h=GI(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=UI(e);return f=Se("cachedContents",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=jI(T),b=new $_;return Object.assign(b,E),b})}else{const h=LI(e);return f=Se("cachedContents",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=OI(T),b=new $_;return Object.assign(b,E),b})}}}function eT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Et(n){return this instanceof Et?(this.v=n,this):new Et(n)}function Ia(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(w){return function(P){return Promise.resolve(P).then(w,E)}}function f(w,P){i[w]&&(o[w]=function(U){return new Promise(function(H,ne){l.push([w,U,H,ne])>1||g(w,U)})},P&&(o[w]=P(o[w])))}function g(w,P){try{h(i[w](P))}catch(U){b(l[0][3],U)}}function h(w){w.value instanceof Et?Promise.resolve(w.value.v).then(T,E):b(l[0][2],w)}function T(w){g("next",w)}function E(w){g("throw",w)}function b(w,P){w(P),l.shift(),l.length&&g(l[0][0],l[0][1])}}function fu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof eT=="function"?eT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(u){return new Promise(function(f,g){u=n[l](u),o(f,g,u.done,u.value)})}}function o(l,u,f,g){Promise.resolve(g).then(function(h){l({value:h,done:f})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JI(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:tx(t)}function tx(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function KI(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function tT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let l=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),l&&!tx(n[i])&&(l=!1),i++;l?e.push(...o):e.pop()}return e}class QI{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new XI(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class XI{constructor(e,t,i,o={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=l,this.sendPromise=Promise.resolve(),KI(l)}async sendMessage(e){var t;await this.sendPromise;const i=pn(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,u,f;const g=await o,h=(u=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,T=g.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let b=[];T!=null&&(b=(f=T.slice(E))!==null&&f!==void 0?f:[]);const w=h?[h]:[];this.recordHistory(i,w,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=pn(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const l=await o;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?tT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,o;return Ia(this,arguments,function*(){var u,f,g,h;const T=[];try{for(var E=!0,b=fu(e),w;w=yield Et(b.next()),u=w.done,!u;E=!0){h=w.value,E=!1;const P=h;if(JI(P)){const U=(o=(i=P.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;U!==void 0&&T.push(U)}yield yield Et(P)}}catch(P){f={error:P}}finally{try{!E&&!u&&(g=b.return)&&(yield Et(g.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,T)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(l=>l.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...tT(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Wd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WI(n){const e={},t=m(n,["file"]);return t!=null&&y(e,["file"],t),e}function ZI(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function eN(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","file"],JE(t)),e}function tN(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function nN(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","file"],JE(t)),e}function sN(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function iN(n){const e={},t=m(n,["config"]);return t!=null&&sN(t,e),e}function rN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["files"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oN extends Ao{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Cu(yo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=iN(e);return l=Se("files",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const h=rN(g),T=new vw;return Object.assign(T,h),T})}}async createInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=WI(e);return l=Se("upload/v1beta/files",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const h=ZI(g),T=new _w;return Object.assign(T,h),T})}}async get(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=nN(e);return l=Se("files/{file}",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async delete(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=eN(e);return l=Se("files/{file}",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const h=tN(g),T=new Tw;return Object.assign(T,h),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vd(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function aN(n){const e={},t=m(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>xN(l))),y(e,["parts"],o)}const i=m(n,["role"]);return i!=null&&y(e,["role"],i),e}function lN(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function uN(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=m(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const f=m(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function cN(n){const e={},t=m(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=m(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=m(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=m(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=m(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=m(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=m(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const h=m(n,["mediaResolution"]);h!=null&&y(e,["mediaResolution"],h);const T=m(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=m(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=m(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=m(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const P=m(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const U=m(n,["responseSchema"]);U!=null&&y(e,["responseSchema"],U);const H=m(n,["routingConfig"]);H!=null&&y(e,["routingConfig"],H);const ne=m(n,["seed"]);ne!=null&&y(e,["seed"],ne);const F=m(n,["speechConfig"]);F!=null&&y(e,["speechConfig"],nx(F));const O=m(n,["stopSequences"]);O!=null&&y(e,["stopSequences"],O);const z=m(n,["temperature"]);z!=null&&y(e,["temperature"],z);const Z=m(n,["thinkingConfig"]);Z!=null&&y(e,["thinkingConfig"],Z);const W=m(n,["topK"]);W!=null&&y(e,["topK"],W);const R=m(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function dN(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function fN(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function hN(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=m(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=m(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=m(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=m(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const T=m(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=m(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Dp(E));const b=m(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=m(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const P=m(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],aN(pn(P)));const U=m(n,["tools"]);if(e!==void 0&&U!=null){let W=Ya(U);Array.isArray(W)&&(W=W.map(R=>AN(Ga(R)))),y(e,["setup","tools"],W)}const H=m(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],bN(H));const ne=m(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const F=m(n,["outputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","outputAudioTranscription"],F);const O=m(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const z=m(n,["contextWindowCompression"]);e!==void 0&&z!=null&&y(e,["setup","contextWindowCompression"],z);const Z=m(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function mN(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],cN(i));const o=m(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=m(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=m(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=m(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const T=m(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=m(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],nx(Dp(E)));const b=m(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=m(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const P=m(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],pn(P));const U=m(n,["tools"]);if(e!==void 0&&U!=null){let W=Ya(U);Array.isArray(W)&&(W=W.map(R=>SN(Ga(R)))),y(e,["setup","tools"],W)}const H=m(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],H);const ne=m(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const F=m(n,["outputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","outputAudioTranscription"],F);const O=m(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const z=m(n,["contextWindowCompression"]);e!==void 0&&z!=null&&y(e,["setup","contextWindowCompression"],z);const Z=m(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function pN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=m(e,["config"]);return o!=null&&y(t,["config"],hN(o,t)),t}function gN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=m(e,["config"]);return o!=null&&y(t,["config"],mN(o,t)),t}function yN(n){const e={},t=m(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function vN(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["weightedPrompts"],i)}return e}function _N(n){const e={},t=m(n,["media"]);if(t!=null){let h=zE(t);Array.isArray(h)&&(h=h.map(T=>vd(T))),y(e,["mediaChunks"],h)}const i=m(n,["audio"]);i!=null&&y(e,["audio"],vd(GE(i)));const o=m(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=m(n,["video"]);l!=null&&y(e,["video"],vd(HE(l)));const u=m(n,["text"]);u!=null&&y(e,["text"],u);const f=m(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=m(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function TN(n){const e={},t=m(n,["media"]);if(t!=null){let h=zE(t);Array.isArray(h)&&(h=h.map(T=>T)),y(e,["mediaChunks"],h)}const i=m(n,["audio"]);i!=null&&y(e,["audio"],GE(i));const o=m(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=m(n,["video"]);l!=null&&y(e,["video"],HE(l));const u=m(n,["text"]);u!=null&&y(e,["text"],u);const f=m(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=m(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function EN(n){const e={},t=m(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=m(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const o=m(n,["toolCall"]);o!=null&&y(e,["toolCall"],o);const l=m(n,["toolCallCancellation"]);l!=null&&y(e,["toolCallCancellation"],l);const u=m(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],CN(u));const f=m(n,["goAway"]);f!=null&&y(e,["goAway"],f);const g=m(n,["sessionResumptionUpdate"]);return g!=null&&y(e,["sessionResumptionUpdate"],g),e}function xN(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=m(n,["thought"]);i!=null&&y(e,["thought"],i);const o=m(n,["inlineData"]);o!=null&&y(e,["inlineData"],vd(o));const l=m(n,["fileData"]);l!=null&&y(e,["fileData"],lN(l));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=m(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=m(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const h=m(n,["executableCode"]);h!=null&&y(e,["executableCode"],h);const T=m(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=m(n,["text"]);return E!=null&&y(e,["text"],E),e}function bN(n){const e={},t=m(n,["handle"]);if(t!=null&&y(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function nx(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=m(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function AN(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["functionDeclarations"],h)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],fN(i));const o=m(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],dN(l));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=m(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function SN(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>uN(b))),y(e,["functionDeclarations"],E)}const i=m(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=m(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=m(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=m(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=m(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const h=m(n,["computerUse"]);h!=null&&y(e,["computerUse"],h);const T=m(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function CN(n){const e={},t=m(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=m(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const o=m(n,["candidatesTokenCount"]);o!=null&&y(e,["responseTokenCount"],o);const l=m(n,["toolUsePromptTokenCount"]);l!=null&&y(e,["toolUsePromptTokenCount"],l);const u=m(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const f=m(n,["totalTokenCount"]);f!=null&&y(e,["totalTokenCount"],f);const g=m(n,["promptTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(P=>P)),y(e,["promptTokensDetails"],w)}const h=m(n,["cacheTokensDetails"]);if(h!=null){let w=h;Array.isArray(w)&&(w=w.map(P=>P)),y(e,["cacheTokensDetails"],w)}const T=m(n,["candidatesTokensDetails"]);if(T!=null){let w=T;Array.isArray(w)&&(w=w.map(P=>P)),y(e,["responseTokensDetails"],w)}const E=m(n,["toolUsePromptTokensDetails"]);if(E!=null){let w=E;Array.isArray(w)&&(w=w.map(P=>P)),y(e,["toolUsePromptTokensDetails"],w)}const b=m(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wN(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function IN(n){const e={},t=m(n,["content"]);t!=null&&y(e,["content"],t);const i=m(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],NN(i));const o=m(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=m(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=m(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=m(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=m(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const h=m(n,["index"]);h!=null&&y(e,["index"],h);const T=m(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=m(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function NN(n){const e={},t=m(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function RN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let l=ns(o);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["contents"],l)}return t}function MN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["tokensInfo"],o)}return e}function DN(n){const e={},t=m(n,["values"]);t!=null&&y(e,["values"],t);const i=m(n,["statistics"]);return i!=null&&y(e,["statistics"],PN(i)),e}function PN(n){const e={},t=m(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=m(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function Zd(n){const e={},t=m(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>OR(l))),y(e,["parts"],o)}const i=m(n,["role"]);return i!=null&&y(e,["role"],i),e}function kN(n){const e={},t=m(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=m(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function VN(n){const e={};if(m(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function LN(n,e){const t={},i=m(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],pn(i));const o=m(n,["tools"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(f=>ax(f))),y(e,["tools"],u)}const l=m(n,["generationConfig"]);return e!==void 0&&l!=null&&y(e,["generationConfig"],SR(l)),t}function UN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let u=ns(o);Array.isArray(u)&&(u=u.map(f=>Zd(f))),y(t,["contents"],u)}const l=m(e,["config"]);return l!=null&&VN(l),t}function ON(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let u=ns(o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=m(e,["config"]);return l!=null&&LN(l,t),t}function jN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const o=m(n,["cachedContentTokenCount"]);return o!=null&&y(e,["cachedContentTokenCount"],o),e}function FN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function qN(n,e){const t={},i=m(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function BN(n,e){const t={},i=m(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function zN(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function HN(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function GN(n,e){const t={},i=m(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=m(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=m(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=m(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=m(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=m(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const h=m(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const T=m(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=m(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=m(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=m(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const P=m(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const U=m(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&y(e,["parameters","outputOptions","compressionQuality"],U);const H=m(n,["addWatermark"]);e!==void 0&&H!=null&&y(e,["parameters","addWatermark"],H);const ne=m(n,["labels"]);e!==void 0&&ne!=null&&y(e,["labels"],ne);const F=m(n,["editMode"]);e!==void 0&&F!=null&&y(e,["parameters","editMode"],F);const O=m(n,["baseSteps"]);return e!==void 0&&O!=null&&y(e,["parameters","editConfig","baseSteps"],O),t}function YN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=m(e,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(g=>HR(g))),y(t,["instances[0]","referenceImages"],f)}const u=m(e,["config"]);return u!=null&&GN(u,t),t}function $N(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>ef(l))),y(e,["generatedImages"],o)}return e}function JN(n,e){const t={},i=m(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=m(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=m(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function KN(n,e){const t={},i=m(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const o=m(n,["title"]);e!==void 0&&o!=null&&y(e,["instances[]","title"],o);const l=m(n,["outputDimensionality"]);e!==void 0&&l!=null&&y(e,["parameters","outputDimensionality"],l);const u=m(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const f=m(n,["autoTruncate"]);return e!==void 0&&f!=null&&y(e,["parameters","autoTruncate"],f),t}function QN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let f=Np(n,o);Array.isArray(f)&&(f=f.map(g=>g)),y(t,["requests[]","content"],f)}const l=m(e,["config"]);l!=null&&JN(l,t);const u=m(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],rt(n,u)),t}function XN(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let u=Np(n,o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["instances[]","content"],u)}const l=m(e,["config"]);return l!=null&&KN(l,t),t}function WN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["embeddings"],l)}const o=m(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function ZN(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>DN(u))),y(e,["embeddings"],l)}const o=m(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function eR(n){const e={},t=m(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=m(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function tR(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function nR(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&y(e,["description"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=m(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=m(n,["response"]);u!=null&&y(e,["response"],u);const f=m(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function sR(n,e,t){const i={},o=m(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],Zd(pn(o)));const l=m(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=m(e,["topP"]);u!=null&&y(i,["topP"],u);const f=m(e,["topK"]);f!=null&&y(i,["topK"],f);const g=m(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const h=m(e,["maxOutputTokens"]);h!=null&&y(i,["maxOutputTokens"],h);const T=m(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=m(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=m(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=m(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const P=m(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const U=m(e,["seed"]);U!=null&&y(i,["seed"],U);const H=m(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const ne=m(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Rp(ne));const F=m(e,["responseJsonSchema"]);if(F!=null&&y(i,["responseJsonSchema"],F),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const O=m(e,["safetySettings"]);if(t!==void 0&&O!=null){let j=O;Array.isArray(j)&&(j=j.map(D=>GR(D))),y(t,["safetySettings"],j)}const z=m(e,["tools"]);if(t!==void 0&&z!=null){let j=Ya(z);Array.isArray(j)&&(j=j.map(D=>XR(Ga(D)))),y(t,["tools"],j)}const Z=m(e,["toolConfig"]);if(t!==void 0&&Z!=null&&y(t,["toolConfig"],Z),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const W=m(e,["cachedContent"]);t!==void 0&&W!=null&&y(t,["cachedContent"],Vi(n,W));const R=m(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=m(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const N=m(e,["speechConfig"]);if(N!=null&&y(i,["speechConfig"],Mp(N)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const k=m(e,["thinkingConfig"]);k!=null&&y(i,["thinkingConfig"],k);const V=m(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function iR(n,e,t){const i={},o=m(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],pn(o));const l=m(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=m(e,["topP"]);u!=null&&y(i,["topP"],u);const f=m(e,["topK"]);f!=null&&y(i,["topK"],f);const g=m(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const h=m(e,["maxOutputTokens"]);h!=null&&y(i,["maxOutputTokens"],h);const T=m(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=m(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=m(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=m(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const P=m(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const U=m(e,["seed"]);U!=null&&y(i,["seed"],U);const H=m(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const ne=m(e,["responseSchema"]);ne!=null&&y(i,["responseSchema"],Rp(ne));const F=m(e,["responseJsonSchema"]);F!=null&&y(i,["responseJsonSchema"],F);const O=m(e,["routingConfig"]);O!=null&&y(i,["routingConfig"],O);const z=m(e,["modelSelectionConfig"]);z!=null&&y(i,["modelConfig"],z);const Z=m(e,["safetySettings"]);if(t!==void 0&&Z!=null){let $=Z;Array.isArray($)&&($=$.map(de=>de)),y(t,["safetySettings"],$)}const W=m(e,["tools"]);if(t!==void 0&&W!=null){let $=Ya(W);Array.isArray($)&&($=$.map(de=>ax(Ga(de)))),y(t,["tools"],$)}const R=m(e,["toolConfig"]);t!==void 0&&R!=null&&y(t,["toolConfig"],R);const C=m(e,["labels"]);t!==void 0&&C!=null&&y(t,["labels"],C);const N=m(e,["cachedContent"]);t!==void 0&&N!=null&&y(t,["cachedContent"],Vi(n,N));const k=m(e,["responseModalities"]);k!=null&&y(i,["responseModalities"],k);const V=m(e,["mediaResolution"]);V!=null&&y(i,["mediaResolution"],V);const j=m(e,["speechConfig"]);j!=null&&y(i,["speechConfig"],ox(Mp(j)));const D=m(e,["audioTimestamp"]);D!=null&&y(i,["audioTimestamp"],D);const Le=m(e,["thinkingConfig"]);Le!=null&&y(i,["thinkingConfig"],Le);const he=m(e,["imageConfig"]);return he!=null&&y(i,["imageConfig"],he),i}function nT(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let u=ns(o);Array.isArray(u)&&(u=u.map(f=>Zd(f))),y(t,["contents"],u)}const l=m(e,["config"]);return l!=null&&y(t,["generationConfig"],sR(n,l,t)),t}function sT(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["contents"]);if(o!=null){let u=ns(o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=m(e,["config"]);return l!=null&&y(t,["generationConfig"],iR(n,l,t)),t}function iT(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(h=>IN(h))),y(e,["candidates"],g)}const o=m(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=m(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=m(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=m(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function rT(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["candidates"],h)}const o=m(n,["createTime"]);o!=null&&y(e,["createTime"],o);const l=m(n,["modelVersion"]);l!=null&&y(e,["modelVersion"],l);const u=m(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const f=m(n,["responseId"]);f!=null&&y(e,["responseId"],f);const g=m(n,["usageMetadata"]);return g!=null&&y(e,["usageMetadata"],g),e}function rR(n,e){const t={};if(m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=m(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=m(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const l=m(n,["guidanceScale"]);if(e!==void 0&&l!=null&&y(e,["parameters","guidanceScale"],l),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=m(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const f=m(n,["personGeneration"]);e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f);const g=m(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&y(e,["parameters","includeSafetyAttributes"],g);const h=m(n,["includeRaiReason"]);e!==void 0&&h!=null&&y(e,["parameters","includeRaiReason"],h);const T=m(n,["language"]);e!==void 0&&T!=null&&y(e,["parameters","language"],T);const E=m(n,["outputMimeType"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","mimeType"],E);const b=m(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),m(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=m(n,["imageSize"]);if(e!==void 0&&w!=null&&y(e,["parameters","sampleImageSize"],w),m(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function oR(n,e){const t={},i=m(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=m(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=m(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=m(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=m(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=m(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const h=m(n,["safetyFilterLevel"]);e!==void 0&&h!=null&&y(e,["parameters","safetySetting"],h);const T=m(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=m(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=m(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=m(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const P=m(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const U=m(n,["outputCompressionQuality"]);e!==void 0&&U!=null&&y(e,["parameters","outputOptions","compressionQuality"],U);const H=m(n,["addWatermark"]);e!==void 0&&H!=null&&y(e,["parameters","addWatermark"],H);const ne=m(n,["labels"]);e!==void 0&&ne!=null&&y(e,["labels"],ne);const F=m(n,["imageSize"]);e!==void 0&&F!=null&&y(e,["parameters","sampleImageSize"],F);const O=m(n,["enhancePrompt"]);return e!==void 0&&O!=null&&y(e,["parameters","enhancePrompt"],O),t}function aR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=m(e,["config"]);return l!=null&&rR(l,t),t}function lR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=m(e,["config"]);return l!=null&&oR(l,t),t}function uR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ER(u))),y(e,["generatedImages"],l)}const o=m(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],ix(o)),e}function cR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ef(u))),y(e,["generatedImages"],l)}const o=m(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],rx(o)),e}function dR(n,e){const t={},i=m(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=m(n,["durationSeconds"]);if(e!==void 0&&o!=null&&y(e,["parameters","durationSeconds"],o),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const u=m(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const f=m(n,["personGeneration"]);if(e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f),m(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=m(n,["negativePrompt"]);e!==void 0&&g!=null&&y(e,["parameters","negativePrompt"],g);const h=m(n,["enhancePrompt"]);if(e!==void 0&&h!=null&&y(e,["parameters","enhancePrompt"],h),m(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=m(n,["lastFrame"]);e!==void 0&&T!=null&&y(e,["instances[0]","lastFrame"],tf(T));const E=m(n,["referenceImages"]);if(e!==void 0&&E!=null){let b=E;Array.isArray(b)&&(b=b.map(w=>c1(w))),y(e,["instances[0]","referenceImages"],b)}if(m(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function fR(n,e){const t={},i=m(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=m(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const l=m(n,["fps"]);e!==void 0&&l!=null&&y(e,["parameters","fps"],l);const u=m(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const f=m(n,["seed"]);e!==void 0&&f!=null&&y(e,["parameters","seed"],f);const g=m(n,["aspectRatio"]);e!==void 0&&g!=null&&y(e,["parameters","aspectRatio"],g);const h=m(n,["resolution"]);e!==void 0&&h!=null&&y(e,["parameters","resolution"],h);const T=m(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=m(n,["pubsubTopic"]);e!==void 0&&E!=null&&y(e,["parameters","pubsubTopic"],E);const b=m(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const w=m(n,["enhancePrompt"]);e!==void 0&&w!=null&&y(e,["parameters","enhancePrompt"],w);const P=m(n,["generateAudio"]);e!==void 0&&P!=null&&y(e,["parameters","generateAudio"],P);const U=m(n,["lastFrame"]);e!==void 0&&U!=null&&y(e,["instances[0]","lastFrame"],Ts(U));const H=m(n,["referenceImages"]);if(e!==void 0&&H!=null){let O=H;Array.isArray(O)&&(O=O.map(z=>d1(z))),y(e,["instances[0]","referenceImages"],O)}const ne=m(n,["mask"]);e!==void 0&&ne!=null&&y(e,["instances[0]","mask"],u1(ne));const F=m(n,["compressionQuality"]);return e!==void 0&&F!=null&&y(e,["parameters","compressionQuality"],F),t}function hR(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);l!=null&&y(e,["error"],l);const u=m(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],yR(u)),e}function mR(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=m(n,["done"]);o!=null&&y(e,["done"],o);const l=m(n,["error"]);l!=null&&y(e,["error"],l);const u=m(n,["response"]);return u!=null&&y(e,["response"],vR(u)),e}function pR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=m(e,["image"]);l!=null&&y(t,["instances[0]","image"],tf(l));const u=m(e,["video"]);u!=null&&y(t,["instances[0]","video"],lx(u));const f=m(e,["source"]);f!=null&&_R(f,t);const g=m(e,["config"]);return g!=null&&dR(g,t),t}function gR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=m(e,["image"]);l!=null&&y(t,["instances[0]","image"],Ts(l));const u=m(e,["video"]);u!=null&&y(t,["instances[0]","video"],ux(u));const f=m(e,["source"]);f!=null&&TR(f,t);const g=m(e,["config"]);return g!=null&&fR(g,t),t}function yR(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>bR(u))),y(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=m(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function vR(n){const e={},t=m(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>AR(u))),y(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=m(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function _R(n,e){const t={},i=m(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=m(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],tf(o));const l=m(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],lx(l)),t}function TR(n,e){const t={},i=m(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=m(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],Ts(o));const l=m(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],ux(l)),t}function ER(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["image"],RR(t));const i=m(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=m(n,["_self"]);return o!=null&&y(e,["safetyAttributes"],ix(o)),e}function ef(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["image"],sx(t));const i=m(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=m(n,["_self"]);o!=null&&y(e,["safetyAttributes"],rx(o));const l=m(n,["prompt"]);return l!=null&&y(e,["enhancedPrompt"],l),e}function xR(n){const e={},t=m(n,["_self"]);t!=null&&y(e,["mask"],sx(t));const i=m(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["labels"],o)}return e}function bR(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],a1(t)),e}function AR(n){const e={},t=m(n,["_self"]);return t!=null&&y(e,["video"],l1(t)),e}function SR(n){const e={},t=m(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=m(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=m(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=m(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=m(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=m(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=m(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const h=m(n,["mediaResolution"]);h!=null&&y(e,["mediaResolution"],h);const T=m(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=m(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=m(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=m(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const P=m(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const U=m(n,["responseSchema"]);U!=null&&y(e,["responseSchema"],U);const H=m(n,["routingConfig"]);H!=null&&y(e,["routingConfig"],H);const ne=m(n,["seed"]);ne!=null&&y(e,["seed"],ne);const F=m(n,["speechConfig"]);F!=null&&y(e,["speechConfig"],ox(F));const O=m(n,["stopSequences"]);O!=null&&y(e,["stopSequences"],O);const z=m(n,["temperature"]);z!=null&&y(e,["temperature"],z);const Z=m(n,["thinkingConfig"]);Z!=null&&y(e,["thinkingConfig"],Z);const W=m(n,["topK"]);W!=null&&y(e,["topK"],W);const R=m(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function CR(n,e){const t={},i=m(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function wR(n,e){const t={},i=m(e,["model"]);return i!=null&&y(t,["_url","name"],rt(n,i)),t}function IR(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function NR(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function RR(n){const e={},t=m(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Pr(t));const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function sx(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=m(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],Pr(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function tf(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Pr(t));const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Ts(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=m(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Pr(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function MR(n,e,t){const i={},o=m(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=m(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=m(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=m(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],KE(n,f)),i}function DR(n,e,t){const i={},o=m(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=m(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=m(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=m(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],KE(n,f)),i}function PR(n,e){const t={},i=m(e,["config"]);return i!=null&&MR(n,i,t),t}function kR(n,e){const t={},i=m(e,["config"]);return i!=null&&DR(n,i,t),t}function VR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["_self"]);if(o!=null){let l=QE(o);Array.isArray(l)&&(l=l.map(u=>Km(u))),y(e,["models"],l)}return e}function LR(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["_self"]);if(o!=null){let l=QE(o);Array.isArray(l)&&(l=l.map(u=>Qm(u))),y(e,["models"],l)}return e}function UR(n){const e={},t=m(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=m(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const o=m(n,["maskDilation"]);return o!=null&&y(e,["dilation"],o),e}function Km(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=m(n,["description"]);o!=null&&y(e,["description"],o);const l=m(n,["version"]);l!=null&&y(e,["version"],l);const u=m(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],WR(u));const f=m(n,["inputTokenLimit"]);f!=null&&y(e,["inputTokenLimit"],f);const g=m(n,["outputTokenLimit"]);g!=null&&y(e,["outputTokenLimit"],g);const h=m(n,["supportedGenerationMethods"]);return h!=null&&y(e,["supportedActions"],h),e}function Qm(n){const e={},t=m(n,["name"]);t!=null&&y(e,["name"],t);const i=m(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=m(n,["description"]);o!=null&&y(e,["description"],o);const l=m(n,["versionId"]);l!=null&&y(e,["version"],l);const u=m(n,["deployedModels"]);if(u!=null){let E=u;Array.isArray(E)&&(E=E.map(b=>eR(b))),y(e,["endpoints"],E)}const f=m(n,["labels"]);f!=null&&y(e,["labels"],f);const g=m(n,["_self"]);g!=null&&y(e,["tunedModelInfo"],ZR(g));const h=m(n,["defaultCheckpointId"]);h!=null&&y(e,["defaultCheckpointId"],h);const T=m(n,["checkpoints"]);if(T!=null){let E=T;Array.isArray(E)&&(E=E.map(b=>b)),y(e,["checkpoints"],E)}return e}function OR(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=m(n,["thought"]);i!=null&&y(e,["thought"],i);const o=m(n,["inlineData"]);o!=null&&y(e,["inlineData"],wN(o));const l=m(n,["fileData"]);l!=null&&y(e,["fileData"],tR(l));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=m(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=m(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const h=m(n,["executableCode"]);h!=null&&y(e,["executableCode"],h);const T=m(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=m(n,["text"]);return E!=null&&y(e,["text"],E),e}function jR(n){const e={},t=m(n,["productImage"]);return t!=null&&y(e,["image"],Ts(t)),e}function FR(n,e){const t={},i=m(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=m(n,["baseSteps"]);e!==void 0&&o!=null&&y(e,["parameters","editConfig","baseSteps"],o);const l=m(n,["outputGcsUri"]);e!==void 0&&l!=null&&y(e,["parameters","storageUri"],l);const u=m(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const f=m(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&y(e,["parameters","safetySetting"],f);const g=m(n,["personGeneration"]);e!==void 0&&g!=null&&y(e,["parameters","personGeneration"],g);const h=m(n,["addWatermark"]);e!==void 0&&h!=null&&y(e,["parameters","addWatermark"],h);const T=m(n,["outputMimeType"]);e!==void 0&&T!=null&&y(e,["parameters","outputOptions","mimeType"],T);const E=m(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const b=m(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const w=m(n,["labels"]);return e!==void 0&&w!=null&&y(e,["labels"],w),t}function qR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["source"]);o!=null&&zR(o,t);const l=m(e,["config"]);return l!=null&&FR(l,t),t}function BR(n){const e={},t=m(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>ef(o))),y(e,["generatedImages"],i)}return e}function zR(n,e){const t={},i=m(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=m(n,["personImage"]);e!==void 0&&o!=null&&y(e,["instances[0]","personImage","image"],Ts(o));const l=m(n,["productImages"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(f=>jR(f))),y(e,["instances[0]","productImages"],u)}return t}function HR(n){const e={},t=m(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],Ts(t));const i=m(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const o=m(n,["referenceType"]);o!=null&&y(e,["referenceType"],o);const l=m(n,["maskImageConfig"]);l!=null&&y(e,["maskImageConfig"],UR(l));const u=m(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],kN(u));const f=m(n,["styleImageConfig"]);f!=null&&y(e,["styleImageConfig"],f);const g=m(n,["subjectImageConfig"]);return g!=null&&y(e,["subjectImageConfig"],g),e}function ix(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=m(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=m(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function rx(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=m(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=m(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function GR(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&y(e,["category"],t);const i=m(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function YR(n){const e={},t=m(n,["image"]);return t!=null&&y(e,["image"],Ts(t)),e}function $R(n,e){const t={},i=m(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const o=m(n,["maxPredictions"]);e!==void 0&&o!=null&&y(e,["parameters","maxPredictions"],o);const l=m(n,["confidenceThreshold"]);e!==void 0&&l!=null&&y(e,["parameters","confidenceThreshold"],l);const u=m(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const f=m(n,["binaryColorThreshold"]);e!==void 0&&f!=null&&y(e,["parameters","binaryColorThreshold"],f);const g=m(n,["labels"]);return e!==void 0&&g!=null&&y(e,["labels"],g),t}function JR(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["source"]);o!=null&&QR(o,t);const l=m(e,["config"]);return l!=null&&$R(l,t),t}function KR(n){const e={},t=m(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>xR(o))),y(e,["generatedMasks"],i)}return e}function QR(n,e){const t={},i=m(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=m(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],Ts(o));const l=m(n,["scribbleImage"]);return e!==void 0&&l!=null&&y(e,["instances[0]","scribble"],YR(l)),t}function ox(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=m(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function XR(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["functionDeclarations"],h)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],NR(i));const o=m(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],IR(l));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=m(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function ax(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>nR(b))),y(e,["functionDeclarations"],E)}const i=m(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=m(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=m(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=m(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=m(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=m(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const h=m(n,["computerUse"]);h!=null&&y(e,["computerUse"],h);const T=m(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function WR(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=m(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=m(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function ZR(n){const e={},t=m(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=m(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=m(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function e1(n,e){const t={},i=m(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=m(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=m(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function t1(n,e){const t={},i=m(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=m(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=m(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function n1(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","name"],rt(n,i));const o=m(e,["config"]);return o!=null&&e1(o,t),t}function s1(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["config"]);return o!=null&&t1(o,t),t}function i1(n,e){const t={},i=m(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=m(n,["includeRaiReason"]);e!==void 0&&o!=null&&y(e,["parameters","includeRaiReason"],o);const l=m(n,["outputMimeType"]);e!==void 0&&l!=null&&y(e,["parameters","outputOptions","mimeType"],l);const u=m(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const f=m(n,["enhanceInputImage"]);e!==void 0&&f!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=m(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const h=m(n,["labels"]);e!==void 0&&h!=null&&y(e,["labels"],h);const T=m(n,["numberOfImages"]);e!==void 0&&T!=null&&y(e,["parameters","sampleCount"],T);const E=m(n,["mode"]);return e!==void 0&&E!=null&&y(e,["parameters","mode"],E),t}function r1(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["_url","model"],rt(n,i));const o=m(e,["image"]);o!=null&&y(t,["instances[0]","image"],Ts(o));const l=m(e,["upscaleFactor"]);l!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],l);const u=m(e,["config"]);return u!=null&&i1(u,t),t}function o1(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>ef(l))),y(e,["generatedImages"],o)}return e}function a1(n){const e={},t=m(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=m(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Pr(i));const o=m(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function l1(n){const e={},t=m(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=m(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Pr(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function u1(n){const e={},t=m(n,["image"]);t!=null&&y(e,["_self"],Ts(t));const i=m(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function c1(n){const e={},t=m(n,["image"]);t!=null&&y(e,["image"],tf(t));const i=m(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function d1(n){const e={},t=m(n,["image"]);t!=null&&y(e,["image"],Ts(t));const i=m(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function lx(n){const e={},t=m(n,["uri"]);t!=null&&y(e,["video","uri"],t);const i=m(n,["videoBytes"]);i!=null&&y(e,["video","encodedVideo"],Pr(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["encoding"],o),e}function ux(n){const e={},t=m(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=m(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Pr(i));const o=m(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f1="Content-Type",h1="X-Server-Timeout",m1="User-Agent",Xm="x-goog-api-client",p1="1.24.0",g1=`google-genai-sdk/${p1}`,y1="v1beta1",v1="v1beta",oT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class _1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:y1,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:v1,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,f]of Object.entries(e.queryParams))o.searchParams.append(u,String(f));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(o,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,l]of Object.entries(t))typeof l=="object"?i[o]=Object.assign(Object.assign({},i[o]),l):l!==void 0&&(i[o]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(o,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&T1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await aT(o),new Ym(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await aT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return Ia(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:f,value:g}=yield Et(o.read());if(f){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=l.decode(g,{stream:!0});try{const E=JSON.parse(h);if("error"in E){const b=JSON.parse(JSON.stringify(E.error)),w=b.status,P=b.code,U=`got status: ${w}. ${JSON.stringify(E)}`;if(P>=400&&P<600)throw new Wd({message:U,status:P})}}catch(E){if(E.name==="ApiError")throw E}u+=h;let T=u.match(oT);for(;T;){const E=T[1];try{const b=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Et(new Ym(b)),u=u.slice(T[0].length),T=u.match(oT)}catch(b){throw new Error(`exception parsing stream chunk ${E}. ${b}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=g1+" "+this.clientOptions.userAgentExtra;return e[m1]=t,e[Xm]=t,e[f1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))t.append(i,o);e.timeout&&e.timeout>0&&t.append(h1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);o.sizeBytes=String(u.size);const f=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=f;const g=await this.fetchUploadUrl(o,t);return l.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let o={};t!=null&&t.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},u=await this.request({path:Se("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function aT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new Wd({message:o,status:t}):new Error(o)}}function T1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,u){const f=Object.assign({},l);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const h=u[g],T=f[g];h&&typeof h=="object"&&!Array.isArray(h)&&T&&typeof T=="object"&&!Array.isArray(T)?f[g]=i(T,h):(T&&h&&typeof T!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof T}, New type: ${typeof h}. Overwriting.`),f[g]=h)}return f}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E1="mcp_used/unknown";let x1=!1;function cx(n){for(const e of n)if(b1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return x1}function dx(n){var e;const t=(e=n[Xm])!==null&&e!==void 0?e:"";n[Xm]=(t+` ${E1}`).trimStart()}function b1(n){return n!==null&&typeof n=="object"&&n instanceof Pp}function A1(n,e=100){return Ia(this,arguments,function*(){let i,o=0;for(;o<e;){const l=yield Et(n.listTools({cursor:i}));for(const u of l.tools)yield yield Et(u),o++;if(!l.nextCursor)break;i=l.nextCursor}})}class Pp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Pp(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const l={},u=[];for(const T of this.mcpClients)try{for(var f=!0,g=(t=void 0,fu(A1(T))),h;h=await g.next(),e=h.done,!e;f=!0){o=h.value,f=!1;const E=o;u.push(E);const b=E.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=T}}catch(E){t={error:E}}finally{try{!f&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),Rw(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const u=await o.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function S1(n,e,t){const i=new xw;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class C1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),u=N1(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),g=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${f}`;let h=()=>{};const T=new Promise(O=>{h=O}),E=e.callbacks,b=function(){h({})},w=this.apiClient,P={onopen:b,onmessage:O=>{S1(w,E.onmessage,O)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(O){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(O){}},U=this.webSocketFactory.create(g,I1(u),P);U.connect(),await T;const F={setup:{model:rt(this.apiClient,e.model)}};return U.send(JSON.stringify(F)),new w1(U,this.apiClient)}}class w1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=vN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=yN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Aa.PLAY)}pause(){this.sendPlaybackControl(Aa.PAUSE)}stop(){this.sendPlaybackControl(Aa.STOP)}resetContext(){this.sendPlaybackControl(Aa.RESET_CONTEXT)}close(){this.conn.close()}}function I1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function N1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const R1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function M1(n,e,t){const i=new Ew;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const l=JSON.parse(o);if(n.isVertexAI()){const u=EN(l);Object.assign(i,u)}else Object.assign(i,l);e(i)}class D1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new C1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,l,u,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let T;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&cx(e.config.tools)&&dx(E);const b=L1(E);if(this.apiClient.isVertexAI())T=`${g}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const N=this.apiClient.getApiKey();let k="BidiGenerateContent",V="key";N!=null&&N.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),k="BidiGenerateContentConstrained",V="access_token"),T=`${g}/ws/google.ai.generativelanguage.${h}.GenerativeService.${k}?${V}=${N}`}let w=()=>{};const P=new Promise(N=>{w=N}),U=e.callbacks,H=function(){var N;(N=U==null?void 0:U.onopen)===null||N===void 0||N.call(U),w({})},ne=this.apiClient,F={onopen:H,onmessage:N=>{M1(ne,U.onmessage,N)},onerror:(t=U==null?void 0:U.onerror)!==null&&t!==void 0?t:function(N){},onclose:(i=U==null?void 0:U.onclose)!==null&&i!==void 0?i:function(N){}},O=this.webSocketFactory.create(T,V1(b),F);O.connect(),await P;let z=rt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&z.startsWith("publishers/")){const N=this.apiClient.getProject(),k=this.apiClient.getLocation();z=`projects/${N}/locations/${k}/`+z}let Z={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Id.AUDIO]}:e.config.responseModalities=[Id.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const W=(f=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[],R=[];for(const N of W)if(this.isCallableTool(N)){const k=N;R.push(await k.tool())}else R.push(N);R.length>0&&(e.config.tools=R);const C={model:z,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Z=gN(this.apiClient,C):Z=pN(this.apiClient,C),delete Z.config,O.send(JSON.stringify(Z)),new k1(O,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const P1={turnComplete:!0};class k1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ns(t.turns),e.isVertexAI()||(i=i.map(o=>Zd(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(R1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},P1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:TN(e)}:t={realtimeInput:_N(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function V1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function L1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lT=10;function uT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Na(u)){o=!0;break}if(!o)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function Na(n){return"callTool"in n&&typeof n.callTool=="function"}function U1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>Na(o)))!==null&&i!==void 0?i:!1}function O1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!Na(o)))!==null&&i!==void 0?i:!1}function cT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class j1 extends Ao{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,l,u,f;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!U1(t)||uT(t.config))return await this.generateContentInternal(g);if(O1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,T;const E=ns(g.contents),b=(l=(o=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&l!==void 0?l:lT;let w=0;for(;w<b&&(h=await this.generateContentInternal(g),!(!h.functionCalls||h.functionCalls.length===0));){const P=h.candidates[0].content,U=[];for(const H of(f=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[])if(Na(H)){const F=await H.callTool(h.functionCalls);U.push(...F)}w++,T={role:"user",parts:U},g.contents=ns(g.contents),g.contents.push(P),g.contents.push(T),cT(g.config)&&(E.push(P),E.push(T))}return cT(g.config)&&(h.automaticFunctionCallingHistory=E),h},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),uT(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let l;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((o=g==null?void 0:g.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:u.push(g);let f;return l?f={generatedImages:u,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:f={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},f}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Cu(yo.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const u=await Promise.all(l.map(async g=>Na(g)?await g.tool():g)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(f.config.tools=u,e.config&&e.config.tools&&cx(e.config.tools)){const g=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let h=Object.assign({},g);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),dx(h),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return f}async initAfcToolsMap(e){var t,i,o;const l=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Na(u)){const f=u,g=await f.tool();for(const h of(o=g.functionDeclarations)!==null&&o!==void 0?o:[]){if(!h.name)throw new Error("Function declaration name is required.");if(l.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);l.set(h.name,f)}}return l}async processAfcStream(e){var t,i,o;const l=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:lT;let u=!1,f=0;const g=await this.initAfcToolsMap(e);return(function(h,T,E){var b,w;return Ia(this,arguments,function*(){for(var P,U,H,ne;f<l;){u&&(f++,u=!1);const Z=yield Et(h.processParamsMaybeAddMcpUsage(E)),W=yield Et(h.generateContentStreamInternal(Z)),R=[],C=[];try{for(var F=!0,O=(U=void 0,fu(W)),z;z=yield Et(O.next()),P=z.done,!P;F=!0){ne=z.value,F=!1;const N=ne;if(yield yield Et(N),N.candidates&&(!((b=N.candidates[0])===null||b===void 0)&&b.content)){C.push(N.candidates[0].content);for(const k of(w=N.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(f<l&&k.functionCall){if(!k.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(k.functionCall.name)){const V=yield Et(T.get(k.functionCall.name).callTool([k.functionCall]));R.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${k.functionCall.name}`)}}}}catch(N){U={error:N}}finally{try{!F&&!P&&(H=O.return)&&(yield Et(H.call(O)))}finally{if(U)throw U.error}}if(R.length>0){u=!0;const N=new ru;N.candidates=[{content:{role:"user",parts:R}}],yield yield Et(N);const k=[];k.push(...C),k.push({role:"user",parts:R});const V=ns(E.contents).concat(k);E.contents=V}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=sT(this.apiClient,e);return f=Se("{model}:generateContent",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=rT(T),b=new ru;return Object.assign(b,E),b})}else{const h=nT(this.apiClient,e);return f=Se("{model}:generateContent",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=iT(T),b=new ru;return Object.assign(b,E),b})}}async generateContentStreamInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=sT(this.apiClient,e);return f=Se("{model}:streamGenerateContent?alt=sse",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(E){return Ia(this,arguments,function*(){var b,w,P,U;try{for(var H=!0,ne=fu(E),F;F=yield Et(ne.next()),b=F.done,!b;H=!0){U=F.value,H=!1;const O=U,z=rT(yield Et(O.json()));z.sdkHttpResponse={headers:O.headers};const Z=new ru;Object.assign(Z,z),yield yield Et(Z)}}catch(O){w={error:O}}finally{try{!H&&!b&&(P=ne.return)&&(yield Et(P.call(ne)))}finally{if(w)throw w.error}}})})}else{const h=nT(this.apiClient,e);return f=Se("{model}:streamGenerateContent?alt=sse",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),u.then(function(E){return Ia(this,arguments,function*(){var b,w,P,U;try{for(var H=!0,ne=fu(E),F;F=yield Et(ne.next()),b=F.done,!b;H=!0){U=F.value,H=!1;const O=U,z=iT(yield Et(O.json()));z.sdkHttpResponse={headers:O.headers};const Z=new ru;Object.assign(Z,z),yield yield Et(Z)}}catch(O){w={error:O}}finally{try{!H&&!b&&(P=ne.return)&&(yield Et(P.call(ne)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=XN(this.apiClient,e);return f=Se("{model}:predict",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=ZN(T),b=new F_;return Object.assign(b,E),b})}else{const h=QN(this.apiClient,e);return f=Se("{model}:batchEmbedContents",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=WN(T),b=new F_;return Object.assign(b,E),b})}}async generateImagesInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=lR(this.apiClient,e);return f=Se("{model}:predict",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=cR(T),b=new q_;return Object.assign(b,E),b})}else{const h=aR(this.apiClient,e);return f=Se("{model}:predict",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=uR(T),b=new q_;return Object.assign(b,E),b})}}async editImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=YN(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const h=$N(g),T=new hw;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=r1(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const h=o1(g),T=new mw;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=qR(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const h=BR(g),T=new pw;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=JR(this.apiClient,e);return l=Se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const h=KR(g),T=new gw;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=wR(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const h=CR(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=kR(this.apiClient,e);return f=Se("{models_url}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=LR(T),b=new B_;return Object.assign(b,E),b})}else{const h=PR(this.apiClient,e);return f=Se("{models_url}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=VR(T),b=new B_;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=s1(this.apiClient,e);return f=Se("{model}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const h=n1(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=BN(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=HN(T),b=new z_;return Object.assign(b,E),b})}else{const h=qN(this.apiClient,e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=zN(T),b=new z_;return Object.assign(b,E),b})}}async countTokens(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=ON(this.apiClient,e);return f=Se("{model}:countTokens",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=FN(T),b=new H_;return Object.assign(b,E),b})}else{const h=UN(this.apiClient,e);return f=Se("{model}:countTokens",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=jN(T),b=new H_;return Object.assign(b,E),b})}}async computeTokens(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=RN(this.apiClient,e);return l=Se("{model}:computeTokens",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const h=MN(g),T=new yw;return Object.assign(T,h),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=gR(this.apiClient,e);return f=Se("{model}:predictLongRunning",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>{const E=mR(T),b=new Nd;return Object.assign(b,E),b})}else{const h=pR(this.apiClient,e);return f=Se("{model}:predictLongRunning",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>{const E=hR(T),b=new Nd;return Object.assign(b,E),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class F1 extends Ao{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=cw(e);return f=Se("{operationName}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u}else{const h=uw(e);return f=Se("{operationName}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=nw(e);return l=Se("{resourceName}:fetchPredictOperation",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q1(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&y(e,["data"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function B1(n){const e={},t=m(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>Q1(l))),y(e,["parts"],o)}const i=m(n,["role"]);return i!=null&&y(e,["role"],i),e}function z1(n,e,t){const i={},o=m(e,["expireTime"]);t!==void 0&&o!=null&&y(t,["expireTime"],o);const l=m(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&y(t,["newSessionExpireTime"],l);const u=m(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const f=m(e,["liveConnectConstraints"]);t!==void 0&&f!=null&&y(t,["bidiGenerateContentSetup"],K1(n,f));const g=m(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&y(t,["fieldMask"],g),i}function H1(n,e){const t={},i=m(e,["config"]);return i!=null&&y(t,["config"],z1(n,i,t)),t}function G1(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Y1(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function $1(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function J1(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=m(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=m(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=m(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=m(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=m(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","mediaResolution"],h);const T=m(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=m(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Dp(E));const b=m(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=m(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const P=m(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],B1(pn(P)));const U=m(n,["tools"]);if(e!==void 0&&U!=null){let W=Ya(U);Array.isArray(W)&&(W=W.map(R=>W1(Ga(R)))),y(e,["setup","tools"],W)}const H=m(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],X1(H));const ne=m(n,["inputAudioTranscription"]);e!==void 0&&ne!=null&&y(e,["setup","inputAudioTranscription"],ne);const F=m(n,["outputAudioTranscription"]);e!==void 0&&F!=null&&y(e,["setup","outputAudioTranscription"],F);const O=m(n,["realtimeInputConfig"]);e!==void 0&&O!=null&&y(e,["setup","realtimeInputConfig"],O);const z=m(n,["contextWindowCompression"]);e!==void 0&&z!=null&&y(e,["setup","contextWindowCompression"],z);const Z=m(n,["proactivity"]);return e!==void 0&&Z!=null&&y(e,["setup","proactivity"],Z),t}function K1(n,e){const t={},i=m(e,["model"]);i!=null&&y(t,["setup","model"],rt(n,i));const o=m(e,["config"]);return o!=null&&y(t,["config"],J1(o,t)),t}function Q1(n){const e={},t=m(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=m(n,["thought"]);i!=null&&y(e,["thought"],i);const o=m(n,["inlineData"]);o!=null&&y(e,["inlineData"],q1(o));const l=m(n,["fileData"]);l!=null&&y(e,["fileData"],G1(l));const u=m(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=m(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=m(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const h=m(n,["executableCode"]);h!=null&&y(e,["executableCode"],h);const T=m(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=m(n,["text"]);return E!=null&&y(e,["text"],E),e}function X1(n){const e={},t=m(n,["handle"]);if(t!=null&&y(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function W1(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(T=>T)),y(e,["functionDeclarations"],h)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],$1(i));const o=m(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],Y1(l));const u=m(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=m(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=m(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z1(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(l=>`${t}.${l}`);e.push(...o)}else e.push(t)}return e.join(",")}function eM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const l=Z1(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];o.length>0&&(f=o.map(h=>u.includes(h)?`generationConfig.${h}`:h));const g=[];l&&g.push(l),f.length>0&&g.push(...f),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class tM extends Ao{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=H1(this.apiClient,e);l=Se("auth_tokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query;const g=eM(f,e.config);return o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nM(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function sM(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function iM(n,e){const t={};if(m(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=m(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),m(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=m(n,["epochCount"]);e!==void 0&&o!=null&&y(e,["tuningTask","hyperparameters","epochCount"],o);const l=m(n,["learningRateMultiplier"]);if(l!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=m(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const f=m(n,["learningRate"]);if(e!==void 0&&f!=null&&y(e,["tuningTask","hyperparameters","learningRate"],f),m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function rM(n,e){const t={},i=m(n,["validationDataset"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec"],TM(i,t));const o=m(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&y(e,["tunedModelDisplayName"],o);const l=m(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);const u=m(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const f=m(n,["learningRateMultiplier"]);e!==void 0&&f!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const g=m(n,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const h=m(n,["adapterSize"]);if(e!==void 0&&h!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],h),m(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=m(n,["labels"]);return e!==void 0&&T!=null&&y(e,["labels"],T),t}function oM(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=m(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=m(n,["trainingDataset"]);o!=null&&y(e,["tuningTask","trainingData"],yM(o));const l=m(n,["config"]);return l!=null&&iM(l,e),e}function aM(n){const e={},t=m(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=m(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=m(n,["trainingDataset"]);o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],vM(o,e));const l=m(n,["config"]);return l!=null&&rM(l,e),e}function lM(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function uM(n){const e={},t=m(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function cM(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=m(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function dM(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=m(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=m(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function fM(n){const e={},t=m(n,["config"]);return t!=null&&cM(t,e),e}function hM(n){const e={},t=m(n,["config"]);return t!=null&&dM(t,e),e}function mM(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>fx(u))),y(e,["tuningJobs"],l)}return e}function pM(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=m(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Wm(u))),y(e,["tuningJobs"],l)}return e}function gM(n){const e={},t=m(n,["name"]);t!=null&&y(e,["model"],t);const i=m(n,["name"]);return i!=null&&y(e,["endpoint"],i),e}function yM(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=m(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["examples","examples"],i)}return e}function vM(n,e){const t={},i=m(n,["gcsUri"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],i);const o=m(n,["vertexDatasetResource"]);if(e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),m(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function fx(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["state"]);o!=null&&y(e,["state"],$E(o));const l=m(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=m(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const f=m(n,["tuningTask","completeTime"]);f!=null&&y(e,["endTime"],f);const g=m(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const h=m(n,["description"]);h!=null&&y(e,["description"],h);const T=m(n,["baseModel"]);T!=null&&y(e,["baseModel"],T);const E=m(n,["_self"]);E!=null&&y(e,["tunedModel"],gM(E));const b=m(n,["customBaseModel"]);b!=null&&y(e,["customBaseModel"],b);const w=m(n,["experiment"]);w!=null&&y(e,["experiment"],w);const P=m(n,["labels"]);P!=null&&y(e,["labels"],P);const U=m(n,["outputUri"]);U!=null&&y(e,["outputUri"],U);const H=m(n,["pipelineJob"]);H!=null&&y(e,["pipelineJob"],H);const ne=m(n,["serviceAccount"]);ne!=null&&y(e,["serviceAccount"],ne);const F=m(n,["tunedModelDisplayName"]);F!=null&&y(e,["tunedModelDisplayName"],F);const O=m(n,["veoTuningSpec"]);return O!=null&&y(e,["veoTuningSpec"],O),e}function Wm(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["state"]);o!=null&&y(e,["state"],$E(o));const l=m(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=m(n,["startTime"]);u!=null&&y(e,["startTime"],u);const f=m(n,["endTime"]);f!=null&&y(e,["endTime"],f);const g=m(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const h=m(n,["error"]);h!=null&&y(e,["error"],h);const T=m(n,["description"]);T!=null&&y(e,["description"],T);const E=m(n,["baseModel"]);E!=null&&y(e,["baseModel"],E);const b=m(n,["tunedModel"]);b!=null&&y(e,["tunedModel"],b);const w=m(n,["preTunedModel"]);w!=null&&y(e,["preTunedModel"],w);const P=m(n,["supervisedTuningSpec"]);P!=null&&y(e,["supervisedTuningSpec"],P);const U=m(n,["tuningDataStats"]);U!=null&&y(e,["tuningDataStats"],U);const H=m(n,["encryptionSpec"]);H!=null&&y(e,["encryptionSpec"],H);const ne=m(n,["partnerModelTuningSpec"]);ne!=null&&y(e,["partnerModelTuningSpec"],ne);const F=m(n,["customBaseModel"]);F!=null&&y(e,["customBaseModel"],F);const O=m(n,["experiment"]);O!=null&&y(e,["experiment"],O);const z=m(n,["labels"]);z!=null&&y(e,["labels"],z);const Z=m(n,["outputUri"]);Z!=null&&y(e,["outputUri"],Z);const W=m(n,["pipelineJob"]);W!=null&&y(e,["pipelineJob"],W);const R=m(n,["serviceAccount"]);R!=null&&y(e,["serviceAccount"],R);const C=m(n,["tunedModelDisplayName"]);C!=null&&y(e,["tunedModelDisplayName"],C);const N=m(n,["veoTuningSpec"]);return N!=null&&y(e,["veoTuningSpec"],N),e}function _M(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&y(e,["name"],i);const o=m(n,["metadata"]);o!=null&&y(e,["metadata"],o);const l=m(n,["done"]);l!=null&&y(e,["done"],l);const u=m(n,["error"]);return u!=null&&y(e,["error"],u),e}function TM(n,e){const t={},i=m(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const o=m(n,["vertexDatasetResource"]);return e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EM extends Ao{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Cu(yo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:o});return l.baseModel=void 0,await this.tuneInternal(l)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),l=await this.tuneMldevInternal(o);let u="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?u=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(u=l.name.split("/operations/")[0]),{name:u,state:Gm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=uM(e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Wm(T))}else{const h=lM(e);return f=Se("{name}",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>fx(T))}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const h=hM(e);return f=Se("tuningJobs",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=pM(T),b=new G_;return Object.assign(b,E),b})}else{const h=fM(e);return f=Se("tunedModels",h._url),g=h._query,delete h._url,delete h._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=mM(T),b=new G_;return Object.assign(b,E),b})}}async cancel(e){var t,i,o,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=sM(e);u=Se("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=nM(e);u=Se("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=aM(e);return l=Se("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>Wm(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=oM(e);return l=Se("tunedModels",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(h=>{const T=h;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>_M(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xM{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const bM=1024*1024*8,AM=3,SM=1e3,CM=2,wm="x-goog-upload-status";async function wM(n,e,t){var i,o,l;let u=0,f=0,g=new Ym(new Response),h="upload";for(u=n.size;f<u;){const E=Math.min(bM,u-f),b=n.slice(f,f+E);f+E>=u&&(h+=", finalize");let w=0,P=SM;for(;w<AM&&(g=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(f),"Content-Length":String(E)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[wm]));)w++,await NM(P),P=P*CM;if(f+=E,((o=g==null?void 0:g.headers)===null||o===void 0?void 0:o[wm])!=="active")break;if(u<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(g==null?void 0:g.json());if(((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[wm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function IM(n){return{size:n.size,type:n.type}}function NM(n){return new Promise(e=>setTimeout(e,n))}class RM{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await wM(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await IM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MM{create(e,t,i){return new DM(e,t,i)}}class DM{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dT="x-goog-api-key";class PM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(dT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(dT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kM="gl-node/";class VM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=tw(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new PM(this.apiKey);this.apiClient=new _1({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:kM+"web",uploader:new RM,downloader:new xM}),this.models=new j1(this.apiClient),this.live=new D1(this.apiClient,o,new MM),this.batches=new vI(this.apiClient),this.chats=new QI(this.models,this.apiClient),this.caches=new $I(this.apiClient),this.files=new oN(this.apiClient),this.operations=new F1(this.apiClient),this.authTokens=new tM(this.apiClient),this.tunings=new EM(this.apiClient)}}const hx={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},Lt={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:Lt.app.environment,firebaseApiKey:Lt.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:Lt.firebase.authDomain||"❌ مفقود",firebaseProjectId:Lt.firebase.projectId||"❌ مفقود",firebaseStorageBucket:Lt.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:Lt.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:Lt.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(hx).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(hx).filter(n=>n.startsWith("VITE_")));const Ra=()=>{const n=[];return Lt.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),Lt.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),Lt.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),Lt.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),Lt.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),Lt.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!Lt.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=Ra();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Md;const LM="gemini-2.5-flash",mx=()=>{if(Md)return;const n=Ra();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Md=new VM({apiKey:Lt.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},Ja={FINANCIAL_ANALYST:`You are an expert financial analyst assistant, "المحلل الذكي". You have full access to the user's financial data for a specific period. Your purpose is to provide detailed, insightful analysis and answer complex questions in Arabic based ONLY on the data provided for that period.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- Analyze the user's provided financial state (transactions, card details, bank balance, investments, installments) for the specified period to answer their query.
- Be thorough. Connect different parts of their financial data to give holistic answers.
- DO NOT just state data, INTERPRET it. Provide insights, identify trends, and offer observations.
- Be friendly, professional, and act as a true financial advisor.`,INVESTMENT_COACH:`You are an educational investment coach named "المستشار الذكي". Your primary role is to educate the user about investment concepts and strategies, particularly within the context of the Saudi stock market (Tadawul).
- You MUST NOT give direct financial advice. Do not recommend buying or selling specific stocks (e.g., "Buy Aramco").
- When asked for a recommendation, you MUST politely decline and instead explain HOW the user can research and make their own informed decisions.
- Your tone should be encouraging, educational, and responsible.
- Keep your answers clear, concise, and in Arabic.`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`},Ka=async(n,e,t=!1)=>{if(!Md)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Md.models.generateContent({model:LM,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(i){console.error("Gemini API Error:",i);let o="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw i instanceof Error&&"message"in i&&i.message.includes("403")&&(o="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(o)}},px=(n,e)=>Ka(Ja.FINANCIAL_ANALYST,`User Query: "${n}"

Financial Data: ${JSON.stringify(e)}`),gx=(n,e,t,i)=>{const o=Object.keys(t),l=Object.keys(i);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...o].map(g=>`'${g}'`).join(", ")}].
`;Object.values(i).forEach(g=>{const h=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);h.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${h.join("', '")}', use '${g.id}'.
`)}),Object.values(t).forEach(g=>{const h=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);h.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${h.join("', '")}', use '${g.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const f=Ja.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return Ka(f,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},yx=n=>Ka(Ja.INVESTMENT_COACH,n),Zm=n=>Ka(Ja.ICON_SUGGESTER,`Category: ${n}`),vx=(n,e,t)=>Ka(Ja.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),_x=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,i=await Ka(Ja.EXCHANGE_RATE,t,!0);try{const o=JSON.parse(i);return{rate:parseFloat(o.rate),fromCurrency:o.fromCurrency,toCurrency:o.toCurrency,lastUpdated:o.lastUpdated}}catch(o){throw console.error("Error parsing exchange rate:",o),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},UM=Object.freeze(Object.defineProperty({__proto__:null,analyzeFinancialData:px,analyzePastedText:gx,generateBudgetPlan:vx,generateInvestmentAdvice:yx,getExchangeRate:_x,initializeAi:mx,suggestCategoryIcon:Zm},Symbol.toStringTag,{value:"Module"})),OM="modulepreload",jM=function(n){return"/fd/"+n},fT={},vi=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(T=>Promise.resolve(T).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),g=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=u(t.map(h=>{if(h=jM(h),h in fT)return;fT[h]=!0;const T=h.endsWith(".css"),E=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${E}`))return;const b=document.createElement("link");if(b.rel=T?"stylesheet":OM,T||(b.as="script"),b.crossOrigin="",b.href=h,g&&b.setAttribute("nonce",g),document.head.appendChild(b),T)return new Promise((w,P)=>{b.addEventListener("load",w),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return o.then(u=>{for(const f of u||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})},FM=()=>{};var hT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},qM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[i++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],u=n[t++],f=n[t++],g=((o&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(l&63)<<6|u&63)}}return e.join("")},Ex={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const l=n[o],u=o+1<n.length,f=u?n[o+1]:0,g=o+2<n.length,h=g?n[o+2]:0,T=l>>2,E=(l&3)<<4|f>>4;let b=(f&15)<<2|h>>6,w=h&63;g||(w=64,u||(b=64)),i.push(t[T],t[E],t[b],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Tx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const h=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||f==null||h==null||E==null)throw new BM;const b=l<<2|f>>4;if(i.push(b),h!==64){const w=f<<4&240|h>>2;if(i.push(w),E!==64){const P=h<<6&192|E;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class BM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zM=function(n){const e=Tx(n);return Ex.encodeByteArray(e,!0)},Dd=function(n){return zM(n).replace(/\./g,"")},xx=function(n){try{return Ex.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=()=>HM().__FIREBASE_DEFAULTS__,YM=()=>{if(typeof process>"u"||typeof hT>"u")return;const n=hT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$M=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&xx(n[1]);return e&&JSON.parse(e)},nf=()=>{try{return FM()||GM()||YM()||$M()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bx=n=>{var e,t;return(t=(e=nf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},JM=n=>{const e=bx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ax=()=>{var n;return(n=nf())==null?void 0:n.config},Sx=n=>{var e;return(e=nf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Cx(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Dd(JSON.stringify(t)),Dd(JSON.stringify(u)),""].join(".")}const hu={};function XM(){const n={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?n.emulator.push(e):n.prod.push(e);return n}function WM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let mT=!1;function wx(n,e){if(typeof window>"u"||typeof document>"u"||!Qa(window.location.host)||hu[n]===e||hu[n]||mT)return;hu[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=XM().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function f(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function h(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{mT=!0,u()},b}function T(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function E(){const b=WM(i),w=t("text"),P=document.getElementById(w)||document.createElement("span"),U=t("learnmore"),H=document.getElementById(U)||document.createElement("a"),ne=t("preprendIcon"),F=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const O=b.element;f(O),T(H,U);const z=h();g(F,ne),O.append(F,P,H,z),document.body.appendChild(O)}l?(P.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function eD(){var e;const n=(e=nf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nD(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function sD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iD(){const n=gn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rD(){return!eD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oD(){try{return typeof indexedDB=="object"}catch{return!1}}function aD(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD="FirebaseError";class Li extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=lD,Object.setPrototypeOf(this,Li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],u=l?uD(l,i):"Error",f=`${this.serviceName}: ${u} (${o}).`;return new Li(o,f,i)}}function uD(n,e){return n.replace(cD,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const cD=/\{\$([^}]+)}/g;function dD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const l=n[o],u=e[o];if(pT(l)&&pT(u)){if(!vo(l,u))return!1}else if(l!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function pT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function au(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,l]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function lu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function fD(n,e){const t=new hD(n,e);return t.subscribe.bind(t)}class hD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");mD(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Im),o.error===void 0&&(o.error=Im),o.complete===void 0&&(o.complete=Im);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Im(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n){return n&&n._delegate?n._delegate:n}class _o{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new KM;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yD(e))try{this.getOrInitializeService({instanceIdentifier:mo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});i.resolve(l)}catch{}}}}clearInstance(e=mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mo){return this.instances.has(e)}getOptions(e=mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const l=this.instances.get(i);return l&&e(l,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:gD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=mo){return this.component?this.component.multipleInstances?e:mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gD(n){return n===mo?void 0:n}function yD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const _D={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},TD=Ke.INFO,ED={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},xD=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=ED[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kp{constructor(e){this.name=e,this._logLevel=TD,this._logHandler=xD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_D[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const bD=(n,e)=>e.some(t=>n instanceof t);let gT,yT;function AD(){return gT||(gT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SD(){return yT||(yT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ix=new WeakMap,ep=new WeakMap,Nx=new WeakMap,Nm=new WeakMap,Vp=new WeakMap;function CD(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(Er(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&Ix.set(t,n)}).catch(()=>{}),Vp.set(e,n),e}function wD(n){if(ep.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});ep.set(n,e)}let tp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ep.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Nx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Er(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ID(n){tp=n(tp)}function ND(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Rm(this),e,...t);return Nx.set(i,e.sort?e.sort():[e]),Er(i)}:SD().includes(n)?function(...e){return n.apply(Rm(this),e),Er(Ix.get(this))}:function(...e){return Er(n.apply(Rm(this),e))}}function RD(n){return typeof n=="function"?ND(n):(n instanceof IDBTransaction&&wD(n),bD(n,AD())?new Proxy(n,tp):n)}function Er(n){if(n instanceof IDBRequest)return CD(n);if(Nm.has(n))return Nm.get(n);const e=RD(n);return e!==n&&(Nm.set(n,e),Vp.set(e,n)),e}const Rm=n=>Vp.get(n);function MD(n,e,{blocked:t,upgrade:i,blocking:o,terminated:l}={}){const u=indexedDB.open(n,e),f=Er(u);return i&&u.addEventListener("upgradeneeded",g=>{i(Er(u.result),g.oldVersion,g.newVersion,Er(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),f.then(g=>{l&&g.addEventListener("close",()=>l()),o&&g.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),f}const DD=["get","getKey","getAll","getAllKeys","count"],PD=["put","add","delete","clear"],Mm=new Map;function vT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mm.get(e))return Mm.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=PD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||DD.includes(t)))return;const l=async function(u,...f){const g=this.transaction(u,o?"readwrite":"readonly");let h=g.store;return i&&(h=h.index(f.shift())),(await Promise.all([h[t](...f),o&&g.done]))[0]};return Mm.set(e,l),l}ID(n=>({...n,get:(e,t,i)=>vT(e,t)||n.get(e,t,i),has:(e,t)=>!!vT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VD(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function VD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",_T="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new kp("@firebase/app"),LD="@firebase/app-compat",UD="@firebase/analytics-compat",OD="@firebase/analytics",jD="@firebase/app-check-compat",FD="@firebase/app-check",qD="@firebase/auth",BD="@firebase/auth-compat",zD="@firebase/database",HD="@firebase/data-connect",GD="@firebase/database-compat",YD="@firebase/functions",$D="@firebase/functions-compat",JD="@firebase/installations",KD="@firebase/installations-compat",QD="@firebase/messaging",XD="@firebase/messaging-compat",WD="@firebase/performance",ZD="@firebase/performance-compat",e2="@firebase/remote-config",t2="@firebase/remote-config-compat",n2="@firebase/storage",s2="@firebase/storage-compat",i2="@firebase/firestore",r2="@firebase/ai",o2="@firebase/firestore-compat",a2="firebase",l2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",u2={[np]:"fire-core",[LD]:"fire-core-compat",[OD]:"fire-analytics",[UD]:"fire-analytics-compat",[FD]:"fire-app-check",[jD]:"fire-app-check-compat",[qD]:"fire-auth",[BD]:"fire-auth-compat",[zD]:"fire-rtdb",[HD]:"fire-data-connect",[GD]:"fire-rtdb-compat",[YD]:"fire-fn",[$D]:"fire-fn-compat",[JD]:"fire-iid",[KD]:"fire-iid-compat",[QD]:"fire-fcm",[XD]:"fire-fcm-compat",[WD]:"fire-perf",[ZD]:"fire-perf-compat",[e2]:"fire-rc",[t2]:"fire-rc-compat",[n2]:"fire-gcs",[s2]:"fire-gcs-compat",[i2]:"fire-fst",[o2]:"fire-fst-compat",[r2]:"fire-vertex","fire-js":"fire-js",[a2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=new Map,c2=new Map,ip=new Map;function TT(n,e){try{n.container.addComponent(e)}catch(t){Ri.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function La(n){const e=n.name;if(ip.has(e))return Ri.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,n);for(const t of Pd.values())TT(t,n);for(const t of c2.values())TT(t,n);return!0}function Lp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function es(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new wu("app","Firebase",d2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new _o("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=l2;function Rx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:sp,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw xr.create("bad-app-name",{appName:String(o)});if(t||(t=Ax()),!t)throw xr.create("no-options");const l=Pd.get(o);if(l){if(vo(t,l.options)&&vo(i,l.config))return l;throw xr.create("duplicate-app",{appName:o})}const u=new vD(o);for(const g of ip.values())u.addComponent(g);const f=new f2(t,i,u);return Pd.set(o,f),f}function Mx(n=sp){const e=Pd.get(n);if(!e&&n===sp&&Ax())return Rx();if(!e)throw xr.create("no-app",{appName:n});return e}function br(n,e,t){let i=u2[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ri.warn(u.join(" "));return}La(new _o(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2="firebase-heartbeat-database",m2=1,Tu="firebase-heartbeat-store";let Dm=null;function Dx(){return Dm||(Dm=MD(h2,m2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Tu)}catch(t){console.warn(t)}}}}).catch(n=>{throw xr.create("idb-open",{originalErrorMessage:n.message})})),Dm}async function p2(n){try{const t=(await Dx()).transaction(Tu),i=await t.objectStore(Tu).get(Px(n));return await t.done,i}catch(e){if(e instanceof Li)Ri.warn(e.message);else{const t=xr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ri.warn(t.message)}}}async function ET(n,e){try{const i=(await Dx()).transaction(Tu,"readwrite");await i.objectStore(Tu).put(e,Px(n)),await i.done}catch(t){if(t instanceof Li)Ri.warn(t.message);else{const i=xr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ri.warn(i.message)}}}function Px(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=1024,y2=30;class v2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new T2(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=xT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>y2){const u=E2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ri.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=xT(),{heartbeatsToSend:i,unsentEntries:o}=_2(this._heartbeatsCache.heartbeats),l=Dd(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ri.warn(t),""}}}function xT(){return new Date().toISOString().substring(0,10)}function _2(n,e=g2){const t=[];let i=n.slice();for(const o of n){const l=t.find(u=>u.agent===o.agent);if(l){if(l.dates.push(o.date),bT(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),bT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class T2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oD()?aD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await p2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ET(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ET(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function bT(n){return Dd(JSON.stringify({version:2,heartbeats:n})).length}function E2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(n){La(new _o("platform-logger",e=>new kD(e),"PRIVATE")),La(new _o("heartbeat",e=>new v2(e),"PRIVATE")),br(np,_T,n),br(np,_T,"esm2020"),br("fire-js","")}x2("");var b2="firebase",A2="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */br(b2,A2,"app");var AT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ar,kx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,C){function N(){}N.prototype=C.prototype,R.F=C.prototype,R.prototype=new N,R.prototype.constructor=R,R.D=function(k,V,j){for(var D=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)D[Le-2]=arguments[Le];return C.prototype[V].apply(k,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(R,C,N){N||(N=0);const k=Array(16);if(typeof C=="string")for(var V=0;V<16;++V)k[V]=C.charCodeAt(N++)|C.charCodeAt(N++)<<8|C.charCodeAt(N++)<<16|C.charCodeAt(N++)<<24;else for(V=0;V<16;++V)k[V]=C[N++]|C[N++]<<8|C[N++]<<16|C[N++]<<24;C=R.g[0],N=R.g[1],V=R.g[2];let j=R.g[3],D;D=C+(j^N&(V^j))+k[0]+3614090360&4294967295,C=N+(D<<7&4294967295|D>>>25),D=j+(V^C&(N^V))+k[1]+3905402710&4294967295,j=C+(D<<12&4294967295|D>>>20),D=V+(N^j&(C^N))+k[2]+606105819&4294967295,V=j+(D<<17&4294967295|D>>>15),D=N+(C^V&(j^C))+k[3]+3250441966&4294967295,N=V+(D<<22&4294967295|D>>>10),D=C+(j^N&(V^j))+k[4]+4118548399&4294967295,C=N+(D<<7&4294967295|D>>>25),D=j+(V^C&(N^V))+k[5]+1200080426&4294967295,j=C+(D<<12&4294967295|D>>>20),D=V+(N^j&(C^N))+k[6]+2821735955&4294967295,V=j+(D<<17&4294967295|D>>>15),D=N+(C^V&(j^C))+k[7]+4249261313&4294967295,N=V+(D<<22&4294967295|D>>>10),D=C+(j^N&(V^j))+k[8]+1770035416&4294967295,C=N+(D<<7&4294967295|D>>>25),D=j+(V^C&(N^V))+k[9]+2336552879&4294967295,j=C+(D<<12&4294967295|D>>>20),D=V+(N^j&(C^N))+k[10]+4294925233&4294967295,V=j+(D<<17&4294967295|D>>>15),D=N+(C^V&(j^C))+k[11]+2304563134&4294967295,N=V+(D<<22&4294967295|D>>>10),D=C+(j^N&(V^j))+k[12]+1804603682&4294967295,C=N+(D<<7&4294967295|D>>>25),D=j+(V^C&(N^V))+k[13]+4254626195&4294967295,j=C+(D<<12&4294967295|D>>>20),D=V+(N^j&(C^N))+k[14]+2792965006&4294967295,V=j+(D<<17&4294967295|D>>>15),D=N+(C^V&(j^C))+k[15]+1236535329&4294967295,N=V+(D<<22&4294967295|D>>>10),D=C+(V^j&(N^V))+k[1]+4129170786&4294967295,C=N+(D<<5&4294967295|D>>>27),D=j+(N^V&(C^N))+k[6]+3225465664&4294967295,j=C+(D<<9&4294967295|D>>>23),D=V+(C^N&(j^C))+k[11]+643717713&4294967295,V=j+(D<<14&4294967295|D>>>18),D=N+(j^C&(V^j))+k[0]+3921069994&4294967295,N=V+(D<<20&4294967295|D>>>12),D=C+(V^j&(N^V))+k[5]+3593408605&4294967295,C=N+(D<<5&4294967295|D>>>27),D=j+(N^V&(C^N))+k[10]+38016083&4294967295,j=C+(D<<9&4294967295|D>>>23),D=V+(C^N&(j^C))+k[15]+3634488961&4294967295,V=j+(D<<14&4294967295|D>>>18),D=N+(j^C&(V^j))+k[4]+3889429448&4294967295,N=V+(D<<20&4294967295|D>>>12),D=C+(V^j&(N^V))+k[9]+568446438&4294967295,C=N+(D<<5&4294967295|D>>>27),D=j+(N^V&(C^N))+k[14]+3275163606&4294967295,j=C+(D<<9&4294967295|D>>>23),D=V+(C^N&(j^C))+k[3]+4107603335&4294967295,V=j+(D<<14&4294967295|D>>>18),D=N+(j^C&(V^j))+k[8]+1163531501&4294967295,N=V+(D<<20&4294967295|D>>>12),D=C+(V^j&(N^V))+k[13]+2850285829&4294967295,C=N+(D<<5&4294967295|D>>>27),D=j+(N^V&(C^N))+k[2]+4243563512&4294967295,j=C+(D<<9&4294967295|D>>>23),D=V+(C^N&(j^C))+k[7]+1735328473&4294967295,V=j+(D<<14&4294967295|D>>>18),D=N+(j^C&(V^j))+k[12]+2368359562&4294967295,N=V+(D<<20&4294967295|D>>>12),D=C+(N^V^j)+k[5]+4294588738&4294967295,C=N+(D<<4&4294967295|D>>>28),D=j+(C^N^V)+k[8]+2272392833&4294967295,j=C+(D<<11&4294967295|D>>>21),D=V+(j^C^N)+k[11]+1839030562&4294967295,V=j+(D<<16&4294967295|D>>>16),D=N+(V^j^C)+k[14]+4259657740&4294967295,N=V+(D<<23&4294967295|D>>>9),D=C+(N^V^j)+k[1]+2763975236&4294967295,C=N+(D<<4&4294967295|D>>>28),D=j+(C^N^V)+k[4]+1272893353&4294967295,j=C+(D<<11&4294967295|D>>>21),D=V+(j^C^N)+k[7]+4139469664&4294967295,V=j+(D<<16&4294967295|D>>>16),D=N+(V^j^C)+k[10]+3200236656&4294967295,N=V+(D<<23&4294967295|D>>>9),D=C+(N^V^j)+k[13]+681279174&4294967295,C=N+(D<<4&4294967295|D>>>28),D=j+(C^N^V)+k[0]+3936430074&4294967295,j=C+(D<<11&4294967295|D>>>21),D=V+(j^C^N)+k[3]+3572445317&4294967295,V=j+(D<<16&4294967295|D>>>16),D=N+(V^j^C)+k[6]+76029189&4294967295,N=V+(D<<23&4294967295|D>>>9),D=C+(N^V^j)+k[9]+3654602809&4294967295,C=N+(D<<4&4294967295|D>>>28),D=j+(C^N^V)+k[12]+3873151461&4294967295,j=C+(D<<11&4294967295|D>>>21),D=V+(j^C^N)+k[15]+530742520&4294967295,V=j+(D<<16&4294967295|D>>>16),D=N+(V^j^C)+k[2]+3299628645&4294967295,N=V+(D<<23&4294967295|D>>>9),D=C+(V^(N|~j))+k[0]+4096336452&4294967295,C=N+(D<<6&4294967295|D>>>26),D=j+(N^(C|~V))+k[7]+1126891415&4294967295,j=C+(D<<10&4294967295|D>>>22),D=V+(C^(j|~N))+k[14]+2878612391&4294967295,V=j+(D<<15&4294967295|D>>>17),D=N+(j^(V|~C))+k[5]+4237533241&4294967295,N=V+(D<<21&4294967295|D>>>11),D=C+(V^(N|~j))+k[12]+1700485571&4294967295,C=N+(D<<6&4294967295|D>>>26),D=j+(N^(C|~V))+k[3]+2399980690&4294967295,j=C+(D<<10&4294967295|D>>>22),D=V+(C^(j|~N))+k[10]+4293915773&4294967295,V=j+(D<<15&4294967295|D>>>17),D=N+(j^(V|~C))+k[1]+2240044497&4294967295,N=V+(D<<21&4294967295|D>>>11),D=C+(V^(N|~j))+k[8]+1873313359&4294967295,C=N+(D<<6&4294967295|D>>>26),D=j+(N^(C|~V))+k[15]+4264355552&4294967295,j=C+(D<<10&4294967295|D>>>22),D=V+(C^(j|~N))+k[6]+2734768916&4294967295,V=j+(D<<15&4294967295|D>>>17),D=N+(j^(V|~C))+k[13]+1309151649&4294967295,N=V+(D<<21&4294967295|D>>>11),D=C+(V^(N|~j))+k[4]+4149444226&4294967295,C=N+(D<<6&4294967295|D>>>26),D=j+(N^(C|~V))+k[11]+3174756917&4294967295,j=C+(D<<10&4294967295|D>>>22),D=V+(C^(j|~N))+k[2]+718787259&4294967295,V=j+(D<<15&4294967295|D>>>17),D=N+(j^(V|~C))+k[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(V+(D<<21&4294967295|D>>>11))&4294967295,R.g[2]=R.g[2]+V&4294967295,R.g[3]=R.g[3]+j&4294967295}i.prototype.v=function(R,C){C===void 0&&(C=R.length);const N=C-this.blockSize,k=this.C;let V=this.h,j=0;for(;j<C;){if(V==0)for(;j<=N;)o(this,R,j),j+=this.blockSize;if(typeof R=="string"){for(;j<C;)if(k[V++]=R.charCodeAt(j++),V==this.blockSize){o(this,k),V=0;break}}else for(;j<C;)if(k[V++]=R[j++],V==this.blockSize){o(this,k),V=0;break}}this.h=V,this.o+=C},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var N=R.length-8;N<R.length;++N)R[N]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,N=0;N<4;++N)for(let k=0;k<32;k+=8)R[C++]=this.g[N]>>>k&255;return R};function l(R,C){var N=f;return Object.prototype.hasOwnProperty.call(N,R)?N[R]:N[R]=C(R)}function u(R,C){this.h=C;const N=[];let k=!0;for(let V=R.length-1;V>=0;V--){const j=R[V]|0;k&&j==C||(N[V]=j,k=!1)}this.g=N}var f={};function g(R){return-128<=R&&R<128?l(R,function(C){return new u([C|0],C<0?-1:0)}):new u([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return E;if(R<0)return H(h(-R));const C=[];let N=1;for(let k=0;R>=N;k++)C[k]=R/N|0,N*=4294967296;return new u(C,0)}function T(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return H(T(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=h(Math.pow(C,8));let k=E;for(let j=0;j<R.length;j+=8){var V=Math.min(8,R.length-j);const D=parseInt(R.substring(j,j+V),C);V<8?(V=h(Math.pow(C,V)),k=k.j(V).add(h(D))):(k=k.j(N),k=k.add(h(D)))}return k}var E=g(0),b=g(1),w=g(16777216);n=u.prototype,n.m=function(){if(U(this))return-H(this).m();let R=0,C=1;for(let N=0;N<this.g.length;N++){const k=this.i(N);R+=(k>=0?k:4294967296+k)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P(this))return"0";if(U(this))return"-"+H(this).toString(R);const C=h(Math.pow(R,6));var N=this;let k="";for(;;){const V=z(N,C).g;N=ne(N,V.j(C));let j=((N.g.length>0?N.g[0]:N.h)>>>0).toString(R);if(N=V,P(N))return j+k;for(;j.length<6;)j="0"+j;k=j+k}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function P(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function U(R){return R.h==-1}n.l=function(R){return R=ne(this,R),U(R)?-1:P(R)?0:1};function H(R){const C=R.g.length,N=[];for(let k=0;k<C;k++)N[k]=~R.g[k];return new u(N,~R.h).add(b)}n.abs=function(){return U(this)?H(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),N=[];let k=0;for(let V=0;V<=C;V++){let j=k+(this.i(V)&65535)+(R.i(V)&65535),D=(j>>>16)+(this.i(V)>>>16)+(R.i(V)>>>16);k=D>>>16,j&=65535,D&=65535,N[V]=D<<16|j}return new u(N,N[N.length-1]&-2147483648?-1:0)};function ne(R,C){return R.add(H(C))}n.j=function(R){if(P(this)||P(R))return E;if(U(this))return U(R)?H(this).j(H(R)):H(H(this).j(R));if(U(R))return H(this.j(H(R)));if(this.l(w)<0&&R.l(w)<0)return h(this.m()*R.m());const C=this.g.length+R.g.length,N=[];for(var k=0;k<2*C;k++)N[k]=0;for(k=0;k<this.g.length;k++)for(let V=0;V<R.g.length;V++){const j=this.i(k)>>>16,D=this.i(k)&65535,Le=R.i(V)>>>16,he=R.i(V)&65535;N[2*k+2*V]+=D*he,F(N,2*k+2*V),N[2*k+2*V+1]+=j*he,F(N,2*k+2*V+1),N[2*k+2*V+1]+=D*Le,F(N,2*k+2*V+1),N[2*k+2*V+2]+=j*Le,F(N,2*k+2*V+2)}for(R=0;R<C;R++)N[R]=N[2*R+1]<<16|N[2*R];for(R=C;R<2*C;R++)N[R]=0;return new u(N,0)};function F(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function O(R,C){this.g=R,this.h=C}function z(R,C){if(P(C))throw Error("division by zero");if(P(R))return new O(E,E);if(U(R))return C=z(H(R),C),new O(H(C.g),H(C.h));if(U(C))return C=z(R,H(C)),new O(H(C.g),C.h);if(R.g.length>30){if(U(R)||U(C))throw Error("slowDivide_ only works with positive integers.");for(var N=b,k=C;k.l(R)<=0;)N=Z(N),k=Z(k);var V=W(N,1),j=W(k,1);for(k=W(k,2),N=W(N,2);!P(k);){var D=j.add(k);D.l(R)<=0&&(V=V.add(N),j=D),k=W(k,1),N=W(N,1)}return C=ne(R,V.j(C)),new O(V,C)}for(V=E;R.l(C)>=0;){for(N=Math.max(1,Math.floor(R.m()/C.m())),k=Math.ceil(Math.log(N)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),j=h(N),D=j.j(C);U(D)||D.l(R)>0;)N-=k,j=h(N),D=j.j(C);P(j)&&(j=b),V=V.add(j),R=ne(R,D)}return new O(V,R)}n.B=function(R){return z(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),N=[];for(let k=0;k<C;k++)N[k]=this.i(k)&R.i(k);return new u(N,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),N=[];for(let k=0;k<C;k++)N[k]=this.i(k)|R.i(k);return new u(N,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),N=[];for(let k=0;k<C;k++)N[k]=this.i(k)^R.i(k);return new u(N,this.h^R.h)};function Z(R){const C=R.g.length+1,N=[];for(let k=0;k<C;k++)N[k]=R.i(k)<<1|R.i(k-1)>>>31;return new u(N,R.h)}function W(R,C){const N=C>>5;C%=32;const k=R.g.length-N,V=[];for(let j=0;j<k;j++)V[j]=C>0?R.i(j+N)>>>C|R.i(j+N+1)<<32-C:R.i(j+N);return new u(V,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,kx=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=h,u.fromString=T,Ar=u}).apply(typeof AT<"u"?AT:typeof self<"u"?self:typeof window<"u"?window:{});var ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vx,uu,Lx,_d,rp,Ux,Ox,jx;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof ud=="object"&&ud];for(var x=0;x<p.length;++x){var S=p[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function o(p,x){if(x)e:{var S=i;p=p.split(".");for(var M=0;M<p.length-1;M++){var J=p[M];if(!(J in S))break e;S=S[J]}p=p[p.length-1],M=S[p],x=x(M),x!=M&&x!=null&&e(S,p,{configurable:!0,writable:!0,value:x})}}o("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(p){return p||function(x){var S=[],M;for(M in x)Object.prototype.hasOwnProperty.call(x,M)&&S.push([M,x[M]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function f(p){var x=typeof p;return x=="object"&&p!=null||x=="function"}function g(p,x,S){return p.call.apply(p.bind,arguments)}function h(p,x,S){return h=g,h.apply(null,arguments)}function T(p,x){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function E(p,x){function S(){}S.prototype=x.prototype,p.Z=x.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(M,J,ee){for(var ge=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)ge[Fe-2]=arguments[Fe];return x.prototype[J].apply(M,ge)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function w(p){const x=p.length;if(x>0){const S=Array(x);for(let M=0;M<x;M++)S[M]=p[M];return S}return[]}function P(p,x){for(let M=1;M<arguments.length;M++){const J=arguments[M];var S=typeof J;if(S=S!="object"?S:J?Array.isArray(J)?"array":S:"null",S=="array"||S=="object"&&typeof J.length=="number"){S=p.length||0;const ee=J.length||0;p.length=S+ee;for(let ge=0;ge<ee;ge++)p[S+ge]=J[ge]}else p.push(J)}}class U{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function H(p){u.setTimeout(()=>{throw p},0)}function ne(){var p=R;let x=null;return p.g&&(x=p.g,p.g=p.g.next,p.g||(p.h=null),x.next=null),x}class F{constructor(){this.h=this.g=null}add(x,S){const M=O.get();M.set(x,S),this.h?this.h.next=M:this.g=M,this.h=M}}var O=new U(()=>new z,p=>p.reset());class z{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,W=!1,R=new F,C=()=>{const p=Promise.resolve(void 0);Z=()=>{p.then(N)}};function N(){for(var p;p=ne();){try{p.h.call(p.g)}catch(S){H(S)}var x=O;x.j(p),x.h<100&&(x.h++,p.next=x.g,x.g=p)}W=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(p,x){this.type=p,this.g=this.target=x,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,x=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};u.addEventListener("test",S,x),u.removeEventListener("test",S,x)}catch{}return p})();function D(p){return/^[\s\xa0]*$/.test(p)}function Le(p,x){V.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,x)}E(Le,V),Le.prototype.init=function(p,x){const S=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=x,x=p.relatedTarget,x||(S=="mouseover"?x=p.fromElement:S=="mouseout"&&(x=p.toElement)),this.relatedTarget=x,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var he="closure_listenable_"+(Math.random()*1e6|0),$=0;function de(p,x,S,M,J){this.listener=p,this.proxy=null,this.src=x,this.type=S,this.capture=!!M,this.ha=J,this.key=++$,this.da=this.fa=!1}function ve(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Be(p,x,S){for(const M in p)x.call(S,p[M],M,p)}function Ze(p,x){for(const S in p)x.call(void 0,p[S],S,p)}function q(p){const x={};for(const S in p)x[S]=p[S];return x}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(p,x){let S,M;for(let J=1;J<arguments.length;J++){M=arguments[J];for(S in M)p[S]=M[S];for(let ee=0;ee<re.length;ee++)S=re[ee],Object.prototype.hasOwnProperty.call(M,S)&&(p[S]=M[S])}}function _e(p){this.src=p,this.g={},this.h=0}_e.prototype.add=function(p,x,S,M,J){const ee=p.toString();p=this.g[ee],p||(p=this.g[ee]=[],this.h++);const ge=ce(p,x,M,J);return ge>-1?(x=p[ge],S||(x.fa=!1)):(x=new de(x,this.src,ee,!!M,J),x.fa=S,p.push(x)),x};function ie(p,x){const S=x.type;if(S in p.g){var M=p.g[S],J=Array.prototype.indexOf.call(M,x,void 0),ee;(ee=J>=0)&&Array.prototype.splice.call(M,J,1),ee&&(ve(x),p.g[S].length==0&&(delete p.g[S],p.h--))}}function ce(p,x,S,M){for(let J=0;J<p.length;++J){const ee=p[J];if(!ee.da&&ee.listener==x&&ee.capture==!!S&&ee.ha==M)return J}return-1}var be="closure_lm_"+(Math.random()*1e6|0),et={};function nt(p,x,S,M,J){if(Array.isArray(x)){for(let ee=0;ee<x.length;ee++)nt(p,x[ee],S,M,J);return null}return S=Ur(S),p&&p[he]?p.J(x,S,f(M)?!!M.capture:!1,J):Tn(p,x,S,!1,M,J)}function Tn(p,x,S,M,J,ee){if(!x)throw Error("Invalid event type");const ge=f(J)?!!J.capture:!!J;let Fe=Ks(p);if(Fe||(p[be]=Fe=new _e(p)),S=Fe.add(x,S,M,ge,ee),S.proxy)return S;if(M=St(),S.proxy=M,M.src=p,M.listener=S,p.addEventListener)j||(J=ge),J===void 0&&(J=!1),p.addEventListener(x.toString(),M,J);else if(p.attachEvent)p.attachEvent(Fn(x.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function St(){function p(S){return x.call(p.src,p.listener,S)}const x=Vr;return p}function Es(p,x,S,M,J){if(Array.isArray(x))for(var ee=0;ee<x.length;ee++)Es(p,x[ee],S,M,J);else M=f(M)?!!M.capture:!!M,S=Ur(S),p&&p[he]?(p=p.i,ee=String(x).toString(),ee in p.g&&(x=p.g[ee],S=ce(x,S,M,J),S>-1&&(ve(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete p.g[ee],p.h--)))):p&&(p=Ks(p))&&(x=p.g[x.toString()],p=-1,x&&(p=ce(x,S,M,J)),(S=p>-1?x[p]:null)&&Oi(S))}function Oi(p){if(typeof p!="number"&&p&&!p.da){var x=p.src;if(x&&x[he])ie(x.i,p);else{var S=p.type,M=p.proxy;x.removeEventListener?x.removeEventListener(S,M,p.capture):x.detachEvent?x.detachEvent(Fn(S),M):x.addListener&&x.removeListener&&x.removeListener(M),(S=Ks(x))?(ie(S,p),S.h==0&&(S.src=null,x[be]=null)):ve(p)}}}function Fn(p){return p in et?et[p]:et[p]="on"+p}function Vr(p,x){if(p.da)p=!0;else{x=new Le(x,this);const S=p.listener,M=p.ha||p.src;p.fa&&Oi(p),p=S.call(M,x)}return p}function Ks(p){return p=p[be],p instanceof _e?p:null}var Lr="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ur(p){return typeof p=="function"?p:(p[Lr]||(p[Lr]=function(x){return p.handleEvent(x)}),p[Lr])}function wt(){k.call(this),this.i=new _e(this),this.M=this,this.G=null}E(wt,k),wt.prototype[he]=!0,wt.prototype.removeEventListener=function(p,x,S,M){Es(this,p,x,S,M)};function Mt(p,x){var S,M=p.G;if(M)for(S=[];M;M=M.G)S.push(M);if(p=p.M,M=x.type||x,typeof x=="string")x=new V(x,p);else if(x instanceof V)x.target=x.target||p;else{var J=x;x=new V(M,p),ye(x,J)}J=!0;let ee,ge;if(S)for(ge=S.length-1;ge>=0;ge--)ee=x.g=S[ge],J=xs(ee,M,!0,x)&&J;if(ee=x.g=p,J=xs(ee,M,!0,x)&&J,J=xs(ee,M,!1,x)&&J,S)for(ge=0;ge<S.length;ge++)ee=x.g=S[ge],J=xs(ee,M,!1,x)&&J}wt.prototype.N=function(){if(wt.Z.N.call(this),this.i){var p=this.i;for(const x in p.g){const S=p.g[x];for(let M=0;M<S.length;M++)ve(S[M]);delete p.g[x],p.h--}}this.G=null},wt.prototype.J=function(p,x,S,M){return this.i.add(String(p),x,!1,S,M)},wt.prototype.K=function(p,x,S,M){return this.i.add(String(p),x,!0,S,M)};function xs(p,x,S,M){if(x=p.i.g[String(x)],!x)return!0;x=x.concat();let J=!0;for(let ee=0;ee<x.length;++ee){const ge=x[ee];if(ge&&!ge.da&&ge.capture==S){const Fe=ge.listener,Dt=ge.ha||ge.src;ge.fa&&ie(p.i,ge),J=Fe.call(Dt,M)!==!1&&J}}return J&&!M.defaultPrevented}function sl(p,x){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:u.setTimeout(p,x||0)}function Mo(p){p.g=sl(()=>{p.g=null,p.i&&(p.i=!1,Mo(p))},p.l);const x=p.h;p.h=null,p.m.apply(null,x)}class Xt extends k{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Mo(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qs(p){k.call(this),this.h=p,this.g={}}E(Qs,k);var ji=[];function Fi(p){Be(p.g,function(x,S){this.g.hasOwnProperty(S)&&Oi(x)},p),p.g={}}Qs.prototype.N=function(){Qs.Z.N.call(this),Fi(this)},Qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ss=u.JSON.stringify,Do=u.JSON.parse,Or=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function Y(){}function pe(){}var me={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Te(){V.call(this,"d")}E(Te,V);function Re(){V.call(this,"c")}E(Re,V);var Ue={},jr=null;function Xs(){return jr=jr||new wt}Ue.Ia="serverreachability";function Po(p){V.call(this,Ue.Ia,p)}E(Po,V);function qn(p){const x=Xs();Mt(x,new Po(x))}Ue.STAT_EVENT="statevent";function Ws(p,x){V.call(this,Ue.STAT_EVENT,p),this.stat=x}E(Ws,V);function It(p){const x=Xs();Mt(x,new Ws(x,p))}Ue.Ja="timingevent";function Ee(p,x){V.call(this,Ue.Ja,p),this.size=x}E(Ee,V);function ft(p,x){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},x)}function Ut(){this.g=!0}Ut.prototype.ua=function(){this.g=!1};function En(p,x,S,M,J,ee){p.info(function(){if(p.g)if(ee){var ge="",Fe=ee.split("&");for(let ot=0;ot<Fe.length;ot++){var Dt=Fe[ot].split("=");if(Dt.length>1){const bt=Dt[0];Dt=Dt[1];const Gn=bt.split("_");ge=Gn.length>=2&&Gn[1]=="type"?ge+(bt+"="+Dt+"&"):ge+(bt+"=redacted&")}}}else ge=null;else ge=ee;return"XMLHTTP REQ ("+M+") [attempt "+J+"]: "+x+`
`+S+`
`+ge})}function bs(p,x,S,M,J,ee,ge){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+J+"]: "+x+`
`+S+`
`+ee+" "+ge})}function Ye(p,x,S,M){p.info(function(){return"XMLHTTP TEXT ("+x+"): "+Sf(p,S)+(M?" "+M:"")})}function Fr(p,x){p.info(function(){return"TIMEOUT: "+x})}Ut.prototype.info=function(){};function Sf(p,x){if(!p.g)return x;if(!x)return null;try{const ee=JSON.parse(x);if(ee){for(p=0;p<ee.length;p++)if(Array.isArray(ee[p])){var S=ee[p];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var J=M[0];if(J!="noop"&&J!="stop"&&J!="close")for(let ge=1;ge<M.length;ge++)M[ge]=""}}}}return ss(ee)}catch{return x}}var qr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},il={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},rl;function Br(){}E(Br,Y),Br.prototype.g=function(){return new XMLHttpRequest},rl=new Br;function Zs(p){return encodeURIComponent(String(p))}function Fu(p){var x=1;p=p.split(":");const S=[];for(;x>0&&p.length;)S.push(p.shift()),x--;return p.length&&S.push(p.join(":")),S}function is(p,x,S,M){this.j=p,this.i=x,this.l=S,this.S=M||1,this.V=new Qs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new rs}function rs(){this.i=null,this.g="",this.h=!1}var Ot={},Wt={};function As(p,x,S){p.M=1,p.A=zr(Ft(x)),p.u=S,p.R=!0,ko(p,null)}function ko(p,x){p.F=Date.now(),Ss(p),p.B=Ft(p.A);var S=p.B,M=p.S;Array.isArray(M)||(M=[String(M)]),Oo(S.i,"t",M),p.C=0,S=p.j.L,p.h=new rs,p.g=tc(p.j,S?x:null,!p.u),p.P>0&&(p.O=new Xt(h(p.Y,p,p.g),p.P)),x=p.V,S=p.g,M=p.ba;var J="readystatechange";Array.isArray(J)||(J&&(ji[0]=J.toString()),J=ji);for(let ee=0;ee<J.length;ee++){const ge=nt(S,J[ee],M||x.handleEvent,!1,x.h||x);if(!ge)break;x.g[ge.key]=ge}x=p.J?q(p.J):{},p.u?(p.v||(p.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,x)):(p.v="GET",p.g.ea(p.B,p.v,null,x)),qn(),En(p.i,p.v,p.B,p.l,p.S,p.u)}is.prototype.ba=function(p){p=p.target;const x=this.O;x&&ls(p)==3?x.j():this.Y(p)},is.prototype.Y=function(p){try{if(p==this.g)e:{const Fe=ls(this.g),Dt=this.g.ya(),ot=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||rn(this.g)))){this.K||Fe!=4||Dt==7||(Dt==8||ot<=0?qn(3):qn(2)),Cs(this);var x=this.g.ca();this.X=x;var S=Cf(this);if(this.o=x==200,bs(this.i,this.v,this.B,this.l,this.S,Fe,x),this.o){if(this.U&&!this.L){t:{if(this.g){var M,J=this.g;if((M=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(M)){var ee=M;break t}}ee=null}if(p=ee)Ye(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ws(this,p);else{this.o=!1,this.m=3,It(12),Rn(this),Bn(this);break e}}if(this.R){p=!0;let bt;for(;!this.K&&this.C<S.length;)if(bt=Bu(this,S),bt==Wt){Fe==4&&(this.m=4,It(14),p=!1),Ye(this.i,this.l,null,"[Incomplete Response]");break}else if(bt==Ot){this.m=4,It(15),Ye(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Ye(this.i,this.l,bt,null),ws(this,bt);if(qu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||S.length!=0||this.h.h||(this.m=1,It(16),p=!1),this.o=this.o&&p,!p)Ye(this.i,this.l,S,"[Invalid Chunked Response]"),Rn(this),Bn(this);else if(S.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Tl(ge),ge.P=!0,It(11))}}else Ye(this.i,this.l,S,null),ws(this,S);Fe==4&&Rn(this),this.o&&!this.K&&(Fe==4?Xu(this.j,this):(this.o=!1,Ss(this)))}else ti(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),Rn(this),Bn(this)}}}catch{}finally{}};function Cf(p){if(!qu(p))return p.g.la();const x=rn(p.g);if(x==="")return"";let S="";const M=x.length,J=ls(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Rn(p),Bn(p),"";p.h.i=new u.TextDecoder}for(let ee=0;ee<M;ee++)p.h.h=!0,S+=p.h.i.decode(x[ee],{stream:!(J&&ee==M-1)});return x.length=0,p.h.g+=S,p.C=0,p.h.g}function qu(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function Bu(p,x){var S=p.C,M=x.indexOf(`
`,S);return M==-1?Wt:(S=Number(x.substring(S,M)),isNaN(S)?Ot:(M+=1,M+S>x.length?Wt:(x=x.slice(M,M+S),p.C=M+S,x)))}is.prototype.cancel=function(){this.K=!0,Rn(this)};function Ss(p){p.T=Date.now()+p.H,Vo(p,p.H)}function Vo(p,x){if(p.D!=null)throw Error("WatchDog timer not null");p.D=ft(h(p.aa,p),x)}function Cs(p){p.D&&(u.clearTimeout(p.D),p.D=null)}is.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Fr(this.i,this.B),this.M!=2&&(qn(),It(17)),Rn(this),this.m=2,Bn(this)):Vo(this,this.T-p)};function Bn(p){p.j.I==0||p.K||Xu(p.j,p)}function Rn(p){Cs(p);var x=p.O;x&&typeof x.dispose=="function"&&x.dispose(),p.O=null,Fi(p.V),p.g&&(x=p.g,p.g=null,x.abort(),x.dispose())}function ws(p,x){try{var S=p.j;if(S.I!=0&&(S.g==p||Ns(S.h,p))){if(!p.L&&Ns(S.h,p)&&S.I==3){try{var M=S.Ba.g.parse(x)}catch{M=null}if(Array.isArray(M)&&M.length==3){var J=M;if(J[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)zo(S),Ji(S);else break e;Qr(S),It(18)}}else S.xa=J[1],0<S.xa-S.K&&J[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=ft(h(S.Va,S),6e3));Is(S.h)<=1&&S.ta&&(S.ta=void 0)}else Vs(S,11)}else if((p.L||S.g==p)&&zo(S),!D(x))for(J=S.Ba.g.parse(x),x=0;x<J.length;x++){let ot=J[x];const bt=ot[0];if(!(bt<=S.K))if(S.K=bt,ot=ot[1],S.I==2)if(ot[0]=="c"){S.M=ot[1],S.ba=ot[2];const Gn=ot[3];Gn!=null&&(S.ka=Gn,S.j.info("VER="+S.ka));const Ls=ot[4];Ls!=null&&(S.za=Ls,S.j.info("SVER="+S.za));const us=ot[5];us!=null&&typeof us=="number"&&us>0&&(M=1.5*us,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const cs=p.g;if(cs){const Xr=cs.g?cs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xr){var ee=M.h;ee.g||Xr.indexOf("spdy")==-1&&Xr.indexOf("quic")==-1&&Xr.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(ll(ee,ee.h),ee.h=null))}if(M.G){const Ho=cs.g?cs.g.getResponseHeader("X-HTTP-Session-Id"):null;Ho&&(M.wa=Ho,ut(M.J,M.G,Ho))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var ge=p;if(M.na=ec(M,M.L?M.ba:null,M.W),ge.L){ul(M.h,ge);var Fe=ge,Dt=M.O;Dt&&(Fe.H=Dt),Fe.D&&(Cs(Fe),Ss(Fe)),M.g=ge}else Ku(M);S.i.length>0&&ks(S)}else ot[0]!="stop"&&ot[0]!="close"||Vs(S,7);else S.I==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?Vs(S,7):vl(S):ot[0]!="noop"&&S.l&&S.l.qa(ot),S.A=0)}}qn(4)}catch{}}var jt=class{constructor(p,x){this.g=p,this.map=x}};function ol(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function al(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Is(p){return p.h?1:p.g?p.g.size:0}function Ns(p,x){return p.h?p.h==x:p.g?p.g.has(x):!1}function ll(p,x){p.g?p.g.add(x):p.h=x}function ul(p,x){p.h&&p.h==x?p.h=null:p.g&&p.g.has(x)&&p.g.delete(x)}ol.prototype.cancel=function(){if(this.i=cl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function cl(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let x=p.i;for(const S of p.g.values())x=x.concat(S.G);return x}return w(p.i)}var zu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lo(p,x){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const M=p[S].indexOf("=");let J,ee=null;M>=0?(J=p[S].substring(0,M),ee=p[S].substring(M+1)):J=p[S],x(J,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Mn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;p instanceof Mn?(this.l=p.l,Zt(this,p.j),this.o=p.o,this.g=p.g,qi(this,p.u),this.h=p.h,dl(this,$u(p.i)),this.m=p.m):p&&(x=String(p).match(zu))?(this.l=!1,Zt(this,x[1]||"",!0),this.o=Rs(x[2]||""),this.g=Rs(x[3]||"",!0),qi(this,x[4]),this.h=Rs(x[5]||"",!0),dl(this,x[6]||"",!0),this.m=Rs(x[7]||"")):(this.l=!1,this.i=new zi(null,this.l))}Mn.prototype.toString=function(){const p=[];var x=this.j;x&&p.push(Hr(x,Uo,!0),":");var S=this.g;return(S||x=="file")&&(p.push("//"),(x=this.o)&&p.push(Hr(x,Uo,!0),"@"),p.push(Zs(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Hr(S,S.charAt(0)=="/"?fl:Hu,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Hr(S,Gu)),p.join("")},Mn.prototype.resolve=function(p){const x=Ft(this);let S=!!p.j;S?Zt(x,p.j):S=!!p.o,S?x.o=p.o:S=!!p.g,S?x.g=p.g:S=p.u!=null;var M=p.h;if(S)qi(x,p.u);else if(S=!!p.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var J=x.h.lastIndexOf("/");J!=-1&&(M=x.h.slice(0,J+1)+M)}if(J=M,J==".."||J==".")M="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){M=J.lastIndexOf("/",0)==0,J=J.split("/");const ee=[];for(let ge=0;ge<J.length;){const Fe=J[ge++];Fe=="."?M&&ge==J.length&&ee.push(""):Fe==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),M&&ge==J.length&&ee.push("")):(ee.push(Fe),M=!0)}M=ee.join("/")}else M=J}return S?x.h=M:S=p.i.toString()!=="",S?dl(x,$u(p.i)):S=!!p.m,S&&(x.m=p.m),x};function Ft(p){return new Mn(p)}function Zt(p,x,S){p.j=S?Rs(x,!0):x,p.j&&(p.j=p.j.replace(/:$/,""))}function qi(p,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);p.u=x}else p.u=null}function dl(p,x,S){x instanceof zi?(p.i=x,jo(p.i,p.l)):(S||(x=Hr(x,Bi)),p.i=new zi(x,p.l))}function ut(p,x,S){p.i.set(x,S)}function zr(p){return ut(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Rs(p,x){return p?x?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Hr(p,x,S){return typeof p=="string"?(p=encodeURI(p).replace(x,xn),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function xn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Uo=/[#\/\?@]/g,Hu=/[#\?:]/g,fl=/[#\?]/g,Bi=/[#\?@]/g,Gu=/#/g;function zi(p,x){this.h=this.g=null,this.i=p||null,this.j=!!x}function bn(p){p.g||(p.g=new Map,p.h=0,p.i&&Lo(p.i,function(x,S){p.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}n=zi.prototype,n.add=function(p,x){bn(this),this.i=null,p=Hi(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(x),this.h+=1,this};function Yu(p,x){bn(p),x=Hi(p,x),p.g.has(x)&&(p.i=null,p.h-=p.g.get(x).length,p.g.delete(x))}function hl(p,x){return bn(p),x=Hi(p,x),p.g.has(x)}n.forEach=function(p,x){bn(this),this.g.forEach(function(S,M){S.forEach(function(J){p.call(x,J,M,this)},this)},this)};function ml(p,x){bn(p);let S=[];if(typeof x=="string")hl(p,x)&&(S=S.concat(p.g.get(Hi(p,x))));else for(p=Array.from(p.g.values()),x=0;x<p.length;x++)S=S.concat(p[x]);return S}n.set=function(p,x){return bn(this),this.i=null,p=Hi(this,p),hl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[x]),this.h+=1,this},n.get=function(p,x){return p?(p=ml(this,p),p.length>0?String(p[0]):x):x};function Oo(p,x,S){Yu(p,x),S.length>0&&(p.i=null,p.g.set(Hi(p,x),w(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],x=Array.from(this.g.keys());for(let M=0;M<x.length;M++){var S=x[M];const J=Zs(S);S=ml(this,S);for(let ee=0;ee<S.length;ee++){let ge=J;S[ee]!==""&&(ge+="="+Zs(S[ee])),p.push(ge)}}return this.i=p.join("&")};function $u(p){const x=new zi;return x.i=p.i,p.g&&(x.g=new Map(p.g),x.h=p.h),x}function Hi(p,x){return x=String(x),p.j&&(x=x.toLowerCase()),x}function jo(p,x){x&&!p.j&&(bn(p),p.i=null,p.g.forEach(function(S,M){const J=M.toLowerCase();M!=J&&(Yu(this,M),Oo(this,J,S))},p)),p.j=x}function os(p,x){const S=new Ut;if(u.Image){const M=new Image;M.onload=T(zn,S,"TestLoadImage: loaded",!0,x,M),M.onerror=T(zn,S,"TestLoadImage: error",!1,x,M),M.onabort=T(zn,S,"TestLoadImage: abort",!1,x,M),M.ontimeout=T(zn,S,"TestLoadImage: timeout",!1,x,M),u.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else x(!1)}function pl(p,x){const S=new Ut,M=new AbortController,J=setTimeout(()=>{M.abort(),zn(S,"TestPingServer: timeout",!1,x)},1e4);fetch(p,{signal:M.signal}).then(ee=>{clearTimeout(J),ee.ok?zn(S,"TestPingServer: ok",!0,x):zn(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(J),zn(S,"TestPingServer: error",!1,x)})}function zn(p,x,S,M,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),M(S)}catch{}}function Gi(){this.g=new Or}function Ms(p){this.i=p.Sb||null,this.h=p.ab||!1}E(Ms,Y),Ms.prototype.g=function(){return new Gr(this.i,this.h)};function Gr(p,x){wt.call(this),this.H=p,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(Gr,wt),n=Gr.prototype,n.open=function(p,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=x,this.readyState=1,as(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(x.body=p),(this.H||u).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,as(this)),this.g&&(this.readyState=3,as(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Fo(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Fo(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var x=p.value?p.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!p.done}))&&(this.response=this.responseText+=x)}p.done?Yi(this):as(this),this.readyState==3&&Fo(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Yi(this))},n.Na=function(p){this.g&&(this.response=p,Yi(this))},n.ga=function(){this.g&&Yi(this)};function Yi(p){p.readyState=4,p.l=null,p.j=null,p.B=null,as(p)}n.setRequestHeader=function(p,x){this.A.append(p,x)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=x.next();return p.join(`\r
`)};function as(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Gr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Hn(p){let x="";return Be(p,function(S,M){x+=M,x+=":",x+=S,x+=`\r
`}),x}function Yr(p,x,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=Hn(S),typeof p=="string"?S!=null&&Zs(S):ut(p,x,S))}function ht(p){wt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(ht,wt);var Ds=/^https?$/i,gl=["POST","PUT"];n=ht.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,x,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);x=x?x.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():rl.g(),this.g.onreadystatechange=b(h(this.Ca,this));try{this.B=!0,this.g.open(x,String(p),!0),this.B=!1}catch(ee){$r(this,ee);return}if(p=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var J in M)S.set(J,M[J]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ee of M.keys())S.set(ee,M.get(ee));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(ee=>ee.toLowerCase()=="content-type"),J=u.FormData&&p instanceof u.FormData,!(Array.prototype.indexOf.call(gl,x,void 0)>=0)||M||J||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,ge]of S)this.g.setRequestHeader(ee,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ee){$r(this,ee)}};function $r(p,x){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=x,p.o=5,yl(p),ei(p)}function yl(p){p.A||(p.A=!0,Mt(p,"complete"),Mt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Mt(this,"complete"),Mt(this,"abort"),ei(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ei(this,!0)),ht.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Jr(this):this.Xa())},n.Xa=function(){Jr(this)};function Jr(p){if(p.h&&typeof l<"u"){if(p.v&&ls(p)==4)setTimeout(p.Ca.bind(p),0);else if(Mt(p,"readystatechange"),ls(p)==4){p.h=!1;try{const ee=p.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var M;if(M=ee===0){let ge=String(p.D).match(zu)[1]||null;!ge&&u.self&&u.self.location&&(ge=u.self.location.protocol.slice(0,-1)),M=!Ds.test(ge?ge.toLowerCase():"")}S=M}if(S)Mt(p,"complete"),Mt(p,"success");else{p.o=6;try{var J=ls(p)>2?p.g.statusText:""}catch{J=""}p.l=J+" ["+p.ca()+"]",yl(p)}}finally{ei(p)}}}}function ei(p,x){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,x||Mt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ls(p){return p.g?p.g.readyState:0}n.ca=function(){try{return ls(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var x=this.g.responseText;return p&&x.indexOf(p)==0&&(x=x.substring(p.length)),Do(x)}};function rn(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ti(p){const x={};p=(p.g&&ls(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(D(p[M]))continue;var S=Fu(p[M]);const J=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ee=x[J]||[];x[J]=ee,ee.push(S)}Ze(x,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ps(p,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||x}function $i(p){this.za=0,this.i=[],this.j=new Ut,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ps("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ps("baseRetryDelayMs",5e3,p),this.Za=Ps("retryDelaySeedMs",1e4,p),this.Ta=Ps("forwardChannelMaxRetries",2,p),this.va=Ps("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new ol(p&&p.concurrentRequestLimit),this.Ba=new Gi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$i.prototype,n.ka=8,n.I=1,n.connect=function(p,x,S,M){It(0),this.W=p,this.H=x||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=ec(this,null,this.W),ks(this)};function vl(p){if(qo(p),p.I==3){var x=p.V++,S=Ft(p.J);if(ut(S,"SID",p.M),ut(S,"RID",x),ut(S,"TYPE","terminate"),Kr(p,S),x=new is(p,p.j,x),x.M=2,x.A=zr(Ft(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=x.A,S=!0),S||(x.g=tc(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Ss(x)}Zu(p)}function Ji(p){p.g&&(Tl(p),p.g.cancel(),p.g=null)}function qo(p){Ji(p),p.v&&(u.clearTimeout(p.v),p.v=null),zo(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&u.clearTimeout(p.m),p.m=null)}function ks(p){if(!al(p.h)&&!p.m){p.m=!0;var x=p.Ea;Z||C(),W||(Z(),W=!0),R.add(x,p),p.D=0}}function Bo(p,x){return Is(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=x.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=ft(h(p.Ea,p,x),Wu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const J=new is(this,this.j,p);let ee=this.o;if(this.U&&(ee?(ee=q(ee),ye(ee,this.U)):ee=this.U),this.u!==null||this.R||(J.J=ee,ee=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(x+=M,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Ju(this,J,x),S=Ft(this.J),ut(S,"RID",p),ut(S,"CVER",22),this.G&&ut(S,"X-HTTP-Session-Id",this.G),Kr(this,S),ee&&(this.R?x="headers="+Zs(Hn(ee))+"&"+x:this.u&&Yr(S,this.u,ee)),ll(this.h,J),this.Ra&&ut(S,"TYPE","init"),this.S?(ut(S,"$req",x),ut(S,"SID","null"),J.U=!0,As(J,S,null)):As(J,S,x),this.I=2}}else this.I==3&&(p?_l(this,p):this.i.length==0||al(this.h)||_l(this))};function _l(p,x){var S;x?S=x.l:S=p.V++;const M=Ft(p.J);ut(M,"SID",p.M),ut(M,"RID",S),ut(M,"AID",p.K),Kr(p,M),p.u&&p.o&&Yr(M,p.u,p.o),S=new is(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),x&&(p.i=x.G.concat(p.i)),x=Ju(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ll(p.h,S),As(S,M,x)}function Kr(p,x){p.H&&Be(p.H,function(S,M){ut(x,M,S)}),p.l&&Be({},function(S,M){ut(x,M,S)})}function Ju(p,x,S){S=Math.min(p.i.length,S);const M=p.l?h(p.l.Ka,p.l,p):null;e:{var J=p.i;let Fe=-1;for(;;){const Dt=["count="+S];Fe==-1?S>0?(Fe=J[0].g,Dt.push("ofs="+Fe)):Fe=0:Dt.push("ofs="+Fe);let ot=!0;for(let bt=0;bt<S;bt++){var ee=J[bt].g;const Gn=J[bt].map;if(ee-=Fe,ee<0)Fe=Math.max(0,J[bt].g-100),ot=!1;else try{ee="req"+ee+"_"||"";try{var ge=Gn instanceof Map?Gn:Object.entries(Gn);for(const[Ls,us]of ge){let cs=us;f(us)&&(cs=ss(us)),Dt.push(ee+Ls+"="+encodeURIComponent(cs))}}catch(Ls){throw Dt.push(ee+"type="+encodeURIComponent("_badmap")),Ls}}catch{M&&M(Gn)}}if(ot){ge=Dt.join("&");break e}}ge=void 0}return p=p.i.splice(0,S),x.G=p,ge}function Ku(p){if(!p.g&&!p.v){p.Y=1;var x=p.Da;Z||C(),W||(Z(),W=!0),R.add(x,p),p.A=0}}function Qr(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=ft(h(p.Da,p),Wu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Qu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=ft(h(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),Ji(this),Qu(this))};function Tl(p){p.B!=null&&(u.clearTimeout(p.B),p.B=null)}function Qu(p){p.g=new is(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var x=Ft(p.na);ut(x,"RID","rpc"),ut(x,"SID",p.M),ut(x,"AID",p.K),ut(x,"CI",p.F?"0":"1"),!p.F&&p.ia&&ut(x,"TO",p.ia),ut(x,"TYPE","xmlhttp"),Kr(p,x),p.u&&p.o&&Yr(x,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=zr(Ft(x)),S.u=null,S.R=!0,ko(S,p)}n.Va=function(){this.C!=null&&(this.C=null,Ji(this),Qr(this),It(19))};function zo(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Xu(p,x){var S=null;if(p.g==x){zo(p),Tl(p),p.g=null;var M=2}else if(Ns(p.h,x))S=x.G,ul(p.h,x),M=1;else return;if(p.I!=0){if(x.o)if(M==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var J=p.D;M=Xs(),Mt(M,new Ee(M,S)),ks(p)}else Ku(p);else if(J=x.m,J==3||J==0&&x.X>0||!(M==1&&Bo(p,x)||M==2&&Qr(p)))switch(S&&S.length>0&&(x=p.h,x.i=x.i.concat(S)),J){case 1:Vs(p,5);break;case 4:Vs(p,10);break;case 3:Vs(p,6);break;default:Vs(p,2)}}}function Wu(p,x){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*x}function Vs(p,x){if(p.j.info("Error code "+x),x==2){var S=h(p.bb,p),M=p.Ua;const J=!M;M=new Mn(M||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Zt(M,"https"),zr(M),J?os(M.toString(),S):pl(M.toString(),S)}else It(2);p.I=0,p.l&&p.l.pa(x),Zu(p),qo(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Zu(p){if(p.I=0,p.ja=[],p.l){const x=cl(p.h);(x.length!=0||p.i.length!=0)&&(P(p.ja,x),P(p.ja,p.i),p.h.i.length=0,w(p.i),p.i.length=0),p.l.oa()}}function ec(p,x,S){var M=S instanceof Mn?Ft(S):new Mn(S);if(M.g!="")x&&(M.g=x+"."+M.g),qi(M,M.u);else{var J=u.location;M=J.protocol,x=x?x+"."+J.hostname:J.hostname,J=+J.port;const ee=new Mn(null);M&&Zt(ee,M),x&&(ee.g=x),J&&qi(ee,J),S&&(ee.h=S),M=ee}return S=p.G,x=p.wa,S&&x&&ut(M,S,x),ut(M,"VER",p.ka),Kr(p,M),M}function tc(p,x,S){if(x&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=p.Aa&&!p.ma?new ht(new Ms({ab:S})):new ht(p.ma),x.Fa(p.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nc(){}n=nc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ki(){}Ki.prototype.g=function(p,x){return new yn(p,x)};function yn(p,x){wt.call(this),this.g=new $i(x),this.l=p,this.h=x&&x.messageUrlParams||null,p=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(p?p["X-WebChannel-Content-Type"]=x.messageContentType:p={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(p?p["X-WebChannel-Client-Profile"]=x.sa:p={"X-WebChannel-Client-Profile":x.sa}),this.g.U=p,(p=x&&x.Qb)&&!D(p)&&(this.g.u=p),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!D(x)&&(this.g.G=x,p=this.h,p!==null&&x in p&&(p=this.h,x in p&&delete p[x])),this.j=new ni(this)}E(yn,wt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){vl(this.g)},yn.prototype.o=function(p){var x=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=ss(p),p=S);x.i.push(new jt(x.Ya++,p)),x.I==3&&ks(x)},yn.prototype.N=function(){this.g.l=null,delete this.j,vl(this.g),delete this.g,yn.Z.N.call(this)};function sc(p){Te.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var x=p.__sm__;if(x){e:{for(const S in x){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,x=x!==null&&p in x?x[p]:void 0),this.data=x}else this.data=p}E(sc,Te);function ic(){Re.call(this),this.status=1}E(ic,Re);function ni(p){this.g=p}E(ni,nc),ni.prototype.ra=function(){Mt(this.g,"a")},ni.prototype.qa=function(p){Mt(this.g,new sc(p))},ni.prototype.pa=function(p){Mt(this.g,new ic)},ni.prototype.oa=function(){Mt(this.g,"b")},Ki.prototype.createWebChannel=Ki.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,jx=function(){return new Ki},Ox=function(){return Xs()},Ux=Ue,rp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qr.NO_ERROR=0,qr.TIMEOUT=8,qr.HTTP_ERROR=6,_d=qr,il.COMPLETE="complete",Lx=il,pe.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",wt.prototype.listen=wt.prototype.J,uu=pe,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,Vx=ht}).apply(typeof ud<"u"?ud:typeof self<"u"?self:typeof window<"u"?window:{});const ST="@firebase/firestore",CT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hn.UNAUTHENTICATED=new hn(null),hn.GOOGLE_CREDENTIALS=new hn("google-credentials-uid"),hn.FIRST_PARTY=new hn("first-party-uid"),hn.MOCK_USER=new hn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wa="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new kp("@firebase/firestore");function Ta(){return To.logLevel}function xe(n,...e){if(To.logLevel<=Ke.DEBUG){const t=e.map(Up);To.debug(`Firestore (${Wa}): ${n}`,...t)}}function Mi(n,...e){if(To.logLevel<=Ke.ERROR){const t=e.map(Up);To.error(`Firestore (${Wa}): ${n}`,...t)}}function Eo(n,...e){if(To.logLevel<=Ke.WARN){const t=e.map(Up);To.warn(`Firestore (${Wa}): ${n}`,...t)}}function Up(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Fx(n,i,t)}function Fx(n,e,t){let i=`FIRESTORE (${Wa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Mi(i),new Error(i)}function lt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||Fx(e,o,i)}function je(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Li{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(hn.UNAUTHENTICATED)))}shutdown(){}}class S2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class C2{constructor(e){this.t=e,this.currentUser=hn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lt(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new wi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new wi,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},f=g=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>f(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?f(g):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new wi)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(lt(typeof i.accessToken=="string",31837,{l:i}),new qx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new hn(e)}}class w2{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=hn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class I2{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new w2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(hn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class N2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,es(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lt(this.o===void 0,3512);const i=l=>{l.error!=null&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,xe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const o=l=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=R2(40);for(let l=0;l<o.length;++l)i.length<20&&o[l]<t&&(i+=e.charAt(o[l]%62))}return i}}function Qe(n,e){return n<e?-1:n>e?1:0}function op(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),l=e.charAt(i);if(o!==l)return Pm(o)===Pm(l)?Qe(o,l):Pm(o)?1:-1}return Qe(n.length,e.length)}const M2=55296,D2=57343;function Pm(n){const e=n.charCodeAt(0);return e>=M2&&e<=D2}function Ua(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="__name__";class qs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Pe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Pe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const l=qs.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return Qe(e.length,t.length)}static compareSegments(e,t){const i=qs.isNumericId(e),o=qs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?qs.extractNumericId(e).compare(qs.extractNumericId(t)):op(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ar.fromString(e.substring(4,e.length-2))}}class xt extends qs{construct(e,t,i){return new xt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new xt(t)}static emptyPath(){return new xt([])}}const P2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nn extends qs{construct(e,t,i){return new nn(e,t,i)}static isValidIdentifier(e){return P2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IT}static keyField(){return new nn([IT])}static fromServerFormat(e){const t=[];let i="",o=0;const l=()=>{if(i.length===0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new Ce(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ce(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else f==="`"?(u=!u,o++):f!=="."||u?(i+=f,o++):(l(),o++)}if(l(),u)throw new Ce(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nn(t)}static emptyPath(){return new nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(xt.fromString(e))}static fromName(e){return new Ne(xt.fromString(e).popFirst(5))}static empty(){return new Ne(xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(n,e,t){if(!t)throw new Ce(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Hx(n,e,t,i){if(e===!0&&i===!0)throw new Ce(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NT(n){if(!Ne.isDocumentKey(n))throw new Ce(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RT(n){if(Ne.isDocumentKey(n))throw new Ce(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Op(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Pe(12329,{type:typeof n})}function Di(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Op(n);throw new Ce(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Nu(n,e){if(!Gx(n))throw new Ce(ue.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(o&&typeof u!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Ce(ue.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=-62135596800,DT=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*DT);return new vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<MT)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DT}_compareTo(e){return this.seconds===e.seconds?Qe(this.nanoseconds,e.nanoseconds):Qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nu(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-MT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Yt("string",vt._jsonSchemaVersion),seconds:Yt("number"),nanoseconds:Yt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new vt(0,0))}static max(){return new Ve(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu=-1;function k2(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Ve.fromTimestamp(i===1e9?new vt(t+1,0):new vt(t,i));return new Cr(o,Ne.empty(),e)}function V2(n){return new Cr(n.readTime,n.key,Eu)}class Cr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Cr(Ve.min(),Ne.empty(),Eu)}static max(){return new Cr(Ve.max(),Ne.empty(),Eu)}}function L2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ne.comparator(n.documentKey,e.documentKey),t!==0?t:Qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class O2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Za(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==U2)throw n;xe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le(((i,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):le.reject(t)}static resolve(e){return new le(((t,i)=>{t(e)}))}static reject(e){return new le(((t,i)=>{i(e)}))}static waitFor(e){return new le(((t,i)=>{let o=0,l=0,u=!1;e.forEach((f=>{++o,f.next((()=>{++l,u&&l===o&&t()}),(g=>i(g)))})),u=!0,l===o&&t()}))}static or(e){let t=le.resolve(!1);for(const i of e)t=t.next((o=>o?le.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,l)=>{i.push(t.call(this,o,l))})),this.waitFor(i)}static mapArray(e,t){return new le(((i,o)=>{const l=e.length,u=new Array(l);let f=0;for(let g=0;g<l;g++){const h=g;t(e[h]).next((T=>{u[h]=T,++f,f===l&&i(u)}),(T=>o(T)))}}))}static doWhile(e,t){return new le(((i,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):i()};l()}))}}function j2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function el(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=-1;function of(n){return n==null}function kd(n){return n===0&&1/n==-1/0}function F2(n){return typeof n=="number"&&Number.isInteger(n)&&!kd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx="";function q2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PT(e)),e=B2(n.get(t),e);return PT(e)}function B2(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case Yx:t+="";break;default:t+=l}}return t}function PT(n){return n+Yx+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function So(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $x(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t){this.comparator=e,this.root=t||cn.EMPTY}insert(e,t){return new Ct(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new Ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cd(this.root,e,this.comparator,!0)}}class cd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cn{constructor(e,t,i,o,l){this.key=e,this.value=t,this.color=i??cn.RED,this.left=o??cn.EMPTY,this.right=l??cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,l){return new cn(e??this.key,t??this.value,i??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const l=i(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,i),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return cn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,i,o,l){return this}insert(e,t,i){return new cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VT(this.data.getIterator())}getIteratorFrom(e){return new VT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qt(this.comparator);return t.data=e,t}}class VT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.fields=e,e.sort(nn.comparator)}static empty(){return new ps([])}unionWith(e){let t=new Qt(nn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ps(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ua(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Jx("Invalid base64 string: "+l):l}})(e);return new sn(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let u=0;u<o.length;++u)l+=String.fromCharCode(o[u]);return l})(e);return new sn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const z2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(n){if(lt(!!n,39018),typeof n=="string"){let e=0;const t=z2.exec(n);if(lt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ir(n){return typeof n=="string"?sn.fromBase64String(n):sn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx="server_timestamp",Qx="__type__",Xx="__previous_value__",Wx="__local_write_time__";function Fp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Qx])==null?void 0:i.stringValue)===Kx}function af(n){const e=n.mapValue.fields[Xx];return Fp(e)?af(e):e}function xu(n){const e=wr(n.mapValue.fields[Wx].timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,t,i,o,l,u,f,g,h,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=g,this.useFetchStreams=h,this.isUsingEmulator=T}}const Vd="(default)";class Oa{constructor(e,t){this.projectId=e,this.database=t||Vd}static empty(){return new Oa("","")}get isDefaultDatabase(){return this.database===Vd}isEqual(e){return e instanceof Oa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="__type__",G2="__max__",dd={mapValue:{}},eb="__vector__",Ld="value";function Nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fp(n)?4:$2(n)?9007199254740991:Y2(n)?10:11:Pe(28295,{value:n})}function $s(n,e){if(n===e)return!0;const t=Nr(n);if(t!==Nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xu(n).isEqual(xu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const u=wr(o.timestampValue),f=wr(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return Ir(o.bytesValue).isEqual(Ir(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return Vt(o.geoPointValue.latitude)===Vt(l.geoPointValue.latitude)&&Vt(o.geoPointValue.longitude)===Vt(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return Vt(o.integerValue)===Vt(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const u=Vt(o.doubleValue),f=Vt(l.doubleValue);return u===f?kd(u)===kd(f):isNaN(u)&&isNaN(f)}return!1})(n,e);case 9:return Ua(n.arrayValue.values||[],e.arrayValue.values||[],$s);case 10:case 11:return(function(o,l){const u=o.mapValue.fields||{},f=l.mapValue.fields||{};if(kT(u)!==kT(f))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(f[g]===void 0||!$s(u[g],f[g])))return!1;return!0})(n,e);default:return Pe(52216,{left:n})}}function bu(n,e){return(n.values||[]).find((t=>$s(t,e)))!==void 0}function ja(n,e){if(n===e)return 0;const t=Nr(n),i=Nr(e);if(t!==i)return Qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Qe(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=Vt(l.integerValue||l.doubleValue),g=Vt(u.integerValue||u.doubleValue);return f<g?-1:f>g?1:f===g?0:isNaN(f)?isNaN(g)?0:-1:1})(n,e);case 3:return LT(n.timestampValue,e.timestampValue);case 4:return LT(xu(n),xu(e));case 5:return op(n.stringValue,e.stringValue);case 6:return(function(l,u){const f=Ir(l),g=Ir(u);return f.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),g=u.split("/");for(let h=0;h<f.length&&h<g.length;h++){const T=Qe(f[h],g[h]);if(T!==0)return T}return Qe(f.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=Qe(Vt(l.latitude),Vt(u.latitude));return f!==0?f:Qe(Vt(l.longitude),Vt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return UT(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var b,w,P,U;const f=l.fields||{},g=u.fields||{},h=(b=f[Ld])==null?void 0:b.arrayValue,T=(w=g[Ld])==null?void 0:w.arrayValue,E=Qe(((P=h==null?void 0:h.values)==null?void 0:P.length)||0,((U=T==null?void 0:T.values)==null?void 0:U.length)||0);return E!==0?E:UT(h,T)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===dd.mapValue&&u===dd.mapValue)return 0;if(l===dd.mapValue)return 1;if(u===dd.mapValue)return-1;const f=l.fields||{},g=Object.keys(f),h=u.fields||{},T=Object.keys(h);g.sort(),T.sort();for(let E=0;E<g.length&&E<T.length;++E){const b=op(g[E],T[E]);if(b!==0)return b;const w=ja(f[g[E]],h[T[E]]);if(w!==0)return w}return Qe(g.length,T.length)})(n.mapValue,e.mapValue);default:throw Pe(23264,{he:t})}}function LT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Qe(n,e);const t=wr(n),i=wr(e),o=Qe(t.seconds,i.seconds);return o!==0?o:Qe(t.nanos,i.nanos)}function UT(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const l=ja(t[o],i[o]);if(l)return l}return Qe(t.length,i.length)}function Fa(n){return ap(n)}function ap(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=wr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ir(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ne.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const l of t.values||[])o?o=!1:i+=",",i+=ap(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const u of i)l?l=!1:o+=",",o+=`${u}:${ap(t.fields[u])}`;return o+"}"})(n.mapValue):Pe(61005,{value:n})}function Td(n){switch(Nr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=af(n);return e?16+Td(e):16;case 5:return 2*n.stringValue.length;case 6:return Ir(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,l)=>o+Td(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return So(i.fields,((l,u)=>{o+=l.length+Td(u)})),o})(n.mapValue);default:throw Pe(13486,{value:n})}}function lp(n){return!!n&&"integerValue"in n}function qp(n){return!!n&&"arrayValue"in n}function OT(n){return!!n&&"nullValue"in n}function jT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ed(n){return!!n&&"mapValue"in n}function Y2(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Zx])==null?void 0:i.stringValue)===eb}function mu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return So(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mu(n.arrayValue.values[t]);return e}return{...n}}function $2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===G2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.value=e}static empty(){return new ts({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ed(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(t)}setAll(e){let t=nn.emptyPath(),i={},o=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const g=this.getFieldsMap(t);this.applyChanges(g,i,o),i={},o=[],t=f.popLast()}u?i[f.lastSegment()]=mu(u):o.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,o)}delete(e){const t=this.field(e.popLast());Ed(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $s(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Ed(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){So(t,((o,l)=>e[o]=l));for(const o of i)delete e[o]}clone(){return new ts(mu(this.value))}}function tb(n){const e=[];return So(n.fields,((t,i)=>{const o=new nn([t]);if(Ed(i)){const l=tb(i.mapValue).fields;if(l.length===0)e.push(o);else for(const u of l)e.push(o.child(u))}else e.push(o)})),new ps(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,t,i,o,l,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new mn(e,0,Ve.min(),Ve.min(),Ve.min(),ts.empty(),0)}static newFoundDocument(e,t,i,o){return new mn(e,1,t,Ve.min(),i,o,0)}static newNoDocument(e,t){return new mn(e,2,t,Ve.min(),Ve.min(),ts.empty(),0)}static newUnknownDocument(e,t){return new mn(e,3,t,Ve.min(),Ve.min(),ts.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ts.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ts.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e,t){this.position=e,this.inclusive=t}}function FT(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const l=e[o],u=n.position[o];if(l.field.isKeyField()?i=Ne.comparator(Ne.fromName(u.referenceValue),t.key):i=ja(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function qT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$s(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t="asc"){this.field=e,this.dir=t}}function J2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{}class Kt extends nb{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Q2(e,t,i):t==="array-contains"?new Z2(e,i):t==="in"?new eP(e,i):t==="not-in"?new tP(e,i):t==="array-contains-any"?new nP(e,i):new Kt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new X2(e,i):new W2(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ja(t,this.value)):t!==null&&Nr(this.value)===Nr(t)&&this.matchesComparison(ja(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Js extends nb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Js(e,t)}matches(e){return sb(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function sb(n){return n.op==="and"}function ib(n){return K2(n)&&sb(n)}function K2(n){for(const e of n.filters)if(e instanceof Js)return!1;return!0}function up(n){if(n instanceof Kt)return n.field.canonicalString()+n.op.toString()+Fa(n.value);if(ib(n))return n.filters.map((e=>up(e))).join(",");{const e=n.filters.map((t=>up(t))).join(",");return`${n.op}(${e})`}}function rb(n,e){return n instanceof Kt?(function(i,o){return o instanceof Kt&&i.op===o.op&&i.field.isEqual(o.field)&&$s(i.value,o.value)})(n,e):n instanceof Js?(function(i,o){return o instanceof Js&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((l,u,f)=>l&&rb(u,o.filters[f])),!0):!1})(n,e):void Pe(19439)}function ob(n){return n instanceof Kt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Fa(t.value)}`})(n):n instanceof Js?(function(t){return t.op.toString()+" {"+t.getFilters().map(ob).join(" ,")+"}"})(n):"Filter"}class Q2 extends Kt{constructor(e,t,i){super(e,t,i),this.key=Ne.fromName(i.referenceValue)}matches(e){const t=Ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class X2 extends Kt{constructor(e,t){super(e,"in",t),this.keys=ab("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class W2 extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=ab("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ab(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ne.fromName(i.referenceValue)))}class Z2 extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qp(t)&&bu(t.arrayValue,this.value)}}class eP extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&bu(this.value.arrayValue,t)}}class tP extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!bu(this.value.arrayValue,t)}}class nP extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>bu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,t=null,i=[],o=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function BT(n,e=null,t=[],i=[],o=null,l=null,u=null){return new sP(n,e,t,i,o,l,u)}function Bp(n){const e=je(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>up(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),of(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Fa(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Fa(i))).join(",")),e.Te=t}return e.Te}function zp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!J2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qT(n.startAt,e.startAt)&&qT(n.endAt,e.endAt)}function cp(n){return Ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t=null,i=[],o=[],l=null,u="F",f=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iP(n,e,t,i,o,l,u,f){return new lf(n,e,t,i,o,l,u,f)}function Hp(n){return new lf(n)}function zT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function rP(n){return n.collectionGroup!==null}function pu(n){const e=je(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new Qt(nn.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((h=>{h.isInequality()&&(f=f.add(h.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Od(l,i))})),t.has(nn.keyField().canonicalString())||e.Ie.push(new Od(nn.keyField(),i))}return e.Ie}function Bs(n){const e=je(n);return e.Ee||(e.Ee=oP(e,pu(n))),e.Ee}function oP(n,e){if(n.limitType==="F")return BT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Od(o.field,l)}));const t=n.endAt?new Ud(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ud(n.startAt.position,n.startAt.inclusive):null;return BT(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function dp(n,e,t){return new lf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return zp(Bs(n),Bs(e))&&n.limitType===e.limitType}function lb(n){return`${Bp(Bs(n))}|lt:${n.limitType}`}function Ea(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>ob(o))).join(", ")}]`),of(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>Fa(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>Fa(o))).join(",")),`Target(${i})`})(Bs(n))}; limitType=${n.limitType})`}function cf(n,e){return e.isFoundDocument()&&(function(i,o){const l=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ne.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,o){for(const l of pu(i))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const l of i.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(u,f,g){const h=FT(u,f,g);return u.inclusive?h<=0:h<0})(i.startAt,pu(i),o)||i.endAt&&!(function(u,f,g){const h=FT(u,f,g);return u.inclusive?h>=0:h>0})(i.endAt,pu(i),o))})(n,e)}function aP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ub(n){return(e,t)=>{let i=!1;for(const o of pu(n)){const l=lP(o,e,t);if(l!==0)return l;i=i||o.field.isKeyField()}return 0}}function lP(n,e,t){const i=n.field.isKeyField()?Ne.comparator(e.key,t.key):(function(l,u,f){const g=u.data.field(l),h=f.data.field(l);return g!==null&&h!==null?ja(g,h):Pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,l]of i)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){So(this.inner,((t,i)=>{for(const[o,l]of i)e(o,l)}))}isEmpty(){return $x(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP=new Ct(Ne.comparator);function Pi(){return uP}const cb=new Ct(Ne.comparator);function cu(...n){let e=cb;for(const t of n)e=e.insert(t.key,t);return e}function db(n){let e=cb;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function po(){return gu()}function fb(){return gu()}function gu(){return new Co((n=>n.toString()),((n,e)=>n.isEqual(e)))}const cP=new Ct(Ne.comparator),dP=new Qt(Ne.comparator);function Xe(...n){let e=dP;for(const t of n)e=e.add(t);return e}const fP=new Qt(Qe);function hP(){return fP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kd(e)?"-0":e}}function hb(n){return{integerValue:""+n}}function mP(n,e){return F2(e)?hb(e):Gp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this._=void 0}}function pP(n,e,t){return n instanceof jd?(function(o,l){const u={fields:{[Qx]:{stringValue:Kx},[Wx]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Fp(l)&&(l=af(l)),l&&(u.fields[Xx]=l),{mapValue:u}})(t,e):n instanceof Au?pb(n,e):n instanceof Su?gb(n,e):(function(o,l){const u=mb(o,l),f=HT(u)+HT(o.Ae);return lp(u)&&lp(o.Ae)?hb(f):Gp(o.serializer,f)})(n,e)}function gP(n,e,t){return n instanceof Au?pb(n,e):n instanceof Su?gb(n,e):t}function mb(n,e){return n instanceof Fd?(function(i){return lp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class jd extends df{}class Au extends df{constructor(e){super(),this.elements=e}}function pb(n,e){const t=yb(e);for(const i of n.elements)t.some((o=>$s(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Su extends df{constructor(e){super(),this.elements=e}}function gb(n,e){let t=yb(e);for(const i of n.elements)t=t.filter((o=>!$s(o,i)));return{arrayValue:{values:t}}}class Fd extends df{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function HT(n){return Vt(n.integerValue||n.doubleValue)}function yb(n){return qp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function yP(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Au&&o instanceof Au||i instanceof Su&&o instanceof Su?Ua(i.elements,o.elements,$s):i instanceof Fd&&o instanceof Fd?$s(i.Ae,o.Ae):i instanceof jd&&o instanceof jd})(n.transform,e.transform)}class vP{constructor(e,t){this.version=e,this.transformResults=t}}class zs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new zs}static exists(e){return new zs(void 0,e)}static updateTime(e){return new zs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ff{}function vb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Yp(n.key,zs.none()):new Ru(n.key,n.data,zs.none());{const t=n.data,i=ts.empty();let o=new Qt(nn.comparator);for(let l of e.fields)if(!o.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),o=o.add(l)}return new wo(n.key,i,new ps(o.toArray()),zs.none())}}function _P(n,e,t){n instanceof Ru?(function(o,l,u){const f=o.value.clone(),g=YT(o.fieldTransforms,l,u.transformResults);f.setAll(g),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):n instanceof wo?(function(o,l,u){if(!xd(o.precondition,l))return void l.convertToUnknownDocument(u.version);const f=YT(o.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(_b(o)),g.setAll(f),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(o,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function yu(n,e,t,i){return n instanceof Ru?(function(l,u,f,g){if(!xd(l.precondition,u))return f;const h=l.value.clone(),T=$T(l.fieldTransforms,g,u);return h.setAll(T),u.convertToFoundDocument(u.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof wo?(function(l,u,f,g){if(!xd(l.precondition,u))return f;const h=$T(l.fieldTransforms,g,u),T=u.data;return T.setAll(_b(l)),T.setAll(h),u.convertToFoundDocument(u.version,T).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(l,u,f){return xd(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(n,e,t)}function TP(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),l=mb(i.transform,o||null);l!=null&&(t===null&&(t=ts.empty()),t.set(i.field,l))}return t||null}function GT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Ua(i,o,((l,u)=>yP(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ru extends ff{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class wo extends ff{constructor(e,t,i,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function _b(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function YT(n,e,t){const i=new Map;lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],u=l.transform,f=e.data.field(l.field);i.set(l.field,gP(u,f,t[o]))}return i}function $T(n,e,t){const i=new Map;for(const o of n){const l=o.transform,u=t.data.field(o.field);i.set(o.field,pP(l,u,e))}return i}class Yp extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class EP extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&_P(l,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=yu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=yu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=fb();return this.mutations.forEach((o=>{const l=e.get(o.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=t.has(o.key)?null:f;const g=vb(u,f);g!==null&&i.set(o.key,g),u.isValidDocument()||u.convertToNoDocument(Ve.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Xe())}isEqual(e){return this.batchId===e.batchId&&Ua(this.mutations,e.mutations,((t,i)=>GT(t,i)))&&Ua(this.baseMutations,e.baseMutations,((t,i)=>GT(t,i)))}}class $p{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){lt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return cP})();const l=e.mutations;for(let u=0;u<l.length;u++)o=o.insert(l[u].key,i[u].version);return new $p(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,tt;function SP(n){switch(n){case ue.OK:return Pe(64938);case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0;default:return Pe(15467,{code:n})}}function Tb(n){if(n===void 0)return Mi("GRPC error has no .code"),ue.UNKNOWN;switch(n){case Gt.OK:return ue.OK;case Gt.CANCELLED:return ue.CANCELLED;case Gt.UNKNOWN:return ue.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return ue.INTERNAL;case Gt.UNAVAILABLE:return ue.UNAVAILABLE;case Gt.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Gt.NOT_FOUND:return ue.NOT_FOUND;case Gt.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Gt.ABORTED:return ue.ABORTED;case Gt.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Gt.DATA_LOSS:return ue.DATA_LOSS;default:return Pe(39323,{code:n})}}(tt=Gt||(Gt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=new Ar([4294967295,4294967295],0);function JT(n){const e=CP().encode(n),t=new kx;return t.update(e),new Uint8Array(t.digest())}function KT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Ar([t,i],0),new Ar([o,l],0)]}class Jp{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new du(`Invalid padding: ${t}`);if(i<0)throw new du(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new du(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new du(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ar.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Ar.fromNumber(i)));return o.compare(wP)===1&&(o=new Ar([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=JT(e),[i,o]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Jp(l,o,t);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const t=JT(e),[i,o]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class du extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t,i,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Mu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new hf(Ve.min(),o,new Ct(Qe),Pi(),Xe())}}class Mu{constructor(e,t,i,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Mu(i,t,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class Eb{constructor(e,t){this.targetId=e,this.Ce=t}}class xb{constructor(e,t,i=sn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class QT{constructor(){this.ve=0,this.Fe=XT(),this.Me=sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),t=Xe(),i=Xe();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Pe(38017,{changeType:l})}})),new Mu(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=XT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class IP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pi(),this.Je=fd(),this.He=fd(),this.Ye=new Ct(Qe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(cp(l))if(i===0){const u=new Ne(l.path);this.et(t,u,mn.newNoDocument(u,Ve.min()))}else lt(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const f=this.ut(e),g=f?this.ct(f,e,u):1;if(g!==0){this.it(t);const h=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:l=0}=t;let u,f;try{u=Ir(i).toUint8Array()}catch(g){if(g instanceof Jx)return Eo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{f=new Jp(u,o,l)}catch(g){return Eo(g instanceof du?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&cp(f.target)){const g=new Ne(f.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,mn.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let i=Xe();this.He.forEach(((l,u)=>{let f=!0;u.forEachWhile((g=>{const h=this.ot(g);return!h||h.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const o=new hf(e,t,this.Ye,this.je,i);return this.je=Pi(),this.Je=fd(),this.He=fd(),this.Ye=new Ct(Qe),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new QT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qt(Qe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qt(Qe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||xe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new QT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fd(){return new Ct(Ne.comparator)}function XT(){return new Ct(Ne.comparator)}const NP={asc:"ASCENDING",desc:"DESCENDING"},RP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MP={and:"AND",or:"OR"};class DP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fp(n,e){return n.useProto3Json||of(e)?e:{value:e}}function qd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function PP(n,e){return qd(n,e.toTimestamp())}function Hs(n){return lt(!!n,49232),Ve.fromTimestamp((function(t){const i=wr(t);return new vt(i.seconds,i.nanos)})(n))}function Kp(n,e){return hp(n,e).canonicalString()}function hp(n,e){const t=(function(o){return new xt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Ab(n){const e=xt.fromString(n);return lt(Nb(e),10190,{key:e.toString()}),e}function mp(n,e){return Kp(n.databaseId,e.path)}function km(n,e){const t=Ab(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ne(Cb(t))}function Sb(n,e){return Kp(n.databaseId,e)}function kP(n){const e=Ab(n);return e.length===4?xt.emptyPath():Cb(e)}function pp(n){return new xt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cb(n){return lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function WT(n,e,t){return{name:mp(n,e),fields:t.value.mapValue.fields}}function VP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Pe(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(h,T){return h.useProto3Json?(lt(T===void 0||typeof T=="string",58123),sn.fromBase64String(T||"")):(lt(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),sn.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(h){const T=h.code===void 0?ue.UNKNOWN:Tb(h.code);return new Ce(T,h.message||"")})(u);t=new xb(i,o,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=km(n,i.document.name),l=Hs(i.document.updateTime),u=i.document.createTime?Hs(i.document.createTime):Ve.min(),f=new ts({mapValue:{fields:i.document.fields}}),g=mn.newFoundDocument(o,l,u,f),h=i.targetIds||[],T=i.removedTargetIds||[];t=new bd(h,T,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=km(n,i.document),l=i.readTime?Hs(i.readTime):Ve.min(),u=mn.newNoDocument(o,l),f=i.removedTargetIds||[];t=new bd([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=km(n,i.document),l=i.removedTargetIds||[];t=new bd([],l,o,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:l}=i,u=new AP(o,l),f=i.targetId;t=new Eb(f,u)}}return t}function LP(n,e){let t;if(e instanceof Ru)t={update:WT(n,e.key,e.value)};else if(e instanceof Yp)t={delete:mp(n,e.key)};else if(e instanceof wo)t={update:WT(n,e.key,e.data),updateMask:GP(e.fieldMask)};else{if(!(e instanceof EP))return Pe(16599,{Vt:e.type});t={verify:mp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof jd)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Au)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Su)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Fd)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw Pe(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:PP(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Pe(27497)})(n,e.precondition)),t}function UP(n,e){return n&&n.length>0?(lt(e!==void 0,14353),n.map((t=>(function(o,l){let u=o.updateTime?Hs(o.updateTime):Hs(l);return u.isEqual(Ve.min())&&(u=Hs(l)),new vP(u,o.transformResults||[])})(t,e)))):[]}function OP(n,e){return{documents:[Sb(n,e.path)]}}function jP(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Sb(n,o);const l=(function(h){if(h.length!==0)return Ib(Js.create(h,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(h){if(h.length!==0)return h.map((T=>(function(b){return{field:xa(b.field),direction:BP(b.dir)}})(T)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=fp(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:o}}function FP(n){let e=kP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){lt(i===1,65062);const T=t.from[0];T.allDescendants?o=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(E){const b=wb(E);return b instanceof Js&&ib(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((b=>(function(P){return new Od(ba(P.field),(function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(b)))})(t.orderBy));let f=null;t.limit&&(f=(function(E){let b;return b=typeof E=="object"?E.value:E,of(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(E){const b=!!E.before,w=E.values||[];return new Ud(w,b)})(t.startAt));let h=null;return t.endAt&&(h=(function(E){const b=!E.before,w=E.values||[];return new Ud(w,b)})(t.endAt)),iP(e,o,u,l,f,"F",g,h)}function qP(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ba(t.unaryFilter.field);return Kt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=ba(t.unaryFilter.field);return Kt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ba(t.unaryFilter.field);return Kt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ba(t.unaryFilter.field);return Kt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Kt.create(ba(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Js.create(t.compositeFilter.filters.map((i=>wb(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(t.compositeFilter.op))})(n):Pe(30097,{filter:n})}function BP(n){return NP[n]}function zP(n){return RP[n]}function HP(n){return MP[n]}function xa(n){return{fieldPath:n.canonicalString()}}function ba(n){return nn.fromServerFormat(n.fieldPath)}function Ib(n){return n instanceof Kt?(function(t){if(t.op==="=="){if(jT(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NAN"}};if(OT(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jT(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NOT_NAN"}};if(OT(t.value))return{unaryFilter:{field:xa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xa(t.field),op:zP(t.op),value:t.value}}})(n):n instanceof Js?(function(t){const i=t.getFilters().map((o=>Ib(o)));return i.length===1?i[0]:{compositeFilter:{op:HP(t.op),filters:i}}})(n):Pe(54877,{filter:n})}function GP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Nb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t,i,o,l=Ve.min(),u=Ve.min(),f=sn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=g}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.yt=e}}function $P(n){const e=FP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.Cn=new KP}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Cr.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Cr.min())}updateCollectionGroup(e,t,i){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class KP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Qt(xt.comparator),l=!o.has(i);return this.index[t]=o.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Qt(xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rb=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(Rb,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qa(0)}static cr(){return new qa(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE="LruGarbageCollector",QP=1048576;function tE([n,e],[t,i]){const o=Qe(n,t);return o===0?Qe(e,i):o}class XP{constructor(e){this.Ir=e,this.buffer=new Qt(tE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tE(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WP{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){xe(eE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){el(t)?xe(eE,"Ignoring IndexedDB error during garbage collection: ",t):await Za(t)}await this.Vr(3e5)}))}}class ZP{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return le.resolve(rf.ce);const i=new XP(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(xe("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(ZT)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,l,u,f,g,h;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,u=Date.now(),this.nthSequenceNumber(e,o)))).next((E=>(i=E,f=Date.now(),this.removeTargets(e,i,t)))).next((E=>(l=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(h=Date.now(),Ta()<=Ke.DEBUG&&xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-T}ms
	Determined least recently used ${o} in `+(f-u)+`ms
	Removed ${l} targets in `+(g-f)+`ms
	Removed ${E} documents in `+(h-g)+`ms
Total Duration: ${h-T}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:E}))))}}function ek(n,e){return new ZP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(){this.changes=new Co((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?le.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&yu(i.mutation,o,ps.empty(),vt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Xe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Xe()){const o=po();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((l=>{let u=cu();return l.forEach(((f,g)=>{u=u.insert(f,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=po();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Xe())))}populateOverlays(e,t,i){const o=[];return i.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,i,o){let l=Pi();const u=gu(),f=(function(){return gu()})();return t.forEach(((g,h)=>{const T=i.get(h.key);o.has(h.key)&&(T===void 0||T.mutation instanceof wo)?l=l.insert(h.key,h):T!==void 0?(u.set(h.key,T.mutation.getFieldMask()),yu(T.mutation,h,T.mutation.getFieldMask(),vt.now())):u.set(h.key,ps.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((h,T)=>u.set(h,T))),t.forEach(((h,T)=>f.set(h,new nk(T,u.get(h)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=gu();let o=new Ct(((u,f)=>u-f)),l=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((g=>{const h=t.get(g);if(h===null)return;let T=i.get(g)||ps.empty();T=f.applyToLocalView(h,T),i.set(g,T);const E=(o.get(f.batchId)||Xe()).add(g);o=o.insert(f.batchId,E)}))})).next((()=>{const u=[],f=o.getReverseIterator();for(;f.hasNext();){const g=f.getNext(),h=g.key,T=g.value,E=fb();T.forEach((b=>{if(!l.has(b)){const w=vb(t.get(b),i.get(b));w!==null&&E.set(b,w),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,h,E))}return le.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(u){return Ne.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((l=>{const u=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-l.size):le.resolve(po());let f=Eu,g=l;return u.next((h=>le.forEach(h,((T,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(T)?le.resolve():this.remoteDocumentCache.getEntry(e,T).next((b=>{g=g.insert(T,b)}))))).next((()=>this.populateOverlays(e,h,l))).next((()=>this.computeViews(e,g,h,Xe()))).next((T=>({batchId:f,changes:db(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ne(t)).next((i=>{let o=cu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const l=t.collectionGroup;let u=cu();return this.indexManager.getCollectionParents(e,l).next((f=>le.forEach(f,(g=>{const h=(function(E,b){return new lf(b,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,h,i,o).next((T=>{T.forEach(((E,b)=>{u=u.insert(E,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,o)))).next((u=>{l.forEach(((g,h)=>{const T=h.getKey();u.get(T)===null&&(u=u.insert(T,mn.newInvalidDocument(T)))}));let f=cu();return u.forEach(((g,h)=>{const T=l.get(g);T!==void 0&&yu(T.mutation,h,ps.empty(),vt.now()),cf(t,h)&&(f=f.insert(g,h))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return le.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Hs(o.createTime)}})(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:$P(o.bundledQuery),readTime:Hs(o.readTime)}})(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(){this.overlays=new Ct(Ne.comparator),this.qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const i=po();return le.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&i.set(o,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,l)=>{this.St(e,t,l)})),le.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),le.resolve()}getOverlaysForCollection(e,t,i){const o=po(),l=t.length+1,u=new Ne(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const g=f.getNext().value,h=g.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===l&&g.largestBatchId>i&&o.set(g.getKey(),g)}return le.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let l=new Ct(((h,T)=>h-T));const u=this.overlays.getIterator();for(;u.hasNext();){const h=u.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let T=l.get(h.largestBatchId);T===null&&(T=po(),l=l.insert(h.largestBatchId,T)),T.set(h.getKey(),h)}}const f=po(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((h,T)=>f.set(h,T))),!(f.size()>=o)););return le.resolve(f)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new bP(t,i));let l=this.qr.get(t);l===void 0&&(l=Xe(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.Qr=new Qt(tn.$r),this.Ur=new Qt(tn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new tn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new tn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ne(new xt([])),i=new tn(t,e),o=new tn(t,e+1),l=[];return this.Ur.forEachInRange([i,o],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ne(new xt([])),i=new tn(t,e),o=new tn(t,e+1);let l=Xe();return this.Ur.forEachInRange([i,o],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new tn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class tn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ne.comparator(e.key,t.key)||Qe(e.Yr,t.Yr)}static Kr(e,t){return Qe(e.Yr,t.Yr)||Ne.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(tn.$r)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new xP(l,t,i,o);this.mutationQueue.push(u);for(const f of o)this.Zr=this.Zr.add(new tn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return le.resolve(u)}lookupMutationBatch(e,t){return le.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),l=o<0?0:o;return le.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?jp:this.tr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new tn(t,0),o=new tn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,o],(u=>{const f=this.Xr(u.Yr);l.push(f)})),le.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Qt(Qe);return t.forEach((o=>{const l=new tn(o,0),u=new tn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(f=>{i=i.add(f.Yr)}))})),le.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let l=i;Ne.isDocumentKey(l)||(l=l.child(""));const u=new tn(new Ne(l),0);let f=new Qt(Qe);return this.Zr.forEachWhile((g=>{const h=g.key.path;return!!i.isPrefixOf(h)&&(h.length===o&&(f=f.add(g.Yr)),!0)}),u),le.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return le.forEach(t.mutations,(o=>{const l=new tn(o.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new tn(t,0),o=this.Zr.firstAfterOrEqual(i);return le.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.ri=e,this.docs=(function(){return new Ct(Ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),l=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return le.resolve(i?i.document.mutableCopy():mn.newInvalidDocument(t))}getEntries(e,t){let i=Pi();return t.forEach((o=>{const l=this.docs.get(o);i=i.insert(o,l?l.document.mutableCopy():mn.newInvalidDocument(o))})),le.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let l=Pi();const u=t.path,f=new Ne(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(f);for(;g.hasNext();){const{key:h,value:{document:T}}=g.getNext();if(!u.isPrefixOf(h.path))break;h.path.length>u.length+1||L2(V2(T),i)<=0||(o.has(T.key)||cf(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return le.resolve(l)}getAllFromCollectionGroup(e,t,i,o){Pe(9500)}ii(e,t){return le.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new uk(this)}getSize(e){return le.resolve(this.size)}}class uk extends tk{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),le.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e){this.persistence=e,this.si=new Co((t=>Bp(t)),zp),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new Qp,this.targetCount=0,this.ai=qa.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),le.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new qa(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Pr(t),le.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,i){let o=0;const l=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)})),le.waitFor(l).next((()=>o))}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return le.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),le.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((u=>{l.push(o.markPotentiallyOrphaned(e,u))})),le.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return le.resolve(i)}containsKey(e,t){return le.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,t){this.ui={},this.overlays={},this.ci=new rf(0),this.li=!1,this.li=!0,this.hi=new ok,this.referenceDelegate=e(this),this.Pi=new ck(this),this.indexManager=new JP,this.remoteDocumentCache=(function(o){return new lk(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new YP(t),this.Ii=new ik(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new rk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new ak(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){xe("MemoryPersistence","Starting transaction:",e);const o=new dk(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return le.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class dk extends O2{constructor(e){super(),this.currentSequenceNumber=e}}class Xp{constructor(e){this.persistence=e,this.Ri=new Qp,this.Vi=null}static mi(e){return new Xp(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),le.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.fi,(i=>{const o=Ne.fromPath(i);return this.gi(e,o).next((l=>{l||t.removeEntry(o,Ve.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return le.or([()=>le.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Bd{constructor(e,t){this.persistence=e,this.pi=new Co((i=>q2(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=ek(this,t)}static mi(e,t){return new Bd(e,t)}Ei(){}di(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return le.forEach(this.pi,((i,o)=>this.br(e,i,o).next((l=>l?le.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((f=>{f||(i++,l.removeEntry(u,Ve.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),le.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),le.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Td(e.data.value)),t}br(e,t,i){return le.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return le.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=Xe(),o=Xe();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Wp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return rD()?8:j2(gn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,o,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new fk;return this.Ss(e,t,u).next((f=>{if(l.result=f,this.Vs)return this.bs(e,t,u,f.size)}))})).next((()=>l.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(Ta()<=Ke.DEBUG&&xe("QueryEngine","SDK will not create cache indexes for query:",Ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),le.resolve()):(Ta()<=Ke.DEBUG&&xe("QueryEngine","Query:",Ea(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(Ta()<=Ke.DEBUG&&xe("QueryEngine","The SDK decides to create cache indexes for query:",Ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bs(t))):le.resolve())}ys(e,t){if(zT(t))return le.resolve(null);let i=Bs(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=dp(t,null,"F"),i=Bs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=Xe(...l);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((g=>{const h=this.Ds(t,f);return this.Cs(t,h,u,g.readTime)?this.ys(e,dp(t,null,"F")):this.vs(e,h,t,g)}))))})))))}ws(e,t,i,o){return zT(t)||o.isEqual(Ve.min())?le.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,i,o)?le.resolve(null):(Ta()<=Ke.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ea(t)),this.vs(e,u,t,k2(o,Eu)).next((f=>f)))}))}Ds(e,t){let i=new Qt(ub(e));return t.forEach(((o,l)=>{cf(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,i){return Ta()<=Ke.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",Ea(t)),this.ps.getDocumentsMatchingQuery(e,t,Cr.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="LocalStore",mk=3e8;class pk{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new Ct(Qe),this.xs=new Co((l=>Bp(l)),zp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sk(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function gk(n,e,t,i){return new pk(n,e,t,i)}async function Db(n,e){const t=je(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let g=Xe();for(const h of o){u.push(h.batchId);for(const T of h.mutations)g=g.add(T.key)}for(const h of l){f.push(h.batchId);for(const T of h.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(i,g).next((h=>({Ls:h,removedBatchIds:u,addedBatchIds:f})))}))}))}function yk(n,e){const t=je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,g,h,T){const E=h.batch,b=E.keys();let w=le.resolve();return b.forEach((P=>{w=w.next((()=>T.getEntry(g,P))).next((U=>{const H=h.docVersions.get(P);lt(H!==null,48541),U.version.compareTo(H)<0&&(E.applyToRemoteDocument(U,h),U.isValidDocument()&&(U.setReadTime(h.commitVersion),T.addEntry(U)))}))})),w.next((()=>f.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let g=Xe();for(let h=0;h<f.mutationResults.length;++h)f.mutationResults[h].transformResults.length>0&&(g=g.add(f.batch.mutations[h].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function Pb(n){const e=je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function vk(n,e){const t=je(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const f=[];e.targetChanges.forEach(((T,E)=>{const b=o.get(E);if(!b)return;f.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,E))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?w=w.withResumeToken(sn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):T.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(T.resumeToken,i)),o=o.insert(E,w),(function(U,H,ne){return U.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=mk?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(b,w,T)&&f.push(t.Pi.updateTargetData(l,w))}));let g=Pi(),h=Xe();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),f.push(_k(l,u,e.documentUpdates).next((T=>{g=T.ks,h=T.qs}))),!i.isEqual(Ve.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((E=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(T)}return le.waitFor(f).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,h))).next((()=>g))})).then((l=>(t.Ms=o,l)))}function _k(n,e,t){let i=Xe(),o=Xe();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=Pi();return t.forEach(((f,g)=>{const h=l.get(f);g.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(f)),g.isNoDocument()&&g.version.isEqual(Ve.min())?(e.removeEntry(f,g.readTime),u=u.insert(f,g)):!h.isValidDocument()||g.version.compareTo(h.version)>0||g.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(g),u=u.insert(f,g)):xe(Zp,"Ignoring outdated watch update for ",f,". Current version:",h.version," Watch version:",g.version)})),{ks:u,qs:o}}))}function Tk(n,e){const t=je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=jp),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Ek(n,e){const t=je(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((l=>l?(o=l,le.resolve(o)):t.Pi.allocateTargetId(i).next((u=>(o=new Tr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function gp(n,e,t){const i=je(n),o=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!el(u))throw u;xe(Zp,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function nE(n,e,t){const i=je(n);let o=Ve.min(),l=Xe();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,h,T){const E=je(g),b=E.xs.get(T);return b!==void 0?le.resolve(E.Ms.get(b)):E.Pi.getTargetData(h,T)})(i,u,Bs(e)).next((f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?o:Ve.min(),t?l:Xe()))).next((f=>(xk(i,aP(e),f),{documents:f,Qs:l})))))}function xk(n,e,t){let i=n.Os.get(e)||Ve.min();t.forEach(((o,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class sE{constructor(){this.activeTargetIds=hP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bk{constructor(){this.Mo=new sE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new sE,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="ConnectivityMonitor";class rE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){xe(iE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){xe(iE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hd=null;function yp(){return hd===null?hd=(function(){return 268435456+Math.round(2147483648*Math.random())})():hd++,"0x"+hd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="RestConnection",Sk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ck{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===Vd?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,l){const u=yp(),f=this.zo(e,t.toUriEncodedString());xe(Vm,`Sending RPC '${e}' ${u}:`,f,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,o,l);const{host:h}=new URL(f),T=Qa(h);return this.Jo(e,f,g,i,T).then((E=>(xe(Vm,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw Eo(Vm,`RPC '${e}' ${u} failed with error: `,E,"url: ",f,"request:",i),E}))}Ho(e,t,i,o,l,u){return this.Go(e,t,i,o,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wa})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),i&&i.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const i=Sk[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="WebChannelConnection";class Ik extends Ck{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,l){const u=yp();return new Promise(((f,g)=>{const h=new Vx;h.setWithCredentials(!0),h.listenOnce(Lx.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case _d.NO_ERROR:const E=h.getResponseJson();xe(fn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),f(E);break;case _d.TIMEOUT:xe(fn,`RPC '${e}' ${u} timed out`),g(new Ce(ue.DEADLINE_EXCEEDED,"Request time out"));break;case _d.HTTP_ERROR:const b=h.getStatus();if(xe(fn,`RPC '${e}' ${u} failed with status:`,b,"response text:",h.getResponseText()),b>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const P=w==null?void 0:w.error;if(P&&P.status&&P.message){const U=(function(ne){const F=ne.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(F)>=0?F:ue.UNKNOWN})(P.status);g(new Ce(U,P.message))}else g(new Ce(ue.UNKNOWN,"Server responded with status "+h.getStatus()))}else g(new Ce(ue.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:u,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{xe(fn,`RPC '${e}' ${u} completed.`)}}));const T=JSON.stringify(o);xe(fn,`RPC '${e}' ${u} sending request:`,o),h.send(t,"POST",T,i,15)}))}T_(e,t,i){const o=yp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=jx(),f=Ox(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(g.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const T=l.join("");xe(fn,`Creating RPC '${e}' stream ${o}: ${T}`,g);const E=u.createWebChannel(T,g);this.I_(E);let b=!1,w=!1;const P=new wk({Yo:H=>{w?xe(fn,`Not sending because RPC '${e}' stream ${o} is closed:`,H):(b||(xe(fn,`Opening RPC '${e}' stream ${o} transport.`),E.open(),b=!0),xe(fn,`RPC '${e}' stream ${o} sending:`,H),E.send(H))},Zo:()=>E.close()}),U=(H,ne,F)=>{H.listen(ne,(O=>{try{F(O)}catch(z){setTimeout((()=>{throw z}),0)}}))};return U(E,uu.EventType.OPEN,(()=>{w||(xe(fn,`RPC '${e}' stream ${o} transport opened.`),P.o_())})),U(E,uu.EventType.CLOSE,(()=>{w||(w=!0,xe(fn,`RPC '${e}' stream ${o} transport closed`),P.a_(),this.E_(E))})),U(E,uu.EventType.ERROR,(H=>{w||(w=!0,Eo(fn,`RPC '${e}' stream ${o} transport errored. Name:`,H.name,"Message:",H.message),P.a_(new Ce(ue.UNAVAILABLE,"The operation could not be completed")))})),U(E,uu.EventType.MESSAGE,(H=>{var ne;if(!w){const F=H.data[0];lt(!!F,16349);const O=F,z=(O==null?void 0:O.error)||((ne=O[0])==null?void 0:ne.error);if(z){xe(fn,`RPC '${e}' stream ${o} received error:`,z);const Z=z.status;let W=(function(N){const k=Gt[N];if(k!==void 0)return Tb(k)})(Z),R=z.message;W===void 0&&(W=ue.INTERNAL,R="Unknown error status: "+Z+" with message "+z.message),w=!0,P.a_(new Ce(W,R)),E.close()}else xe(fn,`RPC '${e}' stream ${o} received:`,F),P.u_(F)}})),U(f,Ux.STAT_EVENT,(H=>{H.stat===rp.PROXY?xe(fn,`RPC '${e}' stream ${o} detected buffering proxy`):H.stat===rp.NOPROXY&&xe(fn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Lm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(n){return new DP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,t,i=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&xe("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE="PersistentStream";class Vb{constructor(e,t,i,o,l,u,f,g){this.Mi=e,this.S_=i,this.b_=o,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new kb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Mi(t.toString()),Mi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ce(ue.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return xe(oE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(xe(oE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Nk extends Vb{constructor(e,t,i,o,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=VP(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ve.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ve.min():u.readTime?Hs(u.readTime):Ve.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=pp(this.serializer),t.addTarget=(function(l,u){let f;const g=u.target;if(f=cp(g)?{documents:OP(l,g)}:{query:jP(l,g).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=bb(l,u.resumeToken);const h=fp(l,u.expectedCount);h!==null&&(f.expectedCount=h)}else if(u.snapshotVersion.compareTo(Ve.min())>0){f.readTime=qd(l,u.snapshotVersion.toTimestamp());const h=fp(l,u.expectedCount);h!==null&&(f.expectedCount=h)}return f})(this.serializer,e);const i=qP(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=pp(this.serializer),t.removeTarget=e,this.q_(t)}}class Rk extends Vb{constructor(e,t,i,o,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=UP(e.writeResults,e.commitTime),i=Hs(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=pp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>LP(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{}class Dk extends Mk{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,hp(t,i),o,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ce(ue.UNKNOWN,l.toString())}))}Ho(e,t,i,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,hp(t,i),o,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(ue.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Pk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mi(t),this.aa=!1):xe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo="RemoteStore";class kk{constructor(e,t,i,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Io(this)&&(xe(xo,"Restarting streams for network reachability change."),await(async function(g){const h=je(g);h.Ea.add(4),await Du(h),h.Ra.set("Unknown"),h.Ea.delete(4),await pf(h)})(this))}))})),this.Ra=new Pk(i,o)}}async function pf(n){if(Io(n))for(const e of n.da)await e(!0)}async function Du(n){for(const e of n.da)await e(!1)}function Lb(n,e){const t=je(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sg(t)?ng(t):tl(t).O_()&&tg(t,e))}function eg(n,e){const t=je(n),i=tl(t);t.Ia.delete(e),i.O_()&&Ub(t,e),t.Ia.size===0&&(i.O_()?i.L_():Io(t)&&t.Ra.set("Unknown"))}function tg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(n).Y_(e)}function Ub(n,e){n.Va.Ue(e),tl(n).Z_(e)}function ng(n){n.Va=new IP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),tl(n).start(),n.Ra.ua()}function sg(n){return Io(n)&&!tl(n).x_()&&n.Ia.size>0}function Io(n){return je(n).Ea.size===0}function Ob(n){n.Va=void 0}async function Vk(n){n.Ra.set("Online")}async function Lk(n){n.Ia.forEach(((e,t)=>{tg(n,e)}))}async function Uk(n,e){Ob(n),sg(n)?(n.Ra.ha(e),ng(n)):n.Ra.set("Unknown")}async function Ok(n,e,t){if(n.Ra.set("Online"),e instanceof xb&&e.state===2&&e.cause)try{await(async function(o,l){const u=l.cause;for(const f of l.targetIds)o.Ia.has(f)&&(await o.remoteSyncer.rejectListen(f,u),o.Ia.delete(f),o.Va.removeTarget(f))})(n,e)}catch(i){xe(xo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await zd(n,i)}else if(e instanceof bd?n.Va.Ze(e):e instanceof Eb?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ve.min()))try{const i=await Pb(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const f=l.Va.Tt(u);return f.targetChanges.forEach(((g,h)=>{if(g.resumeToken.approximateByteSize()>0){const T=l.Ia.get(h);T&&l.Ia.set(h,T.withResumeToken(g.resumeToken,u))}})),f.targetMismatches.forEach(((g,h)=>{const T=l.Ia.get(g);if(!T)return;l.Ia.set(g,T.withResumeToken(sn.EMPTY_BYTE_STRING,T.snapshotVersion)),Ub(l,g);const E=new Tr(T.target,g,h,T.sequenceNumber);tg(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(i){xe(xo,"Failed to raise snapshot:",i),await zd(n,i)}}async function zd(n,e,t){if(!el(e))throw e;n.Ea.add(1),await Du(n),n.Ra.set("Offline"),t||(t=()=>Pb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{xe(xo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await pf(n)}))}function jb(n,e){return e().catch((t=>zd(n,t,e)))}async function gf(n){const e=je(n),t=Rr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jp;for(;jk(e);)try{const o=await Tk(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,Fk(e,o)}catch(o){await zd(e,o)}Fb(e)&&qb(e)}function jk(n){return Io(n)&&n.Ta.length<10}function Fk(n,e){n.Ta.push(e);const t=Rr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Fb(n){return Io(n)&&!Rr(n).x_()&&n.Ta.length>0}function qb(n){Rr(n).start()}async function qk(n){Rr(n).ra()}async function Bk(n){const e=Rr(n);for(const t of n.Ta)e.ea(t.mutations)}async function zk(n,e,t){const i=n.Ta.shift(),o=$p.from(i,e,t);await jb(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await gf(n)}async function Hk(n,e){e&&Rr(n).X_&&await(async function(i,o){if((function(u){return SP(u)&&u!==ue.ABORTED})(o.code)){const l=i.Ta.shift();Rr(i).B_(),await jb(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,o))),await gf(i)}})(n,e),Fb(n)&&qb(n)}async function aE(n,e){const t=je(n);t.asyncQueue.verifyOperationInProgress(),xe(xo,"RemoteStore received new credentials");const i=Io(t);t.Ea.add(3),await Du(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await pf(t)}async function Gk(n,e){const t=je(n);e?(t.Ea.delete(2),await pf(t)):e||(t.Ea.add(2),await Du(t),t.Ra.set("Unknown"))}function tl(n){return n.ma||(n.ma=(function(t,i,o){const l=je(t);return l.sa(),new Nk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:Vk.bind(null,n),t_:Lk.bind(null,n),r_:Uk.bind(null,n),H_:Ok.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),sg(n)?ng(n):n.Ra.set("Unknown")):(await n.ma.stop(),Ob(n))}))),n.ma}function Rr(n){return n.fa||(n.fa=(function(t,i,o){const l=je(t);return l.sa(),new Rk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:qk.bind(null,n),r_:Hk.bind(null,n),ta:Bk.bind(null,n),na:zk.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await gf(n)):(await n.fa.stop(),n.Ta.length>0&&(xe(xo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t,i,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=l,this.deferred=new wi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,l){const u=Date.now()+i,f=new ig(e,t,u,o,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rg(n,e){if(Mi("AsyncQueue",`${e}: ${n}`),el(n))return new Ce(ue.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{static emptySet(e){return new Ma(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ne.comparator(t.key,i.key):(t,i)=>Ne.comparator(t.key,i.key),this.keyedMap=cu(),this.sortedSet=new Ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ma)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ma;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(){this.ga=new Ct(Ne.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Ba{constructor(e,t,i,o,l,u,f,g,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=g,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,o,l){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new Ba(e,t,Ma.emptySet(t),u,i,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class $k{constructor(){this.queries=uE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=je(t),l=o.queries;o.queries=uE(),l.forEach(((u,f)=>{for(const g of f.Sa)g.onError(i)}))})(this,new Ce(ue.ABORTED,"Firestore shutting down"))}}function uE(){return new Co((n=>lb(n)),uf)}async function Bb(n,e){const t=je(n);let i=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(i=2):(l=new Yk,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const f=rg(u,`Initialization of query '${Ea(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&og(t)}async function zb(n,e){const t=je(n),i=e.query;let o=3;const l=t.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Jk(n,e){const t=je(n);let i=!1;for(const o of e){const l=o.query,u=t.queries.get(l);if(u){for(const f of u.Sa)f.Fa(o)&&(i=!0);u.wa=o}}i&&og(t)}function Kk(n,e,t){const i=je(n),o=i.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);i.queries.delete(e)}function og(n){n.Ca.forEach((e=>{e.next()}))}var vp,cE;(cE=vp||(vp={})).Ma="default",cE.Cache="cache";class Hb{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Ba(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e){this.key=e}}class Yb{constructor(e){this.key=e}}class Qk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=ub(e),this.tu=new Ma(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new lE,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=o,f=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((T,E)=>{const b=o.get(T),w=cf(this.query,E)?E:null,P=!!b&&this.mutatedKeys.has(b.key),U=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let H=!1;b&&w?b.data.isEqual(w.data)?P!==U&&(i.track({type:3,doc:w}),H=!0):this.su(b,w)||(i.track({type:2,doc:w}),H=!0,(g&&this.eu(w,g)>0||h&&this.eu(w,h)<0)&&(f=!0)):!b&&w?(i.track({type:0,doc:w}),H=!0):b&&!w&&(i.track({type:1,doc:b}),H=!0,(g||h)&&(f=!0)),H&&(w?(u=u.add(w),l=U?l.add(T):l.delete(T)):(u=u.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const T=this.query.limitType==="F"?u.last():u.first();u=u.delete(T.key),l=l.delete(T.key),i.track({type:1,doc:T})}return{tu:u,iu:i,Cs:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((T,E)=>(function(w,P){const U=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:H})}};return U(w)-U(P)})(T.type,E.type)||this.eu(T.doc,E.doc))),this.ou(i),o=o??!1;const f=t&&!o?this._u():[],g=this.Xa.size===0&&this.current&&!o?1:0,h=g!==this.Za;return this.Za=g,u.length!==0||h?{snapshot:new Ba(this.query,e.tu,l,u,e.mutatedKeys,g===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Yb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Gb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Xe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ba.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ag="SyncEngine";class Xk{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Wk{constructor(e){this.key=e,this.hu=!1}}class Zk{constructor(e,t,i,o,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Co((f=>lb(f)),uf),this.Iu=new Map,this.Eu=new Set,this.du=new Ct(Ne.comparator),this.Au=new Map,this.Ru=new Qp,this.Vu={},this.mu=new Map,this.fu=qa.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function eV(n,e,t=!0){const i=Wb(n);let o;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await $b(i,e,t,!0),o}async function tV(n,e){const t=Wb(n);await $b(t,e,!0,!1)}async function $b(n,e,t,i){const o=await Ek(n.localStore,Bs(e)),l=o.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let f;return i&&(f=await nV(n,e,l,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&Lb(n.remoteStore,o),f}async function nV(n,e,t,i,o){n.pu=(E,b,w)=>(async function(U,H,ne,F){let O=H.view.ru(ne);O.Cs&&(O=await nE(U.localStore,H.query,!1).then((({documents:R})=>H.view.ru(R,O))));const z=F&&F.targetChanges.get(H.targetId),Z=F&&F.targetMismatches.get(H.targetId)!=null,W=H.view.applyChanges(O,U.isPrimaryClient,z,Z);return fE(U,H.targetId,W.au),W.snapshot})(n,E,b,w);const l=await nE(n.localStore,e,!0),u=new Qk(e,l.Qs),f=u.ru(l.documents),g=Mu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),h=u.applyChanges(f,n.isPrimaryClient,g);fE(n,t,h.au);const T=new Xk(e,t,u);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function sV(n,e,t){const i=je(n),o=i.Tu.get(e),l=i.Iu.get(o.targetId);if(l.length>1)return i.Iu.set(o.targetId,l.filter((u=>!uf(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await gp(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&eg(i.remoteStore,o.targetId),_p(i,o.targetId)})).catch(Za)):(_p(i,o.targetId),await gp(i.localStore,o.targetId,!0))}async function iV(n,e){const t=je(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),eg(t.remoteStore,i.targetId))}async function rV(n,e,t){const i=fV(n);try{const o=await(function(u,f){const g=je(u),h=vt.now(),T=f.reduce(((w,P)=>w.add(P.key)),Xe());let E,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let P=Pi(),U=Xe();return g.Ns.getEntries(w,T).next((H=>{P=H,P.forEach(((ne,F)=>{F.isValidDocument()||(U=U.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(w,P))).next((H=>{E=H;const ne=[];for(const F of f){const O=TP(F,E.get(F.key).overlayedDocument);O!=null&&ne.push(new wo(F.key,O,tb(O.value.mapValue),zs.exists(!0)))}return g.mutationQueue.addMutationBatch(w,h,ne,f)})).next((H=>{b=H;const ne=H.applyToLocalDocumentSet(E,U);return g.documentOverlayCache.saveOverlays(w,H.batchId,ne)}))})).then((()=>({batchId:b.batchId,changes:db(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(u,f,g){let h=u.Vu[u.currentUser.toKey()];h||(h=new Ct(Qe)),h=h.insert(f,g),u.Vu[u.currentUser.toKey()]=h})(i,o.batchId,t),await Pu(i,o.changes),await gf(i.remoteStore)}catch(o){const l=rg(o,"Failed to persist write");t.reject(l)}}async function Jb(n,e){const t=je(n);try{const i=await vk(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const u=t.Au.get(l);u&&(lt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?lt(u.hu,14607):o.removedDocuments.size>0&&(lt(u.hu,42227),u.hu=!1))})),await Pu(t,i,e)}catch(i){await Za(i)}}function dE(n,e,t){const i=je(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&o.push(f.snapshot)})),(function(u,f){const g=je(u);g.onlineState=f;let h=!1;g.queries.forEach(((T,E)=>{for(const b of E.Sa)b.va(f)&&(h=!0)})),h&&og(g)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function oV(n,e,t){const i=je(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),l=o&&o.key;if(l){let u=new Ct(Ne.comparator);u=u.insert(l,mn.newNoDocument(l,Ve.min()));const f=Xe().add(l),g=new hf(Ve.min(),new Map,new Ct(Qe),u,f);await Jb(i,g),i.du=i.du.remove(l),i.Au.delete(e),lg(i)}else await gp(i.localStore,e,!1).then((()=>_p(i,e,t))).catch(Za)}async function aV(n,e){const t=je(n),i=e.batch.batchId;try{const o=await yk(t.localStore,e);Qb(t,i,null),Kb(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Pu(t,o)}catch(o){await Za(o)}}async function lV(n,e,t){const i=je(n);try{const o=await(function(u,f){const g=je(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let T;return g.mutationQueue.lookupMutationBatch(h,f).next((E=>(lt(E!==null,37113),T=E.keys(),g.mutationQueue.removeMutationBatch(h,E)))).next((()=>g.mutationQueue.performConsistencyCheck(h))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(h,T,f))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,T))).next((()=>g.localDocuments.getDocuments(h,T)))}))})(i.localStore,e);Qb(i,e,t),Kb(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Pu(i,o)}catch(o){await Za(o)}}function Kb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Qb(n,e,t){const i=je(n);let o=i.Vu[i.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),i.Vu[i.currentUser.toKey()]=o}}function _p(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Xb(n,i)}))}function Xb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(eg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),lg(n))}function fE(n,e,t){for(const i of t)i instanceof Gb?(n.Ru.addReference(i.key,e),uV(n,i)):i instanceof Yb?(xe(ag,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Xb(n,i.key)):Pe(19791,{wu:i})}function uV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(xe(ag,"New document in limbo: "+t),n.Eu.add(i),lg(n))}function lg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ne(xt.fromString(e)),i=n.fu.next();n.Au.set(i,new Wk(t)),n.du=n.du.insert(t,i),Lb(n.remoteStore,new Tr(Bs(Hp(t.path)),i,"TargetPurposeLimboResolution",rf.ce))}}async function Pu(n,e,t){const i=je(n),o=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,g)=>{u.push(i.pu(g,e,t).then((h=>{var T;if((h||t)&&i.isPrimaryClient){const E=h?!h.fromCache:(T=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:T.current;i.sharedClientState.updateQueryState(g.targetId,E?"current":"not-current")}if(h){o.push(h);const E=Wp.As(g.targetId,h);l.push(E)}})))})),await Promise.all(u),i.Pu.H_(o),await(async function(g,h){const T=je(g);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>le.forEach(h,(b=>le.forEach(b.Es,(w=>T.persistence.referenceDelegate.addReference(E,b.targetId,w))).next((()=>le.forEach(b.ds,(w=>T.persistence.referenceDelegate.removeReference(E,b.targetId,w)))))))))}catch(E){if(!el(E))throw E;xe(Zp,"Failed to update sequence numbers: "+E)}for(const E of h){const b=E.targetId;if(!E.fromCache){const w=T.Ms.get(b),P=w.snapshotVersion,U=w.withLastLimboFreeSnapshotVersion(P);T.Ms=T.Ms.insert(b,U)}}})(i.localStore,l))}async function cV(n,e){const t=je(n);if(!t.currentUser.isEqual(e)){xe(ag,"User change. New user:",e.toKey());const i=await Db(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((g=>{g.reject(new Ce(ue.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Pu(t,i.Ls)}}function dV(n,e){const t=je(n),i=t.Au.get(e);if(i&&i.hu)return Xe().add(i.key);{let o=Xe();const l=t.Iu.get(e);if(!l)return o;for(const u of l){const f=t.Tu.get(u);o=o.unionWith(f.view.nu)}return o}}function Wb(n){const e=je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oV.bind(null,e),e.Pu.H_=Jk.bind(null,e.eventManager),e.Pu.yu=Kk.bind(null,e.eventManager),e}function fV(n){const e=je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lV.bind(null,e),e}class Hd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return gk(this.persistence,new hk,e.initialUser,this.serializer)}Cu(e){return new Mb(Xp.mi,this.serializer)}Du(e){return new bk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hd.provider={build:()=>new Hd};class hV extends Hd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){lt(this.persistence.referenceDelegate instanceof Bd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new WP(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new Mb((i=>Bd.mi(i,t)),this.serializer)}}class Tp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=cV.bind(null,this.syncEngine),await Gk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new $k})()}createDatastore(e){const t=mf(e.databaseInfo.databaseId),i=(function(l){return new Ik(l)})(e.databaseInfo);return(function(l,u,f,g){return new Dk(l,u,f,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,l,u,f){return new kk(i,o,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>dE(this.syncEngine,t,0)),(function(){return rE.v()?new rE:new Ak})())}createSyncEngine(e,t){return(function(o,l,u,f,g,h,T){const E=new Zk(o,l,u,f,g,h);return T&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const l=je(o);xe(xo,"RemoteStore shutting down."),l.Ea.add(5),await Du(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class mV{constructor(e,t,i,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=hn.UNAUTHENTICATED,this.clientId=sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{xe(Mr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(xe(Mr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=rg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Um(n,e){n.asyncQueue.verifyOperationInProgress(),xe(Mr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Db(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function hE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await pV(n);xe(Mr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>aE(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>aE(e.remoteStore,o))),n._onlineComponents=e}async function pV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){xe(Mr,"Using user provided OfflineComponentProvider");try{await Um(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ue.FAILED_PRECONDITION||o.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Eo("Error using user provided cache. Falling back to memory cache: "+t),await Um(n,new Hd)}}else xe(Mr,"Using default OfflineComponentProvider"),await Um(n,new hV(void 0));return n._offlineComponents}async function eA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(xe(Mr,"Using user provided OnlineComponentProvider"),await hE(n,n._uninitializedComponentsProvider._online)):(xe(Mr,"Using default OnlineComponentProvider"),await hE(n,new Tp))),n._onlineComponents}function gV(n){return eA(n).then((e=>e.syncEngine))}async function tA(n){const e=await eA(n),t=e.eventManager;return t.onListen=eV.bind(null,e.syncEngine),t.onUnlisten=sV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=iV.bind(null,e.syncEngine),t}function yV(n,e,t={}){const i=new wi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,h){const T=new Zb({next:b=>{T.Nu(),u.enqueueAndForget((()=>zb(l,E)));const w=b.docs.has(f);!w&&b.fromCache?h.reject(new Ce(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&g&&g.source==="server"?h.reject(new Ce(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(b)},error:b=>h.reject(b)}),E=new Hb(Hp(f.path),T,{includeMetadataChanges:!0,qa:!0});return Bb(l,E)})(await tA(n),n.asyncQueue,e,t,i))),i.promise}function vV(n,e,t={}){const i=new wi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,h){const T=new Zb({next:b=>{T.Nu(),u.enqueueAndForget((()=>zb(l,E))),b.fromCache&&g.source==="server"?h.reject(new Ce(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(b)},error:b=>h.reject(b)}),E=new Hb(f,T,{includeMetadataChanges:!0,qa:!0});return Bb(l,E)})(await tA(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="firestore.googleapis.com",pE=!0;class gE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sA,this.ssl=pE}else this.host=e.host,this.ssl=e.ssl??pE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Rb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QP)throw new Ce(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Hx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Bx;switch(i.type){case"firstParty":return new I2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=mE.get(t);i&&(xe("ComponentProvider","Removing Datastore"),mE.delete(t),i.terminate())})(this),Promise.resolve()}}function iA(n,e,t,i={}){var h;n=Di(n,yf);const o=Qa(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;o&&(Cx(`https://${f}`),wx("Firestore",!0)),l.host!==sA&&l.host!==f&&Eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:f,ssl:o,emulatorOptions:i};if(!vo(g,u)&&(n._setSettings(g),i.mockUserToken)){let T,E;if(typeof i.mockUserToken=="string")T=i.mockUserToken,E=hn.MOCK_USER;else{T=QM(i.mockUserToken,(h=n._app)==null?void 0:h.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Ce(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new hn(b)}n._authCredentials=new S2(new qx(T,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ku(this.firestore,e,this._query)}}class $t{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ii(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $t(this.firestore,e,this._key)}toJSON(){return{type:$t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Nu(t,$t._jsonSchema))return new $t(e,i||null,new Ne(xt.fromString(t.referencePath)))}}$t._jsonSchemaVersion="firestore/documentReference/1.0",$t._jsonSchema={type:Yt("string",$t._jsonSchemaVersion),referencePath:Yt("string")};class Ii extends ku{constructor(e,t,i){super(e,t,Hp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $t(this.firestore,null,new Ne(e))}withConverter(e){return new Ii(this.firestore,e,this._path)}}function _V(n,e,...t){if(n=_n(n),zx("collection","path",e),n instanceof yf){const i=xt.fromString(e,...t);return RT(i),new Ii(n,null,i)}{if(!(n instanceof $t||n instanceof Ii))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(xt.fromString(e,...t));return RT(i),new Ii(n.firestore,null,i)}}function TV(n,e,...t){if(n=_n(n),arguments.length===1&&(e=sf.newId()),zx("doc","path",e),n instanceof yf){const i=xt.fromString(e,...t);return NT(i),new $t(n,null,new Ne(i))}{if(!(n instanceof $t||n instanceof Ii))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(xt.fromString(e,...t));return NT(i),new $t(n.firestore,n instanceof Ii?n.converter:null,new Ne(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="AsyncQueue";class vE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kb(this,"async_queue_retry"),this._c=()=>{const i=Lm();i&&xe(yE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Lm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Lm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new wi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!el(e))throw e;xe(yE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Mi("INTERNAL UNHANDLED ERROR: ",_E(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=ig.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&Pe(47125,{Pc:_E(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _E(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class nl extends yf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new vE,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vE(e),this._firestoreClient=void 0,await e}}}function rA(n,e){const t=typeof n=="object"?n:Mx(),i=typeof n=="string"?n:Vd,o=Lp(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const l=JM("firestore");l&&iA(o,...l)}return o}function vf(n){if(n._terminated)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||EV(n),n._firestoreClient}function EV(n){var i,o,l;const e=n._freezeSettings(),t=(function(f,g,h,T){return new H2(f,g,h,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,nA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const g=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jn(sn.fromBase64String(e))}catch(t){throw new Ce(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new jn(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nu(e,jn._jsonSchema))return jn.fromBase64String(e.bytes)}}jn._jsonSchemaVersion="firestore/bytes/1.0",jn._jsonSchema={type:Yt("string",jn._jsonSchemaVersion),bytes:Yt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Qe(this._lat,e._lat)||Qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ys._jsonSchemaVersion}}static fromJSON(e){if(Nu(e,ys._jsonSchema))return new ys(e.latitude,e.longitude)}}ys._jsonSchemaVersion="firestore/geoPoint/1.0",ys._jsonSchema={type:Yt("string",ys._jsonSchemaVersion),latitude:Yt("number"),longitude:Yt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:vs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nu(e,vs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new vs(e.vectorValues);throw new Ce(ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vs._jsonSchemaVersion="firestore/vectorValue/1.0",vs._jsonSchema={type:Yt("string",vs._jsonSchemaVersion),vectorValues:Yt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV=/^__.*__$/;class bV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ru(e,this.data,t,this.fieldTransforms)}}function oA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:n})}}class cg{constructor(e,t,i,o,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oA(this.Ac)&&xV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class AV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||mf(e)}Cc(e,t,i,o=!1){return new cg({Ac:e,methodName:t,Dc:i,path:nn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function SV(n){const e=n._freezeSettings(),t=mf(n._databaseId);return new AV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function CV(n,e,t,i,o,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);cA("Data must be an object, but it was:",u,i);const f=lA(i,u);let g,h;if(l.merge)g=new ps(u.fieldMask),h=u.fieldTransforms;else if(l.mergeFields){const T=[];for(const E of l.mergeFields){const b=wV(e,E,t);if(!u.contains(b))throw new Ce(ue.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);NV(T,b)||T.push(b)}g=new ps(T),h=u.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,h=u.fieldTransforms;return new bV(new ts(f),g,h)}function aA(n,e){if(uA(n=_n(n)))return cA("Unsupported field value:",e,n),lA(n,e);if(n instanceof ug)return(function(i,o){if(!oA(o.Ac))throw o.Sc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,o){const l=[];let u=0;for(const f of i){let g=aA(f,o.wc(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,o){if((i=_n(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return mP(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=vt.fromDate(i);return{timestampValue:qd(o.serializer,l)}}if(i instanceof vt){const l=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:qd(o.serializer,l)}}if(i instanceof ys)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof jn)return{bytesValue:bb(o.serializer,i._byteString)};if(i instanceof $t){const l=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Kp(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof vs)return(function(u,f){return{mapValue:{fields:{[Zx]:{stringValue:eb},[Ld]:{arrayValue:{values:u.toArray().map((h=>{if(typeof h!="number")throw f.Sc("VectorValues must only contain numeric values.");return Gp(f.serializer,h)}))}}}}}})(i,o);throw o.Sc(`Unsupported field value: ${Op(i)}`)})(n,e)}function lA(n,e){const t={};return $x(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):So(n,((i,o)=>{const l=aA(o,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function uA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof ys||n instanceof jn||n instanceof $t||n instanceof ug||n instanceof vs)}function cA(n,e,t){if(!uA(t)||!Gx(t)){const i=Op(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function wV(n,e,t){if((e=_n(e))instanceof _f)return e._internalPath;if(typeof e=="string")return dA(n,e);throw Gd("Field path arguments must be of type string or ",n,!1,void 0,t)}const IV=new RegExp("[~\\*/\\[\\]]");function dA(n,e,t){if(e.search(IV)>=0)throw Gd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _f(...e.split("."))._internalPath}catch{throw Gd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gd(n,e,t,i,o){const l=i&&!i.isEmpty(),u=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${o}`),g+=")"),new Ce(ue.INVALID_ARGUMENT,f+n+g)}function NV(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,i,o,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new $t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class RV extends fA{data(){return super.data()}}function hA(n,e){return typeof e=="string"?dA(n,e):e instanceof _f?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mA{convertValue(e,t="none"){switch(Nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return So(e,((o,l)=>{i[o]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,o,l;const t=(l=(o=(i=e.fields)==null?void 0:i[Ld].arrayValue)==null?void 0:o.values)==null?void 0:l.map((u=>Vt(u.doubleValue)));return new vs(t)}convertGeoPoint(e){return new ys(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=af(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(xu(e));default:return null}}convertTimestamp(e){const t=wr(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=xt.fromString(e);lt(Nb(i),9688,{name:e});const o=new Oa(i.get(1),i.get(3)),l=new Ne(i.popFirst(5));return o.isEqual(t)||Mi(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Sa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sr extends fA{constructor(e,t,i,o,l,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(hA("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Sr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Sr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Sr._jsonSchema={type:Yt("string",Sr._jsonSchemaVersion),bundleSource:Yt("string","DocumentSnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class vu extends Sr{data(e={}){return super.data(e)}}class go{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Sa(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new vu(this._firestore,this._userDataWriter,i.key,i,new Sa(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((f=>{const g=new vu(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Sa(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const g=new vu(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Sa(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,T=-1;return f.type!==0&&(h=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),T=u.indexOf(f.doc.key)),{type:PV(f.type),doc:g,oldIndex:h,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=go._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kV(n){n=Di(n,$t);const e=Di(n.firestore,nl);return yV(vf(e),n._key).then((t=>OV(e,n,t)))}go._jsonSchemaVersion="firestore/querySnapshot/1.0",go._jsonSchema={type:Yt("string",go._jsonSchemaVersion),bundleSource:Yt("string","QuerySnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class pA extends mA{constructor(e){super(),this.firestore=e}convertBytes(e){return new jn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new $t(this.firestore,null,t)}}function VV(n){n=Di(n,ku);const e=Di(n.firestore,nl),t=vf(e),i=new pA(e);return MV(n._query),vV(t,n._query).then((o=>new go(e,i,n,o)))}function LV(n,e,t){n=Di(n,$t);const i=Di(n.firestore,nl),o=DV(n.converter,e,t);return dg(i,[CV(SV(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,zs.none())])}function UV(n){return dg(Di(n.firestore,nl),[new Yp(n._key,zs.none())])}function dg(n,e){return(function(i,o){const l=new wi;return i.asyncQueue.enqueueAndForget((async()=>rV(await gV(i),o,l))),l.promise})(vf(n),e)}function OV(n,e,t){const i=t.docs.get(e._key),o=new pA(n);return new Sr(n,o,e._key,i,new Sa(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){Wa=o})(Xa),La(new _o("firestore",((i,{instanceIdentifier:o,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new nl(new C2(i.getProvider("auth-internal")),new N2(u,i.getProvider("app-check-internal")),(function(h,T){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ce(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oa(h.options.projectId,T)})(u,o),u);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),br(ST,CT,e),br(ST,CT,"esm2020")})();const md=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:mA,Bytes:jn,CollectionReference:Ii,DocumentReference:$t,DocumentSnapshot:Sr,FieldPath:_f,FieldValue:ug,Firestore:nl,FirestoreError:Ce,GeoPoint:ys,Query:ku,QueryDocumentSnapshot:vu,QuerySnapshot:go,SnapshotMetadata:Sa,Timestamp:vt,VectorValue:vs,_AutoId:sf,_ByteString:sn,_DatabaseId:Oa,_DocumentKey:Ne,_EmptyAuthCredentialsProvider:Bx,_FieldPath:nn,_cast:Di,_logWarn:Eo,_validateIsNotUsedTogether:Hx,collection:_V,connectFirestoreEmulator:iA,deleteDoc:UV,doc:TV,ensureFirestoreConfigured:vf,executeWrite:dg,getDoc:kV,getDocs:VV,getFirestore:rA,setDoc:LV},Symbol.toStringTag,{value:"Module"}));function gA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yA=gA,vA=new wu("auth","Firebase",gA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=new kp("@firebase/auth");function jV(n,...e){Yd.logLevel<=Ke.WARN&&Yd.warn(`Auth (${Xa}): ${n}`,...e)}function Ad(n,...e){Yd.logLevel<=Ke.ERROR&&Yd.error(`Auth (${Xa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(n,...e){throw fg(n,...e)}function Gs(n,...e){return fg(n,...e)}function _A(n,e,t){const i={...yA(),[e]:t};return new wu("auth","Firebase",i).create(e,{appName:n.name})}function Ni(n){return _A(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return vA.create(n,...e)}function De(n,e,...t){if(!n)throw fg(e,...t)}function Si(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ad(e),new Error(e)}function ki(n,e){n||Si(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function FV(){return TE()==="http:"||TE()==="https:"}function TE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FV()||nD()||"connection"in navigator)?navigator.onLine:!0}function BV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ki(t>e,"Short delay should be less than long delay!"),this.isMobile=ZM()||sD()}get(){return qV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n,e){ki(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GV=new Vu(3e4,6e4);function kr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ui(n,e,t,i,o={}){return EA(n,o,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=Iu({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:g,...l};return tD()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Qa(n.emulatorConfig.host)&&(h.credentials="include"),TA.fetch()(await xA(n,n.config.apiHost,t,f),h)})}async function EA(n,e,t){n._canInitEmulator=!1;const i={...zV,...e};try{const o=new $V(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw pd(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[g,h]=f.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw pd(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw pd(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw pd(n,"user-disabled",u);const T=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _A(n,T,h);_s(n,T)}}catch(o){if(o instanceof Li)throw o;_s(n,"network-request-failed",{message:String(o)})}}async function Lu(n,e,t,i,o={}){const l=await Ui(n,e,t,i,o);return"mfaPendingCredential"in l&&_s(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function xA(n,e,t,i){const o=`${e}${t}?${i}`,l=n,u=l.config.emulator?hg(n.config,o):`${n.config.apiScheme}://${o}`;return HV.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function YV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $V{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Gs(this.auth,"network-request-failed")),GV.get())})}}function pd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Gs(n,e,i);return o.customData._tokenResponse=t,o}function EE(n){return n!==void 0&&n.enterprise!==void 0}class JV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return YV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KV(n,e){return Ui(n,"GET","/v2/recaptchaConfig",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QV(n,e){return Ui(n,"POST","/v1/accounts:delete",e)}async function $d(n,e){return Ui(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bA(n,e=!1){const t=_n(n),i=await t.getIdToken(e),o=mg(i);De(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:o,token:i,authTime:_u(Om(o.auth_time)),issuedAtTime:_u(Om(o.iat)),expirationTime:_u(Om(o.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Om(n){return Number(n)*1e3}function mg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ad("JWT malformed, contained fewer than 3 sections"),null;try{const o=xx(t);return o?JSON.parse(o):(Ad("Failed to decode base64 JWT payload"),null)}catch(o){return Ad("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function xE(n){const e=mg(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function za(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Li&&XV(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function XV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_u(this.lastLoginAt),this.creationTime=_u(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jd(n){var E;const e=n.auth,t=await n.getIdToken(),i=await za(n,$d(e,{idToken:t}));De(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const l=(E=o.providerUserInfo)!=null&&E.length?SA(o.providerUserInfo):[],u=ZV(n.providerData,l),f=n.isAnonymous,g=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),h=f?g:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new xp(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,T)}async function AA(n){const e=_n(n);await Jd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZV(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function SA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(n,e){const t=await EA(n,{},async()=>{const i=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,u=await xA(n,o,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:f,body:i};return n.emulatorConfig&&Qa(n.emulatorConfig.host)&&(g.credentials="include"),TA.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tL(n,e){return Ui(n,"POST","/v2/accounts:revokeToken",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=xE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:l}=await eL(e,t);this.updateTokensAndExpiration(i,o,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:l}=t,u=new Da;return i&&(De(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(De(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),l&&(De(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Da,this.toJSON())}_performRefresh(){return Si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vr(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class gs{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new WV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new xp(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await za(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bA(this,e)}reload(){return AA(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new gs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Jd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(es(this.auth.app))return Promise.reject(Ni(this.auth));const e=await this.getIdToken();return await za(this,QV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,f=t.tenantId??void 0,g=t._redirectEventId??void 0,h=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:E,emailVerified:b,isAnonymous:w,providerData:P,stsTokenManager:U}=t;De(E&&U,e,"internal-error");const H=Da.fromJSON(this.name,U);De(typeof E=="string",e,"internal-error"),vr(i,e.name),vr(o,e.name),De(typeof b=="boolean",e,"internal-error"),De(typeof w=="boolean",e,"internal-error"),vr(l,e.name),vr(u,e.name),vr(f,e.name),vr(g,e.name),vr(h,e.name),vr(T,e.name);const ne=new gs({uid:E,auth:e,email:o,emailVerified:b,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:H,createdAt:h,lastLoginAt:T});return P&&Array.isArray(P)&&(ne.providerData=P.map(F=>({...F}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,t,i=!1){const o=new Da;o.updateFromServerResponse(t);const l=new gs({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Jd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];De(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?SA(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(l!=null&&l.length),f=new Da;f.updateFromIdToken(i);const g=new gs({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:u}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new xp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,h),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE=new Map;function Ci(n){ki(n instanceof Function,"Expected a class definition");let e=bE.get(n);return e?(ki(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,bE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}CA.type="NONE";const bp=CA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(n,e,t){return`firebase:${n}:${e}:${t}`}class Pa{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:l}=this.auth;this.fullUserKey=Sd(this.userKey,o.apiKey,l),this.fullPersistenceKey=Sd("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await $d(this.auth,{idToken:e}).catch(()=>{});return t?gs._fromGetAccountInfoResponse(this.auth,t,e):null}return gs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Pa(Ci(bp),e,i);const o=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let l=o[0]||Ci(bp);const u=Sd(i,e.config.apiKey,e.name);let f=null;for(const h of t)try{const T=await h._get(u);if(T){let E;if(typeof T=="string"){const b=await $d(e,{idToken:T}).catch(()=>{});if(!b)break;E=await gs._fromGetAccountInfoResponse(e,b,T)}else E=gs._fromJSON(e,T);h!==l&&(f=E),l=h;break}}catch{}const g=o.filter(h=>h._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Pa(l,e,i):(l=g[0],f&&await l._set(u,f.toJSON()),await Promise.all(t.map(async h=>{if(h!==l)try{await h._remove(u)}catch{}})),new Pa(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DA(e))return"Blackberry";if(PA(e))return"Webos";if(IA(e))return"Safari";if((e.includes("chrome/")||NA(e))&&!e.includes("edge/"))return"Chrome";if(MA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function wA(n=gn()){return/firefox\//i.test(n)}function IA(n=gn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NA(n=gn()){return/crios\//i.test(n)}function RA(n=gn()){return/iemobile/i.test(n)}function MA(n=gn()){return/android/i.test(n)}function DA(n=gn()){return/blackberry/i.test(n)}function PA(n=gn()){return/webos/i.test(n)}function pg(n=gn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nL(n=gn()){var e;return pg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function sL(){return iD()&&document.documentMode===10}function kA(n=gn()){return pg(n)||MA(n)||PA(n)||DA(n)||/windows phone/i.test(n)||RA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(n,e=[]){let t;switch(n){case"Browser":t=AE(gn());break;case"Worker":t=`${AE(gn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xa}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,f)=>{try{const g=e(l);u(g)}catch(g){f(g)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rL(n,e={}){return Ui(n,"GET","/v2/passwordPolicy",kr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=6;class aL{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new SE(this),this.idTokenSubscription=new SE(this),this.beforeStateQueue=new iL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ci(t)),this._initializationPromise=this.queue(async()=>{var i,o,l;if(!this._deleted&&(this.persistenceManager=await Pa.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await $d(this,{idToken:e}),i=await gs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(es(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,f=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===f)&&(g!=null&&g.user)&&(i=g.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Jd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(es(this.app))return Promise.reject(Ni(this));const t=e?_n(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return es(this.app)?Promise.reject(Ni(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return es(this.app)?Promise.reject(Ni(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rL(this),t=new aL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await tL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ci(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Pa.create(this,[Ci(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,o);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(es(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&jV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function No(n){return _n(n)}class SE{constructor(e){this.auth=e,this.observer=null,this.addObserver=fD(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uL(n){Tf=n}function LA(n){return Tf.loadJS(n)}function cL(){return Tf.recaptchaEnterpriseScript}function dL(){return Tf.gapiScript}function fL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class hL{constructor(){this.enterprise=new mL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class mL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const pL="recaptcha-enterprise",UA="NO_RECAPTCHA";class gL{constructor(e){this.type=pL,this.auth=No(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{KV(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const h=new JV(g);return l.tenantId==null?l._agentRecaptchaConfig=h:l._tenantRecaptchaConfigs[l.tenantId]=h,u(h.siteKey)}}).catch(g=>{f(g)})})}function o(l,u,f){const g=window.grecaptcha;EE(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(h=>{u(h)}).catch(()=>{u(UA)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hL().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!t&&EE(window.grecaptcha))o(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=cL();g.length!==0&&(g+=f),LA(g).then(()=>{o(f,l,u)}).catch(h=>{u(h)})}}).catch(f=>{u(f)})})}}async function CE(n,e,t,i=!1,o=!1){const l=new gL(n);let u;if(o)u=UA;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const g=f.phoneEnrollmentInfo.phoneNumber,h=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:h,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const g=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Ap(n,e,t,i,o){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await CE(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await CE(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(n,e){const t=Lp(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(vo(l,e??{}))return o;_s(o,"already-initialized")}return t.initialize({options:e})}function yL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ci);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function jA(n,e,t){const i=No(n);De(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,l=FA(e),{host:u,port:f}=vL(e),g=f===null?"":`:${f}`,h={url:`${l}//${u}${g}/`},T=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){De(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),De(vo(h,i.config.emulator)&&vo(T,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=T,i.settings.appVerificationDisabledForTesting=!0,Qa(u)?(Cx(`${l}//${u}${g}`),wx("Auth",!0)):_L()}function FA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function vL(n){const e=FA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const l=o[1];return{host:l,port:wE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:wE(u)}}}function wE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function _L(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Si("not implemented")}_getIdTokenResponse(e){return Si("not implemented")}_linkToIdToken(e,t){return Si("not implemented")}_getReauthenticationResolver(e){return Si("not implemented")}}async function TL(n,e){return Ui(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(n,e){return Lu(n,"POST","/v1/accounts:signInWithPassword",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xL(n,e){return Lu(n,"POST","/v1/accounts:signInWithEmailLink",kr(n,e))}async function bL(n,e){return Lu(n,"POST","/v1/accounts:signInWithEmailLink",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha extends Ef{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Ha(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ha(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,t,"signInWithPassword",EL);case"emailLink":return xL(e,{email:this._email,oobCode:this._password});default:_s(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,i,"signUpPassword",TL);case"emailLink":return bL(e,{idToken:t,email:this._email,oobCode:this._password});default:_s(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ka(n,e){return Lu(n,"POST","/v1/accounts:signInWithIdp",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL="http://localhost";class Dr extends Ef{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_s("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...l}=t;if(!i||!o)return null;const u=new Dr(i,o);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return ka(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ka(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ka(e,t)}buildRequest(){const e={requestUri:AL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function CL(n){const e=au(lu(n)).link,t=e?au(lu(e)).deep_link_id:null,i=au(lu(n)).deep_link_id;return(i?au(lu(i)).link:null)||i||t||e||n}class xf{constructor(e){const t=au(lu(e)),i=t.apiKey??null,o=t.oobCode??null,l=SL(t.mode??null);De(i&&o&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=CL(e);try{return new xf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(){this.providerId=Ro.PROVIDER_ID}static credential(e,t){return Ha._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=xf.parseLink(t);return De(i,"argument-error"),Ha._fromEmailAndCode(e,i.code,i.tenantId)}}Ro.PROVIDER_ID="password";Ro.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ro.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu extends qA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends Uu{constructor(){super("facebook.com")}static credential(e){return Dr._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ti.credential(e.oauthAccessToken)}catch{return null}}}Ti.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ti.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Uu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dr._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ei.credential(t,i)}catch{return null}}}Ei.GOOGLE_SIGN_IN_METHOD="google.com";Ei.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Uu{constructor(){super("github.com")}static credential(e){return Dr._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com";xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Uu{constructor(){super("twitter.com")}static credential(e,t){return Dr._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return bi.credential(t,i)}catch{return null}}}bi.TWITTER_SIGN_IN_METHOD="twitter.com";bi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wL(n,e){return Lu(n,"POST","/v1/accounts:signUp",kr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const l=await gs._fromIdTokenResponse(e,i,o),u=IE(i);return new bo({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=IE(i);return new bo({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function IE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd extends Li{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Kd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Kd(e,t,i,o)}}function BA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Kd._fromErrorAndOperation(n,l,e,i):l})}async function IL(n,e,t=!1){const i=await za(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return bo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NL(n,e,t=!1){const{auth:i}=n;if(es(i.app))return Promise.reject(Ni(i));const o="reauthenticate";try{const l=await za(n,BA(i,o,e,n),t);De(l.idToken,i,"internal-error");const u=mg(l.idToken);De(u,i,"internal-error");const{sub:f}=u;return De(n.uid===f,i,"user-mismatch"),bo._forOperation(n,o,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&_s(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zA(n,e,t=!1){if(es(n.app))return Promise.reject(Ni(n));const i="signIn",o=await BA(n,i,e),l=await bo._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(l.user),l}async function HA(n,e){return zA(No(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GA(n){const e=No(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function RL(n,e,t){if(es(n.app))return Promise.reject(Ni(n));const i=No(n),u=await Ap(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",wL).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&GA(n),g}),f=await bo._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(f.user),f}function ML(n,e,t){return es(n.app)?Promise.reject(Ni(n)):HA(_n(n),Ro.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&GA(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DL(n,e){return Ui(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=_n(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await za(i,DL(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const f=i.providerData.find(({providerId:g})=>g==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function YA(n,e,t,i){return _n(n).onIdTokenChanged(e,t,i)}function $A(n,e,t){return _n(n).beforeAuthStateChanged(e,t)}function kL(n,e,t,i){return _n(n).onAuthStateChanged(e,t,i)}function VL(n){return _n(n).signOut()}const Qd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qd,"1"),this.storage.removeItem(Qd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL=1e3,UL=10;class KA extends JA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);sL()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,UL):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},LL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}KA.type="LOCAL";const QA=KA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA extends JA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XA.type="SESSION";const gg=XA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new bf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:l}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(u).map(async h=>h(t.origin,l)),g=await OL(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,u;return new Promise((f,g)=>{const h=yg("",20);o.port1.start();const T=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(E){const b=E;if(b.data.eventId===h)switch(b.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(b.data.response);break;default:clearTimeout(T),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(){return window}function FL(n){Ys().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function qL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function BL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function zL(){return WA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA="firebaseLocalStorageDb",HL=1,Xd="firebaseLocalStorage",eS="fbase_key";class Ou{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Af(n,e){return n.transaction([Xd],e?"readwrite":"readonly").objectStore(Xd)}function GL(){const n=indexedDB.deleteDatabase(ZA);return new Ou(n).toPromise()}function Sp(){const n=indexedDB.open(ZA,HL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Xd,{keyPath:eS})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Xd)?e(i):(i.close(),await GL(),e(await Sp()))})})}async function NE(n,e,t){const i=Af(n,!0).put({[eS]:e,value:t});return new Ou(i).toPromise()}async function YL(n,e){const t=Af(n,!1).get(e),i=await new Ou(t).toPromise();return i===void 0?null:i.value}function RE(n,e){const t=Af(n,!0).delete(e);return new Ou(t).toPromise()}const $L=800,JL=3;class tS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>JL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return WA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bf._getInstance(zL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await qL(),!this.activeServiceWorker)return;this.sender=new jL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||BL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await NE(e,Qd,"1"),await RE(e,Qd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>NE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>YL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>RE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=Af(o,!1).getAll();return new Ou(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$L)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tS.type="LOCAL";const nS=tS;new Vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(n,e){return e?Ci(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg extends Ef{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ka(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ka(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ka(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function QL(n){return zA(n.auth,new vg(n),n.bypassAuthState)}function XL(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),NL(t,new vg(n),n.bypassAuthState)}async function WL(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),IL(t,new vg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t,i,o,l=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(g))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QL;case"linkViaPopup":case"linkViaRedirect":return WL;case"reauthViaPopup":case"reauthViaRedirect":return XL;default:_s(this.auth,"internal-error")}}resolve(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new Vu(2e3,1e4);class Ca extends sS{constructor(e,t,i,o,l){super(e,t,o,l),this.provider=i,this.authWindow=null,this.pollId=null,Ca.currentPopupAction&&Ca.currentPopupAction.cancel(),Ca.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){ki(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Gs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Gs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ca.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZL.get())};e()}}Ca.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU="pendingRedirect",Cd=new Map;class tU extends sS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Cd.get(this.auth._key());if(!e){try{const i=await nU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Cd.set(this.auth._key(),e)}return this.bypassAuthState||Cd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nU(n,e){const t=rU(e),i=iU(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function sU(n,e){Cd.set(n._key(),e)}function iU(n){return Ci(n._redirectPersistence)}function rU(n){return Sd(eU,n.config.apiKey,n.name)}async function oU(n,e,t=!1){if(es(n.app))return Promise.reject(Ni(n));const i=No(n),o=KL(i,e),u=await new tU(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU=600*1e3;class lU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!iS(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Gs(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=aU&&this.cachedEventUids.clear(),this.cachedEventUids.has(ME(e))}saveEventToCache(e){this.cachedEventUids.add(ME(e)),this.lastProcessedEventTime=Date.now()}}function ME(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function iS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function uU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cU(n,e={}){return Ui(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fU=/^https?/;async function hU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await cU(n);for(const t of e)try{if(mU(t))return}catch{}_s(n,"unauthorized-domain")}function mU(n){const e=Ep(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!fU.test(t))return!1;if(dU.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=new Vu(3e4,6e4);function DE(){const n=Ys().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function gU(n){return new Promise((e,t)=>{var o,l,u;function i(){DE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{DE(),t(Gs(n,"network-request-failed"))},timeout:pU.get()})}if((l=(o=Ys().gapi)==null?void 0:o.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=Ys().gapi)!=null&&u.load)i();else{const f=fL("iframefcb");return Ys()[f]=()=>{gapi.load?i():t(Gs(n,"network-request-failed"))},LA(`${dL()}?onload=${f}`).catch(g=>t(g))}}).catch(e=>{throw wd=null,e})}let wd=null;function yU(n){return wd=wd||gU(n),wd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=new Vu(5e3,15e3),_U="__/auth/iframe",TU="emulator/auth/iframe",EU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bU(n){const e=n.config;De(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hg(e,TU):`https://${n.config.authDomain}/${_U}`,i={apiKey:e.apiKey,appName:n.name,v:Xa},o=xU.get(n.config.apiHost);o&&(i.eid=o);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Iu(i).slice(1)}`}async function AU(n){const e=await yU(n),t=Ys().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:bU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:EU,dontclear:!0},i=>new Promise(async(o,l)=>{await i.restyle({setHideOnLeave:!1});const u=Gs(n,"network-request-failed"),f=Ys().setTimeout(()=>{l(u)},vU.get());function g(){Ys().clearTimeout(f),o(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CU=500,wU=600,IU="_blank",NU="http://localhost";class PE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RU(n,e,t,i=CU,o=wU){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const g={...SU,width:i.toString(),height:o.toString(),top:l,left:u},h=gn().toLowerCase();t&&(f=NA(h)?IU:t),wA(h)&&(e=e||NU,g.scrollbars="yes");const T=Object.entries(g).reduce((b,[w,P])=>`${b}${w}=${P},`,"");if(nL(h)&&f!=="_self")return MU(e||"",f),new PE(null);const E=window.open(e||"",f,T);De(E,n,"popup-blocked");try{E.focus()}catch{}return new PE(E)}function MU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU="__/auth/handler",PU="emulator/auth/handler",kU=encodeURIComponent("fac");async function kE(n,e,t,i,o,l){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Xa,eventId:o};if(e instanceof qA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",dD(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,E]of Object.entries({}))u[T]=E}if(e instanceof Uu){const T=e.getScopes().filter(E=>E!=="");T.length>0&&(u.scopes=T.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const T of Object.keys(f))f[T]===void 0&&delete f[T];const g=await n._getAppCheckToken(),h=g?`#${kU}=${encodeURIComponent(g)}`:"";return`${VU(n)}?${Iu(f).slice(1)}${h}`}function VU({config:n}){return n.emulator?hg(n,PU):`https://${n.authDomain}/${DU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm="webStorageSupport";class LU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gg,this._completeRedirectFn=oU,this._overrideRedirectResult=sU}async _openPopup(e,t,i,o){var u;ki((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await kE(e,t,i,Ep(),o);return RU(e,l,yg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const l=await kE(e,t,i,Ep(),o);return FL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(ki(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await AU(e),i=new lU(e);return t.register("authEvent",o=>(De(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jm,{type:jm},o=>{var u;const l=(u=o==null?void 0:o[0])==null?void 0:u[jm];l!==void 0&&t(!!l),_s(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kA()||IA()||pg()}}const rS=LU;var VE="@firebase/auth",LE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jU(n){La(new _o("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;De(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VA(n)},h=new lL(i,o,l,g);return yL(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),La(new _o("auth-internal",e=>{const t=No(e.getProvider("auth").getImmediate());return(i=>new UU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),br(VE,LE,OU(n)),br(VE,LE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=300,qU=Sx("authIdTokenMaxAge")||FU;let UE=null;const BU=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>qU)return;const o=t==null?void 0:t.token;UE!==o&&(UE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function oS(n=Mx()){const e=Lp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=OA(n,{popupRedirectResolver:rS,persistence:[nS,QA,gg]}),i=Sx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=BU(l.toString());$A(t,u,()=>u(t.currentUser)),YA(t,f=>u(f))}}const o=bx("auth");return o&&jA(t,`http://${o}`),t}function zU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}uL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const l=Gs("internal-error");l.customData=o,t(l)},i.type="text/javascript",i.charset="UTF-8",zU().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jU("Browser");const gd=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:xf,AuthCredential:Ef,EmailAuthCredential:Ha,EmailAuthProvider:Ro,FacebookAuthProvider:Ti,GithubAuthProvider:xi,GoogleAuthProvider:Ei,OAuthCredential:Dr,TwitterAuthProvider:bi,beforeAuthStateChanged:$A,browserLocalPersistence:QA,browserPopupRedirectResolver:rS,browserSessionPersistence:gg,connectAuthEmulator:jA,createUserWithEmailAndPassword:RL,getAuth:oS,getIdTokenResult:bA,inMemoryPersistence:bp,indexedDBLocalPersistence:nS,initializeAuth:OA,onAuthStateChanged:kL,onIdTokenChanged:YA,prodErrorMap:yA,reload:AA,signInWithCredential:HA,signInWithEmailAndPassword:ML,signOut:VL,updateProfile:PL},Symbol.toStringTag,{value:"Module"}));let Fm=null,_i=null,ms=null;const HU=()=>{try{return Ra().hasFirebase?(Fm=Rx(Lt.firebase),_i=rA(Fm),ms=oS(Fm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};HU();const Ai={async signUp(n,e,t){if(!ms)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:i,updateProfile:o}=await vi(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:f}=await Promise.resolve().then(()=>gd);return{createUserWithEmailAndPassword:u,updateProfile:f}},void 0),l=await i(ms,n,e);return await o(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(i){return console.error("خطأ في التسجيل:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async signIn(n,e){if(!ms)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await vi(async()=>{const{signInWithEmailAndPassword:o}=await Promise.resolve().then(()=>gd);return{signInWithEmailAndPassword:o}},void 0);return{success:!0,user:(await t(ms,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!ms)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await vi(async()=>{const{signOut:e}=await Promise.resolve().then(()=>gd);return{signOut:e}},void 0);return await n(ms),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return ms?ms.currentUser:null},async onAuthStateChanged(n){if(!ms)return n(null),()=>{};try{const{onAuthStateChanged:e}=await vi(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>gd);return{onAuthStateChanged:t}},void 0);return e(ms,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:i,setDoc:o}=await vi(async()=>{const{doc:u,setDoc:f}=await Promise.resolve().then(()=>md);return{doc:u,setDoc:f}},void 0),l=i(_i,n,e);return await o(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(i){return console.error("خطأ في حفظ البيانات:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async getData(n,e){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:i}=await vi(async()=>{const{doc:u,getDoc:f}=await Promise.resolve().then(()=>md);return{doc:u,getDoc:f}},void 0),o=t(_i,n,e),l=await i(o);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await vi(async()=>{const{collection:l,getDocs:u}=await Promise.resolve().then(()=>md);return{collection:l,getDocs:u}},void 0),i=await t(e(_i,n)),o=[];return i.forEach(l=>{o.push({id:l.id,...l.data()})}),{success:!0,data:o}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!_i)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:i}=await vi(async()=>{const{doc:l,deleteDoc:u}=await Promise.resolve().then(()=>md);return{doc:l,deleteDoc:u}},void 0),o=t(_i,n,e);return await i(o),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},OE=({onSuccess:n,onClose:e,hideCloseButton:t=!1})=>{const[i,o]=fe.useState(!0),[l,u]=fe.useState({email:"",password:"",displayName:""}),[f,g]=fe.useState(!1),[h,T]=fe.useState(""),E=async w=>{w.preventDefault(),g(!0),T("");try{let P;if(i)P=await Ai.signIn(l.email,l.password);else{if(!l.displayName.trim()){T("الاسم مطلوب"),g(!1);return}P=await Ai.signUp(l.email,l.password,l.displayName)}P.success?n(P.user):T(P.error||"حدث خطأ غير متوقع")}catch{T("حدث خطأ في الاتصال")}finally{g(!1)}},b=w=>{u(P=>({...P,[w.target.name]:w.target.value}))};return d.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:i?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&d.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),d.jsxs("form",{onSubmit:E,className:"space-y-4",children:[!i&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),d.jsx("input",{type:"text",id:"displayName",name:"displayName",value:l.displayName,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!i})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),d.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),d.jsx("input",{type:"password",id:"password",name:"password",value:l.password,onChange:b,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),h&&d.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:d.jsx("p",{className:"text-red-600 text-sm",children:h})}),d.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:f?"⏳ جاري المعالجة...":i?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("button",{onClick:()=>o(!i),className:"text-blue-600 hover:text-blue-700 font-medium",children:i?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},aS=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),d.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Va=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),d.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),GU=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),d.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),YU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),$U=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),JU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),KU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),QU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),ju=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),qm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Bm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),XU=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),WU=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:i,onAddTransaction:o,currentUser:l,onSignOut:u})=>{const f=fe.useMemo(()=>{const h=new Date().getFullYear(),T=[];for(let E=h+1;E>=2020;E--)T.push(E);return T},[]),g=fe.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return d.jsx("header",{className:"bg-slate-50/95 backdrop-blur-lg border-b border-slate-200 py-3 shadow-sm",children:d.jsx("div",{className:"container mx-auto px-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-wide",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-xs text-slate-500",children:"Developed by K.A Team"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 p-1.5 rounded-lg",children:[d.jsx("select",{value:n,onChange:h=>t(parseInt(h.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:f.map(h=>d.jsx("option",{value:h,children:h},h))}),d.jsx("select",{value:e,onChange:h=>i(h.target.value==="all"?"all":parseInt(h.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:g.map(h=>d.jsx("option",{value:h.value,children:h.label},h.value))})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:l.displayName||"المستخدم"}),d.jsx("p",{className:"text-xs text-slate-500",children:l.email})]}),d.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),d.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),d.jsxs("button",{onClick:o,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[d.jsx(QU,{className:"w-5 h-5"}),d.jsx("span",{children:"إضافة حركة"})]})]})]})})})},zm=[{id:"summary",label:"📊 الملخص",icon:YU},{id:"analysis",label:"📈 التحليل",icon:$U},{id:"transactions",label:"💳 الحركات",icon:JU},{id:"budget",label:"✨ الميزانية"},{id:"investment",label:"💹 الاستثمار"},{id:"ai-assistant",label:"🤖 المحلل الذكي"},{id:"cards",label:"💳 إدارة البطاقات"},{id:"bank",label:"🏦 البنك"},{id:"installments",label:"📱 الأقساط"},{id:"debts-loans",label:"📊 الديون والقروض"},{id:"settings",label:"⚙️ الإعدادات"}],jE=["summary","analysis","transactions"],ZU=({activeTab:n,setActiveTab:e})=>{const[t,i]=fe.useState(!1),o=f=>{e(f),i(!1)},l=zm.filter(f=>jE.includes(f.id)),u=zm.filter(f=>!jE.includes(f.id));return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:zm.map(f=>d.jsx("button",{onClick:()=>o(f.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===f.id?"active":""}`,children:f.label},f.id))}),d.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[l.map(f=>{const g=f.icon;return d.jsxs("button",{onClick:()=>o(f.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===f.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[g&&d.jsx(g,{}),d.jsx("span",{className:"text-xs",children:f.label.split(" ")[1]})]},f.id)}),d.jsxs("button",{onClick:()=>i(!t),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${t?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[d.jsx(KU,{}),d.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),t&&d.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>i(!1),children:d.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:f=>f.stopPropagation(),children:[d.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),d.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:u.map(f=>d.jsxs("button",{onClick:()=>o(f.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===f.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[d.jsx("span",{className:"text-2xl",children:f.label.split(" ")[0]}),d.jsx("span",{className:"text-xs font-semibold",children:f.label.split(" ")[1]})]},f.id))})]})})]})},e4=({className:n})=>d.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-slate-200/80 to-transparent ${n}`}),Hm=()=>d.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[d.jsx("div",{className:"h-6 w-1/2 bg-slate-200 rounded mb-6"}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),d.jsx("div",{className:"h-4 w-5/6 bg-slate-200 rounded"}),d.jsx("div",{className:"h-4 w-full bg-slate-200 rounded"}),d.jsx("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]}),d.jsx(e4,{})]}),t4=()=>d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx("div",{className:"h-16 mb-3"}),d.jsx("div",{className:"flex flex-wrap justify-center mb-8 bg-slate-100 rounded-xl p-2 h-14"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsx(Hm,{}),d.jsx(Hm,{}),d.jsx(Hm,{})]})]}),ke=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),n4=({title:n,details:e,barColor:t})=>d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h4",{className:"font-bold text-sm text-slate-800",children:n}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),d.jsxs("div",{className:"bg-slate-50 p-2 rounded-lg border border-gray-200",children:[d.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[d.jsx("span",{className:"text-slate-600",children:"المستحق:"}),d.jsx("span",{className:"font-semibold number-display text-slate-900 text-xs",children:ke(e.balance)})]}),d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsx("span",{className:"text-slate-600",children:"المتبقي:"}),d.jsx("span",{className:"font-semibold number-display text-emerald-700 text-xs",children:ke(e.available)})]})]}),d.jsx("div",{className:"bg-slate-200 rounded-full h-1.5 overflow-hidden",children:d.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),s4=({calculations:n,categories:e})=>{const t=Object.values(n.expensesByCategory).reduce((o,l)=>o+Number(l),0);if(t===0)return d.jsx("p",{className:"text-slate-500 text-center p-4 text-sm",children:"لا توجد مصاريف في هذه الفترة."});const i=Object.entries(n.expensesByCategory).sort(([,o],[,l])=>l-o);return d.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:i.map(([o,l])=>{const u=e.find(g=>g.id===o);u&&`${u.icon}${u.name}`;const f=Number(l)/t*100;return d.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-base",children:(u==null?void 0:u.icon)||"📊"}),d.jsx("span",{className:"font-medium text-slate-700 truncate text-sm",title:u==null?void 0:u.name,children:(u==null?void 0:u.name)||"غير مصنف"})]}),d.jsx("span",{className:"font-semibold text-slate-900 number-display text-sm bg-slate-50 px-2 py-1 rounded border border-gray-200",children:ke(l)})]}),d.jsx("div",{className:"mt-2 bg-slate-200 rounded-full h-1.5 overflow-hidden",children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${f.toFixed(1)}%`}})}),d.jsxs("div",{className:"text-xs text-slate-500 mt-1 text-center",children:[f.toFixed(1),"%"]})]},o)})})},i4=({calculations:n,categories:e})=>{const{totalIncome:t,totalExpenses:i,cardDetails:o,cardPayments:l,bankAccountDetails:u,totalDebt:f,totalAvailable:g,totalLimits:h,totalBankBalance:T}=n,E=t-i,b=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"];return d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"💳 ملخص ديون البطاقات"}),d.jsx("div",{className:"space-y-4",children:Object.values(o).map((w,P)=>d.jsx(n4,{title:w.name,details:w,barColor:b[P%b.length]},w.id))}),d.jsx("div",{className:"mt-4 p-3 bg-slate-100 rounded-lg",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-600 font-semibold text-xs mb-2",children:"إجمالي الديون"}),d.jsx("p",{className:"font-bold text-sm text-red-600 number-display",children:ke(f)})]}),d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-2",children:"إجمالي المتاح"}),d.jsx("p",{className:"font-bold text-sm text-emerald-600 number-display",children:ke(g)})]}),d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),d.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:ke(h)})]})]})})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),d.jsx("div",{className:"space-y-3",children:Object.values(u).map(w=>{const P=w.balance>0?"bank-card-positive":w.balance<0?"bank-card-negative":"bank-card-neutral";return d.jsxs("div",{className:`card-consistent ${P} h-32 flex flex-col justify-between`,children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:w.name}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),d.jsx("div",{className:"text-center",children:d.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:ke(w.balance)})}),d.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),d.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",ke(w.deposits)]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),d.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",ke(w.withdrawals)]})]})]})]},w.id)})}),d.jsxs("div",{className:"mt-4 card-consistent text-center",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-2",children:"🏦 إجمالي الأرصدة البنكية"}),d.jsx("p",{className:"font-bold text-xl text-blue-900 number-display",children:ke(T)})]})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي الدخل:"}),d.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:ke(t)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي المصاريف:"}),d.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:ke(i)})]}),d.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(o).map((w,P)=>d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["مصاريف ",w.name,":"]}),d.jsx("span",{className:`font-semibold ${b[P%b.length].replace("bg-","text-")} number-display`,children:ke(w.balance+(l[w.id]||0))})]},w.id)),d.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(l).map(([w,P])=>{var U;return d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(U=o[w])==null?void 0:U.name,":"]}),d.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:ke(P)})]},w)}),d.jsx("hr",{className:"my-2 border-slate-200"}),d.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[d.jsx("span",{children:"الصافي:"}),d.jsx("span",{className:`number-display ${E>=0?"text-emerald-500":"text-red-500"}`,children:ke(E)})]})]})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),d.jsx(s4,{calculations:n,categories:e})]})]})},r4=({transactions:n,allTransactions:e,categories:t,deleteTransaction:i,editTransaction:o,state:l})=>{const[u,f]=fe.useState(""),[g,h]=fe.useState(""),[T,E]=fe.useState(""),[b,w]=fe.useState(""),[P,U]=fe.useState(""),H=z=>{const Z={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return Z[z]?Z[z]:l.cards[z]?`💳 ${l.cards[z].name}`:l.bankAccounts[z]?`🏦 ${l.bankAccounts[z].name}`:z},ne=z=>{const Z={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(Z[z])return Z[z];if(z.endsWith("-payment")){const W=z.replace("-payment","");if(l.cards[W])return`💳 سداد ${l.cards[W].name}`}return z},F=fe.useMemo(()=>{let z=n;if(b&&P){const Z=new Date(b),W=new Date(P);W.setHours(23,59,59,999),z=e.filter(R=>{const C=new Date(R.date);return C>=Z&&C<=W})}return z=z.filter(Z=>{const W=u.toLowerCase(),R=t.find(V=>V.id===Z.categoryId),C=Z.description.toLowerCase().includes(W)||(R==null?void 0:R.name.toLowerCase().includes(W)),N=!g||Z.paymentMethod===g,k=!T||Z.categoryId===T;return C&&N&&k}),z.sort((Z,W)=>{const R=parseInt(Z.id.replace("trans-","").split("-")[0]);return parseInt(W.id.replace("trans-","").split("-")[0])-R})},[n,e,u,g,T,b,P,t]),O=fe.useMemo(()=>F.reduce((z,Z)=>(Z.type==="income"||Z.type.toString().includes("payment")||Z.type==="investment-withdrawal"?z.positive+=Z.amount:z.negative+=Z.amount,z),{positive:0,negative:0}),[F]);return d.jsx("div",{className:"space-y-6 animate-fade-in",children:d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),d.jsx("input",{type:"date",id:"dateFrom",value:b,onChange:z=>w(z.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),d.jsx("input",{type:"date",id:"dateTo",value:P,onChange:z=>U(z.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),d.jsxs("select",{id:"filterMethod",value:g,onChange:z=>h(z.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(z=>d.jsxs("option",{value:z.id,children:["🏦 ",z.name]},z.id)),d.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(z=>d.jsxs("option",{value:z.id,children:["💳 ",z.name]},z.id)),d.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),d.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),d.jsxs("select",{id:"filterCategory",value:T,onChange:z=>E(z.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الفئات"}),t.map(z=>d.jsx("option",{value:z.id,children:z.name},z.id))]})]}),d.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[d.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),d.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:u,onChange:z=>f(z.target.value),className:"p-2 w-full"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),d.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),d.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:d.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:ke(O.positive)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),d.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),d.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:d.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:ke(O.negative)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),d.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),d.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:d.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:ke(O.positive-O.negative)})})]})]}),d.jsxs("div",{className:"overflow-x-auto",children:[d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),d.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),d.jsx("tbody",{children:F.map(z=>{const Z=t.find(R=>R.id===z.categoryId),W=z.type==="income"||z.type.toString().includes("payment")||z.type==="investment-withdrawal";return d.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[d.jsx("td",{className:"p-3",children:z.date}),d.jsx("td",{className:"p-3",children:H(z.paymentMethod)}),d.jsx("td",{className:"p-3",children:ne(z.type)}),d.jsxs("td",{className:`p-3 font-semibold number-display ${W?"text-emerald-500":"text-red-500"}`,children:[W?"+":"-"," ",ke(z.amount)]}),d.jsx("td",{className:"p-3",children:Z?`${Z.icon} ${Z.name}`:"غير محدد"}),d.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:z.description||"-"}),d.jsx("td",{className:"p-3 text-center",children:d.jsxs("div",{className:"flex gap-2 justify-center",children:[d.jsx("button",{onClick:()=>o(z.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),d.jsx("button",{onClick:()=>i(z.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:d.jsx(Va,{})})]})})]},z.id)})})]}),F.length===0&&d.jsxs("div",{className:"text-center p-8 text-slate-500",children:[d.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),d.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},o4=()=>d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),a4=({calculations:n,filteredTransactions:e})=>{const[t,i]=fe.useState([{id:"1",text:'أهلاً بك! أنا مساعدك المالي الشامل. يمكنك أن تسألني أسئلة تفصيلية عن وضعك المالي، مثل "ما هو إجمالي ديوني؟" أو "هل إنفاقي هذا الشهر يتوافق مع أهدافي؟"',sender:"ai"}]),[o,l]=fe.useState(""),[u,f]=fe.useState(!1),g=fe.useRef(null);fe.useEffect(()=>{var T;(T=g.current)==null||T.scrollTo(0,g.current.scrollHeight)},[t,u]);const h=async T=>{T.preventDefault();const E=o.trim();if(!E||u)return;const b={id:Date.now().toString(),text:E,sender:"user"};i(w=>[...w,b]),l(""),f(!0);try{const P=await px(E,{periodSummary:n,transactions:e}),U={id:(Date.now()+1).toString(),text:P,sender:"ai"};i(H=>[...H,U])}catch(w){const P={id:(Date.now()+1).toString(),text:w instanceof Error?w.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};i(U=>[...U,P])}finally{f(!1)}};return d.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[d.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل المالي الذكي"}),d.jsx("p",{className:"text-sm text-slate-500",children:"اسأل أي شيء عن بياناتك المالية للشهر المحدد"})]}),d.jsxs("div",{ref:g,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[t.map(T=>d.jsx("div",{className:`chat-bubble ${T.sender==="user"?"user-bubble":"ai-bubble"}`,children:d.jsx("p",{dangerouslySetInnerHTML:{__html:T.text.replace(/\n/g,"<br />")}})},T.id)),u&&d.jsx(o4,{})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:h,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:o,onChange:T=>l(T.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:u}),d.jsx("button",{type:"submit",disabled:u,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:d.jsx(aS,{})})]})})]})},l4=({calculations:n,categories:e,allTransactions:t})=>{const i=fe.useRef(null),o=fe.useRef(null),l=fe.useRef({}),u=fe.useMemo(()=>Object.entries(n.expensesByCategory).map(([g,h])=>{const T=e.find(E=>E.id===g);return{name:T?`${T.icon} ${T.name}`:"غير محدد",value:h}}).sort((g,h)=>h.value-g.value),[n.expensesByCategory,e]),f=fe.useMemo(()=>{const g={},h=new Date;for(let T=5;T>=0;T--){const b=new Date(h.getFullYear(),h.getMonth()-T,1).toLocaleString("en-US",{month:"short",year:"numeric"});g[b]={income:0,expenses:0}}return t.forEach(T=>{const b=new Date(T.date).toLocaleString("en-US",{month:"short",year:"numeric"});g[b]&&(T.type==="income"&&(g[b].income+=T.amount),(T.type==="expense"||T.type==="bnpl-payment")&&(g[b].expenses+=T.amount))}),{labels:Object.keys(g),incomeData:Object.values(g).map(T=>T.income),expensesData:Object.values(g).map(T=>T.expenses)}},[t]);return fe.useEffect(()=>{var h,T;const g=window.Chart;if(g){if((h=l.current.pie)==null||h.destroy(),(T=l.current.bar)==null||T.destroy(),i.current&&u.length>0){const E=i.current.getContext("2d");E&&(l.current.pie=new g(E,{type:"doughnut",data:{labels:u.map(b=>b.name),datasets:[{data:u.map(b=>b.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(o.current&&f.labels.length>0){const E=o.current.getContext("2d");E&&(l.current.bar=new g(E,{type:"bar",data:{labels:f.labels,datasets:[{label:"الدخل",data:f.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:f.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var E,b;(E=l.current.pie)==null||E.destroy(),(b=l.current.bar)==null||b.destroy()}}},[u,f]),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📊 توزيع مصاريف الفترة"}),d.jsx("div",{className:"h-80",children:u.length>0?d.jsx("canvas",{ref:i}):d.jsx("p",{className:"text-center text-slate-500 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),d.jsx("div",{className:"h-80",children:d.jsx("canvas",{ref:o})})]})]})},u4=({state:n,setLoading:e,setModal:t})=>{const[i,o]=fe.useState(""),[l,u]=fe.useState(""),f=async()=>{const g=parseFloat(i);if(isNaN(g)||g<=0){t({title:"خطأ",body:"<p>الرجاء إدخال مبلغ ميزانية صحيح.</p>",confirmText:"موافق",hideCancel:!0});return}e(!0,"جاري إنشاء خطة الميزانية..."),u("");try{const h=new Date;h.setDate(h.getDate()-60);const T=n.transactions.filter(b=>new Date(b.date)>=h&&b.type==="expense");if(T.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const E=await vx(g,n.categories,T);u(E)}catch(h){const T=h instanceof Error?h.message:"حدث خطأ غير متوقع.";t({title:"خطأ في إنشاء الميزانية",body:`<p>${T}</p>`,confirmText:"موافق",hideCancel:!0})}finally{e(!1)}};return d.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"✨ الميزانية الشهرية الذكية"}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 bg-slate-100 rounded-lg",children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("label",{htmlFor:"monthly-budget-input",className:"block text-sm font-medium text-slate-600 mb-1",children:"أدخل إجمالي ميزانيتك الشهرية (ريال)"}),d.jsx("input",{type:"number",id:"monthly-budget-input",className:"w-full p-2",placeholder:"5000",value:i,onChange:g=>o(g.target.value)})]}),d.jsx("button",{onClick:f,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:"✨ إنشاء خطة الميزانية"})]}),d.jsx("div",{className:"prose max-w-none",children:l?d.jsx("div",{dangerouslySetInnerHTML:{__html:l.replace(/### (.*)/g,'<h4 class="text-lg font-bold text-slate-900 mt-3 mb-2">$1</h4>').replace(/\n/g,"<br />")}}):d.jsx("p",{className:"text-center text-slate-500",children:"أدخل ميزانيتك أعلاه للحصول على خطة مخصصة بناءً على إنفاقك."})})]})},c4=({state:n,setState:e,calculations:t,setModal:i})=>{const[o,l]=fe.useState([{id:"1",text:'أهلاً بك! أنا مرشدك لفهم عالم الاستثمار. يمكنك سؤالي عن استراتيجيات، أو مفاهيم مثل "ما هو الاستثمار طويل الأجل؟". تذكر، أنا لا أقدم نصائح مباشرة لشراء أسهم معينة.',sender:"ai"}]),[u,f]=fe.useState(""),[g,h]=fe.useState(!1),T=fe.useRef(null);fe.useEffect(()=>{var P;(P=T.current)==null||P.scrollTo(0,T.current.scrollHeight)},[o,g]);const E=P=>{P.preventDefault();const U=P.target,H=parseFloat(U.elements.namedItem("investment-amount").value),ne=U.elements.namedItem("investment-type").value,F=U.elements.namedItem("payment-method").value;if(isNaN(H)||H<=0){i({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const O={amount:H,date:new Date().toISOString().split("T")[0],description:ne==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:F,type:ne==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(z=>({...z,transactions:[...z.transactions,{...O,id:`trans-${Date.now()}`}]})),U.reset()},b=async P=>{P.preventDefault();const U=u.trim();if(!(!U||g)){l(H=>[...H,{id:Date.now().toString(),text:U,sender:"user"}]),f(""),h(!0);try{const H=await yx(U);l(ne=>[...ne,{id:(Date.now()+1).toString(),text:H,sender:"ai"}])}catch(H){l(ne=>[...ne,{id:(Date.now()+1).toString(),text:H instanceof Error?H.message:"عذراً، حدث خطأ.",sender:"ai"}])}finally{h(!1)}}},w=()=>{const P=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;i({show:!0,title:"تحديث قيمة المحفظة",body:P,confirmText:"حفظ",onConfirm:()=>{const U=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(U)||U<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(H=>({...H,investments:{...H.investments,currentValue:U}}))}})};return d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[d.jsxs("div",{className:"glass-card p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),d.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:ke(n.investments.currentValue)}),d.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",d.jsx("span",{className:"font-semibold number-display text-slate-600",children:ke(t.totalInvestmentDeposits)})]}),d.jsx("button",{onClick:w,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),d.jsxs("form",{onSubmit:E,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),d.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),d.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[d.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),d.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),d.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(P=>d.jsxs("option",{value:P.id,children:["🏦 ",P.name]},P.id))})]}),d.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),d.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[d.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 مستشارك الاستثماري الذكي"}),d.jsx("p",{className:"text-sm text-slate-500",children:"اسأل عن المفاهيم والاستراتيجيات لاتخاذ قرارات أفضل"})]}),d.jsxs("div",{ref:T,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[o.map(P=>d.jsx("div",{className:`chat-bubble ${P.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:P.text.replace(/\n/g,"<br/>")}},P.id)),g&&d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:b,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:u,onChange:P=>f(P.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:g}),d.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:g,children:d.jsx(aS,{})})]})})]})]})},d4=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:i})=>{const o=l=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(u=>`
            <tr class="hover:bg-slate-50">
                <td class="p-2">${u.postingDate||u.date}</td>
                <td class="p-2 truncate" title="${u.description}">${u.description}</td>
                <td class="p-2 number-display text-red-500">${ke(u.amount)}</td>
            </tr>
        `).join("");return d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>i(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:d.jsx(Va,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),d.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),d.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:d.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[ke(e.statementDueAmount)," ريال"]})}),d.jsxs("div",{className:"flex justify-between items-center text-xs",children:[d.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),d.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),d.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:d.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),d.jsxs("p",{className:"font-bold text-red-800 number-display",children:[ke(n.balance)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),d.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[ke(n.limit)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[d.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),d.jsxs("p",{className:"font-bold text-green-800 number-display",children:[ke(n.available)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[d.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),d.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),d.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[d.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),d.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:d.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${o(e.upcomingTransactions)}</tbody>`}})})]})]})},f4=({state:n,openCardFormModal:e,deleteCard:t})=>{const i=fe.useMemo(()=>{const l={};return Object.values(n.cards).forEach(u=>{const f=new Date,g=f.getDate(),h=f.getMonth(),T=f.getFullYear();let E,b,w;g>u.statementDay?E=new Date(T,h,u.statementDay):E=new Date(T,h-1,u.statementDay),b=new Date(E.getFullYear(),E.getMonth()-1,u.statementDay+1);let P=E.getMonth()+1,U=E.getFullYear();P>11&&(P=0,U+=1),w=new Date(U,P,u.dueDay);const H=n.transactions.filter(O=>{const z=new Date(O.postingDate||O.date);return O.paymentMethod===u.id&&(O.type==="expense"||O.type==="bnpl-payment")&&z>=b&&z<=E}),ne=n.transactions.filter(O=>{const z=new Date(O.postingDate||O.date);return O.paymentMethod===u.id&&(O.type==="expense"||O.type==="bnpl-payment")&&z>E}),F=H.reduce((O,z)=>O+z.amount,0);l[u.id]={statementDueAmount:F,dueDate:w,totalOutstanding:0,upcomingTransactions:ne}}),l},[n.transactions,n.cards]),o=Object.values(n.cards);return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),d.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(l=>{const u=n.transactions.filter(g=>g.paymentMethod===l.id&&(g.type==="expense"||g.type==="bnpl-payment")).reduce((g,h)=>g+h.amount,0)-n.transactions.filter(g=>g.type===`${l.id}-payment`).reduce((g,h)=>g+h.amount,0),f={...l,balance:u,available:l.limit-u,usagePercentage:l.limit>0?u/l.limit*100:0};return d.jsx(d4,{card:f,statementDetails:i[f.id],openCardFormModal:e,deleteCard:t},f.id)})})]})},h4=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const i=n.replace("-payment","");if(e.cards[i])return`💳 سداد ${e.cards[i].name}`}return n},m4=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),d.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:d.jsx(Va,{})})]})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),d.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:ke(n.balance)})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:ke(n.deposits)})]}),d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:ke(n.withdrawals)})]})]})]}),p4=({state:n,setState:e,calculations:t,filteredTransactions:i,categories:o,setModal:l,openBankAccountFormModal:u,deleteBankAccount:f,openTransferModal:g})=>d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),d.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&d.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(h=>d.jsx(m4,{account:h,openBankAccountFormModal:u,deleteBankAccount:f},h.id))}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),d.jsx("tbody",{children:i.filter(h=>n.bankAccounts[h.paymentMethod]).sort((h,T)=>new Date(T.date).getTime()-new Date(h.date).getTime()).map(h=>{var w;const T=["income","investment-withdrawal"].includes(h.type),E=T?"text-emerald-500":"text-red-500",b=o.find(P=>P.id===h.categoryId);return d.jsxs("tr",{className:"border-b border-gray-200/50",children:[d.jsx("td",{className:"p-3",children:h.date}),d.jsx("td",{className:"p-3",children:(w=n.bankAccounts[h.paymentMethod])==null?void 0:w.name}),d.jsx("td",{className:"p-3",children:h4(h.type,n)}),d.jsxs("td",{className:`p-3 font-semibold ${E} number-display`,children:[T?"+":"-",ke(h.amount)]}),d.jsx("td",{className:"p-3",children:b?`${b.icon} ${b.name}`:"-"}),d.jsx("td",{className:"p-3 text-slate-500",children:h.description||"-"})]},h.id)})})]})})]})]}),yd=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},g4=({state:n,setState:e,filteredTransactions:t,setModal:i})=>{const[o,l]=wp.useState(!1),u=()=>{const F=n.installments.filter(C=>C.paid<C.total),O=F.filter(C=>C.provider==="tabby-bnpl"),z=F.filter(C=>C.provider==="tamara-bnpl"),Z=O.reduce((C,N)=>{const k=N.total-N.paid;return C+N.installmentAmount*k},0),W=z.reduce((C,N)=>{const k=N.total-N.paid;return C+N.installmentAmount*k},0),R=Z+W;return{tabbyTotal:Z,tamaraTotal:W,grandTotal:R,activeCount:F.length,completedCount:n.installments.filter(C=>C.paid>=C.total).length}},f=()=>{const F=n.installments.filter(Z=>Z.paid<Z.total);if(F.length===0)return null;const O=n.transactions.filter(Z=>Z.isInstallmentPayment);if(O.length===0){const Z=F.sort((C,N)=>new Date(C.createdAt).getTime()-new Date(N.createdAt).getTime())[0],W=new Date(Z.createdAt),R=new Date(W);return R.setDate(R.getDate()+30),R.toISOString().split("T")[0]}let z=null;for(const Z of F){const W=O.filter(R=>R.installmentId===Z.id).sort((R,C)=>new Date(C.date).getTime()-new Date(R.date).getTime());if(W.length>0){const R=W[0],C=new Date(R.date),N=new Date(C);N.setDate(N.getDate()+30),(!z||N<new Date(z))&&(z=N.toISOString().split("T")[0])}else{const R=new Date(Z.createdAt),C=new Date(R);C.setDate(C.getDate()+30),(!z||C<new Date(z))&&(z=C.toISOString().split("T")[0])}}return z},g=()=>n.installments.filter(O=>O.paid<O.total).reduce((O,z)=>O+z.installmentAmount,0),h=()=>{const F=n.installments.filter(z=>z.paid<z.total),O=n.transactions.filter(z=>z.isInstallmentPayment);return F.map(z=>{const Z=O.filter(R=>R.installmentId===z.id).sort((R,C)=>new Date(C.date).getTime()-new Date(R.date).getTime());let W;if(Z.length>0){const R=Z[0],C=new Date(R.date),N=new Date(C);N.setDate(N.getDate()+30),W=N.toISOString().split("T")[0]}else{const R=new Date(z.createdAt),C=new Date(R);C.setDate(C.getDate()+30),W=C.toISOString().split("T")[0]}return{installment:z,nextPaymentDate:W}}).sort((z,Z)=>new Date(z.nextPaymentDate).getTime()-new Date(Z.nextPaymentDate).getTime())},T=F=>{const O=n.transactions.find(W=>W.id===F);if(!O||!O.isInstallmentPayment||!n.installments.find(W=>W.id===O.installmentId))return;const Z=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${O.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${O.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${O.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(W=>`<option value="${W.id}" ${O.paymentMethod===W.id?"selected":""}>🏦 ${W.name}</option>`).join("")}
                        <option value="cash" ${O.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(W=>`<option value="${W.id}" ${O.paymentMethod===W.id?"selected":""}>💳 ${W.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;i({show:!0,title:"تعديل حركة القسط",body:Z,confirmText:"حفظ التعديلات",onConfirm:()=>{const W=parseFloat(document.getElementById("edit-amount").value),R=document.getElementById("edit-date").value,C=document.getElementById("edit-description").value,N=document.getElementById("edit-payment-method").value;e(k=>({...k,transactions:k.transactions.map(V=>V.id===F?{...V,amount:W,date:R,description:C,paymentMethod:N}:V)})),i({show:!1})}})},E=F=>{const O=n.transactions.find(Z=>Z.id===F);if(!O||!O.isInstallmentPayment)return;i({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const Z=O.installmentId;e(W=>({...W,transactions:W.transactions.filter(R=>R.id!==F),installments:W.installments.map(R=>R.id===Z?{...R,paid:Math.max(0,R.paid-1)}:R)})),i({show:!1})}})},b=F=>{const O=n.installments.find(Z=>Z.id===F);if(!O)return;const z=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${O.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${O.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${O.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${O.paid}" min="0" max="${O.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;i({show:!0,title:"تعديل خطة القسط",body:z,confirmText:"حفظ التعديلات",onConfirm:()=>{const Z=document.getElementById("edit-description").value,W=parseFloat(document.getElementById("edit-amount").value),R=parseInt(document.getElementById("edit-total").value),C=parseInt(document.getElementById("edit-paid").value);e(N=>({...N,installments:N.installments.map(k=>k.id===F?{...k,description:Z,installmentAmount:W,total:R,paid:C}:k)})),i({show:!1})}})},w=F=>{const O=n.installments.find(Z=>Z.id===F);if(!O)return;const z=`<p>هل أنت متأكد من حذف خطة القسط "${O.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;i({show:!0,title:"حذف خطة القسط",body:z,confirmText:"حذف",onConfirm:()=>{e(Z=>({...Z,installments:Z.installments.filter(W=>W.id!==F),transactions:Z.transactions.filter(W=>W.installmentId!==F)})),i({show:!1})}})},P=F=>{const O=n.installments.find(W=>W.id===F);if(!O||O.paid>=O.total)return;let z="";Object.values(n.bankAccounts).forEach(W=>{z+=`<option value="${W.id}">🏦 ${W.name}</option>`}),z+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(W=>{z+=`<option value="${W.id}">💳 ${W.name}</option>`});const Z=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${O.description}" بقيمة ${ke(O.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${z}</select></div>`;i({show:!0,title:"سداد قسط",body:Z,confirmText:"تأكيد الدفع",onConfirm:()=>{var k;const W=document.getElementById("installment-payment-source").value,R=n.categories.find(V=>V.name==="سداد فواتير"||V.name==="💳 سداد فواتير"),C=(R==null?void 0:R.id)||((k=n.categories.find(V=>V.name==="أخرى"))==null?void 0:k.id)||"",N={id:"trans-"+Date.now(),amount:O.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${O.paid+1} لـ: ${O.description}`,paymentMethod:W,type:"bnpl-payment",categoryId:C,isInstallmentPayment:!0,installmentId:F};e(V=>{const j=V.installments.map(D=>{if(D.id===F){const Le={...D,paid:D.paid+1};return console.log("🔄 تحديث قسط:",{id:D.id,paid:D.paid,newPaid:Le.paid,total:D.total}),Le}return D});return{...V,transactions:[...V.transactions,N],installments:j}})}})},U=n.installments.filter(F=>F.paid<F.total),H=n.transactions.filter(F=>F.isInstallmentPayment),ne=u();return f(),g(),d.jsxs("div",{className:"animate-fade-in",children:[d.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[d.jsx("div",{className:"flex justify-between items-start mb-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"ملخص الأقساط"}),d.jsx("p",{className:"text-sm text-slate-600",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"🎯"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ke(ne.grandTotal)})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:ke(ne.tabbyTotal)})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:ke(ne.tamaraTotal)})]})]}),h().length>0&&d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("span",{className:"text-2xl",children:"⏰"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),d.jsx("div",{className:"space-y-2",children:h().slice(0,3).map((F,O)=>d.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-slate-700",children:F.installment.description}),d.jsx("p",{className:"text-xs text-slate-500",children:yd(F.installment.provider,n)})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(F.nextPaymentDate).toLocaleDateString("en-GB")}),d.jsx("p",{className:"text-xs text-slate-600",children:ke(F.installment.installmentAmount)})]})]},F.installment.id))})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"flex gap-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ne.activeCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),d.jsx("div",{className:"text-center",children:d.jsxs("button",{onClick:()=>l(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[d.jsx("p",{className:"text-2xl font-bold text-green-600",children:ne.completedCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),h().length>0&&d.jsx("button",{onClick:()=>{n.installments.filter(O=>O.paid<O.total).forEach(O=>{P(O.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),d.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900",children:"📱 خطط الأقساط النشطة"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:U.length>0?U.map(F=>{const O=F.paid/F.total*100;return console.log("📊 عرض قسط:",{id:F.id,paid:F.paid,total:F.total,progress:O}),d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-slate-900",children:F.description}),d.jsx("p",{className:"text-sm text-slate-500",children:yd(F.provider,n)})]})]}),d.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:d.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[ke(F.installmentAmount),"/شهر"]})})]}),d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-gray-200 mb-3",children:[d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:d.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${O}%`}})}),d.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[d.jsxs("span",{className:"font-medium",children:[F.paid," / ",F.total," مدفوع"]}),d.jsxs("span",{className:"font-medium",children:["متبقي: ",F.total-F.paid]})]}),d.jsx("div",{className:"text-center mt-2",children:d.jsxs("span",{className:"text-xs text-slate-500",children:[O.toFixed(1),"% مكتمل"]})})]}),d.jsxs("div",{className:"flex gap-2 mt-3",children:[d.jsx("button",{onClick:()=>P(F.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),d.jsx("button",{onClick:()=>b(F.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),d.jsx("button",{onClick:()=>w(F.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},F.id)}):d.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:d.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),d.jsxs("div",{className:"glass-card p-6 mt-8",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 سجل دفعات الأقساط"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المصدر"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الإجراءات"})]})}),d.jsx("tbody",{children:H.sort((F,O)=>new Date(O.date).getTime()-new Date(F.date).getTime()).map(F=>d.jsxs("tr",{className:"border-b border-gray-200/50",children:[d.jsx("td",{className:"p-3",children:new Date(F.date).toLocaleDateString("en-GB")}),d.jsx("td",{className:"p-3 text-slate-600",children:F.description}),d.jsx("td",{className:"p-3",children:yd(F.paymentMethod,n)}),d.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:ke(F.amount)}),d.jsx("td",{className:"p-3",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>T(F.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),d.jsx("button",{onClick:()=>E(F.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},F.id))})]})})]}),o&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:F=>F.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),d.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(F=>F.paid>=F.total).map(F=>d.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-green-800",children:F.description}),d.jsx("p",{className:"text-sm text-green-600",children:yd(F.provider,n)})]}),d.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:F.total}),d.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:ke(F.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:ke(F.total*F.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},F.id)),Object.values(n.installments).filter(F=>F.paid>=F.total).length===0&&d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),d.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),d.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),d.jsx("div",{className:"flex justify-end mt-6",children:d.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},FE=({onClose:n,onSave:e,initialData:t,type:i})=>{const[o,l]=fe.useState({[i==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[u,f]=fe.useState({});wp.useEffect(()=>{t&&l(t)},[t]);const g=b=>{const{name:w,value:P}=b.target;l(U=>({...U,[w]:w==="amount"?parseFloat(P)||0:P})),u[w]&&f(U=>({...U,[w]:""}))},h=()=>{const b={};return o[i==="toMe"?"debtor":"creditor"]||(b[i==="toMe"?"debtor":"creditor"]="اسم المدين/الدائن مطلوب"),o.amount<=0&&(b.amount="المبلغ يجب أن يكون أكبر من صفر"),o.description.trim()||(b.description="وصف الدين مطلوب"),o.date||(b.date="تاريخ الدين مطلوب"),f(b),Object.keys(b).length===0},T=b=>{b.preventDefault(),h()&&e(o,t==null?void 0:t.id)},E=i==="toMe";return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:E?"إضافة دين لي":"إضافة دين علي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(ju,{})})]}),d.jsxs("form",{onSubmit:T,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:E?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:E?"اسم المدين":"اسم الدائن"}),d.jsx("input",{type:"text",id:E?"debtor":"creditor",name:E?"debtor":"creditor",value:o[E?"debtor":"creditor"],onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:E?"اسم الشخص الذي يدين لي":"اسم الشخص الذي أدين له",required:!0}),u[E?"debtor":"creditor"]&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u[E?"debtor":"creditor"]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",value:o.amount,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),u.amount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.amount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:E?"من أين دينني":"أين أضفت الدين"}),d.jsx("input",{type:"text",id:"source",name:"source",value:o.source,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:E?"مثال: بنك الراجحي، تطبيق ستور":"مثال: بنك الأهلي، تطبيق تابي"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"السبب (اختياري)"}),d.jsx("textarea",{id:"reason",name:"reason",value:o.reason,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"سبب الدين أو تفاصيل إضافية..."})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"وصف الدين"}),d.jsx("input",{type:"text",id:"description",name:"description",value:o.description,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف مختصر للدين",required:!0}),u.description&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.description})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ الدين"}),d.jsx("input",{type:"date",id:"date",name:"date",value:o.date,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),u.date&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.date})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"الحالة"}),d.jsxs("select",{id:"status",name:"status",value:o.status,onChange:g,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"pending",children:"معلق"}),d.jsx("option",{value:"partial",children:"جزئي"}),d.jsx("option",{value:"paid",children:"مدفوع"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"إضافة الدين"})]})]})]})})})},y4=({state:n,setState:e,setModal:t,openLoanFormModal:i})=>{const[o,l]=fe.useState("loans"),[u,f]=fe.useState(!1),[g,h]=fe.useState(!1),[T,E]=fe.useState(!1),b=C=>{switch(C){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},w=C=>{switch(C){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},P=C=>{switch(C){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},U=C=>{switch(C){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},H=C=>{e(N=>({...N,loans:Object.fromEntries(Object.entries(N.loans).filter(([k])=>k!==C))}))},ne=C=>{const N={...C,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(k=>({...k,debtsToMe:{...k.debtsToMe,[N.id]:N}})),h(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين من "${N.debtor}" بقيمة ${ke(N.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},F=C=>{const N={...C,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(k=>({...k,debtsFromMe:{...k.debtsFromMe,[N.id]:N}})),E(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين لـ "${N.creditor}" بقيمة ${ke(N.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},O=C=>{e(N=>({...N,debtsToMe:Object.fromEntries(Object.entries(N.debtsToMe).filter(([k])=>k!==C))}))},z=C=>{e(N=>({...N,debtsFromMe:Object.fromEntries(Object.entries(N.debtsFromMe).filter(([k])=>k!==C))}))},Z=Object.values(n.loans).filter(C=>C.status==="active").length,W=Object.values(n.debtsToMe).filter(C=>C.status!=="paid").length,R=Object.values(n.debtsFromMe).filter(C=>C.status!=="paid").length;return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"📊 الديون والقروض"})}),d.jsxs("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[d.jsxs("button",{onClick:()=>l("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="loans"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["🏦 القروض (",Z,")"]}),d.jsxs("button",{onClick:()=>l("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="debts-to-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💰 الديون لي (",W,")"]}),d.jsxs("button",{onClick:()=>l("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${o==="debts-from-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💸 الديون علي (",R,")"]})]}),o==="loans"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),d.jsx("button",{onClick:()=>i(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),d.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(C=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:b(C.type)})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:C.name}),d.jsxs("p",{className:"text-sm text-slate-500",children:[w(C.type)," - ",C.lender]})]})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>i(C.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${C.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>H(C.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${C.name}`,children:d.jsx(Va,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:ke(C.totalAmount)})]}),(C.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[d.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),d.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((C.prepaidAmount||0)/C.totalAmount*100),"%"]})]}),d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(C.prepaidAmount||0)/C.totalAmount*100}%`}})}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[d.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[d.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((C.prepaidAmount||0)/C.monthlyPayment)}),d.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),d.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[d.jsx("p",{className:"text-blue-700 font-bold text-sm",children:C.totalMonths-Math.floor((C.prepaidAmount||0)/C.monthlyPayment)}),d.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),d.jsx("p",{className:"font-semibold text-slate-800",children:ke(C.monthlyPayment)})]}),d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),d.jsxs("p",{className:"font-semibold text-slate-800",children:[C.remainingMonths||0," شهر"]})]})]}),(C.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),d.jsx("p",{className:"text-orange-900 font-bold text-lg",children:ke(C.prepaidAmount||0)})]}),d.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),d.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(C.status)}`,children:U(C.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(C.startDate).toLocaleDateString("en-GB")]})]})]})]},C.id))})]}),o==="debts-to-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),d.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💰"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(C=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:C.debtor}),d.jsx("p",{className:"text-sm text-slate-500",children:C.description})]}),d.jsx("button",{onClick:()=>O(C.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${C.debtor}`,children:d.jsx(Va,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-green-900",children:ke(C.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(C.status)}`,children:U(C.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(C.date).toLocaleDateString("ar-SA")]})]})]})]},C.id))})]}),o==="debts-from-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),d.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💸"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(C=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:C.creditor}),d.jsx("p",{className:"text-sm text-slate-500",children:C.description})]}),d.jsx("button",{onClick:()=>z(C.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${C.creditor}`,children:d.jsx(Va,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-red-900",children:ke(C.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(C.status)}`,children:U(C.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(C.date).toLocaleDateString("ar-SA")]})]})]})]},C.id))})]}),g&&d.jsx(FE,{onClose:()=>h(!1),onSave:ne,type:"toMe"}),T&&d.jsx(FE,{onClose:()=>E(!1),onSave:F,type:"fromMe"})]})},v4=({state:n,setState:e,setModal:t,setLoading:i,onRestore:o})=>{const[l,u]=fe.useState(Ra()),[f,g]=fe.useState({connected:!1}),[h,T]=fe.useState(!0),[E,b]=fe.useState({firebase:l.hasFirebase,gemini:l.hasGemini});fe.useEffect(()=>{const ie=Ra();u(ie),b({firebase:ie.hasFirebase,gemini:ie.hasGemini}),ie.hasFirebase?(async()=>{try{T(!0);const be=await Ai.getData("test","connection");g({connected:!0})}catch(be){g({connected:!1,error:be instanceof Error?be.message:"خطأ في الاتصال"})}finally{T(!1)}})():(g({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),T(!1))},[]);const w=({isValid:ie})=>ie?d.jsx(qm,{className:"w-6 h-6 text-green-500"}):d.jsx(Bm,{className:"w-6 h-6 text-red-500"}),P=()=>d.jsx(XU,{className:"w-6 h-6 text-yellow-500"}),[U,H]=fe.useState({name:"",icon:""}),[ne,F]=fe.useState(null),[O,z]=fe.useState({name:"",icon:""}),[Z,W]=fe.useState({name:"",icon:""}),R=()=>{if(!U.name.trim()||!U.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة للفئة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`cat-${Date.now()}`,name:U.name.trim(),icon:U.icon.trim()};e(be=>({...be,categories:[...be.categories,ce]})),H({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},[C,N]=fe.useState(!1),k=async()=>{const ie=U.name.trim();if(!ie){t({title:"خطأ",body:"<p>الرجاء إدخال اسم الفئة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}N(!0);try{const{suggestCategoryIcon:ce,initializeAi:be}=await vi(async()=>{const{suggestCategoryIcon:nt,initializeAi:Tn}=await Promise.resolve().then(()=>UM);return{suggestCategoryIcon:nt,initializeAi:Tn}},void 0);be();const et=await ce(ie);et&&et.trim()?H(nt=>({...nt,icon:et.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{N(!1)}},V=ie=>{n.transactions.some(ce=>ce.categoryId===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات. يرجى تغيير فئة الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,categories:ce.categories.filter(be=>be.id!==ie)})),t({title:"نجح",body:"<p>تم حذف الفئة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},[j,D]=fe.useState(!1),Le=async()=>{const ie=O.name.trim();if(!ie){t({title:"خطأ",body:"<p>يرجى إدخال اسم نوع الحركة أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{D(!0);const ce=await Zm(ie);ce&&ce.trim()?z(be=>({...be,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Transaction type icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{D(!1)}},[he,$]=fe.useState(!1),de=async()=>{const ie=Z.name.trim();if(!ie){t({title:"خطأ",body:"<p>يرجى إدخال اسم وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"});return}try{$(!0);const ce=await Zm(ie);ce&&ce.trim()?W(be=>({...be,icon:ce.trim()})):t({title:"خطأ",body:"<p>لم أتمكن من العثور على أيقونة مناسبة.</p>",hideCancel:!0,confirmText:"موافق"})}catch(ce){console.error("Payment method icon suggestion error:",ce),t({title:"خطأ",body:`<p>حدث خطأ أثناء اقتراح الأيقونة. تأكد من إعداد مفتاح Gemini API بشكل صحيح.</p><p>تفاصيل الخطأ: ${ce.message}</p>`,hideCancel:!0,confirmText:"موافق"})}finally{$(!1)}},ve=()=>{if(!O.name.trim()||!O.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لنوع الحركة.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-type-${Date.now()}`,name:O.name.trim(),icon:O.icon.trim(),isCustom:!0};e(be=>({...be,customTransactionTypes:[...be.customTransactionTypes||[],ce]})),z({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},Be=ie=>{n.transactions.some(ce=>ce.type===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات. يرجى تغيير نوع الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customTransactionTypes:(ce.customTransactionTypes||[]).filter(be=>be.id!==ie)})),t({title:"نجح",body:"<p>تم حذف نوع الحركة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},Ze=()=>{if(!Z.name.trim()||!Z.icon.trim()){t({title:"خطأ",body:"<p>يرجى إدخال اسم وأيقونة لوسيلة الدفع.</p>",hideCancel:!0,confirmText:"موافق"});return}const ce={id:`custom-payment-${Date.now()}`,name:Z.name.trim(),icon:Z.icon.trim(),isCustom:!0};e(be=>({...be,customPaymentMethods:[...be.customPaymentMethods||[],ce]})),W({name:"",icon:""}),t({title:"نجح",body:"<p>تم إضافة وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})},q=ie=>{n.transactions.some(ce=>ce.paymentMethod===ie)?t({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات. يرجى تغيير وسيلة الدفع أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):(e(ce=>({...ce,customPaymentMethods:(ce.customPaymentMethods||[]).filter(be=>be.id!==ie)})),t({title:"نجح",body:"<p>تم حذف وسيلة الدفع بنجاح.</p>",hideCancel:!0,confirmText:"موافق"}))},re=()=>{try{const ie=JSON.stringify(n,null,2),ce=new Blob([ie],{type:"application/json"}),be=URL.createObjectURL(ce),et=document.createElement("a");et.href=be,et.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(et),et.click(),document.body.removeChild(et),URL.revokeObjectURL(be),t({title:"نجح",body:"<p>تم إنشاء النسخة الاحتياطية المحلية بنجاح.</p>",hideCancel:!0,confirmText:"موافق"})}catch{t({title:"خطأ",body:"<p>فشل إنشاء النسخة الاحتياطية.</p>",hideCancel:!0,confirmText:"موافق"})}},ye=async()=>{i(!0,"جاري حفظ النسخة الاحتياطية في السحابة...");try{const ie=await Ai.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(ie.success)t({title:"نجح",body:"<p>تم حفظ النسخة الاحتياطية في السحابة بنجاح.</p>",hideCancel:!0,confirmText:"موافق"});else throw new Error(ie.error)}catch{t({title:"خطأ",body:"<p>فشل في حفظ النسخة الاحتياطية في السحابة.</p>",hideCancel:!0,confirmText:"موافق"})}finally{i(!1)}},_e=ie=>{var et;const ce=(et=ie.target.files)==null?void 0:et[0];if(!ce)return;const be=new FileReader;be.onload=nt=>{var Tn;try{const St=JSON.parse((Tn=nt.target)==null?void 0:Tn.result);if(St!=null&&St.transactions&&(St!=null&&St.categories))o?o(St):t({show:!0,title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية.</p>",confirmText:"نعم، استعادة",onConfirm:()=>{const Es={transactions:St.transactions||[],categories:St.categories||[],installments:St.installments||[],investments:St.investments||{currentValue:0},cards:St.cards||{},bankAccounts:St.bankAccounts||{}};e(Es),t({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح.</p>",confirmText:"موافق",hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:"خطأ",body:"<p>فشل في استعادة النسخة الاحتياطية. الملف غير صالح.</p>",confirmText:"موافق",hideCancel:!0})}},be.readAsText(ce),ie.target.value=""};return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"⚙️ إعدادات النظام"})}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"🔑 حالة مفاتيح API"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🔥"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800",children:"Firebase Configuration"}),d.jsxs("p",{className:"text-sm text-slate-600",children:["Project ID: ",Lt.firebase.projectId]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:E.firebase?f.connected?d.jsxs(d.Fragment,{children:[d.jsx(qm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(P,{}),d.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),d.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🤖"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),d.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",Lt.gemini.model]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:E.gemini?d.jsxs(d.Fragment,{children:[d.jsx(qm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!l.isValid&&d.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[d.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),d.jsx("ul",{className:"space-y-1",children:l.errors.map((ie,ce)=>d.jsxs("li",{className:"text-sm text-red-600",children:["• ",ie]},ce))})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📱 معلومات المشروع"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Lt.app.name})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Lt.app.version})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Lt.app.environment})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(w,{isValid:l.isValid&&f.connected}),d.jsx("span",{className:`text-sm font-semibold ${l.isValid&&f.connected?"text-green-600":"text-red-600"}`,children:l.isValid&&f.connected?"جاهز":"يحتاج إعداد"})]})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),d.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!l.isValid||!f.connected)&&d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📝 تعليمات الإعداد"}),d.jsxs("div",{className:"space-y-4",children:[!E.gemini&&d.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),d.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[d.jsxs("li",{children:["اذهب إلى ",d.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),d.jsx("li",{children:"أنشئ مفتاح API جديد"}),d.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),d.jsxs("li",{children:["أو ضعه في ملف ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!E.firebase&&d.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),d.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",d.jsx("br",{}),"• VITE_FIREBASE_API_KEY",d.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",d.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",d.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",d.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",d.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📂 إدارة الفئات"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم الفئة",value:U.name,onChange:ie=>H(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:U.icon,onChange:ie=>H(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:k,disabled:!U.name.trim()||C,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:C?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),d.jsx("button",{onClick:R,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(ie=>d.jsxs("div",{className:"p-3 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-lg",children:ie.icon}),d.jsx("span",{className:"text-sm font-medium text-slate-800",children:ie.name})]}),d.jsx("button",{onClick:()=>V(ie.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},ie.id))})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:O.name,onChange:ie=>z(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:O.icon,onChange:ie=>z(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:Le,disabled:!O.name.trim()||j,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:j?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:ve,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(ie=>d.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:ie.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:ie.name})]}),d.jsx("button",{onClick:()=>Be(ie.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},ie.id))})]}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:Z.name,onChange:ie=>W(ce=>({...ce,name:ie.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:Z.icon,onChange:ie=>W(ce=>({...ce,icon:ie.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:de,disabled:!Z.name.trim()||he,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:he?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(ie=>d.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:ie.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:ie.name})]}),d.jsx("button",{onClick:()=>q(ie.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},ie.id))})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💰 دخل"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💸 مصاريف"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 سداد قسط"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 إيداع استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 سحب استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),d.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[d.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💵 نقدي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تابي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تمارا"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💳 سداد البطاقات"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"💾 النسخ الاحتياطي والاستعادة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),d.jsx("button",{onClick:re,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),d.jsx("button",{onClick:ye,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),d.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:_e}),d.jsx("button",{onClick:()=>{var ie;return(ie=document.getElementById("backup-file"))==null?void 0:ie.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors",children:"📥 استعادة البيانات"})]})]})]}),d.jsx("div",{className:"text-center",children:d.jsx("button",{onClick:()=>{u(Ra()),window.location.reload()},disabled:h,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:h?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},_4=({onClose:n,onSave:e,initialData:t,categories:i,cards:o,bankAccounts:l,loans:u,setModalConfig:f})=>{var Le;const[g,h]=fe.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((Le=i.find(he=>he.name==="أخرى"))==null?void 0:Le.id)||null}),[T,E]=fe.useState(!1),[b,w]=fe.useState(""),[P,U]=fe.useState({isOpen:!1,text:""}),[H,ne]=fe.useState(!1),[F,O]=fe.useState(!1),[z,Z]=fe.useState(4),[W,R]=fe.useState(Object.keys(l)[0]||"cash");fe.useEffect(()=>{var he;t?h(t):(he=navigator.clipboard)!=null&&he.readText&&(async()=>{try{const $=await navigator.clipboard.readText();$&&$.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==$&&U({isOpen:!0,text:$})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const C=he=>{const{name:$,value:de}=he.target;if($==="paymentMethod"){const ve=de.includes("bnpl");O(ve),ve&&h(Be=>({...Be,type:"expense"}))}h(ve=>({...ve,[$]:$==="amount"?parseFloat(de):de}))},N=he=>{if(he.preventDefault(),g.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(de=>de.status==="active").length>0){ne(!0);return}F&&g.paymentMethod.includes("bnpl")?e({...g,bnplData:{installmentsCount:z,initialPaymentSource:W,installmentAmount:g.amount/z}},t==null?void 0:t.id):e(g,t==null?void 0:t.id)},k=async he=>{if(he.trim()){E(!0),w("");try{const $=await gx(he,i,o,l),de=JSON.parse($);de.error?w(de.error):h(ve=>({...ve,amount:de.amount||ve.amount,date:de.date||ve.date,description:de.merchant||ve.description,paymentMethod:de.paymentMethod||ve.paymentMethod,categoryId:de.categoryId||ve.categoryId}))}catch($){w($ instanceof Error?$.message:"فشل تحليل النص."),console.error($)}finally{E(!1)}}},V=async()=>{w("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){w("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const he=await navigator.clipboard.readText();he&&he.trim().length>0?k(he):w("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(he){console.error("Clipboard operation failed: ",he),w("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},j=fe.useMemo(()=>{const he=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach($=>he.push({value:$.id,label:`🏦 ${$.name}`})),Object.values(o).forEach($=>he.push({value:$.id,label:`💳 ${$.name}`})),he.push({value:"tabby-bnpl",label:"📱 تابي"}),he.push({value:"tamara-bnpl",label:"📱 تمارا"}),he},[l,o]),D=fe.useMemo(()=>{const he=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(o).forEach($=>he.push({value:`${$.id}-payment`,label:`💳 سداد ${$.name}`})),he},[o]);return d.jsxs(d.Fragment,{children:[P.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>U({isOpen:!1,text:""}),children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:he=>he.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),d.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:P.text}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",P.text),U({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),d.jsx("button",{onClick:()=>{U({isOpen:!1,text:""}),k(P.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:he=>he.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(ju,{})})]}),d.jsxs("button",{type:"button",onClick:V,disabled:T,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[d.jsx(GU,{}),d.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),T&&d.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),d.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),b&&d.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:b}),d.jsxs("form",{onSubmit:N,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),d.jsx("input",{type:"number",name:"amount",value:g.amount,onChange:C,className:"w-full",required:!0,step:"0.01"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),d.jsx("input",{type:"date",name:"date",value:g.date,onChange:C,className:"w-full",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),d.jsx("input",{type:"text",name:"description",value:g.description,onChange:C,className:"w-full",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),d.jsx("select",{name:"type",value:g.type,onChange:C,className:"w-full",children:D.map(he=>d.jsx("option",{value:he.value,children:he.label},he.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),d.jsx("select",{name:"paymentMethod",value:g.paymentMethod,onChange:C,className:"w-full",children:j.map(he=>d.jsx("option",{value:he.value,children:he.label},he.value))})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),d.jsxs("select",{name:"categoryId",value:g.categoryId||"",onChange:C,className:"w-full",children:[d.jsx("option",{value:"",children:"-- اختر فئة --"}),i.map(he=>d.jsxs("option",{value:he.id,children:[he.icon," ",he.name]},he.id))]})]}),F&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[d.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),d.jsxs("select",{value:z,onChange:he=>Z(parseInt(he.target.value)),className:"w-full",children:[d.jsx("option",{value:2,children:"قسطين (2)"}),d.jsx("option",{value:3,children:"3 أقساط"}),d.jsx("option",{value:4,children:"4 أقساط"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),d.jsx("select",{value:W,onChange:he=>R(he.target.value),className:"w-full",children:j.filter(he=>!he.value.includes("bnpl")).map(he=>d.jsx("option",{value:he.value,children:he.label},he.value))})]})]}),d.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:d.jsxs("p",{className:"text-sm text-blue-700",children:[d.jsx("strong",{children:"الدفعة الأولى:"})," ",(g.amount/z).toFixed(2)," ريال",d.jsx("br",{}),d.jsx("strong",{children:"المبلغ المتبقي:"})," ",(g.amount*(z-1)/z).toFixed(2)," ريال"]})})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),H&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:he=>he.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),d.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(he=>he.status==="active").map(he=>d.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:d.jsx("div",{className:"flex justify-between items-center",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:he.name}),d.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",he.monthlyPayment.toLocaleString()," ريال"]})]})})},he.id))}),d.jsxs("div",{className:"flex justify-end gap-3",children:[d.jsx("button",{onClick:()=>{ne(!1),e(g,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),d.jsx("button",{onClick:()=>{ne(!1);const he=Object.values(u).filter(ve=>ve.status==="active"),$=he.reduce((ve,Be)=>ve+Be.monthlyPayment,0),de={...g};he.map(ve=>({id:`trans-${Date.now()}-loan-${ve.id}`,amount:ve.monthlyPayment,date:g.date,description:`قسط شهري - ${ve.name}`,paymentMethod:g.paymentMethod,type:"expense",categoryId:null})),e(de,t==null?void 0:t.id),f({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${$.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},T4=({onClose:n,onSave:e,initialData:t})=>{var f;const[i,o]=fe.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});fe.useEffect(()=>{t&&o(t)},[t]);const l=g=>{const{name:h,value:T,type:E}=g.target;o(h==="smsSamples"?b=>({...b,smsSamples:T.split(",").map(w=>w.trim()).filter(Boolean)}):b=>({...b,[h]:E==="number"?parseFloat(T)||0:T}))},u=g=>{g.preventDefault(),e(i,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:g=>g.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(ju,{})})]}),d.jsxs("form",{onSubmit:u,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),d.jsx("input",{type:"text",name:"name",value:i.name,onChange:l,className:"w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),d.jsx("input",{type:"number",name:"limit",value:i.limit,onChange:l,className:"w-full p-2",required:!0,step:"100"})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),d.jsx("input",{type:"number",name:"statementDay",value:i.statementDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),d.jsx("input",{type:"number",name:"dueDay",value:i.dueDay,onChange:l,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((f=i.smsSamples)==null?void 0:f.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},E4=({onClose:n,onSave:e,initialData:t})=>{var f;const[i,o]=fe.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});fe.useEffect(()=>{t&&o(t)},[t]);const l=g=>{const{name:h,value:T,type:E}=g.target;o(h==="smsSamples"?b=>({...b,smsSamples:T.split(",").map(w=>w.trim()).filter(Boolean)}):b=>({...b,[h]:E==="number"?parseFloat(T)||0:T}))},u=g=>{g.preventDefault(),e(i,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:g=>g.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(ju,{})})]}),d.jsxs("form",{onSubmit:u,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),d.jsx("input",{type:"text",name:"name",value:i.name,onChange:l,className:"w-full p-2",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),d.jsx("input",{type:"number",name:"balance",value:i.balance,onChange:l,className:"w-full p-2",required:!0,step:"10"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),d.jsxs("select",{name:"currency",value:i.currency||"SAR",onChange:l,className:"w-full p-2",required:!0,children:[d.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),d.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),d.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),d.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),d.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),d.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),d.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),d.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),d.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),d.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((f=i.smsSamples)==null?void 0:f.join(", "))||"",onChange:l,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},x4=({onClose:n,onSave:e,initialData:t,bankAccounts:i})=>{const[o,l]=fe.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[u,f]=fe.useState({});fe.useEffect(()=>{t&&l(t)},[t]),fe.useEffect(()=>{if(o.totalAmount>0&&o.downPayment>=0&&o.finalPayment>=0&&o.monthlyPayment>0){const w=o.totalAmount-o.downPayment-o.finalPayment-(o.prepaidAmount||0);if(w>0){const P=Math.ceil(w/o.monthlyPayment),U=new Date(o.startDate),H=new Date(U);H.setMonth(H.getMonth()+P),l(ne=>({...ne,totalMonths:P,endDate:H.toISOString().split("T")[0],remainingMonths:P}))}}},[o.totalAmount,o.downPayment,o.finalPayment,o.monthlyPayment,o.startDate,o.prepaidAmount]),fe.useEffect(()=>{if(o.prepaidAmount&&o.monthlyPayment>0){const w=Math.floor(o.prepaidAmount/o.monthlyPayment);l(P=>({...P,prepaidInstallments:w}))}else l(w=>({...w,prepaidInstallments:0}))},[o.prepaidAmount,o.monthlyPayment]);const g=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],h=w=>{const{name:P,value:U}=w.target;l(H=>({...H,[P]:P.includes("Amount")||P.includes("Payment")||P.includes("Months")?parseFloat(U)||0:U})),u[P]&&f(H=>({...H,[P]:""}))},T=()=>{const w={};return o.name.trim()||(w.name="اسم القرض مطلوب"),o.totalAmount<=0&&(w.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),o.downPayment<0&&(w.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),o.finalPayment<0&&(w.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),o.monthlyPayment<=0&&(w.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),o.lender.trim()||(w.lender="اسم البنك أو المؤسسة مطلوب"),o.startDate||(w.startDate="تاريخ بداية القرض مطلوب"),o.downPayment+o.finalPayment>=o.totalAmount&&(w.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),f(w),Object.keys(w).length===0},E=w=>{if(w.preventDefault(),!T())return;const P={...o,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(P)},b=Object.values(i).map(w=>({value:w.id,label:`${w.name} (${w.currency})`}));return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:w=>w.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(ju,{})})]}),d.jsxs("form",{onSubmit:E,className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),d.jsx("select",{id:"type",name:"type",value:o.type,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:g.map(w=>d.jsxs("option",{value:w.value,children:[w.icon," ",w.label]},w.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),d.jsx("input",{type:"text",id:"name",name:"name",value:o.name,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),u.name&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.name})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),d.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:o.totalAmount,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.totalAmount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.totalAmount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),d.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:o.downPayment,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.downPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.downPayment})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),d.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:o.finalPayment,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.finalPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.finalPayment})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),d.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:o.monthlyPayment,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),u.monthlyPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.monthlyPayment})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),d.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:o.prepaidAmount||0,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),d.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(o.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[d.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",o.prepaidInstallments||0," قسط"]}),d.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(o.totalAmount-o.downPayment-o.finalPayment-(o.prepaidAmount||0))," ريال"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),d.jsx("input",{type:"date",id:"startDate",name:"startDate",value:o.startDate,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),u.startDate&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.startDate})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),d.jsx("input",{type:"date",id:"endDate",name:"endDate",value:o.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),d.jsx("input",{type:"text",id:"lender",name:"lender",value:o.lender,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),u.lender&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.lender})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),d.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:o.linkedAccount,onChange:h,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"اختر حساب بنكي"}),b.map(w=>d.jsx("option",{value:w.value,children:w.label},w.value))]})]})]}),o.totalMonths>0&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",o.totalMonths," شهر"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",o.remainingMonths," شهر"]})]})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},b4=()=>{var ji,Fi,ss,Do,Or;const[n,e]=fe.useState(!1),[t,i]=fe.useState(ld),[o,l]=fe.useState(new Date().getFullYear()),[u,f]=fe.useState(new Date().getMonth()+1),[g,h]=fe.useState("summary"),[T,E]=fe.useState({isLoading:!1,text:""}),[b,w]=fe.useState(null),[P,U]=fe.useState({isOpen:!1}),[H,ne]=fe.useState({isOpen:!1}),[F,O]=fe.useState({isOpen:!1}),[z,Z]=fe.useState({isOpen:!1}),[W,R]=fe.useState({isOpen:!1}),[C,N]=fe.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[k,V]=fe.useState(!1),[j,D]=fe.useState(""),[Le,he]=fe.useState(null),[$,de]=fe.useState(!1),[ve,Be]=fe.useState(!0);fe.useEffect(()=>{(async()=>{mx();const pe=await Ai.onAuthStateChanged(async me=>{try{me?(console.log("✅ تم تسجيل دخول المستخدم:",me.email),he(me),await Ze(me.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),he(null),await q())}catch(Te){console.error("خطأ في تحميل بيانات المستخدم:",Te),await q()}finally{Be(!1),e(!0)}});return()=>{typeof pe=="function"&&pe()}})()},[]),fe.useEffect(()=>(P.isOpen||H.isOpen||F.isOpen||z.isOpen||W.isOpen||b||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[P.isOpen,H.isOpen,F.isOpen,z.isOpen,W.isOpen,b,T.isLoading]),fe.useEffect(()=>{t.settings.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const Y=document.documentElement;t.settings.language==="ar"?(Y.setAttribute("lang","ar"),Y.setAttribute("dir","rtl")):(Y.setAttribute("lang","en"),Y.setAttribute("dir","ltr"))},[t.settings.darkMode,t.settings.language]),fe.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(Y=>{console.log("Service Worker registered successfully:",Y)}).catch(Y=>{console.log("Service Worker registration failed:",Y)})},[]),fe.useEffect(()=>{var Y,pe;W.isOpen&&C.fromAccount&&C.toAccount&&((Y=t.bankAccounts[C.fromAccount])==null?void 0:Y.currency)!==((pe=t.bankAccounts[C.toAccount])==null?void 0:pe.currency)&&Xt()},[C.fromAccount,C.toAccount,W.isOpen]);const Ze=async Y=>{var pe;try{const me=await Ai.getData("users",Y);if(me.success&&me.data){const Te=ld(),Re={...Te,...me.data,cards:{...Te.cards,...me.data.cards||{}},bankAccounts:{...Te.bankAccounts,...me.data.bankAccounts||{}},investments:{...Te.investments,...me.data.investments||{}}};i(Re),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else me.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",me.error),(pe=me.error)!=null&&pe.includes("الأذونات")&&w({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(me){console.error("خطأ في تحميل بيانات المستخدم:",me)}},q=async()=>{try{const Y=localStorage.getItem("financial_dashboard_state");if(Y){const pe=JSON.parse(Y),me=ld(),Te={...me,...pe,cards:{...me.cards,...pe.cards||{}},bankAccounts:{...me.bankAccounts,...pe.bankAccounts||{}},investments:{...me.investments,...pe.investments||{}}};i(Te),console.log("✅ تم تحميل البيانات من localStorage")}}catch(Y){console.error("خطأ في تحميل البيانات المحلية:",Y)}};fe.useEffect(()=>{if(n&&!ve&&(localStorage.setItem("financial_dashboard_state",JSON.stringify(t)),Le)){const pe=setTimeout(async()=>{try{const me=await Ai.saveData("users",Le.uid,t);me.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",me.error)}catch(me){console.error("❌ خطأ في حفظ البيانات في Firebase:",me)}},2e3);return()=>clearTimeout(pe)}},[t,n,Le,ve]);const re=(Y,pe="")=>E({isLoading:Y,text:pe}),ye=fe.useCallback(()=>t.transactions?t.transactions.filter(Y=>{const pe=new Date(Y.date),me=pe.getFullYear()===o,Te=u==="all"||pe.getMonth()+1===u;return me&&Te}):[],[t.transactions,o,u]),_e=fe.useMemo(()=>ye(),[ye]),ie=fe.useMemo(()=>{const Y={},pe={},me={},Te={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(Ee=>{Ee&&Ee.id&&(me[Ee.id]={...Ee,balance:0,available:Ee.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(Ee=>{Ee&&Ee.id&&(Te[Ee.id]={...Ee,deposits:0,withdrawals:0})});let Re=0,Ue=0,jr=0,Xs=0;_e.forEach(Ee=>{if(Ee.type==="income")Re+=Ee.amount;else if(Ee.type==="expense")Ue+=Ee.amount,Ee.categoryId&&(Y[Ee.categoryId]=(Y[Ee.categoryId]||0)+Ee.amount);else if(Ee.type==="bnpl-payment")Ue+=Ee.amount,Ee.categoryId&&(Y[Ee.categoryId]=(Y[Ee.categoryId]||0)+Ee.amount);else if(Ee.type==="investment-deposit")jr+=Ee.amount,Ue+=Ee.amount;else if(Ee.type==="investment-withdrawal")Xs+=Ee.amount,Re+=Ee.amount;else if(Ee.type.endsWith("-payment")){const ft=Ee.type.replace("-payment","");pe[ft]?pe[ft]+=Ee.amount:pe[ft]=Ee.amount}}),Object.keys(t.cards).forEach(Ee=>{const ft=t.cards[Ee];let Ut=0;t.transactions.forEach(En=>{En.paymentMethod===Ee&&En.type==="expense"&&(Ut+=En.amount),En.type===`${Ee}-payment`&&(Ut-=En.amount)}),me[Ee].balance=Ut,me[Ee].available=ft.limit-Ut,me[Ee].usagePercentage=ft.limit>0?Ut/ft.limit*100:0}),Object.keys(t.bankAccounts).forEach(Ee=>{const ft=t.bankAccounts[Ee];let Ut=0,En=0,bs=ft.balance;t.transactions.forEach(Ye=>{Ye.paymentMethod===Ee&&(["income","investment-withdrawal"].includes(Ye.type)?bs+=Ye.amount:["expense","investment-deposit"].includes(Ye.type)&&(bs-=Ye.amount)),Ye.type.endsWith("-payment")&&Ye.paymentMethod===Ee&&(bs-=Ye.amount),Ye.type==="expense"&&Ye.isInstallmentPayment&&Ye.paymentMethod===Ee&&(bs-=Ye.amount)}),_e.forEach(Ye=>{Ye.paymentMethod===Ee&&(["income","investment-withdrawal"].includes(Ye.type)?Ut+=Ye.amount:["expense","investment-deposit"].includes(Ye.type)&&(En+=Ye.amount)),Ye.type.endsWith("-payment")&&Ye.paymentMethod===Ee&&(En+=Ye.amount),Ye.type==="expense"&&Ye.isInstallmentPayment&&Ye.paymentMethod===Ee&&(En+=Ye.amount)}),Te[Ee].balance=bs,Te[Ee].deposits=Ut,Te[Ee].withdrawals=En});const Po=Object.values(me).reduce((Ee,ft)=>Ee+ft.balance,0),qn=Object.values(me).reduce((Ee,ft)=>Ee+ft.available,0),Ws=Object.values(me).reduce((Ee,ft)=>Ee+ft.limit,0),It=Object.values(Te).reduce((Ee,ft)=>Ee+ft.balance,0);return{totalIncome:Re,totalExpenses:Ue,cardDetails:me,cardPayments:pe,bankAccountDetails:Te,totalDebt:Po,totalAvailable:qn,totalLimits:Ws,totalBankBalance:It,totalInvestmentDeposits:jr,totalInvestmentWithdrawals:Xs,expensesByCategory:Y}},[_e,t.transactions,t.cards,t.bankAccounts]),ce=(Y,pe)=>{i(me=>{if(pe){const Te=me.transactions.map(Re=>Re.id===pe?{...Re,...Y}:Re);return{...me,transactions:Te}}else if(Y.bnplData&&Y.paymentMethod.includes("bnpl")){const Te={id:`installment-${Date.now()}`,provider:Y.paymentMethod,description:Y.description,totalAmount:Y.amount,installmentAmount:Y.bnplData.installmentAmount,total:Y.bnplData.installmentsCount,paid:1,createdAt:Y.date},Re={id:`trans-${Date.now()}-1`,amount:Y.bnplData.installmentAmount,date:Y.date,description:`الدفعة الأولى لـ: ${Y.description}`,paymentMethod:Y.bnplData.initialPaymentSource,type:"expense",categoryId:Y.categoryId,isInstallmentPayment:!0,installmentId:Te.id};return{...me,transactions:[...me.transactions,Re],installments:[...me.installments,Te]}}else{const Te={id:`trans-${Date.now()}`,...Y};return{...me,transactions:[...me.transactions,Te]}}}),U({isOpen:!1})},be=Y=>{w({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{i(pe=>{const me=pe.transactions.find(Ue=>Ue.id===Y);if(!me)return pe;const Te=pe.transactions.filter(Ue=>Ue.id!==Y);let Re=pe.installments;return me.isInstallmentPayment&&me.installmentId&&(Re=pe.installments.map(Ue=>Ue.id===me.installmentId?{...Ue,paid:Math.max(0,Ue.paid-1)}:Ue)),{...pe,transactions:Te,installments:Re}}),w(null)}})},et=Y=>{const pe=t.transactions.find(me=>me.id===Y);pe&&U({isOpen:!0,initialData:pe})},nt=async Y=>{he(Y),de(!1),await Ze(Y.uid)},Tn=async()=>{try{const Y=await Ai.signOut();Y.success?(console.log("✅ تم تسجيل الخروج بنجاح"),he(null),await q()):console.error("❌ خطأ في تسجيل الخروج:",Y.error)}catch(Y){console.error("❌ خطأ في تسجيل الخروج:",Y)}},St=(Y,pe)=>{i(me=>{const Te={...me.cards};if(pe)Te[pe]={...Te[pe],...Y,id:pe};else{const Re=`card-${Date.now()}`;Te[Re]={...Y,id:Re}}return{...me,cards:Te}}),ne({isOpen:!1})},Es=Y=>{var pe;t.transactions.some(me=>me.paymentMethod===Y||me.type===`${Y}-payment`)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(pe=t.cards[Y])==null?void 0:pe.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const Te={...me.cards};return delete Te[Y],{...me,cards:Te}}),w(null)}})},Oi=(Y,pe)=>{i(me=>{const Te={...me.bankAccounts};if(pe)Te[pe]={...Te[pe],...Y,id:pe};else{const Re=`bank-${Date.now()}`;Te[Re]={...Y,id:Re}}return{...me,bankAccounts:Te}}),O({isOpen:!1})},Fn=Y=>{var pe;t.transactions.some(me=>me.paymentMethod===Y)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(pe=t.bankAccounts[Y])==null?void 0:pe.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const Te={...me.bankAccounts};return delete Te[Y],{...me,bankAccounts:Te}}),w(null)}})},Vr=Y=>{w({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const pe=ld();if(Y.creditCards&&!Y.cards){const Te={};Object.entries(Y.creditCards).forEach(([Re,Ue])=>{Te[Re]={id:Re,name:Re.toUpperCase(),limit:Ue.creditLimit||0,balance:Ue.currentBalance||0,dueDay:Ue.dueDay||1,smsSamples:[],keywords:[]}}),Y.cards=Te}if(Y.cards&&typeof Y.cards=="object"&&(Y.cards.snb||Y.cards.enbd)){const Te={};Y.cards.snb&&(Te["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:Y.cards.snb.limit||0,dueDay:Y.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),Y.cards.enbd&&(Te["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:Y.cards.enbd.limit||0,dueDay:Y.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),Y.cards=Te}Y.bank&&!Y.bankAccounts&&(Y.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:Y.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),Y.transactions&&Array.isArray(Y.transactions)&&(Y.transactions=Y.transactions.map(Te=>Te.paymentMethod==="mada-bank"?{...Te,paymentMethod:"bank-default"}:Te));const me={...pe,...Y};i(me),Le&&(async()=>{try{const Re=await Ai.saveData("users",Le.uid,me);Re.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",Re.error)}catch(Re){console.error("❌ خطأ في حفظ البيانات في Firebase:",Re)}})(),w({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{w({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},Ks=Y=>ne({isOpen:!0,initialData:Y?t.cards[Y]:null}),Lr=Y=>O({isOpen:!0,initialData:Y?t.bankAccounts[Y]:null}),Ur=Y=>Z({isOpen:!0,initialData:Y?t.loans[Y]:null}),wt=()=>{i(Y=>({...Y,settings:{...Y.settings,darkMode:!Y.settings.darkMode}}))},Mt=()=>{i(Y=>({...Y,settings:{...Y.settings,notifications:!Y.settings.notifications}}))},xs=()=>{i(Y=>({...Y,settings:{...Y.settings,language:Y.settings.language==="ar"?"en":"ar"}}))},sl=()=>{if(!C.fromAccount||!C.toAccount||C.amount<=0){w({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(C.fromAccount===C.toAccount){w({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const Y=t.bankAccounts[C.fromAccount],pe=t.bankAccounts[C.toAccount],me=C.amount*C.exchangeRate,Te={id:`trans-${Date.now()}-withdrawal`,amount:C.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(pe==null?void 0:pe.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.fromAccount,type:"expense",categoryId:null},Re={id:`trans-${Date.now()}-deposit`,amount:me,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(Y==null?void 0:Y.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.toAccount,type:"income",categoryId:null};i(Ue=>({...Ue,transactions:[...Ue.transactions,Te,Re]})),R({isOpen:!1}),N({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D(""),w({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Mo=Y=>{if(i(pe=>({...pe,loans:{...pe.loans,[Y.id]:Y}})),!Y.id.includes("edit")){const pe=[];Y.downPayment>0&&pe.push({id:`trans-${Date.now()}-down-payment`,amount:Y.downPayment,date:Y.startDate,description:`دفعة أولى - ${Y.name}`,paymentMethod:Y.linkedAccount||"cash",type:"expense",categoryId:null}),pe.push({id:`trans-${Date.now()}-loan-deposit`,amount:Y.totalAmount,date:Y.startDate,description:`إيداع قرض - ${Y.name} من ${Y.lender}`,paymentMethod:Y.linkedAccount||"cash",type:"income",categoryId:null}),Y.finalPayment>0&&Y.endDate&&pe.push({id:`trans-${Date.now()}-final-payment`,amount:Y.finalPayment,date:Y.endDate,description:`دفعة أخيرة - ${Y.name}`,paymentMethod:Y.linkedAccount||"cash",type:"expense",categoryId:null}),i(me=>({...me,transactions:[...me.transactions,...pe]}))}Z({isOpen:!1}),w({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Xt=async()=>{if(!C.fromAccount||!C.toAccount)return;const Y=t.bankAccounts[C.fromAccount],pe=t.bankAccounts[C.toAccount];if(!Y||!pe)return;const me=Y.currency||"SAR",Te=pe.currency||"SAR";if(me===Te){N(Re=>({...Re,exchangeRate:1})),D("");return}V(!0),D("");try{const Re=await _x(me,Te);N(Ue=>({...Ue,exchangeRate:Re.rate}))}catch(Re){D(Re instanceof Error?Re.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",Re)}finally{V(!1)}};if(!n||ve)return d.jsx(t4,{});if(!Le)return d.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:d.jsxs("div",{className:"w-full max-w-md px-4",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),d.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),d.jsx(OE,{onSuccess:nt,onClose:()=>{},hideCloseButton:!0})]})});`${o}${u==="all"?"كل الشهور":new Date(o,u-1).toLocaleString("ar-SA",{month:"long"})}`;const Qs=()=>{switch(g){case"summary":return d.jsx(i4,{calculations:ie,categories:t.categories});case"transactions":return d.jsx(r4,{transactions:_e,allTransactions:t.transactions,categories:t.categories,deleteTransaction:be,editTransaction:et,state:t});case"ai-assistant":return d.jsx(a4,{calculations:ie,filteredTransactions:_e});case"analysis":return d.jsx(l4,{calculations:ie,categories:t.categories,allTransactions:t.transactions});case"budget":return d.jsx(u4,{state:t,setLoading:re,setModal:w});case"investment":return d.jsx(c4,{state:t,setState:i,calculations:ie,setModal:w});case"cards":return d.jsx(f4,{state:t,openCardFormModal:Ks,deleteCard:Es});case"bank":return d.jsx(p4,{state:t,setState:i,calculations:ie,filteredTransactions:_e,categories:t.categories,setModal:w,openBankAccountFormModal:Lr,deleteBankAccount:Fn,openTransferModal:()=>R({isOpen:!0})});case"installments":return d.jsx(g4,{state:t,setState:i,filteredTransactions:_e,setModal:w});case"debts-loans":return d.jsx(y4,{state:t,setState:i,setModal:w,openLoanFormModal:Ur});case"settings":return d.jsx(v4,{state:t,setState:i,setModal:w,setLoading:re,onRestore:Vr});default:return d.jsx("div",{children:"Tab not found"})}};return d.jsxs("div",{className:`min-h-screen font-sans ${t.settings.darkMode?"dark":""}`,children:[d.jsx(WU,{selectedYear:o,selectedMonth:u,onYearChange:l,onMonthChange:Y=>f(Y),onAddTransaction:()=>U({isOpen:!0}),currentUser:Le,onSignOut:Tn}),d.jsx("div",{className:`backdrop-blur-sm border-b p-4 ${t.settings.darkMode?"bg-slate-800/80 border-slate-700":"bg-white/80 border-slate-200"}`,children:d.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:`text-sm font-medium ${t.settings.darkMode?"text-slate-200":"text-slate-700"}`,children:t.settings.language==="ar"?"الوضع المظلم":"Dark Mode"}),d.jsx(QC,{darkMode:t.settings.darkMode,onToggle:wt})]}),d.jsx(XC,{notifications:t.settings.notifications,onToggle:Mt,language:t.settings.language})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:xs,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${t.settings.darkMode?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-blue-100 hover:bg-blue-200 text-slate-700"}`,children:[d.jsx("span",{className:"text-sm font-medium",children:t.settings.language==="ar"?"العربية":"English"}),d.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${t.settings.darkMode?"bg-blue-500":"bg-blue-600"}`,children:d.jsx("span",{className:"text-white font-bold text-xs",children:t.settings.language==="ar"?"A":"E"})})]})})]})}),d.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx(ZU,{activeTab:g,setActiveTab:h}),Qs()]}),d.jsx("button",{onClick:()=>U({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),P.isOpen&&d.jsx(_4,{onClose:()=>U({isOpen:!1}),onSave:ce,initialData:P.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,loans:t.loans,setModalConfig:w}),H.isOpen&&d.jsx(T4,{onClose:()=>ne({isOpen:!1}),onSave:St,initialData:H.initialData}),F.isOpen&&d.jsx(E4,{onClose:()=>O({isOpen:!1}),onSave:Oi,initialData:F.initialData}),z.isOpen&&d.jsx(x4,{onClose:()=>Z({isOpen:!1}),onSave:Mo,initialData:z.initialData,bankAccounts:t.bankAccounts}),W.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{R({isOpen:!1}),N({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Y=>Y.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>{R({isOpen:!1}),N({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),d.jsxs("select",{id:"fromAccount",name:"fromAccount",value:C.fromAccount,onChange:Y=>N(pe=>({...pe,fromAccount:Y.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([Y,pe])=>d.jsx("option",{value:Y,children:pe.name},Y))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),d.jsxs("select",{id:"toAccount",name:"toAccount",value:C.toAccount,onChange:Y=>N(pe=>({...pe,toAccount:Y.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([Y])=>Y!==C.fromAccount).map(([Y,pe])=>d.jsx("option",{value:Y,children:pe.name},Y))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:C.amount,onChange:Y=>N(pe=>({...pe,amount:parseFloat(Y.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),C.fromAccount&&C.toAccount&&((ji=t.bankAccounts[C.fromAccount])==null?void 0:ji.currency)!==((Fi=t.bankAccounts[C.toAccount])==null?void 0:Fi.currency)&&d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(ss=t.bankAccounts[C.fromAccount])==null?void 0:ss.currency," → ",(Do=t.bankAccounts[C.toAccount])==null?void 0:Do.currency,")"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"number",step:"0.0001",value:C.exchangeRate,onChange:Y=>N(pe=>({...pe,exchangeRate:parseFloat(Y.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),d.jsxs("button",{type:"button",onClick:Xt,disabled:k,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[k?d.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",d.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),j&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:j}),d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(C.amount*C.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(Or=t.bankAccounts[C.toAccount])==null?void 0:Or.currency]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),d.jsx("input",{type:"text",id:"description",name:"description",value:C.description,onChange:Y=>N(pe=>({...pe,description:Y.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:()=>{R({isOpen:!1}),N({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),D("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"button",onClick:sl,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),b&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>w(null),children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Y=>Y.stopPropagation(),children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:b.title}),d.jsx("div",{className:"text-slate-600",dangerouslySetInnerHTML:{__html:b.body}}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!b.hideCancel&&d.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),d.jsx("button",{onClick:()=>{(!b.onConfirm||b.onConfirm()!==!1)&&w(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:b.confirmText||"موافق"})]})]})}),T.isLoading&&d.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),d.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),$&&Le&&d.jsx(OE,{onSuccess:nt,onClose:()=>de(!1)})]})},lS=document.getElementById("root");if(!lS)throw new Error("Could not find root element");const A4=KC.createRoot(lS);A4.render(d.jsx(wp.StrictMode,{children:d.jsx(b4,{})}));
