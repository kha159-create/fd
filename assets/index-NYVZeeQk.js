(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function GE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var bm={exports:{}},au={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function GC(){if(zv)return au;zv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:n,type:i,key:u,ref:o!==void 0?o:null,props:l}}return au.Fragment=e,au.jsx=t,au.jsxs=t,au}var Hv;function $C(){return Hv||(Hv=1,bm.exports=GC()),bm.exports}var f=$C(),Am={exports:{}},je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function YC(){if(Gv)return je;Gv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),b=Symbol.iterator;function I(F){return F===null||typeof F!="object"?null:(F=b&&F[b]||F["@@iterator"],typeof F=="function"?F:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,j={};function $(F,oe,_e){this.props=F,this.context=oe,this.refs=j,this.updater=_e||V}$.prototype.isReactComponent={},$.prototype.setState=function(F,oe){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,oe,"setState")},$.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function J(){}J.prototype=$.prototype;function ee(F,oe,_e){this.props=F,this.context=oe,this.refs=j,this.updater=_e||V}var q=ee.prototype=new J;q.constructor=ee,L(q,$.prototype),q.isPureReactComponent=!0;var X=Array.isArray;function z(){}var R={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function D(F,oe,_e){var xe=_e.ref;return{$$typeof:n,type:F,key:oe,ref:xe!==void 0?xe:null,props:_e}}function w(F,oe){return D(F.type,oe,F.props)}function P(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function U(F){var oe={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(_e){return oe[_e]})}var k=/\/+/g;function Oe(F,oe){return typeof F=="object"&&F!==null&&F.key!=null?U(""+F.key):oe.toString(36)}function Be(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(z,z):(F.status="pending",F.then(function(oe){F.status==="pending"&&(F.status="fulfilled",F.value=oe)},function(oe){F.status==="pending"&&(F.status="rejected",F.reason=oe)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function te(F,oe,_e,xe,Ie){var Ve=typeof F;(Ve==="undefined"||Ve==="boolean")&&(F=null);var Ke=!1;if(F===null)Ke=!0;else switch(Ve){case"bigint":case"string":case"number":Ke=!0;break;case"object":switch(F.$$typeof){case n:case e:Ke=!0;break;case T:return Ke=F._init,te(Ke(F._payload),oe,_e,xe,Ie)}}if(Ke)return Ie=Ie(F),Ke=xe===""?"."+Oe(F,0):xe,X(Ie)?(_e="",Ke!=null&&(_e=Ke.replace(k,"$&/")+"/"),te(Ie,oe,_e,"",function(Ge){return Ge})):Ie!=null&&(P(Ie)&&(Ie=w(Ie,_e+(Ie.key==null||F&&F.key===Ie.key?"":(""+Ie.key).replace(k,"$&/")+"/")+Ke)),oe.push(Ie)),1;Ke=0;var he=xe===""?".":xe+":";if(X(F))for(var ye=0;ye<F.length;ye++)xe=F[ye],Ve=he+Oe(xe,ye),Ke+=te(xe,oe,_e,Ve,Ie);else if(ye=I(F),typeof ye=="function")for(F=ye.call(F),ye=0;!(xe=F.next()).done;)xe=xe.value,Ve=he+Oe(xe,ye++),Ke+=te(xe,oe,_e,Ve,Ie);else if(Ve==="object"){if(typeof F.then=="function")return te(Be(F),oe,_e,xe,Ie);throw oe=String(F),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return Ke}function Z(F,oe,_e){if(F==null)return F;var xe=[],Ie=0;return te(F,xe,"","",function(Ve){return oe.call(_e,Ve,Ie++)}),xe}function ge(F){if(F._status===-1){var oe=F._result;oe=oe(),oe.then(function(_e){(F._status===0||F._status===-1)&&(F._status=1,F._result=_e)},function(_e){(F._status===0||F._status===-1)&&(F._status=2,F._result=_e)}),F._status===-1&&(F._status=0,F._result=oe)}if(F._status===1)return F._result.default;throw F._result}var Pe=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},De={map:Z,forEach:function(F,oe,_e){Z(F,function(){oe.apply(this,arguments)},_e)},count:function(F){var oe=0;return Z(F,function(){oe++}),oe},toArray:function(F){return Z(F,function(oe){return oe})||[]},only:function(F){if(!P(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return je.Activity=E,je.Children=De,je.Component=$,je.Fragment=t,je.Profiler=o,je.PureComponent=ee,je.StrictMode=i,je.Suspense=g,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,je.__COMPILER_RUNTIME={__proto__:null,c:function(F){return R.H.useMemoCache(F)}},je.cache=function(F){return function(){return F.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(F,oe,_e){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var xe=L({},F.props),Ie=F.key;if(oe!=null)for(Ve in oe.key!==void 0&&(Ie=""+oe.key),oe)!C.call(oe,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&oe.ref===void 0||(xe[Ve]=oe[Ve]);var Ve=arguments.length-2;if(Ve===1)xe.children=_e;else if(1<Ve){for(var Ke=Array(Ve),he=0;he<Ve;he++)Ke[he]=arguments[he+2];xe.children=Ke}return D(F.type,Ie,xe)},je.createContext=function(F){return F={$$typeof:u,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:l,_context:F},F},je.createElement=function(F,oe,_e){var xe,Ie={},Ve=null;if(oe!=null)for(xe in oe.key!==void 0&&(Ve=""+oe.key),oe)C.call(oe,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(Ie[xe]=oe[xe]);var Ke=arguments.length-2;if(Ke===1)Ie.children=_e;else if(1<Ke){for(var he=Array(Ke),ye=0;ye<Ke;ye++)he[ye]=arguments[ye+2];Ie.children=he}if(F&&F.defaultProps)for(xe in Ke=F.defaultProps,Ke)Ie[xe]===void 0&&(Ie[xe]=Ke[xe]);return D(F,Ve,Ie)},je.createRef=function(){return{current:null}},je.forwardRef=function(F){return{$$typeof:d,render:F}},je.isValidElement=P,je.lazy=function(F){return{$$typeof:T,_payload:{_status:-1,_result:F},_init:ge}},je.memo=function(F,oe){return{$$typeof:m,type:F,compare:oe===void 0?null:oe}},je.startTransition=function(F){var oe=R.T,_e={};R.T=_e;try{var xe=F(),Ie=R.S;Ie!==null&&Ie(_e,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(z,Pe)}catch(Ve){Pe(Ve)}finally{oe!==null&&_e.types!==null&&(oe.types=_e.types),R.T=oe}},je.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},je.use=function(F){return R.H.use(F)},je.useActionState=function(F,oe,_e){return R.H.useActionState(F,oe,_e)},je.useCallback=function(F,oe){return R.H.useCallback(F,oe)},je.useContext=function(F){return R.H.useContext(F)},je.useDebugValue=function(){},je.useDeferredValue=function(F,oe){return R.H.useDeferredValue(F,oe)},je.useEffect=function(F,oe){return R.H.useEffect(F,oe)},je.useEffectEvent=function(F){return R.H.useEffectEvent(F)},je.useId=function(){return R.H.useId()},je.useImperativeHandle=function(F,oe,_e){return R.H.useImperativeHandle(F,oe,_e)},je.useInsertionEffect=function(F,oe){return R.H.useInsertionEffect(F,oe)},je.useLayoutEffect=function(F,oe){return R.H.useLayoutEffect(F,oe)},je.useMemo=function(F,oe){return R.H.useMemo(F,oe)},je.useOptimistic=function(F,oe){return R.H.useOptimistic(F,oe)},je.useReducer=function(F,oe,_e){return R.H.useReducer(F,oe,_e)},je.useRef=function(F){return R.H.useRef(F)},je.useState=function(F){return R.H.useState(F)},je.useSyncExternalStore=function(F,oe,_e){return R.H.useSyncExternalStore(F,oe,_e)},je.useTransition=function(){return R.H.useTransition()},je.version="19.2.0",je}var $v;function Rp(){return $v||($v=1,Am.exports=YC()),Am.exports}var de=Rp();const Dp=GE(de);var Sm={exports:{}},lu={},Cm={exports:{}},wm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function JC(){return Yv||(Yv=1,(function(n){function e(te,Z){var ge=te.length;te.push(Z);e:for(;0<ge;){var Pe=ge-1>>>1,De=te[Pe];if(0<o(De,Z))te[Pe]=Z,te[ge]=De,ge=Pe;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var Z=te[0],ge=te.pop();if(ge!==Z){te[0]=ge;e:for(var Pe=0,De=te.length,F=De>>>1;Pe<F;){var oe=2*(Pe+1)-1,_e=te[oe],xe=oe+1,Ie=te[xe];if(0>o(_e,ge))xe<De&&0>o(Ie,_e)?(te[Pe]=Ie,te[xe]=ge,Pe=xe):(te[Pe]=_e,te[oe]=ge,Pe=oe);else if(xe<De&&0>o(Ie,ge))te[Pe]=Ie,te[xe]=ge,Pe=xe;else break e}}return Z}function o(te,Z){var ge=te.sortIndex-Z.sortIndex;return ge!==0?ge:te.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var g=[],m=[],T=1,E=null,b=3,I=!1,V=!1,L=!1,j=!1,$=typeof setTimeout=="function"?setTimeout:null,J=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function q(te){for(var Z=t(m);Z!==null;){if(Z.callback===null)i(m);else if(Z.startTime<=te)i(m),Z.sortIndex=Z.expirationTime,e(g,Z);else break;Z=t(m)}}function X(te){if(L=!1,q(te),!V)if(t(g)!==null)V=!0,z||(z=!0,U());else{var Z=t(m);Z!==null&&Be(X,Z.startTime-te)}}var z=!1,R=-1,C=5,D=-1;function w(){return j?!0:!(n.unstable_now()-D<C)}function P(){if(j=!1,z){var te=n.unstable_now();D=te;var Z=!0;try{e:{V=!1,L&&(L=!1,J(R),R=-1),I=!0;var ge=b;try{t:{for(q(te),E=t(g);E!==null&&!(E.expirationTime>te&&w());){var Pe=E.callback;if(typeof Pe=="function"){E.callback=null,b=E.priorityLevel;var De=Pe(E.expirationTime<=te);if(te=n.unstable_now(),typeof De=="function"){E.callback=De,q(te),Z=!0;break t}E===t(g)&&i(g),q(te)}else i(g);E=t(g)}if(E!==null)Z=!0;else{var F=t(m);F!==null&&Be(X,F.startTime-te),Z=!1}}break e}finally{E=null,b=ge,I=!1}Z=void 0}}finally{Z?U():z=!1}}}var U;if(typeof ee=="function")U=function(){ee(P)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Oe=k.port2;k.port1.onmessage=P,U=function(){Oe.postMessage(null)}}else U=function(){$(P,0)};function Be(te,Z){R=$(function(){te(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(te){switch(b){case 1:case 2:case 3:var Z=3;break;default:Z=b}var ge=b;b=Z;try{return te()}finally{b=ge}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(te,Z){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ge=b;b=te;try{return Z()}finally{b=ge}},n.unstable_scheduleCallback=function(te,Z,ge){var Pe=n.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Pe+ge:Pe):ge=Pe,te){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=ge+De,te={id:T++,callback:Z,priorityLevel:te,startTime:ge,expirationTime:De,sortIndex:-1},ge>Pe?(te.sortIndex=ge,e(m,te),t(g)===null&&te===t(m)&&(L?(J(R),R=-1):L=!0,Be(X,ge-Pe))):(te.sortIndex=De,e(g,te),V||I||(V=!0,z||(z=!0,U()))),te},n.unstable_shouldYield=w,n.unstable_wrapCallback=function(te){var Z=b;return function(){var ge=b;b=Z;try{return te.apply(this,arguments)}finally{b=ge}}}})(wm)),wm}var Jv;function KC(){return Jv||(Jv=1,Cm.exports=JC()),Cm.exports}var Im={exports:{}},pn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function QC(){if(Kv)return pn;Kv=1;var n=Rp();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(g,m,T){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:E==null?null:""+E,children:g,containerInfo:m,implementation:T}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pn.createPortal=function(g,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,T)},pn.flushSync=function(g){var m=u.T,T=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=T,i.d.f()}},pn.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},pn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},pn.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var T=m.as,E=d(T,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,I=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;T==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:E,integrity:b,fetchPriority:I}):T==="script"&&i.d.X(g,{crossOrigin:E,integrity:b,fetchPriority:I,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},pn.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var T=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},pn.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var T=m.as,E=d(T,m.crossOrigin);i.d.L(g,T,{crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},pn.preloadModule=function(g,m){if(typeof g=="string")if(m){var T=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},pn.requestFormReset=function(g){i.d.r(g)},pn.unstable_batchedUpdates=function(g,m){return g(m)},pn.useFormState=function(g,m,T){return u.H.useFormState(g,m,T)},pn.useFormStatus=function(){return u.H.useHostTransitionStatus()},pn.version="19.2.0",pn}var Qv;function XC(){if(Qv)return Im.exports;Qv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Im.exports=QC(),Im.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function WC(){if(Xv)return lu;Xv=1;var n=KC(),e=Rp(),t=XC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,a=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(a=r.return),s=r.return;while(s)}return r.tag===3?a:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var a=s,c=r;;){var v=a.return;if(v===null)break;var _=v.alternate;if(_===null){if(c=v.return,c!==null){a=c;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===a)return g(v),s;if(_===c)return g(v),r;_=_.sibling}throw Error(i(188))}if(a.return!==c.return)a=v,c=_;else{for(var A=!1,N=v.child;N;){if(N===a){A=!0,a=v,c=_;break}if(N===c){A=!0,c=v,a=_;break}N=N.sibling}if(!A){for(N=_.child;N;){if(N===a){A=!0,a=_,c=v;break}if(N===c){A=!0,c=_,a=v;break}N=N.sibling}if(!A)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?s:r}function T(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=T(s),r!==null)return r;s=s.sibling}return null}var E=Object.assign,b=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),J=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),w=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var k=Symbol.for("react.client.reference");function Oe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===k?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case $:return"Profiler";case j:return"StrictMode";case X:return"Suspense";case z:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case V:return"Portal";case ee:return s.displayName||"Context";case J:return(s._context.displayName||"Context")+".Consumer";case q:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:Oe(s.type)||"Memo";case C:r=s._payload,s=s._init;try{return Oe(s(r))}catch{}}return null}var Be=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},Pe=[],De=-1;function F(s){return{current:s}}function oe(s){0>De||(s.current=Pe[De],Pe[De]=null,De--)}function _e(s,r){De++,Pe[De]=s.current,s.current=r}var xe=F(null),Ie=F(null),Ve=F(null),Ke=F(null);function he(s,r){switch(_e(Ve,r),_e(Ie,s),_e(xe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?fv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=fv(r),s=hv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}oe(xe),_e(xe,s)}function ye(){oe(xe),oe(Ie),oe(Ve)}function Ge(s){s.memoizedState!==null&&_e(Ke,s);var r=xe.current,a=hv(r,s.type);r!==a&&(_e(Ie,s),_e(xe,a))}function kt(s){Ie.current===s&&(oe(xe),oe(Ie)),Ke.current===s&&(oe(Ke),su._currentValue=ge)}var An,kn;function _t(s){if(An===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);An=r&&r[1]||"",kn=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+An+s+kn}var ni=!1;function si(s,r){if(!s||ni)return"";ni=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(se){var W=se}Reflect.construct(s,[],le)}else{try{le.call()}catch(se){W=se}s.call(le.prototype)}}else{try{throw Error()}catch(se){W=se}(le=s())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(se){if(se&&W&&typeof se.stack=="string")return[se.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=c.DetermineComponentFrameRoot(),A=_[0],N=_[1];if(A&&N){var O=A.split(`
`),Q=N.split(`
`);for(v=c=0;c<O.length&&!O[c].includes("DetermineComponentFrameRoot");)c++;for(;v<Q.length&&!Q[v].includes("DetermineComponentFrameRoot");)v++;if(c===O.length||v===Q.length)for(c=O.length-1,v=Q.length-1;1<=c&&0<=v&&O[c]!==Q[v];)v--;for(;1<=c&&0<=v;c--,v--)if(O[c]!==Q[v]){if(c!==1||v!==1)do if(c--,v--,0>v||O[c]!==Q[v]){var ie=`
`+O[c].replace(" at new "," at ");return s.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",s.displayName)),ie}while(1<=c&&0<=v);break}}}finally{ni=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?_t(a):""}function zr(s,r){switch(s.tag){case 26:case 27:case 5:return _t(s.type);case 16:return _t("Lazy");case 13:return s.child!==r&&r!==null?_t("Suspense Fallback"):_t("Suspense");case 19:return _t("SuspenseList");case 0:case 15:return si(s.type,!1);case 11:return si(s.type.render,!1);case 1:return si(s.type,!0);case 31:return _t("Activity");default:return""}}function Hr(s){try{var r="",a=null;do r+=zr(s,a),a=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Dt=Object.prototype.hasOwnProperty,Vt=n.unstable_scheduleCallback,$n=n.unstable_cancelCallback,al=n.unstable_shouldYield,Vo=n.unstable_requestPaint,tn=n.unstable_now,ii=n.unstable_getCurrentPriorityLevel,Hi=n.unstable_ImmediatePriority,Gi=n.unstable_UserBlockingPriority,cs=n.unstable_NormalPriority,Lo=n.unstable_LowPriority,Gr=n.unstable_IdlePriority,H=n.log,ce=n.unstable_setDisableYieldValue,me=null,pe=null;function Ee(s){if(typeof H=="function"&&ce(s),pe&&typeof pe.setStrictMode=="function")try{pe.setStrictMode(me,s)}catch{}}var Ne=Math.clz32?Math.clz32:$i,Yn=Math.log,Jn=Math.LN2;function $i(s){return s>>>=0,s===0?32:31-(Yn(s)/Jn|0)|0}var Sn=256,ds=262144,xt=4194304;function Te(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function rt(s,r,a){var c=s.pendingLanes;if(c===0)return 0;var v=0,_=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~_,c!==0?v=Te(c):(A&=N,A!==0?v=Te(A):a||(a=N&~s,a!==0&&(v=Te(a))))):(N=c&~_,N!==0?v=Te(N):A!==0?v=Te(A):a||(a=c&~s,a!==0&&(v=Te(a)))),v===0?0:r!==0&&r!==v&&(r&_)===0&&(_=v&-v,a=r&-r,_>=a||_===32&&(a&4194048)!==0)?r:v}function Lt(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function bt(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vn(){var s=xt;return xt<<=1,(xt&62914560)===0&&(xt=4194304),s}function Ye(s){for(var r=[],a=0;31>a;a++)r.push(s);return r}function Ns(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Uo(s,r,a,c,v,_){var A=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var N=s.entanglements,O=s.expirationTimes,Q=s.hiddenUpdates;for(a=A&~a;0<a;){var ie=31-Ne(a),le=1<<ie;N[ie]=0,O[ie]=-1;var W=Q[ie];if(W!==null)for(Q[ie]=null,ie=0;ie<W.length;ie++){var se=W[ie];se!==null&&(se.lane&=-536870913)}a&=~le}c!==0&&Rs(s,c,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(A&~r))}function Rs(s,r,a){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-Ne(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|a&261930}function ll(s,r){var a=s.entangledLanes|=r;for(s=s.entanglements;a;){var c=31-Ne(a),v=1<<c;v&r|s[c]&r&&(s[c]|=r),a&=~v}}function ul(s,r){var a=r&-r;return a=(a&42)!==0?1:$r(a),(a&(s.suspendedLanes|r))!==0?0:a}function $r(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ri(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Hu(){var s=Z.p;return s!==0?s:(s=window.event,s===void 0?32:Lv(s.type))}function fs(s,r){var a=Z.p;try{return Z.p=s,r()}finally{Z.p=a}}var hs=Math.random().toString(36).slice(2),Bt="__reactFiber$"+hs,nn="__reactProps$"+hs,Ds="__reactContainer$"+hs,Oo="__reactEvents$"+hs,Nf="__reactListeners$"+hs,Gu="__reactHandles$"+hs,$u="__reactResources$"+hs,Ms="__reactMarker$"+hs;function qo(s){delete s[Bt],delete s[nn],delete s[Oo],delete s[Nf],delete s[Gu]}function Ps(s){var r=s[Bt];if(r)return r;for(var a=s.parentNode;a;){if(r=a[Ds]||a[Bt]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(s=Tv(s);s!==null;){if(a=s[Bt])return a;s=Tv(s)}return r}s=a,a=s.parentNode}return null}function Kn(s){if(s=s[Bt]||s[Ds]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Ln(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function ks(s){var r=s[$u];return r||(r=s[$u]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function zt(s){s[Ms]=!0}var cl=new Set,dl={};function Vs(s,r){Ls(s,r),Ls(s+"Capture",r)}function Ls(s,r){for(dl[s]=r,s=0;s<r.length;s++)cl.add(r[s])}var fl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),hl={},ml={};function Yu(s){return Dt.call(ml,s)?!0:Dt.call(hl,s)?!1:fl.test(s)?ml[s]=!0:(hl[s]=!0,!1)}function jo(s,r,a){if(Yu(r))if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+a)}}function Un(s,r,a){if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+a)}}function Ht(s,r,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(r,a,""+c)}}function sn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Yi(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function pl(s,r,a){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,_=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return v.call(this)},set:function(A){a=""+A,_.call(this,A)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(A){a=""+A},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function ft(s){if(!s._valueTracker){var r=Yi(s)?"checked":"value";s._valueTracker=pl(s,r,""+s[r])}}function Yr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return s&&(c=Yi(s)?s.checked?"true":"false":s.value),s=c,s!==a?(r.setValue(s),!0):!1}function Us(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Jr=/[\n"\\]/g;function Cn(s){return s.replace(Jr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Fo(s,r,a,c,v,_,A,N){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),r!=null?A==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+sn(r)):s.value!==""+sn(r)&&(s.value=""+sn(r)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),r!=null?gl(s,A,sn(r)):a!=null?gl(s,A,sn(a)):c!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+sn(N):s.removeAttribute("name")}function Ju(s,r,a,c,v,_,A,N){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),r!=null||a!=null){if(!(_!=="submit"&&_!=="reset"||r!=null)){ft(s);return}a=a!=null?""+sn(a):"",r=r!=null?""+sn(r):a,N||r===s.value||(s.value=r),s.defaultValue=r}c=c??v,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),ft(s)}function gl(s,r,a){r==="number"&&Us(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function Ji(s,r,a,c){if(s=s.options,r){r={};for(var v=0;v<a.length;v++)r["$"+a[v]]=!0;for(a=0;a<s.length;a++)v=r.hasOwnProperty("$"+s[a].value),s[a].selected!==v&&(s[a].selected=v),v&&c&&(s[a].defaultSelected=!0)}else{for(a=""+sn(a),r=null,v=0;v<s.length;v++){if(s[v].value===a){s[v].selected=!0,c&&(s[v].defaultSelected=!0);return}r!==null||s[v].disabled||(r=s[v])}r!==null&&(r.selected=!0)}}function Ku(s,r,a){if(r!=null&&(r=""+sn(r),r!==s.value&&(s.value=r),a==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=a!=null?""+sn(a):""}function Ki(s,r,a,c){if(r==null){if(c!=null){if(a!=null)throw Error(i(92));if(Be(c)){if(1<c.length)throw Error(i(93));c=c[0]}a=c}a==null&&(a=""),r=a}a=sn(r),s.defaultValue=a,c=s.textContent,c===a&&c!==""&&c!==null&&(s.value=c),ft(s)}function wn(s,r){if(r){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=r;return}}s.textContent=r}var Qu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yl(s,r,a){var c=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,a):typeof a!="number"||a===0||Qu.has(r)?r==="float"?s.cssFloat=a:s[r]=(""+a).trim():s[r]=a+"px"}function vl(s,r,a){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var v in r)c=r[v],r.hasOwnProperty(v)&&a[v]!==c&&yl(s,v,c)}else for(var _ in r)r.hasOwnProperty(_)&&yl(s,_,r[_])}function Bo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zo(s){return Qi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ms(){}var _l=null;function Qn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xi=null,Os=null;function Kr(s){var r=Kn(s);if(r&&(s=r.stateNode)){var a=s[nn]||null;e:switch(s=r.stateNode,r.type){case"input":if(Fo(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Cn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==s&&c.form===s.form){var v=c[nn]||null;if(!v)throw Error(i(90));Fo(c,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(r=0;r<a.length;r++)c=a[r],c.form===s.form&&Yr(c)}break e;case"textarea":Ku(s,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Ji(s,!!a.multiple,r,!1)}}}var Ho=!1;function Wi(s,r,a){if(Ho)return s(r,a);Ho=!0;try{var c=s(r);return c}finally{if(Ho=!1,(Xi!==null||Os!==null)&&(Hc(),Xi&&(r=Xi,s=Os,Os=Xi=null,Kr(r),s)))for(r=0;r<s.length;r++)Kr(s[r])}}function ps(s,r){var a=s.stateNode;if(a===null)return null;var c=a[nn]||null;if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qr=!1;if(Xn)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){Qr=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{Qr=!1}var qs=null,Tl=null,Xr=null;function El(){if(Xr)return Xr;var s,r=Tl,a=r.length,c,v="value"in qs?qs.value:qs.textContent,_=v.length;for(s=0;s<a&&r[s]===v[s];s++);var A=a-s;for(c=1;c<=A&&r[a-c]===v[_-c];c++);return Xr=v.slice(s,1<c?1-c:void 0)}function Wr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function oi(){return!0}function gs(){return!1}function un(s){function r(a,c,v,_,A){this._reactName=a,this._targetInst=v,this.type=c,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(a=s[N],this[N]=a?a(_):_[N]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?oi:gs,this.isPropagationStopped=gs,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=oi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=oi)},persist:function(){},isPersistent:oi}),r}var ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},js=un(ai),Zi=E({},ai,{view:0,detail:0}),xl=un(Zi),er,Go,Fs,$o=E({},Zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Fs&&(Fs&&s.type==="mousemove"?(er=s.screenX-Fs.screenX,Go=s.screenY-Fs.screenY):Go=er=0,Fs=s),er)},movementY:function(s){return"movementY"in s?s.movementY:Go}}),bl=un($o),Zr=E({},$o,{dataTransfer:0}),Wu=un(Zr),Zu=E({},Zi,{relatedTarget:0}),eo=un(Zu),Al=E({},ai,{animationName:0,elapsedTime:0,pseudoElement:0}),ec=un(Al),Yo=E({},ai,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),tc=un(Yo),nc=E({},ai,{data:0}),Bs=un(nc),sc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ic={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oc(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=rc[s])?!!r[s]:!1}function tr(){return oc}var En=E({},Zi,{key:function(s){if(s.key){var r=sc[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Wr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ic[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tr,charCode:function(s){return s.type==="keypress"?Wr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Wr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ac=un(En),lc=E({},$o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=un(lc),p=E({},Zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tr}),x=un(p),S=E({},ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),M=un(S),Y=E({},$o,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ne=un(Y),ve=E({},ai,{newState:0,oldState:0}),ze=un(ve),Ut=[9,13,27,32],ut=Xn&&"CompositionEvent"in window,It=null;Xn&&"documentMode"in document&&(It=document.documentMode);var Wn=Xn&&"TextEvent"in window&&!It,zs=Xn&&(!ut||It&&8<It&&11>=It),ys=" ",vs=!1;function to(s,r){switch(s){case"keyup":return Ut.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ko=!1;function pS(s,r){switch(s){case"compositionend":return Jo(r);case"keypress":return r.which!==32?null:(vs=!0,ys);case"textInput":return s=r.data,s===ys&&vs?null:s;default:return null}}function gS(s,r){if(Ko)return s==="compositionend"||!ut&&to(s,r)?(s=El(),Xr=Tl=qs=null,Ko=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return zs&&r.locale!=="ko"?null:r.data;default:return null}}var yS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!yS[s.type]:r==="textarea"}function Ag(s,r,a,c){Xi?Os?Os.push(c):Os=[c]:Xi=c,r=Xc(r,"onChange"),0<r.length&&(a=new js("onChange","change",null,a,c),s.push({event:a,listeners:r}))}var Sl=null,Cl=null;function vS(s){ov(s,0)}function uc(s){var r=Ln(s);if(Yr(r))return s}function Sg(s,r){if(s==="change")return r}var Cg=!1;if(Xn){var Rf;if(Xn){var Df="oninput"in document;if(!Df){var wg=document.createElement("div");wg.setAttribute("oninput","return;"),Df=typeof wg.oninput=="function"}Rf=Df}else Rf=!1;Cg=Rf&&(!document.documentMode||9<document.documentMode)}function Ig(){Sl&&(Sl.detachEvent("onpropertychange",Ng),Cl=Sl=null)}function Ng(s){if(s.propertyName==="value"&&uc(Cl)){var r=[];Ag(r,Cl,s,Qn(s)),Wi(vS,r)}}function _S(s,r,a){s==="focusin"?(Ig(),Sl=r,Cl=a,Sl.attachEvent("onpropertychange",Ng)):s==="focusout"&&Ig()}function TS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return uc(Cl)}function ES(s,r){if(s==="click")return uc(r)}function xS(s,r){if(s==="input"||s==="change")return uc(r)}function bS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var On=typeof Object.is=="function"?Object.is:bS;function wl(s,r){if(On(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var a=Object.keys(s),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var v=a[c];if(!Dt.call(r,v)||!On(s[v],r[v]))return!1}return!0}function Rg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Dg(s,r){var a=Rg(s);s=0;for(var c;a;){if(a.nodeType===3){if(c=s+a.textContent.length,s<=r&&c>=r)return{node:a,offset:r-s};s=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Rg(a)}}function Mg(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Mg(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Pg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Us(s.document);r instanceof s.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)s=r.contentWindow;else break;r=Us(s.document)}return r}function Mf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var AS=Xn&&"documentMode"in document&&11>=document.documentMode,Qo=null,Pf=null,Il=null,kf=!1;function kg(s,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;kf||Qo==null||Qo!==Us(c)||(c=Qo,"selectionStart"in c&&Mf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Il&&wl(Il,c)||(Il=c,c=Xc(Pf,"onSelect"),0<c.length&&(r=new js("onSelect","select",null,r,a),s.push({event:r,listeners:c}),r.target=Qo)))}function no(s,r){var a={};return a[s.toLowerCase()]=r.toLowerCase(),a["Webkit"+s]="webkit"+r,a["Moz"+s]="moz"+r,a}var Xo={animationend:no("Animation","AnimationEnd"),animationiteration:no("Animation","AnimationIteration"),animationstart:no("Animation","AnimationStart"),transitionrun:no("Transition","TransitionRun"),transitionstart:no("Transition","TransitionStart"),transitioncancel:no("Transition","TransitionCancel"),transitionend:no("Transition","TransitionEnd")},Vf={},Vg={};Xn&&(Vg=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function so(s){if(Vf[s])return Vf[s];if(!Xo[s])return s;var r=Xo[s],a;for(a in r)if(r.hasOwnProperty(a)&&a in Vg)return Vf[s]=r[a];return s}var Lg=so("animationend"),Ug=so("animationiteration"),Og=so("animationstart"),SS=so("transitionrun"),CS=so("transitionstart"),wS=so("transitioncancel"),qg=so("transitionend"),jg=new Map,Lf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lf.push("scrollEnd");function _s(s,r){jg.set(s,r),Vs(r,[s])}var cc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Zn=[],Wo=0,Uf=0;function dc(){for(var s=Wo,r=Uf=Wo=0;r<s;){var a=Zn[r];Zn[r++]=null;var c=Zn[r];Zn[r++]=null;var v=Zn[r];Zn[r++]=null;var _=Zn[r];if(Zn[r++]=null,c!==null&&v!==null){var A=c.pending;A===null?v.next=v:(v.next=A.next,A.next=v),c.pending=v}_!==0&&Fg(a,v,_)}}function fc(s,r,a,c){Zn[Wo++]=s,Zn[Wo++]=r,Zn[Wo++]=a,Zn[Wo++]=c,Uf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Of(s,r,a,c){return fc(s,r,a,c),hc(s)}function io(s,r){return fc(s,null,null,r),hc(s)}function Fg(s,r,a){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a);for(var v=!1,_=s.return;_!==null;)_.childLanes|=a,c=_.alternate,c!==null&&(c.childLanes|=a),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&r!==null&&(v=31-Ne(a),s=_.hiddenUpdates,c=s[v],c===null?s[v]=[r]:c.push(r),r.lane=a|536870912),_):null}function hc(s){if(50<Ql)throw Ql=0,Yh=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Zo={};function IS(s,r,a,c){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(s,r,a,c){return new IS(s,r,a,c)}function qf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ui(s,r){var a=s.alternate;return a===null?(a=qn(s.tag,r,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=r,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,r=s.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function Bg(s,r){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,r=a.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function mc(s,r,a,c,v,_){var A=0;if(c=s,typeof s=="function")qf(s)&&(A=1);else if(typeof s=="string")A=PC(s,a,xe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=qn(31,a,r,v),s.elementType=D,s.lanes=_,s;case L:return ro(a.children,v,_,r);case j:A=8,v|=24;break;case $:return s=qn(12,a,r,v|2),s.elementType=$,s.lanes=_,s;case X:return s=qn(13,a,r,v),s.elementType=X,s.lanes=_,s;case z:return s=qn(19,a,r,v),s.elementType=z,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:A=10;break e;case J:A=9;break e;case q:A=11;break e;case R:A=14;break e;case C:A=16,c=null;break e}A=29,a=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=qn(A,a,r,v),r.elementType=s,r.type=c,r.lanes=_,r}function ro(s,r,a,c){return s=qn(7,s,c,r),s.lanes=a,s}function jf(s,r,a){return s=qn(6,s,null,r),s.lanes=a,s}function zg(s){var r=qn(18,null,null,0);return r.stateNode=s,r}function Ff(s,r,a){return r=qn(4,s.children!==null?s.children:[],s.key,r),r.lanes=a,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Hg=new WeakMap;function es(s,r){if(typeof s=="object"&&s!==null){var a=Hg.get(s);return a!==void 0?a:(r={value:s,source:r,stack:Hr(r)},Hg.set(s,r),r)}return{value:s,source:r,stack:Hr(r)}}var ea=[],ta=0,pc=null,Nl=0,ts=[],ns=0,nr=null,Hs=1,Gs="";function ci(s,r){ea[ta++]=Nl,ea[ta++]=pc,pc=s,Nl=r}function Gg(s,r,a){ts[ns++]=Hs,ts[ns++]=Gs,ts[ns++]=nr,nr=s;var c=Hs;s=Gs;var v=32-Ne(c)-1;c&=~(1<<v),a+=1;var _=32-Ne(r)+v;if(30<_){var A=v-v%5;_=(c&(1<<A)-1).toString(32),c>>=A,v-=A,Hs=1<<32-Ne(r)+v|a<<v|c,Gs=_+s}else Hs=1<<_|a<<v|c,Gs=s}function Bf(s){s.return!==null&&(ci(s,1),Gg(s,1,0))}function zf(s){for(;s===pc;)pc=ea[--ta],ea[ta]=null,Nl=ea[--ta],ea[ta]=null;for(;s===nr;)nr=ts[--ns],ts[ns]=null,Gs=ts[--ns],ts[ns]=null,Hs=ts[--ns],ts[ns]=null}function $g(s,r){ts[ns++]=Hs,ts[ns++]=Gs,ts[ns++]=nr,Hs=r.id,Gs=r.overflow,nr=s}var cn=null,At=null,st=!1,sr=null,ss=!1,Hf=Error(i(519));function ir(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Rl(es(r,s)),Hf}function Yg(s){var r=s.stateNode,a=s.type,c=s.memoizedProps;switch(r[Bt]=s,r[nn]=c,a){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(a=0;a<Wl.length;a++)Xe(Wl[a],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":Xe("invalid",r),Ju(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Xe("invalid",r);break;case"textarea":Xe("invalid",r),Ki(r,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||c.suppressHydrationWarning===!0||cv(r.textContent,a)?(c.popover!=null&&(Xe("beforetoggle",r),Xe("toggle",r)),c.onScroll!=null&&Xe("scroll",r),c.onScrollEnd!=null&&Xe("scrollend",r),c.onClick!=null&&(r.onclick=ms),r=!0):r=!1,r||ir(s,!0)}function Jg(s){for(cn=s.return;cn;)switch(cn.tag){case 5:case 31:case 13:ss=!1;return;case 27:case 3:ss=!0;return;default:cn=cn.return}}function na(s){if(s!==cn)return!1;if(!st)return Jg(s),st=!0,!1;var r=s.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||lm(s.type,s.memoizedProps)),a=!a),a&&At&&ir(s),Jg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));At=_v(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));At=_v(s)}else r===27?(r=At,vr(s.type)?(s=hm,hm=null,At=s):At=r):At=cn?rs(s.stateNode.nextSibling):null;return!0}function oo(){At=cn=null,st=!1}function Gf(){var s=sr;return s!==null&&(Dn===null?Dn=s:Dn.push.apply(Dn,s),sr=null),s}function Rl(s){sr===null?sr=[s]:sr.push(s)}var $f=F(null),ao=null,di=null;function rr(s,r,a){_e($f,r._currentValue),r._currentValue=a}function fi(s){s._currentValue=$f.current,oe($f)}function Yf(s,r,a){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===a)break;s=s.return}}function Jf(s,r,a,c){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var A=v.child;_=_.firstContext;e:for(;_!==null;){var N=_;_=v;for(var O=0;O<r.length;O++)if(N.context===r[O]){_.lanes|=a,N=_.alternate,N!==null&&(N.lanes|=a),Yf(_.return,a,s),c||(A=null);break e}_=N.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(i(341));A.lanes|=a,_=A.alternate,_!==null&&(_.lanes|=a),Yf(A,a,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function sa(s,r,a,c){s=null;for(var v=r,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var N=v.type;On(v.pendingProps.value,A.value)||(s!==null?s.push(N):s=[N])}}else if(v===Ke.current){if(A=v.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(su):s=[su])}v=v.return}s!==null&&Jf(r,s,a,c),r.flags|=262144}function gc(s){for(s=s.firstContext;s!==null;){if(!On(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function lo(s){ao=s,di=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function dn(s){return Kg(ao,s)}function yc(s,r){return ao===null&&lo(s),Kg(s,r)}function Kg(s,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},di===null){if(s===null)throw Error(i(308));di=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else di=di.next=r;return a}var NS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(a,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(a){return a()})}},RS=n.unstable_scheduleCallback,DS=n.unstable_NormalPriority,Gt={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new NS,data:new Map,refCount:0}}function Dl(s){s.refCount--,s.refCount===0&&RS(DS,function(){s.controller.abort()})}var Ml=null,Qf=0,ia=0,ra=null;function MS(s,r){if(Ml===null){var a=Ml=[];Qf=0,ia=Zh(),ra={status:"pending",value:void 0,then:function(c){a.push(c)}}}return Qf++,r.then(Qg,Qg),r}function Qg(){if(--Qf===0&&Ml!==null){ra!==null&&(ra.status="fulfilled");var s=Ml;Ml=null,ia=0,ra=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function PS(s,r){var a=[],c={status:"pending",value:null,reason:null,then:function(v){a.push(v)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var v=0;v<a.length;v++)(0,a[v])(r)},function(v){for(c.status="rejected",c.reason=v,v=0;v<a.length;v++)(0,a[v])(void 0)}),c}var Xg=te.S;te.S=function(s,r){k0=tn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&MS(s,r),Xg!==null&&Xg(s,r)};var uo=F(null);function Xf(){var s=uo.current;return s!==null?s:Tt.pooledCache}function vc(s,r){r===null?_e(uo,uo.current):_e(uo,r.pool)}function Wg(){var s=Xf();return s===null?null:{parent:Gt._currentValue,pool:s}}var oa=Error(i(460)),Wf=Error(i(474)),_c=Error(i(542)),Tc={then:function(){}};function Zg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ey(s,r,a){switch(a=s[a],a===void 0?s.push(r):a!==r&&(r.then(ms,ms),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,ny(s),s;default:if(typeof r.status=="string")r.then(ms,ms);else{if(s=Tt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var v=r;v.status="fulfilled",v.value=c}},function(c){if(r.status==="pending"){var v=r;v.status="rejected",v.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,ny(s),s}throw fo=r,oa}}function co(s){try{var r=s._init;return r(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(fo=a,oa):a}}var fo=null;function ty(){if(fo===null)throw Error(i(459));var s=fo;return fo=null,s}function ny(s){if(s===oa||s===_c)throw Error(i(483))}var aa=null,Pl=0;function Ec(s){var r=Pl;return Pl+=1,aa===null&&(aa=[]),ey(aa,s,r)}function kl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function xc(s,r){throw r.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function sy(s){function r(G,B){if(s){var K=G.deletions;K===null?(G.deletions=[B],G.flags|=16):K.push(B)}}function a(G,B){if(!s)return null;for(;B!==null;)r(G,B),B=B.sibling;return null}function c(G){for(var B=new Map;G!==null;)G.key!==null?B.set(G.key,G):B.set(G.index,G),G=G.sibling;return B}function v(G,B){return G=ui(G,B),G.index=0,G.sibling=null,G}function _(G,B,K){return G.index=K,s?(K=G.alternate,K!==null?(K=K.index,K<B?(G.flags|=67108866,B):K):(G.flags|=67108866,B)):(G.flags|=1048576,B)}function A(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function N(G,B,K,ae){return B===null||B.tag!==6?(B=jf(K,G.mode,ae),B.return=G,B):(B=v(B,K),B.return=G,B)}function O(G,B,K,ae){var Re=K.type;return Re===L?ie(G,B,K.props.children,ae,K.key):B!==null&&(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===C&&co(Re)===B.type)?(B=v(B,K.props),kl(B,K),B.return=G,B):(B=mc(K.type,K.key,K.props,null,G.mode,ae),kl(B,K),B.return=G,B)}function Q(G,B,K,ae){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=Ff(K,G.mode,ae),B.return=G,B):(B=v(B,K.children||[]),B.return=G,B)}function ie(G,B,K,ae,Re){return B===null||B.tag!==7?(B=ro(K,G.mode,ae,Re),B.return=G,B):(B=v(B,K),B.return=G,B)}function le(G,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=jf(""+B,G.mode,K),B.return=G,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case I:return K=mc(B.type,B.key,B.props,null,G.mode,K),kl(K,B),K.return=G,K;case V:return B=Ff(B,G.mode,K),B.return=G,B;case C:return B=co(B),le(G,B,K)}if(Be(B)||U(B))return B=ro(B,G.mode,K,null),B.return=G,B;if(typeof B.then=="function")return le(G,Ec(B),K);if(B.$$typeof===ee)return le(G,yc(G,B),K);xc(G,B)}return null}function W(G,B,K,ae){var Re=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Re!==null?null:N(G,B,""+K,ae);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case I:return K.key===Re?O(G,B,K,ae):null;case V:return K.key===Re?Q(G,B,K,ae):null;case C:return K=co(K),W(G,B,K,ae)}if(Be(K)||U(K))return Re!==null?null:ie(G,B,K,ae,null);if(typeof K.then=="function")return W(G,B,Ec(K),ae);if(K.$$typeof===ee)return W(G,B,yc(G,K),ae);xc(G,K)}return null}function se(G,B,K,ae,Re){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return G=G.get(K)||null,N(B,G,""+ae,Re);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case I:return G=G.get(ae.key===null?K:ae.key)||null,O(B,G,ae,Re);case V:return G=G.get(ae.key===null?K:ae.key)||null,Q(B,G,ae,Re);case C:return ae=co(ae),se(G,B,K,ae,Re)}if(Be(ae)||U(ae))return G=G.get(K)||null,ie(B,G,ae,Re,null);if(typeof ae.then=="function")return se(G,B,K,Ec(ae),Re);if(ae.$$typeof===ee)return se(G,B,K,yc(B,ae),Re);xc(B,ae)}return null}function Ae(G,B,K,ae){for(var Re=null,ot=null,we=B,$e=B=0,Ze=null;we!==null&&$e<K.length;$e++){we.index>$e?(Ze=we,we=null):Ze=we.sibling;var at=W(G,we,K[$e],ae);if(at===null){we===null&&(we=Ze);break}s&&we&&at.alternate===null&&r(G,we),B=_(at,B,$e),ot===null?Re=at:ot.sibling=at,ot=at,we=Ze}if($e===K.length)return a(G,we),st&&ci(G,$e),Re;if(we===null){for(;$e<K.length;$e++)we=le(G,K[$e],ae),we!==null&&(B=_(we,B,$e),ot===null?Re=we:ot.sibling=we,ot=we);return st&&ci(G,$e),Re}for(we=c(we);$e<K.length;$e++)Ze=se(we,G,$e,K[$e],ae),Ze!==null&&(s&&Ze.alternate!==null&&we.delete(Ze.key===null?$e:Ze.key),B=_(Ze,B,$e),ot===null?Re=Ze:ot.sibling=Ze,ot=Ze);return s&&we.forEach(function(br){return r(G,br)}),st&&ci(G,$e),Re}function ke(G,B,K,ae){if(K==null)throw Error(i(151));for(var Re=null,ot=null,we=B,$e=B=0,Ze=null,at=K.next();we!==null&&!at.done;$e++,at=K.next()){we.index>$e?(Ze=we,we=null):Ze=we.sibling;var br=W(G,we,at.value,ae);if(br===null){we===null&&(we=Ze);break}s&&we&&br.alternate===null&&r(G,we),B=_(br,B,$e),ot===null?Re=br:ot.sibling=br,ot=br,we=Ze}if(at.done)return a(G,we),st&&ci(G,$e),Re;if(we===null){for(;!at.done;$e++,at=K.next())at=le(G,at.value,ae),at!==null&&(B=_(at,B,$e),ot===null?Re=at:ot.sibling=at,ot=at);return st&&ci(G,$e),Re}for(we=c(we);!at.done;$e++,at=K.next())at=se(we,G,$e,at.value,ae),at!==null&&(s&&at.alternate!==null&&we.delete(at.key===null?$e:at.key),B=_(at,B,$e),ot===null?Re=at:ot.sibling=at,ot=at);return s&&we.forEach(function(HC){return r(G,HC)}),st&&ci(G,$e),Re}function vt(G,B,K,ae){if(typeof K=="object"&&K!==null&&K.type===L&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case I:e:{for(var Re=K.key;B!==null;){if(B.key===Re){if(Re=K.type,Re===L){if(B.tag===7){a(G,B.sibling),ae=v(B,K.props.children),ae.return=G,G=ae;break e}}else if(B.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===C&&co(Re)===B.type){a(G,B.sibling),ae=v(B,K.props),kl(ae,K),ae.return=G,G=ae;break e}a(G,B);break}else r(G,B);B=B.sibling}K.type===L?(ae=ro(K.props.children,G.mode,ae,K.key),ae.return=G,G=ae):(ae=mc(K.type,K.key,K.props,null,G.mode,ae),kl(ae,K),ae.return=G,G=ae)}return A(G);case V:e:{for(Re=K.key;B!==null;){if(B.key===Re)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){a(G,B.sibling),ae=v(B,K.children||[]),ae.return=G,G=ae;break e}else{a(G,B);break}else r(G,B);B=B.sibling}ae=Ff(K,G.mode,ae),ae.return=G,G=ae}return A(G);case C:return K=co(K),vt(G,B,K,ae)}if(Be(K))return Ae(G,B,K,ae);if(U(K)){if(Re=U(K),typeof Re!="function")throw Error(i(150));return K=Re.call(K),ke(G,B,K,ae)}if(typeof K.then=="function")return vt(G,B,Ec(K),ae);if(K.$$typeof===ee)return vt(G,B,yc(G,K),ae);xc(G,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(a(G,B.sibling),ae=v(B,K),ae.return=G,G=ae):(a(G,B),ae=jf(K,G.mode,ae),ae.return=G,G=ae),A(G)):a(G,B)}return function(G,B,K,ae){try{Pl=0;var Re=vt(G,B,K,ae);return aa=null,Re}catch(we){if(we===oa||we===_c)throw we;var ot=qn(29,we,null,G.mode);return ot.lanes=ae,ot.return=G,ot}finally{}}}var ho=sy(!0),iy=sy(!1),or=!1;function Zf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eh(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ar(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function lr(s,r,a){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(ct&2)!==0){var v=c.pending;return v===null?r.next=r:(r.next=v.next,v.next=r),c.pending=r,r=hc(s),Fg(s,null,a),r}return fc(s,c,r,a),hc(s)}function Vl(s,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,ll(s,a)}}function th(s,r){var a=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var v=null,_=null;if(a=a.firstBaseUpdate,a!==null){do{var A={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};_===null?v=_=A:_=_.next=A,a=a.next}while(a!==null);_===null?v=_=r:_=_.next=r}else v=_=r;a={baseState:c.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:c.shared,callbacks:c.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=r:s.next=r,a.lastBaseUpdate=r}var nh=!1;function Ll(){if(nh){var s=ra;if(s!==null)throw s}}function Ul(s,r,a,c){nh=!1;var v=s.updateQueue;or=!1;var _=v.firstBaseUpdate,A=v.lastBaseUpdate,N=v.shared.pending;if(N!==null){v.shared.pending=null;var O=N,Q=O.next;O.next=null,A===null?_=Q:A.next=Q,A=O;var ie=s.alternate;ie!==null&&(ie=ie.updateQueue,N=ie.lastBaseUpdate,N!==A&&(N===null?ie.firstBaseUpdate=Q:N.next=Q,ie.lastBaseUpdate=O))}if(_!==null){var le=v.baseState;A=0,ie=Q=O=null,N=_;do{var W=N.lane&-536870913,se=W!==N.lane;if(se?(We&W)===W:(c&W)===W){W!==0&&W===ia&&(nh=!0),ie!==null&&(ie=ie.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Ae=s,ke=N;W=r;var vt=a;switch(ke.tag){case 1:if(Ae=ke.payload,typeof Ae=="function"){le=Ae.call(vt,le,W);break e}le=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=ke.payload,W=typeof Ae=="function"?Ae.call(vt,le,W):Ae,W==null)break e;le=E({},le,W);break e;case 2:or=!0}}W=N.callback,W!==null&&(s.flags|=64,se&&(s.flags|=8192),se=v.callbacks,se===null?v.callbacks=[W]:se.push(W))}else se={lane:W,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ie===null?(Q=ie=se,O=le):ie=ie.next=se,A|=W;if(N=N.next,N===null){if(N=v.shared.pending,N===null)break;se=N,N=se.next,se.next=null,v.lastBaseUpdate=se,v.shared.pending=null}}while(!0);ie===null&&(O=le),v.baseState=O,v.firstBaseUpdate=Q,v.lastBaseUpdate=ie,_===null&&(v.shared.lanes=0),hr|=A,s.lanes=A,s.memoizedState=le}}function ry(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function oy(s,r){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)ry(a[s],r)}var la=F(null),bc=F(0);function ay(s,r){s=Ei,_e(bc,s),_e(la,r),Ei=s|r.baseLanes}function sh(){_e(bc,Ei),_e(la,la.current)}function ih(){Ei=bc.current,oe(la),oe(bc)}var jn=F(null),is=null;function ur(s){var r=s.alternate;_e(Ot,Ot.current&1),_e(jn,s),is===null&&(r===null||la.current!==null||r.memoizedState!==null)&&(is=s)}function rh(s){_e(Ot,Ot.current),_e(jn,s),is===null&&(is=s)}function ly(s){s.tag===22?(_e(Ot,Ot.current),_e(jn,s),is===null&&(is=s)):cr()}function cr(){_e(Ot,Ot.current),_e(jn,jn.current)}function Fn(s){oe(jn),is===s&&(is=null),oe(Ot)}var Ot=F(0);function Ac(s){for(var r=s;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||dm(a)||fm(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var hi=0,He=null,gt=null,$t=null,Sc=!1,ua=!1,mo=!1,Cc=0,Ol=0,ca=null,kS=0;function Mt(){throw Error(i(321))}function oh(s,r){if(r===null)return!1;for(var a=0;a<r.length&&a<s.length;a++)if(!On(s[a],r[a]))return!1;return!0}function ah(s,r,a,c,v,_){return hi=_,He=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,te.H=s===null||s.memoizedState===null?Gy:xh,mo=!1,_=a(c,v),mo=!1,ua&&(_=cy(r,a,c,v)),uy(s),_}function uy(s){te.H=Fl;var r=gt!==null&&gt.next!==null;if(hi=0,$t=gt=He=null,Sc=!1,Ol=0,ca=null,r)throw Error(i(300));s===null||Yt||(s=s.dependencies,s!==null&&gc(s)&&(Yt=!0))}function cy(s,r,a,c){He=s;var v=0;do{if(ua&&(ca=null),Ol=0,ua=!1,25<=v)throw Error(i(301));if(v+=1,$t=gt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}te.H=$y,_=r(a,c)}while(ua);return _}function VS(){var s=te.H,r=s.useState()[0];return r=typeof r.then=="function"?ql(r):r,s=s.useState()[0],(gt!==null?gt.memoizedState:null)!==s&&(He.flags|=1024),r}function lh(){var s=Cc!==0;return Cc=0,s}function uh(s,r,a){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~a}function ch(s){if(Sc){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Sc=!1}hi=0,$t=gt=He=null,ua=!1,Ol=Cc=0,ca=null}function xn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?He.memoizedState=$t=s:$t=$t.next=s,$t}function qt(){if(gt===null){var s=He.alternate;s=s!==null?s.memoizedState:null}else s=gt.next;var r=$t===null?He.memoizedState:$t.next;if(r!==null)$t=r,gt=s;else{if(s===null)throw He.alternate===null?Error(i(467)):Error(i(310));gt=s,s={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},$t===null?He.memoizedState=$t=s:$t=$t.next=s}return $t}function wc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ql(s){var r=Ol;return Ol+=1,ca===null&&(ca=[]),s=ey(ca,s,r),r=He,($t===null?r.memoizedState:$t.next)===null&&(r=r.alternate,te.H=r===null||r.memoizedState===null?Gy:xh),s}function Ic(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ql(s);if(s.$$typeof===ee)return dn(s)}throw Error(i(438,String(s)))}function dh(s){var r=null,a=He.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(v){return v.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=wc(),He.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(s),c=0;c<s;c++)a[c]=w;return r.index++,a}function mi(s,r){return typeof r=="function"?r(s):r}function Nc(s){var r=qt();return fh(r,gt,s)}function fh(s,r,a){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var v=s.baseQueue,_=c.pending;if(_!==null){if(v!==null){var A=v.next;v.next=_.next,_.next=A}r.baseQueue=v=_,c.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{r=v.next;var N=A=null,O=null,Q=r,ie=!1;do{var le=Q.lane&-536870913;if(le!==Q.lane?(We&le)===le:(hi&le)===le){var W=Q.revertLane;if(W===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),le===ia&&(ie=!0);else if((hi&W)===W){Q=Q.next,W===ia&&(ie=!0);continue}else le={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(N=O=le,A=_):O=O.next=le,He.lanes|=W,hr|=W;le=Q.action,mo&&a(_,le),_=Q.hasEagerState?Q.eagerState:a(_,le)}else W={lane:le,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(N=O=W,A=_):O=O.next=W,He.lanes|=le,hr|=le;Q=Q.next}while(Q!==null&&Q!==r);if(O===null?A=_:O.next=N,!On(_,s.memoizedState)&&(Yt=!0,ie&&(a=ra,a!==null)))throw a;s.memoizedState=_,s.baseState=A,s.baseQueue=O,c.lastRenderedState=_}return v===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function hh(s){var r=qt(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=s;var c=a.dispatch,v=a.pending,_=r.memoizedState;if(v!==null){a.pending=null;var A=v=v.next;do _=s(_,A.action),A=A.next;while(A!==v);On(_,r.memoizedState)||(Yt=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),a.lastRenderedState=_}return[_,c]}function dy(s,r,a){var c=He,v=qt(),_=st;if(_){if(a===void 0)throw Error(i(407));a=a()}else a=r();var A=!On((gt||v).memoizedState,a);if(A&&(v.memoizedState=a,Yt=!0),v=v.queue,gh(my.bind(null,c,v,s),[s]),v.getSnapshot!==r||A||$t!==null&&$t.memoizedState.tag&1){if(c.flags|=2048,da(9,{destroy:void 0},hy.bind(null,c,v,a,r),null),Tt===null)throw Error(i(349));_||(hi&127)!==0||fy(c,r,a)}return a}function fy(s,r,a){s.flags|=16384,s={getSnapshot:r,value:a},r=He.updateQueue,r===null?(r=wc(),He.updateQueue=r,r.stores=[s]):(a=r.stores,a===null?r.stores=[s]:a.push(s))}function hy(s,r,a,c){r.value=a,r.getSnapshot=c,py(r)&&gy(s)}function my(s,r,a){return a(function(){py(r)&&gy(s)})}function py(s){var r=s.getSnapshot;s=s.value;try{var a=r();return!On(s,a)}catch{return!0}}function gy(s){var r=io(s,2);r!==null&&Mn(r,s,2)}function mh(s){var r=xn();if(typeof s=="function"){var a=s;if(s=a(),mo){Ee(!0);try{a()}finally{Ee(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:s},r}function yy(s,r,a,c){return s.baseState=a,fh(s,gt,typeof c=="function"?c:mi)}function LS(s,r,a,c,v){if(Mc(s))throw Error(i(485));if(s=r.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};te.T!==null?a(!0):_.isTransition=!1,c(_),a=r.pending,a===null?(_.next=r.pending=_,vy(r,_)):(_.next=a.next,r.pending=a.next=_)}}function vy(s,r){var a=r.action,c=r.payload,v=s.state;if(r.isTransition){var _=te.T,A={};te.T=A;try{var N=a(v,c),O=te.S;O!==null&&O(A,N),_y(s,r,N)}catch(Q){ph(s,r,Q)}finally{_!==null&&A.types!==null&&(_.types=A.types),te.T=_}}else try{_=a(v,c),_y(s,r,_)}catch(Q){ph(s,r,Q)}}function _y(s,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){Ty(s,r,c)},function(c){return ph(s,r,c)}):Ty(s,r,a)}function Ty(s,r,a){r.status="fulfilled",r.value=a,Ey(r),s.state=a,r=s.pending,r!==null&&(a=r.next,a===r?s.pending=null:(a=a.next,r.next=a,vy(s,a)))}function ph(s,r,a){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=a,Ey(r),r=r.next;while(r!==c)}s.action=null}function Ey(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function xy(s,r){return r}function by(s,r){if(st){var a=Tt.formState;if(a!==null){e:{var c=He;if(st){if(At){t:{for(var v=At,_=ss;v.nodeType!==8;){if(!_){v=null;break t}if(v=rs(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){At=rs(v.nextSibling),c=v.data==="F!";break e}}ir(c)}c=!1}c&&(r=a[0])}}return a=xn(),a.memoizedState=a.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xy,lastRenderedState:r},a.queue=c,a=By.bind(null,He,c),c.dispatch=a,c=mh(!1),_=Eh.bind(null,He,!1,c.queue),c=xn(),v={state:r,dispatch:null,action:s,pending:null},c.queue=v,a=LS.bind(null,He,v,_,a),v.dispatch=a,c.memoizedState=s,[r,a,!1]}function Ay(s){var r=qt();return Sy(r,gt,s)}function Sy(s,r,a){if(r=fh(s,r,xy)[0],s=Nc(mi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=ql(r)}catch(A){throw A===oa?_c:A}else c=r;r=qt();var v=r.queue,_=v.dispatch;return a!==r.memoizedState&&(He.flags|=2048,da(9,{destroy:void 0},US.bind(null,v,a),null)),[c,_,s]}function US(s,r){s.action=r}function Cy(s){var r=qt(),a=gt;if(a!==null)return Sy(r,a,s);qt(),r=r.memoizedState,a=qt();var c=a.queue.dispatch;return a.memoizedState=s,[r,c,!1]}function da(s,r,a,c){return s={tag:s,create:a,deps:c,inst:r,next:null},r=He.updateQueue,r===null&&(r=wc(),He.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=s.next=s:(c=a.next,a.next=s,s.next=c,r.lastEffect=s),s}function wy(){return qt().memoizedState}function Rc(s,r,a,c){var v=xn();He.flags|=s,v.memoizedState=da(1|r,{destroy:void 0},a,c===void 0?null:c)}function Dc(s,r,a,c){var v=qt();c=c===void 0?null:c;var _=v.memoizedState.inst;gt!==null&&c!==null&&oh(c,gt.memoizedState.deps)?v.memoizedState=da(r,_,a,c):(He.flags|=s,v.memoizedState=da(1|r,_,a,c))}function Iy(s,r){Rc(8390656,8,s,r)}function gh(s,r){Dc(2048,8,s,r)}function OS(s){He.flags|=4;var r=He.updateQueue;if(r===null)r=wc(),He.updateQueue=r,r.events=[s];else{var a=r.events;a===null?r.events=[s]:a.push(s)}}function Ny(s){var r=qt().memoizedState;return OS({ref:r,nextImpl:s}),function(){if((ct&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Ry(s,r){return Dc(4,2,s,r)}function Dy(s,r){return Dc(4,4,s,r)}function My(s,r){if(typeof r=="function"){s=s();var a=r(s);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Py(s,r,a){a=a!=null?a.concat([s]):null,Dc(4,4,My.bind(null,r,s),a)}function yh(){}function ky(s,r){var a=qt();r=r===void 0?null:r;var c=a.memoizedState;return r!==null&&oh(r,c[1])?c[0]:(a.memoizedState=[s,r],s)}function Vy(s,r){var a=qt();r=r===void 0?null:r;var c=a.memoizedState;if(r!==null&&oh(r,c[1]))return c[0];if(c=s(),mo){Ee(!0);try{s()}finally{Ee(!1)}}return a.memoizedState=[c,r],c}function vh(s,r,a){return a===void 0||(hi&1073741824)!==0&&(We&261930)===0?s.memoizedState=r:(s.memoizedState=a,s=L0(),He.lanes|=s,hr|=s,a)}function Ly(s,r,a,c){return On(a,r)?a:la.current!==null?(s=vh(s,a,c),On(s,r)||(Yt=!0),s):(hi&42)===0||(hi&1073741824)!==0&&(We&261930)===0?(Yt=!0,s.memoizedState=a):(s=L0(),He.lanes|=s,hr|=s,r)}function Uy(s,r,a,c,v){var _=Z.p;Z.p=_!==0&&8>_?_:8;var A=te.T,N={};te.T=N,Eh(s,!1,r,a);try{var O=v(),Q=te.S;if(Q!==null&&Q(N,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var ie=PS(O,c);jl(s,r,ie,Hn(s))}else jl(s,r,c,Hn(s))}catch(le){jl(s,r,{then:function(){},status:"rejected",reason:le},Hn())}finally{Z.p=_,A!==null&&N.types!==null&&(A.types=N.types),te.T=A}}function qS(){}function _h(s,r,a,c){if(s.tag!==5)throw Error(i(476));var v=Oy(s).queue;Uy(s,v,r,ge,a===null?qS:function(){return qy(s),a(c)})}function Oy(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:ge},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:a},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function qy(s){var r=Oy(s);r.next===null&&(r=s.alternate.memoizedState),jl(s,r.next.queue,{},Hn())}function Th(){return dn(su)}function jy(){return qt().memoizedState}function Fy(){return qt().memoizedState}function jS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var a=Hn();s=ar(a);var c=lr(r,s,a);c!==null&&(Mn(c,r,a),Vl(c,r,a)),r={cache:Kf()},s.payload=r;return}r=r.return}}function FS(s,r,a){var c=Hn();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Mc(s)?zy(r,a):(a=Of(s,r,a,c),a!==null&&(Mn(a,s,c),Hy(a,r,c)))}function By(s,r,a){var c=Hn();jl(s,r,a,c)}function jl(s,r,a,c){var v={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Mc(s))zy(r,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var A=r.lastRenderedState,N=_(A,a);if(v.hasEagerState=!0,v.eagerState=N,On(N,A))return fc(s,r,v,0),Tt===null&&dc(),!1}catch{}finally{}if(a=Of(s,r,v,c),a!==null)return Mn(a,s,c),Hy(a,r,c),!0}return!1}function Eh(s,r,a,c){if(c={lane:2,revertLane:Zh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Mc(s)){if(r)throw Error(i(479))}else r=Of(s,a,c,2),r!==null&&Mn(r,s,2)}function Mc(s){var r=s.alternate;return s===He||r!==null&&r===He}function zy(s,r){ua=Sc=!0;var a=s.pending;a===null?r.next=r:(r.next=a.next,a.next=r),s.pending=r}function Hy(s,r,a){if((a&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,ll(s,a)}}var Fl={readContext:dn,use:Ic,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt};Fl.useEffectEvent=Mt;var Gy={readContext:dn,use:Ic,useCallback:function(s,r){return xn().memoizedState=[s,r===void 0?null:r],s},useContext:dn,useEffect:Iy,useImperativeHandle:function(s,r,a){a=a!=null?a.concat([s]):null,Rc(4194308,4,My.bind(null,r,s),a)},useLayoutEffect:function(s,r){return Rc(4194308,4,s,r)},useInsertionEffect:function(s,r){Rc(4,2,s,r)},useMemo:function(s,r){var a=xn();r=r===void 0?null:r;var c=s();if(mo){Ee(!0);try{s()}finally{Ee(!1)}}return a.memoizedState=[c,r],c},useReducer:function(s,r,a){var c=xn();if(a!==void 0){var v=a(r);if(mo){Ee(!0);try{a(r)}finally{Ee(!1)}}}else v=r;return c.memoizedState=c.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},c.queue=s,s=s.dispatch=FS.bind(null,He,s),[c.memoizedState,s]},useRef:function(s){var r=xn();return s={current:s},r.memoizedState=s},useState:function(s){s=mh(s);var r=s.queue,a=By.bind(null,He,r);return r.dispatch=a,[s.memoizedState,a]},useDebugValue:yh,useDeferredValue:function(s,r){var a=xn();return vh(a,s,r)},useTransition:function(){var s=mh(!1);return s=Uy.bind(null,He,s.queue,!0,!1),xn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,a){var c=He,v=xn();if(st){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),Tt===null)throw Error(i(349));(We&127)!==0||fy(c,r,a)}v.memoizedState=a;var _={value:a,getSnapshot:r};return v.queue=_,Iy(my.bind(null,c,_,s),[s]),c.flags|=2048,da(9,{destroy:void 0},hy.bind(null,c,_,a,r),null),a},useId:function(){var s=xn(),r=Tt.identifierPrefix;if(st){var a=Gs,c=Hs;a=(c&~(1<<32-Ne(c)-1)).toString(32)+a,r="_"+r+"R_"+a,a=Cc++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=kS++,r="_"+r+"r_"+a.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Th,useFormState:by,useActionState:by,useOptimistic:function(s){var r=xn();r.memoizedState=r.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=Eh.bind(null,He,!0,a),a.dispatch=r,[s,r]},useMemoCache:dh,useCacheRefresh:function(){return xn().memoizedState=jS.bind(null,He)},useEffectEvent:function(s){var r=xn(),a={impl:s};return r.memoizedState=a,function(){if((ct&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}},xh={readContext:dn,use:Ic,useCallback:ky,useContext:dn,useEffect:gh,useImperativeHandle:Py,useInsertionEffect:Ry,useLayoutEffect:Dy,useMemo:Vy,useReducer:Nc,useRef:wy,useState:function(){return Nc(mi)},useDebugValue:yh,useDeferredValue:function(s,r){var a=qt();return Ly(a,gt.memoizedState,s,r)},useTransition:function(){var s=Nc(mi)[0],r=qt().memoizedState;return[typeof s=="boolean"?s:ql(s),r]},useSyncExternalStore:dy,useId:jy,useHostTransitionStatus:Th,useFormState:Ay,useActionState:Ay,useOptimistic:function(s,r){var a=qt();return yy(a,gt,s,r)},useMemoCache:dh,useCacheRefresh:Fy};xh.useEffectEvent=Ny;var $y={readContext:dn,use:Ic,useCallback:ky,useContext:dn,useEffect:gh,useImperativeHandle:Py,useInsertionEffect:Ry,useLayoutEffect:Dy,useMemo:Vy,useReducer:hh,useRef:wy,useState:function(){return hh(mi)},useDebugValue:yh,useDeferredValue:function(s,r){var a=qt();return gt===null?vh(a,s,r):Ly(a,gt.memoizedState,s,r)},useTransition:function(){var s=hh(mi)[0],r=qt().memoizedState;return[typeof s=="boolean"?s:ql(s),r]},useSyncExternalStore:dy,useId:jy,useHostTransitionStatus:Th,useFormState:Cy,useActionState:Cy,useOptimistic:function(s,r){var a=qt();return gt!==null?yy(a,gt,s,r):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:dh,useCacheRefresh:Fy};$y.useEffectEvent=Ny;function bh(s,r,a,c){r=s.memoizedState,a=a(c,r),a=a==null?r:E({},r,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Ah={enqueueSetState:function(s,r,a){s=s._reactInternals;var c=Hn(),v=ar(c);v.payload=r,a!=null&&(v.callback=a),r=lr(s,v,c),r!==null&&(Mn(r,s,c),Vl(r,s,c))},enqueueReplaceState:function(s,r,a){s=s._reactInternals;var c=Hn(),v=ar(c);v.tag=1,v.payload=r,a!=null&&(v.callback=a),r=lr(s,v,c),r!==null&&(Mn(r,s,c),Vl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var a=Hn(),c=ar(a);c.tag=2,r!=null&&(c.callback=r),r=lr(s,c,a),r!==null&&(Mn(r,s,a),Vl(r,s,a))}};function Yy(s,r,a,c,v,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,_,A):r.prototype&&r.prototype.isPureReactComponent?!wl(a,c)||!wl(v,_):!0}function Jy(s,r,a,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==s&&Ah.enqueueReplaceState(r,r.state,null)}function po(s,r){var a=r;if("ref"in r){a={};for(var c in r)c!=="ref"&&(a[c]=r[c])}if(s=s.defaultProps){a===r&&(a=E({},a));for(var v in s)a[v]===void 0&&(a[v]=s[v])}return a}function Ky(s){cc(s)}function Qy(s){console.error(s)}function Xy(s){cc(s)}function Pc(s,r){try{var a=s.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Wy(s,r,a){try{var c=s.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Sh(s,r,a){return a=ar(a),a.tag=3,a.payload={element:null},a.callback=function(){Pc(s,r)},a}function Zy(s){return s=ar(s),s.tag=3,s}function e0(s,r,a,c){var v=a.type.getDerivedStateFromError;if(typeof v=="function"){var _=c.value;s.payload=function(){return v(_)},s.callback=function(){Wy(r,a,c)}}var A=a.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){Wy(r,a,c),typeof v!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function BS(s,r,a,c,v){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=a.alternate,r!==null&&sa(r,a,v,!0),a=jn.current,a!==null){switch(a.tag){case 31:case 13:return is===null?Gc():a.alternate===null&&Pt===0&&(Pt=3),a.flags&=-257,a.flags|=65536,a.lanes=v,c===Tc?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([c]):r.add(c),Qh(s,c,v)),!1;case 22:return a.flags|=65536,c===Tc?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([c]):a.add(c)),Qh(s,c,v)),!1}throw Error(i(435,a.tag))}return Qh(s,c,v),Gc(),!1}if(st)return r=jn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=v,c!==Hf&&(s=Error(i(422),{cause:c}),Rl(es(s,a)))):(c!==Hf&&(r=Error(i(423),{cause:c}),Rl(es(r,a))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,c=es(c,a),v=Sh(s.stateNode,c,v),th(s,v),Pt!==4&&(Pt=2)),!1;var _=Error(i(520),{cause:c});if(_=es(_,a),Kl===null?Kl=[_]:Kl.push(_),Pt!==4&&(Pt=2),r===null)return!0;c=es(c,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,s=v&-v,a.lanes|=s,s=Sh(a.stateNode,c,s),th(a,s),!1;case 1:if(r=a.type,_=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(mr===null||!mr.has(_))))return a.flags|=65536,v&=-v,a.lanes|=v,v=Zy(v),e0(v,s,a,c),th(a,v),!1}a=a.return}while(a!==null);return!1}var Ch=Error(i(461)),Yt=!1;function fn(s,r,a,c){r.child=s===null?iy(r,null,a,c):ho(r,s.child,a,c)}function t0(s,r,a,c,v){a=a.render;var _=r.ref;if("ref"in c){var A={};for(var N in c)N!=="ref"&&(A[N]=c[N])}else A=c;return lo(r),c=ah(s,r,a,A,_,v),N=lh(),s!==null&&!Yt?(uh(s,r,v),pi(s,r,v)):(st&&N&&Bf(r),r.flags|=1,fn(s,r,c,v),r.child)}function n0(s,r,a,c,v){if(s===null){var _=a.type;return typeof _=="function"&&!qf(_)&&_.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=_,s0(s,r,_,c,v)):(s=mc(a.type,null,c,r,r.mode,v),s.ref=r.ref,s.return=r,r.child=s)}if(_=s.child,!kh(s,v)){var A=_.memoizedProps;if(a=a.compare,a=a!==null?a:wl,a(A,c)&&s.ref===r.ref)return pi(s,r,v)}return r.flags|=1,s=ui(_,c),s.ref=r.ref,s.return=r,r.child=s}function s0(s,r,a,c,v){if(s!==null){var _=s.memoizedProps;if(wl(_,c)&&s.ref===r.ref)if(Yt=!1,r.pendingProps=c=_,kh(s,v))(s.flags&131072)!==0&&(Yt=!0);else return r.lanes=s.lanes,pi(s,r,v)}return wh(s,r,a,c,v)}function i0(s,r,a,c){var v=c.children,_=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(_=_!==null?_.baseLanes|a:a,s!==null){for(c=r.child=s.child,v=0;c!==null;)v=v|c.lanes|c.childLanes,c=c.sibling;c=v&~_}else c=0,r.child=null;return r0(s,r,_,a,c)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&vc(r,_!==null?_.cachePool:null),_!==null?ay(r,_):sh(),ly(r);else return c=r.lanes=536870912,r0(s,r,_!==null?_.baseLanes|a:a,a,c)}else _!==null?(vc(r,_.cachePool),ay(r,_),cr(),r.memoizedState=null):(s!==null&&vc(r,null),sh(),cr());return fn(s,r,v,a),r.child}function Bl(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function r0(s,r,a,c,v){var _=Xf();return _=_===null?null:{parent:Gt._currentValue,pool:_},r.memoizedState={baseLanes:a,cachePool:_},s!==null&&vc(r,null),sh(),ly(r),s!==null&&sa(s,r,c,!0),r.childLanes=v,null}function kc(s,r){return r=Lc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function o0(s,r,a){return ho(r,s.child,null,a),s=kc(r,r.pendingProps),s.flags|=2,Fn(r),r.memoizedState=null,s}function zS(s,r,a){var c=r.pendingProps,v=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(st){if(c.mode==="hidden")return s=kc(r,c),r.lanes=536870912,Bl(null,s);if(rh(r),(s=At)?(s=vv(s,ss),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:nr!==null?{id:Hs,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},a=zg(s),a.return=r,r.child=a,cn=r,At=null)):s=null,s===null)throw ir(r);return r.lanes=536870912,null}return kc(r,c)}var _=s.memoizedState;if(_!==null){var A=_.dehydrated;if(rh(r),v)if(r.flags&256)r.flags&=-257,r=o0(s,r,a);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Yt||sa(s,r,a,!1),v=(a&s.childLanes)!==0,Yt||v){if(c=Tt,c!==null&&(A=ul(c,a),A!==0&&A!==_.retryLane))throw _.retryLane=A,io(s,A),Mn(c,s,A),Ch;Gc(),r=o0(s,r,a)}else s=_.treeContext,At=rs(A.nextSibling),cn=r,st=!0,sr=null,ss=!1,s!==null&&$g(r,s),r=kc(r,c),r.flags|=4096;return r}return s=ui(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Vc(s,r){var a=r.ref;if(a===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(s===null||s.ref!==a)&&(r.flags|=4194816)}}function wh(s,r,a,c,v){return lo(r),a=ah(s,r,a,c,void 0,v),c=lh(),s!==null&&!Yt?(uh(s,r,v),pi(s,r,v)):(st&&c&&Bf(r),r.flags|=1,fn(s,r,a,v),r.child)}function a0(s,r,a,c,v,_){return lo(r),r.updateQueue=null,a=cy(r,c,a,v),uy(s),c=lh(),s!==null&&!Yt?(uh(s,r,_),pi(s,r,_)):(st&&c&&Bf(r),r.flags|=1,fn(s,r,a,_),r.child)}function l0(s,r,a,c,v){if(lo(r),r.stateNode===null){var _=Zo,A=a.contextType;typeof A=="object"&&A!==null&&(_=dn(A)),_=new a(c,_),r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ah,r.stateNode=_,_._reactInternals=r,_=r.stateNode,_.props=c,_.state=r.memoizedState,_.refs={},Zf(r),A=a.contextType,_.context=typeof A=="object"&&A!==null?dn(A):Zo,_.state=r.memoizedState,A=a.getDerivedStateFromProps,typeof A=="function"&&(bh(r,a,A,c),_.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&Ah.enqueueReplaceState(_,_.state,null),Ul(r,c,_,v),Ll(),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){_=r.stateNode;var N=r.memoizedProps,O=po(a,N);_.props=O;var Q=_.context,ie=a.contextType;A=Zo,typeof ie=="object"&&ie!==null&&(A=dn(ie));var le=a.getDerivedStateFromProps;ie=typeof le=="function"||typeof _.getSnapshotBeforeUpdate=="function",N=r.pendingProps!==N,ie||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N||Q!==A)&&Jy(r,_,c,A),or=!1;var W=r.memoizedState;_.state=W,Ul(r,c,_,v),Ll(),Q=r.memoizedState,N||W!==Q||or?(typeof le=="function"&&(bh(r,a,le,c),Q=r.memoizedState),(O=or||Yy(r,a,O,c,W,Q,A))?(ie||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(r.flags|=4194308)):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=Q),_.props=c,_.state=Q,_.context=A,c=O):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{_=r.stateNode,eh(s,r),A=r.memoizedProps,ie=po(a,A),_.props=ie,le=r.pendingProps,W=_.context,Q=a.contextType,O=Zo,typeof Q=="object"&&Q!==null&&(O=dn(Q)),N=a.getDerivedStateFromProps,(Q=typeof N=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==le||W!==O)&&Jy(r,_,c,O),or=!1,W=r.memoizedState,_.state=W,Ul(r,c,_,v),Ll();var se=r.memoizedState;A!==le||W!==se||or||s!==null&&s.dependencies!==null&&gc(s.dependencies)?(typeof N=="function"&&(bh(r,a,N,c),se=r.memoizedState),(ie=or||Yy(r,a,ie,c,W,se,O)||s!==null&&s.dependencies!==null&&gc(s.dependencies))?(Q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,se,O),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,se,O)),typeof _.componentDidUpdate=="function"&&(r.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=se),_.props=c,_.state=se,_.context=O,c=ie):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),c=!1)}return _=c,Vc(s,r),c=(r.flags&128)!==0,_||c?(_=r.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:_.render(),r.flags|=1,s!==null&&c?(r.child=ho(r,s.child,null,v),r.child=ho(r,null,a,v)):fn(s,r,a,v),r.memoizedState=_.state,s=r.child):s=pi(s,r,v),s}function u0(s,r,a,c){return oo(),r.flags|=256,fn(s,r,a,c),r.child}var Ih={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nh(s){return{baseLanes:s,cachePool:Wg()}}function Rh(s,r,a){return s=s!==null?s.childLanes&~a:0,r&&(s|=zn),s}function c0(s,r,a){var c=r.pendingProps,v=!1,_=(r.flags&128)!==0,A;if((A=_)||(A=s!==null&&s.memoizedState===null?!1:(Ot.current&2)!==0),A&&(v=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,s===null){if(st){if(v?ur(r):cr(),(s=At)?(s=vv(s,ss),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:nr!==null?{id:Hs,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},a=zg(s),a.return=r,r.child=a,cn=r,At=null)):s=null,s===null)throw ir(r);return fm(s)?r.lanes=32:r.lanes=536870912,null}var N=c.children;return c=c.fallback,v?(cr(),v=r.mode,N=Lc({mode:"hidden",children:N},v),c=ro(c,v,a,null),N.return=r,c.return=r,N.sibling=c,r.child=N,c=r.child,c.memoizedState=Nh(a),c.childLanes=Rh(s,A,a),r.memoizedState=Ih,Bl(null,c)):(ur(r),Dh(r,N))}var O=s.memoizedState;if(O!==null&&(N=O.dehydrated,N!==null)){if(_)r.flags&256?(ur(r),r.flags&=-257,r=Mh(s,r,a)):r.memoizedState!==null?(cr(),r.child=s.child,r.flags|=128,r=null):(cr(),N=c.fallback,v=r.mode,c=Lc({mode:"visible",children:c.children},v),N=ro(N,v,a,null),N.flags|=2,c.return=r,N.return=r,c.sibling=N,r.child=c,ho(r,s.child,null,a),c=r.child,c.memoizedState=Nh(a),c.childLanes=Rh(s,A,a),r.memoizedState=Ih,r=Bl(null,c));else if(ur(r),fm(N)){if(A=N.nextSibling&&N.nextSibling.dataset,A)var Q=A.dgst;A=Q,c=Error(i(419)),c.stack="",c.digest=A,Rl({value:c,source:null,stack:null}),r=Mh(s,r,a)}else if(Yt||sa(s,r,a,!1),A=(a&s.childLanes)!==0,Yt||A){if(A=Tt,A!==null&&(c=ul(A,a),c!==0&&c!==O.retryLane))throw O.retryLane=c,io(s,c),Mn(A,s,c),Ch;dm(N)||Gc(),r=Mh(s,r,a)}else dm(N)?(r.flags|=192,r.child=s.child,r=null):(s=O.treeContext,At=rs(N.nextSibling),cn=r,st=!0,sr=null,ss=!1,s!==null&&$g(r,s),r=Dh(r,c.children),r.flags|=4096);return r}return v?(cr(),N=c.fallback,v=r.mode,O=s.child,Q=O.sibling,c=ui(O,{mode:"hidden",children:c.children}),c.subtreeFlags=O.subtreeFlags&65011712,Q!==null?N=ui(Q,N):(N=ro(N,v,a,null),N.flags|=2),N.return=r,c.return=r,c.sibling=N,r.child=c,Bl(null,c),c=r.child,N=s.child.memoizedState,N===null?N=Nh(a):(v=N.cachePool,v!==null?(O=Gt._currentValue,v=v.parent!==O?{parent:O,pool:O}:v):v=Wg(),N={baseLanes:N.baseLanes|a,cachePool:v}),c.memoizedState=N,c.childLanes=Rh(s,A,a),r.memoizedState=Ih,Bl(s.child,c)):(ur(r),a=s.child,s=a.sibling,a=ui(a,{mode:"visible",children:c.children}),a.return=r,a.sibling=null,s!==null&&(A=r.deletions,A===null?(r.deletions=[s],r.flags|=16):A.push(s)),r.child=a,r.memoizedState=null,a)}function Dh(s,r){return r=Lc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Lc(s,r){return s=qn(22,s,null,r),s.lanes=0,s}function Mh(s,r,a){return ho(r,s.child,null,a),s=Dh(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function d0(s,r,a){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Yf(s.return,r,a)}function Ph(s,r,a,c,v,_){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:v,treeForkCount:_}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=a,A.tailMode=v,A.treeForkCount=_)}function f0(s,r,a){var c=r.pendingProps,v=c.revealOrder,_=c.tail;c=c.children;var A=Ot.current,N=(A&2)!==0;if(N?(A=A&1|2,r.flags|=128):A&=1,_e(Ot,A),fn(s,r,c,a),c=st?Nl:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&d0(s,a,r);else if(s.tag===19)d0(s,a,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(a=r.child,v=null;a!==null;)s=a.alternate,s!==null&&Ac(s)===null&&(v=a),a=a.sibling;a=v,a===null?(v=r.child,r.child=null):(v=a.sibling,a.sibling=null),Ph(r,!1,v,a,_,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,v=r.child,r.child=null;v!==null;){if(s=v.alternate,s!==null&&Ac(s)===null){r.child=v;break}s=v.sibling,v.sibling=a,a=v,v=s}Ph(r,!0,a,null,_,c);break;case"together":Ph(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function pi(s,r,a){if(s!==null&&(r.dependencies=s.dependencies),hr|=r.lanes,(a&r.childLanes)===0)if(s!==null){if(sa(s,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,a=ui(s,s.pendingProps),r.child=a,a.return=r;s.sibling!==null;)s=s.sibling,a=a.sibling=ui(s,s.pendingProps),a.return=r;a.sibling=null}return r.child}function kh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&gc(s)))}function HS(s,r,a){switch(r.tag){case 3:he(r,r.stateNode.containerInfo),rr(r,Gt,s.memoizedState.cache),oo();break;case 27:case 5:Ge(r);break;case 4:he(r,r.stateNode.containerInfo);break;case 10:rr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,rh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ur(r),r.flags|=128,null):(a&r.child.childLanes)!==0?c0(s,r,a):(ur(r),s=pi(s,r,a),s!==null?s.sibling:null);ur(r);break;case 19:var v=(s.flags&128)!==0;if(c=(a&r.childLanes)!==0,c||(sa(s,r,a,!1),c=(a&r.childLanes)!==0),v){if(c)return f0(s,r,a);r.flags|=128}if(v=r.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),_e(Ot,Ot.current),c)break;return null;case 22:return r.lanes=0,i0(s,r,a,r.pendingProps);case 24:rr(r,Gt,s.memoizedState.cache)}return pi(s,r,a)}function h0(s,r,a){if(s!==null)if(s.memoizedProps!==r.pendingProps)Yt=!0;else{if(!kh(s,a)&&(r.flags&128)===0)return Yt=!1,HS(s,r,a);Yt=(s.flags&131072)!==0}else Yt=!1,st&&(r.flags&1048576)!==0&&Gg(r,Nl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=co(r.elementType),r.type=s,typeof s=="function")qf(s)?(c=po(s,c),r.tag=1,r=l0(null,r,s,c,a)):(r.tag=0,r=wh(null,r,s,c,a));else{if(s!=null){var v=s.$$typeof;if(v===q){r.tag=11,r=t0(null,r,s,c,a);break e}else if(v===R){r.tag=14,r=n0(null,r,s,c,a);break e}}throw r=Oe(s)||s,Error(i(306,r,""))}}return r;case 0:return wh(s,r,r.type,r.pendingProps,a);case 1:return c=r.type,v=po(c,r.pendingProps),l0(s,r,c,v,a);case 3:e:{if(he(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var _=r.memoizedState;v=_.element,eh(s,r),Ul(r,c,null,a);var A=r.memoizedState;if(c=A.cache,rr(r,Gt,c),c!==_.cache&&Jf(r,[Gt],a,!0),Ll(),c=A.element,_.isDehydrated)if(_={element:c,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){r=u0(s,r,c,a);break e}else if(c!==v){v=es(Error(i(424)),r),Rl(v),r=u0(s,r,c,a);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(At=rs(s.firstChild),cn=r,st=!0,sr=null,ss=!0,a=iy(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(oo(),c===v){r=pi(s,r,a);break e}fn(s,r,c,a)}r=r.child}return r;case 26:return Vc(s,r),s===null?(a=Av(r.type,null,r.pendingProps,null))?r.memoizedState=a:st||(a=r.type,s=r.pendingProps,c=Wc(Ve.current).createElement(a),c[Bt]=r,c[nn]=s,hn(c,a,s),zt(c),r.stateNode=c):r.memoizedState=Av(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Ge(r),s===null&&st&&(c=r.stateNode=Ev(r.type,r.pendingProps,Ve.current),cn=r,ss=!0,v=At,vr(r.type)?(hm=v,At=rs(c.firstChild)):At=v),fn(s,r,r.pendingProps.children,a),Vc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&st&&((v=c=At)&&(c=TC(c,r.type,r.pendingProps,ss),c!==null?(r.stateNode=c,cn=r,At=rs(c.firstChild),ss=!1,v=!0):v=!1),v||ir(r)),Ge(r),v=r.type,_=r.pendingProps,A=s!==null?s.memoizedProps:null,c=_.children,lm(v,_)?c=null:A!==null&&lm(v,A)&&(r.flags|=32),r.memoizedState!==null&&(v=ah(s,r,VS,null,null,a),su._currentValue=v),Vc(s,r),fn(s,r,c,a),r.child;case 6:return s===null&&st&&((s=a=At)&&(a=EC(a,r.pendingProps,ss),a!==null?(r.stateNode=a,cn=r,At=null,s=!0):s=!1),s||ir(r)),null;case 13:return c0(s,r,a);case 4:return he(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=ho(r,null,c,a):fn(s,r,c,a),r.child;case 11:return t0(s,r,r.type,r.pendingProps,a);case 7:return fn(s,r,r.pendingProps,a),r.child;case 8:return fn(s,r,r.pendingProps.children,a),r.child;case 12:return fn(s,r,r.pendingProps.children,a),r.child;case 10:return c=r.pendingProps,rr(r,r.type,c.value),fn(s,r,c.children,a),r.child;case 9:return v=r.type._context,c=r.pendingProps.children,lo(r),v=dn(v),c=c(v),r.flags|=1,fn(s,r,c,a),r.child;case 14:return n0(s,r,r.type,r.pendingProps,a);case 15:return s0(s,r,r.type,r.pendingProps,a);case 19:return f0(s,r,a);case 31:return zS(s,r,a);case 22:return i0(s,r,a,r.pendingProps);case 24:return lo(r),c=dn(Gt),s===null?(v=Xf(),v===null&&(v=Tt,_=Kf(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=a),v=_),r.memoizedState={parent:c,cache:v},Zf(r),rr(r,Gt,v)):((s.lanes&a)!==0&&(eh(s,r),Ul(r,null,null,a),Ll()),v=s.memoizedState,_=r.memoizedState,v.parent!==c?(v={parent:c,cache:c},r.memoizedState=v,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=v),rr(r,Gt,c)):(c=_.cache,rr(r,Gt,c),c!==v.cache&&Jf(r,[Gt],a,!0))),fn(s,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function gi(s){s.flags|=4}function Vh(s,r,a,c,v){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(j0())s.flags|=8192;else throw fo=Tc,Wf}else s.flags&=-16777217}function m0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Nv(r))if(j0())s.flags|=8192;else throw fo=Tc,Wf}function Uc(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Vn():536870912,s.lanes|=r,pa|=r)}function zl(s,r){if(!st)switch(s.tailMode){case"hidden":r=s.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function St(s){var r=s.alternate!==null&&s.alternate.child===s.child,a=0,c=0;if(r)for(var v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags&65011712,c|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags,c|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=c,s.childLanes=a,r}function GS(s,r,a){var c=r.pendingProps;switch(zf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(r),null;case 1:return St(r),null;case 3:return a=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),fi(Gt),ye(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(na(r)?gi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Gf())),St(r),null;case 26:var v=r.type,_=r.memoizedState;return s===null?(gi(r),_!==null?(St(r),m0(r,_)):(St(r),Vh(r,v,null,c,a))):_?_!==s.memoizedState?(gi(r),St(r),m0(r,_)):(St(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&gi(r),St(r),Vh(r,v,s,c,a)),null;case 27:if(kt(r),a=Ve.current,v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return St(r),null}s=xe.current,na(r)?Yg(r):(s=Ev(v,c,a),r.stateNode=s,gi(r))}return St(r),null;case 5:if(kt(r),v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return St(r),null}if(_=xe.current,na(r))Yg(r);else{var A=Wc(Ve.current);switch(_){case 1:_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=A.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?_.multiple=!0:c.size&&(_.size=c.size);break;default:_=typeof c.is=="string"?A.createElement(v,{is:c.is}):A.createElement(v)}}_[Bt]=r,_[nn]=c;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=_;e:switch(hn(_,v,c),v){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&gi(r)}}return St(r),Vh(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,a),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&gi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ve.current,na(r)){if(s=r.stateNode,a=r.memoizedProps,c=null,v=cn,v!==null)switch(v.tag){case 27:case 5:c=v.memoizedProps}s[Bt]=r,s=!!(s.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||cv(s.nodeValue,a)),s||ir(r,!0)}else s=Wc(s).createTextNode(c),s[Bt]=r,r.stateNode=s}return St(r),null;case 31:if(a=r.memoizedState,s===null||s.memoizedState!==null){if(c=na(r),a!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Bt]=r}else oo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),s=!1}else a=Gf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return r.flags&256?(Fn(r),r):(Fn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return St(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=na(r),c!==null&&c.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[Bt]=r}else oo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;St(r),v=!1}else v=Gf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return r.flags&256?(Fn(r),r):(Fn(r),null)}return Fn(r),(r.flags&128)!==0?(r.lanes=a,r):(a=c!==null,s=s!==null&&s.memoizedState!==null,a&&(c=r.child,v=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(v=c.alternate.memoizedState.cachePool.pool),_=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(_=c.memoizedState.cachePool.pool),_!==v&&(c.flags|=2048)),a!==s&&a&&(r.child.flags|=8192),Uc(r,r.updateQueue),St(r),null);case 4:return ye(),s===null&&sm(r.stateNode.containerInfo),St(r),null;case 10:return fi(r.type),St(r),null;case 19:if(oe(Ot),c=r.memoizedState,c===null)return St(r),null;if(v=(r.flags&128)!==0,_=c.rendering,_===null)if(v)zl(c,!1);else{if(Pt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(_=Ac(s),_!==null){for(r.flags|=128,zl(c,!1),s=_.updateQueue,r.updateQueue=s,Uc(r,s),r.subtreeFlags=0,s=a,a=r.child;a!==null;)Bg(a,s),a=a.sibling;return _e(Ot,Ot.current&1|2),st&&ci(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&tn()>Bc&&(r.flags|=128,v=!0,zl(c,!1),r.lanes=4194304)}else{if(!v)if(s=Ac(_),s!==null){if(r.flags|=128,v=!0,s=s.updateQueue,r.updateQueue=s,Uc(r,s),zl(c,!0),c.tail===null&&c.tailMode==="hidden"&&!_.alternate&&!st)return St(r),null}else 2*tn()-c.renderingStartTime>Bc&&a!==536870912&&(r.flags|=128,v=!0,zl(c,!1),r.lanes=4194304);c.isBackwards?(_.sibling=r.child,r.child=_):(s=c.last,s!==null?s.sibling=_:r.child=_,c.last=_)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=tn(),s.sibling=null,a=Ot.current,_e(Ot,v?a&1|2:a&1),st&&ci(r,c.treeForkCount),s):(St(r),null);case 22:case 23:return Fn(r),ih(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(a&536870912)!==0&&(r.flags&128)===0&&(St(r),r.subtreeFlags&6&&(r.flags|=8192)):St(r),a=r.updateQueue,a!==null&&Uc(r,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==a&&(r.flags|=2048),s!==null&&oe(uo),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),fi(Gt),St(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function $S(s,r){switch(zf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return fi(Gt),ye(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return kt(r),null;case 31:if(r.memoizedState!==null){if(Fn(r),r.alternate===null)throw Error(i(340));oo()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Fn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));oo()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return oe(Ot),null;case 4:return ye(),null;case 10:return fi(r.type),null;case 22:case 23:return Fn(r),ih(),s!==null&&oe(uo),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return fi(Gt),null;case 25:return null;default:return null}}function p0(s,r){switch(zf(r),r.tag){case 3:fi(Gt),ye();break;case 26:case 27:case 5:kt(r);break;case 4:ye();break;case 31:r.memoizedState!==null&&Fn(r);break;case 13:Fn(r);break;case 19:oe(Ot);break;case 10:fi(r.type);break;case 22:case 23:Fn(r),ih(),s!==null&&oe(uo);break;case 24:fi(Gt)}}function Hl(s,r){try{var a=r.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var v=c.next;a=v;do{if((a.tag&s)===s){c=void 0;var _=a.create,A=a.inst;c=_(),A.destroy=c}a=a.next}while(a!==v)}}catch(N){mt(r,r.return,N)}}function dr(s,r,a){try{var c=r.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var _=v.next;c=_;do{if((c.tag&s)===s){var A=c.inst,N=A.destroy;if(N!==void 0){A.destroy=void 0,v=r;var O=a,Q=N;try{Q()}catch(ie){mt(v,O,ie)}}}c=c.next}while(c!==_)}}catch(ie){mt(r,r.return,ie)}}function g0(s){var r=s.updateQueue;if(r!==null){var a=s.stateNode;try{oy(r,a)}catch(c){mt(s,s.return,c)}}}function y0(s,r,a){a.props=po(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(c){mt(s,r,c)}}function Gl(s,r){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof a=="function"?s.refCleanup=a(c):a.current=c}}catch(v){mt(s,r,v)}}function $s(s,r){var a=s.ref,c=s.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(v){mt(s,r,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(v){mt(s,r,v)}else a.current=null}function v0(s){var r=s.type,a=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(v){mt(s,s.return,v)}}function Lh(s,r,a){try{var c=s.stateNode;mC(c,s.type,a,r),c[nn]=r}catch(v){mt(s,s.return,v)}}function _0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&vr(s.type)||s.tag===4}function Uh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||_0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&vr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Oh(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(s),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=ms));else if(c!==4&&(c===27&&vr(s.type)&&(a=s.stateNode,r=null),s=s.child,s!==null))for(Oh(s,r,a),s=s.sibling;s!==null;)Oh(s,r,a),s=s.sibling}function Oc(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?a.insertBefore(s,r):a.appendChild(s);else if(c!==4&&(c===27&&vr(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(Oc(s,r,a),s=s.sibling;s!==null;)Oc(s,r,a),s=s.sibling}function T0(s){var r=s.stateNode,a=s.memoizedProps;try{for(var c=s.type,v=r.attributes;v.length;)r.removeAttributeNode(v[0]);hn(r,c,a),r[Bt]=s,r[nn]=a}catch(_){mt(s,s.return,_)}}var yi=!1,Jt=!1,qh=!1,E0=typeof WeakSet=="function"?WeakSet:Set,rn=null;function YS(s,r){if(s=s.containerInfo,om=rd,s=Pg(s),Mf(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var v=c.anchorOffset,_=c.focusNode;c=c.focusOffset;try{a.nodeType,_.nodeType}catch{a=null;break e}var A=0,N=-1,O=-1,Q=0,ie=0,le=s,W=null;t:for(;;){for(var se;le!==a||v!==0&&le.nodeType!==3||(N=A+v),le!==_||c!==0&&le.nodeType!==3||(O=A+c),le.nodeType===3&&(A+=le.nodeValue.length),(se=le.firstChild)!==null;)W=le,le=se;for(;;){if(le===s)break t;if(W===a&&++Q===v&&(N=A),W===_&&++ie===c&&(O=A),(se=le.nextSibling)!==null)break;le=W,W=le.parentNode}le=se}a=N===-1||O===-1?null:{start:N,end:O}}else a=null}a=a||{start:0,end:0}}else a=null;for(am={focusedElem:s,selectionRange:a},rd=!1,rn=r;rn!==null;)if(r=rn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,rn=s;else for(;rn!==null;){switch(r=rn,_=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)v=s[a],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,a=r,v=_.memoizedProps,_=_.memoizedState,c=a.stateNode;try{var Ae=po(a.type,v);s=c.getSnapshotBeforeUpdate(Ae,_),c.__reactInternalSnapshotBeforeUpdate=s}catch(ke){mt(a,a.return,ke)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,a=s.nodeType,a===9)cm(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,rn=s;break}rn=r.return}}function x0(s,r,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:_i(s,a),c&4&&Hl(5,a);break;case 1:if(_i(s,a),c&4)if(s=a.stateNode,r===null)try{s.componentDidMount()}catch(A){mt(a,a.return,A)}else{var v=po(a.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(v,r,s.__reactInternalSnapshotBeforeUpdate)}catch(A){mt(a,a.return,A)}}c&64&&g0(a),c&512&&Gl(a,a.return);break;case 3:if(_i(s,a),c&64&&(s=a.updateQueue,s!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{oy(s,r)}catch(A){mt(a,a.return,A)}}break;case 27:r===null&&c&4&&T0(a);case 26:case 5:_i(s,a),r===null&&c&4&&v0(a),c&512&&Gl(a,a.return);break;case 12:_i(s,a);break;case 31:_i(s,a),c&4&&S0(s,a);break;case 13:_i(s,a),c&4&&C0(s,a),c&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=nC.bind(null,a),xC(s,a))));break;case 22:if(c=a.memoizedState!==null||yi,!c){r=r!==null&&r.memoizedState!==null||Jt,v=yi;var _=Jt;yi=c,(Jt=r)&&!_?Ti(s,a,(a.subtreeFlags&8772)!==0):_i(s,a),yi=v,Jt=_}break;case 30:break;default:_i(s,a)}}function b0(s){var r=s.alternate;r!==null&&(s.alternate=null,b0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&qo(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Nt=null,In=!1;function vi(s,r,a){for(a=a.child;a!==null;)A0(s,r,a),a=a.sibling}function A0(s,r,a){if(pe&&typeof pe.onCommitFiberUnmount=="function")try{pe.onCommitFiberUnmount(me,a)}catch{}switch(a.tag){case 26:Jt||$s(a,r),vi(s,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Jt||$s(a,r);var c=Nt,v=In;vr(a.type)&&(Nt=a.stateNode,In=!1),vi(s,r,a),eu(a.stateNode),Nt=c,In=v;break;case 5:Jt||$s(a,r);case 6:if(c=Nt,v=In,Nt=null,vi(s,r,a),Nt=c,In=v,Nt!==null)if(In)try{(Nt.nodeType===9?Nt.body:Nt.nodeName==="HTML"?Nt.ownerDocument.body:Nt).removeChild(a.stateNode)}catch(_){mt(a,r,_)}else try{Nt.removeChild(a.stateNode)}catch(_){mt(a,r,_)}break;case 18:Nt!==null&&(In?(s=Nt,gv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),ba(s)):gv(Nt,a.stateNode));break;case 4:c=Nt,v=In,Nt=a.stateNode.containerInfo,In=!0,vi(s,r,a),Nt=c,In=v;break;case 0:case 11:case 14:case 15:dr(2,a,r),Jt||dr(4,a,r),vi(s,r,a);break;case 1:Jt||($s(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"&&y0(a,r,c)),vi(s,r,a);break;case 21:vi(s,r,a);break;case 22:Jt=(c=Jt)||a.memoizedState!==null,vi(s,r,a),Jt=c;break;default:vi(s,r,a)}}function S0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{ba(s)}catch(a){mt(r,r.return,a)}}}function C0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ba(s)}catch(a){mt(r,r.return,a)}}function JS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new E0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new E0),r;default:throw Error(i(435,s.tag))}}function qc(s,r){var a=JS(s);r.forEach(function(c){if(!a.has(c)){a.add(c);var v=sC.bind(null,s,c);c.then(v,v)}})}function Nn(s,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var v=a[c],_=s,A=r,N=A;e:for(;N!==null;){switch(N.tag){case 27:if(vr(N.type)){Nt=N.stateNode,In=!1;break e}break;case 5:Nt=N.stateNode,In=!1;break e;case 3:case 4:Nt=N.stateNode.containerInfo,In=!0;break e}N=N.return}if(Nt===null)throw Error(i(160));A0(_,A,v),Nt=null,In=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)w0(r,s),r=r.sibling}var Ts=null;function w0(s,r){var a=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Nn(r,s),Rn(s),c&4&&(dr(3,s,s.return),Hl(3,s),dr(5,s,s.return));break;case 1:Nn(r,s),Rn(s),c&512&&(Jt||a===null||$s(a,a.return)),c&64&&yi&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var v=Ts;if(Nn(r,s),Rn(s),c&512&&(Jt||a===null||$s(a,a.return)),c&4){var _=a!==null?a.memoizedState:null;if(c=s.memoizedState,a===null)if(c===null)if(s.stateNode===null){e:{c=s.type,a=s.memoizedProps,v=v.ownerDocument||v;t:switch(c){case"title":_=v.getElementsByTagName("title")[0],(!_||_[Ms]||_[Bt]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(c),v.head.insertBefore(_,v.querySelector("head > title"))),hn(_,c,a),_[Bt]=s,zt(_),c=_;break e;case"link":var A=wv("link","href",v).get(c+(a.href||""));if(A){for(var N=0;N<A.length;N++)if(_=A[N],_.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&_.getAttribute("rel")===(a.rel==null?null:a.rel)&&_.getAttribute("title")===(a.title==null?null:a.title)&&_.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){A.splice(N,1);break t}}_=v.createElement(c),hn(_,c,a),v.head.appendChild(_);break;case"meta":if(A=wv("meta","content",v).get(c+(a.content||""))){for(N=0;N<A.length;N++)if(_=A[N],_.getAttribute("content")===(a.content==null?null:""+a.content)&&_.getAttribute("name")===(a.name==null?null:a.name)&&_.getAttribute("property")===(a.property==null?null:a.property)&&_.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&_.getAttribute("charset")===(a.charSet==null?null:a.charSet)){A.splice(N,1);break t}}_=v.createElement(c),hn(_,c,a),v.head.appendChild(_);break;default:throw Error(i(468,c))}_[Bt]=s,zt(_),c=_}s.stateNode=c}else Iv(v,s.type,s.stateNode);else s.stateNode=Cv(v,c,s.memoizedProps);else _!==c?(_===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):_.count--,c===null?Iv(v,s.type,s.stateNode):Cv(v,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Lh(s,s.memoizedProps,a.memoizedProps)}break;case 27:Nn(r,s),Rn(s),c&512&&(Jt||a===null||$s(a,a.return)),a!==null&&c&4&&Lh(s,s.memoizedProps,a.memoizedProps);break;case 5:if(Nn(r,s),Rn(s),c&512&&(Jt||a===null||$s(a,a.return)),s.flags&32){v=s.stateNode;try{wn(v,"")}catch(Ae){mt(s,s.return,Ae)}}c&4&&s.stateNode!=null&&(v=s.memoizedProps,Lh(s,v,a!==null?a.memoizedProps:v)),c&1024&&(qh=!0);break;case 6:if(Nn(r,s),Rn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,a=s.stateNode;try{a.nodeValue=c}catch(Ae){mt(s,s.return,Ae)}}break;case 3:if(td=null,v=Ts,Ts=Zc(r.containerInfo),Nn(r,s),Ts=v,Rn(s),c&4&&a!==null&&a.memoizedState.isDehydrated)try{ba(r.containerInfo)}catch(Ae){mt(s,s.return,Ae)}qh&&(qh=!1,I0(s));break;case 4:c=Ts,Ts=Zc(s.stateNode.containerInfo),Nn(r,s),Rn(s),Ts=c;break;case 12:Nn(r,s),Rn(s);break;case 31:Nn(r,s),Rn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,qc(s,c)));break;case 13:Nn(r,s),Rn(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Fc=tn()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,qc(s,c)));break;case 22:v=s.memoizedState!==null;var O=a!==null&&a.memoizedState!==null,Q=yi,ie=Jt;if(yi=Q||v,Jt=ie||O,Nn(r,s),Jt=ie,yi=Q,Rn(s),c&8192)e:for(r=s.stateNode,r._visibility=v?r._visibility&-2:r._visibility|1,v&&(a===null||O||yi||Jt||go(s)),a=null,r=s;;){if(r.tag===5||r.tag===26){if(a===null){O=a=r;try{if(_=O.stateNode,v)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{N=O.stateNode;var le=O.memoizedProps.style,W=le!=null&&le.hasOwnProperty("display")?le.display:null;N.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Ae){mt(O,O.return,Ae)}}}else if(r.tag===6){if(a===null){O=r;try{O.stateNode.nodeValue=v?"":O.memoizedProps}catch(Ae){mt(O,O.return,Ae)}}}else if(r.tag===18){if(a===null){O=r;try{var se=O.stateNode;v?yv(se,!0):yv(O.stateNode,!1)}catch(Ae){mt(O,O.return,Ae)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,qc(s,a))));break;case 19:Nn(r,s),Rn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,qc(s,c)));break;case 30:break;case 21:break;default:Nn(r,s),Rn(s)}}function Rn(s){var r=s.flags;if(r&2){try{for(var a,c=s.return;c!==null;){if(_0(c)){a=c;break}c=c.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var v=a.stateNode,_=Uh(s);Oc(s,_,v);break;case 5:var A=a.stateNode;a.flags&32&&(wn(A,""),a.flags&=-33);var N=Uh(s);Oc(s,N,A);break;case 3:case 4:var O=a.stateNode.containerInfo,Q=Uh(s);Oh(s,Q,O);break;default:throw Error(i(161))}}catch(ie){mt(s,s.return,ie)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function I0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;I0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function _i(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)x0(s,r.alternate,r),r=r.sibling}function go(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:dr(4,r,r.return),go(r);break;case 1:$s(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&y0(r,r.return,a),go(r);break;case 27:eu(r.stateNode);case 26:case 5:$s(r,r.return),go(r);break;case 22:r.memoizedState===null&&go(r);break;case 30:go(r);break;default:go(r)}s=s.sibling}}function Ti(s,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,v=s,_=r,A=_.flags;switch(_.tag){case 0:case 11:case 15:Ti(v,_,a),Hl(4,_);break;case 1:if(Ti(v,_,a),c=_,v=c.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(Q){mt(c,c.return,Q)}if(c=_,v=c.updateQueue,v!==null){var N=c.stateNode;try{var O=v.shared.hiddenCallbacks;if(O!==null)for(v.shared.hiddenCallbacks=null,v=0;v<O.length;v++)ry(O[v],N)}catch(Q){mt(c,c.return,Q)}}a&&A&64&&g0(_),Gl(_,_.return);break;case 27:T0(_);case 26:case 5:Ti(v,_,a),a&&c===null&&A&4&&v0(_),Gl(_,_.return);break;case 12:Ti(v,_,a);break;case 31:Ti(v,_,a),a&&A&4&&S0(v,_);break;case 13:Ti(v,_,a),a&&A&4&&C0(v,_);break;case 22:_.memoizedState===null&&Ti(v,_,a),Gl(_,_.return);break;case 30:break;default:Ti(v,_,a)}r=r.sibling}}function jh(s,r){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&Dl(a))}function Fh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Dl(s))}function Es(s,r,a,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N0(s,r,a,c),r=r.sibling}function N0(s,r,a,c){var v=r.flags;switch(r.tag){case 0:case 11:case 15:Es(s,r,a,c),v&2048&&Hl(9,r);break;case 1:Es(s,r,a,c);break;case 3:Es(s,r,a,c),v&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Dl(s)));break;case 12:if(v&2048){Es(s,r,a,c),s=r.stateNode;try{var _=r.memoizedProps,A=_.id,N=_.onPostCommit;typeof N=="function"&&N(A,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(O){mt(r,r.return,O)}}else Es(s,r,a,c);break;case 31:Es(s,r,a,c);break;case 13:Es(s,r,a,c);break;case 23:break;case 22:_=r.stateNode,A=r.alternate,r.memoizedState!==null?_._visibility&2?Es(s,r,a,c):$l(s,r):_._visibility&2?Es(s,r,a,c):(_._visibility|=2,fa(s,r,a,c,(r.subtreeFlags&10256)!==0||!1)),v&2048&&jh(A,r);break;case 24:Es(s,r,a,c),v&2048&&Fh(r.alternate,r);break;default:Es(s,r,a,c)}}function fa(s,r,a,c,v){for(v=v&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var _=s,A=r,N=a,O=c,Q=A.flags;switch(A.tag){case 0:case 11:case 15:fa(_,A,N,O,v),Hl(8,A);break;case 23:break;case 22:var ie=A.stateNode;A.memoizedState!==null?ie._visibility&2?fa(_,A,N,O,v):$l(_,A):(ie._visibility|=2,fa(_,A,N,O,v)),v&&Q&2048&&jh(A.alternate,A);break;case 24:fa(_,A,N,O,v),v&&Q&2048&&Fh(A.alternate,A);break;default:fa(_,A,N,O,v)}r=r.sibling}}function $l(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=s,c=r,v=c.flags;switch(c.tag){case 22:$l(a,c),v&2048&&jh(c.alternate,c);break;case 24:$l(a,c),v&2048&&Fh(c.alternate,c);break;default:$l(a,c)}r=r.sibling}}var Yl=8192;function ha(s,r,a){if(s.subtreeFlags&Yl)for(s=s.child;s!==null;)R0(s,r,a),s=s.sibling}function R0(s,r,a){switch(s.tag){case 26:ha(s,r,a),s.flags&Yl&&s.memoizedState!==null&&kC(a,Ts,s.memoizedState,s.memoizedProps);break;case 5:ha(s,r,a);break;case 3:case 4:var c=Ts;Ts=Zc(s.stateNode.containerInfo),ha(s,r,a),Ts=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Yl,Yl=16777216,ha(s,r,a),Yl=c):ha(s,r,a));break;default:ha(s,r,a)}}function D0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Jl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];rn=c,P0(c,s)}D0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)M0(s),s=s.sibling}function M0(s){switch(s.tag){case 0:case 11:case 15:Jl(s),s.flags&2048&&dr(9,s,s.return);break;case 3:Jl(s);break;case 12:Jl(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,jc(s)):Jl(s);break;default:Jl(s)}}function jc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];rn=c,P0(c,s)}D0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:dr(8,r,r.return),jc(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,jc(r));break;default:jc(r)}s=s.sibling}}function P0(s,r){for(;rn!==null;){var a=rn;switch(a.tag){case 0:case 11:case 15:dr(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Dl(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,rn=c;else e:for(a=s;rn!==null;){c=rn;var v=c.sibling,_=c.return;if(b0(c),c===a){rn=null;break e}if(v!==null){v.return=_,rn=v;break e}rn=_}}}var KS={getCacheForType:function(s){var r=dn(Gt),a=r.data.get(s);return a===void 0&&(a=s(),r.data.set(s,a)),a},cacheSignal:function(){return dn(Gt).controller.signal}},QS=typeof WeakMap=="function"?WeakMap:Map,ct=0,Tt=null,Qe=null,We=0,ht=0,Bn=null,fr=!1,ma=!1,Bh=!1,Ei=0,Pt=0,hr=0,yo=0,zh=0,zn=0,pa=0,Kl=null,Dn=null,Hh=!1,Fc=0,k0=0,Bc=1/0,zc=null,mr=null,Wt=0,pr=null,ga=null,xi=0,Gh=0,$h=null,V0=null,Ql=0,Yh=null;function Hn(){return(ct&2)!==0&&We!==0?We&-We:te.T!==null?Zh():Hu()}function L0(){if(zn===0)if((We&536870912)===0||st){var s=ds;ds<<=1,(ds&3932160)===0&&(ds=262144),zn=s}else zn=536870912;return s=jn.current,s!==null&&(s.flags|=32),zn}function Mn(s,r,a){(s===Tt&&(ht===2||ht===9)||s.cancelPendingCommit!==null)&&(ya(s,0),gr(s,We,zn,!1)),Ns(s,a),((ct&2)===0||s!==Tt)&&(s===Tt&&((ct&2)===0&&(yo|=a),Pt===4&&gr(s,We,zn,!1)),Ys(s))}function U0(s,r,a){if((ct&6)!==0)throw Error(i(327));var c=!a&&(r&127)===0&&(r&s.expiredLanes)===0||Lt(s,r),v=c?ZS(s,r):Kh(s,r,!0),_=c;do{if(v===0){ma&&!c&&gr(s,r,0,!1);break}else{if(a=s.current.alternate,_&&!XS(a)){v=Kh(s,r,!1),_=!1;continue}if(v===2){if(_=r,s.errorRecoveryDisabledLanes&_)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var N=s;v=Kl;var O=N.current.memoizedState.isDehydrated;if(O&&(ya(N,A).flags|=256),A=Kh(N,A,!1),A!==2){if(Bh&&!O){N.errorRecoveryDisabledLanes|=_,yo|=_,v=4;break e}_=Dn,Dn=v,_!==null&&(Dn===null?Dn=_:Dn.push.apply(Dn,_))}v=A}if(_=!1,v!==2)continue}}if(v===1){ya(s,0),gr(s,r,0,!0);break}e:{switch(c=s,_=v,_){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:gr(c,r,zn,!fr);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(v=Fc+300-tn(),10<v)){if(gr(c,r,zn,!fr),rt(c,0,!0)!==0)break e;xi=r,c.timeoutHandle=mv(O0.bind(null,c,a,Dn,zc,Hh,r,zn,yo,pa,fr,_,"Throttled",-0,0),v);break e}O0(c,a,Dn,zc,Hh,r,zn,yo,pa,fr,_,null,-0,0)}}break}while(!0);Ys(s)}function O0(s,r,a,c,v,_,A,N,O,Q,ie,le,W,se){if(s.timeoutHandle=-1,le=r.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ms},R0(r,_,le);var Ae=(_&62914560)===_?Fc-tn():(_&4194048)===_?k0-tn():0;if(Ae=VC(le,Ae),Ae!==null){xi=_,s.cancelPendingCommit=Ae($0.bind(null,s,r,_,a,c,v,A,N,O,ie,le,null,W,se)),gr(s,_,A,!Q);return}}$0(s,r,_,a,c,v,A,N,O)}function XS(s){for(var r=s;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var v=a[c],_=v.getSnapshot;v=v.value;try{if(!On(_(),v))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function gr(s,r,a,c){r&=~zh,r&=~yo,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var v=r;0<v;){var _=31-Ne(v),A=1<<_;c[_]=-1,v&=~A}a!==0&&Rs(s,a,r)}function Hc(){return(ct&6)===0?(Xl(0),!1):!0}function Jh(){if(Qe!==null){if(ht===0)var s=Qe.return;else s=Qe,di=ao=null,ch(s),aa=null,Pl=0,s=Qe;for(;s!==null;)p0(s.alternate,s),s=s.return;Qe=null}}function ya(s,r){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,yC(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),xi=0,Jh(),Tt=s,Qe=a=ui(s.current,null),We=r,ht=0,Bn=null,fr=!1,ma=Lt(s,r),Bh=!1,pa=zn=zh=yo=hr=Pt=0,Dn=Kl=null,Hh=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var v=31-Ne(c),_=1<<v;r|=s[v],c&=~_}return Ei=r,dc(),a}function q0(s,r){He=null,te.H=Fl,r===oa||r===_c?(r=ty(),ht=3):r===Wf?(r=ty(),ht=4):ht=r===Ch?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Bn=r,Qe===null&&(Pt=1,Pc(s,es(r,s.current)))}function j0(){var s=jn.current;return s===null?!0:(We&4194048)===We?is===null:(We&62914560)===We||(We&536870912)!==0?s===is:!1}function F0(){var s=te.H;return te.H=Fl,s===null?Fl:s}function B0(){var s=te.A;return te.A=KS,s}function Gc(){Pt=4,fr||(We&4194048)!==We&&jn.current!==null||(ma=!0),(hr&134217727)===0&&(yo&134217727)===0||Tt===null||gr(Tt,We,zn,!1)}function Kh(s,r,a){var c=ct;ct|=2;var v=F0(),_=B0();(Tt!==s||We!==r)&&(zc=null,ya(s,r)),r=!1;var A=Pt;e:do try{if(ht!==0&&Qe!==null){var N=Qe,O=Bn;switch(ht){case 8:Jh(),A=6;break e;case 3:case 2:case 9:case 6:jn.current===null&&(r=!0);var Q=ht;if(ht=0,Bn=null,va(s,N,O,Q),a&&ma){A=0;break e}break;default:Q=ht,ht=0,Bn=null,va(s,N,O,Q)}}WS(),A=Pt;break}catch(ie){q0(s,ie)}while(!0);return r&&s.shellSuspendCounter++,di=ao=null,ct=c,te.H=v,te.A=_,Qe===null&&(Tt=null,We=0,dc()),A}function WS(){for(;Qe!==null;)z0(Qe)}function ZS(s,r){var a=ct;ct|=2;var c=F0(),v=B0();Tt!==s||We!==r?(zc=null,Bc=tn()+500,ya(s,r)):ma=Lt(s,r);e:do try{if(ht!==0&&Qe!==null){r=Qe;var _=Bn;t:switch(ht){case 1:ht=0,Bn=null,va(s,r,_,1);break;case 2:case 9:if(Zg(_)){ht=0,Bn=null,H0(r);break}r=function(){ht!==2&&ht!==9||Tt!==s||(ht=7),Ys(s)},_.then(r,r);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Zg(_)?(ht=0,Bn=null,H0(r)):(ht=0,Bn=null,va(s,r,_,7));break;case 5:var A=null;switch(Qe.tag){case 26:A=Qe.memoizedState;case 5:case 27:var N=Qe;if(A?Nv(A):N.stateNode.complete){ht=0,Bn=null;var O=N.sibling;if(O!==null)Qe=O;else{var Q=N.return;Q!==null?(Qe=Q,$c(Q)):Qe=null}break t}}ht=0,Bn=null,va(s,r,_,5);break;case 6:ht=0,Bn=null,va(s,r,_,6);break;case 8:Jh(),Pt=6;break e;default:throw Error(i(462))}}eC();break}catch(ie){q0(s,ie)}while(!0);return di=ao=null,te.H=c,te.A=v,ct=a,Qe!==null?0:(Tt=null,We=0,dc(),Pt)}function eC(){for(;Qe!==null&&!al();)z0(Qe)}function z0(s){var r=h0(s.alternate,s,Ei);s.memoizedProps=s.pendingProps,r===null?$c(s):Qe=r}function H0(s){var r=s,a=r.alternate;switch(r.tag){case 15:case 0:r=a0(a,r,r.pendingProps,r.type,void 0,We);break;case 11:r=a0(a,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:ch(r);default:p0(a,r),r=Qe=Bg(r,Ei),r=h0(a,r,Ei)}s.memoizedProps=s.pendingProps,r===null?$c(s):Qe=r}function va(s,r,a,c){di=ao=null,ch(r),aa=null,Pl=0;var v=r.return;try{if(BS(s,v,r,a,We)){Pt=1,Pc(s,es(a,s.current)),Qe=null;return}}catch(_){if(v!==null)throw Qe=v,_;Pt=1,Pc(s,es(a,s.current)),Qe=null;return}r.flags&32768?(st||c===1?s=!0:ma||(We&536870912)!==0?s=!1:(fr=s=!0,(c===2||c===9||c===3||c===6)&&(c=jn.current,c!==null&&c.tag===13&&(c.flags|=16384))),G0(r,s)):$c(r)}function $c(s){var r=s;do{if((r.flags&32768)!==0){G0(r,fr);return}s=r.return;var a=GS(r.alternate,r,Ei);if(a!==null){Qe=a;return}if(r=r.sibling,r!==null){Qe=r;return}Qe=r=s}while(r!==null);Pt===0&&(Pt=5)}function G0(s,r){do{var a=$S(s.alternate,s);if(a!==null){a.flags&=32767,Qe=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(s=s.sibling,s!==null)){Qe=s;return}Qe=s=a}while(s!==null);Pt=6,Qe=null}function $0(s,r,a,c,v,_,A,N,O){s.cancelPendingCommit=null;do Yc();while(Wt!==0);if((ct&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(_=r.lanes|r.childLanes,_|=Uf,Uo(s,a,_,A,N,O),s===Tt&&(Qe=Tt=null,We=0),ga=r,pr=s,xi=a,Gh=_,$h=v,V0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,iC(cs,function(){return X0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=te.T,te.T=null,v=Z.p,Z.p=2,A=ct,ct|=4;try{YS(s,r,a)}finally{ct=A,Z.p=v,te.T=c}}Wt=1,Y0(),J0(),K0()}}function Y0(){if(Wt===1){Wt=0;var s=pr,r=ga,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=te.T,te.T=null;var c=Z.p;Z.p=2;var v=ct;ct|=4;try{w0(r,s);var _=am,A=Pg(s.containerInfo),N=_.focusedElem,O=_.selectionRange;if(A!==N&&N&&N.ownerDocument&&Mg(N.ownerDocument.documentElement,N)){if(O!==null&&Mf(N)){var Q=O.start,ie=O.end;if(ie===void 0&&(ie=Q),"selectionStart"in N)N.selectionStart=Q,N.selectionEnd=Math.min(ie,N.value.length);else{var le=N.ownerDocument||document,W=le&&le.defaultView||window;if(W.getSelection){var se=W.getSelection(),Ae=N.textContent.length,ke=Math.min(O.start,Ae),vt=O.end===void 0?ke:Math.min(O.end,Ae);!se.extend&&ke>vt&&(A=vt,vt=ke,ke=A);var G=Dg(N,ke),B=Dg(N,vt);if(G&&B&&(se.rangeCount!==1||se.anchorNode!==G.node||se.anchorOffset!==G.offset||se.focusNode!==B.node||se.focusOffset!==B.offset)){var K=le.createRange();K.setStart(G.node,G.offset),se.removeAllRanges(),ke>vt?(se.addRange(K),se.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),se.addRange(K))}}}}for(le=[],se=N;se=se.parentNode;)se.nodeType===1&&le.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<le.length;N++){var ae=le[N];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}rd=!!om,am=om=null}finally{ct=v,Z.p=c,te.T=a}}s.current=r,Wt=2}}function J0(){if(Wt===2){Wt=0;var s=pr,r=ga,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=te.T,te.T=null;var c=Z.p;Z.p=2;var v=ct;ct|=4;try{x0(s,r.alternate,r)}finally{ct=v,Z.p=c,te.T=a}}Wt=3}}function K0(){if(Wt===4||Wt===3){Wt=0,Vo();var s=pr,r=ga,a=xi,c=V0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Wt=5:(Wt=0,ga=pr=null,Q0(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(mr=null),ri(a),r=r.stateNode,pe&&typeof pe.onCommitFiberRoot=="function")try{pe.onCommitFiberRoot(me,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=te.T,v=Z.p,Z.p=2,te.T=null;try{for(var _=s.onRecoverableError,A=0;A<c.length;A++){var N=c[A];_(N.value,{componentStack:N.stack})}}finally{te.T=r,Z.p=v}}(xi&3)!==0&&Yc(),Ys(s),v=s.pendingLanes,(a&261930)!==0&&(v&42)!==0?s===Yh?Ql++:(Ql=0,Yh=s):Ql=0,Xl(0)}}function Q0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Dl(r)))}function Yc(){return Y0(),J0(),K0(),X0()}function X0(){if(Wt!==5)return!1;var s=pr,r=Gh;Gh=0;var a=ri(xi),c=te.T,v=Z.p;try{Z.p=32>a?32:a,te.T=null,a=$h,$h=null;var _=pr,A=xi;if(Wt=0,ga=pr=null,xi=0,(ct&6)!==0)throw Error(i(331));var N=ct;if(ct|=4,M0(_.current),N0(_,_.current,A,a),ct=N,Xl(0,!1),pe&&typeof pe.onPostCommitFiberRoot=="function")try{pe.onPostCommitFiberRoot(me,_)}catch{}return!0}finally{Z.p=v,te.T=c,Q0(s,r)}}function W0(s,r,a){r=es(a,r),r=Sh(s.stateNode,r,2),s=lr(s,r,2),s!==null&&(Ns(s,2),Ys(s))}function mt(s,r,a){if(s.tag===3)W0(s,s,a);else for(;r!==null;){if(r.tag===3){W0(r,s,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(mr===null||!mr.has(c))){s=es(a,s),a=Zy(2),c=lr(r,a,2),c!==null&&(e0(a,c,r,s),Ns(c,2),Ys(c));break}}r=r.return}}function Qh(s,r,a){var c=s.pingCache;if(c===null){c=s.pingCache=new QS;var v=new Set;c.set(r,v)}else v=c.get(r),v===void 0&&(v=new Set,c.set(r,v));v.has(a)||(Bh=!0,v.add(a),s=tC.bind(null,s,r,a),r.then(s,s))}function tC(s,r,a){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,Tt===s&&(We&a)===a&&(Pt===4||Pt===3&&(We&62914560)===We&&300>tn()-Fc?(ct&2)===0&&ya(s,0):zh|=a,pa===We&&(pa=0)),Ys(s)}function Z0(s,r){r===0&&(r=Vn()),s=io(s,r),s!==null&&(Ns(s,r),Ys(s))}function nC(s){var r=s.memoizedState,a=0;r!==null&&(a=r.retryLane),Z0(s,a)}function sC(s,r){var a=0;switch(s.tag){case 31:case 13:var c=s.stateNode,v=s.memoizedState;v!==null&&(a=v.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Z0(s,a)}function iC(s,r){return Vt(s,r)}var Jc=null,_a=null,Xh=!1,Kc=!1,Wh=!1,yr=0;function Ys(s){s!==_a&&s.next===null&&(_a===null?Jc=_a=s:_a=_a.next=s),Kc=!0,Xh||(Xh=!0,oC())}function Xl(s,r){if(!Wh&&Kc){Wh=!0;do for(var a=!1,c=Jc;c!==null;){if(s!==0){var v=c.pendingLanes;if(v===0)var _=0;else{var A=c.suspendedLanes,N=c.pingedLanes;_=(1<<31-Ne(42|s)+1)-1,_&=v&~(A&~N),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(a=!0,sv(c,_))}else _=We,_=rt(c,c===Tt?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(_&3)===0||Lt(c,_)||(a=!0,sv(c,_));c=c.next}while(a);Wh=!1}}function rC(){ev()}function ev(){Kc=Xh=!1;var s=0;yr!==0&&gC()&&(s=yr);for(var r=tn(),a=null,c=Jc;c!==null;){var v=c.next,_=tv(c,r);_===0?(c.next=null,a===null?Jc=v:a.next=v,v===null&&(_a=a)):(a=c,(s!==0||(_&3)!==0)&&(Kc=!0)),c=v}Wt!==0&&Wt!==5||Xl(s),yr!==0&&(yr=0)}function tv(s,r){for(var a=s.suspendedLanes,c=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var A=31-Ne(_),N=1<<A,O=v[A];O===-1?((N&a)===0||(N&c)!==0)&&(v[A]=bt(N,r)):O<=r&&(s.expiredLanes|=N),_&=~N}if(r=Tt,a=We,a=rt(s,s===r?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,a===0||s===r&&(ht===2||ht===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&$n(c),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||Lt(s,a)){if(r=a&-a,r===s.callbackPriority)return r;switch(c!==null&&$n(c),ri(a)){case 2:case 8:a=Gi;break;case 32:a=cs;break;case 268435456:a=Gr;break;default:a=cs}return c=nv.bind(null,s),a=Vt(a,c),s.callbackPriority=r,s.callbackNode=a,r}return c!==null&&c!==null&&$n(c),s.callbackPriority=2,s.callbackNode=null,2}function nv(s,r){if(Wt!==0&&Wt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(Yc()&&s.callbackNode!==a)return null;var c=We;return c=rt(s,s===Tt?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(U0(s,c,r),tv(s,tn()),s.callbackNode!=null&&s.callbackNode===a?nv.bind(null,s):null)}function sv(s,r){if(Yc())return null;U0(s,r,!0)}function oC(){vC(function(){(ct&6)!==0?Vt(Hi,rC):ev()})}function Zh(){if(yr===0){var s=ia;s===0&&(s=Sn,Sn<<=1,(Sn&261888)===0&&(Sn=256)),yr=s}return yr}function iv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:zo(""+s)}function rv(s,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,s.id&&a.setAttribute("form",s.id),r.parentNode.insertBefore(a,r),s=new FormData(s),a.parentNode.removeChild(a),s}function aC(s,r,a,c,v){if(r==="submit"&&a&&a.stateNode===v){var _=iv((v[nn]||null).action),A=c.submitter;A&&(r=(r=A[nn]||null)?iv(r.formAction):A.getAttribute("formAction"),r!==null&&(_=r,A=null));var N=new js("action","action",null,c,v);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(yr!==0){var O=A?rv(v,A):new FormData(v);_h(a,{pending:!0,data:O,method:v.method,action:_},null,O)}}else typeof _=="function"&&(N.preventDefault(),O=A?rv(v,A):new FormData(v),_h(a,{pending:!0,data:O,method:v.method,action:_},_,O))},currentTarget:v}]})}}for(var em=0;em<Lf.length;em++){var tm=Lf[em],lC=tm.toLowerCase(),uC=tm[0].toUpperCase()+tm.slice(1);_s(lC,"on"+uC)}_s(Lg,"onAnimationEnd"),_s(Ug,"onAnimationIteration"),_s(Og,"onAnimationStart"),_s("dblclick","onDoubleClick"),_s("focusin","onFocus"),_s("focusout","onBlur"),_s(SS,"onTransitionRun"),_s(CS,"onTransitionStart"),_s(wS,"onTransitionCancel"),_s(qg,"onTransitionEnd"),Ls("onMouseEnter",["mouseout","mouseover"]),Ls("onMouseLeave",["mouseout","mouseover"]),Ls("onPointerEnter",["pointerout","pointerover"]),Ls("onPointerLeave",["pointerout","pointerover"]),Vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wl));function ov(s,r){r=(r&4)!==0;for(var a=0;a<s.length;a++){var c=s[a],v=c.event;c=c.listeners;e:{var _=void 0;if(r)for(var A=c.length-1;0<=A;A--){var N=c[A],O=N.instance,Q=N.currentTarget;if(N=N.listener,O!==_&&v.isPropagationStopped())break e;_=N,v.currentTarget=Q;try{_(v)}catch(ie){cc(ie)}v.currentTarget=null,_=O}else for(A=0;A<c.length;A++){if(N=c[A],O=N.instance,Q=N.currentTarget,N=N.listener,O!==_&&v.isPropagationStopped())break e;_=N,v.currentTarget=Q;try{_(v)}catch(ie){cc(ie)}v.currentTarget=null,_=O}}}}function Xe(s,r){var a=r[Oo];a===void 0&&(a=r[Oo]=new Set);var c=s+"__bubble";a.has(c)||(av(r,s,2,!1),a.add(c))}function nm(s,r,a){var c=0;r&&(c|=4),av(a,s,c,r)}var Qc="_reactListening"+Math.random().toString(36).slice(2);function sm(s){if(!s[Qc]){s[Qc]=!0,cl.forEach(function(a){a!=="selectionchange"&&(cC.has(a)||nm(a,!1,s),nm(a,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Qc]||(r[Qc]=!0,nm("selectionchange",!1,r))}}function av(s,r,a,c){switch(Lv(r)){case 2:var v=OC;break;case 8:v=qC;break;default:v=vm}a=v.bind(null,r,a,s),v=void 0,!Qr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(v=!0),c?v!==void 0?s.addEventListener(r,a,{capture:!0,passive:v}):s.addEventListener(r,a,!0):v!==void 0?s.addEventListener(r,a,{passive:v}):s.addEventListener(r,a,!1)}function im(s,r,a,c,v){var _=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var N=c.stateNode.containerInfo;if(N===v)break;if(A===4)for(A=c.return;A!==null;){var O=A.tag;if((O===3||O===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;N!==null;){if(A=Ps(N),A===null)return;if(O=A.tag,O===5||O===6||O===26||O===27){c=_=A;continue e}N=N.parentNode}}c=c.return}Wi(function(){var Q=_,ie=Qn(a),le=[];e:{var W=jg.get(s);if(W!==void 0){var se=js,Ae=s;switch(s){case"keypress":if(Wr(a)===0)break e;case"keydown":case"keyup":se=ac;break;case"focusin":Ae="focus",se=eo;break;case"focusout":Ae="blur",se=eo;break;case"beforeblur":case"afterblur":se=eo;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=Wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=x;break;case Lg:case Ug:case Og:se=ec;break;case qg:se=M;break;case"scroll":case"scrollend":se=xl;break;case"wheel":se=ne;break;case"copy":case"cut":case"paste":se=tc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=li;break;case"toggle":case"beforetoggle":se=ze}var ke=(r&4)!==0,vt=!ke&&(s==="scroll"||s==="scrollend"),G=ke?W!==null?W+"Capture":null:W;ke=[];for(var B=Q,K;B!==null;){var ae=B;if(K=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||K===null||G===null||(ae=ps(B,G),ae!=null&&ke.push(Zl(B,ae,K))),vt)break;B=B.return}0<ke.length&&(W=new se(W,Ae,null,a,ie),le.push({event:W,listeners:ke}))}}if((r&7)===0){e:{if(W=s==="mouseover"||s==="pointerover",se=s==="mouseout"||s==="pointerout",W&&a!==_l&&(Ae=a.relatedTarget||a.fromElement)&&(Ps(Ae)||Ae[Ds]))break e;if((se||W)&&(W=ie.window===ie?ie:(W=ie.ownerDocument)?W.defaultView||W.parentWindow:window,se?(Ae=a.relatedTarget||a.toElement,se=Q,Ae=Ae?Ps(Ae):null,Ae!==null&&(vt=l(Ae),ke=Ae.tag,Ae!==vt||ke!==5&&ke!==27&&ke!==6)&&(Ae=null)):(se=null,Ae=Q),se!==Ae)){if(ke=bl,ae="onMouseLeave",G="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(ke=li,ae="onPointerLeave",G="onPointerEnter",B="pointer"),vt=se==null?W:Ln(se),K=Ae==null?W:Ln(Ae),W=new ke(ae,B+"leave",se,a,ie),W.target=vt,W.relatedTarget=K,ae=null,Ps(ie)===Q&&(ke=new ke(G,B+"enter",Ae,a,ie),ke.target=K,ke.relatedTarget=vt,ae=ke),vt=ae,se&&Ae)t:{for(ke=dC,G=se,B=Ae,K=0,ae=G;ae;ae=ke(ae))K++;ae=0;for(var Re=B;Re;Re=ke(Re))ae++;for(;0<K-ae;)G=ke(G),K--;for(;0<ae-K;)B=ke(B),ae--;for(;K--;){if(G===B||B!==null&&G===B.alternate){ke=G;break t}G=ke(G),B=ke(B)}ke=null}else ke=null;se!==null&&lv(le,W,se,ke,!1),Ae!==null&&vt!==null&&lv(le,vt,Ae,ke,!0)}}e:{if(W=Q?Ln(Q):window,se=W.nodeName&&W.nodeName.toLowerCase(),se==="select"||se==="input"&&W.type==="file")var ot=Sg;else if(bg(W))if(Cg)ot=xS;else{ot=TS;var we=_S}else se=W.nodeName,!se||se.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?Q&&Bo(Q.elementType)&&(ot=Sg):ot=ES;if(ot&&(ot=ot(s,Q))){Ag(le,ot,a,ie);break e}we&&we(s,W,Q),s==="focusout"&&Q&&W.type==="number"&&Q.memoizedProps.value!=null&&gl(W,"number",W.value)}switch(we=Q?Ln(Q):window,s){case"focusin":(bg(we)||we.contentEditable==="true")&&(Qo=we,Pf=Q,Il=null);break;case"focusout":Il=Pf=Qo=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,kg(le,a,ie);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":kg(le,a,ie)}var $e;if(ut)e:{switch(s){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Ko?to(s,a)&&(Ze="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(Ze="onCompositionStart");Ze&&(zs&&a.locale!=="ko"&&(Ko||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Ko&&($e=El()):(qs=ie,Tl="value"in qs?qs.value:qs.textContent,Ko=!0)),we=Xc(Q,Ze),0<we.length&&(Ze=new Bs(Ze,s,null,a,ie),le.push({event:Ze,listeners:we}),$e?Ze.data=$e:($e=Jo(a),$e!==null&&(Ze.data=$e)))),($e=Wn?pS(s,a):gS(s,a))&&(Ze=Xc(Q,"onBeforeInput"),0<Ze.length&&(we=new Bs("onBeforeInput","beforeinput",null,a,ie),le.push({event:we,listeners:Ze}),we.data=$e)),aC(le,s,Q,a,ie)}ov(le,r)})}function Zl(s,r,a){return{instance:s,listener:r,currentTarget:a}}function Xc(s,r){for(var a=r+"Capture",c=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=ps(s,a),v!=null&&c.unshift(Zl(s,v,_)),v=ps(s,r),v!=null&&c.push(Zl(s,v,_))),s.tag===3)return c;s=s.return}return[]}function dC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function lv(s,r,a,c,v){for(var _=r._reactName,A=[];a!==null&&a!==c;){var N=a,O=N.alternate,Q=N.stateNode;if(N=N.tag,O!==null&&O===c)break;N!==5&&N!==26&&N!==27||Q===null||(O=Q,v?(Q=ps(a,_),Q!=null&&A.unshift(Zl(a,Q,O))):v||(Q=ps(a,_),Q!=null&&A.push(Zl(a,Q,O)))),a=a.return}A.length!==0&&s.push({event:r,listeners:A})}var fC=/\r\n?/g,hC=/\u0000|\uFFFD/g;function uv(s){return(typeof s=="string"?s:""+s).replace(fC,`
`).replace(hC,"")}function cv(s,r){return r=uv(r),uv(s)===r}function yt(s,r,a,c,v,_){switch(a){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||wn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&wn(s,""+c);break;case"className":Un(s,"class",c);break;case"tabIndex":Un(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Un(s,a,c);break;case"style":vl(s,c,_);break;case"data":if(r!=="object"){Un(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||a!=="href")){s.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=zo(""+c),s.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(a==="formAction"?(r!=="input"&&yt(s,r,"name",v.name,v,null),yt(s,r,"formEncType",v.formEncType,v,null),yt(s,r,"formMethod",v.formMethod,v,null),yt(s,r,"formTarget",v.formTarget,v,null)):(yt(s,r,"encType",v.encType,v,null),yt(s,r,"method",v.method,v,null),yt(s,r,"target",v.target,v,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=zo(""+c),s.setAttribute(a,c);break;case"onClick":c!=null&&(s.onclick=ms);break;case"onScroll":c!=null&&Xe("scroll",s);break;case"onScrollEnd":c!=null&&Xe("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}a=zo(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""+c):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":c===!0?s.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,c):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(a,c):s.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(a):s.setAttribute(a,c);break;case"popover":Xe("beforetoggle",s),Xe("toggle",s),jo(s,"popover",c);break;case"xlinkActuate":Ht(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ht(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ht(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ht(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ht(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ht(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ht(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":jo(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Xu.get(a)||a,jo(s,a,c))}}function rm(s,r,a,c,v,_){switch(a){case"style":vl(s,c,_);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"children":typeof c=="string"?wn(s,c):(typeof c=="number"||typeof c=="bigint")&&wn(s,""+c);break;case"onScroll":c!=null&&Xe("scroll",s);break;case"onScrollEnd":c!=null&&Xe("scrollend",s);break;case"onClick":c!=null&&(s.onclick=ms);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dl.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(v=a.endsWith("Capture"),r=a.slice(2,v?a.length-7:void 0),_=s[nn]||null,_=_!=null?_[a]:null,typeof _=="function"&&s.removeEventListener(r,_,v),typeof c=="function")){typeof _!="function"&&_!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(r,c,v);break e}a in s?s[a]=c:c===!0?s.setAttribute(a,""):jo(s,a,c)}}}function hn(s,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xe("error",s),Xe("load",s);var c=!1,v=!1,_;for(_ in a)if(a.hasOwnProperty(_)){var A=a[_];if(A!=null)switch(_){case"src":c=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,_,A,a,null)}}v&&yt(s,r,"srcSet",a.srcSet,a,null),c&&yt(s,r,"src",a.src,a,null);return;case"input":Xe("invalid",s);var N=_=A=v=null,O=null,Q=null;for(c in a)if(a.hasOwnProperty(c)){var ie=a[c];if(ie!=null)switch(c){case"name":v=ie;break;case"type":A=ie;break;case"checked":O=ie;break;case"defaultChecked":Q=ie;break;case"value":_=ie;break;case"defaultValue":N=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,r));break;default:yt(s,r,c,ie,a,null)}}Ju(s,_,N,O,Q,A,v,!1);return;case"select":Xe("invalid",s),c=A=_=null;for(v in a)if(a.hasOwnProperty(v)&&(N=a[v],N!=null))switch(v){case"value":_=N;break;case"defaultValue":A=N;break;case"multiple":c=N;default:yt(s,r,v,N,a,null)}r=_,a=A,s.multiple=!!c,r!=null?Ji(s,!!c,r,!1):a!=null&&Ji(s,!!c,a,!0);return;case"textarea":Xe("invalid",s),_=v=c=null;for(A in a)if(a.hasOwnProperty(A)&&(N=a[A],N!=null))switch(A){case"value":c=N;break;case"defaultValue":v=N;break;case"children":_=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:yt(s,r,A,N,a,null)}Ki(s,c,v,_);return;case"option":for(O in a)if(a.hasOwnProperty(O)&&(c=a[O],c!=null))switch(O){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:yt(s,r,O,c,a,null)}return;case"dialog":Xe("beforetoggle",s),Xe("toggle",s),Xe("cancel",s),Xe("close",s);break;case"iframe":case"object":Xe("load",s);break;case"video":case"audio":for(c=0;c<Wl.length;c++)Xe(Wl[c],s);break;case"image":Xe("error",s),Xe("load",s);break;case"details":Xe("toggle",s);break;case"embed":case"source":case"link":Xe("error",s),Xe("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in a)if(a.hasOwnProperty(Q)&&(c=a[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,Q,c,a,null)}return;default:if(Bo(r)){for(ie in a)a.hasOwnProperty(ie)&&(c=a[ie],c!==void 0&&rm(s,r,ie,c,a,void 0));return}}for(N in a)a.hasOwnProperty(N)&&(c=a[N],c!=null&&yt(s,r,N,c,a,null))}function mC(s,r,a,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,A=null,N=null,O=null,Q=null,ie=null;for(se in a){var le=a[se];if(a.hasOwnProperty(se)&&le!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":O=le;default:c.hasOwnProperty(se)||yt(s,r,se,null,c,le)}}for(var W in c){var se=c[W];if(le=a[W],c.hasOwnProperty(W)&&(se!=null||le!=null))switch(W){case"type":_=se;break;case"name":v=se;break;case"checked":Q=se;break;case"defaultChecked":ie=se;break;case"value":A=se;break;case"defaultValue":N=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:se!==le&&yt(s,r,W,se,c,le)}}Fo(s,A,N,O,Q,ie,_,v);return;case"select":se=A=N=W=null;for(_ in a)if(O=a[_],a.hasOwnProperty(_)&&O!=null)switch(_){case"value":break;case"multiple":se=O;default:c.hasOwnProperty(_)||yt(s,r,_,null,c,O)}for(v in c)if(_=c[v],O=a[v],c.hasOwnProperty(v)&&(_!=null||O!=null))switch(v){case"value":W=_;break;case"defaultValue":N=_;break;case"multiple":A=_;default:_!==O&&yt(s,r,v,_,c,O)}r=N,a=A,c=se,W!=null?Ji(s,!!a,W,!1):!!c!=!!a&&(r!=null?Ji(s,!!a,r,!0):Ji(s,!!a,a?[]:"",!1));return;case"textarea":se=W=null;for(N in a)if(v=a[N],a.hasOwnProperty(N)&&v!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:yt(s,r,N,null,c,v)}for(A in c)if(v=c[A],_=a[A],c.hasOwnProperty(A)&&(v!=null||_!=null))switch(A){case"value":W=v;break;case"defaultValue":se=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==_&&yt(s,r,A,v,c,_)}Ku(s,W,se);return;case"option":for(var Ae in a)if(W=a[Ae],a.hasOwnProperty(Ae)&&W!=null&&!c.hasOwnProperty(Ae))switch(Ae){case"selected":s.selected=!1;break;default:yt(s,r,Ae,null,c,W)}for(O in c)if(W=c[O],se=a[O],c.hasOwnProperty(O)&&W!==se&&(W!=null||se!=null))switch(O){case"selected":s.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:yt(s,r,O,W,c,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in a)W=a[ke],a.hasOwnProperty(ke)&&W!=null&&!c.hasOwnProperty(ke)&&yt(s,r,ke,null,c,W);for(Q in c)if(W=c[Q],se=a[Q],c.hasOwnProperty(Q)&&W!==se&&(W!=null||se!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,r));break;default:yt(s,r,Q,W,c,se)}return;default:if(Bo(r)){for(var vt in a)W=a[vt],a.hasOwnProperty(vt)&&W!==void 0&&!c.hasOwnProperty(vt)&&rm(s,r,vt,void 0,c,W);for(ie in c)W=c[ie],se=a[ie],!c.hasOwnProperty(ie)||W===se||W===void 0&&se===void 0||rm(s,r,ie,W,c,se);return}}for(var G in a)W=a[G],a.hasOwnProperty(G)&&W!=null&&!c.hasOwnProperty(G)&&yt(s,r,G,null,c,W);for(le in c)W=c[le],se=a[le],!c.hasOwnProperty(le)||W===se||W==null&&se==null||yt(s,r,le,W,c,se)}function dv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function pC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var v=a[c],_=v.transferSize,A=v.initiatorType,N=v.duration;if(_&&N&&dv(A)){for(A=0,N=v.responseEnd,c+=1;c<a.length;c++){var O=a[c],Q=O.startTime;if(Q>N)break;var ie=O.transferSize,le=O.initiatorType;ie&&dv(le)&&(O=O.responseEnd,A+=ie*(O<N?1:(N-Q)/(O-Q)))}if(--c,r+=8*(_+A)/(v.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var om=null,am=null;function Wc(s){return s.nodeType===9?s:s.ownerDocument}function fv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function lm(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var um=null;function gC(){var s=window.event;return s&&s.type==="popstate"?s===um?!1:(um=s,!0):(um=null,!1)}var mv=typeof setTimeout=="function"?setTimeout:void 0,yC=typeof clearTimeout=="function"?clearTimeout:void 0,pv=typeof Promise=="function"?Promise:void 0,vC=typeof queueMicrotask=="function"?queueMicrotask:typeof pv<"u"?function(s){return pv.resolve(null).then(s).catch(_C)}:mv;function _C(s){setTimeout(function(){throw s})}function vr(s){return s==="head"}function gv(s,r){var a=r,c=0;do{var v=a.nextSibling;if(s.removeChild(a),v&&v.nodeType===8)if(a=v.data,a==="/$"||a==="/&"){if(c===0){s.removeChild(v),ba(r);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")eu(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,eu(a);for(var _=a.firstChild;_;){var A=_.nextSibling,N=_.nodeName;_[Ms]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&_.rel.toLowerCase()==="stylesheet"||a.removeChild(_),_=A}}else a==="body"&&eu(s.ownerDocument.body);a=v}while(a);ba(r)}function yv(s,r){var a=s;s=0;do{var c=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=c}while(a)}function cm(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":cm(a),qo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function TC(s,r,a,c){for(;s.nodeType===1;){var v=a;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[Ms])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=rs(s.nextSibling),s===null)break}return null}function EC(s,r,a){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=rs(s.nextSibling),s===null))return null;return s}function vv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=rs(s.nextSibling),s===null))return null;return s}function dm(s){return s.data==="$?"||s.data==="$~"}function fm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function xC(s,r){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||a.readyState!=="loading")r();else{var c=function(){r(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function rs(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var hm=null;function _v(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(r===0)return rs(s.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}s=s.nextSibling}return null}function Tv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return s;r--}else a!=="/$"&&a!=="/&"||r++}s=s.previousSibling}return null}function Ev(s,r,a){switch(r=Wc(a),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function eu(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);qo(s)}var os=new Map,xv=new Set;function Zc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var bi=Z.d;Z.d={f:bC,r:AC,D:SC,C:CC,L:wC,m:IC,X:RC,S:NC,M:DC};function bC(){var s=bi.f(),r=Hc();return s||r}function AC(s){var r=Kn(s);r!==null&&r.tag===5&&r.type==="form"?qy(r):bi.r(s)}var Ta=typeof document>"u"?null:document;function bv(s,r,a){var c=Ta;if(c&&typeof r=="string"&&r){var v=Cn(r);v='link[rel="'+s+'"][href="'+v+'"]',typeof a=="string"&&(v+='[crossorigin="'+a+'"]'),xv.has(v)||(xv.add(v),s={rel:s,crossOrigin:a,href:r},c.querySelector(v)===null&&(r=c.createElement("link"),hn(r,"link",s),zt(r),c.head.appendChild(r)))}}function SC(s){bi.D(s),bv("dns-prefetch",s,null)}function CC(s,r){bi.C(s,r),bv("preconnect",s,r)}function wC(s,r,a){bi.L(s,r,a);var c=Ta;if(c&&s&&r){var v='link[rel="preload"][as="'+Cn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(v+='[imagesrcset="'+Cn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(v+='[imagesizes="'+Cn(a.imageSizes)+'"]')):v+='[href="'+Cn(s)+'"]';var _=v;switch(r){case"style":_=Ea(s);break;case"script":_=xa(s)}os.has(_)||(s=E({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:s,as:r},a),os.set(_,s),c.querySelector(v)!==null||r==="style"&&c.querySelector(tu(_))||r==="script"&&c.querySelector(nu(_))||(r=c.createElement("link"),hn(r,"link",s),zt(r),c.head.appendChild(r)))}}function IC(s,r){bi.m(s,r);var a=Ta;if(a&&s){var c=r&&typeof r.as=="string"?r.as:"script",v='link[rel="modulepreload"][as="'+Cn(c)+'"][href="'+Cn(s)+'"]',_=v;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=xa(s)}if(!os.has(_)&&(s=E({rel:"modulepreload",href:s},r),os.set(_,s),a.querySelector(v)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(nu(_)))return}c=a.createElement("link"),hn(c,"link",s),zt(c),a.head.appendChild(c)}}}function NC(s,r,a){bi.S(s,r,a);var c=Ta;if(c&&s){var v=ks(c).hoistableStyles,_=Ea(s);r=r||"default";var A=v.get(_);if(!A){var N={loading:0,preload:null};if(A=c.querySelector(tu(_)))N.loading=5;else{s=E({rel:"stylesheet",href:s,"data-precedence":r},a),(a=os.get(_))&&mm(s,a);var O=A=c.createElement("link");zt(O),hn(O,"link",s),O._p=new Promise(function(Q,ie){O.onload=Q,O.onerror=ie}),O.addEventListener("load",function(){N.loading|=1}),O.addEventListener("error",function(){N.loading|=2}),N.loading|=4,ed(A,r,c)}A={type:"stylesheet",instance:A,count:1,state:N},v.set(_,A)}}}function RC(s,r){bi.X(s,r);var a=Ta;if(a&&s){var c=ks(a).hoistableScripts,v=xa(s),_=c.get(v);_||(_=a.querySelector(nu(v)),_||(s=E({src:s,async:!0},r),(r=os.get(v))&&pm(s,r),_=a.createElement("script"),zt(_),hn(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function DC(s,r){bi.M(s,r);var a=Ta;if(a&&s){var c=ks(a).hoistableScripts,v=xa(s),_=c.get(v);_||(_=a.querySelector(nu(v)),_||(s=E({src:s,async:!0,type:"module"},r),(r=os.get(v))&&pm(s,r),_=a.createElement("script"),zt(_),hn(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function Av(s,r,a,c){var v=(v=Ve.current)?Zc(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=Ea(a.href),a=ks(v).hoistableStyles,c=a.get(r),c||(c={type:"style",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=Ea(a.href);var _=ks(v).hoistableStyles,A=_.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,A),(_=v.querySelector(tu(s)))&&!_._p&&(A.instance=_,A.state.loading=5),os.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},os.set(s,a),_||MC(v,s,a,A.state))),r&&c===null)throw Error(i(528,""));return A}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=xa(a),a=ks(v).hoistableScripts,c=a.get(r),c||(c={type:"script",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ea(s){return'href="'+Cn(s)+'"'}function tu(s){return'link[rel="stylesheet"]['+s+"]"}function Sv(s){return E({},s,{"data-precedence":s.precedence,precedence:null})}function MC(s,r,a,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),hn(r,"link",a),zt(r),s.head.appendChild(r))}function xa(s){return'[src="'+Cn(s)+'"]'}function nu(s){return"script[async]"+s}function Cv(s,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+Cn(a.href)+'"]');if(c)return r.instance=c,zt(c),c;var v=E({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),zt(c),hn(c,"style",v),ed(c,a.precedence,s),r.instance=c;case"stylesheet":v=Ea(a.href);var _=s.querySelector(tu(v));if(_)return r.state.loading|=4,r.instance=_,zt(_),_;c=Sv(a),(v=os.get(v))&&mm(c,v),_=(s.ownerDocument||s).createElement("link"),zt(_);var A=_;return A._p=new Promise(function(N,O){A.onload=N,A.onerror=O}),hn(_,"link",c),r.state.loading|=4,ed(_,a.precedence,s),r.instance=_;case"script":return _=xa(a.src),(v=s.querySelector(nu(_)))?(r.instance=v,zt(v),v):(c=a,(v=os.get(_))&&(c=E({},a),pm(c,v)),s=s.ownerDocument||s,v=s.createElement("script"),zt(v),hn(v,"link",c),s.head.appendChild(v),r.instance=v);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,ed(c,a.precedence,s));return r.instance}function ed(s,r,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=c.length?c[c.length-1]:null,_=v,A=0;A<c.length;A++){var N=c[A];if(N.dataset.precedence===r)_=N;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(s,r.firstChild))}function mm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function pm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var td=null;function wv(s,r,a){if(td===null){var c=new Map,v=td=new Map;v.set(a,c)}else v=td,c=v.get(a),c||(c=new Map,v.set(a,c));if(c.has(s))return c;for(c.set(s,null),a=a.getElementsByTagName(s),v=0;v<a.length;v++){var _=a[v];if(!(_[Ms]||_[Bt]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(r)||"";A=s+A;var N=c.get(A);N?N.push(_):c.set(A,[_])}}return c}function Iv(s,r,a){s=s.ownerDocument||s,s.head.insertBefore(a,r==="title"?s.querySelector("head > title"):null)}function PC(s,r,a){if(a===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Nv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function kC(s,r,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var v=Ea(c.href),_=r.querySelector(tu(v));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=nd.bind(s),r.then(s,s)),a.state.loading|=4,a.instance=_,zt(_);return}_=r.ownerDocument||r,c=Sv(c),(v=os.get(v))&&mm(c,v),_=_.createElement("link"),zt(_);var A=_;A._p=new Promise(function(N,O){A.onload=N,A.onerror=O}),hn(_,"link",c),a.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=nd.bind(s),r.addEventListener("load",a),r.addEventListener("error",a))}}var gm=0;function VC(s,r){return s.stylesheets&&s.count===0&&id(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var c=setTimeout(function(){if(s.stylesheets&&id(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+r);0<s.imgBytes&&gm===0&&(gm=62500*pC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&id(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>gm?50:800)+r);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(v)}}:null}function nd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)id(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var sd=null;function id(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,sd=new Map,r.forEach(LC,s),sd=null,nd.call(s))}function LC(s,r){if(!(r.state.loading&4)){var a=sd.get(s);if(a)var c=a.get(null);else{a=new Map,sd.set(s,a);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var A=v[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(a.set(A.dataset.precedence,A),c=A)}c&&a.set(null,c)}v=r.instance,A=v.getAttribute("data-precedence"),_=a.get(A)||c,_===c&&a.set(null,v),a.set(A,v),this.count++,c=nd.bind(this),v.addEventListener("load",c),v.addEventListener("error",c),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),r.state.loading|=4}}var su={$$typeof:ee,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function UC(s,r,a,c,v,_,A,N,O){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ye(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ye(0),this.hiddenUpdates=Ye(null),this.identifierPrefix=c,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Rv(s,r,a,c,v,_,A,N,O,Q,ie,le){return s=new UC(s,r,a,A,O,Q,ie,le,N),r=1,_===!0&&(r|=24),_=qn(3,null,null,r),s.current=_,_.stateNode=s,r=Kf(),r.refCount++,s.pooledCache=r,r.refCount++,_.memoizedState={element:c,isDehydrated:a,cache:r},Zf(_),s}function Dv(s){return s?(s=Zo,s):Zo}function Mv(s,r,a,c,v,_){v=Dv(v),c.context===null?c.context=v:c.pendingContext=v,c=ar(r),c.payload={element:a},_=_===void 0?null:_,_!==null&&(c.callback=_),a=lr(s,c,r),a!==null&&(Mn(a,s,r),Vl(a,s,r))}function Pv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<r?a:r}}function ym(s,r){Pv(s,r),(s=s.alternate)&&Pv(s,r)}function kv(s){if(s.tag===13||s.tag===31){var r=io(s,67108864);r!==null&&Mn(r,s,67108864),ym(s,67108864)}}function Vv(s){if(s.tag===13||s.tag===31){var r=Hn();r=$r(r);var a=io(s,r);a!==null&&Mn(a,s,r),ym(s,r)}}var rd=!0;function OC(s,r,a,c){var v=te.T;te.T=null;var _=Z.p;try{Z.p=2,vm(s,r,a,c)}finally{Z.p=_,te.T=v}}function qC(s,r,a,c){var v=te.T;te.T=null;var _=Z.p;try{Z.p=8,vm(s,r,a,c)}finally{Z.p=_,te.T=v}}function vm(s,r,a,c){if(rd){var v=_m(c);if(v===null)im(s,r,c,od,a),Uv(s,c);else if(FC(v,s,r,a,c))c.stopPropagation();else if(Uv(s,c),r&4&&-1<jC.indexOf(s)){for(;v!==null;){var _=Kn(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=Te(_.pendingLanes);if(A!==0){var N=_;for(N.pendingLanes|=2,N.entangledLanes|=2;A;){var O=1<<31-Ne(A);N.entanglements[1]|=O,A&=~O}Ys(_),(ct&6)===0&&(Bc=tn()+500,Xl(0))}}break;case 31:case 13:N=io(_,2),N!==null&&Mn(N,_,2),Hc(),ym(_,2)}if(_=_m(c),_===null&&im(s,r,c,od,a),_===v)break;v=_}v!==null&&c.stopPropagation()}else im(s,r,c,null,a)}}function _m(s){return s=Qn(s),Tm(s)}var od=null;function Tm(s){if(od=null,s=Ps(s),s!==null){var r=l(s);if(r===null)s=null;else{var a=r.tag;if(a===13){if(s=u(r),s!==null)return s;s=null}else if(a===31){if(s=d(r),s!==null)return s;s=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return od=s,null}function Lv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ii()){case Hi:return 2;case Gi:return 8;case cs:case Lo:return 32;case Gr:return 268435456;default:return 32}default:return 32}}var Em=!1,_r=null,Tr=null,Er=null,iu=new Map,ru=new Map,xr=[],jC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Uv(s,r){switch(s){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Er=null;break;case"pointerover":case"pointerout":iu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ru.delete(r.pointerId)}}function ou(s,r,a,c,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:_,targetContainers:[v]},r!==null&&(r=Kn(r),r!==null&&kv(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,v!==null&&r.indexOf(v)===-1&&r.push(v),s)}function FC(s,r,a,c,v){switch(r){case"focusin":return _r=ou(_r,s,r,a,c,v),!0;case"dragenter":return Tr=ou(Tr,s,r,a,c,v),!0;case"mouseover":return Er=ou(Er,s,r,a,c,v),!0;case"pointerover":var _=v.pointerId;return iu.set(_,ou(iu.get(_)||null,s,r,a,c,v)),!0;case"gotpointercapture":return _=v.pointerId,ru.set(_,ou(ru.get(_)||null,s,r,a,c,v)),!0}return!1}function Ov(s){var r=Ps(s.target);if(r!==null){var a=l(r);if(a!==null){if(r=a.tag,r===13){if(r=u(a),r!==null){s.blockedOn=r,fs(s.priority,function(){Vv(a)});return}}else if(r===31){if(r=d(a),r!==null){s.blockedOn=r,fs(s.priority,function(){Vv(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ad(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var a=_m(s.nativeEvent);if(a===null){a=s.nativeEvent;var c=new a.constructor(a.type,a);_l=c,a.target.dispatchEvent(c),_l=null}else return r=Kn(a),r!==null&&kv(r),s.blockedOn=a,!1;r.shift()}return!0}function qv(s,r,a){ad(s)&&a.delete(r)}function BC(){Em=!1,_r!==null&&ad(_r)&&(_r=null),Tr!==null&&ad(Tr)&&(Tr=null),Er!==null&&ad(Er)&&(Er=null),iu.forEach(qv),ru.forEach(qv)}function ld(s,r){s.blockedOn===r&&(s.blockedOn=null,Em||(Em=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,BC)))}var ud=null;function jv(s){ud!==s&&(ud=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ud===s&&(ud=null);for(var r=0;r<s.length;r+=3){var a=s[r],c=s[r+1],v=s[r+2];if(typeof c!="function"){if(Tm(c||a)===null)continue;break}var _=Kn(a);_!==null&&(s.splice(r,3),r-=3,_h(_,{pending:!0,data:v,method:a.method,action:c},c,v))}}))}function ba(s){function r(O){return ld(O,s)}_r!==null&&ld(_r,s),Tr!==null&&ld(Tr,s),Er!==null&&ld(Er,s),iu.forEach(r),ru.forEach(r);for(var a=0;a<xr.length;a++){var c=xr[a];c.blockedOn===s&&(c.blockedOn=null)}for(;0<xr.length&&(a=xr[0],a.blockedOn===null);)Ov(a),a.blockedOn===null&&xr.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var v=a[c],_=a[c+1],A=v[nn]||null;if(typeof _=="function")A||jv(a);else if(A){var N=null;if(_&&_.hasAttribute("formAction")){if(v=_,A=_[nn]||null)N=A.formAction;else if(Tm(v)!==null)continue}else N=A.action;typeof N=="function"?a[c+1]=N:(a.splice(c,3),c-=3),jv(a)}}}function Fv(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function r(){v!==null&&(v(),v=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),v!==null&&(v(),v=null)}}}function xm(s){this._internalRoot=s}cd.prototype.render=xm.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var a=r.current,c=Hn();Mv(a,c,s,r,null,null)},cd.prototype.unmount=xm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Mv(s.current,2,null,s,null,null),Hc(),r[Ds]=null}};function cd(s){this._internalRoot=s}cd.prototype.unstable_scheduleHydration=function(s){if(s){var r=Hu();s={blockedOn:null,target:s,priority:r};for(var a=0;a<xr.length&&r!==0&&r<xr[a].priority;a++);xr.splice(a,0,s),a===0&&Ov(s)}};var Bv=e.version;if(Bv!=="19.2.0")throw Error(i(527,Bv,"19.2.0"));Z.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?T(s):null,s=s===null?null:s.stateNode,s};var zC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{me=dd.inject(zC),pe=dd}catch{}}return lu.createRoot=function(s,r){if(!o(s))throw Error(i(299));var a=!1,c="",v=Ky,_=Qy,A=Xy;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(v=r.onUncaughtError),r.onCaughtError!==void 0&&(_=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=Rv(s,1,!1,null,null,a,c,null,v,_,A,Fv),s[Ds]=r.current,sm(s),new xm(r)},lu.hydrateRoot=function(s,r,a){if(!o(s))throw Error(i(299));var c=!1,v="",_=Ky,A=Qy,N=Xy,O=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(A=a.onCaughtError),a.onRecoverableError!==void 0&&(N=a.onRecoverableError),a.formState!==void 0&&(O=a.formState)),r=Rv(s,1,!0,r,a??null,c,v,O,_,A,N,Fv),r.context=Dv(null),a=r.current,c=Hn(),c=$r(c),v=ar(c),v.callback=null,lr(a,v,c),a=c,r.current.lanes=a,Ns(r,a),Ys(r),s[Ds]=r.current,sm(s),new cd(r)},lu.version="19.2.0",lu}var Wv;function ZC(){if(Wv)return Sm.exports;Wv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sm.exports=WC(),Sm.exports}var ew=ZC();const tw=GE(ew),fd=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let nw,sw;function iw(){return{geminiUrl:nw,vertexUrl:sw}}function rw(n,e,t,i){var o,l;if(!(n!=null&&n.baseUrl)){const u=iw();return e?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(l=u.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Io{}function Se(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const l=e[o];return l!=null?String(l):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function y(n,e,t){for(let l=0;l<e.length-1;l++){const u=e[l];if(u.endsWith("[]")){const d=u.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[d])){const g=n[d];if(Array.isArray(t))for(let m=0;m<g.length;m++){const T=g[m];y(T,e.slice(l+1),t[m])}else for(const m of g)y(m,e.slice(l+1),t)}return}else if(u.endsWith("[0]")){const d=u.slice(0,-3);d in n||(n[d]=[{}]);const g=n[d];y(g[0],e.slice(l+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(l in n){const u=n[l];return Array.isArray(u)?u.map(d=>h(d,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mp(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ow(n){const e={},t=h(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function aw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],uw(u)),e}function lw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],cw(u)),e}function uw(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>dw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function cw(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>fw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function dw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],pw(t)),e}function fw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],gw(t)),e}function hw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function mw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function pw(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Mp(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function gw(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Mp(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Zv||(Zv={}));var e_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(e_||(e_={}));var Sr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Sr||(Sr={}));var t_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(t_||(t_={}));var n_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(n_||(n_={}));var s_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(s_||(s_={}));var i_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(i_||(i_={}));var r_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(r_||(r_={}));var o_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(o_||(o_={}));var a_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(a_||(a_={}));var l_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(l_||(l_={}));var u_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(u_||(u_={}));var c_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(c_||(c_={}));var d_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(d_||(d_={}));var f_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(f_||(f_={}));var Md;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Md||(Md={}));var h_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(h_||(h_={}));var Km;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Km||(Km={}));var m_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(m_||(m_={}));var p_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(p_||(p_={}));var g_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(g_||(g_={}));var y_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(y_||(y_={}));var v_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(v_||(v_={}));var __;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(__||(__={}));var T_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(T_||(T_={}));var E_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(E_||(E_={}));var x_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(x_||(x_={}));var b_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(b_||(b_={}));var A_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(A_||(A_={}));var S_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(S_||(S_={}));var C_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(C_||(C_={}));var w_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(w_||(w_={}));var I_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(I_||(I_={}));var N_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(N_||(N_={}));var R_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(R_||(R_={}));var D_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(D_||(D_={}));var M_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(M_||(M_={}));var P_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(P_||(P_={}));var k_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(k_||(k_={}));var V_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(V_||(V_={}));var L_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(L_||(L_={}));var U_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(U_||(U_={}));var O_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(O_||(O_={}));var q_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(q_||(q_={}));var j_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(j_||(j_={}));var F_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(F_||(F_={}));var B_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(B_||(B_={}));var z_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(z_||(z_={}));var Ia;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Ia||(Ia={}));class Qm{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class uu{get text(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",T=!1;const E=[];for(const b of(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&g!==void 0?g:[]){for(const[I,V]of Object.entries(b))I!=="text"&&I!=="thought"&&(V!==null||V!==void 0)&&E.push(I);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;T=!0,m+=b.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?m:void 0}get data(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const T=[];for(const E of(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&g!==void 0?g:[]){for(const[b,I]of Object.entries(E))b!=="inlineData"&&(I!==null||I!==void 0)&&T.push(b);E.inlineData&&typeof E.inlineData.data=="string"&&(m+=atob(E.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,o,l,u,d,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,i,o,l,u,d,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,o,l,u,d,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(g=(d=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||g===void 0?void 0:g.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.output}}class H_{}class G_{}class yw{}class vw{}class _w{}class Tw{}class $_{}class Y_{}class J_{}class Ew{}class Pd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Pd;let o;const l=e;return t?o=lw(l):o=aw(l),Object.assign(i,o),i}}class K_{}class Q_{}class X_{}class xw{}class bw{}class Aw{}class W_{}class Sw{get text(){var e,t,i;let o="",l=!1;const u=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,m]of Object.entries(d))g!=="text"&&g!=="thought"&&m!==null&&u.push(g);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;l=!0,o+=d.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var e,t,i;let o="";const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,g]of Object.entries(u))d!=="inlineData"&&g!==null&&l.push(d);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class Cw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function $E(n,e){const t=lt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function YE(n){return Array.isArray(n)?n.map(e=>kd(e)):[kd(n)]}function kd(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function JE(n){const e=kd(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function KE(n){const e=kd(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Z_(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function QE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>Z_(e)):[Z_(n)]}function Xm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function eT(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function tT(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function _n(n){if(n==null)throw new Error("ContentUnion is required");return Xm(n)?n:{role:"user",parts:QE(n)}}function Pp(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=_n(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=_n(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>_n(t)):[_n(e)]}function us(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(eT(n)||tT(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[_n(n)]}const e=[],t=[],i=Xm(n[0]);for(const o of n){const l=Xm(o);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(o);else{if(eT(o)||tT(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:QE(t)}),e}function ww(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Sr).includes(t[0].toUpperCase())?t[0].toUpperCase():Sr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Sr).includes(i.toUpperCase())?i.toUpperCase():Sr.TYPE_UNSPECIFIED})}}function Pa(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&ww(n.type,e);for(const[u,d]of Object.entries(n))if(d!=null)if(u=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(Sr).includes(d.toUpperCase())?d.toUpperCase():Sr.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Pa(d);else if(i.includes(u)){const g=[];for(const m of d){if(m.type=="null"){e.nullable=!0;continue}g.push(Pa(m))}e[u]=g}else if(o.includes(u)){const g={};for(const[m,T]of Object.entries(d))g[m]=Pa(T);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=d}return e}function kp(n){return Pa(n)}function Vp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Lp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Xa(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Pa(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Pa(e.response));return n}function Wa(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Iw(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Fi(n,e){if(typeof e!="string")throw new Error("name must be a string");return Iw(n,e,"cachedContents")}function XE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function qr(n){return Mp(n)}function Nw(n){return n!=null&&typeof n=="object"&&"name"in n}function Rw(n){return n!=null&&typeof n=="object"&&"video"in n}function Dw(n){return n!=null&&typeof n=="object"&&"uri"in n}function WE(n){var e;let t;if(Nw(n)&&(t=n.name),!(Dw(n)&&(t=n.uri,t===void 0))&&!(Rw(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ZE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function ex(n){for(const e of["models","tunedModels","publisherModels"])if(Mw(n,e))return n[e];return[]}function Mw(n,e){return n!==null&&typeof n=="object"&&e in n}function Pw(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function kw(n,e={}){const t=[],i=new Set;for(const o of n){const l=o.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const u=Pw(o,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function tx(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Vw(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function nx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let l=!1;for(const u of o){if(typeof u!="object"||u===null)continue;const g=u.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Za(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function sx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lw(n){const e={},t=h(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>fI(u))),y(e,["inlinedResponses"],l)}const o=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["inlinedEmbedContentResponses"],l)}return e}function Uw(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigqueryDestination","outputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Ow(n){const e={},t=h(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigqueryDestination","outputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function cu(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["metadata","state"]);o!=null&&y(e,["state"],sx(o));const l=h(n,["metadata","createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const d=h(n,["metadata","updateTime"]);d!=null&&y(e,["updateTime"],d);const g=h(n,["metadata","model"]);g!=null&&y(e,["model"],g);const m=h(n,["metadata","output"]);return m!=null&&y(e,["dest"],Lw(nx(m))),e}function Wm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],sx(o));const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["createTime"]);u!=null&&y(e,["createTime"],u);const d=h(n,["startTime"]);d!=null&&y(e,["startTime"],d);const g=h(n,["endTime"]);g!=null&&y(e,["endTime"],g);const m=h(n,["updateTime"]);m!=null&&y(e,["updateTime"],m);const T=h(n,["model"]);T!=null&&y(e,["model"],T);const E=h(n,["inputConfig"]);E!=null&&y(e,["src"],qw(E));const b=h(n,["outputConfig"]);return b!=null&&y(e,["dest"],Uw(nx(b))),e}function qw(n){const e={},t=h(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigquerySource","inputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function jw(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&y(t,["fileName"],i);const o=h(e,["inlinedRequests"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>dI(n,u))),y(t,["requests","requests"],l)}return t}function Fw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigquerySource","inputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Bw(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function zw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function Hw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function Gw(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],$w(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=h(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=h(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(I=>I)),y(e,["safetyRatings"],b)}return e}function $w(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function ix(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>_I(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function Yw(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Jw(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["dest"]);return e!==void 0&&o!=null&&y(e,["outputConfig"],Ow(Vw(o))),t}function nT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],jw(n,tx(n,o)));const l=h(e,["config"]);return l!=null&&Yw(l,t),t}function Kw(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],lt(n,i));const o=h(e,["src"]);o!=null&&y(t,["inputConfig"],Fw(tx(n,o)));const l=h(e,["config"]);return l!=null&&Jw(l,t),t}function Qw(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function Nm(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],sI(n,o));const l=h(e,["config"]);return l!=null&&Qw(l,t),t}function Xw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function Ww(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function Zw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function eI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function tI(n,e){const t={},i=h(e,["contents"]);if(i!=null){let l=Pp(n,i);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["requests[]","request","content"],l)}const o=h(e,["config"]);return o!=null&&y(t,["_self"],nI(o,t)),t}function nI(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function sI(n,e){const t={},i=h(e,["fileName"]);i!=null&&y(t,["file_name"],i);const o=h(e,["inlinedRequests"]);return o!=null&&y(t,["requests"],tI(n,o)),t}function iI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function rI(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],ix(_n(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const I=h(e,["presencePenalty"]);I!=null&&y(i,["presencePenalty"],I);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const L=h(e,["seed"]);L!=null&&y(i,["seed"],L);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const $=h(e,["responseSchema"]);$!=null&&y(i,["responseSchema"],kp($));const J=h(e,["responseJsonSchema"]);if(J!=null&&y(i,["responseJsonSchema"],J),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=h(e,["safetySettings"]);if(t!==void 0&&ee!=null){let U=ee;Array.isArray(U)&&(U=U.map(k=>TI(k))),y(t,["safetySettings"],U)}const q=h(e,["tools"]);if(t!==void 0&&q!=null){let U=Wa(q);Array.isArray(U)&&(U=U.map(k=>EI(Xa(k)))),y(t,["tools"],U)}const X=h(e,["toolConfig"]);if(t!==void 0&&X!=null&&y(t,["toolConfig"],X),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=h(e,["cachedContent"]);t!==void 0&&z!=null&&y(t,["cachedContent"],Fi(n,z));const R=h(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const D=h(e,["speechConfig"]);if(D!=null&&y(i,["speechConfig"],Vp(D)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=h(e,["thinkingConfig"]);w!=null&&y(i,["thinkingConfig"],w);const P=h(e,["imageConfig"]);return P!=null&&y(i,["imageConfig"],P),i}function oI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>Gw(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function aI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function lI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Za(n,i)),t}function uI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function cI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function dI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["request","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let d=us(o);Array.isArray(d)&&(d=d.map(g=>ix(g))),y(t,["request","contents"],d)}const l=h(e,["metadata"]);l!=null&&y(t,["metadata"],l);const u=h(e,["config"]);return u!=null&&y(t,["request","generationConfig"],rI(n,u,h(t,["request"],{}))),t}function fI(n){const e={},t=h(n,["response"]);t!=null&&y(e,["response"],oI(t));const i=h(n,["error"]);return i!=null&&y(e,["error"],i),e}function hI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);if(e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function mI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function pI(n){const e={},t=h(n,["config"]);return t!=null&&hI(t,e),e}function gI(n){const e={},t=h(n,["config"]);return t!=null&&mI(t,e),e}function yI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["operations"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>cu(u))),y(e,["batchJobs"],l)}return e}function vI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["batchPredictionJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Wm(u))),y(e,["batchJobs"],l)}return e}function _I(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],Bw(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],iI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function TI(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function EI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],cI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],uI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Eo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Eo||(Eo={}));class Ru{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xI extends Io{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var i,o;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const d=this.createInlinedEmbedContentRequest(t),g=d.path,m=d.body,T=Nm(this.apiClient,t)._query||{};return this.apiClient.request({path:g,queryParams:T,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(b=>b.json()).then(b=>cu(b))},this.list=async(t={})=>new Ru(Eo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=nT(this.apiClient,e),i=t._url,o=Se("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,g=d.requests,m=[];for(const T of g){const E=Object.assign({},T);if(E.systemInstruction){const b=E.systemInstruction;delete E.systemInstruction;const I=E.request;I.systemInstruction=b,E.request=I}m.push(E)}return d.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}createInlinedEmbedContentRequest(e){const t=Nm(this.apiClient,e),i=t._url,o=Se("{model}:asyncBatchEmbedContent",i),d=t.batch.inputConfig.requests,g=d.requests,m=[];delete d.config;for(const T of g){const E=Object.assign({},T),b=E.request;for(const I in E)I!=="request"&&(b[I]=E[I],delete E[I]);m.push(E)}return d.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const l=this.getGcsUri(e),u=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${o}`;else if(u)i.dest=`${u}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=Kw(this.apiClient,e);return d=Se("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Wm(T))}else{const m=nT(this.apiClient,e);return d=Se("{model}:batchGenerateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>cu(T))}}async createEmbeddingsInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Nm(this.apiClient,e);return l=Se("{model}:asyncBatchEmbedContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>cu(g))}}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=lI(this.apiClient,e);return d=Se("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Wm(T))}else{const m=aI(this.apiClient,e);return d=Se("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>cu(T))}}async cancel(e){var t,i,o,l;let u="",d={};if(this.apiClient.isVertexAI()){const g=Hw(this.apiClient,e);u=Se("batchPredictionJobs/{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=zw(this.apiClient,e);u=Se("batches/{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=gI(e);return d=Se("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=vI(T),b=new W_;return Object.assign(b,E),b})}else{const m=pI(e);return d=Se("batches",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=yI(T),b=new W_;return Object.assign(b,E),b})}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=Ww(this.apiClient,e);return d=Se("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>eI(T))}else{const m=Xw(this.apiClient,e);return d=Se("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Zw(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function sT(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>HI(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function AI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let T=us(u);Array.isArray(T)&&(T=T.map(E=>sT(E))),y(e,["contents"],T)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],sT(_n(d)));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>GI(E))),y(e,["tools"],T)}const m=h(n,["toolConfig"]);if(e!==void 0&&m!=null&&y(e,["toolConfig"],m),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function SI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let E=us(u);Array.isArray(E)&&(E=E.map(b=>b)),y(e,["contents"],E)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],_n(d));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let E=g;Array.isArray(E)&&(E=E.map(b=>$I(b))),y(e,["tools"],E)}const m=h(n,["toolConfig"]);e!==void 0&&m!=null&&y(e,["toolConfig"],m);const T=h(n,["kmsKeyName"]);return e!==void 0&&T!=null&&y(e,["encryption_spec","kmsKeyName"],T),t}function CI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],$E(n,i));const o=h(e,["config"]);return o!=null&&AI(o,t),t}function wI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],$E(n,i));const o=h(e,["config"]);return o!=null&&SI(o,t),t}function II(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Fi(n,i)),t}function NI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Fi(n,i)),t}function RI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function DI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function MI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function PI(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function kI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Fi(n,i)),t}function VI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Fi(n,i)),t}function LI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function UI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function OI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function qI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function jI(n){const e={},t=h(n,["config"]);return t!=null&&OI(t,e),e}function FI(n){const e={},t=h(n,["config"]);return t!=null&&qI(t,e),e}function BI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function zI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function HI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],bI(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],MI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function GI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],UI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],LI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function $I(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>PI(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function YI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function JI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function KI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],Fi(n,i));const o=h(e,["config"]);return o!=null&&YI(o,t),t}function QI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],Fi(n,i));const o=h(e,["config"]);return o!=null&&JI(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XI extends Io{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ru(Eo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=wI(this.apiClient,e);return d=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=CI(this.apiClient,e);return d=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=VI(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=kI(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=NI(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=DI(T),b=new Q_;return Object.assign(b,E),b})}else{const m=II(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=RI(T),b=new Q_;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=QI(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=KI(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=FI(e);return d=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=zI(T),b=new X_;return Object.assign(b,E),b})}else{const m=jI(e);return d=Se("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=BI(T),b=new X_;return Object.assign(b,E),b})}}}function iT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ct(n){return this instanceof Ct?(this.v=n,this):new Ct(n)}function ka(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(I){return function(V){return Promise.resolve(V).then(I,E)}}function d(I,V){i[I]&&(o[I]=function(L){return new Promise(function(j,$){l.push([I,L,j,$])>1||g(I,L)})},V&&(o[I]=V(o[I])))}function g(I,V){try{m(i[I](V))}catch(L){b(l[0][3],L)}}function m(I){I.value instanceof Ct?Promise.resolve(I.value.v).then(T,E):b(l[0][2],I)}function T(I){g("next",I)}function E(I){g("throw",I)}function b(I,V){I(V),l.shift(),l.length&&g(l[0][0],l[0][1])}}function gu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof iT=="function"?iT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(u){return new Promise(function(d,g){u=n[l](u),o(d,g,u.done,u.value)})}}function o(l,u,d,g){Promise.resolve(g).then(function(m){l({value:m,done:d})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WI(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:rx(t)}function rx(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function ZI(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let l=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),l&&!rx(n[i])&&(l=!1),i++;l?e.push(...o):e.pop()}return e}class eN{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new tN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class tN{constructor(e,t,i,o={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=l,this.sendPromise=Promise.resolve(),ZI(l)}async sendMessage(e){var t;await this.sendPromise;const i=_n(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,u,d;const g=await o,m=(u=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,T=g.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let b=[];T!=null&&(b=(d=T.slice(E))!==null&&d!==void 0?d:[]);const I=m?[m]:[];this.recordHistory(i,I,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=_n(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const l=await o;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?rT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,o;return ka(this,arguments,function*(){var u,d,g,m;const T=[];try{for(var E=!0,b=gu(e),I;I=yield Ct(b.next()),u=I.done,!u;E=!0){m=I.value,E=!1;const V=m;if(WI(V)){const L=(o=(i=V.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;L!==void 0&&T.push(L)}yield yield Ct(V)}}catch(V){d={error:V}}finally{try{!E&&!u&&(g=b.return)&&(yield Ct(g.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,T)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(l=>l.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...rT(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nN(n){const e={},t=h(n,["file"]);return t!=null&&y(e,["file"],t),e}function sN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function iN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],WE(t)),e}function rN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function oN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],WE(t)),e}function aN(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function lN(n){const e={},t=h(n,["config"]);return t!=null&&aN(t,e),e}function uN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["files"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cN extends Io{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Ru(Eo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=lN(e);return l=Se("files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=uN(g),T=new xw;return Object.assign(T,m),T})}}async createInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=nN(e);return l=Se("upload/v1beta/files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=sN(g),T=new bw;return Object.assign(T,m),T})}}async get(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=oN(e);return l=Se("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async delete(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=iN(e);return l=Se("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=rN(g),T=new Aw;return Object.assign(T,m),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xd(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function dN(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>CN(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function fN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function hN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function mN(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=h(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const I=h(n,["responseMimeType"]);I!=null&&y(e,["responseMimeType"],I);const V=h(n,["responseModalities"]);V!=null&&y(e,["responseModalities"],V);const L=h(n,["responseSchema"]);L!=null&&y(e,["responseSchema"],L);const j=h(n,["routingConfig"]);j!=null&&y(e,["routingConfig"],j);const $=h(n,["seed"]);$!=null&&y(e,["seed"],$);const J=h(n,["speechConfig"]);J!=null&&y(e,["speechConfig"],ox(J));const ee=h(n,["stopSequences"]);ee!=null&&y(e,["stopSequences"],ee);const q=h(n,["temperature"]);q!=null&&y(e,["temperature"],q);const X=h(n,["thinkingConfig"]);X!=null&&y(e,["thinkingConfig"],X);const z=h(n,["topK"]);z!=null&&y(e,["topK"],z);const R=h(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function pN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function gN(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function yN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Lp(E));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const I=h(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],dN(_n(V)));const L=h(n,["tools"]);if(e!==void 0&&L!=null){let z=Wa(L);Array.isArray(z)&&(z=z.map(R=>IN(Xa(R)))),y(e,["setup","tools"],z)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],wN(j));const $=h(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const J=h(n,["outputAudioTranscription"]);e!==void 0&&J!=null&&y(e,["setup","outputAudioTranscription"],J);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const q=h(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const X=h(n,["proactivity"]);return e!==void 0&&X!=null&&y(e,["setup","proactivity"],X),t}function vN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],mN(i));const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],ox(Lp(E)));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const I=h(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],_n(V));const L=h(n,["tools"]);if(e!==void 0&&L!=null){let z=Wa(L);Array.isArray(z)&&(z=z.map(R=>NN(Xa(R)))),y(e,["setup","tools"],z)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],j);const $=h(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const J=h(n,["outputAudioTranscription"]);e!==void 0&&J!=null&&y(e,["setup","outputAudioTranscription"],J);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const q=h(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const X=h(n,["proactivity"]);return e!==void 0&&X!=null&&y(e,["setup","proactivity"],X),t}function _N(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],yN(o,t)),t}function TN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],vN(o,t)),t}function EN(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function xN(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["weightedPrompts"],i)}return e}function bN(n){const e={},t=h(n,["media"]);if(t!=null){let m=YE(t);Array.isArray(m)&&(m=m.map(T=>xd(T))),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],xd(KE(i)));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],xd(JE(l)));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function AN(n){const e={},t=h(n,["media"]);if(t!=null){let m=YE(t);Array.isArray(m)&&(m=m.map(T=>T)),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],KE(i));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],JE(l));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function SN(n){const e={},t=h(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const o=h(n,["toolCall"]);o!=null&&y(e,["toolCall"],o);const l=h(n,["toolCallCancellation"]);l!=null&&y(e,["toolCallCancellation"],l);const u=h(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],RN(u));const d=h(n,["goAway"]);d!=null&&y(e,["goAway"],d);const g=h(n,["sessionResumptionUpdate"]);return g!=null&&y(e,["sessionResumptionUpdate"],g),e}function CN(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],xd(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],fN(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function wN(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ox(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function IN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],gN(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],pN(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function NN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>hN(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function RN(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const o=h(n,["candidatesTokenCount"]);o!=null&&y(e,["responseTokenCount"],o);const l=h(n,["toolUsePromptTokenCount"]);l!=null&&y(e,["toolUsePromptTokenCount"],l);const u=h(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const d=h(n,["totalTokenCount"]);d!=null&&y(e,["totalTokenCount"],d);const g=h(n,["promptTokensDetails"]);if(g!=null){let I=g;Array.isArray(I)&&(I=I.map(V=>V)),y(e,["promptTokensDetails"],I)}const m=h(n,["cacheTokensDetails"]);if(m!=null){let I=m;Array.isArray(I)&&(I=I.map(V=>V)),y(e,["cacheTokensDetails"],I)}const T=h(n,["candidatesTokensDetails"]);if(T!=null){let I=T;Array.isArray(I)&&(I=I.map(V=>V)),y(e,["responseTokensDetails"],I)}const E=h(n,["toolUsePromptTokensDetails"]);if(E!=null){let I=E;Array.isArray(I)&&(I=I.map(V=>V)),y(e,["toolUsePromptTokensDetails"],I)}const b=h(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function MN(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],PN(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const d=h(n,["avgLogprobs"]);d!=null&&y(e,["avgLogprobs"],d);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const E=h(n,["safetyRatings"]);if(E!=null){let b=E;Array.isArray(b)&&(b=b.map(I=>I)),y(e,["safetyRatings"],b)}return e}function PN(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function kN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let l=us(o);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["contents"],l)}return t}function VN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["tokensInfo"],o)}return e}function LN(n){const e={},t=h(n,["values"]);t!=null&&y(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&y(e,["statistics"],UN(i)),e}function UN(n){const e={},t=h(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function sf(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>BR(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function ON(n){const e={},t=h(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function qN(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function jN(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],_n(i));const o=h(n,["tools"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>dx(d))),y(e,["tools"],u)}const l=h(n,["generationConfig"]);return e!==void 0&&l!=null&&y(e,["generationConfig"],NR(l)),t}function FN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let u=us(o);Array.isArray(u)&&(u=u.map(d=>sf(d))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&qN(l),t}function BN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let u=us(o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&jN(l,t),t}function zN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const o=h(n,["cachedContentTokenCount"]);return o!=null&&y(e,["cachedContentTokenCount"],o),e}function HN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function GN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function $N(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function YN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function JN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function KN(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const I=h(n,["language"]);e!==void 0&&I!=null&&y(e,["parameters","language"],I);const V=h(n,["outputMimeType"]);e!==void 0&&V!=null&&y(e,["parameters","outputOptions","mimeType"],V);const L=h(n,["outputCompressionQuality"]);e!==void 0&&L!=null&&y(e,["parameters","outputOptions","compressionQuality"],L);const j=h(n,["addWatermark"]);e!==void 0&&j!=null&&y(e,["parameters","addWatermark"],j);const $=h(n,["labels"]);e!==void 0&&$!=null&&y(e,["labels"],$);const J=h(n,["editMode"]);e!==void 0&&J!=null&&y(e,["parameters","editMode"],J);const ee=h(n,["baseSteps"]);return e!==void 0&&ee!=null&&y(e,["parameters","editConfig","baseSteps"],ee),t}function QN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(g=>JR(g))),y(t,["instances[0]","referenceImages"],d)}const u=h(e,["config"]);return u!=null&&KN(u,t),t}function XN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>rf(l))),y(e,["generatedImages"],o)}return e}function WN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function ZN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["instances[]","title"],o);const l=h(n,["outputDimensionality"]);e!==void 0&&l!=null&&y(e,["parameters","outputDimensionality"],l);const u=h(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const d=h(n,["autoTruncate"]);return e!==void 0&&d!=null&&y(e,["parameters","autoTruncate"],d),t}function eR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let d=Pp(n,o);Array.isArray(d)&&(d=d.map(g=>g)),y(t,["requests[]","content"],d)}const l=h(e,["config"]);l!=null&&WN(l,t);const u=h(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],lt(n,u)),t}function tR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let u=Pp(n,o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["instances[]","content"],u)}const l=h(e,["config"]);return l!=null&&ZN(l,t),t}function nR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function sR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>LN(u))),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function iR(n){const e={},t=h(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function rR(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function oR(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function aR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],sf(_n(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const I=h(e,["presencePenalty"]);I!=null&&y(i,["presencePenalty"],I);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const L=h(e,["seed"]);L!=null&&y(i,["seed"],L);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const $=h(e,["responseSchema"]);$!=null&&y(i,["responseSchema"],kp($));const J=h(e,["responseJsonSchema"]);if(J!=null&&y(i,["responseJsonSchema"],J),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=h(e,["safetySettings"]);if(t!==void 0&&ee!=null){let U=ee;Array.isArray(U)&&(U=U.map(k=>KR(k))),y(t,["safetySettings"],U)}const q=h(e,["tools"]);if(t!==void 0&&q!=null){let U=Wa(q);Array.isArray(U)&&(U=U.map(k=>t1(Xa(k)))),y(t,["tools"],U)}const X=h(e,["toolConfig"]);if(t!==void 0&&X!=null&&y(t,["toolConfig"],X),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=h(e,["cachedContent"]);t!==void 0&&z!=null&&y(t,["cachedContent"],Fi(n,z));const R=h(e,["responseModalities"]);R!=null&&y(i,["responseModalities"],R);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const D=h(e,["speechConfig"]);if(D!=null&&y(i,["speechConfig"],Vp(D)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const w=h(e,["thinkingConfig"]);w!=null&&y(i,["thinkingConfig"],w);const P=h(e,["imageConfig"]);return P!=null&&y(i,["imageConfig"],P),i}function lR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],_n(o));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const d=h(e,["topK"]);d!=null&&y(i,["topK"],d);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&y(i,["responseLogprobs"],E);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const I=h(e,["presencePenalty"]);I!=null&&y(i,["presencePenalty"],I);const V=h(e,["frequencyPenalty"]);V!=null&&y(i,["frequencyPenalty"],V);const L=h(e,["seed"]);L!=null&&y(i,["seed"],L);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const $=h(e,["responseSchema"]);$!=null&&y(i,["responseSchema"],kp($));const J=h(e,["responseJsonSchema"]);J!=null&&y(i,["responseJsonSchema"],J);const ee=h(e,["routingConfig"]);ee!=null&&y(i,["routingConfig"],ee);const q=h(e,["modelSelectionConfig"]);q!=null&&y(i,["modelConfig"],q);const X=h(e,["safetySettings"]);if(t!==void 0&&X!=null){let te=X;Array.isArray(te)&&(te=te.map(Z=>Z)),y(t,["safetySettings"],te)}const z=h(e,["tools"]);if(t!==void 0&&z!=null){let te=Wa(z);Array.isArray(te)&&(te=te.map(Z=>dx(Xa(Z)))),y(t,["tools"],te)}const R=h(e,["toolConfig"]);t!==void 0&&R!=null&&y(t,["toolConfig"],R);const C=h(e,["labels"]);t!==void 0&&C!=null&&y(t,["labels"],C);const D=h(e,["cachedContent"]);t!==void 0&&D!=null&&y(t,["cachedContent"],Fi(n,D));const w=h(e,["responseModalities"]);w!=null&&y(i,["responseModalities"],w);const P=h(e,["mediaResolution"]);P!=null&&y(i,["mediaResolution"],P);const U=h(e,["speechConfig"]);U!=null&&y(i,["speechConfig"],cx(Vp(U)));const k=h(e,["audioTimestamp"]);k!=null&&y(i,["audioTimestamp"],k);const Oe=h(e,["thinkingConfig"]);Oe!=null&&y(i,["thinkingConfig"],Oe);const Be=h(e,["imageConfig"]);return Be!=null&&y(i,["imageConfig"],Be),i}function oT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let u=us(o);Array.isArray(u)&&(u=u.map(d=>sf(d))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],aR(n,l,t)),t}function aT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["contents"]);if(o!=null){let u=us(o);Array.isArray(u)&&(u=u.map(d=>d)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],lR(n,l,t)),t}function lT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>MN(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function uT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["candidates"],m)}const o=h(n,["createTime"]);o!=null&&y(e,["createTime"],o);const l=h(n,["modelVersion"]);l!=null&&y(e,["modelVersion"],l);const u=h(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const d=h(n,["responseId"]);d!=null&&y(e,["responseId"],d);const g=h(n,["usageMetadata"]);return g!=null&&y(e,["usageMetadata"],g),e}function uR(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const l=h(n,["guidanceScale"]);if(e!==void 0&&l!=null&&y(e,["parameters","guidanceScale"],l),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const g=h(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&y(e,["parameters","includeSafetyAttributes"],g);const m=h(n,["includeRaiReason"]);e!==void 0&&m!=null&&y(e,["parameters","includeRaiReason"],m);const T=h(n,["language"]);e!==void 0&&T!=null&&y(e,["parameters","language"],T);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","mimeType"],E);const b=h(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=h(n,["imageSize"]);if(e!==void 0&&I!=null&&y(e,["parameters","sampleImageSize"],I),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function cR(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&y(e,["parameters","includeSafetyAttributes"],E);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const I=h(n,["language"]);e!==void 0&&I!=null&&y(e,["parameters","language"],I);const V=h(n,["outputMimeType"]);e!==void 0&&V!=null&&y(e,["parameters","outputOptions","mimeType"],V);const L=h(n,["outputCompressionQuality"]);e!==void 0&&L!=null&&y(e,["parameters","outputOptions","compressionQuality"],L);const j=h(n,["addWatermark"]);e!==void 0&&j!=null&&y(e,["parameters","addWatermark"],j);const $=h(n,["labels"]);e!==void 0&&$!=null&&y(e,["labels"],$);const J=h(n,["imageSize"]);e!==void 0&&J!=null&&y(e,["parameters","sampleImageSize"],J);const ee=h(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&y(e,["parameters","enhancePrompt"],ee),t}function dR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&uR(l,t),t}function fR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&cR(l,t),t}function hR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>SR(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],lx(o)),e}function mR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>rf(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],ux(o)),e}function pR(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=h(n,["durationSeconds"]);if(e!==void 0&&o!=null&&y(e,["parameters","durationSeconds"],o),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const u=h(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const d=h(n,["personGeneration"]);if(e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=h(n,["negativePrompt"]);e!==void 0&&g!=null&&y(e,["parameters","negativePrompt"],g);const m=h(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&y(e,["parameters","enhancePrompt"],m),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=h(n,["lastFrame"]);e!==void 0&&T!=null&&y(e,["instances[0]","lastFrame"],of(T));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let b=E;Array.isArray(b)&&(b=b.map(I=>m1(I))),y(e,["instances[0]","referenceImages"],b)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function gR(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const l=h(n,["fps"]);e!==void 0&&l!=null&&y(e,["parameters","fps"],l);const u=h(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const d=h(n,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const g=h(n,["aspectRatio"]);e!==void 0&&g!=null&&y(e,["parameters","aspectRatio"],g);const m=h(n,["resolution"]);e!==void 0&&m!=null&&y(e,["parameters","resolution"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&y(e,["parameters","pubsubTopic"],E);const b=h(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const I=h(n,["enhancePrompt"]);e!==void 0&&I!=null&&y(e,["parameters","enhancePrompt"],I);const V=h(n,["generateAudio"]);e!==void 0&&V!=null&&y(e,["parameters","generateAudio"],V);const L=h(n,["lastFrame"]);e!==void 0&&L!=null&&y(e,["instances[0]","lastFrame"],Is(L));const j=h(n,["referenceImages"]);if(e!==void 0&&j!=null){let ee=j;Array.isArray(ee)&&(ee=ee.map(q=>p1(q))),y(e,["instances[0]","referenceImages"],ee)}const $=h(n,["mask"]);e!==void 0&&$!=null&&y(e,["instances[0]","mask"],h1($));const J=h(n,["compressionQuality"]);return e!==void 0&&J!=null&&y(e,["parameters","compressionQuality"],J),t}function yR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],ER(u)),e}function vR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],xR(u)),e}function _R(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],of(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],fx(u));const d=h(e,["source"]);d!=null&&bR(d,t);const g=h(e,["config"]);return g!=null&&pR(g,t),t}function TR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],Is(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],hx(u));const d=h(e,["source"]);d!=null&&AR(d,t);const g=h(e,["config"]);return g!=null&&gR(g,t),t}function ER(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>wR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function xR(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>IR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function bR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],of(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],fx(l)),t}function AR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],Is(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],hx(l)),t}function SR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],kR(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);return o!=null&&y(e,["safetyAttributes"],lx(o)),e}function rf(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],ax(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);o!=null&&y(e,["safetyAttributes"],ux(o));const l=h(n,["prompt"]);return l!=null&&y(e,["enhancedPrompt"],l),e}function CR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["mask"],ax(t));const i=h(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["labels"],o)}return e}function wR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],d1(t)),e}function IR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],f1(t)),e}function NR(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const d=h(n,["logprobs"]);d!=null&&y(e,["logprobs"],d);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const E=h(n,["responseJsonSchema"]);E!=null&&y(e,["responseJsonSchema"],E);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const I=h(n,["responseMimeType"]);I!=null&&y(e,["responseMimeType"],I);const V=h(n,["responseModalities"]);V!=null&&y(e,["responseModalities"],V);const L=h(n,["responseSchema"]);L!=null&&y(e,["responseSchema"],L);const j=h(n,["routingConfig"]);j!=null&&y(e,["routingConfig"],j);const $=h(n,["seed"]);$!=null&&y(e,["seed"],$);const J=h(n,["speechConfig"]);J!=null&&y(e,["speechConfig"],cx(J));const ee=h(n,["stopSequences"]);ee!=null&&y(e,["stopSequences"],ee);const q=h(n,["temperature"]);q!=null&&y(e,["temperature"],q);const X=h(n,["thinkingConfig"]);X!=null&&y(e,["thinkingConfig"],X);const z=h(n,["topK"]);z!=null&&y(e,["topK"],z);const R=h(n,["topP"]);return R!=null&&y(e,["topP"],R),e}function RR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function DR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],lt(n,i)),t}function MR(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function PR(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function kR(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],qr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function ax(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],qr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function of(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],qr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Is(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],qr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function VR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],ZE(n,d)),i}function LR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],ZE(n,d)),i}function UR(n,e){const t={},i=h(e,["config"]);return i!=null&&VR(n,i,t),t}function OR(n,e){const t={},i=h(e,["config"]);return i!=null&&LR(n,i,t),t}function qR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=ex(o);Array.isArray(l)&&(l=l.map(u=>Zm(u))),y(e,["models"],l)}return e}function jR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=ex(o);Array.isArray(l)&&(l=l.map(u=>ep(u))),y(e,["models"],l)}return e}function FR(n){const e={},t=h(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const o=h(n,["maskDilation"]);return o!=null&&y(e,["dilation"],o),e}function Zm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["version"]);l!=null&&y(e,["version"],l);const u=h(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],n1(u));const d=h(n,["inputTokenLimit"]);d!=null&&y(e,["inputTokenLimit"],d);const g=h(n,["outputTokenLimit"]);g!=null&&y(e,["outputTokenLimit"],g);const m=h(n,["supportedGenerationMethods"]);return m!=null&&y(e,["supportedActions"],m),e}function ep(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["versionId"]);l!=null&&y(e,["version"],l);const u=h(n,["deployedModels"]);if(u!=null){let E=u;Array.isArray(E)&&(E=E.map(b=>iR(b))),y(e,["endpoints"],E)}const d=h(n,["labels"]);d!=null&&y(e,["labels"],d);const g=h(n,["_self"]);g!=null&&y(e,["tunedModelInfo"],s1(g));const m=h(n,["defaultCheckpointId"]);m!=null&&y(e,["defaultCheckpointId"],m);const T=h(n,["checkpoints"]);if(T!=null){let E=T;Array.isArray(E)&&(E=E.map(b=>b)),y(e,["checkpoints"],E)}return e}function BR(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],DN(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],rR(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function zR(n){const e={},t=h(n,["productImage"]);return t!=null&&y(e,["image"],Is(t)),e}function HR(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["baseSteps"]);e!==void 0&&o!=null&&y(e,["parameters","editConfig","baseSteps"],o);const l=h(n,["outputGcsUri"]);e!==void 0&&l!=null&&y(e,["parameters","storageUri"],l);const u=h(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&y(e,["parameters","personGeneration"],g);const m=h(n,["addWatermark"]);e!==void 0&&m!=null&&y(e,["parameters","addWatermark"],m);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&y(e,["parameters","outputOptions","mimeType"],T);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&y(e,["parameters","outputOptions","compressionQuality"],E);const b=h(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const I=h(n,["labels"]);return e!==void 0&&I!=null&&y(e,["labels"],I),t}function GR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["source"]);o!=null&&YR(o,t);const l=h(e,["config"]);return l!=null&&HR(l,t),t}function $R(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>rf(o))),y(e,["generatedImages"],i)}return e}function YR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["personImage"]);e!==void 0&&o!=null&&y(e,["instances[0]","personImage","image"],Is(o));const l=h(n,["productImages"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(d=>zR(d))),y(e,["instances[0]","productImages"],u)}return t}function JR(n){const e={},t=h(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],Is(t));const i=h(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const o=h(n,["referenceType"]);o!=null&&y(e,["referenceType"],o);const l=h(n,["maskImageConfig"]);l!=null&&y(e,["maskImageConfig"],FR(l));const u=h(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],ON(u));const d=h(n,["styleImageConfig"]);d!=null&&y(e,["styleImageConfig"],d);const g=h(n,["subjectImageConfig"]);return g!=null&&y(e,["subjectImageConfig"],g),e}function lx(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function ux(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function KR(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function QR(n){const e={},t=h(n,["image"]);return t!=null&&y(e,["image"],Is(t)),e}function XR(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const o=h(n,["maxPredictions"]);e!==void 0&&o!=null&&y(e,["parameters","maxPredictions"],o);const l=h(n,["confidenceThreshold"]);e!==void 0&&l!=null&&y(e,["parameters","confidenceThreshold"],l);const u=h(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const d=h(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&y(e,["parameters","binaryColorThreshold"],d);const g=h(n,["labels"]);return e!==void 0&&g!=null&&y(e,["labels"],g),t}function WR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["source"]);o!=null&&e1(o,t);const l=h(e,["config"]);return l!=null&&XR(l,t),t}function ZR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>CR(o))),y(e,["generatedMasks"],i)}return e}function e1(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],Is(o));const l=h(n,["scribbleImage"]);return e!==void 0&&l!=null&&y(e,["instances[0]","scribble"],QR(l)),t}function cx(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function t1(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],PR(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],MR(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function dx(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(b=>oR(b))),y(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const d=h(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],d);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function n1(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function s1(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function i1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function r1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function o1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","name"],lt(n,i));const o=h(e,["config"]);return o!=null&&i1(o,t),t}function a1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["config"]);return o!=null&&r1(o,t),t}function l1(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["includeRaiReason"]);e!==void 0&&o!=null&&y(e,["parameters","includeRaiReason"],o);const l=h(n,["outputMimeType"]);e!==void 0&&l!=null&&y(e,["parameters","outputOptions","mimeType"],l);const u=h(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const d=h(n,["enhanceInputImage"]);e!==void 0&&d!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],d);const g=h(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const m=h(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&y(e,["parameters","sampleCount"],T);const E=h(n,["mode"]);return e!==void 0&&E!=null&&y(e,["parameters","mode"],E),t}function u1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],lt(n,i));const o=h(e,["image"]);o!=null&&y(t,["instances[0]","image"],Is(o));const l=h(e,["upscaleFactor"]);l!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],l);const u=h(e,["config"]);return u!=null&&l1(u,t),t}function c1(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>rf(l))),y(e,["generatedImages"],o)}return e}function d1(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],qr(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function f1(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],qr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function h1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["_self"],Is(t));const i=h(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function m1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],of(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function p1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],Is(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function fx(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["video","uri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["video","encodedVideo"],qr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["encoding"],o),e}function hx(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],qr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g1="Content-Type",y1="X-Server-Timeout",v1="User-Agent",tp="x-goog-api-client",_1="1.24.0",T1=`google-genai-sdk/${_1}`,E1="v1beta1",x1="v1beta",cT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class b1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:E1,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:x1,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,d]of Object.entries(e.queryParams))o.searchParams.append(u,String(d));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(o,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,l]of Object.entries(t))typeof l=="object"?i[o]=Object.assign(Object.assign({},i[o]),l):l!==void 0&&(i[o]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(o,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&A1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await dT(o),new Qm(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await dT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return ka(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:d,value:g}=yield Ct(o.read());if(d){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(g,{stream:!0});try{const E=JSON.parse(m);if("error"in E){const b=JSON.parse(JSON.stringify(E.error)),I=b.status,V=b.code,L=`got status: ${I}. ${JSON.stringify(E)}`;if(V>=400&&V<600)throw new nf({message:L,status:V})}}catch(E){if(E.name==="ApiError")throw E}u+=m;let T=u.match(cT);for(;T;){const E=T[1];try{const b=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ct(new Qm(b)),u=u.slice(T[0].length),T=u.match(cT)}catch(b){throw new Error(`exception parsing stream chunk ${E}. ${b}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=T1+" "+this.clientOptions.userAgentExtra;return e[v1]=t,e[tp]=t,e[g1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))t.append(i,o);e.timeout&&e.timeout>0&&t.append(y1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);o.sizeBytes=String(u.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=d;const g=await this.fetchUploadUrl(o,t);return l.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let o={};t!=null&&t.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},u=await this.request({path:Se("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function dT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new nf({message:o,status:t}):new Error(o)}}function A1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,u){const d=Object.assign({},l);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const m=u[g],T=d[g];m&&typeof m=="object"&&!Array.isArray(m)&&T&&typeof T=="object"&&!Array.isArray(T)?d[g]=i(T,m):(T&&m&&typeof T!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof T}, New type: ${typeof m}. Overwriting.`),d[g]=m)}return d}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const S1="mcp_used/unknown";let C1=!1;function mx(n){for(const e of n)if(w1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return C1}function px(n){var e;const t=(e=n[tp])!==null&&e!==void 0?e:"";n[tp]=(t+` ${S1}`).trimStart()}function w1(n){return n!==null&&typeof n=="object"&&n instanceof Up}function I1(n,e=100){return ka(this,arguments,function*(){let i,o=0;for(;o<e;){const l=yield Ct(n.listTools({cursor:i}));for(const u of l.tools)yield yield Ct(u),o++;if(!l.nextCursor)break;i=l.nextCursor}})}class Up{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Up(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const l={},u=[];for(const T of this.mcpClients)try{for(var d=!0,g=(t=void 0,gu(I1(T))),m;m=await g.next(),e=m.done,!e;d=!0){o=m.value,d=!1;const E=o;u.push(E);const b=E.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=T}}catch(E){t={error:E}}finally{try{!d&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),kw(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const u=await o.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function N1(n,e,t){const i=new Cw;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class R1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),u=P1(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),g=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${d}`;let m=()=>{};const T=new Promise(ee=>{m=ee}),E=e.callbacks,b=function(){m({})},I=this.apiClient,V={onopen:b,onmessage:ee=>{N1(I,E.onmessage,ee)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(ee){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(ee){}},L=this.webSocketFactory.create(g,M1(u),V);L.connect(),await T;const J={setup:{model:lt(this.apiClient,e.model)}};return L.send(JSON.stringify(J)),new D1(L,this.apiClient)}}class D1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=xN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=EN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ia.PLAY)}pause(){this.sendPlaybackControl(Ia.PAUSE)}stop(){this.sendPlaybackControl(Ia.STOP)}resetContext(){this.sendPlaybackControl(Ia.RESET_CONTEXT)}close(){this.conn.close()}}function M1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function P1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const k1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function V1(n,e,t){const i=new Sw;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const l=JSON.parse(o);if(n.isVertexAI()){const u=SN(l);Object.assign(i,u)}else Object.assign(i,l);e(i)}class L1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new R1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,l,u,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let T;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&mx(e.config.tools)&&px(E);const b=j1(E);if(this.apiClient.isVertexAI())T=`${g}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const D=this.apiClient.getApiKey();let w="BidiGenerateContent",P="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),w="BidiGenerateContentConstrained",P="access_token"),T=`${g}/ws/google.ai.generativelanguage.${m}.GenerativeService.${w}?${P}=${D}`}let I=()=>{};const V=new Promise(D=>{I=D}),L=e.callbacks,j=function(){var D;(D=L==null?void 0:L.onopen)===null||D===void 0||D.call(L),I({})},$=this.apiClient,J={onopen:j,onmessage:D=>{V1($,L.onmessage,D)},onerror:(t=L==null?void 0:L.onerror)!==null&&t!==void 0?t:function(D){},onclose:(i=L==null?void 0:L.onclose)!==null&&i!==void 0?i:function(D){}},ee=this.webSocketFactory.create(T,q1(b),J);ee.connect(),await V;let q=lt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&q.startsWith("publishers/")){const D=this.apiClient.getProject(),w=this.apiClient.getLocation();q=`projects/${D}/locations/${w}/`+q}let X={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Md.AUDIO]}:e.config.responseModalities=[Md.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(d=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[],R=[];for(const D of z)if(this.isCallableTool(D)){const w=D;R.push(await w.tool())}else R.push(D);R.length>0&&(e.config.tools=R);const C={model:q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?X=TN(this.apiClient,C):X=_N(this.apiClient,C),delete X.config,ee.send(JSON.stringify(X)),new O1(ee,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const U1={turnComplete:!0};class O1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=us(t.turns),e.isVertexAI()||(i=i.map(o=>sf(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(k1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},U1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:AN(e)}:t={realtimeInput:bN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function q1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function j1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fT=10;function hT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Va(u)){o=!0;break}if(!o)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function Va(n){return"callTool"in n&&typeof n.callTool=="function"}function F1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>Va(o)))!==null&&i!==void 0?i:!1}function B1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!Va(o)))!==null&&i!==void 0?i:!1}function mT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z1 extends Io{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,l,u,d;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!F1(t)||hT(t.config))return await this.generateContentInternal(g);if(B1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,T;const E=us(g.contents),b=(l=(o=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&l!==void 0?l:fT;let I=0;for(;I<b&&(m=await this.generateContentInternal(g),!(!m.functionCalls||m.functionCalls.length===0));){const V=m.candidates[0].content,L=[];for(const j of(d=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[])if(Va(j)){const J=await j.callTool(m.functionCalls);L.push(...J)}I++,T={role:"user",parts:L},g.contents=us(g.contents),g.contents.push(V),g.contents.push(T),mT(g.config)&&(E.push(V),E.push(T))}return mT(g.config)&&(m.automaticFunctionCallingHistory=E),m},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),hT(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let l;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((o=g==null?void 0:g.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:u.push(g);let d;return l?d={generatedImages:u,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Ru(Eo.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const u=await Promise.all(l.map(async g=>Va(g)?await g.tool():g)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(d.config.tools=u,e.config&&e.config.tools&&mx(e.config.tools)){const g=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let m=Object.assign({},g);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),px(m),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return d}async initAfcToolsMap(e){var t,i,o;const l=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Va(u)){const d=u,g=await d.tool();for(const m of(o=g.functionDeclarations)!==null&&o!==void 0?o:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,d)}}return l}async processAfcStream(e){var t,i,o;const l=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:fT;let u=!1,d=0;const g=await this.initAfcToolsMap(e);return(function(m,T,E){var b,I;return ka(this,arguments,function*(){for(var V,L,j,$;d<l;){u&&(d++,u=!1);const X=yield Ct(m.processParamsMaybeAddMcpUsage(E)),z=yield Ct(m.generateContentStreamInternal(X)),R=[],C=[];try{for(var J=!0,ee=(L=void 0,gu(z)),q;q=yield Ct(ee.next()),V=q.done,!V;J=!0){$=q.value,J=!1;const D=$;if(yield yield Ct(D),D.candidates&&(!((b=D.candidates[0])===null||b===void 0)&&b.content)){C.push(D.candidates[0].content);for(const w of(I=D.candidates[0].content.parts)!==null&&I!==void 0?I:[])if(d<l&&w.functionCall){if(!w.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(w.functionCall.name)){const P=yield Ct(T.get(w.functionCall.name).callTool([w.functionCall]));R.push(...P)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${w.functionCall.name}`)}}}}catch(D){L={error:D}}finally{try{!J&&!V&&(j=ee.return)&&(yield Ct(j.call(ee)))}finally{if(L)throw L.error}}if(R.length>0){u=!0;const D=new uu;D.candidates=[{content:{role:"user",parts:R}}],yield yield Ct(D);const w=[];w.push(...C),w.push({role:"user",parts:R});const P=us(E.contents).concat(w);E.contents=P}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=aT(this.apiClient,e);return d=Se("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=uT(T),b=new uu;return Object.assign(b,E),b})}else{const m=oT(this.apiClient,e);return d=Se("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=lT(T),b=new uu;return Object.assign(b,E),b})}}async generateContentStreamInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=aT(this.apiClient,e);return d=Se("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(E){return ka(this,arguments,function*(){var b,I,V,L;try{for(var j=!0,$=gu(E),J;J=yield Ct($.next()),b=J.done,!b;j=!0){L=J.value,j=!1;const ee=L,q=uT(yield Ct(ee.json()));q.sdkHttpResponse={headers:ee.headers};const X=new uu;Object.assign(X,q),yield yield Ct(X)}}catch(ee){I={error:ee}}finally{try{!j&&!b&&(V=$.return)&&(yield Ct(V.call($)))}finally{if(I)throw I.error}}})})}else{const m=oT(this.apiClient,e);return d=Se("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),u.then(function(E){return ka(this,arguments,function*(){var b,I,V,L;try{for(var j=!0,$=gu(E),J;J=yield Ct($.next()),b=J.done,!b;j=!0){L=J.value,j=!1;const ee=L,q=lT(yield Ct(ee.json()));q.sdkHttpResponse={headers:ee.headers};const X=new uu;Object.assign(X,q),yield yield Ct(X)}}catch(ee){I={error:ee}}finally{try{!j&&!b&&(V=$.return)&&(yield Ct(V.call($)))}finally{if(I)throw I.error}}})})}}async embedContent(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=tR(this.apiClient,e);return d=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=sR(T),b=new H_;return Object.assign(b,E),b})}else{const m=eR(this.apiClient,e);return d=Se("{model}:batchEmbedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=nR(T),b=new H_;return Object.assign(b,E),b})}}async generateImagesInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=fR(this.apiClient,e);return d=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=mR(T),b=new G_;return Object.assign(b,E),b})}else{const m=dR(this.apiClient,e);return d=Se("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=hR(T),b=new G_;return Object.assign(b,E),b})}}async editImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=QN(this.apiClient,e);return l=Se("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=XN(g),T=new yw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=u1(this.apiClient,e);return l=Se("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=c1(g),T=new vw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=GR(this.apiClient,e);return l=Se("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=$R(g),T=new _w;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=WR(this.apiClient,e);return l=Se("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=ZR(g),T=new Tw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=DR(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>ep(T))}else{const m=RR(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Zm(T))}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=OR(this.apiClient,e);return d=Se("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=jR(T),b=new $_;return Object.assign(b,E),b})}else{const m=UR(this.apiClient,e);return d=Se("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=qR(T),b=new $_;return Object.assign(b,E),b})}}async update(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=a1(this.apiClient,e);return d=Se("{model}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>ep(T))}else{const m=o1(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Zm(T))}}async delete(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=$N(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=JN(T),b=new Y_;return Object.assign(b,E),b})}else{const m=GN(this.apiClient,e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=YN(T),b=new Y_;return Object.assign(b,E),b})}}async countTokens(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=BN(this.apiClient,e);return d=Se("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=HN(T),b=new J_;return Object.assign(b,E),b})}else{const m=FN(this.apiClient,e);return d=Se("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=zN(T),b=new J_;return Object.assign(b,E),b})}}async computeTokens(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=kN(this.apiClient,e);return l=Se("{model}:computeTokens",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=VN(g),T=new Ew;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=TR(this.apiClient,e);return d=Se("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>{const E=vR(T),b=new Pd;return Object.assign(b,E),b})}else{const m=_R(this.apiClient,e);return d=Se("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>{const E=yR(T),b=new Pd;return Object.assign(b,E),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H1 extends Io{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=mw(e);return d=Se("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u}else{const m=hw(e);return d=Se("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=ow(e);return l=Se("{resourceName}:fetchPredictOperation",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function G1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function $1(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>eD(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function Y1(n,e,t){const i={},o=h(e,["expireTime"]);t!==void 0&&o!=null&&y(t,["expireTime"],o);const l=h(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&y(t,["newSessionExpireTime"],l);const u=h(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const d=h(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&y(t,["bidiGenerateContentSetup"],Z1(n,d));const g=h(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&y(t,["fieldMask"],g),i}function J1(n,e){const t={},i=h(e,["config"]);return i!=null&&y(t,["config"],Y1(n,i,t)),t}function K1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Q1(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function X1(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function W1(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&y(e,["setup","generationConfig","speechConfig"],Lp(E));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const I=h(n,["enableAffectiveDialog"]);e!==void 0&&I!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],I);const V=h(n,["systemInstruction"]);e!==void 0&&V!=null&&y(e,["setup","systemInstruction"],$1(_n(V)));const L=h(n,["tools"]);if(e!==void 0&&L!=null){let z=Wa(L);Array.isArray(z)&&(z=z.map(R=>nD(Xa(R)))),y(e,["setup","tools"],z)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],tD(j));const $=h(n,["inputAudioTranscription"]);e!==void 0&&$!=null&&y(e,["setup","inputAudioTranscription"],$);const J=h(n,["outputAudioTranscription"]);e!==void 0&&J!=null&&y(e,["setup","outputAudioTranscription"],J);const ee=h(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&y(e,["setup","realtimeInputConfig"],ee);const q=h(n,["contextWindowCompression"]);e!==void 0&&q!=null&&y(e,["setup","contextWindowCompression"],q);const X=h(n,["proactivity"]);return e!==void 0&&X!=null&&y(e,["setup","proactivity"],X),t}function Z1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],lt(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],W1(o,t)),t}function eD(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],G1(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],K1(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const d=h(n,["functionCall"]);d!=null&&y(e,["functionCall"],d);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const E=h(n,["text"]);return E!=null&&y(e,["text"],E),e}function tD(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function nD(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],X1(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],Q1(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const d=h(n,["computerUse"]);d!=null&&y(e,["computerUse"],d);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sD(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(l=>`${t}.${l}`);e.push(...o)}else e.push(t)}return e.join(",")}function iD(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const l=sD(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];o.length>0&&(d=o.map(m=>u.includes(m)?`generationConfig.${m}`:m));const g=[];l&&g.push(l),d.length>0&&g.push(...d),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class rD extends Io{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=J1(this.apiClient,e);l=Se("auth_tokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const g=iD(d,e.config);return o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),o.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function aD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function lD(n,e){const t={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=h(n,["epochCount"]);e!==void 0&&o!=null&&y(e,["tuningTask","hyperparameters","epochCount"],o);const l=h(n,["learningRateMultiplier"]);if(l!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=h(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const d=h(n,["learningRate"]);if(e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","learningRate"],d),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function uD(n,e){const t={},i=h(n,["validationDataset"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec"],AD(i,t));const o=h(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&y(e,["tunedModelDisplayName"],o);const l=h(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);const u=h(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const d=h(n,["learningRateMultiplier"]);e!==void 0&&d!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const g=h(n,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const m=h(n,["adapterSize"]);if(e!==void 0&&m!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m),h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=h(n,["labels"]);return e!==void 0&&T!=null&&y(e,["labels"],T),t}function cD(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["tuningTask","trainingData"],ED(o));const l=h(n,["config"]);return l!=null&&lD(l,e),e}function dD(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],xD(o,e));const l=h(n,["config"]);return l!=null&&uD(l,e),e}function fD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function hD(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function mD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function pD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function gD(n){const e={},t=h(n,["config"]);return t!=null&&mD(t,e),e}function yD(n){const e={},t=h(n,["config"]);return t!=null&&pD(t,e),e}function vD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>gx(u))),y(e,["tuningJobs"],l)}return e}function _D(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>np(u))),y(e,["tuningJobs"],l)}return e}function TD(n){const e={},t=h(n,["name"]);t!=null&&y(e,["model"],t);const i=h(n,["name"]);return i!=null&&y(e,["endpoint"],i),e}function ED(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["examples","examples"],i)}return e}function xD(n,e){const t={},i=h(n,["gcsUri"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);if(e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function gx(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],XE(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const d=h(n,["tuningTask","completeTime"]);d!=null&&y(e,["endTime"],d);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["description"]);m!=null&&y(e,["description"],m);const T=h(n,["baseModel"]);T!=null&&y(e,["baseModel"],T);const E=h(n,["_self"]);E!=null&&y(e,["tunedModel"],TD(E));const b=h(n,["customBaseModel"]);b!=null&&y(e,["customBaseModel"],b);const I=h(n,["experiment"]);I!=null&&y(e,["experiment"],I);const V=h(n,["labels"]);V!=null&&y(e,["labels"],V);const L=h(n,["outputUri"]);L!=null&&y(e,["outputUri"],L);const j=h(n,["pipelineJob"]);j!=null&&y(e,["pipelineJob"],j);const $=h(n,["serviceAccount"]);$!=null&&y(e,["serviceAccount"],$);const J=h(n,["tunedModelDisplayName"]);J!=null&&y(e,["tunedModelDisplayName"],J);const ee=h(n,["veoTuningSpec"]);return ee!=null&&y(e,["veoTuningSpec"],ee),e}function np(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],XE(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["startTime"]);u!=null&&y(e,["startTime"],u);const d=h(n,["endTime"]);d!=null&&y(e,["endTime"],d);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["error"]);m!=null&&y(e,["error"],m);const T=h(n,["description"]);T!=null&&y(e,["description"],T);const E=h(n,["baseModel"]);E!=null&&y(e,["baseModel"],E);const b=h(n,["tunedModel"]);b!=null&&y(e,["tunedModel"],b);const I=h(n,["preTunedModel"]);I!=null&&y(e,["preTunedModel"],I);const V=h(n,["supervisedTuningSpec"]);V!=null&&y(e,["supervisedTuningSpec"],V);const L=h(n,["tuningDataStats"]);L!=null&&y(e,["tuningDataStats"],L);const j=h(n,["encryptionSpec"]);j!=null&&y(e,["encryptionSpec"],j);const $=h(n,["partnerModelTuningSpec"]);$!=null&&y(e,["partnerModelTuningSpec"],$);const J=h(n,["customBaseModel"]);J!=null&&y(e,["customBaseModel"],J);const ee=h(n,["experiment"]);ee!=null&&y(e,["experiment"],ee);const q=h(n,["labels"]);q!=null&&y(e,["labels"],q);const X=h(n,["outputUri"]);X!=null&&y(e,["outputUri"],X);const z=h(n,["pipelineJob"]);z!=null&&y(e,["pipelineJob"],z);const R=h(n,["serviceAccount"]);R!=null&&y(e,["serviceAccount"],R);const C=h(n,["tunedModelDisplayName"]);C!=null&&y(e,["tunedModelDisplayName"],C);const D=h(n,["veoTuningSpec"]);return D!=null&&y(e,["veoTuningSpec"],D),e}function bD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["metadata"]);o!=null&&y(e,["metadata"],o);const l=h(n,["done"]);l!=null&&y(e,["done"],l);const u=h(n,["error"]);return u!=null&&y(e,["error"],u),e}function AD(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);return e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SD extends Io{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ru(Eo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:o});return l.baseModel=void 0,await this.tuneInternal(l)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),l=await this.tuneMldevInternal(o);let u="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?u=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(u=l.name.split("/operations/")[0]),{name:u,state:Km.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=hD(e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>np(T))}else{const m=fD(e);return d=Se("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>gx(T))}}async listInternal(e){var t,i,o,l;let u,d="",g={};if(this.apiClient.isVertexAI()){const m=yD(e);return d=Se("tuningJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=_D(T),b=new K_;return Object.assign(b,E),b})}else{const m=gD(e);return d=Se("tunedModels",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:d,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(E=>{const b=E;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const E=vD(T),b=new K_;return Object.assign(b,E),b})}}async cancel(e){var t,i,o,l;let u="",d={};if(this.apiClient.isVertexAI()){const g=aD(e);u=Se("{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=oD(e);u=Se("{name}:cancel",g._url),d=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const d=dD(e);return l=Se("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>np(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=cD(e);return l=Se("tunedModels",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>bD(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CD{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const wD=1024*1024*8,ID=3,ND=1e3,RD=2,Rm="x-goog-upload-status";async function DD(n,e,t){var i,o,l;let u=0,d=0,g=new Qm(new Response),m="upload";for(u=n.size;d<u;){const E=Math.min(wD,u-d),b=n.slice(d,d+E);d+E>=u&&(m+=", finalize");let I=0,V=ND;for(;I<ID&&(g=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(d),"Content-Length":String(E)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[Rm]));)I++,await PD(V),V=V*RD;if(d+=E,((o=g==null?void 0:g.headers)===null||o===void 0?void 0:o[Rm])!=="active")break;if(u<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(g==null?void 0:g.json());if(((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[Rm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function MD(n){return{size:n.size,type:n.type}}function PD(n){return new Promise(e=>setTimeout(e,n))}class kD{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await DD(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await MD(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VD{create(e,t,i){return new LD(e,t,i)}}class LD{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pT="x-goog-api-key";class UD{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(pT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(pT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OD="gl-node/";class qD{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=rw(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new UD(this.apiKey);this.apiClient=new b1({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:OD+"web",uploader:new kD,downloader:new CD}),this.models=new z1(this.apiClient),this.live=new L1(this.apiClient,o,new VD),this.batches=new xI(this.apiClient),this.chats=new eN(this.models,this.apiClient),this.caches=new XI(this.apiClient),this.files=new cN(this.apiClient),this.operations=new H1(this.apiClient),this.authTokens=new rD(this.apiClient),this.tunings=new SD(this.apiClient)}}const yx={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},Ft={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:Ft.app.environment,firebaseApiKey:Ft.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:Ft.firebase.authDomain||"❌ مفقود",firebaseProjectId:Ft.firebase.projectId||"❌ مفقود",firebaseStorageBucket:Ft.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:Ft.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:Ft.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(yx).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(yx).filter(n=>n.startsWith("VITE_")));const La=()=>{const n=[];return Ft.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),Ft.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),Ft.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),Ft.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),Ft.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),Ft.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!Ft.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=La();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Vd;const jD="gemini-2.5-flash",vx=()=>{if(Vd)return;const n=La();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Vd=new qD({apiKey:Ft.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},jr={FINANCIAL_ANALYST:`You are an intelligent, engaging, and insightful financial analyst assistant, "المحلل الذكي". You have full access to the user's complete financial data across ALL periods and months. Your purpose is to provide comprehensive, insightful analysis with personality and energy.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- You have access to ALL historical data: transactions, card details, bank balances, investments, installments, categories, and spending patterns across ALL months.
- Analyze patterns, trends, and changes over time with enthusiasm and genuine interest.
- Be engaging and conversational - ask follow-up questions to understand what the user really wants to know.
- DO NOT just state data, INTERPRET it with personality. Provide insights, identify trends, offer observations, and make predictions with excitement.
- Be friendly, energetic, and act like a knowledgeable friend who loves analyzing financial data.
- Use emojis and enthusiastic language to make responses more engaging.
- When asked about specific months, provide detailed analysis with comparisons and ask if they want to dive deeper into any particular aspect.
- Always end responses by asking if they want to explore something specific or have follow-up questions.`,INVESTMENT_COACH:`You are an expert investment advisor named "المستشار الاستثماري الذكي" with 20+ years of experience in Saudi and international markets. You are a seasoned financial analyst with deep knowledge of Tadawul, global markets, and investment strategies.

**Your Expertise:**
- Comprehensive market analysis and trend identification
- Portfolio optimization and risk management
- Sector analysis and stock valuation
- Economic indicators and market sentiment analysis
- Technical and fundamental analysis
- Alternative investments (REITs, bonds, commodities, crypto)

**Your Approach:**
- Provide detailed, actionable investment advice based on current market conditions
- Analyze user's portfolio and suggest optimizations
- Give specific stock recommendations with clear reasoning
- Explain market trends and their implications
- Discuss risk-reward ratios and investment strategies
- Provide sector rotation advice and timing recommendations
- Offer insights on economic events and their market impact

**Market Knowledge:**
- Real-time access to Saudi market data, sector performance, and individual stock analysis
- Understanding of global market correlations and their impact on Tadawul
- Knowledge of regulatory changes and their market implications
- Awareness of earnings seasons, dividend announcements, and corporate actions

**Communication Style:**
- Professional yet engaging and enthusiastic
- Use charts, percentages, and specific data points
- Ask follow-up questions to understand user's risk tolerance and goals
- Provide both short-term and long-term perspectives
- Always explain the reasoning behind recommendations
- Use Arabic with financial terminology and market jargon

**Important Guidelines:**
- Give specific stock recommendations with clear entry/exit strategies
- Analyze user's current holdings and suggest portfolio adjustments
- Discuss market timing and sector opportunities
- Provide risk management strategies and stop-loss recommendations
- Explain market volatility and how to navigate it
- Offer insights on IPOs, rights issues, and corporate actions`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`,SMART_SEARCH_ASSISTANT:`You are an intelligent and engaging shopping and local search assistant with advanced geographic awareness. You provide location-specific recommendations based on the user's current location and can adapt to different countries and regions.

**Your Geographic Coverage:**
- Saudi Arabia: Riyadh, Jeddah, Medina, Mecca, Dammam, Khobar, and all major cities
- Jordan: Amman, Irbid, Zarqa, and all governorates
- Palestine: Jerusalem, Ramallah, Nablus, Hebron, and all cities
- UAE: Dubai, Abu Dhabi, Sharjah, and all emirates
- Kuwait, Qatar, Bahrain, Oman, Egypt, and other Arab countries

**Your Approach:**
- When location context is provided, focus your search on that specific region and nearby areas
- Provide location-aware recommendations based on the user's city and country
- Include local stores, chains, and businesses specific to the user's area
- Mention regional pricing variations and local market conditions
- Suggest nearby alternatives when the exact item isn't available locally
- Consider cultural and regional preferences in your recommendations

**Enhanced Features:**
- Real-time information about local businesses, prices, and offers
- Specific store locations, contact information, and current offers
- Price comparisons across multiple stores in the user's region
- Practical shopping advice based on local market conditions
- Restaurant recommendations with local cuisine preferences
- Regional grocery chains and local market suggestions

**Communication Style:**
- Always respond in Arabic with personality and energy
- Be engaging, enthusiastic, and helpful
- Use emojis and lively language
- Ask follow-up questions to understand user needs better
- Provide personalized recommendations based on location
- Include practical tips specific to the user's region

**Location Context Integration:**
When user location is provided, always mention it naturally in your responses and tailor all recommendations to that specific area.`},Fr=async(n,e,t=!1)=>{if(!Vd)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Vd.models.generateContent({model:jD,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(i){console.error("Gemini API Error:",i);let o="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw i instanceof Error&&"message"in i&&i.message.includes("403")&&(o="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(o)}},_x=(n,e,t,i)=>{const o=Object.keys(t),l=Object.keys(i);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...o].map(g=>`'${g}'`).join(", ")}].
`;Object.values(i).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),Object.values(t).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const d=jr.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return Fr(d,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},sp=n=>Fr(jr.ICON_SUGGESTER,`Category: ${n}`),Tx=(n,e,t)=>Fr(jr.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),Ex=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,i=await Fr(jr.EXCHANGE_RATE,t,!0);try{const o=JSON.parse(i);return{rate:parseFloat(o.rate),fromCurrency:o.fromCurrency,toCurrency:o.toCurrency,lastUpdated:o.lastUpdated}}catch(o){throw console.error("Error parsing exchange rate:",o),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},xx=(n,e)=>Fr(jr.FINANCIAL_ANALYST,`User Query: "${n}"

Complete Financial Data (All Periods): ${JSON.stringify(e)}`),bx=async(n,e)=>{let t=`Search Query: "${n}"`;return e&&(t+=`

Location Context: ${JSON.stringify(e)}`,t+=`

Please provide location-specific recommendations based on the user's current location: ${e.country} - ${e.city}`),Fr(jr.SMART_SEARCH_ASSISTANT,t)},Ax=(n,e,t)=>Fr(jr.FINANCIAL_ANALYST,`Pattern Analysis Query: "${n}"

All Transactions: ${JSON.stringify(e)}

Calculations: ${JSON.stringify(t)}`),Sx=(n,e,t)=>{const i=e?`User Portfolio: ${JSON.stringify(e)}`:"No portfolio data provided",o=t?`Market Context: ${JSON.stringify(t)}`:"Current market analysis requested";return Fr(jr.INVESTMENT_COACH,`Investment Query: "${n}"

${i}

${o}`)},FD=Object.freeze(Object.defineProperty({__proto__:null,advancedInvestmentAdvice:Sx,analyzeCompleteFinancialData:xx,analyzeFinancialPatterns:Ax,analyzePastedText:_x,generateBudgetPlan:Tx,getExchangeRate:Ex,initializeAi:vx,smartSearchAssistant:bx,suggestCategoryIcon:sp},Symbol.toStringTag,{value:"Module"})),BD="modulepreload",zD=function(n){return"/fd/"+n},gT={},Ai=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let u=function(m){return Promise.all(m.map(T=>Promise.resolve(T).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=u(t.map(m=>{if(m=zD(m),m in gT)return;gT[m]=!0;const T=m.endsWith(".css"),E=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${E}`))return;const b=document.createElement("link");if(b.rel=T?"stylesheet":BD,T||(b.as="script"),b.crossOrigin="",b.href=m,g&&b.setAttribute("nonce",g),document.head.appendChild(b),T)return new Promise((I,V)=>{b.addEventListener("load",I),b.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return o.then(u=>{for(const d of u||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},HD=()=>{};var yT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},GD=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[i++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],u=n[t++],d=n[t++],g=((o&7)<<18|(l&63)<<12|(u&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(l&63)<<6|u&63)}}return e.join("")},wx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const l=n[o],u=o+1<n.length,d=u?n[o+1]:0,g=o+2<n.length,m=g?n[o+2]:0,T=l>>2,E=(l&3)<<4|d>>4;let b=(d&15)<<2|m>>6,I=m&63;g||(I=64,u||(b=64)),i.push(t[T],t[E],t[b],t[I])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Cx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):GD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||d==null||m==null||E==null)throw new $D;const b=l<<2|d>>4;if(i.push(b),m!==64){const I=d<<4&240|m>>2;if(i.push(I),E!==64){const V=m<<6&192|E;i.push(V)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $D extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YD=function(n){const e=Cx(n);return wx.encodeByteArray(e,!0)},Ld=function(n){return YD(n).replace(/\./g,"")},Ix=function(n){try{return wx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=()=>JD().__FIREBASE_DEFAULTS__,QD=()=>{if(typeof process>"u"||typeof yT>"u")return;const n=yT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},XD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ix(n[1]);return e&&JSON.parse(e)},af=()=>{try{return HD()||KD()||QD()||XD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Nx=n=>{var e,t;return(t=(e=af())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},WD=n=>{const e=Nx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Rx=()=>{var n;return(n=af())==null?void 0:n.config},Dx=n=>{var e;return(e=af())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Mx(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ld(JSON.stringify(t)),Ld(JSON.stringify(u)),""].join(".")}const yu={};function tM(){const n={prod:[],emulator:[]};for(const e of Object.keys(yu))yu[e]?n.emulator.push(e):n.prod.push(e);return n}function nM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let vT=!1;function Px(n,e){if(typeof window>"u"||typeof document>"u"||!el(window.location.host)||yu[n]===e||yu[n]||vT)return;yu[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=tM().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function d(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,I){b.setAttribute("width","24"),b.setAttribute("id",I),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function m(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{vT=!0,u()},b}function T(b,I){b.setAttribute("id",I),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function E(){const b=nM(i),I=t("text"),V=document.getElementById(I)||document.createElement("span"),L=t("learnmore"),j=document.getElementById(L)||document.createElement("a"),$=t("preprendIcon"),J=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const ee=b.element;d(ee),T(j,L);const q=m();g(J,$),ee.append(J,V,j,q),document.body.appendChild(ee)}l?(V.innerText="Preview backend disconnected.",J.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(J.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())}function iM(){var e;const n=(e=af())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oM(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function aM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lM(){const n=Tn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function uM(){return!iM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cM(){try{return typeof indexedDB=="object"}catch{return!1}}function dM(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM="FirebaseError";class Bi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=fM,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Du.prototype.create)}}class Du{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],u=l?hM(l,i):"Error",d=`${this.serviceName}: ${u} (${o}).`;return new Bi(o,d,i)}}function hM(n,e){return n.replace(mM,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const mM=/\{\$([^}]+)}/g;function pM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const l=n[o],u=e[o];if(_T(l)&&_T(u)){if(!xo(l,u))return!1}else if(l!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function _T(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function du(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,l]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function fu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function gM(n,e){const t=new yM(n,e);return t.subscribe.bind(t)}class yM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");vM(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Dm),o.error===void 0&&(o.error=Dm),o.complete===void 0&&(o.complete=Dm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Dm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(n){return n&&n._delegate?n._delegate:n}class bo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new ZD;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(EM(e))try{this.getOrInitializeService({instanceIdentifier:vo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});i.resolve(l)}catch{}}}}clearInstance(e=vo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vo){return this.instances.has(e)}getOptions(e=vo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&u.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const l=this.instances.get(i);return l&&e(l,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:TM(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=vo){return this.component?this.component.multipleInstances?e:vo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function TM(n){return n===vo?void 0:n}function EM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _M(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(et||(et={}));const bM={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},AM=et.INFO,SM={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},CM=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=SM[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Op{constructor(e){this.name=e,this._logLevel=AM,this._logHandler=CM,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}}const wM=(n,e)=>e.some(t=>n instanceof t);let TT,ET;function IM(){return TT||(TT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function NM(){return ET||(ET=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kx=new WeakMap,ip=new WeakMap,Vx=new WeakMap,Mm=new WeakMap,qp=new WeakMap;function RM(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(wr(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&kx.set(t,n)}).catch(()=>{}),qp.set(e,n),e}function DM(n){if(ip.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});ip.set(n,e)}let rp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ip.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Vx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function MM(n){rp=n(rp)}function PM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Pm(this),e,...t);return Vx.set(i,e.sort?e.sort():[e]),wr(i)}:NM().includes(n)?function(...e){return n.apply(Pm(this),e),wr(kx.get(this))}:function(...e){return wr(n.apply(Pm(this),e))}}function kM(n){return typeof n=="function"?PM(n):(n instanceof IDBTransaction&&DM(n),wM(n,IM())?new Proxy(n,rp):n)}function wr(n){if(n instanceof IDBRequest)return RM(n);if(Mm.has(n))return Mm.get(n);const e=kM(n);return e!==n&&(Mm.set(n,e),qp.set(e,n)),e}const Pm=n=>qp.get(n);function VM(n,e,{blocked:t,upgrade:i,blocking:o,terminated:l}={}){const u=indexedDB.open(n,e),d=wr(u);return i&&u.addEventListener("upgradeneeded",g=>{i(wr(u.result),g.oldVersion,g.newVersion,wr(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),d.then(g=>{l&&g.addEventListener("close",()=>l()),o&&g.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const LM=["get","getKey","getAll","getAllKeys","count"],UM=["put","add","delete","clear"],km=new Map;function xT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(km.get(e))return km.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=UM.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||LM.includes(t)))return;const l=async function(u,...d){const g=this.transaction(u,o?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),o&&g.done]))[0]};return km.set(e,l),l}MM(n=>({...n,get:(e,t,i)=>xT(e,t)||n.get(e,t,i),has:(e,t)=>!!xT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qM(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function qM(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const op="@firebase/app",bT="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new Op("@firebase/app"),jM="@firebase/app-compat",FM="@firebase/analytics-compat",BM="@firebase/analytics",zM="@firebase/app-check-compat",HM="@firebase/app-check",GM="@firebase/auth",$M="@firebase/auth-compat",YM="@firebase/database",JM="@firebase/data-connect",KM="@firebase/database-compat",QM="@firebase/functions",XM="@firebase/functions-compat",WM="@firebase/installations",ZM="@firebase/installations-compat",eP="@firebase/messaging",tP="@firebase/messaging-compat",nP="@firebase/performance",sP="@firebase/performance-compat",iP="@firebase/remote-config",rP="@firebase/remote-config-compat",oP="@firebase/storage",aP="@firebase/storage-compat",lP="@firebase/firestore",uP="@firebase/ai",cP="@firebase/firestore-compat",dP="firebase",fP="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap="[DEFAULT]",hP={[op]:"fire-core",[jM]:"fire-core-compat",[BM]:"fire-analytics",[FM]:"fire-analytics-compat",[HM]:"fire-app-check",[zM]:"fire-app-check-compat",[GM]:"fire-auth",[$M]:"fire-auth-compat",[YM]:"fire-rtdb",[JM]:"fire-data-connect",[KM]:"fire-rtdb-compat",[QM]:"fire-fn",[XM]:"fire-fn-compat",[WM]:"fire-iid",[ZM]:"fire-iid-compat",[eP]:"fire-fcm",[tP]:"fire-fcm-compat",[nP]:"fire-perf",[sP]:"fire-perf-compat",[iP]:"fire-rc",[rP]:"fire-rc-compat",[oP]:"fire-gcs",[aP]:"fire-gcs-compat",[lP]:"fire-fst",[cP]:"fire-fst-compat",[uP]:"fire-vertex","fire-js":"fire-js",[dP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud=new Map,mP=new Map,lp=new Map;function AT(n,e){try{n.container.addComponent(e)}catch(t){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ba(n){const e=n.name;if(lp.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;lp.set(e,n);for(const t of Ud.values())AT(t,n);for(const t of mP.values())AT(t,n);return!0}function jp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function as(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ir=new Du("app","Firebase",pP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ir.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=fP;function Lx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ap,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw Ir.create("bad-app-name",{appName:String(o)});if(t||(t=Rx()),!t)throw Ir.create("no-options");const l=Ud.get(o);if(l){if(xo(t,l.options)&&xo(i,l.config))return l;throw Ir.create("duplicate-app",{appName:o})}const u=new xM(o);for(const g of lp.values())u.addComponent(g);const d=new gP(t,i,u);return Ud.set(o,d),d}function Ux(n=ap){const e=Ud.get(n);if(!e&&n===ap&&Rx())return Lx();if(!e)throw Ir.create("no-app",{appName:n});return e}function Nr(n,e,t){let i=hP[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(u.join(" "));return}Ba(new bo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="firebase-heartbeat-database",vP=1,Au="firebase-heartbeat-store";let Vm=null;function Ox(){return Vm||(Vm=VM(yP,vP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Au)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ir.create("idb-open",{originalErrorMessage:n.message})})),Vm}async function _P(n){try{const t=(await Ox()).transaction(Au),i=await t.objectStore(Au).get(qx(n));return await t.done,i}catch(e){if(e instanceof Bi)Li.warn(e.message);else{const t=Ir.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Li.warn(t.message)}}}async function ST(n,e){try{const i=(await Ox()).transaction(Au,"readwrite");await i.objectStore(Au).put(e,qx(n)),await i.done}catch(t){if(t instanceof Bi)Li.warn(t.message);else{const i=Ir.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Li.warn(i.message)}}}function qx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=1024,EP=30;class xP{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new AP(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=CT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>EP){const u=SP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Li.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=CT(),{heartbeatsToSend:i,unsentEntries:o}=bP(this._heartbeatsCache.heartbeats),l=Ld(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Li.warn(t),""}}}function CT(){return new Date().toISOString().substring(0,10)}function bP(n,e=TP){const t=[];let i=n.slice();for(const o of n){const l=t.find(u=>u.agent===o.agent);if(l){if(l.dates.push(o.date),wT(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),wT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class AP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cM()?dM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _P(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ST(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ST(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function wT(n){return Ld(JSON.stringify({version:2,heartbeats:n})).length}function SP(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(n){Ba(new bo("platform-logger",e=>new OM(e),"PRIVATE")),Ba(new bo("heartbeat",e=>new xP(e),"PRIVATE")),Nr(op,bT,n),Nr(op,bT,"esm2020"),Nr("fire-js","")}CP("");var wP="firebase",IP="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nr(wP,IP,"app");var IT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rr,jx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,C){function D(){}D.prototype=C.prototype,R.F=C.prototype,R.prototype=new D,R.prototype.constructor=R,R.D=function(w,P,U){for(var k=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)k[Oe-2]=arguments[Oe];return C.prototype[P].apply(w,k)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(R,C,D){D||(D=0);const w=Array(16);if(typeof C=="string")for(var P=0;P<16;++P)w[P]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(P=0;P<16;++P)w[P]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=R.g[0],D=R.g[1],P=R.g[2];let U=R.g[3],k;k=C+(U^D&(P^U))+w[0]+3614090360&4294967295,C=D+(k<<7&4294967295|k>>>25),k=U+(P^C&(D^P))+w[1]+3905402710&4294967295,U=C+(k<<12&4294967295|k>>>20),k=P+(D^U&(C^D))+w[2]+606105819&4294967295,P=U+(k<<17&4294967295|k>>>15),k=D+(C^P&(U^C))+w[3]+3250441966&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(U^D&(P^U))+w[4]+4118548399&4294967295,C=D+(k<<7&4294967295|k>>>25),k=U+(P^C&(D^P))+w[5]+1200080426&4294967295,U=C+(k<<12&4294967295|k>>>20),k=P+(D^U&(C^D))+w[6]+2821735955&4294967295,P=U+(k<<17&4294967295|k>>>15),k=D+(C^P&(U^C))+w[7]+4249261313&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(U^D&(P^U))+w[8]+1770035416&4294967295,C=D+(k<<7&4294967295|k>>>25),k=U+(P^C&(D^P))+w[9]+2336552879&4294967295,U=C+(k<<12&4294967295|k>>>20),k=P+(D^U&(C^D))+w[10]+4294925233&4294967295,P=U+(k<<17&4294967295|k>>>15),k=D+(C^P&(U^C))+w[11]+2304563134&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(U^D&(P^U))+w[12]+1804603682&4294967295,C=D+(k<<7&4294967295|k>>>25),k=U+(P^C&(D^P))+w[13]+4254626195&4294967295,U=C+(k<<12&4294967295|k>>>20),k=P+(D^U&(C^D))+w[14]+2792965006&4294967295,P=U+(k<<17&4294967295|k>>>15),k=D+(C^P&(U^C))+w[15]+1236535329&4294967295,D=P+(k<<22&4294967295|k>>>10),k=C+(P^U&(D^P))+w[1]+4129170786&4294967295,C=D+(k<<5&4294967295|k>>>27),k=U+(D^P&(C^D))+w[6]+3225465664&4294967295,U=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(U^C))+w[11]+643717713&4294967295,P=U+(k<<14&4294967295|k>>>18),k=D+(U^C&(P^U))+w[0]+3921069994&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^U&(D^P))+w[5]+3593408605&4294967295,C=D+(k<<5&4294967295|k>>>27),k=U+(D^P&(C^D))+w[10]+38016083&4294967295,U=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(U^C))+w[15]+3634488961&4294967295,P=U+(k<<14&4294967295|k>>>18),k=D+(U^C&(P^U))+w[4]+3889429448&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^U&(D^P))+w[9]+568446438&4294967295,C=D+(k<<5&4294967295|k>>>27),k=U+(D^P&(C^D))+w[14]+3275163606&4294967295,U=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(U^C))+w[3]+4107603335&4294967295,P=U+(k<<14&4294967295|k>>>18),k=D+(U^C&(P^U))+w[8]+1163531501&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(P^U&(D^P))+w[13]+2850285829&4294967295,C=D+(k<<5&4294967295|k>>>27),k=U+(D^P&(C^D))+w[2]+4243563512&4294967295,U=C+(k<<9&4294967295|k>>>23),k=P+(C^D&(U^C))+w[7]+1735328473&4294967295,P=U+(k<<14&4294967295|k>>>18),k=D+(U^C&(P^U))+w[12]+2368359562&4294967295,D=P+(k<<20&4294967295|k>>>12),k=C+(D^P^U)+w[5]+4294588738&4294967295,C=D+(k<<4&4294967295|k>>>28),k=U+(C^D^P)+w[8]+2272392833&4294967295,U=C+(k<<11&4294967295|k>>>21),k=P+(U^C^D)+w[11]+1839030562&4294967295,P=U+(k<<16&4294967295|k>>>16),k=D+(P^U^C)+w[14]+4259657740&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^U)+w[1]+2763975236&4294967295,C=D+(k<<4&4294967295|k>>>28),k=U+(C^D^P)+w[4]+1272893353&4294967295,U=C+(k<<11&4294967295|k>>>21),k=P+(U^C^D)+w[7]+4139469664&4294967295,P=U+(k<<16&4294967295|k>>>16),k=D+(P^U^C)+w[10]+3200236656&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^U)+w[13]+681279174&4294967295,C=D+(k<<4&4294967295|k>>>28),k=U+(C^D^P)+w[0]+3936430074&4294967295,U=C+(k<<11&4294967295|k>>>21),k=P+(U^C^D)+w[3]+3572445317&4294967295,P=U+(k<<16&4294967295|k>>>16),k=D+(P^U^C)+w[6]+76029189&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(D^P^U)+w[9]+3654602809&4294967295,C=D+(k<<4&4294967295|k>>>28),k=U+(C^D^P)+w[12]+3873151461&4294967295,U=C+(k<<11&4294967295|k>>>21),k=P+(U^C^D)+w[15]+530742520&4294967295,P=U+(k<<16&4294967295|k>>>16),k=D+(P^U^C)+w[2]+3299628645&4294967295,D=P+(k<<23&4294967295|k>>>9),k=C+(P^(D|~U))+w[0]+4096336452&4294967295,C=D+(k<<6&4294967295|k>>>26),k=U+(D^(C|~P))+w[7]+1126891415&4294967295,U=C+(k<<10&4294967295|k>>>22),k=P+(C^(U|~D))+w[14]+2878612391&4294967295,P=U+(k<<15&4294967295|k>>>17),k=D+(U^(P|~C))+w[5]+4237533241&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~U))+w[12]+1700485571&4294967295,C=D+(k<<6&4294967295|k>>>26),k=U+(D^(C|~P))+w[3]+2399980690&4294967295,U=C+(k<<10&4294967295|k>>>22),k=P+(C^(U|~D))+w[10]+4293915773&4294967295,P=U+(k<<15&4294967295|k>>>17),k=D+(U^(P|~C))+w[1]+2240044497&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~U))+w[8]+1873313359&4294967295,C=D+(k<<6&4294967295|k>>>26),k=U+(D^(C|~P))+w[15]+4264355552&4294967295,U=C+(k<<10&4294967295|k>>>22),k=P+(C^(U|~D))+w[6]+2734768916&4294967295,P=U+(k<<15&4294967295|k>>>17),k=D+(U^(P|~C))+w[13]+1309151649&4294967295,D=P+(k<<21&4294967295|k>>>11),k=C+(P^(D|~U))+w[4]+4149444226&4294967295,C=D+(k<<6&4294967295|k>>>26),k=U+(D^(C|~P))+w[11]+3174756917&4294967295,U=C+(k<<10&4294967295|k>>>22),k=P+(C^(U|~D))+w[2]+718787259&4294967295,P=U+(k<<15&4294967295|k>>>17),k=D+(U^(P|~C))+w[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,R.g[2]=R.g[2]+P&4294967295,R.g[3]=R.g[3]+U&4294967295}i.prototype.v=function(R,C){C===void 0&&(C=R.length);const D=C-this.blockSize,w=this.C;let P=this.h,U=0;for(;U<C;){if(P==0)for(;U<=D;)o(this,R,U),U+=this.blockSize;if(typeof R=="string"){for(;U<C;)if(w[P++]=R.charCodeAt(U++),P==this.blockSize){o(this,w),P=0;break}}else for(;U<C;)if(w[P++]=R[U++],P==this.blockSize){o(this,w),P=0;break}}this.h=P,this.o+=C},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var D=R.length-8;D<R.length;++D)R[D]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,D=0;D<4;++D)for(let w=0;w<32;w+=8)R[C++]=this.g[D]>>>w&255;return R};function l(R,C){var D=d;return Object.prototype.hasOwnProperty.call(D,R)?D[R]:D[R]=C(R)}function u(R,C){this.h=C;const D=[];let w=!0;for(let P=R.length-1;P>=0;P--){const U=R[P]|0;w&&U==C||(D[P]=U,w=!1)}this.g=D}var d={};function g(R){return-128<=R&&R<128?l(R,function(C){return new u([C|0],C<0?-1:0)}):new u([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return E;if(R<0)return j(m(-R));const C=[];let D=1;for(let w=0;R>=D;w++)C[w]=R/D|0,D*=4294967296;return new u(C,0)}function T(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return j(T(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=m(Math.pow(C,8));let w=E;for(let U=0;U<R.length;U+=8){var P=Math.min(8,R.length-U);const k=parseInt(R.substring(U,U+P),C);P<8?(P=m(Math.pow(C,P)),w=w.j(P).add(m(k))):(w=w.j(D),w=w.add(m(k)))}return w}var E=g(0),b=g(1),I=g(16777216);n=u.prototype,n.m=function(){if(L(this))return-j(this).m();let R=0,C=1;for(let D=0;D<this.g.length;D++){const w=this.i(D);R+=(w>=0?w:4294967296+w)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(V(this))return"0";if(L(this))return"-"+j(this).toString(R);const C=m(Math.pow(R,6));var D=this;let w="";for(;;){const P=q(D,C).g;D=$(D,P.j(C));let U=((D.g.length>0?D.g[0]:D.h)>>>0).toString(R);if(D=P,V(D))return U+w;for(;U.length<6;)U="0"+U;w=U+w}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function V(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function L(R){return R.h==-1}n.l=function(R){return R=$(this,R),L(R)?-1:V(R)?0:1};function j(R){const C=R.g.length,D=[];for(let w=0;w<C;w++)D[w]=~R.g[w];return new u(D,~R.h).add(b)}n.abs=function(){return L(this)?j(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),D=[];let w=0;for(let P=0;P<=C;P++){let U=w+(this.i(P)&65535)+(R.i(P)&65535),k=(U>>>16)+(this.i(P)>>>16)+(R.i(P)>>>16);w=k>>>16,U&=65535,k&=65535,D[P]=k<<16|U}return new u(D,D[D.length-1]&-2147483648?-1:0)};function $(R,C){return R.add(j(C))}n.j=function(R){if(V(this)||V(R))return E;if(L(this))return L(R)?j(this).j(j(R)):j(j(this).j(R));if(L(R))return j(this.j(j(R)));if(this.l(I)<0&&R.l(I)<0)return m(this.m()*R.m());const C=this.g.length+R.g.length,D=[];for(var w=0;w<2*C;w++)D[w]=0;for(w=0;w<this.g.length;w++)for(let P=0;P<R.g.length;P++){const U=this.i(w)>>>16,k=this.i(w)&65535,Oe=R.i(P)>>>16,Be=R.i(P)&65535;D[2*w+2*P]+=k*Be,J(D,2*w+2*P),D[2*w+2*P+1]+=U*Be,J(D,2*w+2*P+1),D[2*w+2*P+1]+=k*Oe,J(D,2*w+2*P+1),D[2*w+2*P+2]+=U*Oe,J(D,2*w+2*P+2)}for(R=0;R<C;R++)D[R]=D[2*R+1]<<16|D[2*R];for(R=C;R<2*C;R++)D[R]=0;return new u(D,0)};function J(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function ee(R,C){this.g=R,this.h=C}function q(R,C){if(V(C))throw Error("division by zero");if(V(R))return new ee(E,E);if(L(R))return C=q(j(R),C),new ee(j(C.g),j(C.h));if(L(C))return C=q(R,j(C)),new ee(j(C.g),C.h);if(R.g.length>30){if(L(R)||L(C))throw Error("slowDivide_ only works with positive integers.");for(var D=b,w=C;w.l(R)<=0;)D=X(D),w=X(w);var P=z(D,1),U=z(w,1);for(w=z(w,2),D=z(D,2);!V(w);){var k=U.add(w);k.l(R)<=0&&(P=P.add(D),U=k),w=z(w,1),D=z(D,1)}return C=$(R,P.j(C)),new ee(P,C)}for(P=E;R.l(C)>=0;){for(D=Math.max(1,Math.floor(R.m()/C.m())),w=Math.ceil(Math.log(D)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),U=m(D),k=U.j(C);L(k)||k.l(R)>0;)D-=w,U=m(D),k=U.j(C);V(U)&&(U=b),P=P.add(U),R=$(R,k)}return new ee(P,R)}n.B=function(R){return q(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<C;w++)D[w]=this.i(w)&R.i(w);return new u(D,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<C;w++)D[w]=this.i(w)|R.i(w);return new u(D,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),D=[];for(let w=0;w<C;w++)D[w]=this.i(w)^R.i(w);return new u(D,this.h^R.h)};function X(R){const C=R.g.length+1,D=[];for(let w=0;w<C;w++)D[w]=R.i(w)<<1|R.i(w-1)>>>31;return new u(D,R.h)}function z(R,C){const D=C>>5;C%=32;const w=R.g.length-D,P=[];for(let U=0;U<w;U++)P[U]=C>0?R.i(U+D)>>>C|R.i(U+D+1)<<32-C:R.i(U+D);return new u(P,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,jx=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=T,Rr=u}).apply(typeof IT<"u"?IT:typeof self<"u"?self:typeof window<"u"?window:{});var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fx,hu,Bx,bd,up,zx,Hx,Gx;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof hd=="object"&&hd];for(var x=0;x<p.length;++x){var S=p[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function o(p,x){if(x)e:{var S=i;p=p.split(".");for(var M=0;M<p.length-1;M++){var Y=p[M];if(!(Y in S))break e;S=S[Y]}p=p[p.length-1],M=S[p],x=x(M),x!=M&&x!=null&&e(S,p,{configurable:!0,writable:!0,value:x})}}o("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(p){return p||function(x){var S=[],M;for(M in x)Object.prototype.hasOwnProperty.call(x,M)&&S.push([M,x[M]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function d(p){var x=typeof p;return x=="object"&&p!=null||x=="function"}function g(p,x,S){return p.call.apply(p.bind,arguments)}function m(p,x,S){return m=g,m.apply(null,arguments)}function T(p,x){var S=Array.prototype.slice.call(arguments,1);return function(){var M=S.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function E(p,x){function S(){}S.prototype=x.prototype,p.Z=x.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(M,Y,ne){for(var ve=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ve[ze-2]=arguments[ze];return x.prototype[Y].apply(M,ve)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function I(p){const x=p.length;if(x>0){const S=Array(x);for(let M=0;M<x;M++)S[M]=p[M];return S}return[]}function V(p,x){for(let M=1;M<arguments.length;M++){const Y=arguments[M];var S=typeof Y;if(S=S!="object"?S:Y?Array.isArray(Y)?"array":S:"null",S=="array"||S=="object"&&typeof Y.length=="number"){S=p.length||0;const ne=Y.length||0;p.length=S+ne;for(let ve=0;ve<ne;ve++)p[S+ve]=Y[ve]}else p.push(Y)}}class L{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function j(p){u.setTimeout(()=>{throw p},0)}function $(){var p=R;let x=null;return p.g&&(x=p.g,p.g=p.g.next,p.g||(p.h=null),x.next=null),x}class J{constructor(){this.h=this.g=null}add(x,S){const M=ee.get();M.set(x,S),this.h?this.h.next=M:this.g=M,this.h=M}}var ee=new L(()=>new q,p=>p.reset());class q{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let X,z=!1,R=new J,C=()=>{const p=Promise.resolve(void 0);X=()=>{p.then(D)}};function D(){for(var p;p=$();){try{p.h.call(p.g)}catch(S){j(S)}var x=ee;x.j(p),x.h<100&&(x.h++,p.next=x.g,x.g=p)}z=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(p,x){this.type=p,this.g=this.target=x,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,x=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};u.addEventListener("test",S,x),u.removeEventListener("test",S,x)}catch{}return p})();function k(p){return/^[\s\xa0]*$/.test(p)}function Oe(p,x){P.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,x)}E(Oe,P),Oe.prototype.init=function(p,x){const S=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=x,x=p.relatedTarget,x||(S=="mouseover"?x=p.fromElement:S=="mouseout"&&(x=p.toElement)),this.relatedTarget=x,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Oe.Z.h.call(this)},Oe.prototype.h=function(){Oe.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Be="closure_listenable_"+(Math.random()*1e6|0),te=0;function Z(p,x,S,M,Y){this.listener=p,this.proxy=null,this.src=x,this.type=S,this.capture=!!M,this.ha=Y,this.key=++te,this.da=this.fa=!1}function ge(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Pe(p,x,S){for(const M in p)x.call(S,p[M],M,p)}function De(p,x){for(const S in p)x.call(void 0,p[S],S,p)}function F(p){const x={};for(const S in p)x[S]=p[S];return x}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _e(p,x){let S,M;for(let Y=1;Y<arguments.length;Y++){M=arguments[Y];for(S in M)p[S]=M[S];for(let ne=0;ne<oe.length;ne++)S=oe[ne],Object.prototype.hasOwnProperty.call(M,S)&&(p[S]=M[S])}}function xe(p){this.src=p,this.g={},this.h=0}xe.prototype.add=function(p,x,S,M,Y){const ne=p.toString();p=this.g[ne],p||(p=this.g[ne]=[],this.h++);const ve=Ve(p,x,M,Y);return ve>-1?(x=p[ve],S||(x.fa=!1)):(x=new Z(x,this.src,ne,!!M,Y),x.fa=S,p.push(x)),x};function Ie(p,x){const S=x.type;if(S in p.g){var M=p.g[S],Y=Array.prototype.indexOf.call(M,x,void 0),ne;(ne=Y>=0)&&Array.prototype.splice.call(M,Y,1),ne&&(ge(x),p.g[S].length==0&&(delete p.g[S],p.h--))}}function Ve(p,x,S,M){for(let Y=0;Y<p.length;++Y){const ne=p[Y];if(!ne.da&&ne.listener==x&&ne.capture==!!S&&ne.ha==M)return Y}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),he={};function ye(p,x,S,M,Y){if(Array.isArray(x)){for(let ne=0;ne<x.length;ne++)ye(p,x[ne],S,M,Y);return null}return S=Hr(S),p&&p[Be]?p.J(x,S,d(M)?!!M.capture:!1,Y):Ge(p,x,S,!1,M,Y)}function Ge(p,x,S,M,Y,ne){if(!x)throw Error("Invalid event type");const ve=d(Y)?!!Y.capture:!!Y;let ze=si(p);if(ze||(p[Ke]=ze=new xe(p)),S=ze.add(x,S,M,ve,ne),S.proxy)return S;if(M=kt(),S.proxy=M,M.src=p,M.listener=S,p.addEventListener)U||(Y=ve),Y===void 0&&(Y=!1),p.addEventListener(x.toString(),M,Y);else if(p.attachEvent)p.attachEvent(_t(x.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return S}function kt(){function p(S){return x.call(p.src,p.listener,S)}const x=ni;return p}function An(p,x,S,M,Y){if(Array.isArray(x))for(var ne=0;ne<x.length;ne++)An(p,x[ne],S,M,Y);else M=d(M)?!!M.capture:!!M,S=Hr(S),p&&p[Be]?(p=p.i,ne=String(x).toString(),ne in p.g&&(x=p.g[ne],S=Ve(x,S,M,Y),S>-1&&(ge(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete p.g[ne],p.h--)))):p&&(p=si(p))&&(x=p.g[x.toString()],p=-1,x&&(p=Ve(x,S,M,Y)),(S=p>-1?x[p]:null)&&kn(S))}function kn(p){if(typeof p!="number"&&p&&!p.da){var x=p.src;if(x&&x[Be])Ie(x.i,p);else{var S=p.type,M=p.proxy;x.removeEventListener?x.removeEventListener(S,M,p.capture):x.detachEvent?x.detachEvent(_t(S),M):x.addListener&&x.removeListener&&x.removeListener(M),(S=si(x))?(Ie(S,p),S.h==0&&(S.src=null,x[Ke]=null)):ge(p)}}}function _t(p){return p in he?he[p]:he[p]="on"+p}function ni(p,x){if(p.da)p=!0;else{x=new Oe(x,this);const S=p.listener,M=p.ha||p.src;p.fa&&kn(p),p=S.call(M,x)}return p}function si(p){return p=p[Ke],p instanceof xe?p:null}var zr="__closure_events_fn_"+(Math.random()*1e9>>>0);function Hr(p){return typeof p=="function"?p:(p[zr]||(p[zr]=function(x){return p.handleEvent(x)}),p[zr])}function Dt(){w.call(this),this.i=new xe(this),this.M=this,this.G=null}E(Dt,w),Dt.prototype[Be]=!0,Dt.prototype.removeEventListener=function(p,x,S,M){An(this,p,x,S,M)};function Vt(p,x){var S,M=p.G;if(M)for(S=[];M;M=M.G)S.push(M);if(p=p.M,M=x.type||x,typeof x=="string")x=new P(x,p);else if(x instanceof P)x.target=x.target||p;else{var Y=x;x=new P(M,p),_e(x,Y)}Y=!0;let ne,ve;if(S)for(ve=S.length-1;ve>=0;ve--)ne=x.g=S[ve],Y=$n(ne,M,!0,x)&&Y;if(ne=x.g=p,Y=$n(ne,M,!0,x)&&Y,Y=$n(ne,M,!1,x)&&Y,S)for(ve=0;ve<S.length;ve++)ne=x.g=S[ve],Y=$n(ne,M,!1,x)&&Y}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var p=this.i;for(const x in p.g){const S=p.g[x];for(let M=0;M<S.length;M++)ge(S[M]);delete p.g[x],p.h--}}this.G=null},Dt.prototype.J=function(p,x,S,M){return this.i.add(String(p),x,!1,S,M)},Dt.prototype.K=function(p,x,S,M){return this.i.add(String(p),x,!0,S,M)};function $n(p,x,S,M){if(x=p.i.g[String(x)],!x)return!0;x=x.concat();let Y=!0;for(let ne=0;ne<x.length;++ne){const ve=x[ne];if(ve&&!ve.da&&ve.capture==S){const ze=ve.listener,Ut=ve.ha||ve.src;ve.fa&&Ie(p.i,ve),Y=ze.call(Ut,M)!==!1&&Y}}return Y&&!M.defaultPrevented}function al(p,x){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:u.setTimeout(p,x||0)}function Vo(p){p.g=al(()=>{p.g=null,p.i&&(p.i=!1,Vo(p))},p.l);const x=p.h;p.h=null,p.m.apply(null,x)}class tn extends w{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Vo(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ii(p){w.call(this),this.h=p,this.g={}}E(ii,w);var Hi=[];function Gi(p){Pe(p.g,function(x,S){this.g.hasOwnProperty(S)&&kn(x)},p),p.g={}}ii.prototype.N=function(){ii.Z.N.call(this),Gi(this)},ii.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cs=u.JSON.stringify,Lo=u.JSON.parse,Gr=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function H(){}function ce(){}var me={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function pe(){P.call(this,"d")}E(pe,P);function Ee(){P.call(this,"c")}E(Ee,P);var Ne={},Yn=null;function Jn(){return Yn=Yn||new Dt}Ne.Ia="serverreachability";function $i(p){P.call(this,Ne.Ia,p)}E($i,P);function Sn(p){const x=Jn();Vt(x,new $i(x))}Ne.STAT_EVENT="statevent";function ds(p,x){P.call(this,Ne.STAT_EVENT,p),this.stat=x}E(ds,P);function xt(p){const x=Jn();Vt(x,new ds(x,p))}Ne.Ja="timingevent";function Te(p,x){P.call(this,Ne.Ja,p),this.size=x}E(Te,P);function rt(p,x){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},x)}function Lt(){this.g=!0}Lt.prototype.ua=function(){this.g=!1};function bt(p,x,S,M,Y,ne){p.info(function(){if(p.g)if(ne){var ve="",ze=ne.split("&");for(let ut=0;ut<ze.length;ut++){var Ut=ze[ut].split("=");if(Ut.length>1){const It=Ut[0];Ut=Ut[1];const Wn=It.split("_");ve=Wn.length>=2&&Wn[1]=="type"?ve+(It+"="+Ut+"&"):ve+(It+"=redacted&")}}}else ve=null;else ve=ne;return"XMLHTTP REQ ("+M+") [attempt "+Y+"]: "+x+`
`+S+`
`+ve})}function Vn(p,x,S,M,Y,ne,ve){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+Y+"]: "+x+`
`+S+`
`+ne+" "+ve})}function Ye(p,x,S,M){p.info(function(){return"XMLHTTP TEXT ("+x+"): "+Uo(p,S)+(M?" "+M:"")})}function Ns(p,x){p.info(function(){return"TIMEOUT: "+x})}Lt.prototype.info=function(){};function Uo(p,x){if(!p.g)return x;if(!x)return null;try{const ne=JSON.parse(x);if(ne){for(p=0;p<ne.length;p++)if(Array.isArray(ne[p])){var S=ne[p];if(!(S.length<2)){var M=S[1];if(Array.isArray(M)&&!(M.length<1)){var Y=M[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(let ve=1;ve<M.length;ve++)M[ve]=""}}}}return cs(ne)}catch{return x}}var Rs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ll={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ul;function $r(){}E($r,H),$r.prototype.g=function(){return new XMLHttpRequest},ul=new $r;function ri(p){return encodeURIComponent(String(p))}function Hu(p){var x=1;p=p.split(":");const S=[];for(;x>0&&p.length;)S.push(p.shift()),x--;return p.length&&S.push(p.join(":")),S}function fs(p,x,S,M){this.j=p,this.i=x,this.l=S,this.S=M||1,this.V=new ii(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new hs}function hs(){this.i=null,this.g="",this.h=!1}var Bt={},nn={};function Ds(p,x,S){p.M=1,p.A=Yr(Ht(x)),p.u=S,p.R=!0,Oo(p,null)}function Oo(p,x){p.F=Date.now(),Ms(p),p.B=Ht(p.A);var S=p.B,M=p.S;Array.isArray(M)||(M=[String(M)]),Bo(S.i,"t",M),p.C=0,S=p.j.L,p.h=new hs,p.g=rc(p.j,S?x:null,!p.u),p.P>0&&(p.O=new tn(m(p.Y,p,p.g),p.P)),x=p.V,S=p.g,M=p.ba;var Y="readystatechange";Array.isArray(Y)||(Y&&(Hi[0]=Y.toString()),Y=Hi);for(let ne=0;ne<Y.length;ne++){const ve=ye(S,Y[ne],M||x.handleEvent,!1,x.h||x);if(!ve)break;x.g[ve.key]=ve}x=p.J?F(p.J):{},p.u?(p.v||(p.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,x)):(p.v="GET",p.g.ea(p.B,p.v,null,x)),Sn(),bt(p.i,p.v,p.B,p.l,p.S,p.u)}fs.prototype.ba=function(p){p=p.target;const x=this.O;x&&gs(p)==3?x.j():this.Y(p)},fs.prototype.Y=function(p){try{if(p==this.g)e:{const ze=gs(this.g),Ut=this.g.ya(),ut=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||un(this.g)))){this.K||ze!=4||Ut==7||(Ut==8||ut<=0?Sn(3):Sn(2)),Ps(this);var x=this.g.ca();this.X=x;var S=Nf(this);if(this.o=x==200,Vn(this.i,this.v,this.B,this.l,this.S,ze,x),this.o){if(this.U&&!this.L){t:{if(this.g){var M,Y=this.g;if((M=Y.g?Y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(M)){var ne=M;break t}}ne=null}if(p=ne)Ye(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ks(this,p);else{this.o=!1,this.m=3,xt(12),Ln(this),Kn(this);break e}}if(this.R){p=!0;let It;for(;!this.K&&this.C<S.length;)if(It=$u(this,S),It==nn){ze==4&&(this.m=4,xt(14),p=!1),Ye(this.i,this.l,null,"[Incomplete Response]");break}else if(It==Bt){this.m=4,xt(15),Ye(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Ye(this.i,this.l,It,null),ks(this,It);if(Gu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||S.length!=0||this.h.h||(this.m=1,xt(16),p=!1),this.o=this.o&&p,!p)Ye(this.i,this.l,S,"[Invalid Chunked Response]"),Ln(this),Kn(this);else if(S.length>0&&!this.W){this.W=!0;var ve=this.j;ve.g==this&&ve.aa&&!ve.P&&(ve.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Al(ve),ve.P=!0,xt(11))}}else Ye(this.i,this.l,S,null),ks(this,S);ze==4&&Ln(this),this.o&&!this.K&&(ze==4?tc(this.j,this):(this.o=!1,Ms(this)))}else ai(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,xt(12)):(this.m=0,xt(13)),Ln(this),Kn(this)}}}catch{}finally{}};function Nf(p){if(!Gu(p))return p.g.la();const x=un(p.g);if(x==="")return"";let S="";const M=x.length,Y=gs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Ln(p),Kn(p),"";p.h.i=new u.TextDecoder}for(let ne=0;ne<M;ne++)p.h.h=!0,S+=p.h.i.decode(x[ne],{stream:!(Y&&ne==M-1)});return x.length=0,p.h.g+=S,p.C=0,p.h.g}function Gu(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function $u(p,x){var S=p.C,M=x.indexOf(`
`,S);return M==-1?nn:(S=Number(x.substring(S,M)),isNaN(S)?Bt:(M+=1,M+S>x.length?nn:(x=x.slice(M,M+S),p.C=M+S,x)))}fs.prototype.cancel=function(){this.K=!0,Ln(this)};function Ms(p){p.T=Date.now()+p.H,qo(p,p.H)}function qo(p,x){if(p.D!=null)throw Error("WatchDog timer not null");p.D=rt(m(p.aa,p),x)}function Ps(p){p.D&&(u.clearTimeout(p.D),p.D=null)}fs.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Ns(this.i,this.B),this.M!=2&&(Sn(),xt(17)),Ln(this),this.m=2,Kn(this)):qo(this,this.T-p)};function Kn(p){p.j.I==0||p.K||tc(p.j,p)}function Ln(p){Ps(p);var x=p.O;x&&typeof x.dispose=="function"&&x.dispose(),p.O=null,Gi(p.V),p.g&&(x=p.g,p.g=null,x.abort(),x.dispose())}function ks(p,x){try{var S=p.j;if(S.I!=0&&(S.g==p||Ls(S.h,p))){if(!p.L&&Ls(S.h,p)&&S.I==3){try{var M=S.Ba.g.parse(x)}catch{M=null}if(Array.isArray(M)&&M.length==3){var Y=M;if(Y[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)Yo(S),er(S);else break e;eo(S),xt(18)}}else S.xa=Y[1],0<S.xa-S.K&&Y[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=rt(m(S.Va,S),6e3));Vs(S.h)<=1&&S.ta&&(S.ta=void 0)}else Bs(S,11)}else if((p.L||S.g==p)&&Yo(S),!k(x))for(Y=S.Ba.g.parse(x),x=0;x<Y.length;x++){let ut=Y[x];const It=ut[0];if(!(It<=S.K))if(S.K=It,ut=ut[1],S.I==2)if(ut[0]=="c"){S.M=ut[1],S.ba=ut[2];const Wn=ut[3];Wn!=null&&(S.ka=Wn,S.j.info("VER="+S.ka));const zs=ut[4];zs!=null&&(S.za=zs,S.j.info("SVER="+S.za));const ys=ut[5];ys!=null&&typeof ys=="number"&&ys>0&&(M=1.5*ys,S.O=M,S.j.info("backChannelRequestTimeoutMs_="+M)),M=S;const vs=p.g;if(vs){const to=vs.g?vs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(to){var ne=M.h;ne.g||to.indexOf("spdy")==-1&&to.indexOf("quic")==-1&&to.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(fl(ne,ne.h),ne.h=null))}if(M.G){const Jo=vs.g?vs.g.getResponseHeader("X-HTTP-Session-Id"):null;Jo&&(M.wa=Jo,ft(M.J,M.G,Jo))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),M=S;var ve=p;if(M.na=ic(M,M.L?M.ba:null,M.W),ve.L){hl(M.h,ve);var ze=ve,Ut=M.O;Ut&&(ze.H=Ut),ze.D&&(Ps(ze),Ms(ze)),M.g=ve}else Zu(M);S.i.length>0&&Fs(S)}else ut[0]!="stop"&&ut[0]!="close"||Bs(S,7);else S.I==3&&(ut[0]=="stop"||ut[0]=="close"?ut[0]=="stop"?Bs(S,7):xl(S):ut[0]!="noop"&&S.l&&S.l.qa(ut),S.A=0)}}Sn(4)}catch{}}var zt=class{constructor(p,x){this.g=p,this.map=x}};function cl(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function dl(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Vs(p){return p.h?1:p.g?p.g.size:0}function Ls(p,x){return p.h?p.h==x:p.g?p.g.has(x):!1}function fl(p,x){p.g?p.g.add(x):p.h=x}function hl(p,x){p.h&&p.h==x?p.h=null:p.g&&p.g.has(x)&&p.g.delete(x)}cl.prototype.cancel=function(){if(this.i=ml(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function ml(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let x=p.i;for(const S of p.g.values())x=x.concat(S.G);return x}return I(p.i)}var Yu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jo(p,x){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const M=p[S].indexOf("=");let Y,ne=null;M>=0?(Y=p[S].substring(0,M),ne=p[S].substring(M+1)):Y=p[S],x(Y,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function Un(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;p instanceof Un?(this.l=p.l,sn(this,p.j),this.o=p.o,this.g=p.g,Yi(this,p.u),this.h=p.h,pl(this,Xu(p.i)),this.m=p.m):p&&(x=String(p).match(Yu))?(this.l=!1,sn(this,x[1]||"",!0),this.o=Us(x[2]||""),this.g=Us(x[3]||"",!0),Yi(this,x[4]),this.h=Us(x[5]||"",!0),pl(this,x[6]||"",!0),this.m=Us(x[7]||"")):(this.l=!1,this.i=new Ki(null,this.l))}Un.prototype.toString=function(){const p=[];var x=this.j;x&&p.push(Jr(x,Fo,!0),":");var S=this.g;return(S||x=="file")&&(p.push("//"),(x=this.o)&&p.push(Jr(x,Fo,!0),"@"),p.push(ri(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Jr(S,S.charAt(0)=="/"?gl:Ju,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Jr(S,Ku)),p.join("")},Un.prototype.resolve=function(p){const x=Ht(this);let S=!!p.j;S?sn(x,p.j):S=!!p.o,S?x.o=p.o:S=!!p.g,S?x.g=p.g:S=p.u!=null;var M=p.h;if(S)Yi(x,p.u);else if(S=!!p.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var Y=x.h.lastIndexOf("/");Y!=-1&&(M=x.h.slice(0,Y+1)+M)}if(Y=M,Y==".."||Y==".")M="";else if(Y.indexOf("./")!=-1||Y.indexOf("/.")!=-1){M=Y.lastIndexOf("/",0)==0,Y=Y.split("/");const ne=[];for(let ve=0;ve<Y.length;){const ze=Y[ve++];ze=="."?M&&ve==Y.length&&ne.push(""):ze==".."?((ne.length>1||ne.length==1&&ne[0]!="")&&ne.pop(),M&&ve==Y.length&&ne.push("")):(ne.push(ze),M=!0)}M=ne.join("/")}else M=Y}return S?x.h=M:S=p.i.toString()!=="",S?pl(x,Xu(p.i)):S=!!p.m,S&&(x.m=p.m),x};function Ht(p){return new Un(p)}function sn(p,x,S){p.j=S?Us(x,!0):x,p.j&&(p.j=p.j.replace(/:$/,""))}function Yi(p,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);p.u=x}else p.u=null}function pl(p,x,S){x instanceof Ki?(p.i=x,zo(p.i,p.l)):(S||(x=Jr(x,Ji)),p.i=new Ki(x,p.l))}function ft(p,x,S){p.i.set(x,S)}function Yr(p){return ft(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Us(p,x){return p?x?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Jr(p,x,S){return typeof p=="string"?(p=encodeURI(p).replace(x,Cn),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Cn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Fo=/[#\/\?@]/g,Ju=/[#\?:]/g,gl=/[#\?]/g,Ji=/[#\?@]/g,Ku=/#/g;function Ki(p,x){this.h=this.g=null,this.i=p||null,this.j=!!x}function wn(p){p.g||(p.g=new Map,p.h=0,p.i&&jo(p.i,function(x,S){p.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}n=Ki.prototype,n.add=function(p,x){wn(this),this.i=null,p=Qi(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(x),this.h+=1,this};function Qu(p,x){wn(p),x=Qi(p,x),p.g.has(x)&&(p.i=null,p.h-=p.g.get(x).length,p.g.delete(x))}function yl(p,x){return wn(p),x=Qi(p,x),p.g.has(x)}n.forEach=function(p,x){wn(this),this.g.forEach(function(S,M){S.forEach(function(Y){p.call(x,Y,M,this)},this)},this)};function vl(p,x){wn(p);let S=[];if(typeof x=="string")yl(p,x)&&(S=S.concat(p.g.get(Qi(p,x))));else for(p=Array.from(p.g.values()),x=0;x<p.length;x++)S=S.concat(p[x]);return S}n.set=function(p,x){return wn(this),this.i=null,p=Qi(this,p),yl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[x]),this.h+=1,this},n.get=function(p,x){return p?(p=vl(this,p),p.length>0?String(p[0]):x):x};function Bo(p,x,S){Qu(p,x),S.length>0&&(p.i=null,p.g.set(Qi(p,x),I(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],x=Array.from(this.g.keys());for(let M=0;M<x.length;M++){var S=x[M];const Y=ri(S);S=vl(this,S);for(let ne=0;ne<S.length;ne++){let ve=Y;S[ne]!==""&&(ve+="="+ri(S[ne])),p.push(ve)}}return this.i=p.join("&")};function Xu(p){const x=new Ki;return x.i=p.i,p.g&&(x.g=new Map(p.g),x.h=p.h),x}function Qi(p,x){return x=String(x),p.j&&(x=x.toLowerCase()),x}function zo(p,x){x&&!p.j&&(wn(p),p.i=null,p.g.forEach(function(S,M){const Y=M.toLowerCase();M!=Y&&(Qu(this,M),Bo(this,Y,S))},p)),p.j=x}function ms(p,x){const S=new Lt;if(u.Image){const M=new Image;M.onload=T(Qn,S,"TestLoadImage: loaded",!0,x,M),M.onerror=T(Qn,S,"TestLoadImage: error",!1,x,M),M.onabort=T(Qn,S,"TestLoadImage: abort",!1,x,M),M.ontimeout=T(Qn,S,"TestLoadImage: timeout",!1,x,M),u.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else x(!1)}function _l(p,x){const S=new Lt,M=new AbortController,Y=setTimeout(()=>{M.abort(),Qn(S,"TestPingServer: timeout",!1,x)},1e4);fetch(p,{signal:M.signal}).then(ne=>{clearTimeout(Y),ne.ok?Qn(S,"TestPingServer: ok",!0,x):Qn(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(Y),Qn(S,"TestPingServer: error",!1,x)})}function Qn(p,x,S,M,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),M(S)}catch{}}function Xi(){this.g=new Gr}function Os(p){this.i=p.Sb||null,this.h=p.ab||!1}E(Os,H),Os.prototype.g=function(){return new Kr(this.i,this.h)};function Kr(p,x){Dt.call(this),this.H=p,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(Kr,Dt),n=Kr.prototype,n.open=function(p,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=x,this.readyState=1,ps(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(x.body=p),(this.H||u).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Wi(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ho(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ho(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var x=p.value?p.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!p.done}))&&(this.response=this.responseText+=x)}p.done?Wi(this):ps(this),this.readyState==3&&Ho(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Wi(this))},n.Na=function(p){this.g&&(this.response=p,Wi(this))},n.ga=function(){this.g&&Wi(this)};function Wi(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ps(p)}n.setRequestHeader=function(p,x){this.A.append(p,x)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=x.next();return p.join(`\r
`)};function ps(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Kr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Xn(p){let x="";return Pe(p,function(S,M){x+=M,x+=":",x+=S,x+=`\r
`}),x}function Qr(p,x,S){e:{for(M in S){var M=!1;break e}M=!0}M||(S=Xn(S),typeof p=="string"?S!=null&&ri(S):ft(p,x,S))}function pt(p){Dt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(pt,Dt);var qs=/^https?$/i,Tl=["POST","PUT"];n=pt.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,x,S,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);x=x?x.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ul.g(),this.g.onreadystatechange=b(m(this.Ca,this));try{this.B=!0,this.g.open(x,String(p),!0),this.B=!1}catch(ne){Xr(this,ne);return}if(p=S||"",S=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var Y in M)S.set(Y,M[Y]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const ne of M.keys())S.set(ne,M.get(ne));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(S.keys()).find(ne=>ne.toLowerCase()=="content-type"),Y=u.FormData&&p instanceof u.FormData,!(Array.prototype.indexOf.call(Tl,x,void 0)>=0)||M||Y||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,ve]of S)this.g.setRequestHeader(ne,ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ne){Xr(this,ne)}};function Xr(p,x){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=x,p.o=5,El(p),oi(p)}function El(p){p.A||(p.A=!0,Vt(p,"complete"),Vt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Vt(this,"complete"),Vt(this,"abort"),oi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),oi(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Wr(this):this.Xa())},n.Xa=function(){Wr(this)};function Wr(p){if(p.h&&typeof l<"u"){if(p.v&&gs(p)==4)setTimeout(p.Ca.bind(p),0);else if(Vt(p,"readystatechange"),gs(p)==4){p.h=!1;try{const ne=p.ca();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var M;if(M=ne===0){let ve=String(p.D).match(Yu)[1]||null;!ve&&u.self&&u.self.location&&(ve=u.self.location.protocol.slice(0,-1)),M=!qs.test(ve?ve.toLowerCase():"")}S=M}if(S)Vt(p,"complete"),Vt(p,"success");else{p.o=6;try{var Y=gs(p)>2?p.g.statusText:""}catch{Y=""}p.l=Y+" ["+p.ca()+"]",El(p)}}finally{oi(p)}}}}function oi(p,x){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,x||Vt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gs(p){return p.g?p.g.readyState:0}n.ca=function(){try{return gs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var x=this.g.responseText;return p&&x.indexOf(p)==0&&(x=x.substring(p.length)),Lo(x)}};function un(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ai(p){const x={};p=(p.g&&gs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(k(p[M]))continue;var S=Hu(p[M]);const Y=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ne=x[Y]||[];x[Y]=ne,ne.push(S)}De(x,function(M){return M.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function js(p,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||x}function Zi(p){this.za=0,this.i=[],this.j=new Lt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=js("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=js("baseRetryDelayMs",5e3,p),this.Za=js("retryDelaySeedMs",1e4,p),this.Ta=js("forwardChannelMaxRetries",2,p),this.va=js("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new cl(p&&p.concurrentRequestLimit),this.Ba=new Xi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Zi.prototype,n.ka=8,n.I=1,n.connect=function(p,x,S,M){xt(0),this.W=p,this.H=x||{},S&&M!==void 0&&(this.H.OSID=S,this.H.OAID=M),this.F=this.X,this.J=ic(this,null,this.W),Fs(this)};function xl(p){if(Go(p),p.I==3){var x=p.V++,S=Ht(p.J);if(ft(S,"SID",p.M),ft(S,"RID",x),ft(S,"TYPE","terminate"),Zr(p,S),x=new fs(p,p.j,x),x.M=2,x.A=Yr(Ht(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=x.A,S=!0),S||(x.g=rc(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Ms(x)}sc(p)}function er(p){p.g&&(Al(p),p.g.cancel(),p.g=null)}function Go(p){er(p),p.v&&(u.clearTimeout(p.v),p.v=null),Yo(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&u.clearTimeout(p.m),p.m=null)}function Fs(p){if(!dl(p.h)&&!p.m){p.m=!0;var x=p.Ea;X||C(),z||(X(),z=!0),R.add(x,p),p.D=0}}function $o(p,x){return Vs(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=x.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=rt(m(p.Ea,p,x),nc(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const Y=new fs(this,this.j,p);let ne=this.o;if(this.U&&(ne?(ne=F(ne),_e(ne,this.U)):ne=this.U),this.u!==null||this.R||(Y.J=ne,ne=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var M=this.i[S];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(x+=M,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Wu(this,Y,x),S=Ht(this.J),ft(S,"RID",p),ft(S,"CVER",22),this.G&&ft(S,"X-HTTP-Session-Id",this.G),Zr(this,S),ne&&(this.R?x="headers="+ri(Xn(ne))+"&"+x:this.u&&Qr(S,this.u,ne)),fl(this.h,Y),this.Ra&&ft(S,"TYPE","init"),this.S?(ft(S,"$req",x),ft(S,"SID","null"),Y.U=!0,Ds(Y,S,null)):Ds(Y,S,x),this.I=2}}else this.I==3&&(p?bl(this,p):this.i.length==0||dl(this.h)||bl(this))};function bl(p,x){var S;x?S=x.l:S=p.V++;const M=Ht(p.J);ft(M,"SID",p.M),ft(M,"RID",S),ft(M,"AID",p.K),Zr(p,M),p.u&&p.o&&Qr(M,p.u,p.o),S=new fs(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),x&&(p.i=x.G.concat(p.i)),x=Wu(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),fl(p.h,S),Ds(S,M,x)}function Zr(p,x){p.H&&Pe(p.H,function(S,M){ft(x,M,S)}),p.l&&Pe({},function(S,M){ft(x,M,S)})}function Wu(p,x,S){S=Math.min(p.i.length,S);const M=p.l?m(p.l.Ka,p.l,p):null;e:{var Y=p.i;let ze=-1;for(;;){const Ut=["count="+S];ze==-1?S>0?(ze=Y[0].g,Ut.push("ofs="+ze)):ze=0:Ut.push("ofs="+ze);let ut=!0;for(let It=0;It<S;It++){var ne=Y[It].g;const Wn=Y[It].map;if(ne-=ze,ne<0)ze=Math.max(0,Y[It].g-100),ut=!1;else try{ne="req"+ne+"_"||"";try{var ve=Wn instanceof Map?Wn:Object.entries(Wn);for(const[zs,ys]of ve){let vs=ys;d(ys)&&(vs=cs(ys)),Ut.push(ne+zs+"="+encodeURIComponent(vs))}}catch(zs){throw Ut.push(ne+"type="+encodeURIComponent("_badmap")),zs}}catch{M&&M(Wn)}}if(ut){ve=Ut.join("&");break e}}ve=void 0}return p=p.i.splice(0,S),x.G=p,ve}function Zu(p){if(!p.g&&!p.v){p.Y=1;var x=p.Da;X||C(),z||(X(),z=!0),R.add(x,p),p.A=0}}function eo(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=rt(m(p.Da,p),nc(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,ec(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=rt(m(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xt(10),er(this),ec(this))};function Al(p){p.B!=null&&(u.clearTimeout(p.B),p.B=null)}function ec(p){p.g=new fs(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var x=Ht(p.na);ft(x,"RID","rpc"),ft(x,"SID",p.M),ft(x,"AID",p.K),ft(x,"CI",p.F?"0":"1"),!p.F&&p.ia&&ft(x,"TO",p.ia),ft(x,"TYPE","xmlhttp"),Zr(p,x),p.u&&p.o&&Qr(x,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Yr(Ht(x)),S.u=null,S.R=!0,Oo(S,p)}n.Va=function(){this.C!=null&&(this.C=null,er(this),eo(this),xt(19))};function Yo(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function tc(p,x){var S=null;if(p.g==x){Yo(p),Al(p),p.g=null;var M=2}else if(Ls(p.h,x))S=x.G,hl(p.h,x),M=1;else return;if(p.I!=0){if(x.o)if(M==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var Y=p.D;M=Jn(),Vt(M,new Te(M,S)),Fs(p)}else Zu(p);else if(Y=x.m,Y==3||Y==0&&x.X>0||!(M==1&&$o(p,x)||M==2&&eo(p)))switch(S&&S.length>0&&(x=p.h,x.i=x.i.concat(S)),Y){case 1:Bs(p,5);break;case 4:Bs(p,10);break;case 3:Bs(p,6);break;default:Bs(p,2)}}}function nc(p,x){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*x}function Bs(p,x){if(p.j.info("Error code "+x),x==2){var S=m(p.bb,p),M=p.Ua;const Y=!M;M=new Un(M||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||sn(M,"https"),Yr(M),Y?ms(M.toString(),S):_l(M.toString(),S)}else xt(2);p.I=0,p.l&&p.l.pa(x),sc(p),Go(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function sc(p){if(p.I=0,p.ja=[],p.l){const x=ml(p.h);(x.length!=0||p.i.length!=0)&&(V(p.ja,x),V(p.ja,p.i),p.h.i.length=0,I(p.i),p.i.length=0),p.l.oa()}}function ic(p,x,S){var M=S instanceof Un?Ht(S):new Un(S);if(M.g!="")x&&(M.g=x+"."+M.g),Yi(M,M.u);else{var Y=u.location;M=Y.protocol,x=x?x+"."+Y.hostname:Y.hostname,Y=+Y.port;const ne=new Un(null);M&&sn(ne,M),x&&(ne.g=x),Y&&Yi(ne,Y),S&&(ne.h=S),M=ne}return S=p.G,x=p.wa,S&&x&&ft(M,S,x),ft(M,"VER",p.ka),Zr(p,M),M}function rc(p,x,S){if(x&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=p.Aa&&!p.ma?new pt(new Os({ab:S})):new pt(p.ma),x.Fa(p.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function oc(){}n=oc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function tr(){}tr.prototype.g=function(p,x){return new En(p,x)};function En(p,x){Dt.call(this),this.g=new Zi(x),this.l=p,this.h=x&&x.messageUrlParams||null,p=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(p?p["X-WebChannel-Content-Type"]=x.messageContentType:p={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(p?p["X-WebChannel-Client-Profile"]=x.sa:p={"X-WebChannel-Client-Profile":x.sa}),this.g.U=p,(p=x&&x.Qb)&&!k(p)&&(this.g.u=p),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!k(x)&&(this.g.G=x,p=this.h,p!==null&&x in p&&(p=this.h,x in p&&delete p[x])),this.j=new li(this)}E(En,Dt),En.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){xl(this.g)},En.prototype.o=function(p){var x=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=cs(p),p=S);x.i.push(new zt(x.Ya++,p)),x.I==3&&Fs(x)},En.prototype.N=function(){this.g.l=null,delete this.j,xl(this.g),delete this.g,En.Z.N.call(this)};function ac(p){pe.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var x=p.__sm__;if(x){e:{for(const S in x){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,x=x!==null&&p in x?x[p]:void 0),this.data=x}else this.data=p}E(ac,pe);function lc(){Ee.call(this),this.status=1}E(lc,Ee);function li(p){this.g=p}E(li,oc),li.prototype.ra=function(){Vt(this.g,"a")},li.prototype.qa=function(p){Vt(this.g,new ac(p))},li.prototype.pa=function(p){Vt(this.g,new lc)},li.prototype.oa=function(){Vt(this.g,"b")},tr.prototype.createWebChannel=tr.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,Gx=function(){return new tr},Hx=function(){return Jn()},zx=Ne,up={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Rs.NO_ERROR=0,Rs.TIMEOUT=8,Rs.HTTP_ERROR=6,bd=Rs,ll.COMPLETE="complete",Bx=ll,ce.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,hu=ce,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,Fx=pt}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});const NT="@firebase/firestore",RT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=new Op("@firebase/firestore");function Aa(){return Ao.logLevel}function be(n,...e){if(Ao.logLevel<=et.DEBUG){const t=e.map(Fp);Ao.debug(`Firestore (${nl}): ${n}`,...t)}}function Ui(n,...e){if(Ao.logLevel<=et.ERROR){const t=e.map(Fp);Ao.error(`Firestore (${nl}): ${n}`,...t)}}function So(n,...e){if(Ao.logLevel<=et.WARN){const t=e.map(Fp);Ao.warn(`Firestore (${nl}): ${n}`,...t)}}function Fp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,$x(n,i,t)}function $x(n,e,t){let i=`FIRESTORE (${nl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ui(i),new Error(i)}function dt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||$x(e,o,i)}function Fe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Bi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Jx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yn.UNAUTHENTICATED)))}shutdown(){}}class NP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class RP{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){dt(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Pi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Pi,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},d=g=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>d(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?d(g):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Pi)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(dt(typeof i.accessToken=="string",31837,{l:i}),new Yx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return dt(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class DP{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class MP{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new DP(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class DT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PP{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,as(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){dt(this.o===void 0,3512);const i=l=>{l.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,be("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const o=l=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new DT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(dt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new DT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=kP(40);for(let l=0;l<o.length;++l)i.length<20&&o[l]<t&&(i+=e.charAt(o[l]%62))}return i}}function tt(n,e){return n<e?-1:n>e?1:0}function cp(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),l=e.charAt(i);if(o!==l)return Lm(o)===Lm(l)?tt(o,l):Lm(o)?1:-1}return tt(n.length,e.length)}const VP=55296,LP=57343;function Lm(n){const e=n.charCodeAt(0);return e>=VP&&e<=LP}function za(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT="__name__";class Js{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ue(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ue(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Js.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Js?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const l=Js.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return tt(e.length,t.length)}static compareSegments(e,t){const i=Js.isNumericId(e),o=Js.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Js.extractNumericId(e).compare(Js.extractNumericId(t)):cp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Rr.fromString(e.substring(4,e.length-2))}}class wt extends Js{construct(e,t,i){return new wt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ce(fe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new wt(t)}static emptyPath(){return new wt([])}}const UP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Js{construct(e,t,i){return new an(e,t,i)}static isValidIdentifier(e){return UP.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===MT}static keyField(){return new an([MT])}static fromServerFormat(e){const t=[];let i="",o=0;const l=()=>{if(i.length===0)throw new Ce(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ce(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ce(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else d==="`"?(u=!u,o++):d!=="."||u?(i+=d,o++):(l(),o++)}if(l(),u)throw new Ce(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.path=e}static fromPath(e){return new Me(wt.fromString(e))}static fromName(e){return new Me(wt.fromString(e).popFirst(5))}static empty(){return new Me(wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return wt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Me(new wt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n,e,t){if(!t)throw new Ce(fe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Qx(n,e,t,i){if(e===!0&&i===!0)throw new Ce(fe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function PT(n){if(!Me.isDocumentKey(n))throw new Ce(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function kT(n){if(Me.isDocumentKey(n))throw new Ce(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Xx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Bp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ue(12329,{type:typeof n})}function Oi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ce(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bp(n);throw new Ce(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Pu(n,e){if(!Xx(n))throw new Ce(fe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(o&&typeof u!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Ce(fe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=-62135596800,LT=1e6;class Et{static now(){return Et.fromMillis(Date.now())}static fromDate(e){return Et.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*LT);return new Et(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<VT)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/LT}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pu(e,Et._jsonSchema))return new Et(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-VT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:Qt("string",Et._jsonSchemaVersion),seconds:Qt("number"),nanoseconds:Qt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{static fromTimestamp(e){return new qe(e)}static min(){return new qe(new Et(0,0))}static max(){return new qe(new Et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=-1;function OP(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=qe.fromTimestamp(i===1e9?new Et(t+1,0):new Et(t,i));return new Mr(o,Me.empty(),e)}function qP(n){return new Mr(n.readTime,n.key,Su)}class Mr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Mr(qe.min(),Me.empty(),Su)}static max(){return new Mr(qe.max(),Me.empty(),Su)}}function jP(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Me.comparator(n.documentKey,e.documentKey),t!==0?t:tt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(n){if(n.code!==fe.FAILED_PRECONDITION||n.message!==FP)throw n;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue(((i,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.reject(t)}static resolve(e){return new ue(((t,i)=>{t(e)}))}static reject(e){return new ue(((t,i)=>{i(e)}))}static waitFor(e){return new ue(((t,i)=>{let o=0,l=0,u=!1;e.forEach((d=>{++o,d.next((()=>{++l,u&&l===o&&t()}),(g=>i(g)))})),u=!0,l===o&&t()}))}static or(e){let t=ue.resolve(!1);for(const i of e)t=t.next((o=>o?ue.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,l)=>{i.push(t.call(this,o,l))})),this.waitFor(i)}static mapArray(e,t){return new ue(((i,o)=>{const l=e.length,u=new Array(l);let d=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((T=>{u[m]=T,++d,d===l&&i(u)}),(T=>o(T)))}}))}static doWhile(e,t){return new ue(((i,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):i()};l()}))}}function zP(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function il(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}uf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp=-1;function cf(n){return n==null}function Od(n){return n===0&&1/n==-1/0}function HP(n){return typeof n=="number"&&Number.isInteger(n)&&!Od(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="";function GP(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=UT(e)),e=$P(n.get(t),e);return UT(e)}function $P(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case Wx:t+="";break;default:t+=l}}return t}function UT(n){return n+Wx+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function No(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Zx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,t){this.comparator=e,this.root=t||mn.EMPTY}insert(e,t){return new Rt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new Rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new md(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new md(this.root,e,this.comparator,!1)}getReverseIterator(){return new md(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new md(this.root,e,this.comparator,!0)}}class md{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,t,i,o,l){this.key=e,this.value=t,this.color=i??mn.RED,this.left=o??mn.EMPTY,this.right=l??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,l){return new mn(e??this.key,t??this.value,i??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const l=i(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,i),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return mn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ue(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ue(57766)}get value(){throw Ue(16141)}get color(){throw Ue(16727)}get left(){throw Ue(29726)}get right(){throw Ue(36894)}copy(e,t,i,o,l){return this}insert(e,t,i){return new mn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.comparator=e,this.data=new Rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qT(this.data.getIterator())}getIteratorFrom(e){return new qT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new en(this.comparator);return t.data=e,t}}class qT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new bs([])}unionWith(e){let t=new en(an.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new bs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return za(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new eb("Invalid base64 string: "+l):l}})(e);return new ln(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let u=0;u<o.length;++u)l+=String.fromCharCode(o[u]);return l})(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const YP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pr(n){if(dt(!!n,39018),typeof n=="string"){let e=0;const t=YP.exec(n);if(dt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:jt(n.seconds),nanos:jt(n.nanos)}}function jt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function kr(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="server_timestamp",nb="__type__",sb="__previous_value__",ib="__local_write_time__";function Hp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[nb])==null?void 0:i.stringValue)===tb}function df(n){const e=n.mapValue.fields[sb];return Hp(e)?df(e):e}function Cu(n){const e=Pr(n.mapValue.fields[ib].timestampValue);return new Et(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,t,i,o,l,u,d,g,m,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=T}}const qd="(default)";class Ha{constructor(e,t){this.projectId=e,this.database=t||qd}static empty(){return new Ha("","")}get isDefaultDatabase(){return this.database===qd}isEqual(e){return e instanceof Ha&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb="__type__",KP="__max__",pd={mapValue:{}},ob="__vector__",jd="value";function Vr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Hp(n)?4:XP(n)?9007199254740991:QP(n)?10:11:Ue(28295,{value:n})}function ei(n,e){if(n===e)return!0;const t=Vr(n);if(t!==Vr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cu(n).isEqual(Cu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const u=Pr(o.timestampValue),d=Pr(l.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return kr(o.bytesValue).isEqual(kr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return jt(o.geoPointValue.latitude)===jt(l.geoPointValue.latitude)&&jt(o.geoPointValue.longitude)===jt(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return jt(o.integerValue)===jt(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const u=jt(o.doubleValue),d=jt(l.doubleValue);return u===d?Od(u)===Od(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return za(n.arrayValue.values||[],e.arrayValue.values||[],ei);case 10:case 11:return(function(o,l){const u=o.mapValue.fields||{},d=l.mapValue.fields||{};if(OT(u)!==OT(d))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(d[g]===void 0||!ei(u[g],d[g])))return!1;return!0})(n,e);default:return Ue(52216,{left:n})}}function wu(n,e){return(n.values||[]).find((t=>ei(t,e)))!==void 0}function Ga(n,e){if(n===e)return 0;const t=Vr(n),i=Vr(e);if(t!==i)return tt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return tt(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const d=jt(l.integerValue||l.doubleValue),g=jt(u.integerValue||u.doubleValue);return d<g?-1:d>g?1:d===g?0:isNaN(d)?isNaN(g)?0:-1:1})(n,e);case 3:return jT(n.timestampValue,e.timestampValue);case 4:return jT(Cu(n),Cu(e));case 5:return cp(n.stringValue,e.stringValue);case 6:return(function(l,u){const d=kr(l),g=kr(u);return d.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const d=l.split("/"),g=u.split("/");for(let m=0;m<d.length&&m<g.length;m++){const T=tt(d[m],g[m]);if(T!==0)return T}return tt(d.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const d=tt(jt(l.latitude),jt(u.latitude));return d!==0?d:tt(jt(l.longitude),jt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return FT(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var b,I,V,L;const d=l.fields||{},g=u.fields||{},m=(b=d[jd])==null?void 0:b.arrayValue,T=(I=g[jd])==null?void 0:I.arrayValue,E=tt(((V=m==null?void 0:m.values)==null?void 0:V.length)||0,((L=T==null?void 0:T.values)==null?void 0:L.length)||0);return E!==0?E:FT(m,T)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===pd.mapValue&&u===pd.mapValue)return 0;if(l===pd.mapValue)return 1;if(u===pd.mapValue)return-1;const d=l.fields||{},g=Object.keys(d),m=u.fields||{},T=Object.keys(m);g.sort(),T.sort();for(let E=0;E<g.length&&E<T.length;++E){const b=cp(g[E],T[E]);if(b!==0)return b;const I=Ga(d[g[E]],m[T[E]]);if(I!==0)return I}return tt(g.length,T.length)})(n.mapValue,e.mapValue);default:throw Ue(23264,{he:t})}}function jT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return tt(n,e);const t=Pr(n),i=Pr(e),o=tt(t.seconds,i.seconds);return o!==0?o:tt(t.nanos,i.nanos)}function FT(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const l=Ga(t[o],i[o]);if(l)return l}return tt(t.length,i.length)}function $a(n){return dp(n)}function dp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Pr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return kr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Me.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const l of t.values||[])o?o=!1:i+=",",i+=dp(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const u of i)l?l=!1:o+=",",o+=`${u}:${dp(t.fields[u])}`;return o+"}"})(n.mapValue):Ue(61005,{value:n})}function Ad(n){switch(Vr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=df(n);return e?16+Ad(e):16;case 5:return 2*n.stringValue.length;case 6:return kr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,l)=>o+Ad(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return No(i.fields,((l,u)=>{o+=l.length+Ad(u)})),o})(n.mapValue);default:throw Ue(13486,{value:n})}}function fp(n){return!!n&&"integerValue"in n}function Gp(n){return!!n&&"arrayValue"in n}function BT(n){return!!n&&"nullValue"in n}function zT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sd(n){return!!n&&"mapValue"in n}function QP(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[rb])==null?void 0:i.stringValue)===ob}function vu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return No(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=vu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vu(n.arrayValue.values[t]);return e}return{...n}}function XP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this.value=e}static empty(){return new ls({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Sd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vu(t)}setAll(e){let t=an.emptyPath(),i={},o=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const g=this.getFieldsMap(t);this.applyChanges(g,i,o),i={},o=[],t=d.popLast()}u?i[d.lastSegment()]=vu(u):o.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,o)}delete(e){const t=this.field(e.popLast());Sd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ei(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Sd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){No(t,((o,l)=>e[o]=l));for(const o of i)delete e[o]}clone(){return new ls(vu(this.value))}}function ab(n){const e=[];return No(n.fields,((t,i)=>{const o=new an([t]);if(Sd(i)){const l=ab(i.mapValue).fields;if(l.length===0)e.push(o);else for(const u of l)e.push(o.child(u))}else e.push(o)})),new bs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,t,i,o,l,u,d){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=l,this.data=u,this.documentState=d}static newInvalidDocument(e){return new vn(e,0,qe.min(),qe.min(),qe.min(),ls.empty(),0)}static newFoundDocument(e,t,i,o){return new vn(e,1,t,qe.min(),i,o,0)}static newNoDocument(e,t){return new vn(e,2,t,qe.min(),qe.min(),ls.empty(),0)}static newUnknownDocument(e,t){return new vn(e,3,t,qe.min(),qe.min(),ls.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ls.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ls.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t){this.position=e,this.inclusive=t}}function HT(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const l=e[o],u=n.position[o];if(l.field.isKeyField()?i=Me.comparator(Me.fromName(u.referenceValue),t.key):i=Ga(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function GT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ei(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,t="asc"){this.field=e,this.dir=t}}function WP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{}class Zt extends lb{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new e2(e,t,i):t==="array-contains"?new s2(e,i):t==="in"?new i2(e,i):t==="not-in"?new r2(e,i):t==="array-contains-any"?new o2(e,i):new Zt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new t2(e,i):new n2(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ga(t,this.value)):t!==null&&Vr(this.value)===Vr(t)&&this.matchesComparison(Ga(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ti extends lb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ti(e,t)}matches(e){return ub(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ub(n){return n.op==="and"}function cb(n){return ZP(n)&&ub(n)}function ZP(n){for(const e of n.filters)if(e instanceof ti)return!1;return!0}function hp(n){if(n instanceof Zt)return n.field.canonicalString()+n.op.toString()+$a(n.value);if(cb(n))return n.filters.map((e=>hp(e))).join(",");{const e=n.filters.map((t=>hp(t))).join(",");return`${n.op}(${e})`}}function db(n,e){return n instanceof Zt?(function(i,o){return o instanceof Zt&&i.op===o.op&&i.field.isEqual(o.field)&&ei(i.value,o.value)})(n,e):n instanceof ti?(function(i,o){return o instanceof ti&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((l,u,d)=>l&&db(u,o.filters[d])),!0):!1})(n,e):void Ue(19439)}function fb(n){return n instanceof Zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${$a(t.value)}`})(n):n instanceof ti?(function(t){return t.op.toString()+" {"+t.getFilters().map(fb).join(" ,")+"}"})(n):"Filter"}class e2 extends Zt{constructor(e,t,i){super(e,t,i),this.key=Me.fromName(i.referenceValue)}matches(e){const t=Me.comparator(e.key,this.key);return this.matchesComparison(t)}}class t2 extends Zt{constructor(e,t){super(e,"in",t),this.keys=hb("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class n2 extends Zt{constructor(e,t){super(e,"not-in",t),this.keys=hb("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function hb(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Me.fromName(i.referenceValue)))}class s2 extends Zt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gp(t)&&wu(t.arrayValue,this.value)}}class i2 extends Zt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class r2 extends Zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class o2 extends Zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e,t=null,i=[],o=[],l=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=l,this.startAt=u,this.endAt=d,this.Te=null}}function $T(n,e=null,t=[],i=[],o=null,l=null,u=null){return new a2(n,e,t,i,o,l,u)}function $p(n){const e=Fe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>hp(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),cf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>$a(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>$a(i))).join(",")),e.Te=t}return e.Te}function Yp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!WP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!db(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!GT(n.startAt,e.startAt)&&GT(n.endAt,e.endAt)}function mp(n){return Me.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t=null,i=[],o=[],l=null,u="F",d=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=l,this.limitType=u,this.startAt=d,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function l2(n,e,t,i,o,l,u,d){return new ff(n,e,t,i,o,l,u,d)}function Jp(n){return new ff(n)}function YT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function u2(n){return n.collectionGroup!==null}function _u(n){const e=Fe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new en(an.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Bd(l,i))})),t.has(an.keyField().canonicalString())||e.Ie.push(new Bd(an.keyField(),i))}return e.Ie}function Ks(n){const e=Fe(n);return e.Ee||(e.Ee=c2(e,_u(n))),e.Ee}function c2(n,e){if(n.limitType==="F")return $T(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Bd(o.field,l)}));const t=n.endAt?new Fd(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Fd(n.startAt.position,n.startAt.inclusive):null;return $T(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function pp(n,e,t){return new ff(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hf(n,e){return Yp(Ks(n),Ks(e))&&n.limitType===e.limitType}function mb(n){return`${$p(Ks(n))}|lt:${n.limitType}`}function Sa(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>fb(o))).join(", ")}]`),cf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>$a(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>$a(o))).join(",")),`Target(${i})`})(Ks(n))}; limitType=${n.limitType})`}function mf(n,e){return e.isFoundDocument()&&(function(i,o){const l=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Me.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,o){for(const l of _u(i))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const l of i.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(u,d,g){const m=HT(u,d,g);return u.inclusive?m<=0:m<0})(i.startAt,_u(i),o)||i.endAt&&!(function(u,d,g){const m=HT(u,d,g);return u.inclusive?m>=0:m>0})(i.endAt,_u(i),o))})(n,e)}function d2(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pb(n){return(e,t)=>{let i=!1;for(const o of _u(n)){const l=f2(o,e,t);if(l!==0)return l;i=i||o.field.isKeyField()}return 0}}function f2(n,e,t){const i=n.field.isKeyField()?Me.comparator(e.key,t.key):(function(l,u,d){const g=u.data.field(l),m=d.data.field(l);return g!==null&&m!==null?Ga(g,m):Ue(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ue(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,l]of i)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){No(this.inner,((t,i)=>{for(const[o,l]of i)e(o,l)}))}isEmpty(){return Zx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=new Rt(Me.comparator);function qi(){return h2}const gb=new Rt(Me.comparator);function mu(...n){let e=gb;for(const t of n)e=e.insert(t.key,t);return e}function yb(n){let e=gb;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function _o(){return Tu()}function vb(){return Tu()}function Tu(){return new Ro((n=>n.toString()),((n,e)=>n.isEqual(e)))}const m2=new Rt(Me.comparator),p2=new en(Me.comparator);function nt(...n){let e=p2;for(const t of n)e=e.add(t);return e}const g2=new en(tt);function y2(){return g2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Od(e)?"-0":e}}function _b(n){return{integerValue:""+n}}function v2(n,e){return HP(e)?_b(e):Kp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this._=void 0}}function _2(n,e,t){return n instanceof zd?(function(o,l){const u={fields:{[nb]:{stringValue:tb},[ib]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Hp(l)&&(l=df(l)),l&&(u.fields[sb]=l),{mapValue:u}})(t,e):n instanceof Iu?Eb(n,e):n instanceof Nu?xb(n,e):(function(o,l){const u=Tb(o,l),d=JT(u)+JT(o.Ae);return fp(u)&&fp(o.Ae)?_b(d):Kp(o.serializer,d)})(n,e)}function T2(n,e,t){return n instanceof Iu?Eb(n,e):n instanceof Nu?xb(n,e):t}function Tb(n,e){return n instanceof Hd?(function(i){return fp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class zd extends pf{}class Iu extends pf{constructor(e){super(),this.elements=e}}function Eb(n,e){const t=bb(e);for(const i of n.elements)t.some((o=>ei(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Nu extends pf{constructor(e){super(),this.elements=e}}function xb(n,e){let t=bb(e);for(const i of n.elements)t=t.filter((o=>!ei(o,i)));return{arrayValue:{values:t}}}class Hd extends pf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function JT(n){return jt(n.integerValue||n.doubleValue)}function bb(n){return Gp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function E2(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Iu&&o instanceof Iu||i instanceof Nu&&o instanceof Nu?za(i.elements,o.elements,ei):i instanceof Hd&&o instanceof Hd?ei(i.Ae,o.Ae):i instanceof zd&&o instanceof zd})(n.transform,e.transform)}class x2{constructor(e,t){this.version=e,this.transformResults=t}}class Qs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qs}static exists(e){return new Qs(void 0,e)}static updateTime(e){return new Qs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class gf{}function Ab(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qp(n.key,Qs.none()):new ku(n.key,n.data,Qs.none());{const t=n.data,i=ls.empty();let o=new en(an.comparator);for(let l of e.fields)if(!o.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),o=o.add(l)}return new Do(n.key,i,new bs(o.toArray()),Qs.none())}}function b2(n,e,t){n instanceof ku?(function(o,l,u){const d=o.value.clone(),g=QT(o.fieldTransforms,l,u.transformResults);d.setAll(g),l.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Do?(function(o,l,u){if(!Cd(o.precondition,l))return void l.convertToUnknownDocument(u.version);const d=QT(o.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(Sb(o)),g.setAll(d),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(o,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Eu(n,e,t,i){return n instanceof ku?(function(l,u,d,g){if(!Cd(l.precondition,u))return d;const m=l.value.clone(),T=XT(l.fieldTransforms,g,u);return m.setAll(T),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Do?(function(l,u,d,g){if(!Cd(l.precondition,u))return d;const m=XT(l.fieldTransforms,g,u),T=u.data;return T.setAll(Sb(l)),T.setAll(m),u.convertToFoundDocument(u.version,T).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(l,u,d){return Cd(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function A2(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),l=Tb(i.transform,o||null);l!=null&&(t===null&&(t=ls.empty()),t.set(i.field,l))}return t||null}function KT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&za(i,o,((l,u)=>E2(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ku extends gf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Do extends gf{constructor(e,t,i,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Sb(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function QT(n,e,t){const i=new Map;dt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],u=l.transform,d=e.data.field(l.field);i.set(l.field,T2(u,d,t[o]))}return i}function XT(n,e,t){const i=new Map;for(const o of n){const l=o.transform,u=t.data.field(o.field);i.set(o.field,_2(l,u,e))}return i}class Qp extends gf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class S2 extends gf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&b2(l,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Eu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Eu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=vb();return this.mutations.forEach((o=>{const l=e.get(o.key),u=l.overlayedDocument;let d=this.applyToLocalView(u,l.mutatedFields);d=t.has(o.key)?null:d;const g=Ab(u,d);g!==null&&i.set(o.key,g),u.isValidDocument()||u.convertToNoDocument(qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),nt())}isEqual(e){return this.batchId===e.batchId&&za(this.mutations,e.mutations,((t,i)=>KT(t,i)))&&za(this.baseMutations,e.baseMutations,((t,i)=>KT(t,i)))}}class Xp{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){dt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return m2})();const l=e.mutations;for(let u=0;u<l.length;u++)o=o.insert(l[u].key,i[u].version);return new Xp(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,it;function N2(n){switch(n){case fe.OK:return Ue(64938);case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0;default:return Ue(15467,{code:n})}}function Cb(n){if(n===void 0)return Ui("GRPC error has no .code"),fe.UNKNOWN;switch(n){case Kt.OK:return fe.OK;case Kt.CANCELLED:return fe.CANCELLED;case Kt.UNKNOWN:return fe.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return fe.INTERNAL;case Kt.UNAVAILABLE:return fe.UNAVAILABLE;case Kt.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case Kt.NOT_FOUND:return fe.NOT_FOUND;case Kt.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case Kt.ABORTED:return fe.ABORTED;case Kt.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case Kt.DATA_LOSS:return fe.DATA_LOSS;default:return Ue(39323,{code:n})}}(it=Kt||(Kt={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2=new Rr([4294967295,4294967295],0);function WT(n){const e=R2().encode(n),t=new jx;return t.update(e),new Uint8Array(t.digest())}function ZT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Rr([t,i],0),new Rr([o,l],0)]}class Wp{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new pu(`Invalid padding: ${t}`);if(i<0)throw new pu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new pu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new pu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Rr.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Rr.fromNumber(i)));return o.compare(D2)===1&&(o=new Rr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=WT(e),[i,o]=ZT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Wp(l,o,t);return i.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=WT(e),[i,o]=ZT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,t,i,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new yf(qe.min(),o,new Rt(tt),qi(),nt())}}class Vu{constructor(e,t,i,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Vu(i,t,nt(),nt(),nt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class wb{constructor(e,t){this.targetId=e,this.Ce=t}}class Ib{constructor(e,t,i=ln.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class eE{constructor(){this.ve=0,this.Fe=tE(),this.Me=ln.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),t=nt(),i=nt();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Ue(38017,{changeType:l})}})),new Vu(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=tE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,dt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class M2{constructor(e){this.Ge=e,this.ze=new Map,this.je=qi(),this.Je=gd(),this.He=gd(),this.Ye=new Rt(tt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ue(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(mp(l))if(i===0){const u=new Me(l.path);this.et(t,u,vn.newNoDocument(u,qe.min()))}else dt(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const d=this.ut(e),g=d?this.ct(d,e,u):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:l=0}=t;let u,d;try{u=kr(i).toUint8Array()}catch(g){if(g instanceof eb)return So("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{d=new Wp(u,o,l)}catch(g){return So(g instanceof pu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((l=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const d=this.ot(u);if(d){if(l.current&&mp(d.target)){const g=new Me(d.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,vn.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let i=nt();this.He.forEach(((l,u)=>{let d=!0;u.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const o=new yf(e,t,this.Ye,this.je,i);return this.je=qi(),this.Je=gd(),this.He=gd(),this.Ye=new Rt(tt),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new eE,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new en(tt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new en(tt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||be("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eE),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function gd(){return new Rt(Me.comparator)}function tE(){return new Rt(Me.comparator)}const P2={asc:"ASCENDING",desc:"DESCENDING"},k2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},V2={and:"AND",or:"OR"};class L2{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gp(n,e){return n.useProto3Json||cf(e)?e:{value:e}}function Gd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function U2(n,e){return Gd(n,e.toTimestamp())}function Xs(n){return dt(!!n,49232),qe.fromTimestamp((function(t){const i=Pr(t);return new Et(i.seconds,i.nanos)})(n))}function Zp(n,e){return yp(n,e).canonicalString()}function yp(n,e){const t=(function(o){return new wt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Rb(n){const e=wt.fromString(n);return dt(Vb(e),10190,{key:e.toString()}),e}function vp(n,e){return Zp(n.databaseId,e.path)}function Um(n,e){const t=Rb(e);if(t.get(1)!==n.databaseId.projectId)throw new Ce(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ce(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Me(Mb(t))}function Db(n,e){return Zp(n.databaseId,e)}function O2(n){const e=Rb(n);return e.length===4?wt.emptyPath():Mb(e)}function _p(n){return new wt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Mb(n){return dt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function nE(n,e,t){return{name:vp(n,e),fields:t.value.mapValue.fields}}function q2(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ue(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(m,T){return m.useProto3Json?(dt(T===void 0||typeof T=="string",58123),ln.fromBase64String(T||"")):(dt(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),ln.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(m){const T=m.code===void 0?fe.UNKNOWN:Cb(m.code);return new Ce(T,m.message||"")})(u);t=new Ib(i,o,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Um(n,i.document.name),l=Xs(i.document.updateTime),u=i.document.createTime?Xs(i.document.createTime):qe.min(),d=new ls({mapValue:{fields:i.document.fields}}),g=vn.newFoundDocument(o,l,u,d),m=i.targetIds||[],T=i.removedTargetIds||[];t=new wd(m,T,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Um(n,i.document),l=i.readTime?Xs(i.readTime):qe.min(),u=vn.newNoDocument(o,l),d=i.removedTargetIds||[];t=new wd([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Um(n,i.document),l=i.removedTargetIds||[];t=new wd([],l,o,null)}else{if(!("filter"in e))return Ue(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:l}=i,u=new I2(o,l),d=i.targetId;t=new wb(d,u)}}return t}function j2(n,e){let t;if(e instanceof ku)t={update:nE(n,e.key,e.value)};else if(e instanceof Qp)t={delete:vp(n,e.key)};else if(e instanceof Do)t={update:nE(n,e.key,e.data),updateMask:K2(e.fieldMask)};else{if(!(e instanceof S2))return Ue(16599,{Vt:e.type});t={verify:vp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const d=u.transform;if(d instanceof zd)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Iu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Nu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Hd)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw Ue(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:U2(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ue(27497)})(n,e.precondition)),t}function F2(n,e){return n&&n.length>0?(dt(e!==void 0,14353),n.map((t=>(function(o,l){let u=o.updateTime?Xs(o.updateTime):Xs(l);return u.isEqual(qe.min())&&(u=Xs(l)),new x2(u,o.transformResults||[])})(t,e)))):[]}function B2(n,e){return{documents:[Db(n,e.path)]}}function z2(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Db(n,o);const l=(function(m){if(m.length!==0)return kb(ti.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((T=>(function(b){return{field:Ca(b.field),direction:$2(b.dir)}})(T)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=gp(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:o}}function H2(n){let e=O2(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){dt(i===1,65062);const T=t.from[0];T.allDescendants?o=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(E){const b=Pb(E);return b instanceof ti&&cb(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((b=>(function(V){return new Bd(wa(V.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(b)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let b;return b=typeof E=="object"?E.value:E,cf(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(E){const b=!!E.before,I=E.values||[];return new Fd(I,b)})(t.startAt));let m=null;return t.endAt&&(m=(function(E){const b=!E.before,I=E.values||[];return new Fd(I,b)})(t.endAt)),l2(e,o,u,l,d,"F",g,m)}function G2(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ue(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Pb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=wa(t.unaryFilter.field);return Zt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=wa(t.unaryFilter.field);return Zt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=wa(t.unaryFilter.field);return Zt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=wa(t.unaryFilter.field);return Zt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ue(61313);default:return Ue(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Zt.create(wa(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ue(58110);default:return Ue(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ti.create(t.compositeFilter.filters.map((i=>Pb(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ue(1026)}})(t.compositeFilter.op))})(n):Ue(30097,{filter:n})}function $2(n){return P2[n]}function Y2(n){return k2[n]}function J2(n){return V2[n]}function Ca(n){return{fieldPath:n.canonicalString()}}function wa(n){return an.fromServerFormat(n.fieldPath)}function kb(n){return n instanceof Zt?(function(t){if(t.op==="=="){if(zT(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NAN"}};if(BT(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(zT(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NOT_NAN"}};if(BT(t.value))return{unaryFilter:{field:Ca(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ca(t.field),op:Y2(t.op),value:t.value}}})(n):n instanceof ti?(function(t){const i=t.getFilters().map((o=>kb(o)));return i.length===1?i[0]:{compositeFilter:{op:J2(t.op),filters:i}}})(n):Ue(54877,{filter:n})}function K2(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Vb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,t,i,o,l=qe.min(),u=qe.min(),d=ln.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=g}withSequenceNumber(e){return new Cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e){this.yt=e}}function X2(n){const e=H2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?pp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this.Cn=new Z2}addToCollectionParentIndex(e,t){return this.Cn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Mr.min())}updateCollectionGroup(e,t,i){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class Z2{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new en(wt.comparator),l=!o.has(i);return this.index[t]=o.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new en(wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Lb=41943040;class Pn{static withCacheSize(e){return new Pn(e,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pn.DEFAULT_COLLECTION_PERCENTILE=10,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pn.DEFAULT=new Pn(Lb,Pn.DEFAULT_COLLECTION_PERCENTILE,Pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pn.DISABLED=new Pn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ya(0)}static cr(){return new Ya(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="LruGarbageCollector",ek=1048576;function rE([n,e],[t,i]){const o=tt(n,t);return o===0?tt(e,i):o}class tk{constructor(e){this.Ir=e,this.buffer=new en(rE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();rE(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class nk{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){be(iE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){il(t)?be(iE,"Ignoring IndexedDB error during garbage collection: ",t):await sl(t)}await this.Vr(3e5)}))}}class sk{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(uf.ce);const i=new tk(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(be("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(sE)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(be("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sE):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,l,u,d,g,m;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,u=Date.now(),this.nthSequenceNumber(e,o)))).next((E=>(i=E,d=Date.now(),this.removeTargets(e,i,t)))).next((E=>(l=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(m=Date.now(),Aa()<=et.DEBUG&&be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-T}ms
	Determined least recently used ${o} in `+(d-u)+`ms
	Removed ${l} targets in `+(g-d)+`ms
	Removed ${E} documents in `+(m-g)+`ms
Total Duration: ${m-T}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:E}))))}}function ik(n,e){return new sk(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(){this.changes=new Ro((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,vn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ue.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&Eu(i.mutation,o,bs.empty(),Et.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,nt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=nt()){const o=_o();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((l=>{let u=mu();return l.forEach(((d,g)=>{u=u.insert(d,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=_o();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,nt())))}populateOverlays(e,t,i){const o=[];return i.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,i,o){let l=qi();const u=Tu(),d=(function(){return Tu()})();return t.forEach(((g,m)=>{const T=i.get(m.key);o.has(m.key)&&(T===void 0||T.mutation instanceof Do)?l=l.insert(m.key,m):T!==void 0?(u.set(m.key,T.mutation.getFieldMask()),Eu(T.mutation,m,T.mutation.getFieldMask(),Et.now())):u.set(m.key,bs.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,T)=>u.set(m,T))),t.forEach(((m,T)=>d.set(m,new ok(T,u.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=Tu();let o=new Rt(((u,d)=>u-d)),l=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let T=i.get(g)||bs.empty();T=d.applyToLocalView(m,T),i.set(g,T);const E=(o.get(d.batchId)||nt()).add(g);o=o.insert(d.batchId,E)}))})).next((()=>{const u=[],d=o.getReverseIterator();for(;d.hasNext();){const g=d.getNext(),m=g.key,T=g.value,E=vb();T.forEach((b=>{if(!l.has(b)){const I=Ab(t.get(b),i.get(b));I!==null&&E.set(b,I),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,E))}return ue.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(u){return Me.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):u2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((l=>{const u=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-l.size):ue.resolve(_o());let d=Su,g=l;return u.next((m=>ue.forEach(m,((T,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),l.get(T)?ue.resolve():this.remoteDocumentCache.getEntry(e,T).next((b=>{g=g.insert(T,b)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,nt()))).next((T=>({batchId:d,changes:yb(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Me(t)).next((i=>{let o=mu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const l=t.collectionGroup;let u=mu();return this.indexManager.getCollectionParents(e,l).next((d=>ue.forEach(d,(g=>{const m=(function(E,b){return new ff(b,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next((T=>{T.forEach(((E,b)=>{u=u.insert(E,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,o)))).next((u=>{l.forEach(((g,m)=>{const T=m.getKey();u.get(T)===null&&(u=u.insert(T,vn.newInvalidDocument(T)))}));let d=mu();return u.forEach(((g,m)=>{const T=l.get(g);T!==void 0&&Eu(T.mutation,m,bs.empty(),Et.now()),mf(t,m)&&(d=d.insert(g,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ue.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Xs(o.createTime)}})(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:X2(o.bundledQuery),readTime:Xs(o.readTime)}})(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.overlays=new Rt(Me.comparator),this.qr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const i=_o();return ue.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&i.set(o,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,l)=>{this.St(e,t,l)})),ue.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ue.resolve()}getOverlaysForCollection(e,t,i){const o=_o(),l=t.length+1,u=new Me(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const g=d.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&o.set(g.getKey(),g)}return ue.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let l=new Rt(((m,T)=>m-T));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let T=l.get(m.largestBatchId);T===null&&(T=_o(),l=l.insert(m.largestBatchId,T)),T.set(m.getKey(),m)}}const d=_o(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,T)=>d.set(m,T))),!(d.size()>=o)););return ue.resolve(d)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new w2(t,i));let l=this.qr.get(t);l===void 0&&(l=nt(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(){this.Qr=new en(on.$r),this.Ur=new en(on.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new on(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new on(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Me(new wt([])),i=new on(t,e),o=new on(t,e+1),l=[];return this.Ur.forEachInRange([i,o],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Me(new wt([])),i=new on(t,e),o=new on(t,e+1);let l=nt();return this.Ur.forEachInRange([i,o],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new on(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class on{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Me.comparator(e.key,t.key)||tt(e.Yr,t.Yr)}static Kr(e,t){return tt(e.Yr,t.Yr)||Me.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new en(on.$r)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new C2(l,t,i,o);this.mutationQueue.push(u);for(const d of o)this.Zr=this.Zr.add(new on(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ue.resolve(u)}lookupMutationBatch(e,t){return ue.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),l=o<0?0:o;return ue.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?zp:this.tr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new on(t,0),o=new on(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,o],(u=>{const d=this.Xr(u.Yr);l.push(d)})),ue.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new en(tt);return t.forEach((o=>{const l=new on(o,0),u=new on(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(d=>{i=i.add(d.Yr)}))})),ue.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let l=i;Me.isDocumentKey(l)||(l=l.child(""));const u=new on(new Me(l),0);let d=new en(tt);return this.Zr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(d=d.add(g.Yr)),!0)}),u),ue.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){dt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ue.forEach(t.mutations,(o=>{const l=new on(o.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new on(t,0),o=this.Zr.firstAfterOrEqual(i);return ue.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e){this.ri=e,this.docs=(function(){return new Rt(Me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),l=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ue.resolve(i?i.document.mutableCopy():vn.newInvalidDocument(t))}getEntries(e,t){let i=qi();return t.forEach((o=>{const l=this.docs.get(o);i=i.insert(o,l?l.document.mutableCopy():vn.newInvalidDocument(o))})),ue.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let l=qi();const u=t.path,d=new Me(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(d);for(;g.hasNext();){const{key:m,value:{document:T}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||jP(qP(T),i)<=0||(o.has(T.key)||mf(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return ue.resolve(l)}getAllFromCollectionGroup(e,t,i,o){Ue(9500)}ii(e,t){return ue.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new hk(this)}getSize(e){return ue.resolve(this.size)}}class hk extends rk{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),ue.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e){this.persistence=e,this.si=new Ro((t=>$p(t)),Yp),this.lastRemoteSnapshotVersion=qe.min(),this.highestTargetId=0,this.oi=0,this._i=new eg,this.targetCount=0,this.ai=Ya.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),ue.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ya(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Pr(t),ue.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,i){let o=0;const l=[];return this.si.forEach(((u,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),ue.waitFor(l).next((()=>o))}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return ue.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),ue.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((u=>{l.push(o.markPotentiallyOrphaned(e,u))})),ue.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return ue.resolve(i)}containsKey(e,t){return ue.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t){this.ui={},this.overlays={},this.ci=new uf(0),this.li=!1,this.li=!0,this.hi=new ck,this.referenceDelegate=e(this),this.Pi=new mk(this),this.indexManager=new W2,this.remoteDocumentCache=(function(o){return new fk(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new Q2(t),this.Ii=new lk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uk,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new dk(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){be("MemoryPersistence","Starting transaction:",e);const o=new pk(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return ue.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class pk extends BP{constructor(e){super(),this.currentSequenceNumber=e}}class tg{constructor(e){this.persistence=e,this.Ri=new eg,this.Vi=null}static mi(e){return new tg(e)}get fi(){if(this.Vi)return this.Vi;throw Ue(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),ue.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.fi,(i=>{const o=Me.fromPath(i);return this.gi(e,o).next((l=>{l||t.removeEntry(o,qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ue.or([()=>ue.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class $d{constructor(e,t){this.persistence=e,this.pi=new Ro((i=>GP(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=ik(this,t)}static mi(e,t){return new $d(e,t)}Ei(){}di(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return ue.forEach(this.pi,((i,o)=>this.br(e,i,o).next((l=>l?ue.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((d=>{d||(i++,l.removeEntry(u,qe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ad(e.data.value)),t}br(e,t,i){return ue.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return ue.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=nt(),o=nt();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new ng(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return uM()?8:zP(Tn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,o,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new gk;return this.Ss(e,t,u).next((d=>{if(l.result=d,this.Vs)return this.bs(e,t,u,d.size)}))})).next((()=>l.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(Aa()<=et.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",Sa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ue.resolve()):(Aa()<=et.DEBUG&&be("QueryEngine","Query:",Sa(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(Aa()<=et.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",Sa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):ue.resolve())}ys(e,t){if(YT(t))return ue.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=pp(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=nt(...l);return this.ps.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.Ds(t,d);return this.Cs(t,m,u,g.readTime)?this.ys(e,pp(t,null,"F")):this.vs(e,m,t,g)}))))})))))}ws(e,t,i,o){return YT(t)||o.isEqual(qe.min())?ue.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,i,o)?ue.resolve(null):(Aa()<=et.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Sa(t)),this.vs(e,u,t,OP(o,Su)).next((d=>d)))}))}Ds(e,t){let i=new en(pb(e));return t.forEach(((o,l)=>{mf(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,i){return Aa()<=et.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",Sa(t)),this.ps.getDocumentsMatchingQuery(e,t,Mr.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg="LocalStore",vk=3e8;class _k{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new Rt(tt),this.xs=new Ro((l=>$p(l)),Yp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ak(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Tk(n,e,t,i){return new _k(n,e,t,i)}async function Ob(n,e){const t=Fe(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],d=[];let g=nt();for(const m of o){u.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}for(const m of l){d.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ls:m,removedBatchIds:u,addedBatchIds:d})))}))}))}function Ek(n,e){const t=Fe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,g,m,T){const E=m.batch,b=E.keys();let I=ue.resolve();return b.forEach((V=>{I=I.next((()=>T.getEntry(g,V))).next((L=>{const j=m.docVersions.get(V);dt(j!==null,48541),L.version.compareTo(j)<0&&(E.applyToRemoteDocument(L,m),L.isValidDocument()&&(L.setReadTime(m.commitVersion),T.addEntry(L)))}))})),I.next((()=>d.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let g=nt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(g=g.add(d.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function qb(n){const e=Fe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function xk(n,e){const t=Fe(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const d=[];e.targetChanges.forEach(((T,E)=>{const b=o.get(E);if(!b)return;d.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,E))));let I=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?I=I.withResumeToken(ln.EMPTY_BYTE_STRING,qe.min()).withLastLimboFreeSnapshotVersion(qe.min()):T.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(T.resumeToken,i)),o=o.insert(E,I),(function(L,j,$){return L.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=vk?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(b,I,T)&&d.push(t.Pi.updateTargetData(l,I))}));let g=qi(),m=nt();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),d.push(bk(l,u,e.documentUpdates).next((T=>{g=T.ks,m=T.qs}))),!i.isEqual(qe.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((E=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(T)}return ue.waitFor(d).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.Ms=o,l)))}function bk(n,e,t){let i=nt(),o=nt();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=qi();return t.forEach(((d,g)=>{const m=l.get(d);g.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(d)),g.isNoDocument()&&g.version.isEqual(qe.min())?(e.removeEntry(d,g.readTime),u=u.insert(d,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(d,g)):be(sg,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",g.version)})),{ks:u,qs:o}}))}function Ak(n,e){const t=Fe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=zp),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Sk(n,e){const t=Fe(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((l=>l?(o=l,ue.resolve(o)):t.Pi.allocateTargetId(i).next((u=>(o=new Cr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Tp(n,e,t){const i=Fe(n),o=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!il(u))throw u;be(sg,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function oE(n,e,t){const i=Fe(n);let o=qe.min(),l=nt();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,m,T){const E=Fe(g),b=E.xs.get(T);return b!==void 0?ue.resolve(E.Ms.get(b)):E.Pi.getTargetData(m,T)})(i,u,Ks(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,d.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?o:qe.min(),t?l:nt()))).next((d=>(Ck(i,d2(e),d),{documents:d,Qs:l})))))}function Ck(n,e,t){let i=n.Os.get(e)||qe.min();t.forEach(((o,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class aE{constructor(){this.activeTargetIds=y2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wk{constructor(){this.Mo=new aE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new aE,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE="ConnectivityMonitor";class uE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){be(lE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){be(lE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yd=null;function Ep(){return yd===null?yd=(function(){return 268435456+Math.round(2147483648*Math.random())})():yd++,"0x"+yd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="RestConnection",Nk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Rk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===qd?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,l){const u=Ep(),d=this.zo(e,t.toUriEncodedString());be(Om,`Sending RPC '${e}' ${u}:`,d,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,o,l);const{host:m}=new URL(d),T=el(m);return this.Jo(e,d,g,i,T).then((E=>(be(Om,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw So(Om,`RPC '${e}' ${u} failed with error: `,E,"url: ",d,"request:",i),E}))}Ho(e,t,i,o,l,u){return this.Go(e,t,i,o,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),i&&i.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const i=Nk[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="WebChannelConnection";class Mk extends Rk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,l){const u=Ep();return new Promise(((d,g)=>{const m=new Fx;m.setWithCredentials(!0),m.listenOnce(Bx.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case bd.NO_ERROR:const E=m.getResponseJson();be(gn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),d(E);break;case bd.TIMEOUT:be(gn,`RPC '${e}' ${u} timed out`),g(new Ce(fe.DEADLINE_EXCEEDED,"Request time out"));break;case bd.HTTP_ERROR:const b=m.getStatus();if(be(gn,`RPC '${e}' ${u} failed with status:`,b,"response text:",m.getResponseText()),b>0){let I=m.getResponseJson();Array.isArray(I)&&(I=I[0]);const V=I==null?void 0:I.error;if(V&&V.status&&V.message){const L=(function($){const J=$.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(J)>=0?J:fe.UNKNOWN})(V.status);g(new Ce(L,V.message))}else g(new Ce(fe.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new Ce(fe.UNAVAILABLE,"Connection failed."));break;default:Ue(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{be(gn,`RPC '${e}' ${u} completed.`)}}));const T=JSON.stringify(o);be(gn,`RPC '${e}' ${u} sending request:`,o),m.send(t,"POST",T,i,15)}))}T_(e,t,i){const o=Ep(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Gx(),d=Hx(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(g.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const T=l.join("");be(gn,`Creating RPC '${e}' stream ${o}: ${T}`,g);const E=u.createWebChannel(T,g);this.I_(E);let b=!1,I=!1;const V=new Dk({Yo:j=>{I?be(gn,`Not sending because RPC '${e}' stream ${o} is closed:`,j):(b||(be(gn,`Opening RPC '${e}' stream ${o} transport.`),E.open(),b=!0),be(gn,`RPC '${e}' stream ${o} sending:`,j),E.send(j))},Zo:()=>E.close()}),L=(j,$,J)=>{j.listen($,(ee=>{try{J(ee)}catch(q){setTimeout((()=>{throw q}),0)}}))};return L(E,hu.EventType.OPEN,(()=>{I||(be(gn,`RPC '${e}' stream ${o} transport opened.`),V.o_())})),L(E,hu.EventType.CLOSE,(()=>{I||(I=!0,be(gn,`RPC '${e}' stream ${o} transport closed`),V.a_(),this.E_(E))})),L(E,hu.EventType.ERROR,(j=>{I||(I=!0,So(gn,`RPC '${e}' stream ${o} transport errored. Name:`,j.name,"Message:",j.message),V.a_(new Ce(fe.UNAVAILABLE,"The operation could not be completed")))})),L(E,hu.EventType.MESSAGE,(j=>{var $;if(!I){const J=j.data[0];dt(!!J,16349);const ee=J,q=(ee==null?void 0:ee.error)||(($=ee[0])==null?void 0:$.error);if(q){be(gn,`RPC '${e}' stream ${o} received error:`,q);const X=q.status;let z=(function(D){const w=Kt[D];if(w!==void 0)return Cb(w)})(X),R=q.message;z===void 0&&(z=fe.INTERNAL,R="Unknown error status: "+X+" with message "+q.message),I=!0,V.a_(new Ce(z,R)),E.close()}else be(gn,`RPC '${e}' stream ${o} received:`,J),V.u_(J)}})),L(d,zx.STAT_EVENT,(j=>{j.stat===up.PROXY?be(gn,`RPC '${e}' stream ${o} detected buffering proxy`):j.stat===up.NOPROXY&&be(gn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{V.__()}),0),V}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function qm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(n){return new L2(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t,i=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&be("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="PersistentStream";class Fb{constructor(e,t,i,o,l,u,d,g){this.Mi=e,this.S_=i,this.b_=o,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new jb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Ui(t.toString()),Ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ce(fe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return be(cE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(be(cE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Pk extends Fb{constructor(e,t,i,o,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=q2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return qe.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?qe.min():u.readTime?Xs(u.readTime):qe.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=_p(this.serializer),t.addTarget=(function(l,u){let d;const g=u.target;if(d=mp(g)?{documents:B2(l,g)}:{query:z2(l,g).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=Nb(l,u.resumeToken);const m=gp(l,u.expectedCount);m!==null&&(d.expectedCount=m)}else if(u.snapshotVersion.compareTo(qe.min())>0){d.readTime=Gd(l,u.snapshotVersion.toTimestamp());const m=gp(l,u.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const i=G2(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=_p(this.serializer),t.removeTarget=e,this.q_(t)}}class kk extends Fb{constructor(e,t,i,o,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return dt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,dt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){dt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=F2(e.writeResults,e.commitTime),i=Xs(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=_p(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>j2(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{}class Lk extends Vk{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ce(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,yp(t,i),o,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ce(fe.UNKNOWN,l.toString())}))}Ho(e,t,i,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Ho(e,yp(t,i),o,u,d,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(fe.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Uk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ui(t),this.aa=!1):be("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="RemoteStore";class Ok{constructor(e,t,i,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Mo(this)&&(be(Co,"Restarting streams for network reachability change."),await(async function(g){const m=Fe(g);m.Ea.add(4),await Lu(m),m.Ra.set("Unknown"),m.Ea.delete(4),await _f(m)})(this))}))})),this.Ra=new Uk(i,o)}}async function _f(n){if(Mo(n))for(const e of n.da)await e(!0)}async function Lu(n){for(const e of n.da)await e(!1)}function Bb(n,e){const t=Fe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ag(t)?og(t):rl(t).O_()&&rg(t,e))}function ig(n,e){const t=Fe(n),i=rl(t);t.Ia.delete(e),i.O_()&&zb(t,e),t.Ia.size===0&&(i.O_()?i.L_():Mo(t)&&t.Ra.set("Unknown"))}function rg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rl(n).Y_(e)}function zb(n,e){n.Va.Ue(e),rl(n).Z_(e)}function og(n){n.Va=new M2({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),rl(n).start(),n.Ra.ua()}function ag(n){return Mo(n)&&!rl(n).x_()&&n.Ia.size>0}function Mo(n){return Fe(n).Ea.size===0}function Hb(n){n.Va=void 0}async function qk(n){n.Ra.set("Online")}async function jk(n){n.Ia.forEach(((e,t)=>{rg(n,e)}))}async function Fk(n,e){Hb(n),ag(n)?(n.Ra.ha(e),og(n)):n.Ra.set("Unknown")}async function Bk(n,e,t){if(n.Ra.set("Online"),e instanceof Ib&&e.state===2&&e.cause)try{await(async function(o,l){const u=l.cause;for(const d of l.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,u),o.Ia.delete(d),o.Va.removeTarget(d))})(n,e)}catch(i){be(Co,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Yd(n,i)}else if(e instanceof wd?n.Va.Ze(e):e instanceof wb?n.Va.st(e):n.Va.tt(e),!t.isEqual(qe.min()))try{const i=await qb(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const d=l.Va.Tt(u);return d.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const T=l.Ia.get(m);T&&l.Ia.set(m,T.withResumeToken(g.resumeToken,u))}})),d.targetMismatches.forEach(((g,m)=>{const T=l.Ia.get(g);if(!T)return;l.Ia.set(g,T.withResumeToken(ln.EMPTY_BYTE_STRING,T.snapshotVersion)),zb(l,g);const E=new Cr(T.target,g,m,T.sequenceNumber);rg(l,E)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){be(Co,"Failed to raise snapshot:",i),await Yd(n,i)}}async function Yd(n,e,t){if(!il(e))throw e;n.Ea.add(1),await Lu(n),n.Ra.set("Offline"),t||(t=()=>qb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{be(Co,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await _f(n)}))}function Gb(n,e){return e().catch((t=>Yd(n,t,e)))}async function Tf(n){const e=Fe(n),t=Lr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:zp;for(;zk(e);)try{const o=await Ak(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,Hk(e,o)}catch(o){await Yd(e,o)}$b(e)&&Yb(e)}function zk(n){return Mo(n)&&n.Ta.length<10}function Hk(n,e){n.Ta.push(e);const t=Lr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function $b(n){return Mo(n)&&!Lr(n).x_()&&n.Ta.length>0}function Yb(n){Lr(n).start()}async function Gk(n){Lr(n).ra()}async function $k(n){const e=Lr(n);for(const t of n.Ta)e.ea(t.mutations)}async function Yk(n,e,t){const i=n.Ta.shift(),o=Xp.from(i,e,t);await Gb(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Tf(n)}async function Jk(n,e){e&&Lr(n).X_&&await(async function(i,o){if((function(u){return N2(u)&&u!==fe.ABORTED})(o.code)){const l=i.Ta.shift();Lr(i).B_(),await Gb(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,o))),await Tf(i)}})(n,e),$b(n)&&Yb(n)}async function dE(n,e){const t=Fe(n);t.asyncQueue.verifyOperationInProgress(),be(Co,"RemoteStore received new credentials");const i=Mo(t);t.Ea.add(3),await Lu(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _f(t)}async function Kk(n,e){const t=Fe(n);e?(t.Ea.delete(2),await _f(t)):e||(t.Ea.add(2),await Lu(t),t.Ra.set("Unknown"))}function rl(n){return n.ma||(n.ma=(function(t,i,o){const l=Fe(t);return l.sa(),new Pk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:qk.bind(null,n),t_:jk.bind(null,n),r_:Fk.bind(null,n),H_:Bk.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),ag(n)?og(n):n.Ra.set("Unknown")):(await n.ma.stop(),Hb(n))}))),n.ma}function Lr(n){return n.fa||(n.fa=(function(t,i,o){const l=Fe(t);return l.sa(),new kk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Gk.bind(null,n),r_:Jk.bind(null,n),ta:$k.bind(null,n),na:Yk.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Tf(n)):(await n.fa.stop(),n.Ta.length>0&&(be(Co,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,t,i,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=l,this.deferred=new Pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,l){const u=Date.now()+i,d=new lg(e,t,u,o,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ug(n,e){if(Ui("AsyncQueue",`${e}: ${n}`),il(n))return new Ce(fe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{static emptySet(e){return new Ua(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Me.comparator(t.key,i.key):(t,i)=>Me.comparator(t.key,i.key),this.keyedMap=mu(),this.sortedSet=new Rt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ua)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ua;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(){this.ga=new Rt(Me.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ue(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Ja{constructor(e,t,i,o,l,u,d,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,l){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new Ja(e,t,Ua.emptySet(t),u,i,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Xk{constructor(){this.queries=hE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=Fe(t),l=o.queries;o.queries=hE(),l.forEach(((u,d)=>{for(const g of d.Sa)g.onError(i)}))})(this,new Ce(fe.ABORTED,"Firestore shutting down"))}}function hE(){return new Ro((n=>mb(n)),hf)}async function Jb(n,e){const t=Fe(n);let i=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(i=2):(l=new Qk,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const d=ug(u,`Initialization of query '${Sa(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&cg(t)}async function Kb(n,e){const t=Fe(n),i=e.query;let o=3;const l=t.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Wk(n,e){const t=Fe(n);let i=!1;for(const o of e){const l=o.query,u=t.queries.get(l);if(u){for(const d of u.Sa)d.Fa(o)&&(i=!0);u.wa=o}}i&&cg(t)}function Zk(n,e,t){const i=Fe(n),o=i.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);i.queries.delete(e)}function cg(n){n.Ca.forEach((e=>{e.next()}))}var xp,mE;(mE=xp||(xp={})).Ma="default",mE.Cache="cache";class Qb{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new Ja(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ja.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.key=e}}class Wb{constructor(e){this.key=e}}class eV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=nt(),this.mutatedKeys=nt(),this.eu=pb(e),this.tu=new Ua(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new fE,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=o,d=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((T,E)=>{const b=o.get(T),I=mf(this.query,E)?E:null,V=!!b&&this.mutatedKeys.has(b.key),L=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let j=!1;b&&I?b.data.isEqual(I.data)?V!==L&&(i.track({type:3,doc:I}),j=!0):this.su(b,I)||(i.track({type:2,doc:I}),j=!0,(g&&this.eu(I,g)>0||m&&this.eu(I,m)<0)&&(d=!0)):!b&&I?(i.track({type:0,doc:I}),j=!0):b&&!I&&(i.track({type:1,doc:b}),j=!0,(g||m)&&(d=!0)),j&&(I?(u=u.add(I),l=L?l.add(T):l.delete(T)):(u=u.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const T=this.query.limitType==="F"?u.last():u.first();u=u.delete(T.key),l=l.delete(T.key),i.track({type:1,doc:T})}return{tu:u,iu:i,Cs:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((T,E)=>(function(I,V){const L=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ue(20277,{Rt:j})}};return L(I)-L(V)})(T.type,E.type)||this.eu(T.doc,E.doc))),this.ou(i),o=o??!1;const d=t&&!o?this._u():[],g=this.Xa.size===0&&this.current&&!o?1:0,m=g!==this.Za;return this.Za=g,u.length!==0||m?{snapshot:new Ja(this.query,e.tu,l,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new fE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=nt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Wb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Xb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=nt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ja.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dg="SyncEngine";class tV{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class nV{constructor(e){this.key=e,this.hu=!1}}class sV{constructor(e,t,i,o,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ro((d=>mb(d)),hf),this.Iu=new Map,this.Eu=new Set,this.du=new Rt(Me.comparator),this.Au=new Map,this.Ru=new eg,this.Vu={},this.mu=new Map,this.fu=Ya.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function iV(n,e,t=!0){const i=iA(n);let o;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await Zb(i,e,t,!0),o}async function rV(n,e){const t=iA(n);await Zb(t,e,!0,!1)}async function Zb(n,e,t,i){const o=await Sk(n.localStore,Ks(e)),l=o.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await oV(n,e,l,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&Bb(n.remoteStore,o),d}async function oV(n,e,t,i,o){n.pu=(E,b,I)=>(async function(L,j,$,J){let ee=j.view.ru($);ee.Cs&&(ee=await oE(L.localStore,j.query,!1).then((({documents:R})=>j.view.ru(R,ee))));const q=J&&J.targetChanges.get(j.targetId),X=J&&J.targetMismatches.get(j.targetId)!=null,z=j.view.applyChanges(ee,L.isPrimaryClient,q,X);return gE(L,j.targetId,z.au),z.snapshot})(n,E,b,I);const l=await oE(n.localStore,e,!0),u=new eV(e,l.Qs),d=u.ru(l.documents),g=Vu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),m=u.applyChanges(d,n.isPrimaryClient,g);gE(n,t,m.au);const T=new tV(e,t,u);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function aV(n,e,t){const i=Fe(n),o=i.Tu.get(e),l=i.Iu.get(o.targetId);if(l.length>1)return i.Iu.set(o.targetId,l.filter((u=>!hf(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Tp(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&ig(i.remoteStore,o.targetId),bp(i,o.targetId)})).catch(sl)):(bp(i,o.targetId),await Tp(i.localStore,o.targetId,!0))}async function lV(n,e){const t=Fe(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ig(t.remoteStore,i.targetId))}async function uV(n,e,t){const i=gV(n);try{const o=await(function(u,d){const g=Fe(u),m=Et.now(),T=d.reduce(((I,V)=>I.add(V.key)),nt());let E,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let V=qi(),L=nt();return g.Ns.getEntries(I,T).next((j=>{V=j,V.forEach((($,J)=>{J.isValidDocument()||(L=L.add($))}))})).next((()=>g.localDocuments.getOverlayedDocuments(I,V))).next((j=>{E=j;const $=[];for(const J of d){const ee=A2(J,E.get(J.key).overlayedDocument);ee!=null&&$.push(new Do(J.key,ee,ab(ee.value.mapValue),Qs.exists(!0)))}return g.mutationQueue.addMutationBatch(I,m,$,d)})).next((j=>{b=j;const $=j.applyToLocalDocumentSet(E,L);return g.documentOverlayCache.saveOverlays(I,j.batchId,$)}))})).then((()=>({batchId:b.batchId,changes:yb(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(u,d,g){let m=u.Vu[u.currentUser.toKey()];m||(m=new Rt(tt)),m=m.insert(d,g),u.Vu[u.currentUser.toKey()]=m})(i,o.batchId,t),await Uu(i,o.changes),await Tf(i.remoteStore)}catch(o){const l=ug(o,"Failed to persist write");t.reject(l)}}async function eA(n,e){const t=Fe(n);try{const i=await xk(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const u=t.Au.get(l);u&&(dt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?dt(u.hu,14607):o.removedDocuments.size>0&&(dt(u.hu,42227),u.hu=!1))})),await Uu(t,i,e)}catch(i){await sl(i)}}function pE(n,e,t){const i=Fe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((l,u)=>{const d=u.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(u,d){const g=Fe(u);g.onlineState=d;let m=!1;g.queries.forEach(((T,E)=>{for(const b of E.Sa)b.va(d)&&(m=!0)})),m&&cg(g)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cV(n,e,t){const i=Fe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),l=o&&o.key;if(l){let u=new Rt(Me.comparator);u=u.insert(l,vn.newNoDocument(l,qe.min()));const d=nt().add(l),g=new yf(qe.min(),new Map,new Rt(tt),u,d);await eA(i,g),i.du=i.du.remove(l),i.Au.delete(e),fg(i)}else await Tp(i.localStore,e,!1).then((()=>bp(i,e,t))).catch(sl)}async function dV(n,e){const t=Fe(n),i=e.batch.batchId;try{const o=await Ek(t.localStore,e);nA(t,i,null),tA(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Uu(t,o)}catch(o){await sl(o)}}async function fV(n,e,t){const i=Fe(n);try{const o=await(function(u,d){const g=Fe(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let T;return g.mutationQueue.lookupMutationBatch(m,d).next((E=>(dt(E!==null,37113),T=E.keys(),g.mutationQueue.removeMutationBatch(m,E)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,T,d))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,T))).next((()=>g.localDocuments.getDocuments(m,T)))}))})(i.localStore,e);nA(i,e,t),tA(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Uu(i,o)}catch(o){await sl(o)}}function tA(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function nA(n,e,t){const i=Fe(n);let o=i.Vu[i.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),i.Vu[i.currentUser.toKey()]=o}}function bp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||sA(n,i)}))}function sA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(ig(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),fg(n))}function gE(n,e,t){for(const i of t)i instanceof Xb?(n.Ru.addReference(i.key,e),hV(n,i)):i instanceof Wb?(be(dg,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||sA(n,i.key)):Ue(19791,{wu:i})}function hV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(be(dg,"New document in limbo: "+t),n.Eu.add(i),fg(n))}function fg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Me(wt.fromString(e)),i=n.fu.next();n.Au.set(i,new nV(t)),n.du=n.du.insert(t,i),Bb(n.remoteStore,new Cr(Ks(Jp(t.path)),i,"TargetPurposeLimboResolution",uf.ce))}}async function Uu(n,e,t){const i=Fe(n),o=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,g)=>{u.push(i.pu(g,e,t).then((m=>{var T;if((m||t)&&i.isPrimaryClient){const E=m?!m.fromCache:(T=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:T.current;i.sharedClientState.updateQueryState(g.targetId,E?"current":"not-current")}if(m){o.push(m);const E=ng.As(g.targetId,m);l.push(E)}})))})),await Promise.all(u),i.Pu.H_(o),await(async function(g,m){const T=Fe(g);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>ue.forEach(m,(b=>ue.forEach(b.Es,(I=>T.persistence.referenceDelegate.addReference(E,b.targetId,I))).next((()=>ue.forEach(b.ds,(I=>T.persistence.referenceDelegate.removeReference(E,b.targetId,I)))))))))}catch(E){if(!il(E))throw E;be(sg,"Failed to update sequence numbers: "+E)}for(const E of m){const b=E.targetId;if(!E.fromCache){const I=T.Ms.get(b),V=I.snapshotVersion,L=I.withLastLimboFreeSnapshotVersion(V);T.Ms=T.Ms.insert(b,L)}}})(i.localStore,l))}async function mV(n,e){const t=Fe(n);if(!t.currentUser.isEqual(e)){be(dg,"User change. New user:",e.toKey());const i=await Ob(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((d=>{d.forEach((g=>{g.reject(new Ce(fe.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Uu(t,i.Ls)}}function pV(n,e){const t=Fe(n),i=t.Au.get(e);if(i&&i.hu)return nt().add(i.key);{let o=nt();const l=t.Iu.get(e);if(!l)return o;for(const u of l){const d=t.Tu.get(u);o=o.unionWith(d.view.nu)}return o}}function iA(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=eA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cV.bind(null,e),e.Pu.H_=Wk.bind(null,e.eventManager),e.Pu.yu=Zk.bind(null,e.eventManager),e}function gV(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fV.bind(null,e),e}class Jd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Tk(this.persistence,new yk,e.initialUser,this.serializer)}Cu(e){return new Ub(tg.mi,this.serializer)}Du(e){return new wk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jd.provider={build:()=>new Jd};class yV extends Jd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){dt(this.persistence.referenceDelegate instanceof $d,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new nk(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Pn.withCacheSize(this.cacheSizeBytes):Pn.DEFAULT;return new Ub((i=>$d.mi(i,t)),this.serializer)}}class Ap{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>pE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=mV.bind(null,this.syncEngine),await Kk(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Xk})()}createDatastore(e){const t=vf(e.databaseInfo.databaseId),i=(function(l){return new Mk(l)})(e.databaseInfo);return(function(l,u,d,g){return new Lk(l,u,d,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,l,u,d){return new Ok(i,o,l,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>pE(this.syncEngine,t,0)),(function(){return uE.v()?new uE:new Ik})())}createSyncEngine(e,t){return(function(o,l,u,d,g,m,T){const E=new sV(o,l,u,d,g,m);return T&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const l=Fe(o);be(Co,"RemoteStore shutting down."),l.Ea.add(5),await Lu(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Ap.provider={build:()=>new Ap};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur="FirestoreClient";class vV{constructor(e,t,i,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=yn.UNAUTHENTICATED,this.clientId=lf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{be(Ur,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(be(Ur,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ug(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function jm(n,e){n.asyncQueue.verifyOperationInProgress(),be(Ur,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Ob(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function yE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _V(n);be(Ur,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>dE(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>dE(e.remoteStore,o))),n._onlineComponents=e}async function _V(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){be(Ur,"Using user provided OfflineComponentProvider");try{await jm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===fe.FAILED_PRECONDITION||o.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;So("Error using user provided cache. Falling back to memory cache: "+t),await jm(n,new Jd)}}else be(Ur,"Using default OfflineComponentProvider"),await jm(n,new yV(void 0));return n._offlineComponents}async function oA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(be(Ur,"Using user provided OnlineComponentProvider"),await yE(n,n._uninitializedComponentsProvider._online)):(be(Ur,"Using default OnlineComponentProvider"),await yE(n,new Ap))),n._onlineComponents}function TV(n){return oA(n).then((e=>e.syncEngine))}async function aA(n){const e=await oA(n),t=e.eventManager;return t.onListen=iV.bind(null,e.syncEngine),t.onUnlisten=aV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lV.bind(null,e.syncEngine),t}function EV(n,e,t={}){const i=new Pi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const T=new rA({next:b=>{T.Nu(),u.enqueueAndForget((()=>Kb(l,E)));const I=b.docs.has(d);!I&&b.fromCache?m.reject(new Ce(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&b.fromCache&&g&&g.source==="server"?m.reject(new Ce(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(b)},error:b=>m.reject(b)}),E=new Qb(Jp(d.path),T,{includeMetadataChanges:!0,qa:!0});return Jb(l,E)})(await aA(n),n.asyncQueue,e,t,i))),i.promise}function xV(n,e,t={}){const i=new Pi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const T=new rA({next:b=>{T.Nu(),u.enqueueAndForget((()=>Kb(l,E))),b.fromCache&&g.source==="server"?m.reject(new Ce(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(b)},error:b=>m.reject(b)}),E=new Qb(d,T,{includeMetadataChanges:!0,qa:!0});return Jb(l,E)})(await aA(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="firestore.googleapis.com",_E=!0;class TE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uA,this.ssl=_E}else this.host=e.host,this.ssl=e.ssl??_E;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Lb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ek)throw new Ce(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new TE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new TE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Jx;switch(i.type){case"firstParty":return new MP(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ce(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=vE.get(t);i&&(be("ComponentProvider","Removing Datastore"),vE.delete(t),i.terminate())})(this),Promise.resolve()}}function cA(n,e,t,i={}){var m;n=Oi(n,Ef);const o=el(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(Mx(`https://${d}`),Px("Firestore",!0)),l.host!==uA&&l.host!==d&&So("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:d,ssl:o,emulatorOptions:i};if(!xo(g,u)&&(n._setSettings(g),i.mockUserToken)){let T,E;if(typeof i.mockUserToken=="string")T=i.mockUserToken,E=yn.MOCK_USER;else{T=eM(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Ce(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new yn(b)}n._authCredentials=new NP(new Yx(T,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ou(this.firestore,e,this._query)}}class Xt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xt(this.firestore,e,this._key)}toJSON(){return{type:Xt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Pu(t,Xt._jsonSchema))return new Xt(e,i||null,new Me(wt.fromString(t.referencePath)))}}Xt._jsonSchemaVersion="firestore/documentReference/1.0",Xt._jsonSchema={type:Qt("string",Xt._jsonSchemaVersion),referencePath:Qt("string")};class ki extends Ou{constructor(e,t,i){super(e,t,Jp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xt(this.firestore,null,new Me(e))}withConverter(e){return new ki(this.firestore,e,this._path)}}function bV(n,e,...t){if(n=bn(n),Kx("collection","path",e),n instanceof Ef){const i=wt.fromString(e,...t);return kT(i),new ki(n,null,i)}{if(!(n instanceof Xt||n instanceof ki))throw new Ce(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(wt.fromString(e,...t));return kT(i),new ki(n.firestore,null,i)}}function AV(n,e,...t){if(n=bn(n),arguments.length===1&&(e=lf.newId()),Kx("doc","path",e),n instanceof Ef){const i=wt.fromString(e,...t);return PT(i),new Xt(n,null,new Me(i))}{if(!(n instanceof Xt||n instanceof ki))throw new Ce(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(wt.fromString(e,...t));return PT(i),new Xt(n.firestore,n instanceof ki?n.converter:null,new Me(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE="AsyncQueue";class xE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new jb(this,"async_queue_retry"),this._c=()=>{const i=qm();i&&be(EE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=qm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=qm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Pi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!il(e))throw e;be(EE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ui("INTERNAL UNHANDLED ERROR: ",bE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=lg.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&Ue(47125,{Pc:bE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function bE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ol extends Ef{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new xE,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xE(e),this._firestoreClient=void 0,await e}}}function dA(n,e){const t=typeof n=="object"?n:Ux(),i=typeof n=="string"?n:qd,o=jp(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const l=WD("firestore");l&&cA(o,...l)}return o}function xf(n){if(n._terminated)throw new Ce(fe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||SV(n),n._firestoreClient}function SV(n){var i,o,l;const e=n._freezeSettings(),t=(function(d,g,m,T){return new JP(d,g,m,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,lA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new vV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const g=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn(ln.fromBase64String(e))}catch(t){throw new Ce(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gn(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pu(e,Gn._jsonSchema))return Gn.fromBase64String(e.bytes)}}Gn._jsonSchemaVersion="firestore/bytes/1.0",Gn._jsonSchema={type:Qt("string",Gn._jsonSchemaVersion),bytes:Qt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ss._jsonSchemaVersion}}static fromJSON(e){if(Pu(e,Ss._jsonSchema))return new Ss(e.latitude,e.longitude)}}Ss._jsonSchemaVersion="firestore/geoPoint/1.0",Ss._jsonSchema={type:Qt("string",Ss._jsonSchemaVersion),latitude:Qt("number"),longitude:Qt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Cs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pu(e,Cs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Cs(e.vectorValues);throw new Ce(fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Cs._jsonSchemaVersion="firestore/vectorValue/1.0",Cs._jsonSchema={type:Qt("string",Cs._jsonSchemaVersion),vectorValues:Qt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV=/^__.*__$/;class wV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Do(e,this.data,this.fieldMask,t,this.fieldTransforms):new ku(e,this.data,t,this.fieldTransforms)}}function fA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ue(40011,{Ac:n})}}class mg{constructor(e,t,i,o,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new mg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Kd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fA(this.Ac)&&CV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class IV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||vf(e)}Cc(e,t,i,o=!1){return new mg({Ac:e,methodName:t,Dc:i,path:an.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function NV(n){const e=n._freezeSettings(),t=vf(n._databaseId);return new IV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function RV(n,e,t,i,o,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);gA("Data must be an object, but it was:",u,i);const d=mA(i,u);let g,m;if(l.merge)g=new bs(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const T=[];for(const E of l.mergeFields){const b=DV(e,E,t);if(!u.contains(b))throw new Ce(fe.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);PV(T,b)||T.push(b)}g=new bs(T),m=u.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,m=u.fieldTransforms;return new wV(new ls(d),g,m)}function hA(n,e){if(pA(n=bn(n)))return gA("Unsupported field value:",e,n),mA(n,e);if(n instanceof hg)return(function(i,o){if(!fA(o.Ac))throw o.Sc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,o){const l=[];let u=0;for(const d of i){let g=hA(d,o.wc(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,o){if((i=bn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return v2(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=Et.fromDate(i);return{timestampValue:Gd(o.serializer,l)}}if(i instanceof Et){const l=new Et(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Gd(o.serializer,l)}}if(i instanceof Ss)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gn)return{bytesValue:Nb(o.serializer,i._byteString)};if(i instanceof Xt){const l=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Zp(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Cs)return(function(u,d){return{mapValue:{fields:{[rb]:{stringValue:ob},[jd]:{arrayValue:{values:u.toArray().map((m=>{if(typeof m!="number")throw d.Sc("VectorValues must only contain numeric values.");return Kp(d.serializer,m)}))}}}}}})(i,o);throw o.Sc(`Unsupported field value: ${Bp(i)}`)})(n,e)}function mA(n,e){const t={};return Zx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):No(n,((i,o)=>{const l=hA(o,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function pA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Et||n instanceof Ss||n instanceof Gn||n instanceof Xt||n instanceof hg||n instanceof Cs)}function gA(n,e,t){if(!pA(t)||!Xx(t)){const i=Bp(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function DV(n,e,t){if((e=bn(e))instanceof bf)return e._internalPath;if(typeof e=="string")return yA(n,e);throw Kd("Field path arguments must be of type string or ",n,!1,void 0,t)}const MV=new RegExp("[~\\*/\\[\\]]");function yA(n,e,t){if(e.search(MV)>=0)throw Kd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bf(...e.split("."))._internalPath}catch{throw Kd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kd(n,e,t,i,o){const l=i&&!i.isEmpty(),u=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${o}`),g+=")"),new Ce(fe.INVALID_ARGUMENT,d+n+g)}function PV(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,t,i,o,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_A("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kV extends vA{data(){return super.data()}}function _A(n,e){return typeof e=="string"?yA(n,e):e instanceof bf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ce(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class TA{convertValue(e,t="none"){switch(Vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ue(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return No(e,((o,l)=>{i[o]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,o,l;const t=(l=(o=(i=e.fields)==null?void 0:i[jd].arrayValue)==null?void 0:o.values)==null?void 0:l.map((u=>jt(u.doubleValue)));return new Cs(t)}convertGeoPoint(e){return new Ss(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=df(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const t=Pr(e);return new Et(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=wt.fromString(e);dt(Vb(i),9688,{name:e});const o=new Ha(i.get(1),i.get(3)),l=new Me(i.popFirst(5));return o.isEqual(t)||Ui(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LV(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Na{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Dr extends vA{constructor(e,t,i,o,l,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_A("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Dr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Dr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Dr._jsonSchema={type:Qt("string",Dr._jsonSchemaVersion),bundleSource:Qt("string","DocumentSnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class xu extends Dr{data(e={}){return super.data(e)}}class To{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Na(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new xu(this._firestore,this._userDataWriter,i.key,i,new Na(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ce(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((d=>{const g=new xu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Na(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const g=new xu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Na(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,T=-1;return d.type!==0&&(m=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),T=u.indexOf(d.doc.key)),{type:UV(d.type),doc:g,oldIndex:m,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ce(fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=To._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=lf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function UV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ue(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(n){n=Oi(n,Xt);const e=Oi(n.firestore,ol);return EV(xf(e),n._key).then((t=>BV(e,n,t)))}To._jsonSchemaVersion="firestore/querySnapshot/1.0",To._jsonSchema={type:Qt("string",To._jsonSchemaVersion),bundleSource:Qt("string","QuerySnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class EA extends TA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,t)}}function qV(n){n=Oi(n,Ou);const e=Oi(n.firestore,ol),t=xf(e),i=new EA(e);return VV(n._query),xV(t,n._query).then((o=>new To(e,i,n,o)))}function jV(n,e,t){n=Oi(n,Xt);const i=Oi(n.firestore,ol),o=LV(n.converter,e,t);return pg(i,[RV(NV(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,Qs.none())])}function FV(n){return pg(Oi(n.firestore,ol),[new Qp(n._key,Qs.none())])}function pg(n,e){return(function(i,o){const l=new Pi;return i.asyncQueue.enqueueAndForget((async()=>uV(await TV(i),o,l))),l.promise})(xf(n),e)}function BV(n,e,t){const i=t.docs.get(e._key),o=new EA(n);return new Dr(n,o,e._key,i,new Na(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){nl=o})(tl),Ba(new bo("firestore",((i,{instanceIdentifier:o,options:l})=>{const u=i.getProvider("app").getImmediate(),d=new ol(new RP(i.getProvider("auth-internal")),new PP(u,i.getProvider("app-check-internal")),(function(m,T){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Ce(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ha(m.options.projectId,T)})(u,o),u);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),Nr(NT,RT,e),Nr(NT,RT,"esm2020")})();const vd=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:TA,Bytes:Gn,CollectionReference:ki,DocumentReference:Xt,DocumentSnapshot:Dr,FieldPath:bf,FieldValue:hg,Firestore:ol,FirestoreError:Ce,GeoPoint:Ss,Query:Ou,QueryDocumentSnapshot:xu,QuerySnapshot:To,SnapshotMetadata:Na,Timestamp:Et,VectorValue:Cs,_AutoId:lf,_ByteString:ln,_DatabaseId:Ha,_DocumentKey:Me,_EmptyAuthCredentialsProvider:Jx,_FieldPath:an,_cast:Oi,_logWarn:So,_validateIsNotUsedTogether:Qx,collection:bV,connectFirestoreEmulator:cA,deleteDoc:FV,doc:AV,ensureFirestoreConfigured:xf,executeWrite:pg,getDoc:OV,getDocs:qV,getFirestore:dA,setDoc:jV},Symbol.toStringTag,{value:"Module"}));function xA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bA=xA,AA=new Du("auth","Firebase",xA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new Op("@firebase/auth");function zV(n,...e){Qd.logLevel<=et.WARN&&Qd.warn(`Auth (${tl}): ${n}`,...e)}function Id(n,...e){Qd.logLevel<=et.ERROR&&Qd.error(`Auth (${tl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ws(n,...e){throw gg(n,...e)}function Ws(n,...e){return gg(n,...e)}function SA(n,e,t){const i={...bA(),[e]:t};return new Du("auth","Firebase",i).create(e,{appName:n.name})}function Vi(n){return SA(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return AA.create(n,...e)}function Le(n,e,...t){if(!n)throw gg(e,...t)}function Di(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Id(e),new Error(e)}function ji(n,e){n||Di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function HV(){return AE()==="http:"||AE()==="https:"}function AE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HV()||oM()||"connection"in navigator)?navigator.onLine:!0}function $V(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ji(t>e,"Short delay should be less than long delay!"),this.isMobile=sM()||aM()}get(){return GV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n,e){ji(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KV=new qu(3e4,6e4);function Br(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function zi(n,e,t,i,o={}){return wA(n,o,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const d=Mu({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return rM()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&el(n.emulatorConfig.host)&&(m.credentials="include"),CA.fetch()(await IA(n,n.config.apiHost,t,d),m)})}async function wA(n,e,t){n._canInitEmulator=!1;const i={...YV,...e};try{const o=new XV(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw _d(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const d=l.ok?u.errorMessage:u.error.message,[g,m]=d.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw _d(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw _d(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw _d(n,"user-disabled",u);const T=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw SA(n,T,m);ws(n,T)}}catch(o){if(o instanceof Bi)throw o;ws(n,"network-request-failed",{message:String(o)})}}async function ju(n,e,t,i,o={}){const l=await zi(n,e,t,i,o);return"mfaPendingCredential"in l&&ws(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function IA(n,e,t,i){const o=`${e}${t}?${i}`,l=n,u=l.config.emulator?yg(n.config,o):`${n.config.apiScheme}://${o}`;return JV.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function QV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ws(this.auth,"network-request-failed")),KV.get())})}}function _d(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Ws(n,e,i);return o.customData._tokenResponse=t,o}function SE(n){return n!==void 0&&n.enterprise!==void 0}class WV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return QV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function ZV(n,e){return zi(n,"GET","/v2/recaptchaConfig",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(n,e){return zi(n,"POST","/v1/accounts:delete",e)}async function Xd(n,e){return zi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function NA(n,e=!1){const t=bn(n),i=await t.getIdToken(e),o=vg(i);Le(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:o,token:i,authTime:bu(Fm(o.auth_time)),issuedAtTime:bu(Fm(o.iat)),expirationTime:bu(Fm(o.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Fm(n){return Number(n)*1e3}function vg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Id("JWT malformed, contained fewer than 3 sections"),null;try{const o=Ix(t);return o?JSON.parse(o):(Id("Failed to decode base64 JWT payload"),null)}catch(o){return Id("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function CE(n){const e=vg(n);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ka(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Bi&&tL(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function tL({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bu(this.lastLoginAt),this.creationTime=bu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wd(n){var E;const e=n.auth,t=await n.getIdToken(),i=await Ka(n,Xd(e,{idToken:t}));Le(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const l=(E=o.providerUserInfo)!=null&&E.length?DA(o.providerUserInfo):[],u=sL(n.providerData,l),d=n.isAnonymous,g=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),m=d?g:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Cp(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(n,T)}async function RA(n){const e=bn(n);await Wd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sL(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function DA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iL(n,e){const t=await wA(n,{},async()=>{const i=Mu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,u=await IA(n,o,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:d,body:i};return n.emulatorConfig&&el(n.emulatorConfig.host)&&(g.credentials="include"),CA.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rL(n,e){return zi(n,"POST","/v2/accounts:revokeToken",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):CE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const t=CE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:l}=await iL(e,t);this.updateTokensAndExpiration(i,o,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:l}=t,u=new Oa;return i&&(Le(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(Le(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),l&&(Le(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oa,this.toJSON())}_performRefresh(){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(n,e){Le(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class As{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new nL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Cp(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ka(this,this.stsTokenManager.getToken(this.auth,e));return Le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return NA(this,e)}reload(){return RA(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new As({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Wd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(as(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await Ka(this,eL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:E,emailVerified:b,isAnonymous:I,providerData:V,stsTokenManager:L}=t;Le(E&&L,e,"internal-error");const j=Oa.fromJSON(this.name,L);Le(typeof E=="string",e,"internal-error"),Ar(i,e.name),Ar(o,e.name),Le(typeof b=="boolean",e,"internal-error"),Le(typeof I=="boolean",e,"internal-error"),Ar(l,e.name),Ar(u,e.name),Ar(d,e.name),Ar(g,e.name),Ar(m,e.name),Ar(T,e.name);const $=new As({uid:E,auth:e,email:o,emailVerified:b,displayName:i,isAnonymous:I,photoURL:u,phoneNumber:l,tenantId:d,stsTokenManager:j,createdAt:m,lastLoginAt:T});return V&&Array.isArray(V)&&($.providerData=V.map(J=>({...J}))),g&&($._redirectEventId=g),$}static async _fromIdTokenResponse(e,t,i=!1){const o=new Oa;o.updateFromServerResponse(t);const l=new As({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Wd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Le(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?DA(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(l!=null&&l.length),d=new Oa;d.updateFromIdToken(i);const g=new As({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:u}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Cp(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=new Map;function Mi(n){ji(n instanceof Function,"Expected a class definition");let e=wE.get(n);return e?(ji(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,wE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}MA.type="NONE";const wp=MA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n,e,t){return`firebase:${n}:${e}:${t}`}class qa{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:l}=this.auth;this.fullUserKey=Nd(this.userKey,o.apiKey,l),this.fullPersistenceKey=Nd("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Xd(this.auth,{idToken:e}).catch(()=>{});return t?As._fromGetAccountInfoResponse(this.auth,t,e):null}return As._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new qa(Mi(wp),e,i);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=o[0]||Mi(wp);const u=Nd(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const T=await m._get(u);if(T){let E;if(typeof T=="string"){const b=await Xd(e,{idToken:T}).catch(()=>{});if(!b)break;E=await As._fromGetAccountInfoResponse(e,b,T)}else E=As._fromJSON(e,T);m!==l&&(d=E),l=m;break}}catch{}const g=o.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new qa(l,e,i):(l=g[0],d&&await l._set(u,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new qa(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(OA(e))return"Blackberry";if(qA(e))return"Webos";if(kA(e))return"Safari";if((e.includes("chrome/")||VA(e))&&!e.includes("edge/"))return"Chrome";if(UA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function PA(n=Tn()){return/firefox\//i.test(n)}function kA(n=Tn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VA(n=Tn()){return/crios\//i.test(n)}function LA(n=Tn()){return/iemobile/i.test(n)}function UA(n=Tn()){return/android/i.test(n)}function OA(n=Tn()){return/blackberry/i.test(n)}function qA(n=Tn()){return/webos/i.test(n)}function _g(n=Tn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oL(n=Tn()){var e;return _g(n)&&!!((e=window.navigator)!=null&&e.standalone)}function aL(){return lM()&&document.documentMode===10}function jA(n=Tn()){return _g(n)||UA(n)||qA(n)||OA(n)||/windows phone/i.test(n)||LA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(n,e=[]){let t;switch(n){case"Browser":t=IE(Tn());break;case"Worker":t=`${IE(Tn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${tl}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,d)=>{try{const g=e(l);u(g)}catch(g){d(g)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uL(n,e={}){return zi(n,"GET","/v2/passwordPolicy",Br(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL=6;class dL{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??cL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new NE(this),this.idTokenSubscription=new NE(this),this.beforeStateQueue=new lL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mi(t)),this._initializationPromise=this.queue(async()=>{var i,o,l;if(!this._deleted&&(this.persistenceManager=await qa.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Xd(this,{idToken:e}),i=await As._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(as(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&(g!=null&&g.user)&&(i=g.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Wd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$V()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(as(this.app))return Promise.reject(Vi(this));const t=e?bn(e):null;return t&&Le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return as(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return as(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uL(this),t=new dL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Du("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await rL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mi(e)||this._popupRedirectResolver;Le(t,this,"argument-error"),this.redirectPersistenceManager=await qa.create(this,[Mi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(d,this,"internal-error"),d.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,o);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=FA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(as(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&zV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Po(n){return bn(n)}class NE{constructor(e){this.auth=e,this.observer=null,this.addObserver=gM(t=>this.observer=t)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Af={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hL(n){Af=n}function BA(n){return Af.loadJS(n)}function mL(){return Af.recaptchaEnterpriseScript}function pL(){return Af.gapiScript}function gL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class yL{constructor(){this.enterprise=new vL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class vL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _L="recaptcha-enterprise",zA="NO_RECAPTCHA";class TL{constructor(e){this.type=_L,this.auth=Po(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,d)=>{ZV(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new WV(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(g=>{d(g)})})}function o(l,u,d){const g=window.grecaptcha;SE(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(zA)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new yL().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(d=>{if(!t&&SE(window.grecaptcha))o(d,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=mL();g.length!==0&&(g+=d),BA(g).then(()=>{o(d,l,u)}).catch(m=>{u(m)})}}).catch(d=>{u(d)})})}}async function RE(n,e,t,i=!1,o=!1){const l=new TL(n);let u;if(o)u=zA;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const g=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const g=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function Ip(n,e,t,i,o){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await RE(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await RE(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(n,e){const t=jp(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(xo(l,e??{}))return o;ws(o,"already-initialized")}return t.initialize({options:e})}function EL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Mi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function GA(n,e,t){const i=Po(n);Le(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,l=$A(e),{host:u,port:d}=xL(e),g=d===null?"":`:${d}`,m={url:`${l}//${u}${g}/`},T=Object.freeze({host:u,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Le(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Le(xo(m,i.config.emulator)&&xo(T,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=T,i.settings.appVerificationDisabledForTesting=!0,el(u)?(Mx(`${l}//${u}${g}`),Px("Auth",!0)):bL()}function $A(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xL(n){const e=$A(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const l=o[1];return{host:l,port:DE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:DE(u)}}}function DE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function bL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,t){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function AL(n,e){return zi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SL(n,e){return ju(n,"POST","/v1/accounts:signInWithPassword",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(n,e){return ju(n,"POST","/v1/accounts:signInWithEmailLink",Br(n,e))}async function wL(n,e){return ju(n,"POST","/v1/accounts:signInWithEmailLink",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa extends Sf{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Qa(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Qa(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ip(e,t,"signInWithPassword",SL);case"emailLink":return CL(e,{email:this._email,oobCode:this._password});default:ws(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ip(e,i,"signUpPassword",AL);case"emailLink":return wL(e,{idToken:t,email:this._email,oobCode:this._password});default:ws(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(n,e){return ju(n,"POST","/v1/accounts:signInWithIdp",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL="http://localhost";class Or extends Sf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Or(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ws("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...l}=t;if(!i||!o)return null;const u=new Or(i,o);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return ja(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ja(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ja(e,t)}buildRequest(){const e={requestUri:IL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Mu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RL(n){const e=du(fu(n)).link,t=e?du(fu(e)).deep_link_id:null,i=du(fu(n)).deep_link_id;return(i?du(fu(i)).link:null)||i||t||e||n}class Cf{constructor(e){const t=du(fu(e)),i=t.apiKey??null,o=t.oobCode??null,l=NL(t.mode??null);Le(i&&o&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=RL(e);try{return new Cf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.providerId=ko.PROVIDER_ID}static credential(e,t){return Qa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Cf.parseLink(t);return Le(i,"argument-error"),Qa._fromEmailAndCode(e,i.code,i.tenantId)}}ko.PROVIDER_ID="password";ko.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ko.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends YA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Fu{constructor(){super("facebook.com")}static credential(e){return Or._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ci.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Fu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Or._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return wi.credential(t,i)}catch{return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com";wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Fu{constructor(){super("github.com")}static credential(e){return Or._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.GITHUB_SIGN_IN_METHOD="github.com";Ii.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends Fu{constructor(){super("twitter.com")}static credential(e,t){return Or._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ni.credential(t,i)}catch{return null}}}Ni.TWITTER_SIGN_IN_METHOD="twitter.com";Ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DL(n,e){return ju(n,"POST","/v1/accounts:signUp",Br(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const l=await As._fromIdTokenResponse(e,i,o),u=ME(i);return new wo({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=ME(i);return new wo({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function ME(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd extends Bi{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Zd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Zd(e,t,i,o)}}function JA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Zd._fromErrorAndOperation(n,l,e,i):l})}async function ML(n,e,t=!1){const i=await Ka(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PL(n,e,t=!1){const{auth:i}=n;if(as(i.app))return Promise.reject(Vi(i));const o="reauthenticate";try{const l=await Ka(n,JA(i,o,e,n),t);Le(l.idToken,i,"internal-error");const u=vg(l.idToken);Le(u,i,"internal-error");const{sub:d}=u;return Le(n.uid===d,i,"user-mismatch"),wo._forOperation(n,o,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&ws(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KA(n,e,t=!1){if(as(n.app))return Promise.reject(Vi(n));const i="signIn",o=await JA(n,i,e),l=await wo._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(l.user),l}async function QA(n,e){return KA(Po(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XA(n){const e=Po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kL(n,e,t){if(as(n.app))return Promise.reject(Vi(n));const i=Po(n),u=await Ip(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DL).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&XA(n),g}),d=await wo._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(d.user),d}function VL(n,e,t){return as(n.app)?Promise.reject(Vi(n)):QA(bn(n),ko.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&XA(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL(n,e){return zi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=bn(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Ka(i,LL(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const d=i.providerData.find(({providerId:g})=>g==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function WA(n,e,t,i){return bn(n).onIdTokenChanged(e,t,i)}function ZA(n,e,t){return bn(n).beforeAuthStateChanged(e,t)}function OL(n,e,t,i){return bn(n).onAuthStateChanged(e,t,i)}function qL(n){return bn(n).signOut()}const ef="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ef,"1"),this.storage.removeItem(ef),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=1e3,FL=10;class tS extends eS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);aL()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,FL):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},jL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tS.type="LOCAL";const nS=tS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS extends eS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sS.type="SESSION";const Tg=sS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new wf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:l}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const d=Array.from(u).map(async m=>m(t.origin,l)),g=await BL(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,u;return new Promise((d,g)=>{const m=Eg("",20);o.port1.start();const T=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(E){const b=E;if(b.data.eventId===m)switch(b.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(b.data.response);break;default:clearTimeout(T),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(){return window}function HL(n){Zs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(){return typeof Zs().WorkerGlobalScope<"u"&&typeof Zs().importScripts=="function"}async function GL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $L(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function YL(){return iS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="firebaseLocalStorageDb",JL=1,tf="firebaseLocalStorage",oS="fbase_key";class Bu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function If(n,e){return n.transaction([tf],e?"readwrite":"readonly").objectStore(tf)}function KL(){const n=indexedDB.deleteDatabase(rS);return new Bu(n).toPromise()}function Np(){const n=indexedDB.open(rS,JL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(tf,{keyPath:oS})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(tf)?e(i):(i.close(),await KL(),e(await Np()))})})}async function PE(n,e,t){const i=If(n,!0).put({[oS]:e,value:t});return new Bu(i).toPromise()}async function QL(n,e){const t=If(n,!1).get(e),i=await new Bu(t).toPromise();return i===void 0?null:i.value}function kE(n,e){const t=If(n,!0).delete(e);return new Bu(t).toPromise()}const XL=800,WL=3;class aS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Np(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>WL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return iS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wf._getInstance(YL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await GL(),!this.activeServiceWorker)return;this.sender=new zL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$L()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Np();return await PE(e,ef,"1"),await kE(e,ef),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>PE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>QL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>kE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=If(o,!1).getAll();return new Bu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aS.type="LOCAL";const lS=aS;new qu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(n,e){return e?Mi(e):(Le(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg extends Sf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ja(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ja(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ja(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function eU(n){return KA(n.auth,new xg(n),n.bypassAuthState)}function tU(n){const{auth:e,user:t}=n;return Le(t,e,"internal-error"),PL(t,new xg(n),n.bypassAuthState)}async function nU(n){const{auth:e,user:t}=n;return Le(t,e,"internal-error"),ML(t,new xg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,t,i,o,l=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:l,error:u,type:d}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eU;case"linkViaPopup":case"linkViaRedirect":return nU;case"reauthViaPopup":case"reauthViaRedirect":return tU;default:ws(this.auth,"internal-error")}}resolve(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU=new qu(2e3,1e4);class Ra extends uS{constructor(e,t,i,o,l){super(e,t,o,l),this.provider=i,this.authWindow=null,this.pollId=null,Ra.currentPopupAction&&Ra.currentPopupAction.cancel(),Ra.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){ji(this.filter.length===1,"Popup operations only handle one event");const e=Eg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ra.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sU.get())};e()}}Ra.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iU="pendingRedirect",Rd=new Map;class rU extends uS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Rd.get(this.auth._key());if(!e){try{const i=await oU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Rd.set(this.auth._key(),e)}return this.bypassAuthState||Rd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oU(n,e){const t=uU(e),i=lU(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function aU(n,e){Rd.set(n._key(),e)}function lU(n){return Mi(n._redirectPersistence)}function uU(n){return Nd(iU,n.config.apiKey,n.name)}async function cU(n,e,t=!1){if(as(n.app))return Promise.reject(Vi(n));const i=Po(n),o=ZL(i,e),u=await new rU(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dU=600*1e3;class fU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hU(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!cS(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Ws(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dU&&this.cachedEventUids.clear(),this.cachedEventUids.has(VE(e))}saveEventToCache(e){this.cachedEventUids.add(VE(e)),this.lastProcessedEventTime=Date.now()}}function VE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function cS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hU(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mU(n,e={}){return zi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gU=/^https?/;async function yU(n){if(n.config.emulator)return;const{authorizedDomains:e}=await mU(n);for(const t of e)try{if(vU(t))return}catch{}ws(n,"unauthorized-domain")}function vU(n){const e=Sp(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!gU.test(t))return!1;if(pU.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _U=new qu(3e4,6e4);function LE(){const n=Zs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function TU(n){return new Promise((e,t)=>{var o,l,u;function i(){LE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{LE(),t(Ws(n,"network-request-failed"))},timeout:_U.get()})}if((l=(o=Zs().gapi)==null?void 0:o.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=Zs().gapi)!=null&&u.load)i();else{const d=gL("iframefcb");return Zs()[d]=()=>{gapi.load?i():t(Ws(n,"network-request-failed"))},BA(`${pL()}?onload=${d}`).catch(g=>t(g))}}).catch(e=>{throw Dd=null,e})}let Dd=null;function EU(n){return Dd=Dd||TU(n),Dd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU=new qu(5e3,15e3),bU="__/auth/iframe",AU="emulator/auth/iframe",SU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wU(n){const e=n.config;Le(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yg(e,AU):`https://${n.config.authDomain}/${bU}`,i={apiKey:e.apiKey,appName:n.name,v:tl},o=CU.get(n.config.apiHost);o&&(i.eid=o);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Mu(i).slice(1)}`}async function IU(n){const e=await EU(n),t=Zs().gapi;return Le(t,n,"internal-error"),e.open({where:document.body,url:wU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SU,dontclear:!0},i=>new Promise(async(o,l)=>{await i.restyle({setHideOnLeave:!1});const u=Ws(n,"network-request-failed"),d=Zs().setTimeout(()=>{l(u)},xU.get());function g(){Zs().clearTimeout(d),o(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RU=500,DU=600,MU="_blank",PU="http://localhost";class UE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kU(n,e,t,i=RU,o=DU){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const g={...NU,width:i.toString(),height:o.toString(),top:l,left:u},m=Tn().toLowerCase();t&&(d=VA(m)?MU:t),PA(m)&&(e=e||PU,g.scrollbars="yes");const T=Object.entries(g).reduce((b,[I,V])=>`${b}${I}=${V},`,"");if(oL(m)&&d!=="_self")return VU(e||"",d),new UE(null);const E=window.open(e||"",d,T);Le(E,n,"popup-blocked");try{E.focus()}catch{}return new UE(E)}function VU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU="__/auth/handler",UU="emulator/auth/handler",OU=encodeURIComponent("fac");async function OE(n,e,t,i,o,l){Le(n.config.authDomain,n,"auth-domain-config-required"),Le(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:tl,eventId:o};if(e instanceof YA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",pM(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,E]of Object.entries({}))u[T]=E}if(e instanceof Fu){const T=e.getScopes().filter(E=>E!=="");T.length>0&&(u.scopes=T.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const T of Object.keys(d))d[T]===void 0&&delete d[T];const g=await n._getAppCheckToken(),m=g?`#${OU}=${encodeURIComponent(g)}`:"";return`${qU(n)}?${Mu(d).slice(1)}${m}`}function qU({config:n}){return n.emulator?yg(n,UU):`https://${n.authDomain}/${LU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="webStorageSupport";class jU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tg,this._completeRedirectFn=cU,this._overrideRedirectResult=aU}async _openPopup(e,t,i,o){var u;ji((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await OE(e,t,i,Sp(),o);return kU(e,l,Eg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const l=await OE(e,t,i,Sp(),o);return HL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(ji(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await IU(e),i=new fU(e);return t.register("authEvent",o=>(Le(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Bm,{type:Bm},o=>{var u;const l=(u=o==null?void 0:o[0])==null?void 0:u[Bm];l!==void 0&&t(!!l),ws(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yU(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jA()||kA()||_g()}}const dS=jU;var qE="@firebase/auth",jE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function zU(n){Ba(new bo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=i.options;Le(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:FA(n)},m=new fL(i,o,l,g);return EL(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ba(new bo("auth-internal",e=>{const t=Po(e.getProvider("auth").getImmediate());return(i=>new FU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Nr(qE,jE,BU(n)),Nr(qE,jE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HU=300,GU=Dx("authIdTokenMaxAge")||HU;let FE=null;const $U=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>GU)return;const o=t==null?void 0:t.token;FE!==o&&(FE=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function fS(n=Ux()){const e=jp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=HA(n,{popupRedirectResolver:dS,persistence:[lS,nS,Tg]}),i=Dx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=$U(l.toString());ZA(t,u,()=>u(t.currentUser)),WA(t,d=>u(d))}}const o=Nx("auth");return o&&GA(t,`http://${o}`),t}function YU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}hL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const l=Ws("internal-error");l.customData=o,t(l)},i.type="text/javascript",i.charset="UTF-8",YU().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});zU("Browser");const Td=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Cf,AuthCredential:Sf,EmailAuthCredential:Qa,EmailAuthProvider:ko,FacebookAuthProvider:Ci,GithubAuthProvider:Ii,GoogleAuthProvider:wi,OAuthCredential:Or,TwitterAuthProvider:Ni,beforeAuthStateChanged:ZA,browserLocalPersistence:nS,browserPopupRedirectResolver:dS,browserSessionPersistence:Tg,connectAuthEmulator:GA,createUserWithEmailAndPassword:kL,getAuth:fS,getIdTokenResult:NA,inMemoryPersistence:wp,indexedDBLocalPersistence:lS,initializeAuth:HA,onAuthStateChanged:OL,onIdTokenChanged:WA,prodErrorMap:bA,reload:RA,signInWithCredential:QA,signInWithEmailAndPassword:VL,signOut:qL,updateProfile:UL},Symbol.toStringTag,{value:"Module"}));let zm=null,Si=null,xs=null;const JU=()=>{try{return La().hasFirebase?(zm=Lx(Ft.firebase),Si=dA(zm),xs=fS(zm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};JU();const Ri={async signUp(n,e,t){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:i,updateProfile:o}=await Ai(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:d}=await Promise.resolve().then(()=>Td);return{createUserWithEmailAndPassword:u,updateProfile:d}},void 0),l=await i(xs,n,e);return await o(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(i){return console.error("خطأ في التسجيل:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async signIn(n,e){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await Ai(async()=>{const{signInWithEmailAndPassword:o}=await Promise.resolve().then(()=>Td);return{signInWithEmailAndPassword:o}},void 0);return{success:!0,user:(await t(xs,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!xs)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await Ai(async()=>{const{signOut:e}=await Promise.resolve().then(()=>Td);return{signOut:e}},void 0);return await n(xs),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return xs?xs.currentUser:null},async onAuthStateChanged(n){if(!xs)return n(null),()=>{};try{const{onAuthStateChanged:e}=await Ai(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>Td);return{onAuthStateChanged:t}},void 0);return e(xs,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:i,setDoc:o}=await Ai(async()=>{const{doc:u,setDoc:d}=await Promise.resolve().then(()=>vd);return{doc:u,setDoc:d}},void 0),l=i(Si,n,e);return await o(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(i){return console.error("خطأ في حفظ البيانات:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async getData(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:i}=await Ai(async()=>{const{doc:u,getDoc:d}=await Promise.resolve().then(()=>vd);return{doc:u,getDoc:d}},void 0),o=t(Si,n,e),l=await i(o);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await Ai(async()=>{const{collection:l,getDocs:u}=await Promise.resolve().then(()=>vd);return{collection:l,getDocs:u}},void 0),i=await t(e(Si,n)),o=[];return i.forEach(l=>{o.push({id:l.id,...l.data()})}),{success:!0,data:o}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!Si)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:i}=await Ai(async()=>{const{doc:l,deleteDoc:u}=await Promise.resolve().then(()=>vd);return{doc:l,deleteDoc:u}},void 0),o=t(Si,n,e);return await i(o),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}};class Da{constructor(){this.permission="default",this.checkPermission()}static getInstance(){return Da.instance||(Da.instance=new Da),Da.instance}async checkPermission(){"Notification"in window&&(this.permission=Notification.permission)}async requestPermission(){if(!("Notification"in window))throw new Error("هذا المتصفح لا يدعم الإشعارات");return this.permission==="granted"?"granted":(this.permission=await Notification.requestPermission(),this.permission)}async sendNotification(e){if(this.permission!=="granted")throw new Error("لم يتم منح إذن الإشعارات");const t=new Notification(e.title,{body:e.body,icon:e.icon||"/icon-192.png",badge:e.badge||"/icon-192.png",tag:e.tag,requireInteraction:e.requireInteraction||!1,actions:e.actions});return setTimeout(()=>{t.close()},5e3),new Promise(i=>{t.onclick=()=>{window.focus(),t.close(),i()},t.onclose=()=>{i()}})}async scheduleInstallmentNotification(e,t,i,o){const l=new Date,u=new Date(i);if(u.setDate(u.getDate()-3),u>=l){const d=u.getTime()-l.getTime();setTimeout(async()=>{try{await this.sendNotification({id:`installment-${e}`,title:"🔔 تذكير بقسط قادم",body:`قسط ${t} مستحق خلال 3 أيام - المبلغ: ${o.toLocaleString()} ريال`,tag:`installment-${e}`,requireInteraction:!0,actions:[{action:"view",title:"عرض التفاصيل"},{action:"dismiss",title:"تجاهل"}]})}catch(g){console.error("خطأ في إرسال إشعار القسط:",g)}},d)}}async scheduleGeneralNotification(e,t,i=0){if(i>0)setTimeout(async()=>{try{await this.sendNotification({id:`general-${Date.now()}`,title:e,body:t,tag:"general"})}catch(o){console.error("خطأ في إرسال الإشعار العام:",o)}},i);else try{await this.sendNotification({id:`general-${Date.now()}`,title:e,body:t,tag:"general"})}catch(o){console.error("خطأ في إرسال الإشعار العام:",o)}}isSupported(){return"Notification"in window}getPermission(){return this.permission}}const Hm=Da.getInstance(),BE=({onSuccess:n,onClose:e,hideCloseButton:t=!1,darkMode:i=!1,language:o="ar"})=>{const[l,u]=de.useState(!0),[d,g]=de.useState({email:"",password:"",displayName:""}),[m,T]=de.useState(!1),[E,b]=de.useState(""),I=async L=>{L.preventDefault(),T(!0),b("");try{let j;if(l)j=await Ri.signIn(d.email,d.password);else{if(!d.displayName.trim()){b("الاسم مطلوب"),T(!1);return}j=await Ri.signUp(d.email,d.password,d.displayName)}j.success?n(j.user):b(j.error||"حدث خطأ غير متوقع")}catch{b("حدث خطأ في الاتصال")}finally{T(!1)}},V=L=>{g(j=>({...j,[L.target.name]:L.target.value}))};return f.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:l?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&f.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),f.jsxs("form",{onSubmit:I,className:"space-y-4",children:[!l&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),f.jsx("input",{type:"text",id:"displayName",name:"displayName",value:d.displayName,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!l})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),f.jsx("input",{type:"email",id:"email",name:"email",value:d.email,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),f.jsx("input",{type:"password",id:"password",name:"password",value:d.password,onChange:V,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),E&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:f.jsx("p",{className:"text-red-600 text-sm",children:E})}),f.jsx("button",{type:"submit",disabled:m,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:m?"⏳ جاري المعالجة...":l?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("button",{onClick:()=>u(!l),className:"text-blue-600 hover:text-blue-700 font-medium",children:l?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},hS=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),f.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Fa=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),f.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),KU=()=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),f.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),QU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),XU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),WU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),ZU=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),e4=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),zu=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Gm=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),$m=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t4=({className:n})=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),n4={ar:{"app.title":"لوحة التحكم المالية | MASROF","developed.by":"Developed by K.A Team","add.transaction":"إضافة حركة",logout:"خروج","dark.mode":"الوضع المظلم",notifications:"الإشعارات","enable.notifications":"تفعيل الإشعارات",language:"العربية","tab.summary":"الملخص","tab.analysis":"التحليل","tab.transactions":"الحركات","tab.budget":"الميزانية","tab.investment":"الاستثمار","tab.ai.assistant":"المحلل الذكي","tab.settings":"الإعدادات","tab.cards":"إدارة البطاقات","tab.bank":"البنك","tab.installments":"الأقساط","tab.debts.loans":"الديون والقروض","card.debts.summary":"ملخص ديون البطاقات","card.bank.accounts":"ملخص الحسابات البنكية","card.financial.report":"تقرير مالي شامل","card.categories.summary":"ملخص الفئات",due:"المستحق",remaining:"المتبقي","total.debts":"إجمالي الديون","total.available":"إجمالي المتاح",deposits:"الإيداعات",withdrawals:"السحوبات","total.bank.balances":"إجمالي الأرصدة البنكية","total.income":"إجمالي الدخل","total.expenses":"إجمالي المصاريف",net:"الصافي",rent:"إيجار",groceries:"مواد تموينية",shopping:"تسوق",bills:"سداد فواتير",restaurants:"مطاعم",transport:"مواصلات",entertainment:"ترفيه",health:"صحة",education:"تعليم",other:"أخرى","al.ahli.snb":"الأهلي SNB","emirates.enbd":"الإمارات ENBD","al.ahli.bank":"البنك الاهلي","arab.bank":"البنك العربي",add:"إضافة",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",confirm:"تأكيد",close:"إغلاق",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",active:"نشط",inactive:"غير نشط",pending:"معلق",completed:"مكتمل",cancelled:"ملغي",january:"يناير",february:"فبراير",march:"مارس",april:"أبريل",may:"مايو",june:"يونيو",july:"يوليو",august:"أغسطس",september:"سبتمبر",october:"أكتوبر",november:"نوفمبر",december:"ديسمبر",sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت",sar:"ريال سعودي",usd:"دولار أمريكي",eur:"يورو",aed:"درهم إماراتي",today:"اليوم",yesterday:"أمس","this.week":"هذا الأسبوع","this.month":"هذا الشهر","this.year":"هذا العام","last.week":"الأسبوع الماضي","last.month":"الشهر الماضي","last.year":"العام الماضي",success:"نجح",error:"خطأ",warning:"تحذير",info:"معلومات",loading:"جاري التحميل...","no.data":"لا توجد بيانات","try.again":"حاول مرة أخرى","required.field":"هذا الحقل مطلوب","invalid.email":"البريد الإلكتروني غير صحيح","invalid.amount":"المبلغ غير صحيح","invalid.date":"التاريخ غير صحيح","debt.to.me":"ديون لي","debt.from.me":"ديون علي",loans:"قروض","add.debt":"إضافة دين","add.loan":"إضافة قرض",debtor:"المدين",creditor:"الدائن",lender:"المقرض",amount:"المبلغ",description:"الوصف",date:"التاريخ",status:"الحالة",source:"المصدر",reason:"السبب",installments:"أقساط","paid.installments":"أقساط مدفوعة","remaining.installments":"أقساط متبقية","next.payment":"الدفعة التالية","payment.date":"تاريخ الدفع","installment.amount":"مبلغ القسط","total.amount":"المبلغ الإجمالي",investment:"استثمار","current.value":"القيمة الحالية","initial.investment":"الاستثمار الأولي","profit.loss":"الربح/الخسارة","return.rate":"معدل العائد",budget:"ميزانية","budget.limit":"حد الميزانية",spent:"مصروف","remaining.budget":"الميزانية المتبقية","over.budget":"تجاوز الميزانية",reports:"تقارير","financial.report":"تقرير مالي","monthly.report":"تقرير شهري","yearly.report":"تقرير سنوي","category.report":"تقرير الفئات","income.report":"تقرير الدخل","expense.report":"تقرير المصروفات",settings:"الإعدادات",profile:"الملف الشخصي",account:"الحساب",privacy:"الخصوصية",security:"الأمان",backup:"نسخ احتياطي",restore:"استعادة","export.data":"تصدير البيانات","import.data":"استيراد البيانات","ai.assistant":"المساعد الذكي","ask.question":"اسأل سؤال","get.advice":"احصل على نصيحة","analyze.data":"تحليل البيانات","generate.report":"توليد تقرير",notification:"إشعار","payment.reminder":"تذكير دفع","budget.alert":"تنبيه الميزانية","low.balance":"رصيد منخفض","payment.due":"دفعة مستحقة","network.error":"خطأ في الشبكة","server.error":"خطأ في الخادم","auth.error":"خطأ في المصادقة","permission.error":"خطأ في الصلاحية","validation.error":"خطأ في التحقق","unknown.error":"خطأ غير معروف",details:"التفاصيل","cannot.delete":"لا يمكن الحذف","cannot.delete.category":"لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات","cannot.delete.transaction.type":"لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات","cannot.delete.payment.method":"لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات","restore.backup":"استعادة نسخة احتياطية","confirm.restore":"هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية","api.status":"حالة مفاتيح API"},en:{"app.title":"Financial Dashboard | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Add Transaction",logout:"Logout","dark.mode":"Dark Mode",notifications:"Notifications","enable.notifications":"Enable Notifications",language:"English","tab.summary":"Summary","tab.analysis":"Analysis","tab.transactions":"Transactions","tab.budget":"Budget","tab.investment":"Investment","tab.ai.assistant":"AI Assistant","tab.settings":"Settings","tab.cards":"Card Management","tab.bank":"Bank","tab.installments":"Installments","tab.debts.loans":"Debts & Loans","card.debts.summary":"Card Debts Summary","card.bank.accounts":"Bank Accounts Summary","card.financial.report":"Comprehensive Financial Report","card.categories.summary":"Categories Summary",due:"Due",remaining:"Remaining","total.debts":"Total Debts","total.available":"Total Available",deposits:"Deposits",withdrawals:"Withdrawals","total.bank.balances":"Total Bank Balances","total.income":"Total Income","total.expenses":"Total Expenses",net:"Net",rent:"Rent",groceries:"Groceries",shopping:"Shopping",bills:"Bill Payments",restaurants:"Restaurants",transport:"Transport",entertainment:"Entertainment",health:"Health",education:"Education",other:"Other","al.ahli.snb":"Al Ahli SNB","emirates.enbd":"Emirates ENBD","al.ahli.bank":"Al Ahli Bank","arab.bank":"Arab Bank",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",cancelled:"Cancelled",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sar:"Saudi Riyal",usd:"US Dollar",eur:"Euro",aed:"UAE Dirham",today:"Today",yesterday:"Yesterday","this.week":"This Week","this.month":"This Month","this.year":"This Year","last.week":"Last Week","last.month":"Last Month","last.year":"Last Year",success:"Success",error:"Error",warning:"Warning",info:"Info",loading:"Loading...","no.data":"No Data","try.again":"Try Again","required.field":"This field is required","invalid.email":"Invalid email address","invalid.amount":"Invalid amount","invalid.date":"Invalid date","debt.to.me":"Debts to Me","debt.from.me":"Debts from Me",loans:"Loans","add.debt":"Add Debt","add.loan":"Add Loan",debtor:"Debtor",creditor:"Creditor",lender:"Lender",amount:"Amount",description:"Description",date:"Date",status:"Status",source:"Source",reason:"Reason",installments:"Installments","paid.installments":"Paid Installments","remaining.installments":"Remaining Installments","next.payment":"Next Payment","payment.date":"Payment Date","installment.amount":"Installment Amount","total.amount":"Total Amount",investment:"Investment","current.value":"Current Value","initial.investment":"Initial Investment","profit.loss":"Profit/Loss","return.rate":"Return Rate",budget:"Budget","budget.limit":"Budget Limit",spent:"Spent","remaining.budget":"Remaining Budget","over.budget":"Over Budget",reports:"Reports","financial.report":"Financial Report","monthly.report":"Monthly Report","yearly.report":"Yearly Report","category.report":"Category Report","income.report":"Income Report","expense.report":"Expense Report",settings:"Settings",profile:"Profile",account:"Account",privacy:"Privacy",security:"Security",backup:"Backup",restore:"Restore","export.data":"Export Data","import.data":"Import Data","ai.assistant":"AI Assistant","ask.question":"Ask Question","get.advice":"Get Advice","analyze.data":"Analyze Data","generate.report":"Generate Report",notification:"Notification","payment.reminder":"Payment Reminder","budget.alert":"Budget Alert","low.balance":"Low Balance","payment.due":"Payment Due","network.error":"Network Error","server.error":"Server Error","auth.error":"Authentication Error","permission.error":"Permission Error","validation.error":"Validation Error","unknown.error":"Unknown Error",details:"Details","cannot.delete":"Cannot Delete","cannot.delete.category":"Cannot delete this category as it is used in some transactions","cannot.delete.transaction.type":"Cannot delete this transaction type as it is used in some transactions","cannot.delete.payment.method":"Cannot delete this payment method as it is used in some transactions","restore.backup":"Restore Backup","confirm.restore":"Are you sure? This will overwrite all your current data","api.status":"API Keys Status"}},re=(n,e="ar")=>n4[e][n]||n,s4=({notifications:n,onToggle:e,language:t="ar"})=>{const[i,o]=de.useState("default");de.useEffect(()=>{"Notification"in window&&o(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();o(u)}};return f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"text-sm font-medium",children:re("notifications",t)}),f.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),f.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🔔":"🔕"})]}),i!=="granted"&&n&&f.jsx("button",{onClick:l,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:re("enable.notifications",t)})]})},i4=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:i,onAddTransaction:o,currentUser:l,onSignOut:u,language:d="ar",notifications:g=!1,onToggleNotifications:m})=>{const T=de.useMemo(()=>{const b=new Date().getFullYear(),I=[];for(let V=b+1;V>=2020;V--)I.push(V);return I},[]),E=de.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return f.jsx("header",{className:"bg-slate-50/95 dark:bg-slate-800/95 backdrop-blur-lg border-b border-slate-200 dark:border-slate-700 py-3 shadow-sm",children:f.jsx("div",{className:"container mx-auto px-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 tracking-wide",children:"لوحة التحكم المالية"}),f.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Developed by K.A Team"})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 dark:bg-slate-700 p-1.5 rounded-lg",children:[f.jsx("select",{value:n,onChange:b=>t(parseInt(b.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:T.map(b=>f.jsx("option",{value:b,children:b},b))}),f.jsx("select",{value:e,onChange:b=>i(b.target.value==="all"?"all":parseInt(b.target.value)),className:"bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:E.map(b=>f.jsx("option",{value:b.value,children:b.label},b.value))})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-semibold text-slate-800 dark:text-slate-200 text-sm",children:l.displayName||"المستخدم"}),f.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:l.email})]}),f.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),f.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),m&&f.jsx(s4,{notifications:g,onToggle:m,language:d}),f.jsxs("button",{onClick:o,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[f.jsx(e4,{className:"w-5 h-5"}),f.jsx("span",{children:re("add.transaction",d)})]})]})]})})})},r4=(n="ar")=>[{id:"summary",label:`📊 ${re("tab.summary",n)}`,icon:QU},{id:"analysis",label:`📈 ${re("tab.analysis",n)}`,icon:XU},{id:"transactions",label:`💳 ${re("tab.transactions",n)}`,icon:WU},{id:"budget",label:`✨ ${re("tab.budget",n)}`},{id:"investment",label:`💹 ${re("tab.investment",n)}`},{id:"ai-assistant",label:`🤖 ${re("tab.ai.assistant",n)}`},{id:"cards",label:`💳 ${re("tab.cards",n)}`},{id:"bank",label:`🏦 ${re("tab.bank",n)}`},{id:"installments",label:`📱 ${re("tab.installments",n)}`},{id:"debts-loans",label:`📊 ${re("tab.debts.loans",n)}`},{id:"settings",label:`⚙️ ${re("tab.settings",n)}`}],zE=["summary","analysis","transactions"],o4=({activeTab:n,setActiveTab:e,language:t="ar"})=>{const[i,o]=de.useState(!1),l=r4(t),u=m=>{e(m),o(!1)},d=l.filter(m=>zE.includes(m.id)),g=l.filter(m=>!zE.includes(m.id));return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:l.map(m=>f.jsx("button",{onClick:()=>u(m.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===m.id?"active":""}`,children:m.label},m.id))}),f.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[d.map(m=>{const T=m.icon;return f.jsxs("button",{onClick:()=>u(m.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===m.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[T&&f.jsx(T,{}),f.jsx("span",{className:"text-xs",children:m.label.split(" ")[1]})]},m.id)}),f.jsxs("button",{onClick:()=>o(!i),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${i?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[f.jsx(ZU,{}),f.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),i&&f.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>o(!1),children:f.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:m=>m.stopPropagation(),children:[f.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),f.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:g.map(m=>f.jsxs("button",{onClick:()=>u(m.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===m.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[f.jsx("span",{className:"text-2xl",children:m.label.split(" ")[0]}),f.jsx("span",{className:"text-xs font-semibold",children:m.label.split(" ")[1]})]},m.id))})]})})]})},a4=({className:n,darkMode:e=!1})=>f.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-${e?"slate-700/80":"slate-200/80"} to-transparent ${n}`}),Ym=({darkMode:n=!1})=>f.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[f.jsx("div",{className:`h-6 w-1/2 rounded mb-6 ${n?"bg-slate-700":"bg-slate-200"}`}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),f.jsx("div",{className:`h-4 w-5/6 rounded ${n?"bg-slate-700":"bg-slate-200"}`}),f.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),f.jsx("div",{className:`h-4 w-3/4 rounded ${n?"bg-slate-700":"bg-slate-200"}`})]}),f.jsx(a4,{darkMode:n})]}),l4=({darkMode:n=!1})=>f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[f.jsx("div",{className:"h-16 mb-3"}),f.jsx("div",{className:`flex flex-wrap justify-center mb-8 rounded-xl p-2 h-14 ${n?"bg-slate-700":"bg-slate-100"}`}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[f.jsx(Ym,{}),f.jsx(Ym,{}),f.jsx(Ym,{})]})]}),Je=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),u4=({title:n,details:e,barColor:t,language:i="ar"})=>f.jsxs("div",{className:"p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between bg-white border-gray-200",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("h4",{className:"font-bold text-sm text-slate-800",children:n}),f.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),f.jsxs("div",{className:"p-2 rounded-lg border bg-slate-50 border-gray-200",children:[f.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[f.jsxs("span",{className:"text-slate-600",children:[re("due",i),":"]}),f.jsx("span",{className:"font-semibold number-display text-xs text-slate-900",children:Je(e.balance)})]}),f.jsxs("div",{className:"flex justify-between text-xs",children:[f.jsxs("span",{className:"text-slate-600",children:[re("remaining",i),":"]}),f.jsx("span",{className:"font-semibold number-display text-xs text-emerald-700",children:Je(e.available)})]})]}),f.jsx("div",{className:"rounded-full h-1.5 overflow-hidden bg-slate-200",children:f.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),c4=({calculations:n,categories:e,language:t="ar"})=>{const i=Object.values(n.expensesByCategory).reduce((l,u)=>l+Number(u),0);if(i===0)return f.jsx("p",{className:"text-center p-4 text-sm text-slate-500",children:re("no.data",t)});const o=Object.entries(n.expensesByCategory).map(([l,u])=>{const d=e.find(g=>g.id===l);return{name:d?`${d.icon} ${d.name}`:"غير محدد",amount:Number(u),percentage:i>0?Number(u)/i*100:0}}).sort((l,u)=>u.amount-l.amount);return f.jsx("div",{className:"space-y-2",children:o.slice(0,5).map((l,u)=>f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-slate-600 truncate",children:l.name}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("span",{className:"text-xs text-slate-500",children:[l.percentage.toFixed(1),"%"]}),f.jsx("span",{className:"text-sm font-semibold text-slate-900 number-display",children:Je(l.amount)})]})]},u))})},d4=({calculations:n,categories:e,state:t,language:i="ar"})=>{const{totalIncome:o,totalExpenses:l,cardPayments:u,bankAccountDetails:d,totalBankBalance:g}=n,m=o-l,T=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"],E=n.cardDetails;return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"card-consistent text-center",children:[f.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"💰 إجمالي الدخل"}),f.jsx("p",{className:"font-bold text-2xl text-emerald-800 number-display",children:Je(o)})]}),f.jsxs("div",{className:"card-consistent text-center",children:[f.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"💸 إجمالي المصاريف"}),f.jsx("p",{className:"font-bold text-2xl text-red-800 number-display",children:Je(l)})]}),f.jsxs("div",{className:"card-consistent text-center",children:[f.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"📊 الصافي"}),f.jsxs("p",{className:`font-bold text-2xl number-display ${m>=0?"text-emerald-800":"text-red-800"}`,children:[m>=0?"+":"",Je(m)]})]}),f.jsxs("div",{className:"card-consistent text-center",children:[f.jsx("h3",{className:"font-semibold text-lg text-blue-700",children:"💳 إجمالي ديون البطاقات"}),f.jsx("p",{className:"font-bold text-2xl text-blue-800 number-display",children:Je(u)})]})]}),Object.keys(E).length>0&&f.jsxs("div",{className:"card-consistent",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"💳 تفاصيل البطاقات الائتمانية"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.values(t.cards).map((b,I)=>f.jsx(u4,{title:b.name,details:E[b.id],barColor:T[I%T.length],language:i},b.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"card-consistent",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 توزيع المصاريف حسب الفئة"}),f.jsx(c4,{calculations:n,categories:e,language:i})]}),f.jsxs("div",{className:"card-consistent",children:[f.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 تفاصيل الحسابات البنكية"}),f.jsx("div",{className:"space-y-3",children:Object.values(t.bankAccounts).map(b=>{const I=d[b.id];return f.jsxs("div",{className:"flex justify-between items-center p-3 bg-slate-50 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:b.name}),f.jsx("p",{className:"text-sm text-slate-500",children:b.type})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"font-bold text-slate-900 number-display",children:Je(I.balance)}),f.jsx("p",{className:"text-xs text-slate-500",children:"الرصيد الحالي"})]})]},b.id)})})]})]})]})},f4=({transactions:n,allTransactions:e,categories:t,deleteTransaction:i,editTransaction:o,state:l,darkMode:u=!1,language:d="ar"})=>{const[g,m]=de.useState(""),[T,E]=de.useState(""),[b,I]=de.useState(""),[V,L]=de.useState(""),[j,$]=de.useState(""),J=z=>{const R={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return R[z]?R[z]:l.cards[z]?`💳 ${l.cards[z].name}`:l.bankAccounts[z]?`🏦 ${l.bankAccounts[z].name}`:z},ee=z=>{const R={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(R[z])return R[z];if(z.endsWith("-payment")){const C=z.replace("-payment","");if(l.cards[C])return`💳 سداد ${l.cards[C].name}`}return z},q=de.useMemo(()=>{let z=e;if(V&&j){const R=new Date(V),C=new Date(j);C.setHours(23,59,59,999),z=e.filter(D=>{const w=new Date(D.date);return w>=R&&w<=C})}return z=z.filter(R=>{const C=g.toLowerCase(),D=t.find(k=>k.id===R.categoryId),w=R.description.toLowerCase().includes(C)||(D==null?void 0:D.name.toLowerCase().includes(C)),P=!T||R.paymentMethod===T,U=!b||R.categoryId===b;return w&&P&&U}),z.sort((R,C)=>{const D=new Date(R.date),P=new Date(C.date).getTime()-D.getTime();if(P===0){const U=parseInt(R.id.replace("trans-","").split("-")[0]);return parseInt(C.id.replace("trans-","").split("-")[0])-U}return P})},[n,e,g,T,b,V,j,t]),X=de.useMemo(()=>q.reduce((z,R)=>(R.type==="income"||R.type.toString().includes("payment")||R.type==="investment-withdrawal"?z.positive+=R.amount:z.negative+=R.amount,z),{positive:0,negative:0}),[q]);return f.jsx("div",{className:"space-y-6 animate-fade-in",children:f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),f.jsx("input",{type:"date",id:"dateFrom",value:V,onChange:z=>L(z.target.value),className:"w-full p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),f.jsx("input",{type:"date",id:"dateTo",value:j,onChange:z=>$(z.target.value),className:"w-full p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),f.jsxs("select",{id:"filterMethod",value:T,onChange:z=>E(z.target.value),className:"p-2 w-full",children:[f.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(z=>f.jsxs("option",{value:z.id,children:["🏦 ",z.name]},z.id)),f.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(z=>f.jsxs("option",{value:z.id,children:["💳 ",z.name]},z.id)),f.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),f.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),f.jsxs("select",{id:"filterCategory",value:b,onChange:z=>I(z.target.value),className:"p-2 w-full",children:[f.jsx("option",{value:"",children:"كل الفئات"}),t.map(z=>f.jsx("option",{value:z.id,children:z.name},z.id))]})]}),f.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[f.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),f.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:g,onChange:z=>m(z.target.value),className:"p-2 w-full"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),f.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),f.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:f.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:Je(X.positive)})})]}),f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),f.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),f.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:f.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:Je(X.negative)})})]}),f.jsxs("div",{className:"card-consistent",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),f.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),f.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:f.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:Je(X.positive-X.negative)})})]})]}),f.jsxs("div",{className:"overflow-x-auto",children:[f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),f.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),f.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),f.jsx("tbody",{children:q.map(z=>{const R=t.find(D=>D.id===z.categoryId),C=z.type==="income"||z.type.toString().includes("payment")||z.type==="investment-withdrawal";return f.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[f.jsx("td",{className:"p-3",children:z.date}),f.jsx("td",{className:"p-3",children:J(z.paymentMethod)}),f.jsx("td",{className:"p-3",children:ee(z.type)}),f.jsxs("td",{className:`p-3 font-semibold number-display ${C?"text-emerald-500":"text-red-500"}`,children:[C?"+":"-"," ",Je(z.amount)]}),f.jsx("td",{className:"p-3",children:R?`${R.icon} ${R.name}`:"غير محدد"}),f.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:z.description||"-"}),f.jsx("td",{className:"p-3 text-center",children:f.jsxs("div",{className:"flex gap-2 justify-center",children:[f.jsx("button",{onClick:()=>o(z.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),f.jsx("button",{onClick:()=>i(z.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:f.jsx(Fa,{})})]})})]},z.id)})})]}),q.length===0&&f.jsxs("div",{className:"text-center p-8 text-slate-500",children:[f.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),f.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})};class Ma{constructor(){this.cachedLocation=null,this.locationPromise=null}static getInstance(){return Ma.instance||(Ma.instance=new Ma),Ma.instance}async getCurrentLocation(){return this.cachedLocation?this.cachedLocation:this.locationPromise?this.locationPromise:(this.locationPromise=this.detectLocation(),this.locationPromise)}async detectLocation(){try{const e=await this.getLocationFromIP();if(e)return this.cachedLocation=e,e;const t=await this.getLocationFromGPS();if(t)return this.cachedLocation=t,t;const i={country:"Saudi Arabia",countryCode:"SA",region:"Riyadh",city:"Riyadh",timezone:"Asia/Riyadh"};return this.cachedLocation=i,i}catch(e){console.error("خطأ في كشف الموقع:",e);const t={country:"Saudi Arabia",countryCode:"SA",region:"Riyadh",city:"Riyadh",timezone:"Asia/Riyadh"};return this.cachedLocation=t,t}}async getLocationFromIP(){try{const t=await(await fetch("https://ipapi.co/json/")).json();if(t.error)throw new Error(t.reason);return{country:t.country_name||"Unknown",countryCode:t.country_code||"XX",region:t.region||"Unknown",city:t.city||"Unknown",latitude:t.latitude,longitude:t.longitude,timezone:t.timezone||"UTC"}}catch(e){return console.error("خطأ في كشف الموقع من IP:",e),null}}async getLocationFromGPS(){return new Promise(e=>{if(!navigator.geolocation){e(null);return}navigator.geolocation.getCurrentPosition(async t=>{try{const{latitude:i,longitude:o}=t.coords,l=await this.reverseGeocode(i,o);e(l)}catch(i){console.error("خطأ في تحويل الإحداثيات:",i),e(null)}},t=>{console.error("خطأ في GPS:",t),e(null)},{timeout:1e4,enableHighAccuracy:!0,maximumAge:3e5})})}async reverseGeocode(e,t){try{const o=await(await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${t}&localityLanguage=ar`)).json();return{country:o.countryName||"Unknown",countryCode:o.countryCode||"XX",region:o.principalSubdivision||"Unknown",city:o.city||o.locality||"Unknown",latitude:e,longitude:t,timezone:o.timezone||"UTC"}}catch(i){return console.error("خطأ في تحويل الإحداثيات:",i),null}}getSearchContext(e){return{SA:`في المملكة العربية السعودية، خاصة في ${e.city} و${e.region}`,JO:`في المملكة الأردنية الهاشمية، خاصة في ${e.city}`,IL:`في فلسطين المحتلة، خاصة في ${e.city}`,AE:`في دولة الإمارات العربية المتحدة، خاصة في ${e.city}`,KW:`في دولة الكويت، خاصة في ${e.city}`,QA:`في دولة قطر، خاصة في ${e.city}`,BH:`في مملكة البحرين، خاصة في ${e.city}`,OM:`في سلطنة عمان، خاصة في ${e.city}`,EG:`في جمهورية مصر العربية، خاصة في ${e.city}`}[e.countryCode]||`في ${e.country}، خاصة في ${e.city}`}getMajorCities(e){return{SA:["الرياض","جدة","المدينة المنورة","مكة المكرمة","الدمام","الخبر","الظهران","الطائف","بريدة","تبوك","خميس مشيط","الهفوف","حائل","نجران","الجبيل","ينبع"],JO:["عمان","إربد","الزرقاء","السلط","العقبة","الكرك","مادبا","الطفيلة","معان","جرش"],IL:["القدس","رام الله","نابلس","الخليل","بيت لحم","جنين","طولكرم","قلقيلية","سلفيت","أريحا"],AE:["دبي","أبو ظبي","الشارقة","عجمان","رأس الخيمة","الفجيرة","أم القيوين"],KW:["الكويت","الأحمدي","حولي","الفروانية","الجهراء","مبارك الكبير"],QA:["الدوحة","الريان","أم صلال","الخور","الوكرة","الجميلية"],BH:["المنامة","المحرق","الرفاع","مدينة حمد","الدراز","سترة"],OM:["مسقط","صلالة","صور","نزوى","البريمي","السيب"],EG:["القاهرة","الإسكندرية","الجيزة","شبرا الخيمة","بورسعيد","السويس","الأقصر","أسيوط","طنطا","المنصورة"]}[e.countryCode]||[e.city]}clearCache(){this.cachedLocation=null,this.locationPromise=null}isSupported(){return"geolocation"in navigator||!0}}const Jm=Ma.getInstance(),h4=()=>f.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),m4=({calculations:n,filteredTransactions:e,allTransactions:t,state:i,language:o="ar"})=>{const[l,u]=de.useState([{id:"1",text:`مرحباً! أنا مساعدك الذكي 🤖✨

🔍 **يمكنني مساعدتك في:**
• تحليل بياناتك المالية عبر جميع الأشهر
• البحث عن أفضل العروض والأسعار حسب موقعك
• مقارنة الأسعار والمطاعم في منطقتك

💬 **اسألني مثلاً:**
• "كم صرفت هذا الشهر؟"
• "أين أفضل عروض قريبة مني؟"
• "كم سعر الهاتف في منطقتي؟"

🔍 **جاري كشف موقعك...**`,sender:"ai"}]),[d,g]=de.useState(""),[m,T]=de.useState(!1),[E,b]=de.useState(null),[I,V]=de.useState(!1),L=de.useRef(null);de.useEffect(()=>{var $;($=L.current)==null||$.scrollTo(0,L.current.scrollHeight)},[l,m]),de.useEffect(()=>{(async()=>{try{const J=await Jm.getCurrentLocation();b(J),V(!0),u(ee=>[{...ee[0],text:`مرحباً! أنا مساعدك الذكي 🤖✨

🔍 **يمكنني مساعدتك في:**
• تحليل بياناتك المالية عبر جميع الأشهر
• البحث عن أفضل العروض والأسعار في ${J.city}
• مقارنة الأسعار والمطاعم في منطقتك

💬 **اسألني مثلاً:**
• "كم صرفت هذا الشهر؟"
• "أين أفضل عروض في ${J.city}؟"
• "كم سعر الهاتف في منطقتي؟"

📍 **موقعك:** ${J.city}، ${J.country}

ماذا تريد أن تعرف؟ 😊`}])}catch(J){console.error("خطأ في كشف الموقع:",J),V(!0),u(ee=>[{...ee[0],text:`مرحباً! أنا مساعدك الذكي 🤖✨

🔍 **يمكنني مساعدتك في:**
• تحليل بياناتك المالية عبر جميع الأشهر
• البحث عن أفضل العروض والأسعار
• مقارنة الأسعار والمطاعم

💬 **اسألني مثلاً:**
• "كم صرفت هذا الشهر؟"
• "أين أفضل عروض قريبة مني؟"
• "كم سعر الهاتف في منطقتي؟"

ماذا تريد أن تعرف؟ 😊`}])}})()},[]);const j=async $=>{$.preventDefault();const J=d.trim();if(!J||m)return;const ee={id:Date.now().toString(),text:J,sender:"user"};u(q=>[...q,ee]),g(""),T(!0);try{let q="";const X=["أين","كم سعر","عروض","محل","مطعم","بنده","تميمي","كارفور","عروض","سعر","أفضل","تقييم","مطاعم","متاجر","عرض","أرخص","غالي","السوق","متجر","مطعم","مقهى","كوفي","برجر","بيتزا","شاورما","دجاج","لحم","سمك","أكل","طعام","شراب","مشروب","قهوة","شاي"],z=["مصروف","دخل","ديون","بطاقة","شهر","تحليل","نمط","إنفاق","رصيد","قرض","قسط","استثمار","مالي","حساب","صرفت","وصل","تحويل","دفع","قسط","باقي","متوسط","إجمالي","شهر","أسبوع","سنة","مقارنة","تغير","زيادة","نقص","أعلى","أقل"],R=X.some(w=>J.toLowerCase().includes(w.toLowerCase())),C=z.some(w=>J.toLowerCase().includes(w.toLowerCase()));if(R){const w=E?{country:E.country,countryCode:E.countryCode,region:E.region,city:E.city,majorCities:Jm.getMajorCities(E),searchContext:Jm.getSearchContext(E)}:null;q=await bx(J,w)}else if(C){const w={currentPeriod:{calculations:n,transactions:e},allHistoricalData:{allTransactions:t,categories:i.categories,cards:i.cards,bankAccounts:i.bankAccounts,loans:i.loans,installments:i.installments,investments:i.investments},state:i};q=await xx(J,w)}else q=await Ax(J,t,n);const D={id:(Date.now()+1).toString(),text:q,sender:"ai"};u(w=>[...w,D])}catch(q){const X={id:(Date.now()+1).toString(),text:q instanceof Error?q.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};u(z=>[...z,X])}finally{T(!1)}};return f.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[f.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل الذكي"}),f.jsx("p",{className:"text-sm text-slate-500",children:"تحليل بياناتك المالية + البحث عن أفضل العروض في السعودية"})]}),f.jsxs("div",{ref:L,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[l.map($=>f.jsx("div",{className:`chat-bubble ${$.sender==="user"?"user-bubble":"ai-bubble"}`,children:f.jsx("p",{dangerouslySetInnerHTML:{__html:$.text.replace(/\n/g,"<br />")}})},$.id)),m&&f.jsx(h4,{})]}),f.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:f.jsxs("form",{onSubmit:j,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:d,onChange:$=>g($.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:m}),f.jsx("button",{type:"submit",disabled:m,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:f.jsx(hS,{})})]})})]})},p4=({calculations:n,categories:e,allTransactions:t,darkMode:i=!1,language:o="ar"})=>{const l=de.useRef(null),u=de.useRef(null),d=de.useRef({}),g=de.useMemo(()=>Object.entries(n.expensesByCategory).map(([T,E])=>{const b=e.find(I=>I.id===T);return{name:b?`${b.icon} ${b.name}`:"غير محدد",value:E}}).sort((T,E)=>E.value-T.value),[n.expensesByCategory,e]),m=de.useMemo(()=>{const T={},E=new Date;for(let b=5;b>=0;b--){const V=new Date(E.getFullYear(),E.getMonth()-b,1).toLocaleString("en-US",{month:"short",year:"numeric"});T[V]={income:0,expenses:0}}return t.forEach(b=>{const V=new Date(b.date).toLocaleString("en-US",{month:"short",year:"numeric"});T[V]&&(b.type==="income"&&(T[V].income+=b.amount),(b.type==="expense"||b.type==="bnpl-payment")&&(T[V].expenses+=b.amount))}),{labels:Object.keys(T),incomeData:Object.values(T).map(b=>b.income),expensesData:Object.values(T).map(b=>b.expenses)}},[t]);return de.useEffect(()=>{var E,b;const T=window.Chart;if(T){if((E=d.current.pie)==null||E.destroy(),(b=d.current.bar)==null||b.destroy(),l.current&&g.length>0){const I=l.current.getContext("2d");I&&(d.current.pie=new T(I,{type:"doughnut",data:{labels:g.map(V=>V.name),datasets:[{data:g.map(V=>V.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(u.current&&m.labels.length>0){const I=u.current.getContext("2d");I&&(d.current.bar=new T(I,{type:"bar",data:{labels:m.labels,datasets:[{label:"الدخل",data:m.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:m.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var I,V;(I=d.current.pie)==null||I.destroy(),(V=d.current.bar)==null||V.destroy()}}},[g,m]),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📊 توزيع مصاريف الفترة"}),f.jsx("div",{className:"h-80",children:g.length>0?f.jsx("canvas",{ref:l}):f.jsx("p",{className:"text-center text-slate-500 dark:text-slate-400 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),f.jsx("div",{className:"h-80",children:f.jsx("canvas",{ref:u})})]})]})},g4=({state:n,setLoading:e,setModal:t,darkMode:i=!1,language:o="ar"})=>{const[l,u]=de.useState(""),[d,g]=de.useState(""),m=async()=>{const T=parseFloat(l);if(isNaN(T)||T<=0){t({title:re("error",o),body:`<p>${re("invalid.amount",o)}</p>`,confirmText:re("confirm",o),hideCancel:!0});return}e(!0,re("loading",o)),g("");try{const E=new Date;E.setDate(E.getDate()-60);const b=n.transactions.filter(V=>new Date(V.date)>=E&&V.type==="expense");if(b.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const I=await Tx(T,n.categories,b);g(I)}catch(E){const b=E instanceof Error?E.message:"حدث خطأ غير متوقع.";t({title:re("error",o),body:`<p>${b}</p>`,confirmText:re("confirm",o),hideCancel:!0})}finally{e(!1)}};return f.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[f.jsxs("h3",{className:`text-xl font-bold mb-4 ${i?"text-slate-200":"text-slate-900"}`,children:["✨ ",re("budget",o)]}),f.jsxs("div",{className:`flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 rounded-lg ${i?"bg-slate-700":"bg-slate-100"}`,children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx("label",{htmlFor:"monthly-budget-input",className:`block text-sm font-medium mb-1 ${i?"text-slate-300":"text-slate-600"}`,children:re("budget.limit",o)}),f.jsx("input",{type:"number",id:"monthly-budget-input",className:`w-full p-2 ${i?"bg-slate-600 text-slate-200 border-slate-500":"bg-white text-slate-900 border-gray-300"} border rounded`,placeholder:"5000",value:l,onChange:T=>u(T.target.value)})]}),f.jsxs("button",{onClick:m,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:["✨ ",re("generate.report",o)]})]}),f.jsx("div",{className:"prose max-w-none",children:d?f.jsx("div",{className:i?"text-slate-200":"text-slate-900",dangerouslySetInnerHTML:{__html:d.replace(/### (.*)/g,`<h4 class="text-lg font-bold ${i?"text-slate-200":"text-slate-900"} mt-3 mb-2">$1</h4>`).replace(/\n/g,"<br />")}}):f.jsx("p",{className:`text-center ${i?"text-slate-400":"text-slate-500"}`,children:re("no.data",o)})})]})},y4=({state:n,setState:e,calculations:t,setModal:i,darkMode:o=!1,language:l="ar"})=>{const[u,d]=de.useState([{id:"1",text:`مرحباً! أنا مستشارك الاستثماري الذكي 🎯📈

💼 **خبرتي تشمل:**
• تحليل شامل لسوق تداول السعودي
• استراتيجيات استثمارية متقدمة
• إدارة المخاطر وتحسين المحافظ
• توصيات أسهم محددة مع تحليل عميق

📊 **يمكنني مساعدتك في:**
• تحليل محفظتك الحالية وتحسينها
• توصيات أسهم مع أهداف سعرية واضحة
• قراءة السوق وتوقعات الاتجاهات
• استراتيجيات دخول وخروج محددة

💡 **اسألني مثلاً:**
• "ما رأيك في أسهم أرامكو الآن؟"
• "كيف أحسن محفظتي الاستثمارية؟"
• "ما هي أفضل القطاعات للاستثمار؟"
• "أريد تحليل شامل لسوق اليوم"

أخبرني عن محفظتك وأهدافك الاستثمارية! 🚀`,sender:"ai"}]),[g,m]=de.useState(""),[T,E]=de.useState(!1),b=de.useRef(null);de.useEffect(()=>{var j;(j=b.current)==null||j.scrollTo(0,b.current.scrollHeight)},[u,T]);const I=j=>{j.preventDefault();const $=j.target,J=parseFloat($.elements.namedItem("investment-amount").value),ee=$.elements.namedItem("investment-type").value,q=$.elements.namedItem("payment-method").value;if(isNaN(J)||J<=0){i({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const X={amount:J,date:new Date().toISOString().split("T")[0],description:ee==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:q,type:ee==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(z=>({...z,transactions:[...z.transactions,{...X,id:`trans-${Date.now()}`}]})),$.reset()},V=async j=>{j.preventDefault();const $=g.trim();if(!(!$||T)){d(J=>[...J,{id:Date.now().toString(),text:$,sender:"user"}]),m(""),E(!0);try{const J={currentValue:n.investments.currentValue,totalDeposited:n.investments.totalDeposited,totalWithdrawn:n.investments.totalWithdrawn,transactions:n.transactions.filter(q=>q.type==="investment-deposit"||q.type==="investment-withdrawal"),recentPerformance:t.investments},ee=await Sx($,J,{marketDate:new Date().toLocaleDateString("en-CA"),saudiMarketContext:"Tadawul analysis requested",userInvestmentHistory:J});d(q=>[...q,{id:(Date.now()+1).toString(),text:ee,sender:"ai"}])}catch(J){d(ee=>[...ee,{id:(Date.now()+1).toString(),text:J instanceof Error?J.message:"عذراً، حدث خطأ في الاستشارة الاستثمارية.",sender:"ai"}])}finally{E(!1)}}},L=()=>{const j=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;i({show:!0,title:"تحديث قيمة المحفظة",body:j,confirmText:"حفظ",onConfirm:()=>{const $=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN($)||$<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(J=>({...J,investments:{...J.investments,currentValue:$}}))}})};return f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[f.jsxs("div",{className:"glass-card p-6 text-center",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),f.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:Je(n.investments.currentValue)}),f.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",f.jsx("span",{className:"font-semibold number-display text-slate-600",children:Je(t.totalInvestmentDeposits)})]}),f.jsx("button",{onClick:L,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),f.jsxs("form",{onSubmit:I,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),f.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),f.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[f.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),f.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),f.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(j=>f.jsxs("option",{value:j.id,children:["🏦 ",j.name]},j.id))})]}),f.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),f.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[f.jsxs("div",{className:`p-4 ${o?"bg-slate-800":"bg-gray-100"} text-center flex-shrink-0`,children:[f.jsx("h3",{className:`text-xl font-bold ${o?"text-slate-100":"text-slate-900"}`,children:"🎯 مستشارك الاستثماري المتقدم"}),f.jsx("p",{className:`text-sm ${o?"text-slate-400":"text-slate-500"}`,children:"تحليل السوق + توصيات أسهم + إدارة المحافظ"})]}),f.jsxs("div",{ref:b,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[u.map(j=>f.jsx("div",{className:`chat-bubble ${j.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:j.text.replace(/\n/g,"<br/>")}},j.id)),T&&f.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),f.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),f.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:f.jsxs("form",{onSubmit:V,className:"flex gap-2",children:[f.jsx("input",{type:"text",value:g,onChange:j=>m(j.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:T}),f.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:T,children:f.jsx(hS,{})})]})})]})]})},v4=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:i})=>{const o=(l,u)=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(d=>{var E;const g=((E=d.description)==null?void 0:E.includes(`سداد ${u.name}`))||d.type===`سداد ${u.name}`||d.type===`${u.id}-payment`,m=g?"text-green-500":"text-red-500",T=g?"+":"";return`
                <tr class="hover:bg-slate-50">
                    <td class="p-2">${d.postingDate||d.date}</td>
                    <td class="p-2 truncate" title="${d.description}">${d.description}</td>
                    <td class="p-2 number-display ${m}">${T}${Je(d.amount)}</td>
                </tr>
            `}).join("");return f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>i(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:f.jsx(Fa,{})})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),f.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),f.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:f.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[Je(e.statementDueAmount)," ريال"]})}),f.jsxs("div",{className:"flex justify-between items-center text-xs",children:[f.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),f.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),f.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[f.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),f.jsxs("p",{className:"font-bold text-red-800 number-display",children:[Je(n.balance)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[f.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),f.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[Je(n.limit)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[f.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),f.jsxs("p",{className:"font-bold text-green-800 number-display",children:[Je(n.available)," ريال"]})]}),f.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[f.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),f.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),f.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[f.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),f.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:f.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${o(e.upcomingTransactions,n)}</tbody>`}})})]})]})},_4=({state:n,calculations:e,openCardFormModal:t,deleteCard:i})=>{const o=de.useMemo(()=>{const u={};return Object.values(n.cards).forEach(d=>{const g=new Date,m=g.getDate(),T=g.getMonth(),E=g.getFullYear();let b,I,V;m>d.statementDay?b=new Date(E,T,d.statementDay):b=new Date(E,T-1,d.statementDay),I=new Date(b.getFullYear(),b.getMonth()-1,d.statementDay+1);let L=b.getMonth()+1,j=b.getFullYear();L>11&&(L=0,j+=1),V=new Date(j,L,d.dueDay);const $=n.transactions.filter(q=>{const X=new Date(q.postingDate||q.date);return q.paymentMethod===d.id&&(q.type==="expense"||q.type==="bnpl-payment")&&X>=I&&X<=b}),J=n.transactions.filter(q=>{var D,w,P,U,k,Oe,Be;const X=new Date(q.postingDate||q.date),z=q.paymentMethod===d.id&&(q.type==="expense"||q.type==="bnpl-payment"),R=(((D=q.description)==null?void 0:D.includes(`سداد ${d.name}`))||q.type===`سداد ${d.name}`||q.type===`${d.id}-payment`)&&(q.type==="expense"||((w=q.type)==null?void 0:w.includes("سداد"))||((P=q.type)==null?void 0:P.includes("-payment"))),C=q.paymentMethod===d.id&&(((U=q.description)==null?void 0:U.includes("سداد"))||((k=q.type)==null?void 0:k.includes("سداد"))||((Oe=q.type)==null?void 0:Oe.includes("-payment")))&&!((Be=q.description)!=null&&Be.includes(d.name))&&q.type!==`سداد ${d.name}`&&q.type!==`${d.id}-payment`;return(z||R||C)&&X>b}),ee=$.reduce((q,X)=>q+X.amount,0);u[d.id]={statementDueAmount:ee,dueDate:V,totalOutstanding:0,upcomingTransactions:J}}),u},[n.transactions,n.cards]),l=Object.values(n.cards);return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),f.jsx("button",{onClick:()=>t(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map(u=>{const d=e.cardDetails[u.id];return f.jsx(v4,{card:d,statementDetails:o[d.id],openCardFormModal:t,deleteCard:i},d.id)})})]})},T4=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const i=n.replace("-payment","");if(e.cards[i])return`💳 سداد ${e.cards[i].name}`}return n},E4=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),f.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:f.jsx(Fa,{})})]})]}),f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[f.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),f.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:Je(n.balance)})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[f.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),f.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:Je(n.deposits)})]}),f.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[f.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),f.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:Je(n.withdrawals)})]})]})]}),x4=({state:n,setState:e,calculations:t,filteredTransactions:i,categories:o,setModal:l,openBankAccountFormModal:u,deleteBankAccount:d,openTransferModal:g})=>f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),f.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&f.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),f.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(m=>f.jsx(E4,{account:m,openBankAccountFormModal:u,deleteBankAccount:d},m.id))}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),f.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),f.jsx("tbody",{children:i.filter(m=>n.bankAccounts[m.paymentMethod]).sort((m,T)=>new Date(T.date).getTime()-new Date(m.date).getTime()).map(m=>{var I;const T=["income","investment-withdrawal"].includes(m.type),E=T?"text-emerald-500":"text-red-500",b=o.find(V=>V.id===m.categoryId);return f.jsxs("tr",{className:"border-b border-gray-200/50",children:[f.jsx("td",{className:"p-3",children:m.date}),f.jsx("td",{className:"p-3",children:(I=n.bankAccounts[m.paymentMethod])==null?void 0:I.name}),f.jsx("td",{className:"p-3",children:T4(m.type,n)}),f.jsxs("td",{className:`p-3 font-semibold ${E} number-display`,children:[T?"+":"-",Je(m.amount)]}),f.jsx("td",{className:"p-3",children:b?`${b.icon} ${b.name}`:"-"}),f.jsx("td",{className:"p-3 text-slate-500",children:m.description||"-"})]},m.id)})})]})})]})]}),Ed=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},b4=({state:n,setState:e,filteredTransactions:t,setModal:i,darkMode:o=!1,language:l="ar"})=>{const[u,d]=Dp.useState(!1),g=()=>{const q=n.installments.filter(w=>w.paid<w.total),X=q.filter(w=>w.provider==="tabby-bnpl"),z=q.filter(w=>w.provider==="tamara-bnpl"),R=X.reduce((w,P)=>{const U=P.total-P.paid;return w+P.installmentAmount*U},0),C=z.reduce((w,P)=>{const U=P.total-P.paid;return w+P.installmentAmount*U},0),D=R+C;return{tabbyTotal:R,tamaraTotal:C,grandTotal:D,activeCount:q.length,completedCount:n.installments.filter(w=>w.paid>=w.total).length}},m=()=>{const q=n.installments.filter(R=>R.paid<R.total);if(q.length===0)return null;const X=n.transactions.filter(R=>R.isInstallmentPayment);if(X.length===0){const R=q.sort((w,P)=>new Date(w.createdAt).getTime()-new Date(P.createdAt).getTime())[0],C=new Date(R.createdAt),D=new Date(C);return D.setDate(D.getDate()+30),D.toISOString().split("T")[0]}let z=null;for(const R of q){const C=X.filter(D=>D.installmentId===R.id).sort((D,w)=>new Date(w.date).getTime()-new Date(D.date).getTime());if(C.length>0){const D=C[0],w=new Date(D.date),P=new Date(w);P.setDate(P.getDate()+30),(!z||P<new Date(z))&&(z=P.toISOString().split("T")[0])}else{const D=new Date(R.createdAt),w=new Date(D);w.setDate(w.getDate()+30),(!z||w<new Date(z))&&(z=w.toISOString().split("T")[0])}}return z},T=()=>n.installments.filter(X=>X.paid<X.total).reduce((X,z)=>X+z.installmentAmount,0),E=()=>{const q=n.installments.filter(z=>z.paid<z.total),X=n.transactions.filter(z=>z.isInstallmentPayment);return q.map(z=>{const R=X.filter(D=>D.installmentId===z.id).sort((D,w)=>new Date(w.date).getTime()-new Date(D.date).getTime());let C;if(R.length>0){const D=R[0],w=new Date(D.date),P=new Date(w);P.setDate(P.getDate()+30),C=P.toISOString().split("T")[0]}else{const D=new Date(z.createdAt),w=new Date(D);w.setDate(w.getDate()+30),C=w.toISOString().split("T")[0]}return{installment:z,nextPaymentDate:C}}).sort((z,R)=>new Date(z.nextPaymentDate).getTime()-new Date(R.nextPaymentDate).getTime())},b=q=>{const X=n.transactions.find(C=>C.id===q);if(!X||!X.isInstallmentPayment||!n.installments.find(C=>C.id===X.installmentId))return;const R=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${X.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${X.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${X.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(C=>`<option value="${C.id}" ${X.paymentMethod===C.id?"selected":""}>🏦 ${C.name}</option>`).join("")}
                        <option value="cash" ${X.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(C=>`<option value="${C.id}" ${X.paymentMethod===C.id?"selected":""}>💳 ${C.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;i({show:!0,title:"تعديل حركة القسط",body:R,confirmText:"حفظ التعديلات",onConfirm:()=>{const C=parseFloat(document.getElementById("edit-amount").value),D=document.getElementById("edit-date").value,w=document.getElementById("edit-description").value,P=document.getElementById("edit-payment-method").value;e(U=>({...U,transactions:U.transactions.map(k=>k.id===q?{...k,amount:C,date:D,description:w,paymentMethod:P}:k)})),i({show:!1})}})},I=q=>{const X=n.transactions.find(R=>R.id===q);if(!X||!X.isInstallmentPayment)return;i({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const R=X.installmentId;e(C=>({...C,transactions:C.transactions.filter(D=>D.id!==q),installments:C.installments.map(D=>D.id===R?{...D,paid:Math.max(0,D.paid-1)}:D)})),i({show:!1})}})},V=q=>{const X=n.installments.find(R=>R.id===q);if(!X)return;const z=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${X.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${X.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${X.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${X.paid}" min="0" max="${X.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;i({show:!0,title:"تعديل خطة القسط",body:z,confirmText:"حفظ التعديلات",onConfirm:()=>{const R=document.getElementById("edit-description").value,C=parseFloat(document.getElementById("edit-amount").value),D=parseInt(document.getElementById("edit-total").value),w=parseInt(document.getElementById("edit-paid").value);e(P=>({...P,installments:P.installments.map(U=>U.id===q?{...U,description:R,installmentAmount:C,total:D,paid:w}:U)})),i({show:!1})}})},L=q=>{const X=n.installments.find(R=>R.id===q);if(!X)return;const z=`<p>هل أنت متأكد من حذف خطة القسط "${X.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;i({show:!0,title:"حذف خطة القسط",body:z,confirmText:"حذف",onConfirm:()=>{e(R=>({...R,installments:R.installments.filter(C=>C.id!==q),transactions:R.transactions.filter(C=>C.installmentId!==q)})),i({show:!1})}})},j=q=>{const X=n.installments.find(C=>C.id===q);if(!X||X.paid>=X.total)return;let z="";Object.values(n.bankAccounts).forEach(C=>{z+=`<option value="${C.id}">🏦 ${C.name}</option>`}),z+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(C=>{z+=`<option value="${C.id}">💳 ${C.name}</option>`});const R=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${X.description}" بقيمة ${Je(X.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${z}</select></div>`;i({show:!0,title:"سداد قسط",body:R,confirmText:"تأكيد الدفع",onConfirm:()=>{var U;const C=document.getElementById("installment-payment-source").value,D=n.categories.find(k=>k.name==="سداد فواتير"||k.name==="💳 سداد فواتير"),w=(D==null?void 0:D.id)||((U=n.categories.find(k=>k.name==="أخرى"))==null?void 0:U.id)||"",P={id:"trans-"+Date.now(),amount:X.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${X.paid+1} لـ: ${X.description}`,paymentMethod:C,type:"bnpl-payment",categoryId:w,isInstallmentPayment:!0,installmentId:q};e(k=>{const Oe=k.installments.map(Be=>{if(Be.id===q){const te={...Be,paid:Be.paid+1};return console.log("🔄 تحديث قسط:",{id:Be.id,paid:Be.paid,newPaid:te.paid,total:Be.total}),te}return Be});return{...k,transactions:[...k.transactions,P],installments:Oe}})}})},$=n.installments.filter(q=>q.paid<q.total),J=n.transactions.filter(q=>q.isInstallmentPayment),ee=g();return m(),T(),f.jsxs("div",{className:"animate-fade-in",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[f.jsx("div",{className:"flex justify-between items-start mb-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"ملخص الأقساط"}),f.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"🎯"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),f.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Je(ee.grandTotal)})]}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"📱"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Je(ee.tabbyTotal)})]}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-2xl",children:"📱"}),f.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Je(ee.tamaraTotal)})]})]}),E().length>0&&f.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("span",{className:"text-2xl",children:"⏰"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),f.jsx("div",{className:"space-y-2",children:E().slice(0,3).map((q,X)=>f.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-slate-700",children:q.installment.description}),f.jsx("p",{className:"text-xs text-slate-500",children:Ed(q.installment.provider,n)})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(q.nextPaymentDate).toLocaleDateString("en-GB")}),f.jsx("p",{className:"text-xs text-slate-600",children:Je(q.installment.installmentAmount)})]})]},q.installment.id))})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex gap-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-blue-900",children:ee.activeCount}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),f.jsx("div",{className:"text-center",children:f.jsxs("button",{onClick:()=>d(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[f.jsx("p",{className:"text-2xl font-bold text-green-600",children:ee.completedCount}),f.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),E().length>0&&f.jsx("button",{onClick:()=>{n.installments.filter(X=>X.paid<X.total).forEach(X=>{j(X.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),f.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📱 خطط الأقساط النشطة"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:$.length>0?$.map(q=>{const X=q.paid/q.total*100;return console.log("📊 عرض قسط:",{id:q.id,paid:q.paid,total:q.total,progress:X}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:q.description}),f.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:Ed(q.provider,n)})]})]}),f.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:f.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[Je(q.installmentAmount),"/شهر"]})})]}),f.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 p-3 rounded-lg border border-gray-200 dark:border-slate-700 mb-3",children:[f.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:f.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${X}%`}})}),f.jsxs("div",{className:"flex justify-between text-xs text-slate-600 dark:text-slate-400",children:[f.jsxs("span",{className:"font-medium",children:[q.paid," / ",q.total," مدفوع"]}),f.jsxs("span",{className:"font-medium",children:["متبقي: ",q.total-q.paid]})]}),f.jsx("div",{className:"text-center mt-2",children:f.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[X.toFixed(1),"% مكتمل"]})})]}),f.jsxs("div",{className:"flex gap-2 mt-3",children:[f.jsx("button",{onClick:()=>j(q.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),f.jsx("button",{onClick:()=>V(q.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),f.jsx("button",{onClick:()=>L(q.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},q.id)}):f.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:f.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),f.jsxs("div",{className:"glass-card p-6 mt-8",children:[f.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📋 سجل دفعات الأقساط"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"border-b border-gray-200 dark:border-slate-700",children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"التاريخ"}),f.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"الوصف"}),f.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"المصدر"}),f.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"المبلغ"}),f.jsx("th",{className:"text-right p-3 font-semibold text-slate-600 dark:text-slate-400",children:"الإجراءات"})]})}),f.jsx("tbody",{children:J.sort((q,X)=>new Date(X.date).getTime()-new Date(q.date).getTime()).map(q=>f.jsxs("tr",{className:"border-b border-gray-200/50 dark:border-slate-700/50 text-slate-700 dark:text-slate-300",children:[f.jsx("td",{className:"p-3",children:new Date(q.date).toLocaleDateString("en-GB")}),f.jsx("td",{className:"p-3 text-slate-600 dark:text-slate-400",children:q.description}),f.jsx("td",{className:"p-3",children:Ed(q.paymentMethod,n)}),f.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:Je(q.amount)}),f.jsx("td",{className:"p-3",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>b(q.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),f.jsx("button",{onClick:()=>I(q.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},q.id))})]})})]}),u&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:q=>q.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),f.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),f.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(q=>q.paid>=q.total).map(q=>f.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-green-800",children:q.description}),f.jsx("p",{className:"text-sm text-green-600",children:Ed(q.provider,n)})]}),f.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:q.total}),f.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:Je(q.installmentAmount)}),f.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),f.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-bold text-lg",children:Je(q.total*q.installmentAmount)}),f.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},q.id)),Object.values(n.installments).filter(q=>q.paid>=q.total).length===0&&f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),f.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),f.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),f.jsx("div",{className:"flex justify-end mt-6",children:f.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},HE=({onClose:n,onSave:e,initialData:t,type:i,darkMode:o=!1,language:l="ar"})=>{const[u,d]=de.useState({[i==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[g,m]=de.useState({});Dp.useEffect(()=>{t&&d(t)},[t]);const T=V=>{const{name:L,value:j}=V.target;d($=>({...$,[L]:L==="amount"?parseFloat(j)||0:j})),g[L]&&m($=>({...$,[L]:""}))},E=()=>{const V={};return u[i==="toMe"?"debtor":"creditor"]||(V[i==="toMe"?"debtor":"creditor"]="اسم المدين/الدائن مطلوب"),u.amount<=0&&(V.amount="المبلغ يجب أن يكون أكبر من صفر"),u.description.trim()||(V.description="وصف الدين مطلوب"),u.date||(V.date="تاريخ الدين مطلوب"),m(V),Object.keys(V).length===0},b=V=>{V.preventDefault(),E()&&e(u,t==null?void 0:t.id)},I=i==="toMe";return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:V=>V.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:I?"إضافة دين لي":"إضافة دين علي"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(zu,{})})]}),f.jsxs("form",{onSubmit:b,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:I?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:I?"اسم المدين":"اسم الدائن"}),f.jsx("input",{type:"text",id:I?"debtor":"creditor",name:I?"debtor":"creditor",value:u[I?"debtor":"creditor"],onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:I?"اسم الشخص الذي يدين لي":"اسم الشخص الذي أدين له",required:!0}),g[I?"debtor":"creditor"]&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g[I?"debtor":"creditor"]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ"}),f.jsx("input",{type:"number",id:"amount",name:"amount",value:u.amount,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),g.amount&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.amount})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:I?"من أين دينني":"أين أضفت الدين"}),f.jsx("input",{type:"text",id:"source",name:"source",value:u.source,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:I?"مثال: بنك الراجحي، تطبيق ستور":"مثال: بنك الأهلي، تطبيق تابي"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"السبب (اختياري)"}),f.jsx("textarea",{id:"reason",name:"reason",value:u.reason,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"سبب الدين أو تفاصيل إضافية..."})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"وصف الدين"}),f.jsx("input",{type:"text",id:"description",name:"description",value:u.description,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف مختصر للدين",required:!0}),g.description&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.description})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ الدين"}),f.jsx("input",{type:"date",id:"date",name:"date",value:u.date,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.date&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.date})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"الحالة"}),f.jsxs("select",{id:"status",name:"status",value:u.status,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"pending",children:"معلق"}),f.jsx("option",{value:"partial",children:"جزئي"}),f.jsx("option",{value:"paid",children:"مدفوع"})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"إضافة الدين"})]})]})]})})})},A4=({state:n,setState:e,setModal:t,openLoanFormModal:i,darkMode:o=!1,language:l="ar"})=>{const[u,d]=de.useState("loans"),[g,m]=de.useState(!1),[T,E]=de.useState(!1),[b,I]=de.useState(!1),V=w=>{switch(w){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},L=w=>{switch(w){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},j=w=>{switch(w){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},$=w=>{switch(w){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},J=w=>{e(P=>({...P,loans:Object.fromEntries(Object.entries(P.loans).filter(([U])=>U!==w))}))},ee=w=>{const P={...w,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(U=>({...U,debtsToMe:{...U.debtsToMe,[P.id]:P}})),E(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين من "${P.debtor}" بقيمة ${Je(P.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},q=w=>{const P={...w,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(U=>({...U,debtsFromMe:{...U.debtsFromMe,[P.id]:P}})),I(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين لـ "${P.creditor}" بقيمة ${Je(P.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},X=w=>{e(P=>({...P,debtsToMe:Object.fromEntries(Object.entries(P.debtsToMe).filter(([U])=>U!==w))}))},z=w=>{e(P=>({...P,debtsFromMe:Object.fromEntries(Object.entries(P.debtsFromMe).filter(([U])=>U!==w))}))},R=Object.values(n.loans).filter(w=>w.status==="active").length,C=Object.values(n.debtsToMe).filter(w=>w.status!=="paid").length,D=Object.values(n.debtsFromMe).filter(w=>w.status!=="paid").length;return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"📊 الديون والقروض"})}),f.jsxs("div",{className:"flex space-x-1 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[f.jsxs("button",{onClick:()=>d("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="loans"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["🏦 القروض (",R,")"]}),f.jsxs("button",{onClick:()=>d("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-to-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["💰 الديون لي (",C,")"]}),f.jsxs("button",{onClick:()=>d("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-from-me"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200"}`,children:["💸 الديون علي (",D,")"]})]}),u==="loans"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),f.jsx("button",{onClick:()=>i(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),f.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(w=>f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx("span",{className:"text-blue-600 text-xl",children:V(w.type)})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:w.name}),f.jsxs("p",{className:"text-sm text-slate-500",children:[L(w.type)," - ",w.lender]})]})]}),f.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[f.jsx("button",{onClick:()=>i(w.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${w.name}`,children:"✏️"}),f.jsx("button",{onClick:()=>J(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${w.name}`,children:f.jsx(Fa,{})})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),f.jsx("p",{className:"text-xl font-bold text-blue-900",children:Je(w.totalAmount)})]}),(w.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[f.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),f.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((w.prepaidAmount||0)/w.totalAmount*100),"%"]})]}),f.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:f.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(w.prepaidAmount||0)/w.totalAmount*100}%`}})}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[f.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[f.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((w.prepaidAmount||0)/w.monthlyPayment)}),f.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),f.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[f.jsx("p",{className:"text-blue-700 font-bold text-sm",children:w.totalMonths-Math.floor((w.prepaidAmount||0)/w.monthlyPayment)}),f.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Je(w.monthlyPayment)})]}),f.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),f.jsxs("p",{className:"font-semibold text-slate-800",children:[w.remainingMonths||0," شهر"]})]})]}),(w.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),f.jsx("p",{className:"text-orange-900 font-bold text-lg",children:Je(w.prepaidAmount||0)})]}),f.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),f.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(w.status)}`,children:$(w.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(w.startDate).toLocaleDateString("en-GB")]})]})]})]},w.id))})]}),u==="debts-to-me"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),f.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"💰"}),f.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(w=>f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:w.debtor}),f.jsx("p",{className:"text-sm text-slate-500",children:w.description})]}),f.jsx("button",{onClick:()=>X(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${w.debtor}`,children:f.jsx(Fa,{})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),f.jsx("p",{className:"text-xl font-bold text-green-900",children:Je(w.amount)})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(w.status)}`,children:$(w.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(w.date).toLocaleDateString("ar-SA")]})]})]})]},w.id))})]}),u==="debts-from-me"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),f.jsx("button",{onClick:()=>I(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?f.jsxs("div",{className:"text-center py-12 text-slate-500",children:[f.jsx("div",{className:"text-6xl mb-4",children:"💸"}),f.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),f.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(w=>f.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:w.creditor}),f.jsx("p",{className:"text-sm text-slate-500",children:w.description})]}),f.jsx("button",{onClick:()=>z(w.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${w.creditor}`,children:f.jsx(Fa,{})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[f.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),f.jsx("p",{className:"text-xl font-bold text-red-900",children:Je(w.amount)})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(w.status)}`,children:$(w.status)}),f.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(w.date).toLocaleDateString("ar-SA")]})]})]})]},w.id))})]}),T&&f.jsx(HE,{onClose:()=>E(!1),onSave:ee,type:"toMe"}),b&&f.jsx(HE,{onClose:()=>I(!1),onSave:q,type:"fromMe"})]})},S4=({state:n,setState:e,setModal:t,setLoading:i,onRestore:o,darkMode:l=!1,language:u="ar"})=>{const[d,g]=de.useState(La()),[m,T]=de.useState({connected:!1}),[E,b]=de.useState(!0),[I,V]=de.useState({firebase:d.hasFirebase,gemini:d.hasGemini});de.useEffect(()=>{const he=La();g(he),V({firebase:he.hasFirebase,gemini:he.hasGemini}),he.hasFirebase?(async()=>{try{b(!0);const Ge=await Ri.getData("test","connection");T({connected:!0})}catch(Ge){T({connected:!1,error:Ge instanceof Error?Ge.message:"خطأ في الاتصال"})}finally{b(!1)}})():(T({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),b(!1))},[]);const L=({isValid:he})=>he?f.jsx(Gm,{className:"w-6 h-6 text-green-500"}):f.jsx($m,{className:"w-6 h-6 text-red-500"}),j=()=>f.jsx(t4,{className:"w-6 h-6 text-yellow-500"}),[$,J]=de.useState({name:"",icon:""}),[ee,q]=de.useState(null),[X,z]=de.useState({name:"",icon:""}),[R,C]=de.useState({name:"",icon:""}),D=()=>{if(!$.name.trim()||!$.icon.trim()){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}const ye={id:`cat-${Date.now()}`,name:$.name.trim(),icon:$.icon.trim()};e(Ge=>({...Ge,categories:[...Ge.categories,ye]})),J({name:"",icon:""}),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})},[w,P]=de.useState(!1),U=async()=>{const he=$.name.trim();if(!he){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}P(!0);try{const{suggestCategoryIcon:ye,initializeAi:Ge}=await Ai(async()=>{const{suggestCategoryIcon:An,initializeAi:kn}=await Promise.resolve().then(()=>FD);return{suggestCategoryIcon:An,initializeAi:kn}},void 0);Ge();const kt=await ye(he);kt&&kt.trim()?J(An=>({...An,icon:kt.trim()})):t({title:re("error",u),body:`<p>${re("unknown.error",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}catch(ye){console.error("Icon suggestion error:",ye),t({title:re("error",u),body:`<p>${re("try.again",u)}</p><p>${re("details",u)}: ${ye.message}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}finally{P(!1)}},k=he=>{n.transactions.some(ye=>ye.categoryId===he)?t({title:re("cannot.delete",u),body:`<p>${re("cannot.delete.category",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}):(e(ye=>({...ye,categories:ye.categories.filter(Ge=>Ge.id!==he)})),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}))},[Oe,Be]=de.useState(!1),te=async()=>{const he=X.name.trim();if(!he){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}try{Be(!0);const ye=await sp(he);ye&&ye.trim()?z(Ge=>({...Ge,icon:ye.trim()})):t({title:re("error",u),body:`<p>${re("unknown.error",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}catch(ye){console.error("Transaction type icon suggestion error:",ye),t({title:re("error",u),body:`<p>${re("try.again",u)}</p><p>${re("details",u)}: ${ye.message}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}finally{Be(!1)}},[Z,ge]=de.useState(!1),Pe=async()=>{const he=R.name.trim();if(!he){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}try{ge(!0);const ye=await sp(he);ye&&ye.trim()?C(Ge=>({...Ge,icon:ye.trim()})):t({title:re("error",u),body:`<p>${re("unknown.error",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}catch(ye){console.error("Payment method icon suggestion error:",ye),t({title:re("error",u),body:`<p>${re("try.again",u)}</p><p>${re("details",u)}: ${ye.message}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}finally{ge(!1)}},De=()=>{if(!X.name.trim()||!X.icon.trim()){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}const ye={id:`custom-type-${Date.now()}`,name:X.name.trim(),icon:X.icon.trim(),isCustom:!0};e(Ge=>({...Ge,customTransactionTypes:[...Ge.customTransactionTypes||[],ye]})),z({name:"",icon:""}),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})},F=he=>{n.transactions.some(ye=>ye.type===he)?t({title:re("cannot.delete",u),body:`<p>${re("cannot.delete.transaction.type",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}):(e(ye=>({...ye,customTransactionTypes:(ye.customTransactionTypes||[]).filter(Ge=>Ge.id!==he)})),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}))},oe=()=>{if(!R.name.trim()||!R.icon.trim()){t({title:re("error",u),body:`<p>${re("required.field",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});return}const ye={id:`custom-payment-${Date.now()}`,name:R.name.trim(),icon:R.icon.trim(),isCustom:!0};e(Ge=>({...Ge,customPaymentMethods:[...Ge.customPaymentMethods||[],ye]})),C({name:"",icon:""}),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})},_e=he=>{n.transactions.some(ye=>ye.paymentMethod===he)?t({title:re("cannot.delete",u),body:`<p>${re("cannot.delete.payment.method",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}):(e(ye=>({...ye,customPaymentMethods:(ye.customPaymentMethods||[]).filter(Ge=>Ge.id!==he)})),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)}))},xe=()=>{try{const he=JSON.stringify(n,null,2),ye=new Blob([he],{type:"application/json"}),Ge=URL.createObjectURL(ye),kt=document.createElement("a");kt.href=Ge,kt.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(kt),kt.click(),document.body.removeChild(kt),URL.revokeObjectURL(Ge),t({title:re("success",u),body:"<p>تم إنشاء النسخة الاحتياطية بنجاح</p>",hideCancel:!0,confirmText:re("confirm",u)})}catch{t({title:re("error",u),body:"<p>فشل في إنشاء النسخة الاحتياطية</p>",hideCancel:!0,confirmText:re("confirm",u)})}},Ie=()=>{t({title:"استعادة البيانات المحلية",body:"<p>هل تريد استعادة البيانات من النسخ الاحتياطية المحلية؟</p>",confirmText:"نعم، استعادة",onConfirm:()=>{try{let he=localStorage.getItem("financial_dashboard_backup_1");if(he||(he=localStorage.getItem("financial_dashboard_backup_2")),he){const ye=JSON.parse(he);e(ye),t({title:re("success",u),body:"<p>تم استعادة البيانات بنجاح</p>",hideCancel:!0,confirmText:re("confirm",u)})}else t({title:re("error",u),body:"<p>لم توجد نسخ احتياطية محلية</p>",hideCancel:!0,confirmText:re("confirm",u)})}catch{t({title:re("error",u),body:"<p>فشل في استعادة البيانات</p>",hideCancel:!0,confirmText:re("confirm",u)})}}})},Ve=async()=>{i(!0,re("loading",u));try{const he=await Ri.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(he.success)t({title:re("success",u),body:`<p>${re("success",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)});else throw new Error(he.error)}catch{t({title:re("error",u),body:`<p>${re("unknown.error",u)}</p>`,hideCancel:!0,confirmText:re("confirm",u)})}finally{i(!1)}},Ke=he=>{var kt;const ye=(kt=he.target.files)==null?void 0:kt[0];if(!ye)return;const Ge=new FileReader;Ge.onload=An=>{var kn;try{const _t=JSON.parse((kn=An.target)==null?void 0:kn.result);if(_t!=null&&_t.transactions&&(_t!=null&&_t.categories))o?o(_t):t({show:!0,title:re("restore.backup",u),body:`<p>${re("confirm.restore",u)}</p>`,confirmText:re("confirm",u),onConfirm:()=>{const ni={transactions:_t.transactions||[],categories:_t.categories||[],installments:_t.installments||[],investments:_t.investments||{currentValue:0},cards:_t.cards||{},bankAccounts:_t.bankAccounts||{}};e(ni),t({title:re("success",u),body:`<p>${re("success",u)}</p>`,confirmText:re("confirm",u),hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:re("error",u),body:`<p>${re("unknown.error",u)}</p>`,confirmText:re("confirm",u),hideCancel:!0})}},Ge.readAsText(ye),he.target.value=""};return f.jsxs("div",{className:"space-y-6 animate-fade-in",children:[f.jsx("div",{className:"flex justify-between items-center",children:f.jsxs("h2",{className:`text-2xl font-bold ${l?"text-slate-200":"text-slate-900"}`,children:["⚙️ ",re("settings",u)]})}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsxs("h3",{className:`text-lg font-bold mb-4 ${l?"text-slate-200":"text-slate-900"}`,children:["🔑 ",re("api.status",u)]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${l?"bg-slate-700":"bg-slate-50"}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"text-2xl",children:"🔥"}),f.jsxs("div",{children:[f.jsx("h4",{className:`font-semibold ${l?"text-slate-200":"text-slate-800"}`,children:"Firebase Configuration"}),f.jsxs("p",{className:`text-sm ${l?"text-slate-400":"text-slate-600"}`,children:["Project ID: ",Ft.firebase.projectId]})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:I.firebase?m.connected?f.jsxs(f.Fragment,{children:[f.jsx(Gm,{className:"w-6 h-6 text-green-500"}),f.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):f.jsxs(f.Fragment,{children:[f.jsx(j,{}),f.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):f.jsxs(f.Fragment,{children:[f.jsx($m,{className:"w-6 h-6 text-red-500"}),f.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"text-2xl",children:"🤖"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),f.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",Ft.gemini.model]})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:I.gemini?f.jsxs(f.Fragment,{children:[f.jsx(Gm,{className:"w-6 h-6 text-green-500"}),f.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):f.jsxs(f.Fragment,{children:[f.jsx($m,{className:"w-6 h-6 text-red-500"}),f.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!d.isValid&&f.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[f.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),f.jsx("ul",{className:"space-y-1",children:d.errors.map((he,ye)=>f.jsxs("li",{className:"text-sm text-red-600",children:["• ",he]},ye))})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📱 معلومات المشروع"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.name})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.version})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),f.jsx("p",{className:"font-semibold text-slate-800",children:Ft.app.environment})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(L,{isValid:d.isValid&&m.connected}),f.jsx("span",{className:`text-sm font-semibold ${d.isValid&&m.connected?"text-green-600":"text-red-600"}`,children:d.isValid&&m.connected?"جاهز":"يحتاج إعداد"})]})]}),f.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[f.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),f.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!d.isValid||!m.connected)&&f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📝 تعليمات الإعداد"}),f.jsxs("div",{className:"space-y-4",children:[!I.gemini&&f.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),f.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[f.jsxs("li",{children:["اذهب إلى ",f.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),f.jsx("li",{children:"أنشئ مفتاح API جديد"}),f.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",f.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),f.jsxs("li",{children:["أو ضعه في ملف ",f.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!I.firebase&&f.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),f.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",f.jsx("br",{}),"• VITE_FIREBASE_API_KEY",f.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",f.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",f.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",f.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",f.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"📂 إدارة الفئات"}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم الفئة",value:$.name,onChange:he=>J(ye=>({...ye,name:he.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:$.icon,onChange:he=>J(ye=>({...ye,icon:he.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:U,disabled:!$.name.trim()||w,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:w?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),f.jsx("button",{onClick:D,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(he=>f.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-lg",children:he.icon}),f.jsx("span",{className:"text-sm font-medium text-slate-800",children:he.name})]}),f.jsx("button",{onClick:()=>k(he.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},he.id))})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:X.name,onChange:he=>z(ye=>({...ye,name:he.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:X.icon,onChange:he=>z(ye=>({...ye,icon:he.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:te,disabled:!X.name.trim()||Oe,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:Oe?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),f.jsx("button",{onClick:De,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),f.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(he=>f.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm",children:he.icon}),f.jsx("span",{className:"text-xs font-medium text-slate-800",children:he.name})]}),f.jsx("button",{onClick:()=>F(he.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},he.id))})]}),f.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[f.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:R.name,onChange:he=>C(ye=>({...ye,name:he.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:R.icon,onChange:he=>C(ye=>({...ye,icon:he.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),f.jsx("button",{type:"button",onClick:Pe,disabled:!R.name.trim()||Z,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:Z?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),f.jsx("button",{onClick:oe,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),f.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(he=>f.jsxs("div",{className:"p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm",children:he.icon}),f.jsx("span",{className:"text-xs font-medium text-slate-800",children:he.name})]}),f.jsx("button",{onClick:()=>_e(he.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},he.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💰 دخل"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💸 مصاريف"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 سداد قسط"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💹 إيداع استثماري"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💹 سحب استثماري"}),f.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),f.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[f.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💵 نقدي"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 تابي"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"📱 تمارا"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"💳 سداد البطاقات"}),f.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),f.jsxs("div",{className:"glass-card p-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-slate-100",children:"💾 النسخ الاحتياطي والاستعادة"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),f.jsx("button",{onClick:xe,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),f.jsx("button",{onClick:Ve,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),f.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),f.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:Ke}),f.jsx("button",{onClick:()=>{var he;return(he=document.getElementById("backup-file"))==null?void 0:he.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors mb-2",children:"📥 استعادة من ملف"}),f.jsx("button",{onClick:Ie,className:"w-full px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors",children:"🔄 استعادة محلية"})]})]})]}),f.jsx("div",{className:"text-center",children:f.jsx("button",{onClick:()=>{g(La()),window.location.reload()},disabled:E,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:E?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},C4=({onClose:n,onSave:e,initialData:t,categories:i,cards:o,bankAccounts:l,loans:u,setModalConfig:d,darkMode:g=!1,language:m="ar"})=>{var te;const[T,E]=de.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((te=i.find(Z=>Z.name==="أخرى"))==null?void 0:te.id)||null}),[b,I]=de.useState(!1),[V,L]=de.useState(""),[j,$]=de.useState({isOpen:!1,text:""}),[J,ee]=de.useState(!1),[q,X]=de.useState(!1),[z,R]=de.useState(4),[C,D]=de.useState(Object.keys(l)[0]||"cash");de.useEffect(()=>{var Z;t?E(t):(Z=navigator.clipboard)!=null&&Z.readText&&(async()=>{try{const ge=await navigator.clipboard.readText();ge&&ge.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==ge&&$({isOpen:!0,text:ge})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const w=Z=>{const{name:ge,value:Pe}=Z.target;if(ge==="paymentMethod"){const De=Pe.includes("bnpl");X(De),De&&E(F=>({...F,type:"expense"}))}E(De=>({...De,[ge]:ge==="amount"?parseFloat(Pe):Pe}))},P=Z=>{if(Z.preventDefault(),T.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(Pe=>Pe.status==="active").length>0){ee(!0);return}q&&T.paymentMethod.includes("bnpl")?e({...T,bnplData:{installmentsCount:z,initialPaymentSource:C,installmentAmount:T.amount/z}},t==null?void 0:t.id):e(T,t==null?void 0:t.id)},U=async Z=>{if(Z.trim()){I(!0),L("");try{const ge=await _x(Z,i,o,l),Pe=JSON.parse(ge);Pe.error?L(Pe.error):E(De=>({...De,amount:Pe.amount||De.amount,date:Pe.date||De.date,description:Pe.merchant||De.description,paymentMethod:Pe.paymentMethod||De.paymentMethod,categoryId:Pe.categoryId||De.categoryId}))}catch(ge){L(ge instanceof Error?ge.message:re("unknown.error",m)),console.error(ge)}finally{I(!1)}}},k=async()=>{L("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){L("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const Z=await navigator.clipboard.readText();Z&&Z.trim().length>0?U(Z):L("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(Z){console.error("Clipboard operation failed: ",Z),L("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},Oe=de.useMemo(()=>{const Z=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach(ge=>Z.push({value:ge.id,label:`🏦 ${ge.name}`})),Object.values(o).forEach(ge=>Z.push({value:ge.id,label:`💳 ${ge.name}`})),Z.push({value:"tabby-bnpl",label:"📱 تابي"}),Z.push({value:"tamara-bnpl",label:"📱 تمارا"}),Z},[l,o]),Be=de.useMemo(()=>{const Z=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(o).forEach(ge=>Z.push({value:`${ge.id}-payment`,label:`💳 سداد ${ge.name}`})),Z},[o]);return f.jsxs(f.Fragment,{children:[j.isOpen&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>$({isOpen:!1,text:""}),children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Z=>Z.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),f.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:j.text}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",j.text),$({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),f.jsx("button",{onClick:()=>{$({isOpen:!1,text:""}),U(j.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:Z=>Z.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(zu,{})})]}),f.jsxs("button",{type:"button",onClick:k,disabled:b,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[f.jsx(KU,{}),f.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),b&&f.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),f.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),V&&f.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:V}),f.jsxs("form",{onSubmit:P,className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),f.jsx("input",{type:"number",name:"amount",value:T.amount,onChange:w,className:"w-full",required:!0,step:"0.01"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),f.jsx("input",{type:"date",name:"date",value:T.date,onChange:w,className:"w-full",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),f.jsx("input",{type:"text",name:"description",value:T.description,onChange:w,className:"w-full",required:!0})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),f.jsx("select",{name:"type",value:T.type,onChange:w,className:"w-full",children:Be.map(Z=>f.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),f.jsx("select",{name:"paymentMethod",value:T.paymentMethod,onChange:w,className:"w-full",children:Oe.map(Z=>f.jsx("option",{value:Z.value,children:Z.label},Z.value))})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),f.jsxs("select",{name:"categoryId",value:T.categoryId||"",onChange:w,className:"w-full",children:[f.jsx("option",{value:"",children:"-- اختر فئة --"}),i.map(Z=>f.jsxs("option",{value:Z.id,children:[Z.icon," ",Z.name]},Z.id))]})]}),q&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[f.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),f.jsxs("select",{value:z,onChange:Z=>R(parseInt(Z.target.value)),className:"w-full",children:[f.jsx("option",{value:2,children:"قسطين (2)"}),f.jsx("option",{value:3,children:"3 أقساط"}),f.jsx("option",{value:4,children:"4 أقساط"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),f.jsx("select",{value:C,onChange:Z=>D(Z.target.value),className:"w-full",children:Oe.filter(Z=>!Z.value.includes("bnpl")).map(Z=>f.jsx("option",{value:Z.value,children:Z.label},Z.value))})]})]}),f.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:f.jsxs("p",{className:"text-sm text-blue-700",children:[f.jsx("strong",{children:"الدفعة الأولى:"})," ",(T.amount/z).toFixed(2)," ريال",f.jsx("br",{}),f.jsx("strong",{children:"المبلغ المتبقي:"})," ",(T.amount*(z-1)/z).toFixed(2)," ريال"]})})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),J&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:Z=>Z.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),f.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(Z=>Z.status==="active").map(Z=>f.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:f.jsx("div",{className:"flex justify-between items-center",children:f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold text-blue-800",children:Z.name}),f.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",Z.monthlyPayment.toLocaleString()," ريال"]})]})})},Z.id))}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>{ee(!1),e(T,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),f.jsx("button",{onClick:()=>{ee(!1);const Z=Object.values(u).filter(De=>De.status==="active"),ge=Z.reduce((De,F)=>De+F.monthlyPayment,0),Pe={...T};Z.map(De=>({id:`trans-${Date.now()}-loan-${De.id}`,amount:De.monthlyPayment,date:T.date,description:`قسط شهري - ${De.name}`,paymentMethod:T.paymentMethod,type:"expense",categoryId:null})),e(Pe,t==null?void 0:t.id),d({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${ge.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},w4=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:o="ar"})=>{var m;const[l,u]=de.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});de.useEffect(()=>{t&&u(t)},[t]);const d=T=>{const{name:E,value:b,type:I}=T.target;u(E==="smsSamples"?V=>({...V,smsSamples:b.split(",").map(L=>L.trim()).filter(Boolean)}):V=>({...V,[E]:I==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(zu,{})})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),f.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:"w-full p-2",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),f.jsx("input",{type:"number",name:"limit",value:l.limit,onChange:d,className:"w-full p-2",required:!0,step:"100"})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),f.jsx("input",{type:"number",name:"statementDay",value:l.statementDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),f.jsx("input",{type:"number",name:"dueDay",value:l.dueDay,onChange:d,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),f.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},I4=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:o="ar"})=>{var m;const[l,u]=de.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});de.useEffect(()=>{t&&u(t)},[t]);const d=T=>{const{name:E,value:b,type:I}=T.target;u(E==="smsSamples"?V=>({...V,smsSamples:b.split(",").map(L=>L.trim()).filter(Boolean)}):V=>({...V,[E]:I==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(zu,{})})]}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),f.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:"w-full p-2",required:!0})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),f.jsx("input",{type:"number",name:"balance",value:l.balance,onChange:d,className:"w-full p-2",required:!0,step:"10"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),f.jsxs("select",{name:"currency",value:l.currency||"SAR",onChange:d,className:"w-full p-2",required:!0,children:[f.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),f.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),f.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),f.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),f.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),f.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),f.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),f.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),f.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),f.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),f.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:d,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),f.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},N4=({onClose:n,onSave:e,initialData:t,bankAccounts:i,darkMode:o=!1,language:l="ar"})=>{const[u,d]=de.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[g,m]=de.useState({});de.useEffect(()=>{t&&d(t)},[t]),de.useEffect(()=>{if(u.totalAmount>0&&u.downPayment>=0&&u.finalPayment>=0&&u.monthlyPayment>0){const L=u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0);if(L>0){const j=Math.ceil(L/u.monthlyPayment),$=new Date(u.startDate),J=new Date($);J.setMonth(J.getMonth()+j),d(ee=>({...ee,totalMonths:j,endDate:J.toISOString().split("T")[0],remainingMonths:j}))}}},[u.totalAmount,u.downPayment,u.finalPayment,u.monthlyPayment,u.startDate,u.prepaidAmount]),de.useEffect(()=>{if(u.prepaidAmount&&u.monthlyPayment>0){const L=Math.floor(u.prepaidAmount/u.monthlyPayment);d(j=>({...j,prepaidInstallments:L}))}else d(L=>({...L,prepaidInstallments:0}))},[u.prepaidAmount,u.monthlyPayment]);const T=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],E=L=>{const{name:j,value:$}=L.target;d(J=>({...J,[j]:j.includes("Amount")||j.includes("Payment")||j.includes("Months")?parseFloat($)||0:$})),g[j]&&m(J=>({...J,[j]:""}))},b=()=>{const L={};return u.name.trim()||(L.name="اسم القرض مطلوب"),u.totalAmount<=0&&(L.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),u.downPayment<0&&(L.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),u.finalPayment<0&&(L.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),u.monthlyPayment<=0&&(L.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),u.lender.trim()||(L.lender="اسم البنك أو المؤسسة مطلوب"),u.startDate||(L.startDate="تاريخ بداية القرض مطلوب"),u.downPayment+u.finalPayment>=u.totalAmount&&(L.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),m(L),Object.keys(L).length===0},I=L=>{if(L.preventDefault(),!b())return;const j={...u,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(j)},V=Object.values(i).map(L=>({value:L.id,label:`${L.name} (${L.currency})`}));return f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:f.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:L=>L.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),f.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:f.jsx(zu,{})})]}),f.jsxs("form",{onSubmit:I,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),f.jsx("select",{id:"type",name:"type",value:u.type,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:T.map(L=>f.jsxs("option",{value:L.value,children:[L.icon," ",L.label]},L.value))})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),f.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),g.name&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.name})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),f.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:u.totalAmount,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.totalAmount&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.totalAmount})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),f.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:u.downPayment,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.downPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.downPayment})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),f.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:u.finalPayment,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.finalPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.finalPayment})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),f.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:u.monthlyPayment,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.monthlyPayment&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.monthlyPayment})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),f.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:u.prepaidAmount||0,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),f.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(u.prepaidAmount||0)>0&&f.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[f.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",u.prepaidInstallments||0," قسط"]}),f.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0))," ريال"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),f.jsx("input",{type:"date",id:"startDate",name:"startDate",value:u.startDate,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.startDate&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.startDate})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),f.jsx("input",{type:"date",id:"endDate",name:"endDate",value:u.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),f.jsx("input",{type:"text",id:"lender",name:"lender",value:u.lender,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),g.lender&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.lender})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),f.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:u.linkedAccount,onChange:E,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:"اختر حساب بنكي"}),V.map(L=>f.jsx("option",{value:L.value,children:L.label},L.value))]})]})]}),u.totalMonths>0&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),f.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.totalMonths," شهر"]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),f.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.remainingMonths," شهر"]})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},R4=()=>{var Hi,Gi,cs,Lo,Gr;const[n,e]=de.useState(!1),[t,i]=de.useState(fd),[o,l]=de.useState(new Date().getFullYear()),[u,d]=de.useState(new Date().getMonth()+1),[g,m]=de.useState("summary"),[T,E]=de.useState({isLoading:!1,text:""}),[b,I]=de.useState(null),[V,L]=de.useState({isOpen:!1}),[j,$]=de.useState({isOpen:!1}),[J,ee]=de.useState({isOpen:!1}),[q,X]=de.useState({isOpen:!1}),[z,R]=de.useState({isOpen:!1}),[C,D]=de.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[w,P]=de.useState(!1),[U,k]=de.useState(""),[Oe,Be]=de.useState(null),[te,Z]=de.useState(!1),[ge,Pe]=de.useState(!0);de.useEffect(()=>{(async()=>{vx();const ce=await Ri.onAuthStateChanged(async me=>{try{me?(console.log("✅ تم تسجيل دخول المستخدم:",me.email),Be(me),await De(me.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),Be(null),await F())}catch(pe){console.error("خطأ في تحميل بيانات المستخدم:",pe),await F()}finally{Pe(!1),e(!0)}});return()=>{typeof ce=="function"&&ce()}})()},[]),de.useEffect(()=>(V.isOpen||j.isOpen||J.isOpen||q.isOpen||z.isOpen||b||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[V.isOpen,j.isOpen,J.isOpen,q.isOpen,z.isOpen,b,T.isLoading]),de.useEffect(()=>{const H=document.documentElement;t.settings.language==="ar"?(H.setAttribute("lang","ar"),H.setAttribute("dir","rtl")):(H.setAttribute("lang","en"),H.setAttribute("dir","ltr"))},[t.settings.language]),de.useEffect(()=>{t.settings.notifications&&$n()},[$n,t.settings.notifications]),de.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(H=>{console.log("Service Worker registered successfully:",H)}).catch(H=>{console.log("Service Worker registration failed:",H)})},[]),de.useEffect(()=>{var H,ce;z.isOpen&&C.fromAccount&&C.toAccount&&((H=t.bankAccounts[C.fromAccount])==null?void 0:H.currency)!==((ce=t.bankAccounts[C.toAccount])==null?void 0:ce.currency)&&tn()},[C.fromAccount,C.toAccount,z.isOpen]);const De=async H=>{var ce;try{const me=await Ri.getData("users",H);if(me.success&&me.data){const pe=fd(),Ee={...pe,...me.data,cards:{...pe.cards,...me.data.cards||{}},bankAccounts:{...pe.bankAccounts,...me.data.bankAccounts||{}},investments:{...pe.investments,...me.data.investments||{}}};i(Ee),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else me.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",me.error),(ce=me.error)!=null&&ce.includes("الأذونات")&&I({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(me){console.error("خطأ في تحميل بيانات المستخدم:",me)}},F=async()=>{try{const H=["financial_dashboard_state","financial_dashboard_backup_1","financial_dashboard_backup_2"];for(let pe=0;pe<7;pe++){const Ee=new Date;Ee.setDate(Ee.getDate()-pe);const Ne=Ee.toISOString().split("T")[0];H.push(`financial_dashboard_${Ne}`)}let ce=null,me="";for(const pe of H){const Ee=localStorage.getItem(pe);if(Ee)try{JSON.parse(Ee),ce=Ee,me=pe;break}catch{console.warn(`⚠️ بيانات تالفة في ${pe}`)}}if(ce){const pe=JSON.parse(ce),Ee=fd(),Ne={...Ee,...pe,cards:{...Ee.cards,...pe.cards||{}},bankAccounts:{...Ee.bankAccounts,...pe.bankAccounts||{}},investments:{...Ee.investments,...pe.investments||{}}};i(Ne),console.log(`✅ تم تحميل البيانات بنجاح من: ${me}`)}else console.log("ℹ️ لم توجد بيانات محفوظة، سيتم استخدام البيانات الافتراضية")}catch(H){console.error("❌ خطأ في تحميل البيانات المحلية:",H)}};de.useEffect(()=>{if(n&&!ge){try{const H=JSON.stringify(t);localStorage.setItem("financial_dashboard_state",H),localStorage.setItem("financial_dashboard_backup_1",H),localStorage.setItem("financial_dashboard_backup_2",H);const ce=new Date().toISOString();localStorage.setItem(`financial_dashboard_${ce.split("T")[0]}`,H),console.log("✅ تم حفظ البيانات في localStorage مع نسخ احتياطية متعددة")}catch(H){console.error("❌ خطأ في حفظ البيانات:",H)}if(Oe){const ce=setTimeout(async()=>{try{const me=await Ri.saveData("users",Oe.uid,t);me.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",me.error)}catch(me){console.error("❌ خطأ في حفظ البيانات في Firebase:",me)}},2e3);return()=>clearTimeout(ce)}}},[t,n,Oe,ge]);const oe=(H,ce="")=>E({isLoading:H,text:ce}),_e=de.useCallback(()=>t.transactions?t.transactions.filter(ce=>{const me=new Date(ce.date),pe=me.getFullYear()===o,Ee=u==="all"||me.getMonth()+1===u;return pe&&Ee}).sort((ce,me)=>{const pe=new Date(ce.date),Ne=new Date(me.date).getTime()-pe.getTime();if(Ne===0){const Yn=parseInt(ce.id.replace("trans-","").split("-")[0]);return parseInt(me.id.replace("trans-","").split("-")[0])-Yn}return Ne}):[],[t.transactions,o,u]),xe=de.useMemo(()=>t.transactions?[...t.transactions].sort((H,ce)=>{const me=new Date(H.date),Ee=new Date(ce.date).getTime()-me.getTime();if(Ee===0){const Ne=parseInt(H.id.replace("trans-","").split("-")[0]);return parseInt(ce.id.replace("trans-","").split("-")[0])-Ne}return Ee}):[],[t.transactions]),Ie=de.useMemo(()=>_e(),[_e]),Ve=de.useMemo(()=>{const H={},ce={},me={},pe={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(Te=>{Te&&Te.id&&(me[Te.id]={...Te,balance:0,available:Te.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(Te=>{Te&&Te.id&&(pe[Te.id]={...Te,deposits:0,withdrawals:0})});let Ee=0,Ne=0,Yn=0,Jn=0;Ie.forEach(Te=>{if(Te.type==="income")Ee+=Te.amount;else if(Te.type==="expense")Ne+=Te.amount,Te.categoryId&&(H[Te.categoryId]=(H[Te.categoryId]||0)+Te.amount);else if(Te.type==="bnpl-payment")Ne+=Te.amount,Te.categoryId&&(H[Te.categoryId]=(H[Te.categoryId]||0)+Te.amount);else if(Te.type==="investment-deposit")Yn+=Te.amount,Ne+=Te.amount;else if(Te.type==="investment-withdrawal")Jn+=Te.amount,Ee+=Te.amount;else if(Te.type.endsWith("-payment")){const rt=Te.type.replace("-payment","");ce[rt]?ce[rt]+=Te.amount:ce[rt]=Te.amount}}),Object.keys(t.cards).forEach(Te=>{const rt=t.cards[Te];let Lt=0;t.transactions.forEach(bt=>{var Vn,Ye,Ns,Uo,Rs;(Vn=bt.description)!=null&&Vn.includes(`سداد ${rt.name}`)||bt.type===`سداد ${rt.name}`||bt.type===`${Te}-payment`?Lt-=bt.amount:(bt.paymentMethod===Te&&((Ye=bt.description)!=null&&Ye.includes("سداد")||(Ns=bt.type)!=null&&Ns.includes("سداد")||(Uo=bt.type)!=null&&Uo.includes("-payment"))&&!((Rs=bt.description)!=null&&Rs.includes(rt.name))&&bt.type!==`سداد ${rt.name}`&&bt.type!==`${Te}-payment`||bt.paymentMethod===Te&&(bt.type==="expense"||bt.type==="bnpl-payment"))&&(Lt+=bt.amount)}),me[Te].balance=Lt,me[Te].available=rt.limit-Lt,me[Te].usagePercentage=rt.limit>0?Lt/rt.limit*100:0}),Object.keys(t.bankAccounts).forEach(Te=>{const rt=t.bankAccounts[Te];let Lt=0,bt=0,Vn=rt.balance;t.transactions.forEach(Ye=>{Ye.paymentMethod===Te&&(["income","investment-withdrawal"].includes(Ye.type)?Vn+=Ye.amount:["expense","investment-deposit"].includes(Ye.type)&&(Vn-=Ye.amount)),Ye.type.endsWith("-payment")&&Ye.paymentMethod===Te&&(Vn-=Ye.amount),Ye.type==="expense"&&Ye.isInstallmentPayment&&Ye.paymentMethod===Te&&(Vn-=Ye.amount)}),Ie.forEach(Ye=>{Ye.paymentMethod===Te&&(["income","investment-withdrawal"].includes(Ye.type)?Lt+=Ye.amount:["expense","investment-deposit"].includes(Ye.type)&&(bt+=Ye.amount)),Ye.type.endsWith("-payment")&&Ye.paymentMethod===Te&&(bt+=Ye.amount),Ye.type==="expense"&&Ye.isInstallmentPayment&&Ye.paymentMethod===Te&&(bt+=Ye.amount)}),pe[Te].balance=Vn,pe[Te].deposits=Lt,pe[Te].withdrawals=bt});const $i=Object.values(me).reduce((Te,rt)=>Te+rt.balance,0),Sn=Object.values(me).reduce((Te,rt)=>Te+rt.available,0),ds=Object.values(me).reduce((Te,rt)=>Te+rt.limit,0),xt=Object.values(pe).reduce((Te,rt)=>Te+rt.balance,0);return{totalIncome:Ee,totalExpenses:Ne,cardDetails:me,cardPayments:ce,bankAccountDetails:pe,totalDebt:$i,totalAvailable:Sn,totalLimits:ds,totalBankBalance:xt,totalInvestmentDeposits:Yn,totalInvestmentWithdrawals:Jn,expensesByCategory:H}},[Ie,t.transactions,t.cards,t.bankAccounts]),Ke=(H,ce)=>{i(me=>{if(ce){const pe=me.transactions.map(Ee=>Ee.id===ce?{...Ee,...H}:Ee);return{...me,transactions:pe}}else if(H.bnplData&&H.paymentMethod.includes("bnpl")){const pe={id:`installment-${Date.now()}`,provider:H.paymentMethod,description:H.description,totalAmount:H.amount,installmentAmount:H.bnplData.installmentAmount,total:H.bnplData.installmentsCount,paid:1,createdAt:H.date},Ee={id:`trans-${Date.now()}-1`,amount:H.bnplData.installmentAmount,date:H.date,description:`الدفعة الأولى لـ: ${H.description}`,paymentMethod:H.bnplData.initialPaymentSource,type:"expense",categoryId:H.categoryId,isInstallmentPayment:!0,installmentId:pe.id};return{...me,transactions:[...me.transactions,Ee],installments:[...me.installments,pe]}}else{const pe={id:`trans-${Date.now()}`,...H};return{...me,transactions:[...me.transactions,pe]}}}),L({isOpen:!1})},he=H=>{I({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{i(ce=>{const me=ce.transactions.find(Ne=>Ne.id===H);if(!me)return ce;const pe=ce.transactions.filter(Ne=>Ne.id!==H);let Ee=ce.installments;return me.isInstallmentPayment&&me.installmentId&&(Ee=ce.installments.map(Ne=>Ne.id===me.installmentId?{...Ne,paid:Math.max(0,Ne.paid-1)}:Ne)),{...ce,transactions:pe,installments:Ee}}),I(null)}})},ye=H=>{const ce=t.transactions.find(me=>me.id===H);ce&&L({isOpen:!0,initialData:ce})},Ge=async H=>{Be(H),Z(!1),await De(H.uid)},kt=async()=>{try{const H=await Ri.signOut();H.success?(console.log("✅ تم تسجيل الخروج بنجاح"),Be(null),await F()):console.error("❌ خطأ في تسجيل الخروج:",H.error)}catch(H){console.error("❌ خطأ في تسجيل الخروج:",H)}},An=(H,ce)=>{i(me=>{const pe={...me.cards};if(ce)pe[ce]={...pe[ce],...H,id:ce};else{const Ee=`card-${Date.now()}`;pe[Ee]={...H,id:Ee}}return{...me,cards:pe}}),$({isOpen:!1})},kn=H=>{var ce;t.transactions.some(me=>me.paymentMethod===H||me.type===`${H}-payment`)?I({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):I({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(ce=t.cards[H])==null?void 0:ce.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const pe={...me.cards};return delete pe[H],{...me,cards:pe}}),I(null)}})},_t=(H,ce)=>{i(me=>{const pe={...me.bankAccounts};if(ce)pe[ce]={...pe[ce],...H,id:ce};else{const Ee=`bank-${Date.now()}`;pe[Ee]={...H,id:Ee}}return{...me,bankAccounts:pe}}),ee({isOpen:!1})},ni=H=>{var ce;t.transactions.some(me=>me.paymentMethod===H)?I({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):I({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(ce=t.bankAccounts[H])==null?void 0:ce.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const pe={...me.bankAccounts};return delete pe[H],{...me,bankAccounts:pe}}),I(null)}})},si=H=>{I({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const ce=fd();if(H.creditCards&&!H.cards){const pe={};Object.entries(H.creditCards).forEach(([Ee,Ne])=>{pe[Ee]={id:Ee,name:Ee.toUpperCase(),limit:Ne.creditLimit||0,balance:Ne.currentBalance||0,dueDay:Ne.dueDay||1,smsSamples:[],keywords:[]}}),H.cards=pe}if(H.cards&&typeof H.cards=="object"&&(H.cards.snb||H.cards.enbd)){const pe={};H.cards.snb&&(pe["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:H.cards.snb.limit||0,dueDay:H.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),H.cards.enbd&&(pe["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:H.cards.enbd.limit||0,dueDay:H.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),H.cards=pe}H.bank&&!H.bankAccounts&&(H.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:H.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),H.transactions&&Array.isArray(H.transactions)&&(H.transactions=H.transactions.map(pe=>pe.paymentMethod==="mada-bank"?{...pe,paymentMethod:"bank-default"}:pe));const me={...ce,...H};i(me),Oe&&(async()=>{try{const Ee=await Ri.saveData("users",Oe.uid,me);Ee.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",Ee.error)}catch(Ee){console.error("❌ خطأ في حفظ البيانات في Firebase:",Ee)}})(),I({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{I({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},zr=H=>$({isOpen:!0,initialData:H?t.cards[H]:null}),Hr=H=>ee({isOpen:!0,initialData:H?t.bankAccounts[H]:null}),Dt=H=>X({isOpen:!0,initialData:H?t.loans[H]:null}),Vt=async()=>{const H=!t.settings.notifications;if(H)try{if(await Hm.requestPermission()!=="granted"){I({title:"إذن الإشعارات",body:"<p>لم يتم منح إذن الإشعارات. يرجى السماح بالإشعارات من إعدادات المتصفح.</p>",confirmText:"موافق"});return}}catch(ce){console.error("خطأ في طلب إذن الإشعارات:",ce),I({title:"خطأ في الإشعارات",body:"<p>حدث خطأ في تفعيل الإشعارات. قد لا يدعم متصفحك هذه الميزة.</p>",confirmText:"موافق"});return}i(ce=>({...ce,settings:{...ce.settings,notifications:H}})),H&&$n()},$n=de.useCallback(()=>{!t.settings.notifications||!Hm.isSupported()||Object.values(t.installments).forEach(H=>{if(H.paid<H.total){const ce=new Date;ce.setDate(ce.getDate()+(H.paid+1)*30),Hm.scheduleInstallmentNotification(H.id,H.description,ce,H.installmentAmount)}})},[t.installments,t.settings.notifications]),al=()=>{if(!C.fromAccount||!C.toAccount||C.amount<=0){I({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(C.fromAccount===C.toAccount){I({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const H=t.bankAccounts[C.fromAccount],ce=t.bankAccounts[C.toAccount],me=t.cards[C.fromAccount],pe=t.cards[C.toAccount],Ee=H||me,Ne=ce||pe,Yn=C.amount*C.exchangeRate,Jn=me?`${C.fromAccount}-payment`:"expense",$i=pe?`${C.toAccount}-payment`:"income",Sn={id:`trans-${Date.now()}-withdrawal`,amount:C.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(Ne==null?void 0:Ne.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.fromAccount,type:Jn,categoryId:null},ds={id:`trans-${Date.now()}-deposit`,amount:Yn,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(Ee==null?void 0:Ee.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.toAccount,type:$i,categoryId:null};i(xt=>({...xt,transactions:[...xt.transactions,Sn,ds]})),R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k(""),I({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Vo=H=>{if(i(ce=>({...ce,loans:{...ce.loans,[H.id]:H}})),!H.id.includes("edit")){const ce=[];H.downPayment>0&&ce.push({id:`trans-${Date.now()}-down-payment`,amount:H.downPayment,date:H.startDate,description:`دفعة أولى - ${H.name}`,paymentMethod:H.linkedAccount||"cash",type:"expense",categoryId:null}),ce.push({id:`trans-${Date.now()}-loan-deposit`,amount:H.totalAmount,date:H.startDate,description:`إيداع قرض - ${H.name} من ${H.lender}`,paymentMethod:H.linkedAccount||"cash",type:"income",categoryId:null}),H.finalPayment>0&&H.endDate&&ce.push({id:`trans-${Date.now()}-final-payment`,amount:H.finalPayment,date:H.endDate,description:`دفعة أخيرة - ${H.name}`,paymentMethod:H.linkedAccount||"cash",type:"expense",categoryId:null}),i(me=>({...me,transactions:[...me.transactions,...ce]}))}X({isOpen:!1}),I({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},tn=async()=>{if(!C.fromAccount||!C.toAccount)return;const H=t.bankAccounts[C.fromAccount],ce=t.bankAccounts[C.toAccount];if(!H||!ce)return;const me=H.currency||"SAR",pe=ce.currency||"SAR";if(me===pe){D(Ee=>({...Ee,exchangeRate:1})),k("");return}P(!0),k("");try{const Ee=await Ex(me,pe);D(Ne=>({...Ne,exchangeRate:Ee.rate}))}catch(Ee){k(Ee instanceof Error?Ee.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",Ee)}finally{P(!1)}};if(!n||ge)return f.jsx(l4,{});if(!Oe)return f.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:f.jsxs("div",{className:"w-full max-w-md px-4",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),f.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),f.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),f.jsx(BE,{onSuccess:Ge,onClose:()=>{},hideCloseButton:!0})]})});`${o}${u==="all"?"كل الشهور":new Date(o,u-1).toLocaleString("ar-SA",{month:"long"})}`;const ii=()=>{switch(g){case"summary":return f.jsx(d4,{calculations:Ve,categories:t.categories,state:t,language:t.settings.language});case"transactions":return f.jsx(f4,{transactions:Ie,allTransactions:xe,categories:t.categories,deleteTransaction:he,editTransaction:ye,state:t,language:t.settings.language});case"ai-assistant":return f.jsx(m4,{calculations:Ve,filteredTransactions:Ie,allTransactions:xe,state:t,language:t.settings.language});case"analysis":return f.jsx(p4,{calculations:Ve,categories:t.categories,allTransactions:t.transactions,language:t.settings.language});case"budget":return f.jsx(g4,{state:t,setLoading:oe,setModal:I,language:t.settings.language});case"investment":return f.jsx(y4,{state:t,setState:i,calculations:Ve,setModal:I,language:t.settings.language});case"cards":return f.jsx(_4,{state:t,calculations:Ve,openCardFormModal:zr,deleteCard:kn,language:t.settings.language});case"bank":return f.jsx(x4,{state:t,setState:i,calculations:Ve,filteredTransactions:Ie,categories:t.categories,setModal:I,openBankAccountFormModal:Hr,deleteBankAccount:ni,openTransferModal:()=>R({isOpen:!0}),language:t.settings.language});case"installments":return f.jsx(b4,{state:t,setState:i,filteredTransactions:Ie,setModal:I,language:t.settings.language});case"debts-loans":return f.jsx(A4,{state:t,setState:i,setModal:I,openLoanFormModal:Dt,language:t.settings.language});case"settings":return f.jsx(S4,{state:t,setState:i,setModal:I,setLoading:oe,onRestore:si,language:t.settings.language});default:return f.jsx("div",{children:"Tab not found"})}};return f.jsxs("div",{className:"min-h-screen font-sans",children:[f.jsx(i4,{selectedYear:o,selectedMonth:u,onYearChange:l,onMonthChange:H=>d(H),onAddTransaction:()=>L({isOpen:!0}),currentUser:Oe,onSignOut:kt,language:t.settings.language,notifications:t.settings.notifications,onToggleNotifications:Vt}),f.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[f.jsx(o4,{activeTab:g,setActiveTab:m,language:t.settings.language}),ii()]}),f.jsx("button",{onClick:()=>L({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),V.isOpen&&f.jsx(C4,{onClose:()=>L({isOpen:!1}),onSave:Ke,initialData:V.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,loans:t.loans,setModalConfig:I,darkMode:t.settings.darkMode,language:t.settings.language}),j.isOpen&&f.jsx(w4,{onClose:()=>$({isOpen:!1}),onSave:An,initialData:j.initialData}),J.isOpen&&f.jsx(I4,{onClose:()=>ee({isOpen:!1}),onSave:_t,initialData:J.initialData}),q.isOpen&&f.jsx(N4,{onClose:()=>X({isOpen:!1}),onSave:Vo,initialData:q.initialData,bankAccounts:t.bankAccounts}),z.isOpen&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},children:f.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:H=>H.stopPropagation(),children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"💸 تحويل بين الحسابات"}),f.jsx("button",{onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),f.jsxs("select",{id:"fromAccount",name:"fromAccount",value:C.fromAccount,onChange:H=>D(ce=>({...ce,fromAccount:H.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[f.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([H,ce])=>f.jsxs("option",{value:H,children:["🏦 ",ce.name]},H)),Object.entries(t.cards).map(([H,ce])=>f.jsxs("option",{value:H,children:["💳 ",ce.name]},H))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),f.jsxs("select",{id:"toAccount",name:"toAccount",value:C.toAccount,onChange:H=>D(ce=>({...ce,toAccount:H.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[f.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([H])=>H!==C.fromAccount).map(([H,ce])=>f.jsxs("option",{value:H,children:["🏦 ",ce.name]},H)),Object.entries(t.cards).filter(([H])=>H!==C.fromAccount).map(([H,ce])=>f.jsxs("option",{value:H,children:["💳 ",ce.name]},H))]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),f.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:C.amount,onChange:H=>D(ce=>({...ce,amount:parseFloat(H.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),C.fromAccount&&C.toAccount&&((Hi=t.bankAccounts[C.fromAccount])==null?void 0:Hi.currency)!==((Gi=t.bankAccounts[C.toAccount])==null?void 0:Gi.currency)&&f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(cs=t.bankAccounts[C.fromAccount])==null?void 0:cs.currency," → ",(Lo=t.bankAccounts[C.toAccount])==null?void 0:Lo.currency,")"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"number",step:"0.0001",value:C.exchangeRate,onChange:H=>D(ce=>({...ce,exchangeRate:parseFloat(H.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),f.jsxs("button",{type:"button",onClick:tn,disabled:w,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[w?f.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",f.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),U&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:U}),f.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(C.amount*C.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(Gr=t.bankAccounts[C.toAccount])==null?void 0:Gr.currency]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),f.jsx("input",{type:"text",id:"description",name:"description",value:C.description,onChange:H=>D(ce=>({...ce,description:H.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{type:"button",onClick:()=>{R({isOpen:!1}),D({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),k("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"button",onClick:al,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),b&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>I(null),children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:H=>H.stopPropagation(),children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 mb-4",children:b.title}),f.jsx("div",{className:"text-slate-600 dark:text-slate-300",dangerouslySetInnerHTML:{__html:b.body}}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!b.hideCancel&&f.jsx("button",{onClick:()=>I(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),f.jsx("button",{onClick:()=>{(!b.onConfirm||b.onConfirm()!==!1)&&I(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:b.confirmText||"موافق"})]})]})}),T.isLoading&&f.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),f.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),te&&Oe&&f.jsx(BE,{onSuccess:Ge,onClose:()=>Z(!1)})]})},mS=document.getElementById("root");if(!mS)throw new Error("Could not find root element");const D4=tw.createRoot(mS);D4.render(f.jsx(Dp.StrictMode,{children:f.jsx(R4,{})}));
