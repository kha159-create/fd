(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function qx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xm={exports:{}},iu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function jC(){if(jv)return iu;jv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var f in o)f!=="key"&&(l[f]=o[f])}else l=o;return o=l.ref,{$$typeof:n,type:i,key:u,ref:o!==void 0?o:null,props:l}}return iu.Fragment=e,iu.jsx=t,iu.jsxs=t,iu}var Fv;function FC(){return Fv||(Fv=1,xm.exports=jC()),xm.exports}var d=FC(),Em={exports:{}},qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function qC(){if(qv)return qe;qv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function w(q){return q===null||typeof q!="object"?null:(q=b&&q[b]||q["@@iterator"],typeof q=="function"?q:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,j={};function Y(q,oe,ve){this.props=q,this.context=oe,this.refs=j,this.updater=ve||L}Y.prototype.isReactComponent={},Y.prototype.setState=function(q,oe){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,oe,"setState")},Y.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function O(){}O.prototype=Y.prototype;function B(q,oe,ve){this.props=q,this.context=oe,this.refs=j,this.updater=ve||L}var ne=B.prototype=new O;ne.constructor=B,k(ne,Y.prototype),ne.isPureReactComponent=!0;var ie=Array.isArray;function H(){}var N={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function R(q,oe,ve){var _e=ve.ref;return{$$typeof:n,type:q,key:oe,ref:_e!==void 0?_e:null,props:ve}}function M(q,oe){return R(q.type,oe,q.props)}function V(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function F(q){var oe={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ve){return oe[ve]})}var P=/\/+/g;function Ue(q,oe){return typeof q=="object"&&q!==null&&q.key!=null?F(""+q.key):oe.toString(36)}function it(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(H,H):(q.status="pending",q.then(function(oe){q.status==="pending"&&(q.status="fulfilled",q.value=oe)},function(oe){q.status==="pending"&&(q.status="rejected",q.reason=oe)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function ee(q,oe,ve,_e,Ne){var Oe=typeof q;(Oe==="undefined"||Oe==="boolean")&&(q=null);var Ye=!1;if(q===null)Ye=!0;else switch(Oe){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(q.$$typeof){case n:case e:Ye=!0;break;case T:return Ye=q._init,ee(Ye(q._payload),oe,ve,_e,Ne)}}if(Ye)return Ne=Ne(q),Ye=_e===""?"."+Ue(q,0):_e,ie(Ne)?(ve="",Ye!=null&&(ve=Ye.replace(P,"$&/")+"/"),ee(Ne,oe,ve,"",function($e){return $e})):Ne!=null&&(V(Ne)&&(Ne=M(Ne,ve+(Ne.key==null||q&&q.key===Ne.key?"":(""+Ne.key).replace(P,"$&/")+"/")+Ye)),oe.push(Ne)),1;Ye=0;var fe=_e===""?".":_e+":";if(ie(q))for(var ge=0;ge<q.length;ge++)_e=q[ge],Oe=fe+Ue(_e,ge),Ye+=ee(_e,oe,ve,Oe,Ne);else if(ge=w(q),typeof ge=="function")for(q=ge.call(q),ge=0;!(_e=q.next()).done;)_e=_e.value,Oe=fe+Ue(_e,ge++),Ye+=ee(_e,oe,ve,Oe,Ne);else if(Oe==="object"){if(typeof q.then=="function")return ee(it(q),oe,ve,_e,Ne);throw oe=String(q),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function W(q,oe,ve){if(q==null)return q;var _e=[],Ne=0;return ee(q,_e,"","",function(Oe){return oe.call(ve,Oe,Ne++)}),_e}function pe(q){if(q._status===-1){var oe=q._result;oe=oe(),oe.then(function(ve){(q._status===0||q._status===-1)&&(q._status=1,q._result=ve)},function(ve){(q._status===0||q._status===-1)&&(q._status=2,q._result=ve)}),q._status===-1&&(q._status=0,q._result=oe)}if(q._status===1)return q._result.default;throw q._result}var Me=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Ie={map:W,forEach:function(q,oe,ve){W(q,function(){oe.apply(this,arguments)},ve)},count:function(q){var oe=0;return W(q,function(){oe++}),oe},toArray:function(q){return W(q,function(oe){return oe})||[]},only:function(q){if(!V(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return qe.Activity=x,qe.Children=Ie,qe.Component=Y,qe.Fragment=t,qe.Profiler=o,qe.PureComponent=B,qe.StrictMode=i,qe.Suspense=g,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,qe.__COMPILER_RUNTIME={__proto__:null,c:function(q){return N.H.useMemoCache(q)}},qe.cache=function(q){return function(){return q.apply(null,arguments)}},qe.cacheSignal=function(){return null},qe.cloneElement=function(q,oe,ve){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var _e=k({},q.props),Ne=q.key;if(oe!=null)for(Oe in oe.key!==void 0&&(Ne=""+oe.key),oe)!C.call(oe,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&oe.ref===void 0||(_e[Oe]=oe[Oe]);var Oe=arguments.length-2;if(Oe===1)_e.children=ve;else if(1<Oe){for(var Ye=Array(Oe),fe=0;fe<Oe;fe++)Ye[fe]=arguments[fe+2];_e.children=Ye}return R(q.type,Ne,_e)},qe.createContext=function(q){return q={$$typeof:u,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},qe.createElement=function(q,oe,ve){var _e,Ne={},Oe=null;if(oe!=null)for(_e in oe.key!==void 0&&(Oe=""+oe.key),oe)C.call(oe,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(Ne[_e]=oe[_e]);var Ye=arguments.length-2;if(Ye===1)Ne.children=ve;else if(1<Ye){for(var fe=Array(Ye),ge=0;ge<Ye;ge++)fe[ge]=arguments[ge+2];Ne.children=fe}if(q&&q.defaultProps)for(_e in Ye=q.defaultProps,Ye)Ne[_e]===void 0&&(Ne[_e]=Ye[_e]);return R(q,Oe,Ne)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(q){return{$$typeof:f,render:q}},qe.isValidElement=V,qe.lazy=function(q){return{$$typeof:T,_payload:{_status:-1,_result:q},_init:pe}},qe.memo=function(q,oe){return{$$typeof:m,type:q,compare:oe===void 0?null:oe}},qe.startTransition=function(q){var oe=N.T,ve={};N.T=ve;try{var _e=q(),Ne=N.S;Ne!==null&&Ne(ve,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(H,Me)}catch(Oe){Me(Oe)}finally{oe!==null&&ve.types!==null&&(oe.types=ve.types),N.T=oe}},qe.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},qe.use=function(q){return N.H.use(q)},qe.useActionState=function(q,oe,ve){return N.H.useActionState(q,oe,ve)},qe.useCallback=function(q,oe){return N.H.useCallback(q,oe)},qe.useContext=function(q){return N.H.useContext(q)},qe.useDebugValue=function(){},qe.useDeferredValue=function(q,oe){return N.H.useDeferredValue(q,oe)},qe.useEffect=function(q,oe){return N.H.useEffect(q,oe)},qe.useEffectEvent=function(q){return N.H.useEffectEvent(q)},qe.useId=function(){return N.H.useId()},qe.useImperativeHandle=function(q,oe,ve){return N.H.useImperativeHandle(q,oe,ve)},qe.useInsertionEffect=function(q,oe){return N.H.useInsertionEffect(q,oe)},qe.useLayoutEffect=function(q,oe){return N.H.useLayoutEffect(q,oe)},qe.useMemo=function(q,oe){return N.H.useMemo(q,oe)},qe.useOptimistic=function(q,oe){return N.H.useOptimistic(q,oe)},qe.useReducer=function(q,oe,ve){return N.H.useReducer(q,oe,ve)},qe.useRef=function(q){return N.H.useRef(q)},qe.useState=function(q){return N.H.useState(q)},qe.useSyncExternalStore=function(q,oe,ve){return N.H.useSyncExternalStore(q,oe,ve)},qe.useTransition=function(){return N.H.useTransition()},qe.version="19.2.0",qe}var Bv;function Cp(){return Bv||(Bv=1,Em.exports=qC()),Em.exports}var de=Cp();const wp=qx(de);var bm={exports:{}},ru={},Am={exports:{}},Sm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function BC(){return zv||(zv=1,(function(n){function e(ee,W){var pe=ee.length;ee.push(W);e:for(;0<pe;){var Me=pe-1>>>1,Ie=ee[Me];if(0<o(Ie,W))ee[Me]=W,ee[pe]=Ie,pe=Me;else break e}}function t(ee){return ee.length===0?null:ee[0]}function i(ee){if(ee.length===0)return null;var W=ee[0],pe=ee.pop();if(pe!==W){ee[0]=pe;e:for(var Me=0,Ie=ee.length,q=Ie>>>1;Me<q;){var oe=2*(Me+1)-1,ve=ee[oe],_e=oe+1,Ne=ee[_e];if(0>o(ve,pe))_e<Ie&&0>o(Ne,ve)?(ee[Me]=Ne,ee[_e]=pe,Me=_e):(ee[Me]=ve,ee[oe]=pe,Me=oe);else if(_e<Ie&&0>o(Ne,pe))ee[Me]=Ne,ee[_e]=pe,Me=_e;else break e}}return W}function o(ee,W){var pe=ee.sortIndex-W.sortIndex;return pe!==0?pe:ee.id-W.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var g=[],m=[],T=1,x=null,b=3,w=!1,L=!1,k=!1,j=!1,Y=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function ne(ee){for(var W=t(m);W!==null;){if(W.callback===null)i(m);else if(W.startTime<=ee)i(m),W.sortIndex=W.expirationTime,e(g,W);else break;W=t(m)}}function ie(ee){if(k=!1,ne(ee),!L)if(t(g)!==null)L=!0,H||(H=!0,F());else{var W=t(m);W!==null&&it(ie,W.startTime-ee)}}var H=!1,N=-1,C=5,R=-1;function M(){return j?!0:!(n.unstable_now()-R<C)}function V(){if(j=!1,H){var ee=n.unstable_now();R=ee;var W=!0;try{e:{L=!1,k&&(k=!1,O(N),N=-1),w=!0;var pe=b;try{t:{for(ne(ee),x=t(g);x!==null&&!(x.expirationTime>ee&&M());){var Me=x.callback;if(typeof Me=="function"){x.callback=null,b=x.priorityLevel;var Ie=Me(x.expirationTime<=ee);if(ee=n.unstable_now(),typeof Ie=="function"){x.callback=Ie,ne(ee),W=!0;break t}x===t(g)&&i(g),ne(ee)}else i(g);x=t(g)}if(x!==null)W=!0;else{var q=t(m);q!==null&&it(ie,q.startTime-ee),W=!1}}break e}finally{x=null,b=pe,w=!1}W=void 0}}finally{W?F():H=!1}}}var F;if(typeof B=="function")F=function(){B(V)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,Ue=P.port2;P.port1.onmessage=V,F=function(){Ue.postMessage(null)}}else F=function(){Y(V,0)};function it(ee,W){N=Y(function(){ee(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(ee){switch(b){case 1:case 2:case 3:var W=3;break;default:W=b}var pe=b;b=W;try{return ee()}finally{b=pe}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(ee,W){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var pe=b;b=ee;try{return W()}finally{b=pe}},n.unstable_scheduleCallback=function(ee,W,pe){var Me=n.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Me+pe:Me):pe=Me,ee){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=pe+Ie,ee={id:T++,callback:W,priorityLevel:ee,startTime:pe,expirationTime:Ie,sortIndex:-1},pe>Me?(ee.sortIndex=pe,e(m,ee),t(g)===null&&ee===t(m)&&(k?(O(N),N=-1):k=!0,it(ie,pe-Me))):(ee.sortIndex=Ie,e(g,ee),L||w||(L=!0,H||(H=!0,F()))),ee},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(ee){var W=b;return function(){var pe=b;b=W;try{return ee.apply(this,arguments)}finally{b=pe}}}})(Sm)),Sm}var Hv;function zC(){return Hv||(Hv=1,Am.exports=BC()),Am.exports}var Cm={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function HC(){if(Gv)return mn;Gv=1;var n=Cp();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(g,m,T){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:g,containerInfo:m,implementation:T}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,mn.createPortal=function(g,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,T)},mn.flushSync=function(g){var m=u.T,T=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=T,i.d.f()}},mn.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},mn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},mn.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var T=m.as,x=f(T,m.crossOrigin),b=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;T==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:w}):T==="script"&&i.d.X(g,{crossOrigin:x,integrity:b,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},mn.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var T=f(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},mn.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var T=m.as,x=f(T,m.crossOrigin);i.d.L(g,T,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},mn.preloadModule=function(g,m){if(typeof g=="string")if(m){var T=f(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},mn.requestFormReset=function(g){i.d.r(g)},mn.unstable_batchedUpdates=function(g,m){return g(m)},mn.useFormState=function(g,m,T){return u.H.useFormState(g,m,T)},mn.useFormStatus=function(){return u.H.useHostTransitionStatus()},mn.version="19.2.0",mn}var $v;function GC(){if($v)return Cm.exports;$v=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cm.exports=HC(),Cm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function $C(){if(Yv)return ru;Yv=1;var n=zC(),e=Cp(),t=GC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,a=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(a=r.return),s=r.return;while(s)}return r.tag===3?a:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var a=s,c=r;;){var v=a.return;if(v===null)break;var _=v.alternate;if(_===null){if(c=v.return,c!==null){a=c;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===a)return g(v),s;if(_===c)return g(v),r;_=_.sibling}throw Error(i(188))}if(a.return!==c.return)a=v,c=_;else{for(var A=!1,I=v.child;I;){if(I===a){A=!0,a=v,c=_;break}if(I===c){A=!0,c=v,a=_;break}I=I.sibling}if(!A){for(I=_.child;I;){if(I===a){A=!0,a=_,c=v;break}if(I===c){A=!0,c=_,a=v;break}I=I.sibling}if(!A)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?s:r}function T(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=T(s),r!==null)return r;s=s.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),B=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function Ue(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case k:return"Fragment";case Y:return"Profiler";case j:return"StrictMode";case ie:return"Suspense";case H:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case L:return"Portal";case B:return s.displayName||"Context";case O:return(s._context.displayName||"Context")+".Consumer";case ne:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return r=s.displayName||null,r!==null?r:Ue(s.type)||"Memo";case C:r=s._payload,s=s._init;try{return Ue(s(r))}catch{}}return null}var it=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Me=[],Ie=-1;function q(s){return{current:s}}function oe(s){0>Ie||(s.current=Me[Ie],Me[Ie]=null,Ie--)}function ve(s,r){Ie++,Me[Ie]=s.current,s.current=r}var _e=q(null),Ne=q(null),Oe=q(null),Ye=q(null);function fe(s,r){switch(ve(Oe,r),ve(Ne,s),ve(_e,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?lv(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=lv(r),s=uv(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}oe(_e),ve(_e,s)}function ge(){oe(_e),oe(Ne),oe(Oe)}function $e(s){s.memoizedState!==null&&ve(Ye,s);var r=_e.current,a=uv(r,s.type);r!==a&&(ve(Ne,s),ve(_e,a))}function Pt(s){Ne.current===s&&(oe(_e),oe(Ne)),Ye.current===s&&(oe(Ye),eu._currentValue=pe)}var bn,Pn;function _t(s){if(bn===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);bn=r&&r[1]||"",Pn=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bn+s+Pn}var Xs=!1;function Ws(s,r){if(!s||Xs)return"";Xs=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(te){var X=te}Reflect.construct(s,[],le)}else{try{le.call()}catch(te){X=te}s.call(le.prototype)}}else{try{throw Error()}catch(te){X=te}(le=s())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(te){if(te&&X&&typeof te.stack=="string")return[te.stack,X.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=c.DetermineComponentFrameRoot(),A=_[0],I=_[1];if(A&&I){var U=A.split(`
`),Q=I.split(`
`);for(v=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;v<Q.length&&!Q[v].includes("DetermineComponentFrameRoot");)v++;if(c===U.length||v===Q.length)for(c=U.length-1,v=Q.length-1;1<=c&&0<=v&&U[c]!==Q[v];)v--;for(;1<=c&&0<=v;c--,v--)if(U[c]!==Q[v]){if(c!==1||v!==1)do if(c--,v--,0>v||U[c]!==Q[v]){var re=`
`+U[c].replace(" at new "," at ");return s.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",s.displayName)),re}while(1<=c&&0<=v);break}}}finally{Xs=!1,Error.prepareStackTrace=a}return(a=s?s.displayName||s.name:"")?_t(a):""}function Ur(s,r){switch(s.tag){case 26:case 27:case 5:return _t(s.type);case 16:return _t("Lazy");case 13:return s.child!==r&&r!==null?_t("Suspense Fallback"):_t("Suspense");case 19:return _t("SuspenseList");case 0:case 15:return Ws(s.type,!1);case 11:return Ws(s.type.render,!1);case 1:return Ws(s.type,!0);case 31:return _t("Activity");default:return""}}function Or(s){try{var r="",a=null;do r+=Ur(s,a),a=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Nt=Object.prototype.hasOwnProperty,kt=n.unstable_scheduleCallback,As=n.unstable_cancelCallback,il=n.unstable_shouldYield,Do=n.unstable_requestPaint,en=n.unstable_now,Zs=n.unstable_getCurrentPriorityLevel,qi=n.unstable_ImmediatePriority,Bi=n.unstable_UserBlockingPriority,os=n.unstable_NormalPriority,Po=n.unstable_LowPriority,jr=n.unstable_IdlePriority,G=n.log,me=n.unstable_setDisableYieldValue,he=null,Te=null;function De(s){if(typeof G=="function"&&me(s),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(he,s)}catch{}}var Fe=Math.clz32?Math.clz32:ko,Fr=Math.log,ei=Math.LN2;function ko(s){return s>>>=0,s===0?32:31-(Fr(s)/ei|0)|0}var Hn=256,ti=262144,Rt=4194304;function xe(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function mt(s,r,a){var c=s.pendingLanes;if(c===0)return 0;var v=0,_=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var I=c&134217727;return I!==0?(c=I&~_,c!==0?v=xe(c):(A&=I,A!==0?v=xe(A):a||(a=I&~s,a!==0&&(v=xe(a))))):(I=c&~_,I!==0?v=xe(I):A!==0?v=xe(A):a||(a=c&~s,a!==0&&(v=xe(a)))),v===0?0:r!==0&&r!==v&&(r&_)===0&&(_=v&-v,a=r&-r,_>=a||_===32&&(a&4194048)!==0)?r:v}function Ft(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function An(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ss(){var s=Rt;return Rt<<=1,(Rt&62914560)===0&&(Rt=4194304),s}function Qe(s){for(var r=[],a=0;31>a;a++)r.push(s);return r}function qr(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Cf(s,r,a,c,v,_){var A=s.pendingLanes;s.pendingLanes=a,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=a,s.entangledLanes&=a,s.errorRecoveryDisabledLanes&=a,s.shellSuspendCounter=0;var I=s.entanglements,U=s.expirationTimes,Q=s.hiddenUpdates;for(a=A&~a;0<a;){var re=31-Fe(a),le=1<<re;I[re]=0,U[re]=-1;var X=Q[re];if(X!==null)for(Q[re]=null,re=0;re<X.length;re++){var te=X[re];te!==null&&(te.lane&=-536870913)}a&=~le}c!==0&&Br(s,c,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(A&~r))}function Br(s,r,a){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-Fe(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|a&261930}function rl(s,r){var a=s.entangledLanes|=r;for(s=s.entanglements;a;){var c=31-Fe(a),v=1<<c;v&r|s[c]&r&&(s[c]|=r),a&=~v}}function ol(s,r){var a=r&-r;return a=(a&42)!==0?1:zr(a),(a&(s.suspendedLanes|r))!==0?0:a}function zr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ni(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function qu(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:Dv(s.type))}function as(s,r){var a=W.p;try{return W.p=s,r()}finally{W.p=a}}var ls=Math.random().toString(36).slice(2),qt="__reactFiber$"+ls,tn="__reactProps$"+ls,Cs="__reactContainer$"+ls,Vo="__reactEvents$"+ls,wf="__reactListeners$"+ls,Bu="__reactHandles$"+ls,zu="__reactResources$"+ls,ws="__reactMarker$"+ls;function Lo(s){delete s[qt],delete s[tn],delete s[Vo],delete s[wf],delete s[Bu]}function Is(s){var r=s[qt];if(r)return r;for(var a=s.parentNode;a;){if(r=a[Cs]||a[qt]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(s=gv(s);s!==null;){if(a=s[qt])return a;s=gv(s)}return r}s=a,a=s.parentNode}return null}function Gn(s){if(s=s[qt]||s[Cs]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function kn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Ns(s){var r=s[zu];return r||(r=s[zu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Bt(s){s[ws]=!0}var al=new Set,ll={};function Rs(s,r){Ms(s,r),Ms(s+"Capture",r)}function Ms(s,r){for(ll[s]=r,s=0;s<r.length;s++)al.add(r[s])}var ul=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cl={},dl={};function Hu(s){return Nt.call(dl,s)?!0:Nt.call(cl,s)?!1:ul.test(s)?dl[s]=!0:(cl[s]=!0,!1)}function Uo(s,r,a){if(Hu(r))if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+a)}}function Vn(s,r,a){if(a===null)s.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+a)}}function zt(s,r,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttributeNS(r,a,""+c)}}function nn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function zi(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function fl(s,r,a){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,_=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return v.call(this)},set:function(A){a=""+A,_.call(this,A)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(A){a=""+A},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function dt(s){if(!s._valueTracker){var r=zi(s)?"checked":"value";s._valueTracker=fl(s,r,""+s[r])}}function Hr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return s&&(c=zi(s)?s.checked?"true":"false":s.value),s=c,s!==a?(r.setValue(s),!0):!1}function Ds(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Gr=/[\n"\\]/g;function Sn(s){return s.replace(Gr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Oo(s,r,a,c,v,_,A,I){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),r!=null?A==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+nn(r)):s.value!==""+nn(r)&&(s.value=""+nn(r)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),r!=null?hl(s,A,nn(r)):a!=null?hl(s,A,nn(a)):c!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+nn(I):s.removeAttribute("name")}function Gu(s,r,a,c,v,_,A,I){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),r!=null||a!=null){if(!(_!=="submit"&&_!=="reset"||r!=null)){dt(s);return}a=a!=null?""+nn(a):"",r=r!=null?""+nn(r):a,I||r===s.value||(s.value=r),s.defaultValue=r}c=c??v,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=I?s.checked:!!c,s.defaultChecked=!!c,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),dt(s)}function hl(s,r,a){r==="number"&&Ds(s.ownerDocument)===s||s.defaultValue===""+a||(s.defaultValue=""+a)}function Hi(s,r,a,c){if(s=s.options,r){r={};for(var v=0;v<a.length;v++)r["$"+a[v]]=!0;for(a=0;a<s.length;a++)v=r.hasOwnProperty("$"+s[a].value),s[a].selected!==v&&(s[a].selected=v),v&&c&&(s[a].defaultSelected=!0)}else{for(a=""+nn(a),r=null,v=0;v<s.length;v++){if(s[v].value===a){s[v].selected=!0,c&&(s[v].defaultSelected=!0);return}r!==null||s[v].disabled||(r=s[v])}r!==null&&(r.selected=!0)}}function $u(s,r,a){if(r!=null&&(r=""+nn(r),r!==s.value&&(s.value=r),a==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=a!=null?""+nn(a):""}function Gi(s,r,a,c){if(r==null){if(c!=null){if(a!=null)throw Error(i(92));if(it(c)){if(1<c.length)throw Error(i(93));c=c[0]}a=c}a==null&&(a=""),r=a}a=nn(r),s.defaultValue=a,c=s.textContent,c===a&&c!==""&&c!==null&&(s.value=c),dt(s)}function Cn(s,r){if(r){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=r;return}}s.textContent=r}var Yu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ml(s,r,a){var c=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,a):typeof a!="number"||a===0||Yu.has(r)?r==="float"?s.cssFloat=a:s[r]=(""+a).trim():s[r]=a+"px"}function pl(s,r,a){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var v in r)c=r[v],r.hasOwnProperty(v)&&a[v]!==c&&ml(s,v,c)}else for(var _ in r)r.hasOwnProperty(_)&&ml(s,_,r[_])}function jo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ju=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$i=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fo(s){return $i.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function us(){}var gl=null;function $n(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Yi=null,Ps=null;function $r(s){var r=Gn(s);if(r&&(s=r.stateNode)){var a=s[tn]||null;e:switch(s=r.stateNode,r.type){case"input":if(Oo(s,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Sn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==s&&c.form===s.form){var v=c[tn]||null;if(!v)throw Error(i(90));Oo(c,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(r=0;r<a.length;r++)c=a[r],c.form===s.form&&Hr(c)}break e;case"textarea":$u(s,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Hi(s,!!a.multiple,r,!1)}}}var qo=!1;function Ji(s,r,a){if(qo)return s(r,a);qo=!0;try{var c=s(r);return c}finally{if(qo=!1,(Yi!==null||Ps!==null)&&(qc(),Yi&&(r=Yi,s=Ps,Ps=Yi=null,$r(r),s)))for(r=0;r<s.length;r++)$r(s[r])}}function cs(s,r){var a=s.stateNode;if(a===null)return null;var c=a[tn]||null;if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yr=!1;if(Yn)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){Yr=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{Yr=!1}var ks=null,yl=null,Jr=null;function vl(){if(Jr)return Jr;var s,r=yl,a=r.length,c,v="value"in ks?ks.value:ks.textContent,_=v.length;for(s=0;s<a&&r[s]===v[s];s++);var A=a-s;for(c=1;c<=A&&r[a-c]===v[_-c];c++);return Jr=v.slice(s,1<c?1-c:void 0)}function Kr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function si(){return!0}function ds(){return!1}function ln(s){function r(a,c,v,_,A){this._reactName=a,this._targetInst=v,this.type=c,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(a=s[I],this[I]=a?a(_):_[I]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?si:ds,this.isPropagationStopped=ds,this}return x(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=si)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=si)},persist:function(){},isPersistent:si}),r}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vs=ln(ii),Ki=x({},ii,{view:0,detail:0}),_l=ln(Ki),Qi,Bo,Ls,zo=x({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ls&&(Ls&&s.type==="mousemove"?(Qi=s.screenX-Ls.screenX,Bo=s.screenY-Ls.screenY):Bo=Qi=0,Ls=s),Qi)},movementY:function(s){return"movementY"in s?s.movementY:Bo}}),Tl=ln(zo),Qr=x({},zo,{dataTransfer:0}),Ku=ln(Qr),Qu=x({},Ki,{relatedTarget:0}),Xr=ln(Qu),xl=x({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),Xu=ln(xl),Ho=x({},ii,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Wu=ln(Ho),Zu=x({},ii,{data:0}),Us=ln(Zu),ec={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sc(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=nc[s])?!!r[s]:!1}function Xi(){return sc}var Tn=x({},Ki,{key:function(s){if(s.key){var r=ec[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Kr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?tc[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xi,charCode:function(s){return s.type==="keypress"?Kr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Kr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ic=ln(Tn),rc=x({},zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ri=ln(rc),p=x({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xi}),E=ln(p),S=x({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),D=ln(S),J=x({},zo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Z=ln(J),ye=x({},ii,{newState:0,oldState:0}),ze=ln(ye),Vt=[9,13,27,32],lt=Yn&&"CompositionEvent"in window,Ct=null;Yn&&"documentMode"in document&&(Ct=document.documentMode);var Jn=Yn&&"TextEvent"in window&&!Ct,Os=Yn&&(!lt||Ct&&8<Ct&&11>=Ct),fs=" ",hs=!1;function Wr(s,r){switch(s){case"keyup":return Vt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Go(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var $o=!1;function uS(s,r){switch(s){case"compositionend":return Go(r);case"keypress":return r.which!==32?null:(hs=!0,fs);case"textInput":return s=r.data,s===fs&&hs?null:s;default:return null}}function cS(s,r){if($o)return s==="compositionend"||!lt&&Wr(s,r)?(s=vl(),Jr=yl=ks=null,$o=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Os&&r.locale!=="ko"?null:r.data;default:return null}}var dS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!dS[s.type]:r==="textarea"}function Tg(s,r,a,c){Yi?Ps?Ps.push(c):Ps=[c]:Yi=c,r=Jc(r,"onChange"),0<r.length&&(a=new Vs("onChange","change",null,a,c),s.push({event:a,listeners:r}))}var El=null,bl=null;function fS(s){nv(s,0)}function oc(s){var r=kn(s);if(Hr(r))return s}function xg(s,r){if(s==="change")return r}var Eg=!1;if(Yn){var If;if(Yn){var Nf="oninput"in document;if(!Nf){var bg=document.createElement("div");bg.setAttribute("oninput","return;"),Nf=typeof bg.oninput=="function"}If=Nf}else If=!1;Eg=If&&(!document.documentMode||9<document.documentMode)}function Ag(){El&&(El.detachEvent("onpropertychange",Sg),bl=El=null)}function Sg(s){if(s.propertyName==="value"&&oc(bl)){var r=[];Tg(r,bl,s,$n(s)),Ji(fS,r)}}function hS(s,r,a){s==="focusin"?(Ag(),El=r,bl=a,El.attachEvent("onpropertychange",Sg)):s==="focusout"&&Ag()}function mS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return oc(bl)}function pS(s,r){if(s==="click")return oc(r)}function gS(s,r){if(s==="input"||s==="change")return oc(r)}function yS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Ln=typeof Object.is=="function"?Object.is:yS;function Al(s,r){if(Ln(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var a=Object.keys(s),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var v=a[c];if(!Nt.call(r,v)||!Ln(s[v],r[v]))return!1}return!0}function Cg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function wg(s,r){var a=Cg(s);s=0;for(var c;a;){if(a.nodeType===3){if(c=s+a.textContent.length,s<=r&&c>=r)return{node:a,offset:r-s};s=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Cg(a)}}function Ig(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Ig(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function Ng(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ds(s.document);r instanceof s.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)s=r.contentWindow;else break;r=Ds(s.document)}return r}function Rf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var vS=Yn&&"documentMode"in document&&11>=document.documentMode,Yo=null,Mf=null,Sl=null,Df=!1;function Rg(s,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Df||Yo==null||Yo!==Ds(c)||(c=Yo,"selectionStart"in c&&Rf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Sl&&Al(Sl,c)||(Sl=c,c=Jc(Mf,"onSelect"),0<c.length&&(r=new Vs("onSelect","select",null,r,a),s.push({event:r,listeners:c}),r.target=Yo)))}function Zr(s,r){var a={};return a[s.toLowerCase()]=r.toLowerCase(),a["Webkit"+s]="webkit"+r,a["Moz"+s]="moz"+r,a}var Jo={animationend:Zr("Animation","AnimationEnd"),animationiteration:Zr("Animation","AnimationIteration"),animationstart:Zr("Animation","AnimationStart"),transitionrun:Zr("Transition","TransitionRun"),transitionstart:Zr("Transition","TransitionStart"),transitioncancel:Zr("Transition","TransitionCancel"),transitionend:Zr("Transition","TransitionEnd")},Pf={},Mg={};Yn&&(Mg=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function eo(s){if(Pf[s])return Pf[s];if(!Jo[s])return s;var r=Jo[s],a;for(a in r)if(r.hasOwnProperty(a)&&a in Mg)return Pf[s]=r[a];return s}var Dg=eo("animationend"),Pg=eo("animationiteration"),kg=eo("animationstart"),_S=eo("transitionrun"),TS=eo("transitionstart"),xS=eo("transitioncancel"),Vg=eo("transitionend"),Lg=new Map,kf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kf.push("scrollEnd");function ms(s,r){Lg.set(s,r),Rs(r,[s])}var ac=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Kn=[],Ko=0,Vf=0;function lc(){for(var s=Ko,r=Vf=Ko=0;r<s;){var a=Kn[r];Kn[r++]=null;var c=Kn[r];Kn[r++]=null;var v=Kn[r];Kn[r++]=null;var _=Kn[r];if(Kn[r++]=null,c!==null&&v!==null){var A=c.pending;A===null?v.next=v:(v.next=A.next,A.next=v),c.pending=v}_!==0&&Ug(a,v,_)}}function uc(s,r,a,c){Kn[Ko++]=s,Kn[Ko++]=r,Kn[Ko++]=a,Kn[Ko++]=c,Vf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Lf(s,r,a,c){return uc(s,r,a,c),cc(s)}function to(s,r){return uc(s,null,null,r),cc(s)}function Ug(s,r,a){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a);for(var v=!1,_=s.return;_!==null;)_.childLanes|=a,c=_.alternate,c!==null&&(c.childLanes|=a),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&r!==null&&(v=31-Fe(a),s=_.hiddenUpdates,c=s[v],c===null?s[v]=[r]:c.push(r),r.lane=a|536870912),_):null}function cc(s){if(50<Yl)throw Yl=0,Gh=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var Qo={};function ES(s,r,a,c){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(s,r,a,c){return new ES(s,r,a,c)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function oi(s,r){var a=s.alternate;return a===null?(a=Un(s.tag,r,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=r,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&65011712,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,r=s.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a.refCleanup=s.refCleanup,a}function Og(s,r){s.flags&=65011714;var a=s.alternate;return a===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,r=a.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function dc(s,r,a,c,v,_){var A=0;if(c=s,typeof s=="function")Uf(s)&&(A=1);else if(typeof s=="string")A=wC(s,a,_e.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Un(31,a,r,v),s.elementType=R,s.lanes=_,s;case k:return no(a.children,v,_,r);case j:A=8,v|=24;break;case Y:return s=Un(12,a,r,v|2),s.elementType=Y,s.lanes=_,s;case ie:return s=Un(13,a,r,v),s.elementType=ie,s.lanes=_,s;case H:return s=Un(19,a,r,v),s.elementType=H,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case B:A=10;break e;case O:A=9;break e;case ne:A=11;break e;case N:A=14;break e;case C:A=16,c=null;break e}A=29,a=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=Un(A,a,r,v),r.elementType=s,r.type=c,r.lanes=_,r}function no(s,r,a,c){return s=Un(7,s,c,r),s.lanes=a,s}function Of(s,r,a){return s=Un(6,s,null,r),s.lanes=a,s}function jg(s){var r=Un(18,null,null,0);return r.stateNode=s,r}function jf(s,r,a){return r=Un(4,s.children!==null?s.children:[],s.key,r),r.lanes=a,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var Fg=new WeakMap;function Qn(s,r){if(typeof s=="object"&&s!==null){var a=Fg.get(s);return a!==void 0?a:(r={value:s,source:r,stack:Or(r)},Fg.set(s,r),r)}return{value:s,source:r,stack:Or(r)}}var Xo=[],Wo=0,fc=null,Cl=0,Xn=[],Wn=0,Wi=null,js=1,Fs="";function ai(s,r){Xo[Wo++]=Cl,Xo[Wo++]=fc,fc=s,Cl=r}function qg(s,r,a){Xn[Wn++]=js,Xn[Wn++]=Fs,Xn[Wn++]=Wi,Wi=s;var c=js;s=Fs;var v=32-Fe(c)-1;c&=~(1<<v),a+=1;var _=32-Fe(r)+v;if(30<_){var A=v-v%5;_=(c&(1<<A)-1).toString(32),c>>=A,v-=A,js=1<<32-Fe(r)+v|a<<v|c,Fs=_+s}else js=1<<_|a<<v|c,Fs=s}function Ff(s){s.return!==null&&(ai(s,1),qg(s,1,0))}function qf(s){for(;s===fc;)fc=Xo[--Wo],Xo[Wo]=null,Cl=Xo[--Wo],Xo[Wo]=null;for(;s===Wi;)Wi=Xn[--Wn],Xn[Wn]=null,Fs=Xn[--Wn],Xn[Wn]=null,js=Xn[--Wn],Xn[Wn]=null}function Bg(s,r){Xn[Wn++]=js,Xn[Wn++]=Fs,Xn[Wn++]=Wi,js=r.id,Fs=r.overflow,Wi=s}var un=null,Et=null,nt=!1,Zi=null,Zn=!1,Bf=Error(i(519));function er(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wl(Qn(r,s)),Bf}function zg(s){var r=s.stateNode,a=s.type,c=s.memoizedProps;switch(r[qt]=s,r[tn]=c,a){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(a=0;a<Kl.length;a++)Ke(Kl[a],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Ke("invalid",r),Gu(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ke("invalid",r);break;case"textarea":Ke("invalid",r),Gi(r,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||c.suppressHydrationWarning===!0||ov(r.textContent,a)?(c.popover!=null&&(Ke("beforetoggle",r),Ke("toggle",r)),c.onScroll!=null&&Ke("scroll",r),c.onScrollEnd!=null&&Ke("scrollend",r),c.onClick!=null&&(r.onclick=us),r=!0):r=!1,r||er(s,!0)}function Hg(s){for(un=s.return;un;)switch(un.tag){case 5:case 31:case 13:Zn=!1;return;case 27:case 3:Zn=!0;return;default:un=un.return}}function Zo(s){if(s!==un)return!1;if(!nt)return Hg(s),nt=!0,!1;var r=s.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=s.type,a=!(a!=="form"&&a!=="button")||om(s.type,s.memoizedProps)),a=!a),a&&Et&&er(s),Hg(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Et=pv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Et=pv(s)}else r===27?(r=Et,mr(s.type)?(s=dm,dm=null,Et=s):Et=r):Et=un?ts(s.stateNode.nextSibling):null;return!0}function so(){Et=un=null,nt=!1}function zf(){var s=Zi;return s!==null&&(Rn===null?Rn=s:Rn.push.apply(Rn,s),Zi=null),s}function wl(s){Zi===null?Zi=[s]:Zi.push(s)}var Hf=q(null),io=null,li=null;function tr(s,r,a){ve(Hf,r._currentValue),r._currentValue=a}function ui(s){s._currentValue=Hf.current,oe(Hf)}function Gf(s,r,a){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===a)break;s=s.return}}function $f(s,r,a,c){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var A=v.child;_=_.firstContext;e:for(;_!==null;){var I=_;_=v;for(var U=0;U<r.length;U++)if(I.context===r[U]){_.lanes|=a,I=_.alternate,I!==null&&(I.lanes|=a),Gf(_.return,a,s),c||(A=null);break e}_=I.next}}else if(v.tag===18){if(A=v.return,A===null)throw Error(i(341));A.lanes|=a,_=A.alternate,_!==null&&(_.lanes|=a),Gf(A,a,s),A=null}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===s){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}}function ea(s,r,a,c){s=null;for(var v=r,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var A=v.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var I=v.type;Ln(v.pendingProps.value,A.value)||(s!==null?s.push(I):s=[I])}}else if(v===Ye.current){if(A=v.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(eu):s=[eu])}v=v.return}s!==null&&$f(r,s,a,c),r.flags|=262144}function hc(s){for(s=s.firstContext;s!==null;){if(!Ln(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ro(s){io=s,li=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function cn(s){return Gg(io,s)}function mc(s,r){return io===null&&ro(s),Gg(s,r)}function Gg(s,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},li===null){if(s===null)throw Error(i(308));li=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else li=li.next=r;return a}var bS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(a,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(a){return a()})}},AS=n.unstable_scheduleCallback,SS=n.unstable_NormalPriority,Ht={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new bS,data:new Map,refCount:0}}function Il(s){s.refCount--,s.refCount===0&&AS(SS,function(){s.controller.abort()})}var Nl=null,Jf=0,ta=0,na=null;function CS(s,r){if(Nl===null){var a=Nl=[];Jf=0,ta=Xh(),na={status:"pending",value:void 0,then:function(c){a.push(c)}}}return Jf++,r.then($g,$g),r}function $g(){if(--Jf===0&&Nl!==null){na!==null&&(na.status="fulfilled");var s=Nl;Nl=null,ta=0,na=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function wS(s,r){var a=[],c={status:"pending",value:null,reason:null,then:function(v){a.push(v)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var v=0;v<a.length;v++)(0,a[v])(r)},function(v){for(c.status="rejected",c.reason=v,v=0;v<a.length;v++)(0,a[v])(void 0)}),c}var Yg=ee.S;ee.S=function(s,r){R0=en(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&CS(s,r),Yg!==null&&Yg(s,r)};var oo=q(null);function Kf(){var s=oo.current;return s!==null?s:Tt.pooledCache}function pc(s,r){r===null?ve(oo,oo.current):ve(oo,r.pool)}function Jg(){var s=Kf();return s===null?null:{parent:Ht._currentValue,pool:s}}var sa=Error(i(460)),Qf=Error(i(474)),gc=Error(i(542)),yc={then:function(){}};function Kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Qg(s,r,a){switch(a=s[a],a===void 0?s.push(r):a!==r&&(r.then(us,us),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s;default:if(typeof r.status=="string")r.then(us,us);else{if(s=Tt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var v=r;v.status="fulfilled",v.value=c}},function(c){if(r.status==="pending"){var v=r;v.status="rejected",v.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Wg(s),s}throw lo=r,sa}}function ao(s){try{var r=s._init;return r(s._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(lo=a,sa):a}}var lo=null;function Xg(){if(lo===null)throw Error(i(459));var s=lo;return lo=null,s}function Wg(s){if(s===sa||s===gc)throw Error(i(483))}var ia=null,Rl=0;function vc(s){var r=Rl;return Rl+=1,ia===null&&(ia=[]),Qg(ia,s,r)}function Ml(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function _c(s,r){throw r.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Zg(s){function r($,z){if(s){var K=$.deletions;K===null?($.deletions=[z],$.flags|=16):K.push(z)}}function a($,z){if(!s)return null;for(;z!==null;)r($,z),z=z.sibling;return null}function c($){for(var z=new Map;$!==null;)$.key!==null?z.set($.key,$):z.set($.index,$),$=$.sibling;return z}function v($,z){return $=oi($,z),$.index=0,$.sibling=null,$}function _($,z,K){return $.index=K,s?(K=$.alternate,K!==null?(K=K.index,K<z?($.flags|=67108866,z):K):($.flags|=67108866,z)):($.flags|=1048576,z)}function A($){return s&&$.alternate===null&&($.flags|=67108866),$}function I($,z,K,ae){return z===null||z.tag!==6?(z=Of(K,$.mode,ae),z.return=$,z):(z=v(z,K),z.return=$,z)}function U($,z,K,ae){var we=K.type;return we===k?re($,z,K.props.children,ae,K.key):z!==null&&(z.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===C&&ao(we)===z.type)?(z=v(z,K.props),Ml(z,K),z.return=$,z):(z=dc(K.type,K.key,K.props,null,$.mode,ae),Ml(z,K),z.return=$,z)}function Q($,z,K,ae){return z===null||z.tag!==4||z.stateNode.containerInfo!==K.containerInfo||z.stateNode.implementation!==K.implementation?(z=jf(K,$.mode,ae),z.return=$,z):(z=v(z,K.children||[]),z.return=$,z)}function re($,z,K,ae,we){return z===null||z.tag!==7?(z=no(K,$.mode,ae,we),z.return=$,z):(z=v(z,K),z.return=$,z)}function le($,z,K){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Of(""+z,$.mode,K),z.return=$,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case w:return K=dc(z.type,z.key,z.props,null,$.mode,K),Ml(K,z),K.return=$,K;case L:return z=jf(z,$.mode,K),z.return=$,z;case C:return z=ao(z),le($,z,K)}if(it(z)||F(z))return z=no(z,$.mode,K,null),z.return=$,z;if(typeof z.then=="function")return le($,vc(z),K);if(z.$$typeof===B)return le($,mc($,z),K);_c($,z)}return null}function X($,z,K,ae){var we=z!==null?z.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return we!==null?null:I($,z,""+K,ae);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return K.key===we?U($,z,K,ae):null;case L:return K.key===we?Q($,z,K,ae):null;case C:return K=ao(K),X($,z,K,ae)}if(it(K)||F(K))return we!==null?null:re($,z,K,ae,null);if(typeof K.then=="function")return X($,z,vc(K),ae);if(K.$$typeof===B)return X($,z,mc($,K),ae);_c($,K)}return null}function te($,z,K,ae,we){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return $=$.get(K)||null,I(z,$,""+ae,we);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:return $=$.get(ae.key===null?K:ae.key)||null,U(z,$,ae,we);case L:return $=$.get(ae.key===null?K:ae.key)||null,Q(z,$,ae,we);case C:return ae=ao(ae),te($,z,K,ae,we)}if(it(ae)||F(ae))return $=$.get(K)||null,re(z,$,ae,we,null);if(typeof ae.then=="function")return te($,z,K,vc(ae),we);if(ae.$$typeof===B)return te($,z,K,mc(z,ae),we);_c(z,ae)}return null}function be($,z,K,ae){for(var we=null,rt=null,Ce=z,Ge=z=0,We=null;Ce!==null&&Ge<K.length;Ge++){Ce.index>Ge?(We=Ce,Ce=null):We=Ce.sibling;var ot=X($,Ce,K[Ge],ae);if(ot===null){Ce===null&&(Ce=We);break}s&&Ce&&ot.alternate===null&&r($,Ce),z=_(ot,z,Ge),rt===null?we=ot:rt.sibling=ot,rt=ot,Ce=We}if(Ge===K.length)return a($,Ce),nt&&ai($,Ge),we;if(Ce===null){for(;Ge<K.length;Ge++)Ce=le($,K[Ge],ae),Ce!==null&&(z=_(Ce,z,Ge),rt===null?we=Ce:rt.sibling=Ce,rt=Ce);return nt&&ai($,Ge),we}for(Ce=c(Ce);Ge<K.length;Ge++)We=te(Ce,$,Ge,K[Ge],ae),We!==null&&(s&&We.alternate!==null&&Ce.delete(We.key===null?Ge:We.key),z=_(We,z,Ge),rt===null?we=We:rt.sibling=We,rt=We);return s&&Ce.forEach(function(_r){return r($,_r)}),nt&&ai($,Ge),we}function Pe($,z,K,ae){if(K==null)throw Error(i(151));for(var we=null,rt=null,Ce=z,Ge=z=0,We=null,ot=K.next();Ce!==null&&!ot.done;Ge++,ot=K.next()){Ce.index>Ge?(We=Ce,Ce=null):We=Ce.sibling;var _r=X($,Ce,ot.value,ae);if(_r===null){Ce===null&&(Ce=We);break}s&&Ce&&_r.alternate===null&&r($,Ce),z=_(_r,z,Ge),rt===null?we=_r:rt.sibling=_r,rt=_r,Ce=We}if(ot.done)return a($,Ce),nt&&ai($,Ge),we;if(Ce===null){for(;!ot.done;Ge++,ot=K.next())ot=le($,ot.value,ae),ot!==null&&(z=_(ot,z,Ge),rt===null?we=ot:rt.sibling=ot,rt=ot);return nt&&ai($,Ge),we}for(Ce=c(Ce);!ot.done;Ge++,ot=K.next())ot=te(Ce,$,Ge,ot.value,ae),ot!==null&&(s&&ot.alternate!==null&&Ce.delete(ot.key===null?Ge:ot.key),z=_(ot,z,Ge),rt===null?we=ot:rt.sibling=ot,rt=ot);return s&&Ce.forEach(function(OC){return r($,OC)}),nt&&ai($,Ge),we}function vt($,z,K,ae){if(typeof K=="object"&&K!==null&&K.type===k&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case w:e:{for(var we=K.key;z!==null;){if(z.key===we){if(we=K.type,we===k){if(z.tag===7){a($,z.sibling),ae=v(z,K.props.children),ae.return=$,$=ae;break e}}else if(z.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===C&&ao(we)===z.type){a($,z.sibling),ae=v(z,K.props),Ml(ae,K),ae.return=$,$=ae;break e}a($,z);break}else r($,z);z=z.sibling}K.type===k?(ae=no(K.props.children,$.mode,ae,K.key),ae.return=$,$=ae):(ae=dc(K.type,K.key,K.props,null,$.mode,ae),Ml(ae,K),ae.return=$,$=ae)}return A($);case L:e:{for(we=K.key;z!==null;){if(z.key===we)if(z.tag===4&&z.stateNode.containerInfo===K.containerInfo&&z.stateNode.implementation===K.implementation){a($,z.sibling),ae=v(z,K.children||[]),ae.return=$,$=ae;break e}else{a($,z);break}else r($,z);z=z.sibling}ae=jf(K,$.mode,ae),ae.return=$,$=ae}return A($);case C:return K=ao(K),vt($,z,K,ae)}if(it(K))return be($,z,K,ae);if(F(K)){if(we=F(K),typeof we!="function")throw Error(i(150));return K=we.call(K),Pe($,z,K,ae)}if(typeof K.then=="function")return vt($,z,vc(K),ae);if(K.$$typeof===B)return vt($,z,mc($,K),ae);_c($,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,z!==null&&z.tag===6?(a($,z.sibling),ae=v(z,K),ae.return=$,$=ae):(a($,z),ae=Of(K,$.mode,ae),ae.return=$,$=ae),A($)):a($,z)}return function($,z,K,ae){try{Rl=0;var we=vt($,z,K,ae);return ia=null,we}catch(Ce){if(Ce===sa||Ce===gc)throw Ce;var rt=Un(29,Ce,null,$.mode);return rt.lanes=ae,rt.return=$,rt}finally{}}}var uo=Zg(!0),ey=Zg(!1),nr=!1;function Xf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function sr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ir(s,r,a){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(ut&2)!==0){var v=c.pending;return v===null?r.next=r:(r.next=v.next,v.next=r),c.pending=r,r=cc(s),Ug(s,null,a),r}return uc(s,c,r,a),cc(s)}function Dl(s,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,rl(s,a)}}function Zf(s,r){var a=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var v=null,_=null;if(a=a.firstBaseUpdate,a!==null){do{var A={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};_===null?v=_=A:_=_.next=A,a=a.next}while(a!==null);_===null?v=_=r:_=_.next=r}else v=_=r;a={baseState:c.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:c.shared,callbacks:c.callbacks},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=r:s.next=r,a.lastBaseUpdate=r}var eh=!1;function Pl(){if(eh){var s=na;if(s!==null)throw s}}function kl(s,r,a,c){eh=!1;var v=s.updateQueue;nr=!1;var _=v.firstBaseUpdate,A=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var U=I,Q=U.next;U.next=null,A===null?_=Q:A.next=Q,A=U;var re=s.alternate;re!==null&&(re=re.updateQueue,I=re.lastBaseUpdate,I!==A&&(I===null?re.firstBaseUpdate=Q:I.next=Q,re.lastBaseUpdate=U))}if(_!==null){var le=v.baseState;A=0,re=Q=U=null,I=_;do{var X=I.lane&-536870913,te=X!==I.lane;if(te?(Xe&X)===X:(c&X)===X){X!==0&&X===ta&&(eh=!0),re!==null&&(re=re.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var be=s,Pe=I;X=r;var vt=a;switch(Pe.tag){case 1:if(be=Pe.payload,typeof be=="function"){le=be.call(vt,le,X);break e}le=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Pe.payload,X=typeof be=="function"?be.call(vt,le,X):be,X==null)break e;le=x({},le,X);break e;case 2:nr=!0}}X=I.callback,X!==null&&(s.flags|=64,te&&(s.flags|=8192),te=v.callbacks,te===null?v.callbacks=[X]:te.push(X))}else te={lane:X,tag:I.tag,payload:I.payload,callback:I.callback,next:null},re===null?(Q=re=te,U=le):re=re.next=te,A|=X;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;te=I,I=te.next,te.next=null,v.lastBaseUpdate=te,v.shared.pending=null}}while(!0);re===null&&(U=le),v.baseState=U,v.firstBaseUpdate=Q,v.lastBaseUpdate=re,_===null&&(v.shared.lanes=0),ur|=A,s.lanes=A,s.memoizedState=le}}function ty(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function ny(s,r){var a=s.callbacks;if(a!==null)for(s.callbacks=null,s=0;s<a.length;s++)ty(a[s],r)}var ra=q(null),Tc=q(0);function sy(s,r){s=vi,ve(Tc,s),ve(ra,r),vi=s|r.baseLanes}function th(){ve(Tc,vi),ve(ra,ra.current)}function nh(){vi=Tc.current,oe(ra),oe(Tc)}var On=q(null),es=null;function rr(s){var r=s.alternate;ve(Lt,Lt.current&1),ve(On,s),es===null&&(r===null||ra.current!==null||r.memoizedState!==null)&&(es=s)}function sh(s){ve(Lt,Lt.current),ve(On,s),es===null&&(es=s)}function iy(s){s.tag===22?(ve(Lt,Lt.current),ve(On,s),es===null&&(es=s)):or()}function or(){ve(Lt,Lt.current),ve(On,On.current)}function jn(s){oe(On),es===s&&(es=null),oe(Lt)}var Lt=q(0);function xc(s){for(var r=s;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||um(a)||cm(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ci=0,He=null,gt=null,Gt=null,Ec=!1,oa=!1,co=!1,bc=0,Vl=0,aa=null,IS=0;function Mt(){throw Error(i(321))}function ih(s,r){if(r===null)return!1;for(var a=0;a<r.length&&a<s.length;a++)if(!Ln(s[a],r[a]))return!1;return!0}function rh(s,r,a,c,v,_){return ci=_,He=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ee.H=s===null||s.memoizedState===null?qy:Th,co=!1,_=a(c,v),co=!1,oa&&(_=oy(r,a,c,v)),ry(s),_}function ry(s){ee.H=Ol;var r=gt!==null&&gt.next!==null;if(ci=0,Gt=gt=He=null,Ec=!1,Vl=0,aa=null,r)throw Error(i(300));s===null||$t||(s=s.dependencies,s!==null&&hc(s)&&($t=!0))}function oy(s,r,a,c){He=s;var v=0;do{if(oa&&(aa=null),Vl=0,oa=!1,25<=v)throw Error(i(301));if(v+=1,Gt=gt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}ee.H=By,_=r(a,c)}while(oa);return _}function NS(){var s=ee.H,r=s.useState()[0];return r=typeof r.then=="function"?Ll(r):r,s=s.useState()[0],(gt!==null?gt.memoizedState:null)!==s&&(He.flags|=1024),r}function oh(){var s=bc!==0;return bc=0,s}function ah(s,r,a){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~a}function lh(s){if(Ec){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Ec=!1}ci=0,Gt=gt=He=null,oa=!1,Vl=bc=0,aa=null}function xn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?He.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function Ut(){if(gt===null){var s=He.alternate;s=s!==null?s.memoizedState:null}else s=gt.next;var r=Gt===null?He.memoizedState:Gt.next;if(r!==null)Gt=r,gt=s;else{if(s===null)throw He.alternate===null?Error(i(467)):Error(i(310));gt=s,s={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Gt===null?He.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function Ac(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ll(s){var r=Vl;return Vl+=1,aa===null&&(aa=[]),s=Qg(aa,s,r),r=He,(Gt===null?r.memoizedState:Gt.next)===null&&(r=r.alternate,ee.H=r===null||r.memoizedState===null?qy:Th),s}function Sc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ll(s);if(s.$$typeof===B)return cn(s)}throw Error(i(438,String(s)))}function uh(s){var r=null,a=He.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(v){return v.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=Ac(),He.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(s),c=0;c<s;c++)a[c]=M;return r.index++,a}function di(s,r){return typeof r=="function"?r(s):r}function Cc(s){var r=Ut();return ch(r,gt,s)}function ch(s,r,a){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var v=s.baseQueue,_=c.pending;if(_!==null){if(v!==null){var A=v.next;v.next=_.next,_.next=A}r.baseQueue=v=_,c.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{r=v.next;var I=A=null,U=null,Q=r,re=!1;do{var le=Q.lane&-536870913;if(le!==Q.lane?(Xe&le)===le:(ci&le)===le){var X=Q.revertLane;if(X===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),le===ta&&(re=!0);else if((ci&X)===X){Q=Q.next,X===ta&&(re=!0);continue}else le={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(I=U=le,A=_):U=U.next=le,He.lanes|=X,ur|=X;le=Q.action,co&&a(_,le),_=Q.hasEagerState?Q.eagerState:a(_,le)}else X={lane:le,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(I=U=X,A=_):U=U.next=X,He.lanes|=le,ur|=le;Q=Q.next}while(Q!==null&&Q!==r);if(U===null?A=_:U.next=I,!Ln(_,s.memoizedState)&&($t=!0,re&&(a=na,a!==null)))throw a;s.memoizedState=_,s.baseState=A,s.baseQueue=U,c.lastRenderedState=_}return v===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function dh(s){var r=Ut(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=s;var c=a.dispatch,v=a.pending,_=r.memoizedState;if(v!==null){a.pending=null;var A=v=v.next;do _=s(_,A.action),A=A.next;while(A!==v);Ln(_,r.memoizedState)||($t=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),a.lastRenderedState=_}return[_,c]}function ay(s,r,a){var c=He,v=Ut(),_=nt;if(_){if(a===void 0)throw Error(i(407));a=a()}else a=r();var A=!Ln((gt||v).memoizedState,a);if(A&&(v.memoizedState=a,$t=!0),v=v.queue,mh(cy.bind(null,c,v,s),[s]),v.getSnapshot!==r||A||Gt!==null&&Gt.memoizedState.tag&1){if(c.flags|=2048,la(9,{destroy:void 0},uy.bind(null,c,v,a,r),null),Tt===null)throw Error(i(349));_||(ci&127)!==0||ly(c,r,a)}return a}function ly(s,r,a){s.flags|=16384,s={getSnapshot:r,value:a},r=He.updateQueue,r===null?(r=Ac(),He.updateQueue=r,r.stores=[s]):(a=r.stores,a===null?r.stores=[s]:a.push(s))}function uy(s,r,a,c){r.value=a,r.getSnapshot=c,dy(r)&&fy(s)}function cy(s,r,a){return a(function(){dy(r)&&fy(s)})}function dy(s){var r=s.getSnapshot;s=s.value;try{var a=r();return!Ln(s,a)}catch{return!0}}function fy(s){var r=to(s,2);r!==null&&Mn(r,s,2)}function fh(s){var r=xn();if(typeof s=="function"){var a=s;if(s=a(),co){De(!0);try{a()}finally{De(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:s},r}function hy(s,r,a,c){return s.baseState=a,ch(s,gt,typeof c=="function"?c:di)}function RS(s,r,a,c,v){if(Nc(s))throw Error(i(485));if(s=r.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};ee.T!==null?a(!0):_.isTransition=!1,c(_),a=r.pending,a===null?(_.next=r.pending=_,my(r,_)):(_.next=a.next,r.pending=a.next=_)}}function my(s,r){var a=r.action,c=r.payload,v=s.state;if(r.isTransition){var _=ee.T,A={};ee.T=A;try{var I=a(v,c),U=ee.S;U!==null&&U(A,I),py(s,r,I)}catch(Q){hh(s,r,Q)}finally{_!==null&&A.types!==null&&(_.types=A.types),ee.T=_}}else try{_=a(v,c),py(s,r,_)}catch(Q){hh(s,r,Q)}}function py(s,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){gy(s,r,c)},function(c){return hh(s,r,c)}):gy(s,r,a)}function gy(s,r,a){r.status="fulfilled",r.value=a,yy(r),s.state=a,r=s.pending,r!==null&&(a=r.next,a===r?s.pending=null:(a=a.next,r.next=a,my(s,a)))}function hh(s,r,a){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=a,yy(r),r=r.next;while(r!==c)}s.action=null}function yy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function vy(s,r){return r}function _y(s,r){if(nt){var a=Tt.formState;if(a!==null){e:{var c=He;if(nt){if(Et){t:{for(var v=Et,_=Zn;v.nodeType!==8;){if(!_){v=null;break t}if(v=ts(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){Et=ts(v.nextSibling),c=v.data==="F!";break e}}er(c)}c=!1}c&&(r=a[0])}}return a=xn(),a.memoizedState=a.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vy,lastRenderedState:r},a.queue=c,a=Oy.bind(null,He,c),c.dispatch=a,c=fh(!1),_=_h.bind(null,He,!1,c.queue),c=xn(),v={state:r,dispatch:null,action:s,pending:null},c.queue=v,a=RS.bind(null,He,v,_,a),v.dispatch=a,c.memoizedState=s,[r,a,!1]}function Ty(s){var r=Ut();return xy(r,gt,s)}function xy(s,r,a){if(r=ch(s,r,vy)[0],s=Cc(di)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Ll(r)}catch(A){throw A===sa?gc:A}else c=r;r=Ut();var v=r.queue,_=v.dispatch;return a!==r.memoizedState&&(He.flags|=2048,la(9,{destroy:void 0},MS.bind(null,v,a),null)),[c,_,s]}function MS(s,r){s.action=r}function Ey(s){var r=Ut(),a=gt;if(a!==null)return xy(r,a,s);Ut(),r=r.memoizedState,a=Ut();var c=a.queue.dispatch;return a.memoizedState=s,[r,c,!1]}function la(s,r,a,c){return s={tag:s,create:a,deps:c,inst:r,next:null},r=He.updateQueue,r===null&&(r=Ac(),He.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=s.next=s:(c=a.next,a.next=s,s.next=c,r.lastEffect=s),s}function by(){return Ut().memoizedState}function wc(s,r,a,c){var v=xn();He.flags|=s,v.memoizedState=la(1|r,{destroy:void 0},a,c===void 0?null:c)}function Ic(s,r,a,c){var v=Ut();c=c===void 0?null:c;var _=v.memoizedState.inst;gt!==null&&c!==null&&ih(c,gt.memoizedState.deps)?v.memoizedState=la(r,_,a,c):(He.flags|=s,v.memoizedState=la(1|r,_,a,c))}function Ay(s,r){wc(8390656,8,s,r)}function mh(s,r){Ic(2048,8,s,r)}function DS(s){He.flags|=4;var r=He.updateQueue;if(r===null)r=Ac(),He.updateQueue=r,r.events=[s];else{var a=r.events;a===null?r.events=[s]:a.push(s)}}function Sy(s){var r=Ut().memoizedState;return DS({ref:r,nextImpl:s}),function(){if((ut&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Cy(s,r){return Ic(4,2,s,r)}function wy(s,r){return Ic(4,4,s,r)}function Iy(s,r){if(typeof r=="function"){s=s();var a=r(s);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Ny(s,r,a){a=a!=null?a.concat([s]):null,Ic(4,4,Iy.bind(null,r,s),a)}function ph(){}function Ry(s,r){var a=Ut();r=r===void 0?null:r;var c=a.memoizedState;return r!==null&&ih(r,c[1])?c[0]:(a.memoizedState=[s,r],s)}function My(s,r){var a=Ut();r=r===void 0?null:r;var c=a.memoizedState;if(r!==null&&ih(r,c[1]))return c[0];if(c=s(),co){De(!0);try{s()}finally{De(!1)}}return a.memoizedState=[c,r],c}function gh(s,r,a){return a===void 0||(ci&1073741824)!==0&&(Xe&261930)===0?s.memoizedState=r:(s.memoizedState=a,s=D0(),He.lanes|=s,ur|=s,a)}function Dy(s,r,a,c){return Ln(a,r)?a:ra.current!==null?(s=gh(s,a,c),Ln(s,r)||($t=!0),s):(ci&42)===0||(ci&1073741824)!==0&&(Xe&261930)===0?($t=!0,s.memoizedState=a):(s=D0(),He.lanes|=s,ur|=s,r)}function Py(s,r,a,c,v){var _=W.p;W.p=_!==0&&8>_?_:8;var A=ee.T,I={};ee.T=I,_h(s,!1,r,a);try{var U=v(),Q=ee.S;if(Q!==null&&Q(I,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var re=wS(U,c);Ul(s,r,re,Bn(s))}else Ul(s,r,c,Bn(s))}catch(le){Ul(s,r,{then:function(){},status:"rejected",reason:le},Bn())}finally{W.p=_,A!==null&&I.types!==null&&(A.types=I.types),ee.T=A}}function PS(){}function yh(s,r,a,c){if(s.tag!==5)throw Error(i(476));var v=ky(s).queue;Py(s,v,r,pe,a===null?PS:function(){return Vy(s),a(c)})}function ky(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:pe},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:a},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function Vy(s){var r=ky(s);r.next===null&&(r=s.alternate.memoizedState),Ul(s,r.next.queue,{},Bn())}function vh(){return cn(eu)}function Ly(){return Ut().memoizedState}function Uy(){return Ut().memoizedState}function kS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var a=Bn();s=sr(a);var c=ir(r,s,a);c!==null&&(Mn(c,r,a),Dl(c,r,a)),r={cache:Yf()},s.payload=r;return}r=r.return}}function VS(s,r,a){var c=Bn();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Nc(s)?jy(r,a):(a=Lf(s,r,a,c),a!==null&&(Mn(a,s,c),Fy(a,r,c)))}function Oy(s,r,a){var c=Bn();Ul(s,r,a,c)}function Ul(s,r,a,c){var v={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Nc(s))jy(r,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var A=r.lastRenderedState,I=_(A,a);if(v.hasEagerState=!0,v.eagerState=I,Ln(I,A))return uc(s,r,v,0),Tt===null&&lc(),!1}catch{}finally{}if(a=Lf(s,r,v,c),a!==null)return Mn(a,s,c),Fy(a,r,c),!0}return!1}function _h(s,r,a,c){if(c={lane:2,revertLane:Xh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Nc(s)){if(r)throw Error(i(479))}else r=Lf(s,a,c,2),r!==null&&Mn(r,s,2)}function Nc(s){var r=s.alternate;return s===He||r!==null&&r===He}function jy(s,r){oa=Ec=!0;var a=s.pending;a===null?r.next=r:(r.next=a.next,a.next=r),s.pending=r}function Fy(s,r,a){if((a&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,a|=c,r.lanes=a,rl(s,a)}}var Ol={readContext:cn,use:Sc,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt};Ol.useEffectEvent=Mt;var qy={readContext:cn,use:Sc,useCallback:function(s,r){return xn().memoizedState=[s,r===void 0?null:r],s},useContext:cn,useEffect:Ay,useImperativeHandle:function(s,r,a){a=a!=null?a.concat([s]):null,wc(4194308,4,Iy.bind(null,r,s),a)},useLayoutEffect:function(s,r){return wc(4194308,4,s,r)},useInsertionEffect:function(s,r){wc(4,2,s,r)},useMemo:function(s,r){var a=xn();r=r===void 0?null:r;var c=s();if(co){De(!0);try{s()}finally{De(!1)}}return a.memoizedState=[c,r],c},useReducer:function(s,r,a){var c=xn();if(a!==void 0){var v=a(r);if(co){De(!0);try{a(r)}finally{De(!1)}}}else v=r;return c.memoizedState=c.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},c.queue=s,s=s.dispatch=VS.bind(null,He,s),[c.memoizedState,s]},useRef:function(s){var r=xn();return s={current:s},r.memoizedState=s},useState:function(s){s=fh(s);var r=s.queue,a=Oy.bind(null,He,r);return r.dispatch=a,[s.memoizedState,a]},useDebugValue:ph,useDeferredValue:function(s,r){var a=xn();return gh(a,s,r)},useTransition:function(){var s=fh(!1);return s=Py.bind(null,He,s.queue,!0,!1),xn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,a){var c=He,v=xn();if(nt){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),Tt===null)throw Error(i(349));(Xe&127)!==0||ly(c,r,a)}v.memoizedState=a;var _={value:a,getSnapshot:r};return v.queue=_,Ay(cy.bind(null,c,_,s),[s]),c.flags|=2048,la(9,{destroy:void 0},uy.bind(null,c,_,a,r),null),a},useId:function(){var s=xn(),r=Tt.identifierPrefix;if(nt){var a=Fs,c=js;a=(c&~(1<<32-Fe(c)-1)).toString(32)+a,r="_"+r+"R_"+a,a=bc++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=IS++,r="_"+r+"r_"+a.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:vh,useFormState:_y,useActionState:_y,useOptimistic:function(s){var r=xn();r.memoizedState=r.baseState=s;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=_h.bind(null,He,!0,a),a.dispatch=r,[s,r]},useMemoCache:uh,useCacheRefresh:function(){return xn().memoizedState=kS.bind(null,He)},useEffectEvent:function(s){var r=xn(),a={impl:s};return r.memoizedState=a,function(){if((ut&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}},Th={readContext:cn,use:Sc,useCallback:Ry,useContext:cn,useEffect:mh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:My,useReducer:Cc,useRef:by,useState:function(){return Cc(di)},useDebugValue:ph,useDeferredValue:function(s,r){var a=Ut();return Dy(a,gt.memoizedState,s,r)},useTransition:function(){var s=Cc(di)[0],r=Ut().memoizedState;return[typeof s=="boolean"?s:Ll(s),r]},useSyncExternalStore:ay,useId:Ly,useHostTransitionStatus:vh,useFormState:Ty,useActionState:Ty,useOptimistic:function(s,r){var a=Ut();return hy(a,gt,s,r)},useMemoCache:uh,useCacheRefresh:Uy};Th.useEffectEvent=Sy;var By={readContext:cn,use:Sc,useCallback:Ry,useContext:cn,useEffect:mh,useImperativeHandle:Ny,useInsertionEffect:Cy,useLayoutEffect:wy,useMemo:My,useReducer:dh,useRef:by,useState:function(){return dh(di)},useDebugValue:ph,useDeferredValue:function(s,r){var a=Ut();return gt===null?gh(a,s,r):Dy(a,gt.memoizedState,s,r)},useTransition:function(){var s=dh(di)[0],r=Ut().memoizedState;return[typeof s=="boolean"?s:Ll(s),r]},useSyncExternalStore:ay,useId:Ly,useHostTransitionStatus:vh,useFormState:Ey,useActionState:Ey,useOptimistic:function(s,r){var a=Ut();return gt!==null?hy(a,gt,s,r):(a.baseState=s,[s,a.queue.dispatch])},useMemoCache:uh,useCacheRefresh:Uy};By.useEffectEvent=Sy;function xh(s,r,a,c){r=s.memoizedState,a=a(c,r),a=a==null?r:x({},r,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Eh={enqueueSetState:function(s,r,a){s=s._reactInternals;var c=Bn(),v=sr(c);v.payload=r,a!=null&&(v.callback=a),r=ir(s,v,c),r!==null&&(Mn(r,s,c),Dl(r,s,c))},enqueueReplaceState:function(s,r,a){s=s._reactInternals;var c=Bn(),v=sr(c);v.tag=1,v.payload=r,a!=null&&(v.callback=a),r=ir(s,v,c),r!==null&&(Mn(r,s,c),Dl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var a=Bn(),c=sr(a);c.tag=2,r!=null&&(c.callback=r),r=ir(s,c,a),r!==null&&(Mn(r,s,a),Dl(r,s,a))}};function zy(s,r,a,c,v,_,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,_,A):r.prototype&&r.prototype.isPureReactComponent?!Al(a,c)||!Al(v,_):!0}function Hy(s,r,a,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==s&&Eh.enqueueReplaceState(r,r.state,null)}function fo(s,r){var a=r;if("ref"in r){a={};for(var c in r)c!=="ref"&&(a[c]=r[c])}if(s=s.defaultProps){a===r&&(a=x({},a));for(var v in s)a[v]===void 0&&(a[v]=s[v])}return a}function Gy(s){ac(s)}function $y(s){console.error(s)}function Yy(s){ac(s)}function Rc(s,r){try{var a=s.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jy(s,r,a){try{var c=s.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function bh(s,r,a){return a=sr(a),a.tag=3,a.payload={element:null},a.callback=function(){Rc(s,r)},a}function Ky(s){return s=sr(s),s.tag=3,s}function Qy(s,r,a,c){var v=a.type.getDerivedStateFromError;if(typeof v=="function"){var _=c.value;s.payload=function(){return v(_)},s.callback=function(){Jy(r,a,c)}}var A=a.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){Jy(r,a,c),typeof v!="function"&&(cr===null?cr=new Set([this]):cr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function LS(s,r,a,c,v){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=a.alternate,r!==null&&ea(r,a,v,!0),a=On.current,a!==null){switch(a.tag){case 31:case 13:return es===null?Bc():a.alternate===null&&Dt===0&&(Dt=3),a.flags&=-257,a.flags|=65536,a.lanes=v,c===yc?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([c]):r.add(c),Jh(s,c,v)),!1;case 22:return a.flags|=65536,c===yc?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([c]):a.add(c)),Jh(s,c,v)),!1}throw Error(i(435,a.tag))}return Jh(s,c,v),Bc(),!1}if(nt)return r=On.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=v,c!==Bf&&(s=Error(i(422),{cause:c}),wl(Qn(s,a)))):(c!==Bf&&(r=Error(i(423),{cause:c}),wl(Qn(r,a))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,c=Qn(c,a),v=bh(s.stateNode,c,v),Zf(s,v),Dt!==4&&(Dt=2)),!1;var _=Error(i(520),{cause:c});if(_=Qn(_,a),$l===null?$l=[_]:$l.push(_),Dt!==4&&(Dt=2),r===null)return!0;c=Qn(c,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,s=v&-v,a.lanes|=s,s=bh(a.stateNode,c,s),Zf(a,s),!1;case 1:if(r=a.type,_=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(cr===null||!cr.has(_))))return a.flags|=65536,v&=-v,a.lanes|=v,v=Ky(v),Qy(v,s,a,c),Zf(a,v),!1}a=a.return}while(a!==null);return!1}var Ah=Error(i(461)),$t=!1;function dn(s,r,a,c){r.child=s===null?ey(r,null,a,c):uo(r,s.child,a,c)}function Xy(s,r,a,c,v){a=a.render;var _=r.ref;if("ref"in c){var A={};for(var I in c)I!=="ref"&&(A[I]=c[I])}else A=c;return ro(r),c=rh(s,r,a,A,_,v),I=oh(),s!==null&&!$t?(ah(s,r,v),fi(s,r,v)):(nt&&I&&Ff(r),r.flags|=1,dn(s,r,c,v),r.child)}function Wy(s,r,a,c,v){if(s===null){var _=a.type;return typeof _=="function"&&!Uf(_)&&_.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=_,Zy(s,r,_,c,v)):(s=dc(a.type,null,c,r,r.mode,v),s.ref=r.ref,s.return=r,r.child=s)}if(_=s.child,!Dh(s,v)){var A=_.memoizedProps;if(a=a.compare,a=a!==null?a:Al,a(A,c)&&s.ref===r.ref)return fi(s,r,v)}return r.flags|=1,s=oi(_,c),s.ref=r.ref,s.return=r,r.child=s}function Zy(s,r,a,c,v){if(s!==null){var _=s.memoizedProps;if(Al(_,c)&&s.ref===r.ref)if($t=!1,r.pendingProps=c=_,Dh(s,v))(s.flags&131072)!==0&&($t=!0);else return r.lanes=s.lanes,fi(s,r,v)}return Sh(s,r,a,c,v)}function e0(s,r,a,c){var v=c.children,_=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(_=_!==null?_.baseLanes|a:a,s!==null){for(c=r.child=s.child,v=0;c!==null;)v=v|c.lanes|c.childLanes,c=c.sibling;c=v&~_}else c=0,r.child=null;return t0(s,r,_,a,c)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&pc(r,_!==null?_.cachePool:null),_!==null?sy(r,_):th(),iy(r);else return c=r.lanes=536870912,t0(s,r,_!==null?_.baseLanes|a:a,a,c)}else _!==null?(pc(r,_.cachePool),sy(r,_),or(),r.memoizedState=null):(s!==null&&pc(r,null),th(),or());return dn(s,r,v,a),r.child}function jl(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function t0(s,r,a,c,v){var _=Kf();return _=_===null?null:{parent:Ht._currentValue,pool:_},r.memoizedState={baseLanes:a,cachePool:_},s!==null&&pc(r,null),th(),iy(r),s!==null&&ea(s,r,c,!0),r.childLanes=v,null}function Mc(s,r){return r=Pc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function n0(s,r,a){return uo(r,s.child,null,a),s=Mc(r,r.pendingProps),s.flags|=2,jn(r),r.memoizedState=null,s}function US(s,r,a){var c=r.pendingProps,v=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(nt){if(c.mode==="hidden")return s=Mc(r,c),r.lanes=536870912,jl(null,s);if(sh(r),(s=Et)?(s=mv(s,Zn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Wi!==null?{id:js,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},a=jg(s),a.return=r,r.child=a,un=r,Et=null)):s=null,s===null)throw er(r);return r.lanes=536870912,null}return Mc(r,c)}var _=s.memoizedState;if(_!==null){var A=_.dehydrated;if(sh(r),v)if(r.flags&256)r.flags&=-257,r=n0(s,r,a);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if($t||ea(s,r,a,!1),v=(a&s.childLanes)!==0,$t||v){if(c=Tt,c!==null&&(A=ol(c,a),A!==0&&A!==_.retryLane))throw _.retryLane=A,to(s,A),Mn(c,s,A),Ah;Bc(),r=n0(s,r,a)}else s=_.treeContext,Et=ts(A.nextSibling),un=r,nt=!0,Zi=null,Zn=!1,s!==null&&Bg(r,s),r=Mc(r,c),r.flags|=4096;return r}return s=oi(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Dc(s,r){var a=r.ref;if(a===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(s===null||s.ref!==a)&&(r.flags|=4194816)}}function Sh(s,r,a,c,v){return ro(r),a=rh(s,r,a,c,void 0,v),c=oh(),s!==null&&!$t?(ah(s,r,v),fi(s,r,v)):(nt&&c&&Ff(r),r.flags|=1,dn(s,r,a,v),r.child)}function s0(s,r,a,c,v,_){return ro(r),r.updateQueue=null,a=oy(r,c,a,v),ry(s),c=oh(),s!==null&&!$t?(ah(s,r,_),fi(s,r,_)):(nt&&c&&Ff(r),r.flags|=1,dn(s,r,a,_),r.child)}function i0(s,r,a,c,v){if(ro(r),r.stateNode===null){var _=Qo,A=a.contextType;typeof A=="object"&&A!==null&&(_=cn(A)),_=new a(c,_),r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Eh,r.stateNode=_,_._reactInternals=r,_=r.stateNode,_.props=c,_.state=r.memoizedState,_.refs={},Xf(r),A=a.contextType,_.context=typeof A=="object"&&A!==null?cn(A):Qo,_.state=r.memoizedState,A=a.getDerivedStateFromProps,typeof A=="function"&&(xh(r,a,A,c),_.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&Eh.enqueueReplaceState(_,_.state,null),kl(r,c,_,v),Pl(),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){_=r.stateNode;var I=r.memoizedProps,U=fo(a,I);_.props=U;var Q=_.context,re=a.contextType;A=Qo,typeof re=="object"&&re!==null&&(A=cn(re));var le=a.getDerivedStateFromProps;re=typeof le=="function"||typeof _.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,re||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I||Q!==A)&&Hy(r,_,c,A),nr=!1;var X=r.memoizedState;_.state=X,kl(r,c,_,v),Pl(),Q=r.memoizedState,I||X!==Q||nr?(typeof le=="function"&&(xh(r,a,le,c),Q=r.memoizedState),(U=nr||zy(r,a,U,c,X,Q,A))?(re||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(r.flags|=4194308)):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=Q),_.props=c,_.state=Q,_.context=A,c=U):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{_=r.stateNode,Wf(s,r),A=r.memoizedProps,re=fo(a,A),_.props=re,le=r.pendingProps,X=_.context,Q=a.contextType,U=Qo,typeof Q=="object"&&Q!==null&&(U=cn(Q)),I=a.getDerivedStateFromProps,(Q=typeof I=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==le||X!==U)&&Hy(r,_,c,U),nr=!1,X=r.memoizedState,_.state=X,kl(r,c,_,v),Pl();var te=r.memoizedState;A!==le||X!==te||nr||s!==null&&s.dependencies!==null&&hc(s.dependencies)?(typeof I=="function"&&(xh(r,a,I,c),te=r.memoizedState),(re=nr||zy(r,a,re,c,X,te,U)||s!==null&&s.dependencies!==null&&hc(s.dependencies))?(Q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(c,te,U),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(c,te,U)),typeof _.componentDidUpdate=="function"&&(r.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),_.props=c,_.state=te,_.context=U,c=re):(typeof _.componentDidUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),c=!1)}return _=c,Dc(s,r),c=(r.flags&128)!==0,_||c?(_=r.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:_.render(),r.flags|=1,s!==null&&c?(r.child=uo(r,s.child,null,v),r.child=uo(r,null,a,v)):dn(s,r,a,v),r.memoizedState=_.state,s=r.child):s=fi(s,r,v),s}function r0(s,r,a,c){return so(),r.flags|=256,dn(s,r,a,c),r.child}var Ch={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wh(s){return{baseLanes:s,cachePool:Jg()}}function Ih(s,r,a){return s=s!==null?s.childLanes&~a:0,r&&(s|=qn),s}function o0(s,r,a){var c=r.pendingProps,v=!1,_=(r.flags&128)!==0,A;if((A=_)||(A=s!==null&&s.memoizedState===null?!1:(Lt.current&2)!==0),A&&(v=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,s===null){if(nt){if(v?rr(r):or(),(s=Et)?(s=mv(s,Zn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Wi!==null?{id:js,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},a=jg(s),a.return=r,r.child=a,un=r,Et=null)):s=null,s===null)throw er(r);return cm(s)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,v?(or(),v=r.mode,I=Pc({mode:"hidden",children:I},v),c=no(c,v,a,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=wh(a),c.childLanes=Ih(s,A,a),r.memoizedState=Ch,jl(null,c)):(rr(r),Nh(r,I))}var U=s.memoizedState;if(U!==null&&(I=U.dehydrated,I!==null)){if(_)r.flags&256?(rr(r),r.flags&=-257,r=Rh(s,r,a)):r.memoizedState!==null?(or(),r.child=s.child,r.flags|=128,r=null):(or(),I=c.fallback,v=r.mode,c=Pc({mode:"visible",children:c.children},v),I=no(I,v,a,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,uo(r,s.child,null,a),c=r.child,c.memoizedState=wh(a),c.childLanes=Ih(s,A,a),r.memoizedState=Ch,r=jl(null,c));else if(rr(r),cm(I)){if(A=I.nextSibling&&I.nextSibling.dataset,A)var Q=A.dgst;A=Q,c=Error(i(419)),c.stack="",c.digest=A,wl({value:c,source:null,stack:null}),r=Rh(s,r,a)}else if($t||ea(s,r,a,!1),A=(a&s.childLanes)!==0,$t||A){if(A=Tt,A!==null&&(c=ol(A,a),c!==0&&c!==U.retryLane))throw U.retryLane=c,to(s,c),Mn(A,s,c),Ah;um(I)||Bc(),r=Rh(s,r,a)}else um(I)?(r.flags|=192,r.child=s.child,r=null):(s=U.treeContext,Et=ts(I.nextSibling),un=r,nt=!0,Zi=null,Zn=!1,s!==null&&Bg(r,s),r=Nh(r,c.children),r.flags|=4096);return r}return v?(or(),I=c.fallback,v=r.mode,U=s.child,Q=U.sibling,c=oi(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,Q!==null?I=oi(Q,I):(I=no(I,v,a,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,jl(null,c),c=r.child,I=s.child.memoizedState,I===null?I=wh(a):(v=I.cachePool,v!==null?(U=Ht._currentValue,v=v.parent!==U?{parent:U,pool:U}:v):v=Jg(),I={baseLanes:I.baseLanes|a,cachePool:v}),c.memoizedState=I,c.childLanes=Ih(s,A,a),r.memoizedState=Ch,jl(s.child,c)):(rr(r),a=s.child,s=a.sibling,a=oi(a,{mode:"visible",children:c.children}),a.return=r,a.sibling=null,s!==null&&(A=r.deletions,A===null?(r.deletions=[s],r.flags|=16):A.push(s)),r.child=a,r.memoizedState=null,a)}function Nh(s,r){return r=Pc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Pc(s,r){return s=Un(22,s,null,r),s.lanes=0,s}function Rh(s,r,a){return uo(r,s.child,null,a),s=Nh(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function a0(s,r,a){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Gf(s.return,r,a)}function Mh(s,r,a,c,v,_){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:v,treeForkCount:_}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=c,A.tail=a,A.tailMode=v,A.treeForkCount=_)}function l0(s,r,a){var c=r.pendingProps,v=c.revealOrder,_=c.tail;c=c.children;var A=Lt.current,I=(A&2)!==0;if(I?(A=A&1|2,r.flags|=128):A&=1,ve(Lt,A),dn(s,r,c,a),c=nt?Cl:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&a0(s,a,r);else if(s.tag===19)a0(s,a,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(a=r.child,v=null;a!==null;)s=a.alternate,s!==null&&xc(s)===null&&(v=a),a=a.sibling;a=v,a===null?(v=r.child,r.child=null):(v=a.sibling,a.sibling=null),Mh(r,!1,v,a,_,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,v=r.child,r.child=null;v!==null;){if(s=v.alternate,s!==null&&xc(s)===null){r.child=v;break}s=v.sibling,v.sibling=a,a=v,v=s}Mh(r,!0,a,null,_,c);break;case"together":Mh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function fi(s,r,a){if(s!==null&&(r.dependencies=s.dependencies),ur|=r.lanes,(a&r.childLanes)===0)if(s!==null){if(ea(s,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,a=oi(s,s.pendingProps),r.child=a,a.return=r;s.sibling!==null;)s=s.sibling,a=a.sibling=oi(s,s.pendingProps),a.return=r;a.sibling=null}return r.child}function Dh(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&hc(s)))}function OS(s,r,a){switch(r.tag){case 3:fe(r,r.stateNode.containerInfo),tr(r,Ht,s.memoizedState.cache),so();break;case 27:case 5:$e(r);break;case 4:fe(r,r.stateNode.containerInfo);break;case 10:tr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,sh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(rr(r),r.flags|=128,null):(a&r.child.childLanes)!==0?o0(s,r,a):(rr(r),s=fi(s,r,a),s!==null?s.sibling:null);rr(r);break;case 19:var v=(s.flags&128)!==0;if(c=(a&r.childLanes)!==0,c||(ea(s,r,a,!1),c=(a&r.childLanes)!==0),v){if(c)return l0(s,r,a);r.flags|=128}if(v=r.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),ve(Lt,Lt.current),c)break;return null;case 22:return r.lanes=0,e0(s,r,a,r.pendingProps);case 24:tr(r,Ht,s.memoizedState.cache)}return fi(s,r,a)}function u0(s,r,a){if(s!==null)if(s.memoizedProps!==r.pendingProps)$t=!0;else{if(!Dh(s,a)&&(r.flags&128)===0)return $t=!1,OS(s,r,a);$t=(s.flags&131072)!==0}else $t=!1,nt&&(r.flags&1048576)!==0&&qg(r,Cl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=ao(r.elementType),r.type=s,typeof s=="function")Uf(s)?(c=fo(s,c),r.tag=1,r=i0(null,r,s,c,a)):(r.tag=0,r=Sh(null,r,s,c,a));else{if(s!=null){var v=s.$$typeof;if(v===ne){r.tag=11,r=Xy(null,r,s,c,a);break e}else if(v===N){r.tag=14,r=Wy(null,r,s,c,a);break e}}throw r=Ue(s)||s,Error(i(306,r,""))}}return r;case 0:return Sh(s,r,r.type,r.pendingProps,a);case 1:return c=r.type,v=fo(c,r.pendingProps),i0(s,r,c,v,a);case 3:e:{if(fe(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var _=r.memoizedState;v=_.element,Wf(s,r),kl(r,c,null,a);var A=r.memoizedState;if(c=A.cache,tr(r,Ht,c),c!==_.cache&&$f(r,[Ht],a,!0),Pl(),c=A.element,_.isDehydrated)if(_={element:c,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){r=r0(s,r,c,a);break e}else if(c!==v){v=Qn(Error(i(424)),r),wl(v),r=r0(s,r,c,a);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Et=ts(s.firstChild),un=r,nt=!0,Zi=null,Zn=!0,a=ey(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(so(),c===v){r=fi(s,r,a);break e}dn(s,r,c,a)}r=r.child}return r;case 26:return Dc(s,r),s===null?(a=Tv(r.type,null,r.pendingProps,null))?r.memoizedState=a:nt||(a=r.type,s=r.pendingProps,c=Kc(Oe.current).createElement(a),c[qt]=r,c[tn]=s,fn(c,a,s),Bt(c),r.stateNode=c):r.memoizedState=Tv(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return $e(r),s===null&&nt&&(c=r.stateNode=yv(r.type,r.pendingProps,Oe.current),un=r,Zn=!0,v=Et,mr(r.type)?(dm=v,Et=ts(c.firstChild)):Et=v),dn(s,r,r.pendingProps.children,a),Dc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&nt&&((v=c=Et)&&(c=mC(c,r.type,r.pendingProps,Zn),c!==null?(r.stateNode=c,un=r,Et=ts(c.firstChild),Zn=!1,v=!0):v=!1),v||er(r)),$e(r),v=r.type,_=r.pendingProps,A=s!==null?s.memoizedProps:null,c=_.children,om(v,_)?c=null:A!==null&&om(v,A)&&(r.flags|=32),r.memoizedState!==null&&(v=rh(s,r,NS,null,null,a),eu._currentValue=v),Dc(s,r),dn(s,r,c,a),r.child;case 6:return s===null&&nt&&((s=a=Et)&&(a=pC(a,r.pendingProps,Zn),a!==null?(r.stateNode=a,un=r,Et=null,s=!0):s=!1),s||er(r)),null;case 13:return o0(s,r,a);case 4:return fe(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=uo(r,null,c,a):dn(s,r,c,a),r.child;case 11:return Xy(s,r,r.type,r.pendingProps,a);case 7:return dn(s,r,r.pendingProps,a),r.child;case 8:return dn(s,r,r.pendingProps.children,a),r.child;case 12:return dn(s,r,r.pendingProps.children,a),r.child;case 10:return c=r.pendingProps,tr(r,r.type,c.value),dn(s,r,c.children,a),r.child;case 9:return v=r.type._context,c=r.pendingProps.children,ro(r),v=cn(v),c=c(v),r.flags|=1,dn(s,r,c,a),r.child;case 14:return Wy(s,r,r.type,r.pendingProps,a);case 15:return Zy(s,r,r.type,r.pendingProps,a);case 19:return l0(s,r,a);case 31:return US(s,r,a);case 22:return e0(s,r,a,r.pendingProps);case 24:return ro(r),c=cn(Ht),s===null?(v=Kf(),v===null&&(v=Tt,_=Yf(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=a),v=_),r.memoizedState={parent:c,cache:v},Xf(r),tr(r,Ht,v)):((s.lanes&a)!==0&&(Wf(s,r),kl(r,null,null,a),Pl()),v=s.memoizedState,_=r.memoizedState,v.parent!==c?(v={parent:c,cache:c},r.memoizedState=v,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=v),tr(r,Ht,c)):(c=_.cache,tr(r,Ht,c),c!==v.cache&&$f(r,[Ht],a,!0))),dn(s,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function hi(s){s.flags|=4}function Ph(s,r,a,c,v){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(L0())s.flags|=8192;else throw lo=yc,Qf}else s.flags&=-16777217}function c0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Sv(r))if(L0())s.flags|=8192;else throw lo=yc,Qf}function kc(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Ss():536870912,s.lanes|=r,fa|=r)}function Fl(s,r){if(!nt)switch(s.tailMode){case"hidden":r=s.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function bt(s){var r=s.alternate!==null&&s.alternate.child===s.child,a=0,c=0;if(r)for(var v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags&65011712,c|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)a|=v.lanes|v.childLanes,c|=v.subtreeFlags,c|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=c,s.childLanes=a,r}function jS(s,r,a){var c=r.pendingProps;switch(qf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(r),null;case 1:return bt(r),null;case 3:return a=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ui(Ht),ge(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(s===null||s.child===null)&&(Zo(r)?hi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,zf())),bt(r),null;case 26:var v=r.type,_=r.memoizedState;return s===null?(hi(r),_!==null?(bt(r),c0(r,_)):(bt(r),Ph(r,v,null,c,a))):_?_!==s.memoizedState?(hi(r),bt(r),c0(r,_)):(bt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&hi(r),bt(r),Ph(r,v,s,c,a)),null;case 27:if(Pt(r),a=Oe.current,v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return bt(r),null}s=_e.current,Zo(r)?zg(r):(s=yv(v,c,a),r.stateNode=s,hi(r))}return bt(r),null;case 5:if(Pt(r),v=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return bt(r),null}if(_=_e.current,Zo(r))zg(r);else{var A=Kc(Oe.current);switch(_){case 1:_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=A.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=A.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=A.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof c.is=="string"?A.createElement("select",{is:c.is}):A.createElement("select"),c.multiple?_.multiple=!0:c.size&&(_.size=c.size);break;default:_=typeof c.is=="string"?A.createElement(v,{is:c.is}):A.createElement(v)}}_[qt]=r,_[tn]=c;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=_;e:switch(fn(_,v,c),v){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&hi(r)}}return bt(r),Ph(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,a),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=Oe.current,Zo(r)){if(s=r.stateNode,a=r.memoizedProps,c=null,v=un,v!==null)switch(v.tag){case 27:case 5:c=v.memoizedProps}s[qt]=r,s=!!(s.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||ov(s.nodeValue,a)),s||er(r,!0)}else s=Kc(s).createTextNode(c),s[qt]=r,r.stateNode=s}return bt(r),null;case 31:if(a=r.memoizedState,s===null||s.memoizedState!==null){if(c=Zo(r),a!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[qt]=r}else so(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;bt(r),s=!1}else a=zf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=a),s=!0;if(!s)return r.flags&256?(jn(r),r):(jn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return bt(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Zo(r),c!==null&&c.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[qt]=r}else so(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;bt(r),v=!1}else v=zf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return r.flags&256?(jn(r),r):(jn(r),null)}return jn(r),(r.flags&128)!==0?(r.lanes=a,r):(a=c!==null,s=s!==null&&s.memoizedState!==null,a&&(c=r.child,v=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(v=c.alternate.memoizedState.cachePool.pool),_=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(_=c.memoizedState.cachePool.pool),_!==v&&(c.flags|=2048)),a!==s&&a&&(r.child.flags|=8192),kc(r,r.updateQueue),bt(r),null);case 4:return ge(),s===null&&tm(r.stateNode.containerInfo),bt(r),null;case 10:return ui(r.type),bt(r),null;case 19:if(oe(Lt),c=r.memoizedState,c===null)return bt(r),null;if(v=(r.flags&128)!==0,_=c.rendering,_===null)if(v)Fl(c,!1);else{if(Dt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(_=xc(s),_!==null){for(r.flags|=128,Fl(c,!1),s=_.updateQueue,r.updateQueue=s,kc(r,s),r.subtreeFlags=0,s=a,a=r.child;a!==null;)Og(a,s),a=a.sibling;return ve(Lt,Lt.current&1|2),nt&&ai(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&en()>jc&&(r.flags|=128,v=!0,Fl(c,!1),r.lanes=4194304)}else{if(!v)if(s=xc(_),s!==null){if(r.flags|=128,v=!0,s=s.updateQueue,r.updateQueue=s,kc(r,s),Fl(c,!0),c.tail===null&&c.tailMode==="hidden"&&!_.alternate&&!nt)return bt(r),null}else 2*en()-c.renderingStartTime>jc&&a!==536870912&&(r.flags|=128,v=!0,Fl(c,!1),r.lanes=4194304);c.isBackwards?(_.sibling=r.child,r.child=_):(s=c.last,s!==null?s.sibling=_:r.child=_,c.last=_)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=en(),s.sibling=null,a=Lt.current,ve(Lt,v?a&1|2:a&1),nt&&ai(r,c.treeForkCount),s):(bt(r),null);case 22:case 23:return jn(r),nh(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(a&536870912)!==0&&(r.flags&128)===0&&(bt(r),r.subtreeFlags&6&&(r.flags|=8192)):bt(r),a=r.updateQueue,a!==null&&kc(r,a.retryQueue),a=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==a&&(r.flags|=2048),s!==null&&oe(oo),null;case 24:return a=null,s!==null&&(a=s.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),ui(Ht),bt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function FS(s,r){switch(qf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ui(Ht),ge(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Pt(r),null;case 31:if(r.memoizedState!==null){if(jn(r),r.alternate===null)throw Error(i(340));so()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(jn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));so()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return oe(Lt),null;case 4:return ge(),null;case 10:return ui(r.type),null;case 22:case 23:return jn(r),nh(),s!==null&&oe(oo),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ui(Ht),null;case 25:return null;default:return null}}function d0(s,r){switch(qf(r),r.tag){case 3:ui(Ht),ge();break;case 26:case 27:case 5:Pt(r);break;case 4:ge();break;case 31:r.memoizedState!==null&&jn(r);break;case 13:jn(r);break;case 19:oe(Lt);break;case 10:ui(r.type);break;case 22:case 23:jn(r),nh(),s!==null&&oe(oo);break;case 24:ui(Ht)}}function ql(s,r){try{var a=r.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var v=c.next;a=v;do{if((a.tag&s)===s){c=void 0;var _=a.create,A=a.inst;c=_(),A.destroy=c}a=a.next}while(a!==v)}}catch(I){ht(r,r.return,I)}}function ar(s,r,a){try{var c=r.updateQueue,v=c!==null?c.lastEffect:null;if(v!==null){var _=v.next;c=_;do{if((c.tag&s)===s){var A=c.inst,I=A.destroy;if(I!==void 0){A.destroy=void 0,v=r;var U=a,Q=I;try{Q()}catch(re){ht(v,U,re)}}}c=c.next}while(c!==_)}}catch(re){ht(r,r.return,re)}}function f0(s){var r=s.updateQueue;if(r!==null){var a=s.stateNode;try{ny(r,a)}catch(c){ht(s,s.return,c)}}}function h0(s,r,a){a.props=fo(s.type,s.memoizedProps),a.state=s.memoizedState;try{a.componentWillUnmount()}catch(c){ht(s,r,c)}}function Bl(s,r){try{var a=s.ref;if(a!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof a=="function"?s.refCleanup=a(c):a.current=c}}catch(v){ht(s,r,v)}}function qs(s,r){var a=s.ref,c=s.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(v){ht(s,r,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(v){ht(s,r,v)}else a.current=null}function m0(s){var r=s.type,a=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(v){ht(s,s.return,v)}}function kh(s,r,a){try{var c=s.stateNode;lC(c,s.type,a,r),c[tn]=r}catch(v){ht(s,s.return,v)}}function p0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&mr(s.type)||s.tag===4}function Vh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||p0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&mr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lh(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(s,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(s),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=us));else if(c!==4&&(c===27&&mr(s.type)&&(a=s.stateNode,r=null),s=s.child,s!==null))for(Lh(s,r,a),s=s.sibling;s!==null;)Lh(s,r,a),s=s.sibling}function Vc(s,r,a){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?a.insertBefore(s,r):a.appendChild(s);else if(c!==4&&(c===27&&mr(s.type)&&(a=s.stateNode),s=s.child,s!==null))for(Vc(s,r,a),s=s.sibling;s!==null;)Vc(s,r,a),s=s.sibling}function g0(s){var r=s.stateNode,a=s.memoizedProps;try{for(var c=s.type,v=r.attributes;v.length;)r.removeAttributeNode(v[0]);fn(r,c,a),r[qt]=s,r[tn]=a}catch(_){ht(s,s.return,_)}}var mi=!1,Yt=!1,Uh=!1,y0=typeof WeakSet=="function"?WeakSet:Set,sn=null;function qS(s,r){if(s=s.containerInfo,im=nd,s=Ng(s),Rf(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var v=c.anchorOffset,_=c.focusNode;c=c.focusOffset;try{a.nodeType,_.nodeType}catch{a=null;break e}var A=0,I=-1,U=-1,Q=0,re=0,le=s,X=null;t:for(;;){for(var te;le!==a||v!==0&&le.nodeType!==3||(I=A+v),le!==_||c!==0&&le.nodeType!==3||(U=A+c),le.nodeType===3&&(A+=le.nodeValue.length),(te=le.firstChild)!==null;)X=le,le=te;for(;;){if(le===s)break t;if(X===a&&++Q===v&&(I=A),X===_&&++re===c&&(U=A),(te=le.nextSibling)!==null)break;le=X,X=le.parentNode}le=te}a=I===-1||U===-1?null:{start:I,end:U}}else a=null}a=a||{start:0,end:0}}else a=null;for(rm={focusedElem:s,selectionRange:a},nd=!1,sn=r;sn!==null;)if(r=sn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,sn=s;else for(;sn!==null;){switch(r=sn,_=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(a=0;a<s.length;a++)v=s[a],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,a=r,v=_.memoizedProps,_=_.memoizedState,c=a.stateNode;try{var be=fo(a.type,v);s=c.getSnapshotBeforeUpdate(be,_),c.__reactInternalSnapshotBeforeUpdate=s}catch(Pe){ht(a,a.return,Pe)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,a=s.nodeType,a===9)lm(s);else if(a===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,sn=s;break}sn=r.return}}function v0(s,r,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:gi(s,a),c&4&&ql(5,a);break;case 1:if(gi(s,a),c&4)if(s=a.stateNode,r===null)try{s.componentDidMount()}catch(A){ht(a,a.return,A)}else{var v=fo(a.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(v,r,s.__reactInternalSnapshotBeforeUpdate)}catch(A){ht(a,a.return,A)}}c&64&&f0(a),c&512&&Bl(a,a.return);break;case 3:if(gi(s,a),c&64&&(s=a.updateQueue,s!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{ny(s,r)}catch(A){ht(a,a.return,A)}}break;case 27:r===null&&c&4&&g0(a);case 26:case 5:gi(s,a),r===null&&c&4&&m0(a),c&512&&Bl(a,a.return);break;case 12:gi(s,a);break;case 31:gi(s,a),c&4&&x0(s,a);break;case 13:gi(s,a),c&4&&E0(s,a),c&64&&(s=a.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(a=QS.bind(null,a),gC(s,a))));break;case 22:if(c=a.memoizedState!==null||mi,!c){r=r!==null&&r.memoizedState!==null||Yt,v=mi;var _=Yt;mi=c,(Yt=r)&&!_?yi(s,a,(a.subtreeFlags&8772)!==0):gi(s,a),mi=v,Yt=_}break;case 30:break;default:gi(s,a)}}function _0(s){var r=s.alternate;r!==null&&(s.alternate=null,_0(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Lo(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wt=null,wn=!1;function pi(s,r,a){for(a=a.child;a!==null;)T0(s,r,a),a=a.sibling}function T0(s,r,a){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(he,a)}catch{}switch(a.tag){case 26:Yt||qs(a,r),pi(s,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Yt||qs(a,r);var c=wt,v=wn;mr(a.type)&&(wt=a.stateNode,wn=!1),pi(s,r,a),Xl(a.stateNode),wt=c,wn=v;break;case 5:Yt||qs(a,r);case 6:if(c=wt,v=wn,wt=null,pi(s,r,a),wt=c,wn=v,wt!==null)if(wn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(a.stateNode)}catch(_){ht(a,r,_)}else try{wt.removeChild(a.stateNode)}catch(_){ht(a,r,_)}break;case 18:wt!==null&&(wn?(s=wt,fv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.stateNode),Ta(s)):fv(wt,a.stateNode));break;case 4:c=wt,v=wn,wt=a.stateNode.containerInfo,wn=!0,pi(s,r,a),wt=c,wn=v;break;case 0:case 11:case 14:case 15:ar(2,a,r),Yt||ar(4,a,r),pi(s,r,a);break;case 1:Yt||(qs(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"&&h0(a,r,c)),pi(s,r,a);break;case 21:pi(s,r,a);break;case 22:Yt=(c=Yt)||a.memoizedState!==null,pi(s,r,a),Yt=c;break;default:pi(s,r,a)}}function x0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ta(s)}catch(a){ht(r,r.return,a)}}}function E0(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ta(s)}catch(a){ht(r,r.return,a)}}function BS(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new y0),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new y0),r;default:throw Error(i(435,s.tag))}}function Lc(s,r){var a=BS(s);r.forEach(function(c){if(!a.has(c)){a.add(c);var v=XS.bind(null,s,c);c.then(v,v)}})}function In(s,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var v=a[c],_=s,A=r,I=A;e:for(;I!==null;){switch(I.tag){case 27:if(mr(I.type)){wt=I.stateNode,wn=!1;break e}break;case 5:wt=I.stateNode,wn=!1;break e;case 3:case 4:wt=I.stateNode.containerInfo,wn=!0;break e}I=I.return}if(wt===null)throw Error(i(160));T0(_,A,v),wt=null,wn=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)b0(r,s),r=r.sibling}var ps=null;function b0(s,r){var a=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:In(r,s),Nn(s),c&4&&(ar(3,s,s.return),ql(3,s),ar(5,s,s.return));break;case 1:In(r,s),Nn(s),c&512&&(Yt||a===null||qs(a,a.return)),c&64&&mi&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(a=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var v=ps;if(In(r,s),Nn(s),c&512&&(Yt||a===null||qs(a,a.return)),c&4){var _=a!==null?a.memoizedState:null;if(c=s.memoizedState,a===null)if(c===null)if(s.stateNode===null){e:{c=s.type,a=s.memoizedProps,v=v.ownerDocument||v;t:switch(c){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ws]||_[qt]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(c),v.head.insertBefore(_,v.querySelector("head > title"))),fn(_,c,a),_[qt]=s,Bt(_),c=_;break e;case"link":var A=bv("link","href",v).get(c+(a.href||""));if(A){for(var I=0;I<A.length;I++)if(_=A[I],_.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&_.getAttribute("rel")===(a.rel==null?null:a.rel)&&_.getAttribute("title")===(a.title==null?null:a.title)&&_.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){A.splice(I,1);break t}}_=v.createElement(c),fn(_,c,a),v.head.appendChild(_);break;case"meta":if(A=bv("meta","content",v).get(c+(a.content||""))){for(I=0;I<A.length;I++)if(_=A[I],_.getAttribute("content")===(a.content==null?null:""+a.content)&&_.getAttribute("name")===(a.name==null?null:a.name)&&_.getAttribute("property")===(a.property==null?null:a.property)&&_.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&_.getAttribute("charset")===(a.charSet==null?null:a.charSet)){A.splice(I,1);break t}}_=v.createElement(c),fn(_,c,a),v.head.appendChild(_);break;default:throw Error(i(468,c))}_[qt]=s,Bt(_),c=_}s.stateNode=c}else Av(v,s.type,s.stateNode);else s.stateNode=Ev(v,c,s.memoizedProps);else _!==c?(_===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):_.count--,c===null?Av(v,s.type,s.stateNode):Ev(v,c,s.memoizedProps)):c===null&&s.stateNode!==null&&kh(s,s.memoizedProps,a.memoizedProps)}break;case 27:In(r,s),Nn(s),c&512&&(Yt||a===null||qs(a,a.return)),a!==null&&c&4&&kh(s,s.memoizedProps,a.memoizedProps);break;case 5:if(In(r,s),Nn(s),c&512&&(Yt||a===null||qs(a,a.return)),s.flags&32){v=s.stateNode;try{Cn(v,"")}catch(be){ht(s,s.return,be)}}c&4&&s.stateNode!=null&&(v=s.memoizedProps,kh(s,v,a!==null?a.memoizedProps:v)),c&1024&&(Uh=!0);break;case 6:if(In(r,s),Nn(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,a=s.stateNode;try{a.nodeValue=c}catch(be){ht(s,s.return,be)}}break;case 3:if(Wc=null,v=ps,ps=Qc(r.containerInfo),In(r,s),ps=v,Nn(s),c&4&&a!==null&&a.memoizedState.isDehydrated)try{Ta(r.containerInfo)}catch(be){ht(s,s.return,be)}Uh&&(Uh=!1,A0(s));break;case 4:c=ps,ps=Qc(s.stateNode.containerInfo),In(r,s),Nn(s),ps=c;break;case 12:In(r,s),Nn(s);break;case 31:In(r,s),Nn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Lc(s,c)));break;case 13:In(r,s),Nn(s),s.child.flags&8192&&s.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Oc=en()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Lc(s,c)));break;case 22:v=s.memoizedState!==null;var U=a!==null&&a.memoizedState!==null,Q=mi,re=Yt;if(mi=Q||v,Yt=re||U,In(r,s),Yt=re,mi=Q,Nn(s),c&8192)e:for(r=s.stateNode,r._visibility=v?r._visibility&-2:r._visibility|1,v&&(a===null||U||mi||Yt||ho(s)),a=null,r=s;;){if(r.tag===5||r.tag===26){if(a===null){U=a=r;try{if(_=U.stateNode,v)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{I=U.stateNode;var le=U.memoizedProps.style,X=le!=null&&le.hasOwnProperty("display")?le.display:null;I.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(be){ht(U,U.return,be)}}}else if(r.tag===6){if(a===null){U=r;try{U.stateNode.nodeValue=v?"":U.memoizedProps}catch(be){ht(U,U.return,be)}}}else if(r.tag===18){if(a===null){U=r;try{var te=U.stateNode;v?hv(te,!0):hv(U.stateNode,!1)}catch(be){ht(U,U.return,be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,Lc(s,a))));break;case 19:In(r,s),Nn(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Lc(s,c)));break;case 30:break;case 21:break;default:In(r,s),Nn(s)}}function Nn(s){var r=s.flags;if(r&2){try{for(var a,c=s.return;c!==null;){if(p0(c)){a=c;break}c=c.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var v=a.stateNode,_=Vh(s);Vc(s,_,v);break;case 5:var A=a.stateNode;a.flags&32&&(Cn(A,""),a.flags&=-33);var I=Vh(s);Vc(s,I,A);break;case 3:case 4:var U=a.stateNode.containerInfo,Q=Vh(s);Lh(s,Q,U);break;default:throw Error(i(161))}}catch(re){ht(s,s.return,re)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function A0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;A0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function gi(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)v0(s,r.alternate,r),r=r.sibling}function ho(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:ar(4,r,r.return),ho(r);break;case 1:qs(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&h0(r,r.return,a),ho(r);break;case 27:Xl(r.stateNode);case 26:case 5:qs(r,r.return),ho(r);break;case 22:r.memoizedState===null&&ho(r);break;case 30:ho(r);break;default:ho(r)}s=s.sibling}}function yi(s,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,v=s,_=r,A=_.flags;switch(_.tag){case 0:case 11:case 15:yi(v,_,a),ql(4,_);break;case 1:if(yi(v,_,a),c=_,v=c.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(Q){ht(c,c.return,Q)}if(c=_,v=c.updateQueue,v!==null){var I=c.stateNode;try{var U=v.shared.hiddenCallbacks;if(U!==null)for(v.shared.hiddenCallbacks=null,v=0;v<U.length;v++)ty(U[v],I)}catch(Q){ht(c,c.return,Q)}}a&&A&64&&f0(_),Bl(_,_.return);break;case 27:g0(_);case 26:case 5:yi(v,_,a),a&&c===null&&A&4&&m0(_),Bl(_,_.return);break;case 12:yi(v,_,a);break;case 31:yi(v,_,a),a&&A&4&&x0(v,_);break;case 13:yi(v,_,a),a&&A&4&&E0(v,_);break;case 22:_.memoizedState===null&&yi(v,_,a),Bl(_,_.return);break;case 30:break;default:yi(v,_,a)}r=r.sibling}}function Oh(s,r){var a=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==a&&(s!=null&&s.refCount++,a!=null&&Il(a))}function jh(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Il(s))}function gs(s,r,a,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)S0(s,r,a,c),r=r.sibling}function S0(s,r,a,c){var v=r.flags;switch(r.tag){case 0:case 11:case 15:gs(s,r,a,c),v&2048&&ql(9,r);break;case 1:gs(s,r,a,c);break;case 3:gs(s,r,a,c),v&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Il(s)));break;case 12:if(v&2048){gs(s,r,a,c),s=r.stateNode;try{var _=r.memoizedProps,A=_.id,I=_.onPostCommit;typeof I=="function"&&I(A,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(U){ht(r,r.return,U)}}else gs(s,r,a,c);break;case 31:gs(s,r,a,c);break;case 13:gs(s,r,a,c);break;case 23:break;case 22:_=r.stateNode,A=r.alternate,r.memoizedState!==null?_._visibility&2?gs(s,r,a,c):zl(s,r):_._visibility&2?gs(s,r,a,c):(_._visibility|=2,ua(s,r,a,c,(r.subtreeFlags&10256)!==0||!1)),v&2048&&Oh(A,r);break;case 24:gs(s,r,a,c),v&2048&&jh(r.alternate,r);break;default:gs(s,r,a,c)}}function ua(s,r,a,c,v){for(v=v&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var _=s,A=r,I=a,U=c,Q=A.flags;switch(A.tag){case 0:case 11:case 15:ua(_,A,I,U,v),ql(8,A);break;case 23:break;case 22:var re=A.stateNode;A.memoizedState!==null?re._visibility&2?ua(_,A,I,U,v):zl(_,A):(re._visibility|=2,ua(_,A,I,U,v)),v&&Q&2048&&Oh(A.alternate,A);break;case 24:ua(_,A,I,U,v),v&&Q&2048&&jh(A.alternate,A);break;default:ua(_,A,I,U,v)}r=r.sibling}}function zl(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=s,c=r,v=c.flags;switch(c.tag){case 22:zl(a,c),v&2048&&Oh(c.alternate,c);break;case 24:zl(a,c),v&2048&&jh(c.alternate,c);break;default:zl(a,c)}r=r.sibling}}var Hl=8192;function ca(s,r,a){if(s.subtreeFlags&Hl)for(s=s.child;s!==null;)C0(s,r,a),s=s.sibling}function C0(s,r,a){switch(s.tag){case 26:ca(s,r,a),s.flags&Hl&&s.memoizedState!==null&&IC(a,ps,s.memoizedState,s.memoizedProps);break;case 5:ca(s,r,a);break;case 3:case 4:var c=ps;ps=Qc(s.stateNode.containerInfo),ca(s,r,a),ps=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Hl,Hl=16777216,ca(s,r,a),Hl=c):ca(s,r,a));break;default:ca(s,r,a)}}function w0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Gl(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];sn=c,N0(c,s)}w0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)I0(s),s=s.sibling}function I0(s){switch(s.tag){case 0:case 11:case 15:Gl(s),s.flags&2048&&ar(9,s,s.return);break;case 3:Gl(s);break;case 12:Gl(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Uc(s)):Gl(s);break;default:Gl(s)}}function Uc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];sn=c,N0(c,s)}w0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:ar(8,r,r.return),Uc(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,Uc(r));break;default:Uc(r)}s=s.sibling}}function N0(s,r){for(;sn!==null;){var a=sn;switch(a.tag){case 0:case 11:case 15:ar(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Il(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,sn=c;else e:for(a=s;sn!==null;){c=sn;var v=c.sibling,_=c.return;if(_0(c),c===a){sn=null;break e}if(v!==null){v.return=_,sn=v;break e}sn=_}}}var zS={getCacheForType:function(s){var r=cn(Ht),a=r.data.get(s);return a===void 0&&(a=s(),r.data.set(s,a)),a},cacheSignal:function(){return cn(Ht).controller.signal}},HS=typeof WeakMap=="function"?WeakMap:Map,ut=0,Tt=null,Je=null,Xe=0,ft=0,Fn=null,lr=!1,da=!1,Fh=!1,vi=0,Dt=0,ur=0,mo=0,qh=0,qn=0,fa=0,$l=null,Rn=null,Bh=!1,Oc=0,R0=0,jc=1/0,Fc=null,cr=null,Xt=0,dr=null,ha=null,_i=0,zh=0,Hh=null,M0=null,Yl=0,Gh=null;function Bn(){return(ut&2)!==0&&Xe!==0?Xe&-Xe:ee.T!==null?Xh():qu()}function D0(){if(qn===0)if((Xe&536870912)===0||nt){var s=ti;ti<<=1,(ti&3932160)===0&&(ti=262144),qn=s}else qn=536870912;return s=On.current,s!==null&&(s.flags|=32),qn}function Mn(s,r,a){(s===Tt&&(ft===2||ft===9)||s.cancelPendingCommit!==null)&&(ma(s,0),fr(s,Xe,qn,!1)),qr(s,a),((ut&2)===0||s!==Tt)&&(s===Tt&&((ut&2)===0&&(mo|=a),Dt===4&&fr(s,Xe,qn,!1)),Bs(s))}function P0(s,r,a){if((ut&6)!==0)throw Error(i(327));var c=!a&&(r&127)===0&&(r&s.expiredLanes)===0||Ft(s,r),v=c?YS(s,r):Yh(s,r,!0),_=c;do{if(v===0){da&&!c&&fr(s,r,0,!1);break}else{if(a=s.current.alternate,_&&!GS(a)){v=Yh(s,r,!1),_=!1;continue}if(v===2){if(_=r,s.errorRecoveryDisabledLanes&_)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var I=s;v=$l;var U=I.current.memoizedState.isDehydrated;if(U&&(ma(I,A).flags|=256),A=Yh(I,A,!1),A!==2){if(Fh&&!U){I.errorRecoveryDisabledLanes|=_,mo|=_,v=4;break e}_=Rn,Rn=v,_!==null&&(Rn===null?Rn=_:Rn.push.apply(Rn,_))}v=A}if(_=!1,v!==2)continue}}if(v===1){ma(s,0),fr(s,r,0,!0);break}e:{switch(c=s,_=v,_){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:fr(c,r,qn,!lr);break e;case 2:Rn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(v=Oc+300-en(),10<v)){if(fr(c,r,qn,!lr),mt(c,0,!0)!==0)break e;_i=r,c.timeoutHandle=cv(k0.bind(null,c,a,Rn,Fc,Bh,r,qn,mo,fa,lr,_,"Throttled",-0,0),v);break e}k0(c,a,Rn,Fc,Bh,r,qn,mo,fa,lr,_,null,-0,0)}}break}while(!0);Bs(s)}function k0(s,r,a,c,v,_,A,I,U,Q,re,le,X,te){if(s.timeoutHandle=-1,le=r.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:us},C0(r,_,le);var be=(_&62914560)===_?Oc-en():(_&4194048)===_?R0-en():0;if(be=NC(le,be),be!==null){_i=_,s.cancelPendingCommit=be(B0.bind(null,s,r,_,a,c,v,A,I,U,re,le,null,X,te)),fr(s,_,A,!Q);return}}B0(s,r,_,a,c,v,A,I,U)}function GS(s){for(var r=s;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var v=a[c],_=v.getSnapshot;v=v.value;try{if(!Ln(_(),v))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function fr(s,r,a,c){r&=~qh,r&=~mo,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var v=r;0<v;){var _=31-Fe(v),A=1<<_;c[_]=-1,v&=~A}a!==0&&Br(s,a,r)}function qc(){return(ut&6)===0?(Jl(0),!1):!0}function $h(){if(Je!==null){if(ft===0)var s=Je.return;else s=Je,li=io=null,lh(s),ia=null,Rl=0,s=Je;for(;s!==null;)d0(s.alternate,s),s=s.return;Je=null}}function ma(s,r){var a=s.timeoutHandle;a!==-1&&(s.timeoutHandle=-1,dC(a)),a=s.cancelPendingCommit,a!==null&&(s.cancelPendingCommit=null,a()),_i=0,$h(),Tt=s,Je=a=oi(s.current,null),Xe=r,ft=0,Fn=null,lr=!1,da=Ft(s,r),Fh=!1,fa=qn=qh=mo=ur=Dt=0,Rn=$l=null,Bh=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var v=31-Fe(c),_=1<<v;r|=s[v],c&=~_}return vi=r,lc(),a}function V0(s,r){He=null,ee.H=Ol,r===sa||r===gc?(r=Xg(),ft=3):r===Qf?(r=Xg(),ft=4):ft=r===Ah?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Fn=r,Je===null&&(Dt=1,Rc(s,Qn(r,s.current)))}function L0(){var s=On.current;return s===null?!0:(Xe&4194048)===Xe?es===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?s===es:!1}function U0(){var s=ee.H;return ee.H=Ol,s===null?Ol:s}function O0(){var s=ee.A;return ee.A=zS,s}function Bc(){Dt=4,lr||(Xe&4194048)!==Xe&&On.current!==null||(da=!0),(ur&134217727)===0&&(mo&134217727)===0||Tt===null||fr(Tt,Xe,qn,!1)}function Yh(s,r,a){var c=ut;ut|=2;var v=U0(),_=O0();(Tt!==s||Xe!==r)&&(Fc=null,ma(s,r)),r=!1;var A=Dt;e:do try{if(ft!==0&&Je!==null){var I=Je,U=Fn;switch(ft){case 8:$h(),A=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(r=!0);var Q=ft;if(ft=0,Fn=null,pa(s,I,U,Q),a&&da){A=0;break e}break;default:Q=ft,ft=0,Fn=null,pa(s,I,U,Q)}}$S(),A=Dt;break}catch(re){V0(s,re)}while(!0);return r&&s.shellSuspendCounter++,li=io=null,ut=c,ee.H=v,ee.A=_,Je===null&&(Tt=null,Xe=0,lc()),A}function $S(){for(;Je!==null;)j0(Je)}function YS(s,r){var a=ut;ut|=2;var c=U0(),v=O0();Tt!==s||Xe!==r?(Fc=null,jc=en()+500,ma(s,r)):da=Ft(s,r);e:do try{if(ft!==0&&Je!==null){r=Je;var _=Fn;t:switch(ft){case 1:ft=0,Fn=null,pa(s,r,_,1);break;case 2:case 9:if(Kg(_)){ft=0,Fn=null,F0(r);break}r=function(){ft!==2&&ft!==9||Tt!==s||(ft=7),Bs(s)},_.then(r,r);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:Kg(_)?(ft=0,Fn=null,F0(r)):(ft=0,Fn=null,pa(s,r,_,7));break;case 5:var A=null;switch(Je.tag){case 26:A=Je.memoizedState;case 5:case 27:var I=Je;if(A?Sv(A):I.stateNode.complete){ft=0,Fn=null;var U=I.sibling;if(U!==null)Je=U;else{var Q=I.return;Q!==null?(Je=Q,zc(Q)):Je=null}break t}}ft=0,Fn=null,pa(s,r,_,5);break;case 6:ft=0,Fn=null,pa(s,r,_,6);break;case 8:$h(),Dt=6;break e;default:throw Error(i(462))}}JS();break}catch(re){V0(s,re)}while(!0);return li=io=null,ee.H=c,ee.A=v,ut=a,Je!==null?0:(Tt=null,Xe=0,lc(),Dt)}function JS(){for(;Je!==null&&!il();)j0(Je)}function j0(s){var r=u0(s.alternate,s,vi);s.memoizedProps=s.pendingProps,r===null?zc(s):Je=r}function F0(s){var r=s,a=r.alternate;switch(r.tag){case 15:case 0:r=s0(a,r,r.pendingProps,r.type,void 0,Xe);break;case 11:r=s0(a,r,r.pendingProps,r.type.render,r.ref,Xe);break;case 5:lh(r);default:d0(a,r),r=Je=Og(r,vi),r=u0(a,r,vi)}s.memoizedProps=s.pendingProps,r===null?zc(s):Je=r}function pa(s,r,a,c){li=io=null,lh(r),ia=null,Rl=0;var v=r.return;try{if(LS(s,v,r,a,Xe)){Dt=1,Rc(s,Qn(a,s.current)),Je=null;return}}catch(_){if(v!==null)throw Je=v,_;Dt=1,Rc(s,Qn(a,s.current)),Je=null;return}r.flags&32768?(nt||c===1?s=!0:da||(Xe&536870912)!==0?s=!1:(lr=s=!0,(c===2||c===9||c===3||c===6)&&(c=On.current,c!==null&&c.tag===13&&(c.flags|=16384))),q0(r,s)):zc(r)}function zc(s){var r=s;do{if((r.flags&32768)!==0){q0(r,lr);return}s=r.return;var a=jS(r.alternate,r,vi);if(a!==null){Je=a;return}if(r=r.sibling,r!==null){Je=r;return}Je=r=s}while(r!==null);Dt===0&&(Dt=5)}function q0(s,r){do{var a=FS(s.alternate,s);if(a!==null){a.flags&=32767,Je=a;return}if(a=s.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(s=s.sibling,s!==null)){Je=s;return}Je=s=a}while(s!==null);Dt=6,Je=null}function B0(s,r,a,c,v,_,A,I,U){s.cancelPendingCommit=null;do Hc();while(Xt!==0);if((ut&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(_=r.lanes|r.childLanes,_|=Vf,Cf(s,a,_,A,I,U),s===Tt&&(Je=Tt=null,Xe=0),ha=r,dr=s,_i=a,zh=_,Hh=v,M0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,WS(os,function(){return Y0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null,v=W.p,W.p=2,A=ut,ut|=4;try{qS(s,r,a)}finally{ut=A,W.p=v,ee.T=c}}Xt=1,z0(),H0(),G0()}}function z0(){if(Xt===1){Xt=0;var s=dr,r=ha,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=ee.T,ee.T=null;var c=W.p;W.p=2;var v=ut;ut|=4;try{b0(r,s);var _=rm,A=Ng(s.containerInfo),I=_.focusedElem,U=_.selectionRange;if(A!==I&&I&&I.ownerDocument&&Ig(I.ownerDocument.documentElement,I)){if(U!==null&&Rf(I)){var Q=U.start,re=U.end;if(re===void 0&&(re=Q),"selectionStart"in I)I.selectionStart=Q,I.selectionEnd=Math.min(re,I.value.length);else{var le=I.ownerDocument||document,X=le&&le.defaultView||window;if(X.getSelection){var te=X.getSelection(),be=I.textContent.length,Pe=Math.min(U.start,be),vt=U.end===void 0?Pe:Math.min(U.end,be);!te.extend&&Pe>vt&&(A=vt,vt=Pe,Pe=A);var $=wg(I,Pe),z=wg(I,vt);if($&&z&&(te.rangeCount!==1||te.anchorNode!==$.node||te.anchorOffset!==$.offset||te.focusNode!==z.node||te.focusOffset!==z.offset)){var K=le.createRange();K.setStart($.node,$.offset),te.removeAllRanges(),Pe>vt?(te.addRange(K),te.extend(z.node,z.offset)):(K.setEnd(z.node,z.offset),te.addRange(K))}}}}for(le=[],te=I;te=te.parentNode;)te.nodeType===1&&le.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<le.length;I++){var ae=le[I];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}nd=!!im,rm=im=null}finally{ut=v,W.p=c,ee.T=a}}s.current=r,Xt=2}}function H0(){if(Xt===2){Xt=0;var s=dr,r=ha,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=ee.T,ee.T=null;var c=W.p;W.p=2;var v=ut;ut|=4;try{v0(s,r.alternate,r)}finally{ut=v,W.p=c,ee.T=a}}Xt=3}}function G0(){if(Xt===4||Xt===3){Xt=0,Do();var s=dr,r=ha,a=_i,c=M0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Xt=5:(Xt=0,ha=dr=null,$0(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(cr=null),ni(a),r=r.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(he,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=ee.T,v=W.p,W.p=2,ee.T=null;try{for(var _=s.onRecoverableError,A=0;A<c.length;A++){var I=c[A];_(I.value,{componentStack:I.stack})}}finally{ee.T=r,W.p=v}}(_i&3)!==0&&Hc(),Bs(s),v=s.pendingLanes,(a&261930)!==0&&(v&42)!==0?s===Gh?Yl++:(Yl=0,Gh=s):Yl=0,Jl(0)}}function $0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Il(r)))}function Hc(){return z0(),H0(),G0(),Y0()}function Y0(){if(Xt!==5)return!1;var s=dr,r=zh;zh=0;var a=ni(_i),c=ee.T,v=W.p;try{W.p=32>a?32:a,ee.T=null,a=Hh,Hh=null;var _=dr,A=_i;if(Xt=0,ha=dr=null,_i=0,(ut&6)!==0)throw Error(i(331));var I=ut;if(ut|=4,I0(_.current),S0(_,_.current,A,a),ut=I,Jl(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(he,_)}catch{}return!0}finally{W.p=v,ee.T=c,$0(s,r)}}function J0(s,r,a){r=Qn(a,r),r=bh(s.stateNode,r,2),s=ir(s,r,2),s!==null&&(qr(s,2),Bs(s))}function ht(s,r,a){if(s.tag===3)J0(s,s,a);else for(;r!==null;){if(r.tag===3){J0(r,s,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(cr===null||!cr.has(c))){s=Qn(a,s),a=Ky(2),c=ir(r,a,2),c!==null&&(Qy(a,c,r,s),qr(c,2),Bs(c));break}}r=r.return}}function Jh(s,r,a){var c=s.pingCache;if(c===null){c=s.pingCache=new HS;var v=new Set;c.set(r,v)}else v=c.get(r),v===void 0&&(v=new Set,c.set(r,v));v.has(a)||(Fh=!0,v.add(a),s=KS.bind(null,s,r,a),r.then(s,s))}function KS(s,r,a){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&a,s.warmLanes&=~a,Tt===s&&(Xe&a)===a&&(Dt===4||Dt===3&&(Xe&62914560)===Xe&&300>en()-Oc?(ut&2)===0&&ma(s,0):qh|=a,fa===Xe&&(fa=0)),Bs(s)}function K0(s,r){r===0&&(r=Ss()),s=to(s,r),s!==null&&(qr(s,r),Bs(s))}function QS(s){var r=s.memoizedState,a=0;r!==null&&(a=r.retryLane),K0(s,a)}function XS(s,r){var a=0;switch(s.tag){case 31:case 13:var c=s.stateNode,v=s.memoizedState;v!==null&&(a=v.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),K0(s,a)}function WS(s,r){return kt(s,r)}var Gc=null,ga=null,Kh=!1,$c=!1,Qh=!1,hr=0;function Bs(s){s!==ga&&s.next===null&&(ga===null?Gc=ga=s:ga=ga.next=s),$c=!0,Kh||(Kh=!0,eC())}function Jl(s,r){if(!Qh&&$c){Qh=!0;do for(var a=!1,c=Gc;c!==null;){if(s!==0){var v=c.pendingLanes;if(v===0)var _=0;else{var A=c.suspendedLanes,I=c.pingedLanes;_=(1<<31-Fe(42|s)+1)-1,_&=v&~(A&~I),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(a=!0,Z0(c,_))}else _=Xe,_=mt(c,c===Tt?_:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(_&3)===0||Ft(c,_)||(a=!0,Z0(c,_));c=c.next}while(a);Qh=!1}}function ZS(){Q0()}function Q0(){$c=Kh=!1;var s=0;hr!==0&&cC()&&(s=hr);for(var r=en(),a=null,c=Gc;c!==null;){var v=c.next,_=X0(c,r);_===0?(c.next=null,a===null?Gc=v:a.next=v,v===null&&(ga=a)):(a=c,(s!==0||(_&3)!==0)&&($c=!0)),c=v}Xt!==0&&Xt!==5||Jl(s),hr!==0&&(hr=0)}function X0(s,r){for(var a=s.suspendedLanes,c=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var A=31-Fe(_),I=1<<A,U=v[A];U===-1?((I&a)===0||(I&c)!==0)&&(v[A]=An(I,r)):U<=r&&(s.expiredLanes|=I),_&=~I}if(r=Tt,a=Xe,a=mt(s,s===r?a:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,a===0||s===r&&(ft===2||ft===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&As(c),s.callbackNode=null,s.callbackPriority=0;if((a&3)===0||Ft(s,a)){if(r=a&-a,r===s.callbackPriority)return r;switch(c!==null&&As(c),ni(a)){case 2:case 8:a=Bi;break;case 32:a=os;break;case 268435456:a=jr;break;default:a=os}return c=W0.bind(null,s),a=kt(a,c),s.callbackPriority=r,s.callbackNode=a,r}return c!==null&&c!==null&&As(c),s.callbackPriority=2,s.callbackNode=null,2}function W0(s,r){if(Xt!==0&&Xt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var a=s.callbackNode;if(Hc()&&s.callbackNode!==a)return null;var c=Xe;return c=mt(s,s===Tt?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(P0(s,c,r),X0(s,en()),s.callbackNode!=null&&s.callbackNode===a?W0.bind(null,s):null)}function Z0(s,r){if(Hc())return null;P0(s,r,!0)}function eC(){fC(function(){(ut&6)!==0?kt(qi,ZS):Q0()})}function Xh(){if(hr===0){var s=ta;s===0&&(s=Hn,Hn<<=1,(Hn&261888)===0&&(Hn=256)),hr=s}return hr}function ev(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Fo(""+s)}function tv(s,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,s.id&&a.setAttribute("form",s.id),r.parentNode.insertBefore(a,r),s=new FormData(s),a.parentNode.removeChild(a),s}function tC(s,r,a,c,v){if(r==="submit"&&a&&a.stateNode===v){var _=ev((v[tn]||null).action),A=c.submitter;A&&(r=(r=A[tn]||null)?ev(r.formAction):A.getAttribute("formAction"),r!==null&&(_=r,A=null));var I=new Vs("action","action",null,c,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(hr!==0){var U=A?tv(v,A):new FormData(v);yh(a,{pending:!0,data:U,method:v.method,action:_},null,U)}}else typeof _=="function"&&(I.preventDefault(),U=A?tv(v,A):new FormData(v),yh(a,{pending:!0,data:U,method:v.method,action:_},_,U))},currentTarget:v}]})}}for(var Wh=0;Wh<kf.length;Wh++){var Zh=kf[Wh],nC=Zh.toLowerCase(),sC=Zh[0].toUpperCase()+Zh.slice(1);ms(nC,"on"+sC)}ms(Dg,"onAnimationEnd"),ms(Pg,"onAnimationIteration"),ms(kg,"onAnimationStart"),ms("dblclick","onDoubleClick"),ms("focusin","onFocus"),ms("focusout","onBlur"),ms(_S,"onTransitionRun"),ms(TS,"onTransitionStart"),ms(xS,"onTransitionCancel"),ms(Vg,"onTransitionEnd"),Ms("onMouseEnter",["mouseout","mouseover"]),Ms("onMouseLeave",["mouseout","mouseover"]),Ms("onPointerEnter",["pointerout","pointerover"]),Ms("onPointerLeave",["pointerout","pointerover"]),Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kl));function nv(s,r){r=(r&4)!==0;for(var a=0;a<s.length;a++){var c=s[a],v=c.event;c=c.listeners;e:{var _=void 0;if(r)for(var A=c.length-1;0<=A;A--){var I=c[A],U=I.instance,Q=I.currentTarget;if(I=I.listener,U!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=Q;try{_(v)}catch(re){ac(re)}v.currentTarget=null,_=U}else for(A=0;A<c.length;A++){if(I=c[A],U=I.instance,Q=I.currentTarget,I=I.listener,U!==_&&v.isPropagationStopped())break e;_=I,v.currentTarget=Q;try{_(v)}catch(re){ac(re)}v.currentTarget=null,_=U}}}}function Ke(s,r){var a=r[Vo];a===void 0&&(a=r[Vo]=new Set);var c=s+"__bubble";a.has(c)||(sv(r,s,2,!1),a.add(c))}function em(s,r,a){var c=0;r&&(c|=4),sv(a,s,c,r)}var Yc="_reactListening"+Math.random().toString(36).slice(2);function tm(s){if(!s[Yc]){s[Yc]=!0,al.forEach(function(a){a!=="selectionchange"&&(iC.has(a)||em(a,!1,s),em(a,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Yc]||(r[Yc]=!0,em("selectionchange",!1,r))}}function sv(s,r,a,c){switch(Dv(r)){case 2:var v=DC;break;case 8:v=PC;break;default:v=gm}a=v.bind(null,r,a,s),v=void 0,!Yr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(v=!0),c?v!==void 0?s.addEventListener(r,a,{capture:!0,passive:v}):s.addEventListener(r,a,!0):v!==void 0?s.addEventListener(r,a,{passive:v}):s.addEventListener(r,a,!1)}function nm(s,r,a,c,v){var _=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var I=c.stateNode.containerInfo;if(I===v)break;if(A===4)for(A=c.return;A!==null;){var U=A.tag;if((U===3||U===4)&&A.stateNode.containerInfo===v)return;A=A.return}for(;I!==null;){if(A=Is(I),A===null)return;if(U=A.tag,U===5||U===6||U===26||U===27){c=_=A;continue e}I=I.parentNode}}c=c.return}Ji(function(){var Q=_,re=$n(a),le=[];e:{var X=Lg.get(s);if(X!==void 0){var te=Vs,be=s;switch(s){case"keypress":if(Kr(a)===0)break e;case"keydown":case"keyup":te=ic;break;case"focusin":be="focus",te=Xr;break;case"focusout":be="blur",te=Xr;break;case"beforeblur":case"afterblur":te=Xr;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Tl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Ku;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=E;break;case Dg:case Pg:case kg:te=Xu;break;case Vg:te=D;break;case"scroll":case"scrollend":te=_l;break;case"wheel":te=Z;break;case"copy":case"cut":case"paste":te=Wu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=ri;break;case"toggle":case"beforetoggle":te=ze}var Pe=(r&4)!==0,vt=!Pe&&(s==="scroll"||s==="scrollend"),$=Pe?X!==null?X+"Capture":null:X;Pe=[];for(var z=Q,K;z!==null;){var ae=z;if(K=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||K===null||$===null||(ae=cs(z,$),ae!=null&&Pe.push(Ql(z,ae,K))),vt)break;z=z.return}0<Pe.length&&(X=new te(X,be,null,a,re),le.push({event:X,listeners:Pe}))}}if((r&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",X&&a!==gl&&(be=a.relatedTarget||a.fromElement)&&(Is(be)||be[Cs]))break e;if((te||X)&&(X=re.window===re?re:(X=re.ownerDocument)?X.defaultView||X.parentWindow:window,te?(be=a.relatedTarget||a.toElement,te=Q,be=be?Is(be):null,be!==null&&(vt=l(be),Pe=be.tag,be!==vt||Pe!==5&&Pe!==27&&Pe!==6)&&(be=null)):(te=null,be=Q),te!==be)){if(Pe=Tl,ae="onMouseLeave",$="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Pe=ri,ae="onPointerLeave",$="onPointerEnter",z="pointer"),vt=te==null?X:kn(te),K=be==null?X:kn(be),X=new Pe(ae,z+"leave",te,a,re),X.target=vt,X.relatedTarget=K,ae=null,Is(re)===Q&&(Pe=new Pe($,z+"enter",be,a,re),Pe.target=K,Pe.relatedTarget=vt,ae=Pe),vt=ae,te&&be)t:{for(Pe=rC,$=te,z=be,K=0,ae=$;ae;ae=Pe(ae))K++;ae=0;for(var we=z;we;we=Pe(we))ae++;for(;0<K-ae;)$=Pe($),K--;for(;0<ae-K;)z=Pe(z),ae--;for(;K--;){if($===z||z!==null&&$===z.alternate){Pe=$;break t}$=Pe($),z=Pe(z)}Pe=null}else Pe=null;te!==null&&iv(le,X,te,Pe,!1),be!==null&&vt!==null&&iv(le,vt,be,Pe,!0)}}e:{if(X=Q?kn(Q):window,te=X.nodeName&&X.nodeName.toLowerCase(),te==="select"||te==="input"&&X.type==="file")var rt=xg;else if(_g(X))if(Eg)rt=gS;else{rt=mS;var Ce=hS}else te=X.nodeName,!te||te.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&jo(Q.elementType)&&(rt=xg):rt=pS;if(rt&&(rt=rt(s,Q))){Tg(le,rt,a,re);break e}Ce&&Ce(s,X,Q),s==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&hl(X,"number",X.value)}switch(Ce=Q?kn(Q):window,s){case"focusin":(_g(Ce)||Ce.contentEditable==="true")&&(Yo=Ce,Mf=Q,Sl=null);break;case"focusout":Sl=Mf=Yo=null;break;case"mousedown":Df=!0;break;case"contextmenu":case"mouseup":case"dragend":Df=!1,Rg(le,a,re);break;case"selectionchange":if(vS)break;case"keydown":case"keyup":Rg(le,a,re)}var Ge;if(lt)e:{switch(s){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else $o?Wr(s,a)&&(We="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(We="onCompositionStart");We&&(Os&&a.locale!=="ko"&&($o||We!=="onCompositionStart"?We==="onCompositionEnd"&&$o&&(Ge=vl()):(ks=re,yl="value"in ks?ks.value:ks.textContent,$o=!0)),Ce=Jc(Q,We),0<Ce.length&&(We=new Us(We,s,null,a,re),le.push({event:We,listeners:Ce}),Ge?We.data=Ge:(Ge=Go(a),Ge!==null&&(We.data=Ge)))),(Ge=Jn?uS(s,a):cS(s,a))&&(We=Jc(Q,"onBeforeInput"),0<We.length&&(Ce=new Us("onBeforeInput","beforeinput",null,a,re),le.push({event:Ce,listeners:We}),Ce.data=Ge)),tC(le,s,Q,a,re)}nv(le,r)})}function Ql(s,r,a){return{instance:s,listener:r,currentTarget:a}}function Jc(s,r){for(var a=r+"Capture",c=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=cs(s,a),v!=null&&c.unshift(Ql(s,v,_)),v=cs(s,r),v!=null&&c.push(Ql(s,v,_))),s.tag===3)return c;s=s.return}return[]}function rC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function iv(s,r,a,c,v){for(var _=r._reactName,A=[];a!==null&&a!==c;){var I=a,U=I.alternate,Q=I.stateNode;if(I=I.tag,U!==null&&U===c)break;I!==5&&I!==26&&I!==27||Q===null||(U=Q,v?(Q=cs(a,_),Q!=null&&A.unshift(Ql(a,Q,U))):v||(Q=cs(a,_),Q!=null&&A.push(Ql(a,Q,U)))),a=a.return}A.length!==0&&s.push({event:r,listeners:A})}var oC=/\r\n?/g,aC=/\u0000|\uFFFD/g;function rv(s){return(typeof s=="string"?s:""+s).replace(oC,`
`).replace(aC,"")}function ov(s,r){return r=rv(r),rv(s)===r}function yt(s,r,a,c,v,_){switch(a){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Cn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Cn(s,""+c);break;case"className":Vn(s,"class",c);break;case"tabIndex":Vn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Vn(s,a,c);break;case"style":pl(s,c,_);break;case"data":if(r!=="object"){Vn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||a!=="href")){s.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=Fo(""+c),s.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(a==="formAction"?(r!=="input"&&yt(s,r,"name",v.name,v,null),yt(s,r,"formEncType",v.formEncType,v,null),yt(s,r,"formMethod",v.formMethod,v,null),yt(s,r,"formTarget",v.formTarget,v,null)):(yt(s,r,"encType",v.encType,v,null),yt(s,r,"method",v.method,v,null),yt(s,r,"target",v.target,v,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(a);break}c=Fo(""+c),s.setAttribute(a,c);break;case"onClick":c!=null&&(s.onclick=us);break;case"onScroll":c!=null&&Ke("scroll",s);break;case"onScrollEnd":c!=null&&Ke("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}a=Fo(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""+c):s.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,""):s.removeAttribute(a);break;case"capture":case"download":c===!0?s.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(a,c):s.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(a,c):s.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(a):s.setAttribute(a,c);break;case"popover":Ke("beforetoggle",s),Ke("toggle",s),Uo(s,"popover",c);break;case"xlinkActuate":zt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":zt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":zt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":zt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":zt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":zt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":zt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":zt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":zt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Uo(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Ju.get(a)||a,Uo(s,a,c))}}function sm(s,r,a,c,v,_){switch(a){case"style":pl(s,c,_);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=a}}break;case"children":typeof c=="string"?Cn(s,c):(typeof c=="number"||typeof c=="bigint")&&Cn(s,""+c);break;case"onScroll":c!=null&&Ke("scroll",s);break;case"onScrollEnd":c!=null&&Ke("scrollend",s);break;case"onClick":c!=null&&(s.onclick=us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ll.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(v=a.endsWith("Capture"),r=a.slice(2,v?a.length-7:void 0),_=s[tn]||null,_=_!=null?_[a]:null,typeof _=="function"&&s.removeEventListener(r,_,v),typeof c=="function")){typeof _!="function"&&_!==null&&(a in s?s[a]=null:s.hasAttribute(a)&&s.removeAttribute(a)),s.addEventListener(r,c,v);break e}a in s?s[a]=c:c===!0?s.setAttribute(a,""):Uo(s,a,c)}}}function fn(s,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",s),Ke("load",s);var c=!1,v=!1,_;for(_ in a)if(a.hasOwnProperty(_)){var A=a[_];if(A!=null)switch(_){case"src":c=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,_,A,a,null)}}v&&yt(s,r,"srcSet",a.srcSet,a,null),c&&yt(s,r,"src",a.src,a,null);return;case"input":Ke("invalid",s);var I=_=A=v=null,U=null,Q=null;for(c in a)if(a.hasOwnProperty(c)){var re=a[c];if(re!=null)switch(c){case"name":v=re;break;case"type":A=re;break;case"checked":U=re;break;case"defaultChecked":Q=re;break;case"value":_=re;break;case"defaultValue":I=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,r));break;default:yt(s,r,c,re,a,null)}}Gu(s,_,I,U,Q,A,v,!1);return;case"select":Ke("invalid",s),c=A=_=null;for(v in a)if(a.hasOwnProperty(v)&&(I=a[v],I!=null))switch(v){case"value":_=I;break;case"defaultValue":A=I;break;case"multiple":c=I;default:yt(s,r,v,I,a,null)}r=_,a=A,s.multiple=!!c,r!=null?Hi(s,!!c,r,!1):a!=null&&Hi(s,!!c,a,!0);return;case"textarea":Ke("invalid",s),_=v=c=null;for(A in a)if(a.hasOwnProperty(A)&&(I=a[A],I!=null))switch(A){case"value":c=I;break;case"defaultValue":v=I;break;case"children":_=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:yt(s,r,A,I,a,null)}Gi(s,c,v,_);return;case"option":for(U in a)if(a.hasOwnProperty(U)&&(c=a[U],c!=null))switch(U){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:yt(s,r,U,c,a,null)}return;case"dialog":Ke("beforetoggle",s),Ke("toggle",s),Ke("cancel",s),Ke("close",s);break;case"iframe":case"object":Ke("load",s);break;case"video":case"audio":for(c=0;c<Kl.length;c++)Ke(Kl[c],s);break;case"image":Ke("error",s),Ke("load",s);break;case"details":Ke("toggle",s);break;case"embed":case"source":case"link":Ke("error",s),Ke("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in a)if(a.hasOwnProperty(Q)&&(c=a[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:yt(s,r,Q,c,a,null)}return;default:if(jo(r)){for(re in a)a.hasOwnProperty(re)&&(c=a[re],c!==void 0&&sm(s,r,re,c,a,void 0));return}}for(I in a)a.hasOwnProperty(I)&&(c=a[I],c!=null&&yt(s,r,I,c,a,null))}function lC(s,r,a,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,A=null,I=null,U=null,Q=null,re=null;for(te in a){var le=a[te];if(a.hasOwnProperty(te)&&le!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":U=le;default:c.hasOwnProperty(te)||yt(s,r,te,null,c,le)}}for(var X in c){var te=c[X];if(le=a[X],c.hasOwnProperty(X)&&(te!=null||le!=null))switch(X){case"type":_=te;break;case"name":v=te;break;case"checked":Q=te;break;case"defaultChecked":re=te;break;case"value":A=te;break;case"defaultValue":I=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,r));break;default:te!==le&&yt(s,r,X,te,c,le)}}Oo(s,A,I,U,Q,re,_,v);return;case"select":te=A=I=X=null;for(_ in a)if(U=a[_],a.hasOwnProperty(_)&&U!=null)switch(_){case"value":break;case"multiple":te=U;default:c.hasOwnProperty(_)||yt(s,r,_,null,c,U)}for(v in c)if(_=c[v],U=a[v],c.hasOwnProperty(v)&&(_!=null||U!=null))switch(v){case"value":X=_;break;case"defaultValue":I=_;break;case"multiple":A=_;default:_!==U&&yt(s,r,v,_,c,U)}r=I,a=A,c=te,X!=null?Hi(s,!!a,X,!1):!!c!=!!a&&(r!=null?Hi(s,!!a,r,!0):Hi(s,!!a,a?[]:"",!1));return;case"textarea":te=X=null;for(I in a)if(v=a[I],a.hasOwnProperty(I)&&v!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:yt(s,r,I,null,c,v)}for(A in c)if(v=c[A],_=a[A],c.hasOwnProperty(A)&&(v!=null||_!=null))switch(A){case"value":X=v;break;case"defaultValue":te=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==_&&yt(s,r,A,v,c,_)}$u(s,X,te);return;case"option":for(var be in a)if(X=a[be],a.hasOwnProperty(be)&&X!=null&&!c.hasOwnProperty(be))switch(be){case"selected":s.selected=!1;break;default:yt(s,r,be,null,c,X)}for(U in c)if(X=c[U],te=a[U],c.hasOwnProperty(U)&&X!==te&&(X!=null||te!=null))switch(U){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:yt(s,r,U,X,c,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in a)X=a[Pe],a.hasOwnProperty(Pe)&&X!=null&&!c.hasOwnProperty(Pe)&&yt(s,r,Pe,null,c,X);for(Q in c)if(X=c[Q],te=a[Q],c.hasOwnProperty(Q)&&X!==te&&(X!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,r));break;default:yt(s,r,Q,X,c,te)}return;default:if(jo(r)){for(var vt in a)X=a[vt],a.hasOwnProperty(vt)&&X!==void 0&&!c.hasOwnProperty(vt)&&sm(s,r,vt,void 0,c,X);for(re in c)X=c[re],te=a[re],!c.hasOwnProperty(re)||X===te||X===void 0&&te===void 0||sm(s,r,re,X,c,te);return}}for(var $ in a)X=a[$],a.hasOwnProperty($)&&X!=null&&!c.hasOwnProperty($)&&yt(s,r,$,null,c,X);for(le in c)X=c[le],te=a[le],!c.hasOwnProperty(le)||X===te||X==null&&te==null||yt(s,r,le,X,c,te)}function av(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var v=a[c],_=v.transferSize,A=v.initiatorType,I=v.duration;if(_&&I&&av(A)){for(A=0,I=v.responseEnd,c+=1;c<a.length;c++){var U=a[c],Q=U.startTime;if(Q>I)break;var re=U.transferSize,le=U.initiatorType;re&&av(le)&&(U=U.responseEnd,A+=re*(U<I?1:(I-Q)/(U-Q)))}if(--c,r+=8*(_+A)/(v.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var im=null,rm=null;function Kc(s){return s.nodeType===9?s:s.ownerDocument}function lv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function uv(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function om(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var am=null;function cC(){var s=window.event;return s&&s.type==="popstate"?s===am?!1:(am=s,!0):(am=null,!1)}var cv=typeof setTimeout=="function"?setTimeout:void 0,dC=typeof clearTimeout=="function"?clearTimeout:void 0,dv=typeof Promise=="function"?Promise:void 0,fC=typeof queueMicrotask=="function"?queueMicrotask:typeof dv<"u"?function(s){return dv.resolve(null).then(s).catch(hC)}:cv;function hC(s){setTimeout(function(){throw s})}function mr(s){return s==="head"}function fv(s,r){var a=r,c=0;do{var v=a.nextSibling;if(s.removeChild(a),v&&v.nodeType===8)if(a=v.data,a==="/$"||a==="/&"){if(c===0){s.removeChild(v),Ta(r);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")Xl(s.ownerDocument.documentElement);else if(a==="head"){a=s.ownerDocument.head,Xl(a);for(var _=a.firstChild;_;){var A=_.nextSibling,I=_.nodeName;_[ws]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&_.rel.toLowerCase()==="stylesheet"||a.removeChild(_),_=A}}else a==="body"&&Xl(s.ownerDocument.body);a=v}while(a);Ta(r)}function hv(s,r){var a=s;s=0;do{var c=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(s===0)break;s--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||s++;a=c}while(a)}function lm(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":lm(a),Lo(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}s.removeChild(a)}}function mC(s,r,a,c){for(;s.nodeType===1;){var v=a;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[ws])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=ts(s.nextSibling),s===null)break}return null}function pC(s,r,a){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ts(s.nextSibling),s===null))return null;return s}function mv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=ts(s.nextSibling),s===null))return null;return s}function um(s){return s.data==="$?"||s.data==="$~"}function cm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function gC(s,r){var a=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||a.readyState!=="loading")r();else{var c=function(){r(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ts(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var dm=null;function pv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"||a==="/&"){if(r===0)return ts(s.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}s=s.nextSibling}return null}function gv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return s;r--}else a!=="/$"&&a!=="/&"||r++}s=s.previousSibling}return null}function yv(s,r,a){switch(r=Kc(a),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Xl(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Lo(s)}var ns=new Map,vv=new Set;function Qc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ti=W.d;W.d={f:yC,r:vC,D:_C,C:TC,L:xC,m:EC,X:AC,S:bC,M:SC};function yC(){var s=Ti.f(),r=qc();return s||r}function vC(s){var r=Gn(s);r!==null&&r.tag===5&&r.type==="form"?Vy(r):Ti.r(s)}var ya=typeof document>"u"?null:document;function _v(s,r,a){var c=ya;if(c&&typeof r=="string"&&r){var v=Sn(r);v='link[rel="'+s+'"][href="'+v+'"]',typeof a=="string"&&(v+='[crossorigin="'+a+'"]'),vv.has(v)||(vv.add(v),s={rel:s,crossOrigin:a,href:r},c.querySelector(v)===null&&(r=c.createElement("link"),fn(r,"link",s),Bt(r),c.head.appendChild(r)))}}function _C(s){Ti.D(s),_v("dns-prefetch",s,null)}function TC(s,r){Ti.C(s,r),_v("preconnect",s,r)}function xC(s,r,a){Ti.L(s,r,a);var c=ya;if(c&&s&&r){var v='link[rel="preload"][as="'+Sn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(v+='[imagesrcset="'+Sn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(v+='[imagesizes="'+Sn(a.imageSizes)+'"]')):v+='[href="'+Sn(s)+'"]';var _=v;switch(r){case"style":_=va(s);break;case"script":_=_a(s)}ns.has(_)||(s=x({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:s,as:r},a),ns.set(_,s),c.querySelector(v)!==null||r==="style"&&c.querySelector(Wl(_))||r==="script"&&c.querySelector(Zl(_))||(r=c.createElement("link"),fn(r,"link",s),Bt(r),c.head.appendChild(r)))}}function EC(s,r){Ti.m(s,r);var a=ya;if(a&&s){var c=r&&typeof r.as=="string"?r.as:"script",v='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(s)+'"]',_=v;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=_a(s)}if(!ns.has(_)&&(s=x({rel:"modulepreload",href:s},r),ns.set(_,s),a.querySelector(v)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Zl(_)))return}c=a.createElement("link"),fn(c,"link",s),Bt(c),a.head.appendChild(c)}}}function bC(s,r,a){Ti.S(s,r,a);var c=ya;if(c&&s){var v=Ns(c).hoistableStyles,_=va(s);r=r||"default";var A=v.get(_);if(!A){var I={loading:0,preload:null};if(A=c.querySelector(Wl(_)))I.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":r},a),(a=ns.get(_))&&fm(s,a);var U=A=c.createElement("link");Bt(U),fn(U,"link",s),U._p=new Promise(function(Q,re){U.onload=Q,U.onerror=re}),U.addEventListener("load",function(){I.loading|=1}),U.addEventListener("error",function(){I.loading|=2}),I.loading|=4,Xc(A,r,c)}A={type:"stylesheet",instance:A,count:1,state:I},v.set(_,A)}}}function AC(s,r){Ti.X(s,r);var a=ya;if(a&&s){var c=Ns(a).hoistableScripts,v=_a(s),_=c.get(v);_||(_=a.querySelector(Zl(v)),_||(s=x({src:s,async:!0},r),(r=ns.get(v))&&hm(s,r),_=a.createElement("script"),Bt(_),fn(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function SC(s,r){Ti.M(s,r);var a=ya;if(a&&s){var c=Ns(a).hoistableScripts,v=_a(s),_=c.get(v);_||(_=a.querySelector(Zl(v)),_||(s=x({src:s,async:!0,type:"module"},r),(r=ns.get(v))&&hm(s,r),_=a.createElement("script"),Bt(_),fn(_,"link",s),a.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},c.set(v,_))}}function Tv(s,r,a,c){var v=(v=Oe.current)?Qc(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=va(a.href),a=Ns(v).hoistableStyles,c=a.get(r),c||(c={type:"style",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){s=va(a.href);var _=Ns(v).hoistableStyles,A=_.get(s);if(A||(v=v.ownerDocument||v,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,A),(_=v.querySelector(Wl(s)))&&!_._p&&(A.instance=_,A.state.loading=5),ns.has(s)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ns.set(s,a),_||CC(v,s,a,A.state))),r&&c===null)throw Error(i(528,""));return A}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=_a(a),a=Ns(v).hoistableScripts,c=a.get(r),c||(c={type:"script",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function va(s){return'href="'+Sn(s)+'"'}function Wl(s){return'link[rel="stylesheet"]['+s+"]"}function xv(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function CC(s,r,a,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),fn(r,"link",a),Bt(r),s.head.appendChild(r))}function _a(s){return'[src="'+Sn(s)+'"]'}function Zl(s){return"script[async]"+s}function Ev(s,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+Sn(a.href)+'"]');if(c)return r.instance=c,Bt(c),c;var v=x({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),Bt(c),fn(c,"style",v),Xc(c,a.precedence,s),r.instance=c;case"stylesheet":v=va(a.href);var _=s.querySelector(Wl(v));if(_)return r.state.loading|=4,r.instance=_,Bt(_),_;c=xv(a),(v=ns.get(v))&&fm(c,v),_=(s.ownerDocument||s).createElement("link"),Bt(_);var A=_;return A._p=new Promise(function(I,U){A.onload=I,A.onerror=U}),fn(_,"link",c),r.state.loading|=4,Xc(_,a.precedence,s),r.instance=_;case"script":return _=_a(a.src),(v=s.querySelector(Zl(_)))?(r.instance=v,Bt(v),v):(c=a,(v=ns.get(_))&&(c=x({},a),hm(c,v)),s=s.ownerDocument||s,v=s.createElement("script"),Bt(v),fn(v,"link",c),s.head.appendChild(v),r.instance=v);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Xc(c,a.precedence,s));return r.instance}function Xc(s,r,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=c.length?c[c.length-1]:null,_=v,A=0;A<c.length;A++){var I=c[A];if(I.dataset.precedence===r)_=I;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(s,r.firstChild))}function fm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function hm(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Wc=null;function bv(s,r,a){if(Wc===null){var c=new Map,v=Wc=new Map;v.set(a,c)}else v=Wc,c=v.get(a),c||(c=new Map,v.set(a,c));if(c.has(s))return c;for(c.set(s,null),a=a.getElementsByTagName(s),v=0;v<a.length;v++){var _=a[v];if(!(_[ws]||_[qt]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(r)||"";A=s+A;var I=c.get(A);I?I.push(_):c.set(A,[_])}}return c}function Av(s,r,a){s=s.ownerDocument||s,s.head.insertBefore(a,r==="title"?s.querySelector("head > title"):null)}function wC(s,r,a){if(a===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Sv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function IC(s,r,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var v=va(c.href),_=r.querySelector(Wl(v));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Zc.bind(s),r.then(s,s)),a.state.loading|=4,a.instance=_,Bt(_);return}_=r.ownerDocument||r,c=xv(c),(v=ns.get(v))&&fm(c,v),_=_.createElement("link"),Bt(_);var A=_;A._p=new Promise(function(I,U){A.onload=I,A.onerror=U}),fn(_,"link",c),a.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(s.count++,a=Zc.bind(s),r.addEventListener("load",a),r.addEventListener("error",a))}}var mm=0;function NC(s,r){return s.stylesheets&&s.count===0&&td(s,s.stylesheets),0<s.count||0<s.imgCount?function(a){var c=setTimeout(function(){if(s.stylesheets&&td(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+r);0<s.imgBytes&&mm===0&&(mm=62500*uC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&td(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>mm?50:800)+r);return s.unsuspend=a,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(v)}}:null}function Zc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)td(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var ed=null;function td(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,ed=new Map,r.forEach(RC,s),ed=null,Zc.call(s))}function RC(s,r){if(!(r.state.loading&4)){var a=ed.get(s);if(a)var c=a.get(null);else{a=new Map,ed.set(s,a);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var A=v[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(a.set(A.dataset.precedence,A),c=A)}c&&a.set(null,c)}v=r.instance,A=v.getAttribute("data-precedence"),_=a.get(A)||c,_===c&&a.set(null,v),a.set(A,v),this.count++,c=Zc.bind(this),v.addEventListener("load",c),v.addEventListener("error",c),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),r.state.loading|=4}}var eu={$$typeof:B,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function MC(s,r,a,c,v,_,A,I,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qe(0),this.hiddenUpdates=Qe(null),this.identifierPrefix=c,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Cv(s,r,a,c,v,_,A,I,U,Q,re,le){return s=new MC(s,r,a,A,U,Q,re,le,I),r=1,_===!0&&(r|=24),_=Un(3,null,null,r),s.current=_,_.stateNode=s,r=Yf(),r.refCount++,s.pooledCache=r,r.refCount++,_.memoizedState={element:c,isDehydrated:a,cache:r},Xf(_),s}function wv(s){return s?(s=Qo,s):Qo}function Iv(s,r,a,c,v,_){v=wv(v),c.context===null?c.context=v:c.pendingContext=v,c=sr(r),c.payload={element:a},_=_===void 0?null:_,_!==null&&(c.callback=_),a=ir(s,c,r),a!==null&&(Mn(a,s,r),Dl(a,s,r))}function Nv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<r?a:r}}function pm(s,r){Nv(s,r),(s=s.alternate)&&Nv(s,r)}function Rv(s){if(s.tag===13||s.tag===31){var r=to(s,67108864);r!==null&&Mn(r,s,67108864),pm(s,67108864)}}function Mv(s){if(s.tag===13||s.tag===31){var r=Bn();r=zr(r);var a=to(s,r);a!==null&&Mn(a,s,r),pm(s,r)}}var nd=!0;function DC(s,r,a,c){var v=ee.T;ee.T=null;var _=W.p;try{W.p=2,gm(s,r,a,c)}finally{W.p=_,ee.T=v}}function PC(s,r,a,c){var v=ee.T;ee.T=null;var _=W.p;try{W.p=8,gm(s,r,a,c)}finally{W.p=_,ee.T=v}}function gm(s,r,a,c){if(nd){var v=ym(c);if(v===null)nm(s,r,c,sd,a),Pv(s,c);else if(VC(v,s,r,a,c))c.stopPropagation();else if(Pv(s,c),r&4&&-1<kC.indexOf(s)){for(;v!==null;){var _=Gn(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=xe(_.pendingLanes);if(A!==0){var I=_;for(I.pendingLanes|=2,I.entangledLanes|=2;A;){var U=1<<31-Fe(A);I.entanglements[1]|=U,A&=~U}Bs(_),(ut&6)===0&&(jc=en()+500,Jl(0))}}break;case 31:case 13:I=to(_,2),I!==null&&Mn(I,_,2),qc(),pm(_,2)}if(_=ym(c),_===null&&nm(s,r,c,sd,a),_===v)break;v=_}v!==null&&c.stopPropagation()}else nm(s,r,c,null,a)}}function ym(s){return s=$n(s),vm(s)}var sd=null;function vm(s){if(sd=null,s=Is(s),s!==null){var r=l(s);if(r===null)s=null;else{var a=r.tag;if(a===13){if(s=u(r),s!==null)return s;s=null}else if(a===31){if(s=f(r),s!==null)return s;s=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return sd=s,null}function Dv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Zs()){case qi:return 2;case Bi:return 8;case os:case Po:return 32;case jr:return 268435456;default:return 32}default:return 32}}var _m=!1,pr=null,gr=null,yr=null,tu=new Map,nu=new Map,vr=[],kC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pv(s,r){switch(s){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":yr=null;break;case"pointerover":case"pointerout":tu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(r.pointerId)}}function su(s,r,a,c,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:_,targetContainers:[v]},r!==null&&(r=Gn(r),r!==null&&Rv(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,v!==null&&r.indexOf(v)===-1&&r.push(v),s)}function VC(s,r,a,c,v){switch(r){case"focusin":return pr=su(pr,s,r,a,c,v),!0;case"dragenter":return gr=su(gr,s,r,a,c,v),!0;case"mouseover":return yr=su(yr,s,r,a,c,v),!0;case"pointerover":var _=v.pointerId;return tu.set(_,su(tu.get(_)||null,s,r,a,c,v)),!0;case"gotpointercapture":return _=v.pointerId,nu.set(_,su(nu.get(_)||null,s,r,a,c,v)),!0}return!1}function kv(s){var r=Is(s.target);if(r!==null){var a=l(r);if(a!==null){if(r=a.tag,r===13){if(r=u(a),r!==null){s.blockedOn=r,as(s.priority,function(){Mv(a)});return}}else if(r===31){if(r=f(a),r!==null){s.blockedOn=r,as(s.priority,function(){Mv(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function id(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var a=ym(s.nativeEvent);if(a===null){a=s.nativeEvent;var c=new a.constructor(a.type,a);gl=c,a.target.dispatchEvent(c),gl=null}else return r=Gn(a),r!==null&&Rv(r),s.blockedOn=a,!1;r.shift()}return!0}function Vv(s,r,a){id(s)&&a.delete(r)}function LC(){_m=!1,pr!==null&&id(pr)&&(pr=null),gr!==null&&id(gr)&&(gr=null),yr!==null&&id(yr)&&(yr=null),tu.forEach(Vv),nu.forEach(Vv)}function rd(s,r){s.blockedOn===r&&(s.blockedOn=null,_m||(_m=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,LC)))}var od=null;function Lv(s){od!==s&&(od=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){od===s&&(od=null);for(var r=0;r<s.length;r+=3){var a=s[r],c=s[r+1],v=s[r+2];if(typeof c!="function"){if(vm(c||a)===null)continue;break}var _=Gn(a);_!==null&&(s.splice(r,3),r-=3,yh(_,{pending:!0,data:v,method:a.method,action:c},c,v))}}))}function Ta(s){function r(U){return rd(U,s)}pr!==null&&rd(pr,s),gr!==null&&rd(gr,s),yr!==null&&rd(yr,s),tu.forEach(r),nu.forEach(r);for(var a=0;a<vr.length;a++){var c=vr[a];c.blockedOn===s&&(c.blockedOn=null)}for(;0<vr.length&&(a=vr[0],a.blockedOn===null);)kv(a),a.blockedOn===null&&vr.shift();if(a=(s.ownerDocument||s).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var v=a[c],_=a[c+1],A=v[tn]||null;if(typeof _=="function")A||Lv(a);else if(A){var I=null;if(_&&_.hasAttribute("formAction")){if(v=_,A=_[tn]||null)I=A.formAction;else if(vm(v)!==null)continue}else I=A.action;typeof I=="function"?a[c+1]=I:(a.splice(c,3),c-=3),Lv(a)}}}function Uv(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(A){return v=A})},focusReset:"manual",scroll:"manual"})}function r(){v!==null&&(v(),v=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),v!==null&&(v(),v=null)}}}function Tm(s){this._internalRoot=s}ad.prototype.render=Tm.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var a=r.current,c=Bn();Iv(a,c,s,r,null,null)},ad.prototype.unmount=Tm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Iv(s.current,2,null,s,null,null),qc(),r[Cs]=null}};function ad(s){this._internalRoot=s}ad.prototype.unstable_scheduleHydration=function(s){if(s){var r=qu();s={blockedOn:null,target:s,priority:r};for(var a=0;a<vr.length&&r!==0&&r<vr[a].priority;a++);vr.splice(a,0,s),a===0&&kv(s)}};var Ov=e.version;if(Ov!=="19.2.0")throw Error(i(527,Ov,"19.2.0"));W.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?T(s):null,s=s===null?null:s.stateNode,s};var UC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ld.isDisabled&&ld.supportsFiber)try{he=ld.inject(UC),Te=ld}catch{}}return ru.createRoot=function(s,r){if(!o(s))throw Error(i(299));var a=!1,c="",v=Gy,_=$y,A=Yy;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(v=r.onUncaughtError),r.onCaughtError!==void 0&&(_=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=Cv(s,1,!1,null,null,a,c,null,v,_,A,Uv),s[Cs]=r.current,tm(s),new Tm(r)},ru.hydrateRoot=function(s,r,a){if(!o(s))throw Error(i(299));var c=!1,v="",_=Gy,A=$y,I=Yy,U=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onUncaughtError!==void 0&&(_=a.onUncaughtError),a.onCaughtError!==void 0&&(A=a.onCaughtError),a.onRecoverableError!==void 0&&(I=a.onRecoverableError),a.formState!==void 0&&(U=a.formState)),r=Cv(s,1,!0,r,a??null,c,v,U,_,A,I,Uv),r.context=wv(null),a=r.current,c=Bn(),c=zr(c),v=sr(c),v.callback=null,ir(a,v,c),a=c,r.current.lanes=a,qr(r,a),Bs(r),s[Cs]=r.current,tm(s),new ad(r)},ru.version="19.2.0",ru}var Jv;function YC(){if(Jv)return bm.exports;Jv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bm.exports=$C(),bm.exports}var JC=YC();const KC=qx(JC),QC=({darkMode:n,onToggle:e})=>d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🌙":"☀️"})]}),XC={ar:{"app.title":"لوحة التحكم المالية | MASROF","developed.by":"Developed by K.A Team","add.transaction":"إضافة حركة",logout:"خروج","dark.mode":"الوضع المظلم",notifications:"الإشعارات","enable.notifications":"تفعيل الإشعارات",language:"العربية","tab.summary":"الملخص","tab.analysis":"التحليل","tab.transactions":"الحركات","tab.budget":"الميزانية","tab.investment":"الاستثمار","tab.ai.assistant":"المحلل الذكي","tab.settings":"الإعدادات","tab.cards":"إدارة البطاقات","tab.bank":"البنك","tab.installments":"الأقساط","tab.debts.loans":"الديون والقروض","card.debts.summary":"ملخص ديون البطاقات","card.bank.accounts":"ملخص الحسابات البنكية","card.financial.report":"تقرير مالي شامل","card.categories.summary":"ملخص الفئات",due:"المستحق",remaining:"المتبقي","total.debts":"إجمالي الديون","total.available":"إجمالي المتاح",deposits:"الإيداعات",withdrawals:"السحوبات","total.bank.balances":"إجمالي الأرصدة البنكية","total.income":"إجمالي الدخل","total.expenses":"إجمالي المصاريف",net:"الصافي",rent:"إيجار",groceries:"مواد تموينية",shopping:"تسوق",bills:"سداد فواتير",restaurants:"مطاعم",transport:"مواصلات",entertainment:"ترفيه",health:"صحة",education:"تعليم",other:"أخرى","al.ahli.snb":"الأهلي SNB","emirates.enbd":"الإمارات ENBD","al.ahli.bank":"البنك الاهلي","arab.bank":"البنك العربي",add:"إضافة",edit:"تعديل",delete:"حذف",save:"حفظ",cancel:"إلغاء",confirm:"تأكيد",close:"إغلاق",search:"بحث",filter:"تصفية",export:"تصدير",import:"استيراد",active:"نشط",inactive:"غير نشط",pending:"معلق",completed:"مكتمل",cancelled:"ملغي",january:"يناير",february:"فبراير",march:"مارس",april:"أبريل",may:"مايو",june:"يونيو",july:"يوليو",august:"أغسطس",september:"سبتمبر",october:"أكتوبر",november:"نوفمبر",december:"ديسمبر",sunday:"الأحد",monday:"الاثنين",tuesday:"الثلاثاء",wednesday:"الأربعاء",thursday:"الخميس",friday:"الجمعة",saturday:"السبت",sar:"ريال سعودي",usd:"دولار أمريكي",eur:"يورو",aed:"درهم إماراتي",today:"اليوم",yesterday:"أمس","this.week":"هذا الأسبوع","this.month":"هذا الشهر","this.year":"هذا العام","last.week":"الأسبوع الماضي","last.month":"الشهر الماضي","last.year":"العام الماضي",success:"نجح",error:"خطأ",warning:"تحذير",info:"معلومات",loading:"جاري التحميل...","no.data":"لا توجد بيانات","try.again":"حاول مرة أخرى","required.field":"هذا الحقل مطلوب","invalid.email":"البريد الإلكتروني غير صحيح","invalid.amount":"المبلغ غير صحيح","invalid.date":"التاريخ غير صحيح","debt.to.me":"ديون لي","debt.from.me":"ديون علي",loans:"قروض","add.debt":"إضافة دين","add.loan":"إضافة قرض",debtor:"المدين",creditor:"الدائن",lender:"المقرض",amount:"المبلغ",description:"الوصف",date:"التاريخ",status:"الحالة",source:"المصدر",reason:"السبب",installments:"أقساط","paid.installments":"أقساط مدفوعة","remaining.installments":"أقساط متبقية","next.payment":"الدفعة التالية","payment.date":"تاريخ الدفع","installment.amount":"مبلغ القسط","total.amount":"المبلغ الإجمالي",investment:"استثمار","current.value":"القيمة الحالية","initial.investment":"الاستثمار الأولي","profit.loss":"الربح/الخسارة","return.rate":"معدل العائد",budget:"ميزانية","budget.limit":"حد الميزانية",spent:"مصروف","remaining.budget":"الميزانية المتبقية","over.budget":"تجاوز الميزانية",reports:"تقارير","financial.report":"تقرير مالي","monthly.report":"تقرير شهري","yearly.report":"تقرير سنوي","category.report":"تقرير الفئات","income.report":"تقرير الدخل","expense.report":"تقرير المصروفات",settings:"الإعدادات",profile:"الملف الشخصي",account:"الحساب",privacy:"الخصوصية",security:"الأمان",backup:"نسخ احتياطي",restore:"استعادة","export.data":"تصدير البيانات","import.data":"استيراد البيانات","ai.assistant":"المساعد الذكي","ask.question":"اسأل سؤال","get.advice":"احصل على نصيحة","analyze.data":"تحليل البيانات","generate.report":"توليد تقرير",notification:"إشعار","payment.reminder":"تذكير دفع","budget.alert":"تنبيه الميزانية","low.balance":"رصيد منخفض","payment.due":"دفعة مستحقة","network.error":"خطأ في الشبكة","server.error":"خطأ في الخادم","auth.error":"خطأ في المصادقة","permission.error":"خطأ في الصلاحية","validation.error":"خطأ في التحقق","unknown.error":"خطأ غير معروف",details:"التفاصيل","cannot.delete":"لا يمكن الحذف","cannot.delete.category":"لا يمكن حذف هذه الفئة لأنها مستخدمة في بعض الحركات","cannot.delete.transaction.type":"لا يمكن حذف نوع الحركة هذا لأنه مستخدم في بعض الحركات","cannot.delete.payment.method":"لا يمكن حذف وسيلة الدفع هذه لأنها مستخدمة في بعض الحركات","restore.backup":"استعادة نسخة احتياطية","confirm.restore":"هل أنت متأكد؟ سيتم الكتابة فوق جميع بياناتك الحالية","api.status":"حالة مفاتيح API"},en:{"app.title":"Financial Dashboard | MASROF","developed.by":"Developed by K.A Team","add.transaction":"Add Transaction",logout:"Logout","dark.mode":"Dark Mode",notifications:"Notifications","enable.notifications":"Enable Notifications",language:"English","tab.summary":"Summary","tab.analysis":"Analysis","tab.transactions":"Transactions","tab.budget":"Budget","tab.investment":"Investment","tab.ai.assistant":"AI Assistant","tab.settings":"Settings","tab.cards":"Card Management","tab.bank":"Bank","tab.installments":"Installments","tab.debts.loans":"Debts & Loans","card.debts.summary":"Card Debts Summary","card.bank.accounts":"Bank Accounts Summary","card.financial.report":"Comprehensive Financial Report","card.categories.summary":"Categories Summary",due:"Due",remaining:"Remaining","total.debts":"Total Debts","total.available":"Total Available",deposits:"Deposits",withdrawals:"Withdrawals","total.bank.balances":"Total Bank Balances","total.income":"Total Income","total.expenses":"Total Expenses",net:"Net",rent:"Rent",groceries:"Groceries",shopping:"Shopping",bills:"Bill Payments",restaurants:"Restaurants",transport:"Transport",entertainment:"Entertainment",health:"Health",education:"Education",other:"Other","al.ahli.snb":"Al Ahli SNB","emirates.enbd":"Emirates ENBD","al.ahli.bank":"Al Ahli Bank","arab.bank":"Arab Bank",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",confirm:"Confirm",close:"Close",search:"Search",filter:"Filter",export:"Export",import:"Import",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",cancelled:"Cancelled",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",sunday:"Sunday",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sar:"Saudi Riyal",usd:"US Dollar",eur:"Euro",aed:"UAE Dirham",today:"Today",yesterday:"Yesterday","this.week":"This Week","this.month":"This Month","this.year":"This Year","last.week":"Last Week","last.month":"Last Month","last.year":"Last Year",success:"Success",error:"Error",warning:"Warning",info:"Info",loading:"Loading...","no.data":"No Data","try.again":"Try Again","required.field":"This field is required","invalid.email":"Invalid email address","invalid.amount":"Invalid amount","invalid.date":"Invalid date","debt.to.me":"Debts to Me","debt.from.me":"Debts from Me",loans:"Loans","add.debt":"Add Debt","add.loan":"Add Loan",debtor:"Debtor",creditor:"Creditor",lender:"Lender",amount:"Amount",description:"Description",date:"Date",status:"Status",source:"Source",reason:"Reason",installments:"Installments","paid.installments":"Paid Installments","remaining.installments":"Remaining Installments","next.payment":"Next Payment","payment.date":"Payment Date","installment.amount":"Installment Amount","total.amount":"Total Amount",investment:"Investment","current.value":"Current Value","initial.investment":"Initial Investment","profit.loss":"Profit/Loss","return.rate":"Return Rate",budget:"Budget","budget.limit":"Budget Limit",spent:"Spent","remaining.budget":"Remaining Budget","over.budget":"Over Budget",reports:"Reports","financial.report":"Financial Report","monthly.report":"Monthly Report","yearly.report":"Yearly Report","category.report":"Category Report","income.report":"Income Report","expense.report":"Expense Report",settings:"Settings",profile:"Profile",account:"Account",privacy:"Privacy",security:"Security",backup:"Backup",restore:"Restore","export.data":"Export Data","import.data":"Import Data","ai.assistant":"AI Assistant","ask.question":"Ask Question","get.advice":"Get Advice","analyze.data":"Analyze Data","generate.report":"Generate Report",notification:"Notification","payment.reminder":"Payment Reminder","budget.alert":"Budget Alert","low.balance":"Low Balance","payment.due":"Payment Due","network.error":"Network Error","server.error":"Server Error","auth.error":"Authentication Error","permission.error":"Permission Error","validation.error":"Validation Error","unknown.error":"Unknown Error",details:"Details","cannot.delete":"Cannot Delete","cannot.delete.category":"Cannot delete this category as it is used in some transactions","cannot.delete.transaction.type":"Cannot delete this transaction type as it is used in some transactions","cannot.delete.payment.method":"Cannot delete this payment method as it is used in some transactions","restore.backup":"Restore Backup","confirm.restore":"Are you sure? This will overwrite all your current data","api.status":"API Keys Status"}},se=(n,e="ar")=>XC[e][n]||n,WC=({notifications:n,onToggle:e,language:t="ar"})=>{const[i,o]=de.useState("default");de.useEffect(()=>{"Notification"in window&&o(Notification.permission)},[]);const l=async()=>{if("Notification"in window){const u=await Notification.requestPermission();o(u)}};return d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"text-sm font-medium",children:se("notifications",t)}),d.jsxs("button",{onClick:e,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${n?"bg-blue-600":"bg-slate-200"}`,children:[d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n?"translate-x-6":"translate-x-1"}`}),d.jsx("span",{className:"absolute left-1 top-1 text-xs",children:n?"🔔":"🔕"})]}),i!=="granted"&&n&&d.jsx("button",{onClick:l,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:se("enable.notifications",t)})]})},ud=()=>({transactions:[],categories:[{id:"cat-1",name:"بقالة",icon:"🛒"},{id:"cat-2",name:"مطاعم",icon:"🍔"},{id:"cat-3",name:"وقود",icon:"⛽"},{id:"cat-4",name:"فواتير",icon:"🧾"},{id:"cat-9",name:"سداد فواتير",icon:"💳"},{id:"cat-5",name:"تسوق",icon:"🛍️"},{id:"cat-6",name:"إيجار",icon:"🏠"},{id:"cat-8",name:"صيدلية",icon:"💊"},{id:"cat-7",name:"أخرى",icon:"💸"}],installments:[],investments:{currentValue:0},cards:{"snb-card":{id:"snb-card",name:"SNB الأهلي",limit:26e3,dueDay:15,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]},"enbd-card":{id:"enbd-card",name:"ENBD الإمارات",limit:1e4,dueDay:18,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}},bankAccounts:{"bank-default":{id:"bank-default",name:"حساب البنك",balance:0,currency:"SAR",smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}},loans:{},debtsToMe:{},debtsFromMe:{},settings:{darkMode:!1,language:"ar",notifications:!0}});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let ZC,ew;function tw(){return{geminiUrl:ZC,vertexUrl:ew}}function nw(n,e,t,i){var o,l;if(!(n!=null&&n.baseUrl)){const u=tw();return e?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(l=u.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class So{}function Ae(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const l=e[o];return l!=null?String(l):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function y(n,e,t){for(let l=0;l<e.length-1;l++){const u=e[l];if(u.endsWith("[]")){const f=u.slice(0,-2);if(!(f in n))if(Array.isArray(t))n[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[f])){const g=n[f];if(Array.isArray(t))for(let m=0;m<g.length;m++){const T=g[m];y(T,e.slice(l+1),t[m])}else for(const m of g)y(m,e.slice(l+1),t)}return}else if(u.endsWith("[0]")){const f=u.slice(0,-3);f in n||(n[f]=[{}]);const g=n[f];y(g[0],e.slice(l+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(l in n){const u=n[l];return Array.isArray(u)?u.map(f=>h(f,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ip(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sw(n){const e={},t=h(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function iw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],ow(u)),e}function rw(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],aw(u)),e}function ow(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>lw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function aw(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>uw(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function lw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],fw(t)),e}function uw(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],hw(t)),e}function cw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function dw(n){const e={},t=h(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function fw(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Ip(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function hw(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Ip(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kv||(Kv={}));var Qv;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Qv||(Qv={}));var xr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(xr||(xr={}));var Xv;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Xv||(Xv={}));var Wv;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Wv||(Wv={}));var Zv;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Zv||(Zv={}));var e_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(e_||(e_={}));var t_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(t_||(t_={}));var n_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(n_||(n_={}));var s_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(s_||(s_={}));var i_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(i_||(i_={}));var r_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(r_||(r_={}));var o_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(o_||(o_={}));var a_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(a_||(a_={}));var l_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(l_||(l_={}));var Nd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Nd||(Nd={}));var u_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(u_||(u_={}));var Gm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Gm||(Gm={}));var c_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(c_||(c_={}));var d_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(d_||(d_={}));var f_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V"})(f_||(f_={}));var h_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(h_||(h_={}));var m_;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(m_||(m_={}));var p_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(p_||(p_={}));var g_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(g_||(g_={}));var y_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(y_||(y_={}));var v_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(v_||(v_={}));var __;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(__||(__={}));var T_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(T_||(T_={}));var x_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(x_||(x_={}));var E_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(E_||(E_={}));var b_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(b_||(b_={}));var A_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(A_||(A_={}));var S_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(S_||(S_={}));var C_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(C_||(C_={}));var w_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(w_||(w_={}));var I_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(I_||(I_={}));var N_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(N_||(N_={}));var R_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(R_||(R_={}));var M_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(M_||(M_={}));var D_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(D_||(D_={}));var P_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(P_||(P_={}));var k_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(k_||(k_={}));var V_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(V_||(V_={}));var L_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(L_||(L_={}));var U_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(U_||(U_={}));var O_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(O_||(O_={}));var j_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(j_||(j_={}));var Sa;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Sa||(Sa={}));class $m{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ou{get text(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",T=!1;const x=[];for(const b of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[w,L]of Object.entries(b))w!=="text"&&w!=="thought"&&(L!==null||L!==void 0)&&x.push(w);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;T=!0,m+=b.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),T?m:void 0}get data(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const T=[];for(const x of(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&g!==void 0?g:[]){for(const[b,w]of Object.entries(x))b!=="inlineData"&&(w!==null||w!==void 0)&&T.push(b);x.inlineData&&typeof x.inlineData.data=="string"&&(m+=atob(x.inlineData.data))}return T.length>0&&console.warn(`there are non-data parts ${T} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var e,t,i,o,l,u,f,g;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(T=>T.functionCall).map(T=>T.functionCall).filter(T=>T!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var e,t,i,o,l,u,f,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var e,t,i,o,l,u,f,g,m;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const T=(g=(f=(u=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||g===void 0?void 0:g.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((T==null?void 0:T.length)!==0)return(m=T==null?void 0:T[0])===null||m===void 0?void 0:m.output}}class F_{}class q_{}class mw{}class pw{}class gw{}class yw{}class B_{}class z_{}class H_{}class vw{}class Rd{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const i=new Rd;let o;const l=e;return t?o=rw(l):o=iw(l),Object.assign(i,o),i}}class G_{}class $_{}class Y_{}class _w{}class Tw{}class xw{}class J_{}class Ew{get text(){var e,t,i;let o="",l=!1;const u=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,m]of Object.entries(f))g!=="text"&&g!=="thought"&&m!==null&&u.push(g);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;l=!0,o+=f.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?o:void 0}get data(){var e,t,i;let o="";const l=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,g]of Object.entries(u))f!=="inlineData"&&g!==null&&l.push(f);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class bw{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function at(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Bx(n,e){const t=at(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function zx(n){return Array.isArray(n)?n.map(e=>Md(e)):[Md(n)]}function Md(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Hx(n){const e=Md(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Gx(n){const e=Md(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function K_(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function $x(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>K_(e)):[K_(n)]}function Ym(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Q_(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function X_(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function vn(n){if(n==null)throw new Error("ContentUnion is required");return Ym(n)?n:{role:"user",parts:$x(n)}}function Np(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=vn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=vn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>vn(t)):[vn(e)]}function rs(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(Q_(n)||X_(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[vn(n)]}const e=[],t=[],i=Ym(n[0]);for(const o of n){const l=Ym(o);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(o);else{if(Q_(o)||X_(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:$x(t)}),e}function Aw(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(xr).includes(t[0].toUpperCase())?t[0].toUpperCase():xr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(xr).includes(i.toUpperCase())?i.toUpperCase():xr.TYPE_UNSPECIFIED})}}function Ia(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&Aw(n.type,e);for(const[u,f]of Object.entries(n))if(f!=null)if(u=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(xr).includes(f.toUpperCase())?f.toUpperCase():xr.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Ia(f);else if(i.includes(u)){const g=[];for(const m of f){if(m.type=="null"){e.nullable=!0;continue}g.push(Ia(m))}e[u]=g}else if(o.includes(u)){const g={};for(const[m,T]of Object.entries(f))g[m]=Ia(T);e[u]=g}else{if(u==="additionalProperties")continue;e[u]=f}return e}function Rp(n){return Ia(n)}function Mp(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Dp(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function $a(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ia(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ia(e.response));return n}function Ya(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Sw(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Oi(n,e){if(typeof e!="string")throw new Error("name must be a string");return Sw(n,e,"cachedContents")}function Yx(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Vr(n){return Ip(n)}function Cw(n){return n!=null&&typeof n=="object"&&"name"in n}function ww(n){return n!=null&&typeof n=="object"&&"video"in n}function Iw(n){return n!=null&&typeof n=="object"&&"uri"in n}function Jx(n){var e;let t;if(Cw(n)&&(t=n.name),!(Iw(n)&&(t=n.uri,t===void 0))&&!(ww(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Kx(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Qx(n){for(const e of["models","tunedModels","publisherModels"])if(Nw(n,e))return n[e];return[]}function Nw(n,e){return n!==null&&typeof n=="object"&&e in n}function Rw(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Mw(n,e={}){const t=[],i=new Set;for(const o of n){const l=o.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const u=Rw(o,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function Xx(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Dw(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Wx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let l=!1;for(const u of o){if(typeof u!="object"||u===null)continue;const g=u.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Ja(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Zx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pw(n){const e={},t=h(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>uI(u))),y(e,["inlinedResponses"],l)}const o=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["inlinedEmbedContentResponses"],l)}return e}function kw(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigqueryDestination","outputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Vw(n){const e={},t=h(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigqueryDestination","outputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function au(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["metadata","state"]);o!=null&&y(e,["state"],Zx(o));const l=h(n,["metadata","createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["metadata","endTime"]);u!=null&&y(e,["endTime"],u);const f=h(n,["metadata","updateTime"]);f!=null&&y(e,["updateTime"],f);const g=h(n,["metadata","model"]);g!=null&&y(e,["model"],g);const m=h(n,["metadata","output"]);return m!=null&&y(e,["dest"],Pw(Wx(m))),e}function Jm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],Zx(o));const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["createTime"]);u!=null&&y(e,["createTime"],u);const f=h(n,["startTime"]);f!=null&&y(e,["startTime"],f);const g=h(n,["endTime"]);g!=null&&y(e,["endTime"],g);const m=h(n,["updateTime"]);m!=null&&y(e,["updateTime"],m);const T=h(n,["model"]);T!=null&&y(e,["model"],T);const x=h(n,["inputConfig"]);x!=null&&y(e,["src"],Lw(x));const b=h(n,["outputConfig"]);return b!=null&&y(e,["dest"],kw(Wx(b))),e}function Lw(n){const e={},t=h(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const o=h(n,["bigquerySource","inputUri"]);return o!=null&&y(e,["bigqueryUri"],o),e}function Uw(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&y(t,["fileName"],i);const o=h(e,["inlinedRequests"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>lI(n,u))),y(t,["requests","requests"],l)}return t}function Ow(n){const e={},t=h(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&y(e,["bigquerySource","inputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function jw(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Fw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function qw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function Bw(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],zw(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=h(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const x=h(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function zw(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function eE(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>gI(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function Hw(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Gw(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["dest"]);return e!==void 0&&o!=null&&y(e,["outputConfig"],Vw(Dw(o))),t}function W_(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],Uw(n,Xx(n,o)));const l=h(e,["config"]);return l!=null&&Hw(l,t),t}function $w(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],at(n,i));const o=h(e,["src"]);o!=null&&y(t,["inputConfig"],Ow(Xx(n,o)));const l=h(e,["config"]);return l!=null&&Gw(l,t),t}function Yw(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function wm(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["src"]);o!=null&&y(t,["batch","inputConfig"],eI(n,o));const l=h(e,["config"]);return l!=null&&Yw(l,t),t}function Jw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function Kw(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function Qw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function Xw(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);return l!=null&&y(e,["error"],l),e}function Ww(n,e){const t={},i=h(e,["contents"]);if(i!=null){let l=Np(n,i);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["requests[]","request","content"],l)}const o=h(e,["config"]);return o!=null&&y(t,["_self"],Zw(o,t)),t}function Zw(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function eI(n,e){const t={},i=h(e,["fileName"]);i!=null&&y(t,["file_name"],i);const o=h(e,["inlinedRequests"]);return o!=null&&y(t,["requests"],Ww(n,o)),t}function tI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function nI(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],eE(vn(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const L=h(e,["frequencyPenalty"]);L!=null&&y(i,["frequencyPenalty"],L);const k=h(e,["seed"]);k!=null&&y(i,["seed"],k);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const Y=h(e,["responseSchema"]);Y!=null&&y(i,["responseSchema"],Rp(Y));const O=h(e,["responseJsonSchema"]);if(O!=null&&y(i,["responseJsonSchema"],O),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const B=h(e,["safetySettings"]);if(t!==void 0&&B!=null){let F=B;Array.isArray(F)&&(F=F.map(P=>yI(P))),y(t,["safetySettings"],F)}const ne=h(e,["tools"]);if(t!==void 0&&ne!=null){let F=Ya(ne);Array.isArray(F)&&(F=F.map(P=>vI($a(P)))),y(t,["tools"],F)}const ie=h(e,["toolConfig"]);if(t!==void 0&&ie!=null&&y(t,["toolConfig"],ie),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],Oi(n,H));const N=h(e,["responseModalities"]);N!=null&&y(i,["responseModalities"],N);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const R=h(e,["speechConfig"]);if(R!=null&&y(i,["speechConfig"],Mp(R)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=h(e,["thinkingConfig"]);M!=null&&y(i,["thinkingConfig"],M);const V=h(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function sI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>Bw(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=h(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function iI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function rI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Ja(n,i)),t}function oI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function aI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function lI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["request","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let f=rs(o);Array.isArray(f)&&(f=f.map(g=>eE(g))),y(t,["request","contents"],f)}const l=h(e,["metadata"]);l!=null&&y(t,["metadata"],l);const u=h(e,["config"]);return u!=null&&y(t,["request","generationConfig"],nI(n,u,h(t,["request"],{}))),t}function uI(n){const e={},t=h(n,["response"]);t!=null&&y(e,["response"],sI(t));const i=h(n,["error"]);return i!=null&&y(e,["error"],i),e}function cI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);if(e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function dI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function fI(n){const e={},t=h(n,["config"]);return t!=null&&cI(t,e),e}function hI(n){const e={},t=h(n,["config"]);return t!=null&&dI(t,e),e}function mI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["operations"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>au(u))),y(e,["batchJobs"],l)}return e}function pI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["batchPredictionJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Jm(u))),y(e,["batchJobs"],l)}return e}function gI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],jw(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],tI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function yI(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function vI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],aI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],oI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(vo||(vo={}));class wu{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(l=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _I extends So{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{var i,o;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(t.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(t);const f=this.createInlinedEmbedContentRequest(t),g=f.path,m=f.body,T=wm(this.apiClient,t)._query||{};return this.apiClient.request({path:g,queryParams:T,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(b=>b.json()).then(b=>au(b))},this.list=async(t={})=>new wu(vo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=W_(this.apiClient,e),i=t._url,o=Ae("{model}:batchGenerateContent",i),f=t.batch.inputConfig.requests,g=f.requests,m=[];for(const T of g){const x=Object.assign({},T);if(x.systemInstruction){const b=x.systemInstruction;delete x.systemInstruction;const w=x.request;w.systemInstruction=b,x.request=w}m.push(x)}return f.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}createInlinedEmbedContentRequest(e){const t=wm(this.apiClient,e),i=t._url,o=Ae("{model}:asyncBatchEmbedContent",i),f=t.batch.inputConfig.requests,g=f.requests,m=[];delete f.config;for(const T of g){const x=Object.assign({},T),b=x.request;for(const w in x)w!=="request"&&(b[w]=x[w],delete x[w]);m.push(x)}return f.requests=m,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const l=this.getGcsUri(e),u=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${o}`;else if(u)i.dest=`${u}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=$w(this.apiClient,e);return f=Ae("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=W_(this.apiClient,e);return f=Ae("{model}:batchGenerateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>au(T))}}async createEmbeddingsInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=wm(this.apiClient,e);return l=Ae("{model}:asyncBatchEmbedContent",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>au(g))}}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=rI(this.apiClient,e);return f=Ae("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Jm(T))}else{const m=iI(this.apiClient,e);return f=Ae("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>au(T))}}async cancel(e){var t,i,o,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=qw(this.apiClient,e);u=Ae("batchPredictionJobs/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=Fw(this.apiClient,e);u=Ae("batches/{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=hI(e);return f=Ae("batchPredictionJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=pI(T),b=new J_;return Object.assign(b,x),b})}else{const m=fI(e);return f=Ae("batches",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=mI(T),b=new J_;return Object.assign(b,x),b})}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=Kw(this.apiClient,e);return f=Ae("batchPredictionJobs/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Xw(T))}else{const m=Jw(this.apiClient,e);return f=Ae("batches/{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Qw(T))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Z_(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>qI(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function xI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let T=rs(u);Array.isArray(T)&&(T=T.map(x=>Z_(x))),y(e,["contents"],T)}const f=h(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],Z_(vn(f)));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let T=g;Array.isArray(T)&&(T=T.map(x=>BI(x))),y(e,["tools"],T)}const m=h(n,["toolConfig"]);if(e!==void 0&&m!=null&&y(e,["toolConfig"],m),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function EI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&y(e,["expireTime"],o);const l=h(n,["displayName"]);e!==void 0&&l!=null&&y(e,["displayName"],l);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let x=rs(u);Array.isArray(x)&&(x=x.map(b=>b)),y(e,["contents"],x)}const f=h(n,["systemInstruction"]);e!==void 0&&f!=null&&y(e,["systemInstruction"],vn(f));const g=h(n,["tools"]);if(e!==void 0&&g!=null){let x=g;Array.isArray(x)&&(x=x.map(b=>zI(b))),y(e,["tools"],x)}const m=h(n,["toolConfig"]);e!==void 0&&m!=null&&y(e,["toolConfig"],m);const T=h(n,["kmsKeyName"]);return e!==void 0&&T!=null&&y(e,["encryption_spec","kmsKeyName"],T),t}function bI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],Bx(n,i));const o=h(e,["config"]);return o!=null&&xI(o,t),t}function AI(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["model"],Bx(n,i));const o=h(e,["config"]);return o!=null&&EI(o,t),t}function SI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Oi(n,i)),t}function CI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Oi(n,i)),t}function wI(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function II(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function NI(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function RI(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function MI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Oi(n,i)),t}function DI(n,e){const t={},i=h(e,["name"]);return i!=null&&y(t,["_url","name"],Oi(n,i)),t}function PI(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function kI(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function VI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function LI(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function UI(n){const e={},t=h(n,["config"]);return t!=null&&VI(t,e),e}function OI(n){const e={},t=h(n,["config"]);return t!=null&&LI(t,e),e}function jI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function FI(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["cachedContents"],l)}return e}function qI(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],TI(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],NI(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function BI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],kI(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],PI(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function zI(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>RI(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function HI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function GI(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&y(e,["expireTime"],o),t}function $I(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],Oi(n,i));const o=h(e,["config"]);return o!=null&&HI(o,t),t}function YI(n,e){const t={},i=h(e,["name"]);i!=null&&y(t,["_url","name"],Oi(n,i));const o=h(e,["config"]);return o!=null&&GI(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JI extends So{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wu(vo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=AI(this.apiClient,e);return f=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=bI(this.apiClient,e);return f=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=DI(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=MI(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=CI(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=II(T),b=new $_;return Object.assign(b,x),b})}else{const m=SI(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=wI(T),b=new $_;return Object.assign(b,x),b})}}async update(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=YI(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>T)}else{const m=$I(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>T)}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=OI(e);return f=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=FI(T),b=new Y_;return Object.assign(b,x),b})}else{const m=UI(e);return f=Ae("cachedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=jI(T),b=new Y_;return Object.assign(b,x),b})}}}function eT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function At(n){return this instanceof At?(this.v=n,this):new At(n)}function Na(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(w){return function(L){return Promise.resolve(L).then(w,x)}}function f(w,L){i[w]&&(o[w]=function(k){return new Promise(function(j,Y){l.push([w,k,j,Y])>1||g(w,k)})},L&&(o[w]=L(o[w])))}function g(w,L){try{m(i[w](L))}catch(k){b(l[0][3],k)}}function m(w){w.value instanceof At?Promise.resolve(w.value.v).then(T,x):b(l[0][2],w)}function T(w){g("next",w)}function x(w){g("throw",w)}function b(w,L){w(L),l.shift(),l.length&&g(l[0][0],l[0][1])}}function hu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof eT=="function"?eT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(u){return new Promise(function(f,g){u=n[l](u),o(f,g,u.done,u.value)})}}function o(l,u,f,g){Promise.resolve(g).then(function(m){l({value:m,done:f})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KI(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:tE(t)}function tE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function QI(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function tT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let l=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),l&&!tE(n[i])&&(l=!1),i++;l?e.push(...o):e.pop()}return e}class XI{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new WI(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class WI{constructor(e,t,i,o={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=l,this.sendPromise=Promise.resolve(),QI(l)}async sendMessage(e){var t;await this.sendPromise;const i=vn(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,u,f;const g=await o,m=(u=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.content,T=g.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let b=[];T!=null&&(b=(f=T.slice(x))!==null&&f!==void 0?f:[]);const w=m?[m]:[];this.recordHistory(i,w,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=vn(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const l=await o;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?tT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,o;return Na(this,arguments,function*(){var u,f,g,m;const T=[];try{for(var x=!0,b=hu(e),w;w=yield At(b.next()),u=w.done,!u;x=!0){m=w.value,x=!1;const L=m;if(KI(L)){const k=(o=(i=L.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;k!==void 0&&T.push(k)}yield yield At(L)}}catch(L){f={error:L}}finally{try{!x&&!u&&(g=b.return)&&(yield At(g.call(b)))}finally{if(f)throw f.error}}this.recordHistory(t,T)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(l=>l.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...tT(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Zd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZI(n){const e={},t=h(n,["file"]);return t!=null&&y(e,["file"],t),e}function eN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function tN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],Jx(t)),e}function nN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function sN(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","file"],Jx(t)),e}function iN(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&y(e,["_query","pageToken"],o),t}function rN(n){const e={},t=h(n,["config"]);return t!=null&&iN(t,e),e}function oN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["files"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aN extends So{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wu(vo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=rN(e);return l=Ae("files",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=oN(g),T=new _w;return Object.assign(T,m),T})}}async createInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=ZI(e);return l=Ae("upload/v1beta/files",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=eN(g),T=new Tw;return Object.assign(T,m),T})}}async get(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=sN(e);return l=Ae("files/{file}",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async delete(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=tN(e);return l=Ae("files/{file}",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=nN(g),T=new xw;return Object.assign(T,m),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _d(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function lN(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>bN(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function uN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function cN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function dN(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=h(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const x=h(n,["responseJsonSchema"]);x!=null&&y(e,["responseJsonSchema"],x);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=h(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const L=h(n,["responseModalities"]);L!=null&&y(e,["responseModalities"],L);const k=h(n,["responseSchema"]);k!=null&&y(e,["responseSchema"],k);const j=h(n,["routingConfig"]);j!=null&&y(e,["routingConfig"],j);const Y=h(n,["seed"]);Y!=null&&y(e,["seed"],Y);const O=h(n,["speechConfig"]);O!=null&&y(e,["speechConfig"],nE(O));const B=h(n,["stopSequences"]);B!=null&&y(e,["stopSequences"],B);const ne=h(n,["temperature"]);ne!=null&&y(e,["temperature"],ne);const ie=h(n,["thinkingConfig"]);ie!=null&&y(e,["thinkingConfig"],ie);const H=h(n,["topK"]);H!=null&&y(e,["topK"],H);const N=h(n,["topP"]);return N!=null&&y(e,["topP"],N),e}function fN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function hN(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function mN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],Dp(x));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const L=h(n,["systemInstruction"]);e!==void 0&&L!=null&&y(e,["setup","systemInstruction"],lN(vn(L)));const k=h(n,["tools"]);if(e!==void 0&&k!=null){let H=Ya(k);Array.isArray(H)&&(H=H.map(N=>SN($a(N)))),y(e,["setup","tools"],H)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],AN(j));const Y=h(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&y(e,["setup","inputAudioTranscription"],Y);const O=h(n,["outputAudioTranscription"]);e!==void 0&&O!=null&&y(e,["setup","outputAudioTranscription"],O);const B=h(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const ne=h(n,["contextWindowCompression"]);e!==void 0&&ne!=null&&y(e,["setup","contextWindowCompression"],ne);const ie=h(n,["proactivity"]);return e!==void 0&&ie!=null&&y(e,["setup","proactivity"],ie),t}function pN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],dN(i));const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],nE(Dp(x)));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const L=h(n,["systemInstruction"]);e!==void 0&&L!=null&&y(e,["setup","systemInstruction"],vn(L));const k=h(n,["tools"]);if(e!==void 0&&k!=null){let H=Ya(k);Array.isArray(H)&&(H=H.map(N=>CN($a(N)))),y(e,["setup","tools"],H)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],j);const Y=h(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&y(e,["setup","inputAudioTranscription"],Y);const O=h(n,["outputAudioTranscription"]);e!==void 0&&O!=null&&y(e,["setup","outputAudioTranscription"],O);const B=h(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const ne=h(n,["contextWindowCompression"]);e!==void 0&&ne!=null&&y(e,["setup","contextWindowCompression"],ne);const ie=h(n,["proactivity"]);return e!==void 0&&ie!=null&&y(e,["setup","proactivity"],ie),t}function gN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],at(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],mN(o,t)),t}function yN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],at(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],pN(o,t)),t}function vN(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function _N(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["weightedPrompts"],i)}return e}function TN(n){const e={},t=h(n,["media"]);if(t!=null){let m=zx(t);Array.isArray(m)&&(m=m.map(T=>_d(T))),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],_d(Gx(i)));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],_d(Hx(l)));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const f=h(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function xN(n){const e={},t=h(n,["media"]);if(t!=null){let m=zx(t);Array.isArray(m)&&(m=m.map(T=>T)),y(e,["mediaChunks"],m)}const i=h(n,["audio"]);i!=null&&y(e,["audio"],Gx(i));const o=h(n,["audioStreamEnd"]);o!=null&&y(e,["audioStreamEnd"],o);const l=h(n,["video"]);l!=null&&y(e,["video"],Hx(l));const u=h(n,["text"]);u!=null&&y(e,["text"],u);const f=h(n,["activityStart"]);f!=null&&y(e,["activityStart"],f);const g=h(n,["activityEnd"]);return g!=null&&y(e,["activityEnd"],g),e}function EN(n){const e={},t=h(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const o=h(n,["toolCall"]);o!=null&&y(e,["toolCall"],o);const l=h(n,["toolCallCancellation"]);l!=null&&y(e,["toolCallCancellation"],l);const u=h(n,["usageMetadata"]);u!=null&&y(e,["usageMetadata"],wN(u));const f=h(n,["goAway"]);f!=null&&y(e,["goAway"],f);const g=h(n,["sessionResumptionUpdate"]);return g!=null&&y(e,["sessionResumptionUpdate"],g),e}function bN(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],_d(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],uN(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function AN(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function nE(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function SN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],hN(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],fN(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function CN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>cN(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function wN(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const o=h(n,["candidatesTokenCount"]);o!=null&&y(e,["responseTokenCount"],o);const l=h(n,["toolUsePromptTokenCount"]);l!=null&&y(e,["toolUsePromptTokenCount"],l);const u=h(n,["thoughtsTokenCount"]);u!=null&&y(e,["thoughtsTokenCount"],u);const f=h(n,["totalTokenCount"]);f!=null&&y(e,["totalTokenCount"],f);const g=h(n,["promptTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(L=>L)),y(e,["promptTokensDetails"],w)}const m=h(n,["cacheTokensDetails"]);if(m!=null){let w=m;Array.isArray(w)&&(w=w.map(L=>L)),y(e,["cacheTokensDetails"],w)}const T=h(n,["candidatesTokensDetails"]);if(T!=null){let w=T;Array.isArray(w)&&(w=w.map(L=>L)),y(e,["responseTokensDetails"],w)}const x=h(n,["toolUsePromptTokensDetails"]);if(x!=null){let w=x;Array.isArray(w)&&(w=w.map(L=>L)),y(e,["toolUsePromptTokensDetails"],w)}const b=h(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function NN(n){const e={},t=h(n,["content"]);t!=null&&y(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],RN(i));const o=h(n,["tokenCount"]);o!=null&&y(e,["tokenCount"],o);const l=h(n,["finishReason"]);l!=null&&y(e,["finishReason"],l);const u=h(n,["urlContextMetadata"]);u!=null&&y(e,["urlContextMetadata"],u);const f=h(n,["avgLogprobs"]);f!=null&&y(e,["avgLogprobs"],f);const g=h(n,["groundingMetadata"]);g!=null&&y(e,["groundingMetadata"],g);const m=h(n,["index"]);m!=null&&y(e,["index"],m);const T=h(n,["logprobsResult"]);T!=null&&y(e,["logprobsResult"],T);const x=h(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>w)),y(e,["safetyRatings"],b)}return e}function RN(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["citations"],i)}return e}function MN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let l=rs(o);Array.isArray(l)&&(l=l.map(u=>u)),y(t,["contents"],l)}return t}function DN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["tokensInfo"],o)}return e}function PN(n){const e={},t=h(n,["values"]);t!=null&&y(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&y(e,["statistics"],kN(i)),e}function kN(n){const e={},t=h(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function ef(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>jR(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function VN(n){const e={},t=h(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function LN(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function UN(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],vn(i));const o=h(n,["tools"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(f=>aE(f))),y(e,["tools"],u)}const l=h(n,["generationConfig"]);return e!==void 0&&l!=null&&y(e,["generationConfig"],CR(l)),t}function ON(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let u=rs(o);Array.isArray(u)&&(u=u.map(f=>ef(f))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&LN(l),t}function jN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let u=rs(o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&UN(l,t),t}function FN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const o=h(n,["cachedContentTokenCount"]);return o!=null&&y(e,["cachedContentTokenCount"],o),e}function qN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function BN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],at(n,i)),t}function zN(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],at(n,i)),t}function HN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function GN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function $N(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=h(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const L=h(n,["outputMimeType"]);e!==void 0&&L!=null&&y(e,["parameters","outputOptions","mimeType"],L);const k=h(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&y(e,["parameters","outputOptions","compressionQuality"],k);const j=h(n,["addWatermark"]);e!==void 0&&j!=null&&y(e,["parameters","addWatermark"],j);const Y=h(n,["labels"]);e!==void 0&&Y!=null&&y(e,["labels"],Y);const O=h(n,["editMode"]);e!==void 0&&O!=null&&y(e,["parameters","editMode"],O);const B=h(n,["baseSteps"]);return e!==void 0&&B!=null&&y(e,["parameters","editConfig","baseSteps"],B),t}function YN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(g=>GR(g))),y(t,["instances[0]","referenceImages"],f)}const u=h(e,["config"]);return u!=null&&$N(u,t),t}function JN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>tf(l))),y(e,["generatedImages"],o)}return e}function KN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["requests[]","title"],o);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&y(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function QN(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&y(e,["instances[]","title"],o);const l=h(n,["outputDimensionality"]);e!==void 0&&l!=null&&y(e,["parameters","outputDimensionality"],l);const u=h(n,["mimeType"]);e!==void 0&&u!=null&&y(e,["instances[]","mimeType"],u);const f=h(n,["autoTruncate"]);return e!==void 0&&f!=null&&y(e,["parameters","autoTruncate"],f),t}function XN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let f=Np(n,o);Array.isArray(f)&&(f=f.map(g=>g)),y(t,["requests[]","content"],f)}const l=h(e,["config"]);l!=null&&KN(l,t);const u=h(e,["model"]);return u!==void 0&&y(t,["requests[]","model"],at(n,u)),t}function WN(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let u=Np(n,o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["instances[]","content"],u)}const l=h(e,["config"]);return l!=null&&QN(l,t),t}function ZN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>u)),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function eR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>PN(u))),y(e,["embeddings"],l)}const o=h(n,["metadata"]);return o!=null&&y(e,["metadata"],o),e}function tR(n){const e={},t=h(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function nR(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function sR(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&y(e,["description"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["parameters"]);o!=null&&y(e,["parameters"],o);const l=h(n,["parametersJsonSchema"]);l!=null&&y(e,["parametersJsonSchema"],l);const u=h(n,["response"]);u!=null&&y(e,["response"],u);const f=h(n,["responseJsonSchema"]);return f!=null&&y(e,["responseJsonSchema"],f),e}function iR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],ef(vn(o)));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const L=h(e,["frequencyPenalty"]);L!=null&&y(i,["frequencyPenalty"],L);const k=h(e,["seed"]);k!=null&&y(i,["seed"],k);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const Y=h(e,["responseSchema"]);Y!=null&&y(i,["responseSchema"],Rp(Y));const O=h(e,["responseJsonSchema"]);if(O!=null&&y(i,["responseJsonSchema"],O),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const B=h(e,["safetySettings"]);if(t!==void 0&&B!=null){let F=B;Array.isArray(F)&&(F=F.map(P=>$R(P))),y(t,["safetySettings"],F)}const ne=h(e,["tools"]);if(t!==void 0&&ne!=null){let F=Ya(ne);Array.isArray(F)&&(F=F.map(P=>WR($a(P)))),y(t,["tools"],F)}const ie=h(e,["toolConfig"]);if(t!==void 0&&ie!=null&&y(t,["toolConfig"],ie),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const H=h(e,["cachedContent"]);t!==void 0&&H!=null&&y(t,["cachedContent"],Oi(n,H));const N=h(e,["responseModalities"]);N!=null&&y(i,["responseModalities"],N);const C=h(e,["mediaResolution"]);C!=null&&y(i,["mediaResolution"],C);const R=h(e,["speechConfig"]);if(R!=null&&y(i,["speechConfig"],Mp(R)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const M=h(e,["thinkingConfig"]);M!=null&&y(i,["thinkingConfig"],M);const V=h(e,["imageConfig"]);return V!=null&&y(i,["imageConfig"],V),i}function rR(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&y(t,["systemInstruction"],vn(o));const l=h(e,["temperature"]);l!=null&&y(i,["temperature"],l);const u=h(e,["topP"]);u!=null&&y(i,["topP"],u);const f=h(e,["topK"]);f!=null&&y(i,["topK"],f);const g=h(e,["candidateCount"]);g!=null&&y(i,["candidateCount"],g);const m=h(e,["maxOutputTokens"]);m!=null&&y(i,["maxOutputTokens"],m);const T=h(e,["stopSequences"]);T!=null&&y(i,["stopSequences"],T);const x=h(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=h(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const w=h(e,["presencePenalty"]);w!=null&&y(i,["presencePenalty"],w);const L=h(e,["frequencyPenalty"]);L!=null&&y(i,["frequencyPenalty"],L);const k=h(e,["seed"]);k!=null&&y(i,["seed"],k);const j=h(e,["responseMimeType"]);j!=null&&y(i,["responseMimeType"],j);const Y=h(e,["responseSchema"]);Y!=null&&y(i,["responseSchema"],Rp(Y));const O=h(e,["responseJsonSchema"]);O!=null&&y(i,["responseJsonSchema"],O);const B=h(e,["routingConfig"]);B!=null&&y(i,["routingConfig"],B);const ne=h(e,["modelSelectionConfig"]);ne!=null&&y(i,["modelConfig"],ne);const ie=h(e,["safetySettings"]);if(t!==void 0&&ie!=null){let ee=ie;Array.isArray(ee)&&(ee=ee.map(W=>W)),y(t,["safetySettings"],ee)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let ee=Ya(H);Array.isArray(ee)&&(ee=ee.map(W=>aE($a(W)))),y(t,["tools"],ee)}const N=h(e,["toolConfig"]);t!==void 0&&N!=null&&y(t,["toolConfig"],N);const C=h(e,["labels"]);t!==void 0&&C!=null&&y(t,["labels"],C);const R=h(e,["cachedContent"]);t!==void 0&&R!=null&&y(t,["cachedContent"],Oi(n,R));const M=h(e,["responseModalities"]);M!=null&&y(i,["responseModalities"],M);const V=h(e,["mediaResolution"]);V!=null&&y(i,["mediaResolution"],V);const F=h(e,["speechConfig"]);F!=null&&y(i,["speechConfig"],oE(Mp(F)));const P=h(e,["audioTimestamp"]);P!=null&&y(i,["audioTimestamp"],P);const Ue=h(e,["thinkingConfig"]);Ue!=null&&y(i,["thinkingConfig"],Ue);const it=h(e,["imageConfig"]);return it!=null&&y(i,["imageConfig"],it),i}function nT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let u=rs(o);Array.isArray(u)&&(u=u.map(f=>ef(f))),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],iR(n,l,t)),t}function sT(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["contents"]);if(o!=null){let u=rs(o);Array.isArray(u)&&(u=u.map(f=>f)),y(t,["contents"],u)}const l=h(e,["config"]);return l!=null&&y(t,["generationConfig"],rR(n,l,t)),t}function iT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(m=>NN(m))),y(e,["candidates"],g)}const o=h(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=h(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const u=h(n,["responseId"]);u!=null&&y(e,["responseId"],u);const f=h(n,["usageMetadata"]);return f!=null&&y(e,["usageMetadata"],f),e}function rT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["candidates"],m)}const o=h(n,["createTime"]);o!=null&&y(e,["createTime"],o);const l=h(n,["modelVersion"]);l!=null&&y(e,["modelVersion"],l);const u=h(n,["promptFeedback"]);u!=null&&y(e,["promptFeedback"],u);const f=h(n,["responseId"]);f!=null&&y(e,["responseId"],f);const g=h(n,["usageMetadata"]);return g!=null&&y(e,["usageMetadata"],g),e}function oR(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const l=h(n,["guidanceScale"]);if(e!==void 0&&l!=null&&y(e,["parameters","guidanceScale"],l),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&y(e,["parameters","safetySetting"],u);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f);const g=h(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&y(e,["parameters","includeSafetyAttributes"],g);const m=h(n,["includeRaiReason"]);e!==void 0&&m!=null&&y(e,["parameters","includeRaiReason"],m);const T=h(n,["language"]);e!==void 0&&T!=null&&y(e,["parameters","language"],T);const x=h(n,["outputMimeType"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","mimeType"],x);const b=h(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=h(n,["imageSize"]);if(e!==void 0&&w!=null&&y(e,["parameters","sampleImageSize"],w),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function aR(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&y(e,["parameters","negativePrompt"],o);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&y(e,["parameters","sampleCount"],l);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&y(e,["parameters","aspectRatio"],u);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&y(e,["parameters","guidanceScale"],f);const g=h(n,["seed"]);e!==void 0&&g!=null&&y(e,["parameters","seed"],g);const m=h(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&y(e,["parameters","safetySetting"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=h(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const w=h(n,["language"]);e!==void 0&&w!=null&&y(e,["parameters","language"],w);const L=h(n,["outputMimeType"]);e!==void 0&&L!=null&&y(e,["parameters","outputOptions","mimeType"],L);const k=h(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&y(e,["parameters","outputOptions","compressionQuality"],k);const j=h(n,["addWatermark"]);e!==void 0&&j!=null&&y(e,["parameters","addWatermark"],j);const Y=h(n,["labels"]);e!==void 0&&Y!=null&&y(e,["labels"],Y);const O=h(n,["imageSize"]);e!==void 0&&O!=null&&y(e,["parameters","sampleImageSize"],O);const B=h(n,["enhancePrompt"]);return e!==void 0&&B!=null&&y(e,["parameters","enhancePrompt"],B),t}function lR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&oR(l,t),t}function uR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["config"]);return l!=null&&aR(l,t),t}function cR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>ER(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],iE(o)),e}function dR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>tf(u))),y(e,["generatedImages"],l)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&y(e,["positivePromptSafetyAttributes"],rE(o)),e}function fR(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=h(n,["durationSeconds"]);if(e!==void 0&&o!=null&&y(e,["parameters","durationSeconds"],o),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const u=h(n,["resolution"]);e!==void 0&&u!=null&&y(e,["parameters","resolution"],u);const f=h(n,["personGeneration"]);if(e!==void 0&&f!=null&&y(e,["parameters","personGeneration"],f),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=h(n,["negativePrompt"]);e!==void 0&&g!=null&&y(e,["parameters","negativePrompt"],g);const m=h(n,["enhancePrompt"]);if(e!==void 0&&m!=null&&y(e,["parameters","enhancePrompt"],m),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=h(n,["lastFrame"]);e!==void 0&&T!=null&&y(e,["instances[0]","lastFrame"],nf(T));const x=h(n,["referenceImages"]);if(e!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(w=>d1(w))),y(e,["instances[0]","referenceImages"],b)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function hR(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const l=h(n,["fps"]);e!==void 0&&l!=null&&y(e,["parameters","fps"],l);const u=h(n,["durationSeconds"]);e!==void 0&&u!=null&&y(e,["parameters","durationSeconds"],u);const f=h(n,["seed"]);e!==void 0&&f!=null&&y(e,["parameters","seed"],f);const g=h(n,["aspectRatio"]);e!==void 0&&g!=null&&y(e,["parameters","aspectRatio"],g);const m=h(n,["resolution"]);e!==void 0&&m!=null&&y(e,["parameters","resolution"],m);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&y(e,["parameters","personGeneration"],T);const x=h(n,["pubsubTopic"]);e!==void 0&&x!=null&&y(e,["parameters","pubsubTopic"],x);const b=h(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const w=h(n,["enhancePrompt"]);e!==void 0&&w!=null&&y(e,["parameters","enhancePrompt"],w);const L=h(n,["generateAudio"]);e!==void 0&&L!=null&&y(e,["parameters","generateAudio"],L);const k=h(n,["lastFrame"]);e!==void 0&&k!=null&&y(e,["instances[0]","lastFrame"],bs(k));const j=h(n,["referenceImages"]);if(e!==void 0&&j!=null){let B=j;Array.isArray(B)&&(B=B.map(ne=>f1(ne))),y(e,["instances[0]","referenceImages"],B)}const Y=h(n,["mask"]);e!==void 0&&Y!=null&&y(e,["instances[0]","mask"],c1(Y));const O=h(n,["compressionQuality"]);return e!==void 0&&O!=null&&y(e,["parameters","compressionQuality"],O),t}function mR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response","generateVideoResponse"]);return u!=null&&y(e,["response"],vR(u)),e}function pR(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["metadata"]);i!=null&&y(e,["metadata"],i);const o=h(n,["done"]);o!=null&&y(e,["done"],o);const l=h(n,["error"]);l!=null&&y(e,["error"],l);const u=h(n,["response"]);return u!=null&&y(e,["response"],_R(u)),e}function gR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],nf(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],lE(u));const f=h(e,["source"]);f!=null&&TR(f,t);const g=h(e,["config"]);return g!=null&&fR(g,t),t}function yR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["prompt"]);o!=null&&y(t,["instances[0]","prompt"],o);const l=h(e,["image"]);l!=null&&y(t,["instances[0]","image"],bs(l));const u=h(e,["video"]);u!=null&&y(t,["instances[0]","video"],uE(u));const f=h(e,["source"]);f!=null&&xR(f,t);const g=h(e,["config"]);return g!=null&&hR(g,t),t}function vR(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>AR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function _R(n){const e={},t=h(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>SR(u))),y(e,["generatedVideos"],l)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&y(e,["raiMediaFilteredReasons"],o),e}function TR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],nf(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],lE(l)),t}function xR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],bs(o));const l=h(n,["video"]);return e!==void 0&&l!=null&&y(e,["instances[0]","video"],uE(l)),t}function ER(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],MR(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);return o!=null&&y(e,["safetyAttributes"],iE(o)),e}function tf(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["image"],sE(t));const i=h(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const o=h(n,["_self"]);o!=null&&y(e,["safetyAttributes"],rE(o));const l=h(n,["prompt"]);return l!=null&&y(e,["enhancedPrompt"],l),e}function bR(n){const e={},t=h(n,["_self"]);t!=null&&y(e,["mask"],sE(t));const i=h(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["labels"],o)}return e}function AR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],l1(t)),e}function SR(n){const e={},t=h(n,["_self"]);return t!=null&&y(e,["video"],u1(t)),e}function CR(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=h(n,["audioTimestamp"]);i!=null&&y(e,["audioTimestamp"],i);const o=h(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=h(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const u=h(n,["frequencyPenalty"]);u!=null&&y(e,["frequencyPenalty"],u);const f=h(n,["logprobs"]);f!=null&&y(e,["logprobs"],f);const g=h(n,["maxOutputTokens"]);g!=null&&y(e,["maxOutputTokens"],g);const m=h(n,["mediaResolution"]);m!=null&&y(e,["mediaResolution"],m);const T=h(n,["presencePenalty"]);T!=null&&y(e,["presencePenalty"],T);const x=h(n,["responseJsonSchema"]);x!=null&&y(e,["responseJsonSchema"],x);const b=h(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const w=h(n,["responseMimeType"]);w!=null&&y(e,["responseMimeType"],w);const L=h(n,["responseModalities"]);L!=null&&y(e,["responseModalities"],L);const k=h(n,["responseSchema"]);k!=null&&y(e,["responseSchema"],k);const j=h(n,["routingConfig"]);j!=null&&y(e,["routingConfig"],j);const Y=h(n,["seed"]);Y!=null&&y(e,["seed"],Y);const O=h(n,["speechConfig"]);O!=null&&y(e,["speechConfig"],oE(O));const B=h(n,["stopSequences"]);B!=null&&y(e,["stopSequences"],B);const ne=h(n,["temperature"]);ne!=null&&y(e,["temperature"],ne);const ie=h(n,["thinkingConfig"]);ie!=null&&y(e,["thinkingConfig"],ie);const H=h(n,["topK"]);H!=null&&y(e,["topK"],H);const N=h(n,["topP"]);return N!=null&&y(e,["topP"],N),e}function wR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],at(n,i)),t}function IR(n,e){const t={},i=h(e,["model"]);return i!=null&&y(t,["_url","name"],at(n,i)),t}function NR(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function RR(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function MR(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],Vr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function sE(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],Vr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function nf(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],Vr(t));const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function bs(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Vr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function DR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],Kx(n,f)),i}function PR(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&y(t,["_query","pageSize"],o);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&y(t,["_query","pageToken"],l);const u=h(e,["filter"]);t!==void 0&&u!=null&&y(t,["_query","filter"],u);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&y(t,["_url","models_url"],Kx(n,f)),i}function kR(n,e){const t={},i=h(e,["config"]);return i!=null&&DR(n,i,t),t}function VR(n,e){const t={},i=h(e,["config"]);return i!=null&&PR(n,i,t),t}function LR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=Qx(o);Array.isArray(l)&&(l=l.map(u=>Km(u))),y(e,["models"],l)}return e}function UR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let l=Qx(o);Array.isArray(l)&&(l=l.map(u=>Qm(u))),y(e,["models"],l)}return e}function OR(n){const e={},t=h(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const o=h(n,["maskDilation"]);return o!=null&&y(e,["dilation"],o),e}function Km(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["version"]);l!=null&&y(e,["version"],l);const u=h(n,["_self"]);u!=null&&y(e,["tunedModelInfo"],ZR(u));const f=h(n,["inputTokenLimit"]);f!=null&&y(e,["inputTokenLimit"],f);const g=h(n,["outputTokenLimit"]);g!=null&&y(e,["outputTokenLimit"],g);const m=h(n,["supportedGenerationMethods"]);return m!=null&&y(e,["supportedActions"],m),e}function Qm(n){const e={},t=h(n,["name"]);t!=null&&y(e,["name"],t);const i=h(n,["displayName"]);i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);o!=null&&y(e,["description"],o);const l=h(n,["versionId"]);l!=null&&y(e,["version"],l);const u=h(n,["deployedModels"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(b=>tR(b))),y(e,["endpoints"],x)}const f=h(n,["labels"]);f!=null&&y(e,["labels"],f);const g=h(n,["_self"]);g!=null&&y(e,["tunedModelInfo"],e1(g));const m=h(n,["defaultCheckpointId"]);m!=null&&y(e,["defaultCheckpointId"],m);const T=h(n,["checkpoints"]);if(T!=null){let x=T;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["checkpoints"],x)}return e}function jR(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],IN(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],nR(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function FR(n){const e={},t=h(n,["productImage"]);return t!=null&&y(e,["image"],bs(t)),e}function qR(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const o=h(n,["baseSteps"]);e!==void 0&&o!=null&&y(e,["parameters","editConfig","baseSteps"],o);const l=h(n,["outputGcsUri"]);e!==void 0&&l!=null&&y(e,["parameters","storageUri"],l);const u=h(n,["seed"]);e!==void 0&&u!=null&&y(e,["parameters","seed"],u);const f=h(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&y(e,["parameters","safetySetting"],f);const g=h(n,["personGeneration"]);e!==void 0&&g!=null&&y(e,["parameters","personGeneration"],g);const m=h(n,["addWatermark"]);e!==void 0&&m!=null&&y(e,["parameters","addWatermark"],m);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&y(e,["parameters","outputOptions","mimeType"],T);const x=h(n,["outputCompressionQuality"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","compressionQuality"],x);const b=h(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const w=h(n,["labels"]);return e!==void 0&&w!=null&&y(e,["labels"],w),t}function BR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["source"]);o!=null&&HR(o,t);const l=h(e,["config"]);return l!=null&&qR(l,t),t}function zR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>tf(o))),y(e,["generatedImages"],i)}return e}function HR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["personImage"]);e!==void 0&&o!=null&&y(e,["instances[0]","personImage","image"],bs(o));const l=h(n,["productImages"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(f=>FR(f))),y(e,["instances[0]","productImages"],u)}return t}function GR(n){const e={},t=h(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],bs(t));const i=h(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const o=h(n,["referenceType"]);o!=null&&y(e,["referenceType"],o);const l=h(n,["maskImageConfig"]);l!=null&&y(e,["maskImageConfig"],OR(l));const u=h(n,["controlImageConfig"]);u!=null&&y(e,["controlImageConfig"],VN(u));const f=h(n,["styleImageConfig"]);f!=null&&y(e,["styleImageConfig"],f);const g=h(n,["subjectImageConfig"]);return g!=null&&y(e,["subjectImageConfig"],g),e}function iE(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function rE(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&y(e,["contentType"],o),e}function $R(n){const e={};if(h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=h(n,["category"]);t!=null&&y(e,["category"],t);const i=h(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function YR(n){const e={},t=h(n,["image"]);return t!=null&&y(e,["image"],bs(t)),e}function JR(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const o=h(n,["maxPredictions"]);e!==void 0&&o!=null&&y(e,["parameters","maxPredictions"],o);const l=h(n,["confidenceThreshold"]);e!==void 0&&l!=null&&y(e,["parameters","confidenceThreshold"],l);const u=h(n,["maskDilation"]);e!==void 0&&u!=null&&y(e,["parameters","maskDilation"],u);const f=h(n,["binaryColorThreshold"]);e!==void 0&&f!=null&&y(e,["parameters","binaryColorThreshold"],f);const g=h(n,["labels"]);return e!==void 0&&g!=null&&y(e,["labels"],g),t}function KR(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["source"]);o!=null&&XR(o,t);const l=h(e,["config"]);return l!=null&&JR(l,t),t}function QR(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>bR(o))),y(e,["generatedMasks"],i)}return e}function XR(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&y(e,["instances[0]","image"],bs(o));const l=h(n,["scribbleImage"]);return e!==void 0&&l!=null&&y(e,["instances[0]","scribble"],YR(l)),t}function oE(n){const e={},t=h(n,["voiceConfig"]);if(t!=null&&y(e,["voiceConfig"],t),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const i=h(n,["languageCode"]);return i!=null&&y(e,["languageCode"],i),e}function WR(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],RR(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],NR(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}function aE(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>sR(b))),y(e,["functionDeclarations"],x)}const i=h(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const o=h(n,["googleSearch"]);o!=null&&y(e,["googleSearch"],o);const l=h(n,["googleSearchRetrieval"]);l!=null&&y(e,["googleSearchRetrieval"],l);const u=h(n,["enterpriseWebSearch"]);u!=null&&y(e,["enterpriseWebSearch"],u);const f=h(n,["googleMaps"]);f!=null&&y(e,["googleMaps"],f);const g=h(n,["urlContext"]);g!=null&&y(e,["urlContext"],g);const m=h(n,["computerUse"]);m!=null&&y(e,["computerUse"],m);const T=h(n,["codeExecution"]);return T!=null&&y(e,["codeExecution"],T),e}function ZR(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function e1(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&y(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&y(e,["updateTime"],o),e}function t1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function n1(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&y(e,["description"],o);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&y(e,["defaultCheckpointId"],l),t}function s1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","name"],at(n,i));const o=h(e,["config"]);return o!=null&&t1(o,t),t}function i1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["config"]);return o!=null&&n1(o,t),t}function r1(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const o=h(n,["includeRaiReason"]);e!==void 0&&o!=null&&y(e,["parameters","includeRaiReason"],o);const l=h(n,["outputMimeType"]);e!==void 0&&l!=null&&y(e,["parameters","outputOptions","mimeType"],l);const u=h(n,["outputCompressionQuality"]);e!==void 0&&u!=null&&y(e,["parameters","outputOptions","compressionQuality"],u);const f=h(n,["enhanceInputImage"]);e!==void 0&&f!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],f);const g=h(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const m=h(n,["labels"]);e!==void 0&&m!=null&&y(e,["labels"],m);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&y(e,["parameters","sampleCount"],T);const x=h(n,["mode"]);return e!==void 0&&x!=null&&y(e,["parameters","mode"],x),t}function o1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["_url","model"],at(n,i));const o=h(e,["image"]);o!=null&&y(t,["instances[0]","image"],bs(o));const l=h(e,["upscaleFactor"]);l!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],l);const u=h(e,["config"]);return u!=null&&r1(u,t),t}function a1(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>tf(l))),y(e,["generatedImages"],o)}return e}function l1(n){const e={},t=h(n,["video","uri"]);t!=null&&y(e,["uri"],t);const i=h(n,["video","encodedVideo"]);i!=null&&y(e,["videoBytes"],Vr(i));const o=h(n,["encoding"]);return o!=null&&y(e,["mimeType"],o),e}function u1(n){const e={},t=h(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],Vr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}function c1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["_self"],bs(t));const i=h(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function d1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],nf(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function f1(n){const e={},t=h(n,["image"]);t!=null&&y(e,["image"],bs(t));const i=h(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function lE(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["video","uri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["video","encodedVideo"],Vr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["encoding"],o),e}function uE(n){const e={},t=h(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],Vr(i));const o=h(n,["mimeType"]);return o!=null&&y(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const h1="Content-Type",m1="X-Server-Timeout",p1="User-Agent",Xm="x-goog-api-client",g1="1.24.0",y1=`google-genai-sdk/${g1}`,v1="v1beta1",_1="v1beta",oT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class T1{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:v1,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:_1,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,f]of Object.entries(e.queryParams))o.searchParams.append(u,String(f));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.unaryApiCall(o,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,l]of Object.entries(t))typeof l=="object"?i[o]=Object.assign(Object.assign({},i[o]),l):l!==void 0&&(i[o]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,e.abortSignal),this.streamApiCall(o,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i){if(t&&t.timeout||i){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const u=setTimeout(()=>o.abort(),t.timeout);u&&typeof u.unref=="function"&&u.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&x1(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await aT(o),new $m(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await aT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return Na(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:f,value:g}=yield At(o.read());if(f){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=l.decode(g,{stream:!0});try{const x=JSON.parse(m);if("error"in x){const b=JSON.parse(JSON.stringify(x.error)),w=b.status,L=b.code,k=`got status: ${w}. ${JSON.stringify(x)}`;if(L>=400&&L<600)throw new Zd({message:k,status:L})}}catch(x){if(x.name==="ApiError")throw x}u+=m;let T=u.match(oT);for(;T;){const x=T[1];try{const b=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield At(new $m(b)),u=u.slice(T[0].length),T=u.match(oT)}catch(b){throw new Error(`exception parsing stream chunk ${x}. ${b}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=y1+" "+this.clientOptions.userAgentExtra;return e[p1]=t,e[Xm]=t,e[h1]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[i,o]of Object.entries(e.headers))t.append(i,o);e.timeout&&e.timeout>0&&t.append(m1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const l=this.clientOptions.uploader,u=await l.stat(e);o.sizeBytes=String(u.size);const f=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=f;const g=await this.fetchUploadUrl(o,t);return l.upload(e,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var i;let o={};t!=null&&t.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const l={file:e},u=await this.request({path:Ae("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:o});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function aT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new Zd({message:o,status:t}):new Error(o)}}function x1(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,u){const f=Object.assign({},l);for(const g in u)if(Object.prototype.hasOwnProperty.call(u,g)){const m=u[g],T=f[g];m&&typeof m=="object"&&!Array.isArray(m)&&T&&typeof T=="object"&&!Array.isArray(T)?f[g]=i(T,m):(T&&m&&typeof T!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof T}, New type: ${typeof m}. Overwriting.`),f[g]=m)}return f}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E1="mcp_used/unknown";let b1=!1;function cE(n){for(const e of n)if(A1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return b1}function dE(n){var e;const t=(e=n[Xm])!==null&&e!==void 0?e:"";n[Xm]=(t+` ${E1}`).trimStart()}function A1(n){return n!==null&&typeof n=="object"&&n instanceof Pp}function S1(n,e=100){return Na(this,arguments,function*(){let i,o=0;for(;o<e;){const l=yield At(n.listTools({cursor:i}));for(const u of l.tools)yield yield At(u),o++;if(!l.nextCursor)break;i=l.nextCursor}})}class Pp{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Pp(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const l={},u=[];for(const T of this.mcpClients)try{for(var f=!0,g=(t=void 0,hu(S1(T))),m;m=await g.next(),e=m.done,!e;f=!0){o=m.value,f=!1;const x=o;u.push(x);const b=x.name;if(l[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);l[b]=T}}catch(x){t={error:x}}finally{try{!f&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),Mw(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const u=await o.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function C1(n,e,t){const i=new bw;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class w1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),u=R1(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),g=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${f}`;let m=()=>{};const T=new Promise(B=>{m=B}),x=e.callbacks,b=function(){m({})},w=this.apiClient,L={onopen:b,onmessage:B=>{C1(w,x.onmessage,B)},onerror:(t=x==null?void 0:x.onerror)!==null&&t!==void 0?t:function(B){},onclose:(i=x==null?void 0:x.onclose)!==null&&i!==void 0?i:function(B){}},k=this.webSocketFactory.create(g,N1(u),L);k.connect(),await T;const O={setup:{model:at(this.apiClient,e.model)}};return k.send(JSON.stringify(O)),new I1(k,this.apiClient)}}class I1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=_N(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=vN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Sa.PLAY)}pause(){this.sendPlaybackControl(Sa.PAUSE)}stop(){this.sendPlaybackControl(Sa.STOP)}resetContext(){this.sendPlaybackControl(Sa.RESET_CONTEXT)}close(){this.conn.close()}}function N1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function R1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const M1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function D1(n,e,t){const i=new Ew;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const l=JSON.parse(o);if(n.isVertexAI()){const u=EN(l);Object.assign(i,u)}else Object.assign(i,l);e(i)}class P1{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new w1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,l,u,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let T;const x=this.apiClient.getHeaders();e.config&&e.config.tools&&cE(e.config.tools)&&dE(x);const b=U1(x);if(this.apiClient.isVertexAI())T=`${g}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b);else{const R=this.apiClient.getApiKey();let M="BidiGenerateContent",V="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),M="BidiGenerateContentConstrained",V="access_token"),T=`${g}/ws/google.ai.generativelanguage.${m}.GenerativeService.${M}?${V}=${R}`}let w=()=>{};const L=new Promise(R=>{w=R}),k=e.callbacks,j=function(){var R;(R=k==null?void 0:k.onopen)===null||R===void 0||R.call(k),w({})},Y=this.apiClient,O={onopen:j,onmessage:R=>{D1(Y,k.onmessage,R)},onerror:(t=k==null?void 0:k.onerror)!==null&&t!==void 0?t:function(R){},onclose:(i=k==null?void 0:k.onclose)!==null&&i!==void 0?i:function(R){}},B=this.webSocketFactory.create(T,L1(b),O);B.connect(),await L;let ne=at(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&ne.startsWith("publishers/")){const R=this.apiClient.getProject(),M=this.apiClient.getLocation();ne=`projects/${R}/locations/${M}/`+ne}let ie={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Nd.AUDIO]}:e.config.responseModalities=[Nd.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(f=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[],N=[];for(const R of H)if(this.isCallableTool(R)){const M=R;N.push(await M.tool())}else N.push(R);N.length>0&&(e.config.tools=N);const C={model:ne,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ie=yN(this.apiClient,C):ie=gN(this.apiClient,C),delete ie.config,B.send(JSON.stringify(ie)),new V1(B,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const k1={turnComplete:!0};class V1{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=rs(t.turns),e.isVertexAI()||(i=i.map(o=>ef(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(M1)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},k1),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:xN(e)}:t={realtimeInput:TN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function L1(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function U1(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lT=10;function uT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Ra(u)){o=!0;break}if(!o)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function Ra(n){return"callTool"in n&&typeof n.callTool=="function"}function O1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>Ra(o)))!==null&&i!==void 0?i:!1}function j1(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!Ra(o)))!==null&&i!==void 0?i:!1}function cT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class F1 extends So{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,l,u,f;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!O1(t)||uT(t.config))return await this.generateContentInternal(g);if(j1(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,T;const x=rs(g.contents),b=(l=(o=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&l!==void 0?l:lT;let w=0;for(;w<b&&(m=await this.generateContentInternal(g),!(!m.functionCalls||m.functionCalls.length===0));){const L=m.candidates[0].content,k=[];for(const j of(f=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[])if(Ra(j)){const O=await j.callTool(m.functionCalls);k.push(...O)}w++,T={role:"user",parts:k},g.contents=rs(g.contents),g.contents.push(L),g.contents.push(T),cT(g.config)&&(x.push(L),x.push(T))}return cT(g.config)&&(m.automaticFunctionCallingHistory=x),m},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),uT(t.config)){const i=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(i)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let l;const u=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((o=g==null?void 0:g.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:u.push(g);let f;return l?f={generatedImages:u,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:f={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},f}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new wu(vo.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const u=await Promise.all(l.map(async g=>Ra(g)?await g.tool():g)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(f.config.tools=u,e.config&&e.config.tools&&cE(e.config.tools)){const g=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let m=Object.assign({},g);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),dE(m),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:m})}return f}async initAfcToolsMap(e){var t,i,o;const l=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Ra(u)){const f=u,g=await f.tool();for(const m of(o=g.functionDeclarations)!==null&&o!==void 0?o:[]){if(!m.name)throw new Error("Function declaration name is required.");if(l.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);l.set(m.name,f)}}return l}async processAfcStream(e){var t,i,o;const l=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:lT;let u=!1,f=0;const g=await this.initAfcToolsMap(e);return(function(m,T,x){var b,w;return Na(this,arguments,function*(){for(var L,k,j,Y;f<l;){u&&(f++,u=!1);const ie=yield At(m.processParamsMaybeAddMcpUsage(x)),H=yield At(m.generateContentStreamInternal(ie)),N=[],C=[];try{for(var O=!0,B=(k=void 0,hu(H)),ne;ne=yield At(B.next()),L=ne.done,!L;O=!0){Y=ne.value,O=!1;const R=Y;if(yield yield At(R),R.candidates&&(!((b=R.candidates[0])===null||b===void 0)&&b.content)){C.push(R.candidates[0].content);for(const M of(w=R.candidates[0].content.parts)!==null&&w!==void 0?w:[])if(f<l&&M.functionCall){if(!M.functionCall.name)throw new Error("Function call name was not returned by the model.");if(T.has(M.functionCall.name)){const V=yield At(T.get(M.functionCall.name).callTool([M.functionCall]));N.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${T.keys()}, mising tool: ${M.functionCall.name}`)}}}}catch(R){k={error:R}}finally{try{!O&&!L&&(j=B.return)&&(yield At(j.call(B)))}finally{if(k)throw k.error}}if(N.length>0){u=!0;const R=new ou;R.candidates=[{content:{role:"user",parts:N}}],yield yield At(R);const M=[];M.push(...C),M.push({role:"user",parts:N});const V=rs(x.contents).concat(M);x.contents=V}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=sT(this.apiClient,e);return f=Ae("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=rT(T),b=new ou;return Object.assign(b,x),b})}else{const m=nT(this.apiClient,e);return f=Ae("{model}:generateContent",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=iT(T),b=new ou;return Object.assign(b,x),b})}}async generateContentStreamInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=sT(this.apiClient,e);return f=Ae("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(x){return Na(this,arguments,function*(){var b,w,L,k;try{for(var j=!0,Y=hu(x),O;O=yield At(Y.next()),b=O.done,!b;j=!0){k=O.value,j=!1;const B=k,ne=rT(yield At(B.json()));ne.sdkHttpResponse={headers:B.headers};const ie=new ou;Object.assign(ie,ne),yield yield At(ie)}}catch(B){w={error:B}}finally{try{!j&&!b&&(L=Y.return)&&(yield At(L.call(Y)))}finally{if(w)throw w.error}}})})}else{const m=nT(this.apiClient,e);return f=Ae("{model}:streamGenerateContent?alt=sse",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),u.then(function(x){return Na(this,arguments,function*(){var b,w,L,k;try{for(var j=!0,Y=hu(x),O;O=yield At(Y.next()),b=O.done,!b;j=!0){k=O.value,j=!1;const B=k,ne=iT(yield At(B.json()));ne.sdkHttpResponse={headers:B.headers};const ie=new ou;Object.assign(ie,ne),yield yield At(ie)}}catch(B){w={error:B}}finally{try{!j&&!b&&(L=Y.return)&&(yield At(L.call(Y)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=WN(this.apiClient,e);return f=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=eR(T),b=new F_;return Object.assign(b,x),b})}else{const m=XN(this.apiClient,e);return f=Ae("{model}:batchEmbedContents",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=ZN(T),b=new F_;return Object.assign(b,x),b})}}async generateImagesInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=uR(this.apiClient,e);return f=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=dR(T),b=new q_;return Object.assign(b,x),b})}else{const m=lR(this.apiClient,e);return f=Ae("{model}:predict",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=cR(T),b=new q_;return Object.assign(b,x),b})}}async editImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=YN(this.apiClient,e);return l=Ae("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=JN(g),T=new mw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=o1(this.apiClient,e);return l=Ae("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=a1(g),T=new pw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=BR(this.apiClient,e);return l=Ae("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=zR(g),T=new gw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=KR(this.apiClient,e);return l=Ae("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const m=QR(g),T=new yw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=IR(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=wR(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=VR(this.apiClient,e);return f=Ae("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=UR(T),b=new B_;return Object.assign(b,x),b})}else{const m=kR(this.apiClient,e);return f=Ae("{models_url}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=LR(T),b=new B_;return Object.assign(b,x),b})}}async update(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=i1(this.apiClient,e);return f=Ae("{model}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>Qm(T))}else{const m=s1(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>Km(T))}}async delete(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=zN(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=GN(T),b=new z_;return Object.assign(b,x),b})}else{const m=BN(this.apiClient,e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=HN(T),b=new z_;return Object.assign(b,x),b})}}async countTokens(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=jN(this.apiClient,e);return f=Ae("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=qN(T),b=new H_;return Object.assign(b,x),b})}else{const m=ON(this.apiClient,e);return f=Ae("{model}:countTokens",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=FN(T),b=new H_;return Object.assign(b,x),b})}}async computeTokens(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=MN(this.apiClient,e);return l=Ae("{model}:computeTokens",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>{const m=DN(g),T=new vw;return Object.assign(T,m),T})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=yR(this.apiClient,e);return f=Ae("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u.then(T=>{const x=pR(T),b=new Rd;return Object.assign(b,x),b})}else{const m=gR(this.apiClient,e);return f=Ae("{model}:predictLongRunning",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u.then(T=>{const x=mR(T),b=new Rd;return Object.assign(b,x),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q1 extends So{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:u,isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=dw(e);return f=Ae("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json()),u}else{const m=cw(e);return f=Ae("{operationName}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=sw(e);return l=Ae("{resourceName}:fetchPredictOperation",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function B1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["data"]);t!=null&&y(e,["data"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function z1(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>X1(l))),y(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&y(e,["role"],i),e}function H1(n,e,t){const i={},o=h(e,["expireTime"]);t!==void 0&&o!=null&&y(t,["expireTime"],o);const l=h(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&y(t,["newSessionExpireTime"],l);const u=h(e,["uses"]);t!==void 0&&u!=null&&y(t,["uses"],u);const f=h(e,["liveConnectConstraints"]);t!==void 0&&f!=null&&y(t,["bidiGenerateContentSetup"],Q1(n,f));const g=h(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&y(t,["fieldMask"],g),i}function G1(n,e){const t={},i=h(e,["config"]);return i!=null&&y(t,["config"],H1(n,i,t)),t}function $1(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Y1(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function J1(n){const e={},t=h(n,["timeRangeFilter"]);if(t!=null&&y(e,["timeRangeFilter"],t),h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function K1(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","responseModalities"],o);const l=h(n,["temperature"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","temperature"],l);const u=h(n,["topP"]);e!==void 0&&u!=null&&y(e,["setup","generationConfig","topP"],u);const f=h(n,["topK"]);e!==void 0&&f!=null&&y(e,["setup","generationConfig","topK"],f);const g=h(n,["maxOutputTokens"]);e!==void 0&&g!=null&&y(e,["setup","generationConfig","maxOutputTokens"],g);const m=h(n,["mediaResolution"]);e!==void 0&&m!=null&&y(e,["setup","generationConfig","mediaResolution"],m);const T=h(n,["seed"]);e!==void 0&&T!=null&&y(e,["setup","generationConfig","seed"],T);const x=h(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],Dp(x));const b=h(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const w=h(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],w);const L=h(n,["systemInstruction"]);e!==void 0&&L!=null&&y(e,["setup","systemInstruction"],z1(vn(L)));const k=h(n,["tools"]);if(e!==void 0&&k!=null){let H=Ya(k);Array.isArray(H)&&(H=H.map(N=>Z1($a(N)))),y(e,["setup","tools"],H)}const j=h(n,["sessionResumption"]);e!==void 0&&j!=null&&y(e,["setup","sessionResumption"],W1(j));const Y=h(n,["inputAudioTranscription"]);e!==void 0&&Y!=null&&y(e,["setup","inputAudioTranscription"],Y);const O=h(n,["outputAudioTranscription"]);e!==void 0&&O!=null&&y(e,["setup","outputAudioTranscription"],O);const B=h(n,["realtimeInputConfig"]);e!==void 0&&B!=null&&y(e,["setup","realtimeInputConfig"],B);const ne=h(n,["contextWindowCompression"]);e!==void 0&&ne!=null&&y(e,["setup","contextWindowCompression"],ne);const ie=h(n,["proactivity"]);return e!==void 0&&ie!=null&&y(e,["setup","proactivity"],ie),t}function Q1(n,e){const t={},i=h(e,["model"]);i!=null&&y(t,["setup","model"],at(n,i));const o=h(e,["config"]);return o!=null&&y(t,["config"],K1(o,t)),t}function X1(n){const e={},t=h(n,["videoMetadata"]);t!=null&&y(e,["videoMetadata"],t);const i=h(n,["thought"]);i!=null&&y(e,["thought"],i);const o=h(n,["inlineData"]);o!=null&&y(e,["inlineData"],B1(o));const l=h(n,["fileData"]);l!=null&&y(e,["fileData"],$1(l));const u=h(n,["thoughtSignature"]);u!=null&&y(e,["thoughtSignature"],u);const f=h(n,["functionCall"]);f!=null&&y(e,["functionCall"],f);const g=h(n,["codeExecutionResult"]);g!=null&&y(e,["codeExecutionResult"],g);const m=h(n,["executableCode"]);m!=null&&y(e,["executableCode"],m);const T=h(n,["functionResponse"]);T!=null&&y(e,["functionResponse"],T);const x=h(n,["text"]);return x!=null&&y(e,["text"],x),e}function W1(n){const e={},t=h(n,["handle"]);if(t!=null&&y(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Z1(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let m=t;Array.isArray(m)&&(m=m.map(T=>T)),y(e,["functionDeclarations"],m)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearch"]);i!=null&&y(e,["googleSearch"],J1(i));const o=h(n,["googleSearchRetrieval"]);if(o!=null&&y(e,["googleSearchRetrieval"],o),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["googleMaps"]);l!=null&&y(e,["googleMaps"],Y1(l));const u=h(n,["urlContext"]);u!=null&&y(e,["urlContext"],u);const f=h(n,["computerUse"]);f!=null&&y(e,["computerUse"],f);const g=h(n,["codeExecution"]);return g!=null&&y(e,["codeExecution"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(l=>`${t}.${l}`);e.push(...o)}else e.push(t)}return e.join(",")}function tM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const l=eM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];o.length>0&&(f=o.map(m=>u.includes(m)?`generationConfig.${m}`:m));const g=[];l&&g.push(l),f.length>0&&g.push(...f),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class nM extends So{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=G1(this.apiClient,e);l=Ae("auth_tokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query;const g=tM(f,e.config);return o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),o.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function iM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function rM(n,e){const t={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=h(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&y(e,["displayName"],i),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=h(n,["epochCount"]);e!==void 0&&o!=null&&y(e,["tuningTask","hyperparameters","epochCount"],o);const l=h(n,["learningRateMultiplier"]);if(l!=null&&y(t,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=h(n,["batchSize"]);e!==void 0&&u!=null&&y(e,["tuningTask","hyperparameters","batchSize"],u);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&y(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return t}function oM(n,e){const t={},i=h(n,["validationDataset"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec"],xM(i,t));const o=h(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&y(e,["tunedModelDisplayName"],o);const l=h(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);const u=h(n,["epochCount"]);e!==void 0&&u!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const f=h(n,["learningRateMultiplier"]);e!==void 0&&f!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const g=h(n,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g);const m=h(n,["adapterSize"]);if(e!==void 0&&m!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m),h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const T=h(n,["labels"]);return e!==void 0&&T!=null&&y(e,["labels"],T),t}function aM(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["tuningTask","trainingData"],vM(o));const l=h(n,["config"]);return l!=null&&rM(l,e),e}function lM(n){const e={},t=h(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=h(n,["preTunedModel"]);i!=null&&y(e,["preTunedModel"],i);const o=h(n,["trainingDataset"]);o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],_M(o,e));const l=h(n,["config"]);return l!=null&&oM(l,e),e}function uM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function cM(n){const e={},t=h(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function dM(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function fM(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=h(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),t}function hM(n){const e={},t=h(n,["config"]);return t!=null&&dM(t,e),e}function mM(n){const e={},t=h(n,["config"]);return t!=null&&fM(t,e),e}function pM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>fE(u))),y(e,["tuningJobs"],l)}return e}function gM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const o=h(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Wm(u))),y(e,["tuningJobs"],l)}return e}function yM(n){const e={},t=h(n,["name"]);t!=null&&y(e,["model"],t);const i=h(n,["name"]);return i!=null&&y(e,["endpoint"],i),e}function vM(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=h(n,["examples"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),y(e,["examples","examples"],i)}return e}function _M(n,e){const t={},i=h(n,["gcsUri"]);e!==void 0&&i!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);if(e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function fE(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],Yx(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["tuningTask","startTime"]);u!=null&&y(e,["startTime"],u);const f=h(n,["tuningTask","completeTime"]);f!=null&&y(e,["endTime"],f);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["description"]);m!=null&&y(e,["description"],m);const T=h(n,["baseModel"]);T!=null&&y(e,["baseModel"],T);const x=h(n,["_self"]);x!=null&&y(e,["tunedModel"],yM(x));const b=h(n,["customBaseModel"]);b!=null&&y(e,["customBaseModel"],b);const w=h(n,["experiment"]);w!=null&&y(e,["experiment"],w);const L=h(n,["labels"]);L!=null&&y(e,["labels"],L);const k=h(n,["outputUri"]);k!=null&&y(e,["outputUri"],k);const j=h(n,["pipelineJob"]);j!=null&&y(e,["pipelineJob"],j);const Y=h(n,["serviceAccount"]);Y!=null&&y(e,["serviceAccount"],Y);const O=h(n,["tunedModelDisplayName"]);O!=null&&y(e,["tunedModelDisplayName"],O);const B=h(n,["veoTuningSpec"]);return B!=null&&y(e,["veoTuningSpec"],B),e}function Wm(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["state"]);o!=null&&y(e,["state"],Yx(o));const l=h(n,["createTime"]);l!=null&&y(e,["createTime"],l);const u=h(n,["startTime"]);u!=null&&y(e,["startTime"],u);const f=h(n,["endTime"]);f!=null&&y(e,["endTime"],f);const g=h(n,["updateTime"]);g!=null&&y(e,["updateTime"],g);const m=h(n,["error"]);m!=null&&y(e,["error"],m);const T=h(n,["description"]);T!=null&&y(e,["description"],T);const x=h(n,["baseModel"]);x!=null&&y(e,["baseModel"],x);const b=h(n,["tunedModel"]);b!=null&&y(e,["tunedModel"],b);const w=h(n,["preTunedModel"]);w!=null&&y(e,["preTunedModel"],w);const L=h(n,["supervisedTuningSpec"]);L!=null&&y(e,["supervisedTuningSpec"],L);const k=h(n,["tuningDataStats"]);k!=null&&y(e,["tuningDataStats"],k);const j=h(n,["encryptionSpec"]);j!=null&&y(e,["encryptionSpec"],j);const Y=h(n,["partnerModelTuningSpec"]);Y!=null&&y(e,["partnerModelTuningSpec"],Y);const O=h(n,["customBaseModel"]);O!=null&&y(e,["customBaseModel"],O);const B=h(n,["experiment"]);B!=null&&y(e,["experiment"],B);const ne=h(n,["labels"]);ne!=null&&y(e,["labels"],ne);const ie=h(n,["outputUri"]);ie!=null&&y(e,["outputUri"],ie);const H=h(n,["pipelineJob"]);H!=null&&y(e,["pipelineJob"],H);const N=h(n,["serviceAccount"]);N!=null&&y(e,["serviceAccount"],N);const C=h(n,["tunedModelDisplayName"]);C!=null&&y(e,["tunedModelDisplayName"],C);const R=h(n,["veoTuningSpec"]);return R!=null&&y(e,["veoTuningSpec"],R),e}function TM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&y(e,["name"],i);const o=h(n,["metadata"]);o!=null&&y(e,["metadata"],o);const l=h(n,["done"]);l!=null&&y(e,["done"],l);const u=h(n,["error"]);return u!=null&&y(e,["error"],u),e}function xM(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);return e!==void 0&&o!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EM extends So{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new wu(vo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:o});return l.baseModel=void 0,await this.tuneInternal(l)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),l=await this.tuneMldevInternal(o);let u="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?u=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(u=l.name.split("/operations/")[0]),{name:u,state:Gm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=cM(e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>Wm(T))}else{const m=uM(e);return f=Ae("{name}",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>fE(T))}}async listInternal(e){var t,i,o,l;let u,f="",g={};if(this.apiClient.isVertexAI()){const m=mM(e);return f=Ae("tuningJobs",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=gM(T),b=new G_;return Object.assign(b,x),b})}else{const m=hM(e);return f=Ae("tunedModels",m._url),g=m._query,delete m._url,delete m._query,u=this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(T=>T.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:T.headers},b})),u.then(T=>{const x=pM(T),b=new G_;return Object.assign(b,x),b})}}async cancel(e){var t,i,o,l;let u="",f={};if(this.apiClient.isVertexAI()){const g=iM(e);u=Ae("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=sM(e);u=Ae("{name}:cancel",g._url),f=g._query,delete g._url,delete g._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI()){const f=lM(e);return l=Ae("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>Wm(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,l="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=aM(e);return l=Ae("tunedModels",f._url),u=f._query,delete f._url,delete f._query,o=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(m=>{const T=m;return T.sdkHttpResponse={headers:g.headers},T})),o.then(g=>TM(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bM{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const AM=1024*1024*8,SM=3,CM=1e3,wM=2,Im="x-goog-upload-status";async function IM(n,e,t){var i,o,l;let u=0,f=0,g=new $m(new Response),m="upload";for(u=n.size;f<u;){const x=Math.min(AM,u-f),b=n.slice(f,f+x);f+x>=u&&(m+=", finalize");let w=0,L=CM;for(;w<SM&&(g=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(f),"Content-Length":String(x)}}}),!(!((i=g==null?void 0:g.headers)===null||i===void 0)&&i[Im]));)w++,await RM(L),L=L*wM;if(f+=x,((o=g==null?void 0:g.headers)===null||o===void 0?void 0:o[Im])!=="active")break;if(u<=f)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const T=await(g==null?void 0:g.json());if(((l=g==null?void 0:g.headers)===null||l===void 0?void 0:l[Im])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return T.file}async function NM(n){return{size:n.size,type:n.type}}function RM(n){return new Promise(e=>setTimeout(e,n))}class MM{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await IM(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await NM(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DM{create(e,t,i){return new PM(e,t,i)}}class PM{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dT="x-goog-api-key";class kM{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(dT)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(dT,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VM="gl-node/";class LM{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=nw(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new kM(this.apiKey);this.apiClient=new T1({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:VM+"web",uploader:new MM,downloader:new bM}),this.models=new F1(this.apiClient),this.live=new P1(this.apiClient,o,new DM),this.batches=new _I(this.apiClient),this.chats=new XI(this.models,this.apiClient),this.caches=new JI(this.apiClient),this.files=new aN(this.apiClient),this.operations=new q1(this.apiClient),this.authTokens=new nM(this.apiClient),this.tunings=new EM(this.apiClient)}}const hE={BASE_URL:"/fd/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",VITE_FIREBASE_APP_ID:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4",VITE_FIREBASE_AUTH_DOMAIN:"expenses-140c4.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"221809737779",VITE_FIREBASE_PROJECT_ID:"expenses-140c4",VITE_FIREBASE_STORAGE_BUCKET:"expenses-140c4.appspot.com",VITE_GEMINI_API_KEY:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE"},jt={firebase:{apiKey:"AIzaSyBA1uXbBt5qHfOh9nTFXuI2IVN-uhWYD_g",authDomain:"expenses-140c4.firebaseapp.com",projectId:"expenses-140c4",storageBucket:"expenses-140c4.appspot.com",messagingSenderId:"221809737779",appId:"1:221809737779:web:a0e2f3d1b9b6c1e1f2d3e4"},gemini:{apiKey:"AIzaSyCU4hOMnyFAWpi1zuy1tRuWW9AV358_njE",model:"gemini-2.5-flash"},app:{name:"لوحة التحكم المالية",version:"1.0.0",environment:"production"}};console.log("🔍 فحص متغيرات البيئة:",{environment:jt.app.environment,firebaseApiKey:jt.firebase.apiKey?"✅ موجود":"❌ مفقود",firebaseAuthDomain:jt.firebase.authDomain||"❌ مفقود",firebaseProjectId:jt.firebase.projectId||"❌ مفقود",firebaseStorageBucket:jt.firebase.storageBucket||"❌ مفقود",firebaseMessagingSenderId:jt.firebase.messagingSenderId||"❌ مفقود",firebaseAppId:jt.firebase.appId||"❌ مفقود",geminiApiKey:"✅ موجود",allEnvVars:Object.keys(hE).filter(n=>n.startsWith("VITE_"))});console.log("🔍 جميع متغيرات VITE_ في البيئة:",Object.keys(hE).filter(n=>n.startsWith("VITE_")));const Ma=()=>{const n=[];return jt.firebase.apiKey||n.push("مفتاح Firebase API مفقود"),jt.firebase.authDomain||n.push("Firebase Auth Domain مفقود"),jt.firebase.projectId||n.push("معرف مشروع Firebase مفقود"),jt.firebase.storageBucket||n.push("Firebase Storage Bucket مفقود"),jt.firebase.messagingSenderId||n.push("Firebase Messaging Sender ID مفقود"),jt.firebase.appId||n.push("Firebase App ID مفقود"),{isValid:n.length===0,errors:n,hasFirebase:!!jt.firebase.apiKey,hasGemini:!0}};if(typeof window<"u"){const n=Ma();n.isValid?console.log("✅ جميع الإعدادات صحيحة ومكتملة"):console.warn("⚠️ تحذير: بعض الإعدادات غير مكتملة:",n.errors)}let Dd;const UM="gemini-2.5-flash",mE=()=>{if(Dd)return;const n=Ma();if(!n.isValid){console.warn("⚠️ تحذير: مفتاح Gemini API غير صحيح:",n.errors);return}try{Dd=new LM({apiKey:jt.gemini.apiKey}),console.log("🤖 تم تهيئة خدمة Gemini بنجاح")}catch(e){console.error("❌ خطأ في تهيئة خدمة Gemini:",e)}},Ka={FINANCIAL_ANALYST:`You are an expert financial analyst assistant, "المحلل الذكي". You have full access to the user's financial data for a specific period. Your purpose is to provide detailed, insightful analysis and answer complex questions in Arabic based ONLY on the data provided for that period.
- Today's date is ${new Date().toLocaleDateString("en-CA")}.
- Analyze the user's provided financial state (transactions, card details, bank balance, investments, installments) for the specified period to answer their query.
- Be thorough. Connect different parts of their financial data to give holistic answers.
- DO NOT just state data, INTERPRET it. Provide insights, identify trends, and offer observations.
- Be friendly, professional, and act as a true financial advisor.`,INVESTMENT_COACH:`You are an educational investment coach named "المستشار الذكي". Your primary role is to educate the user about investment concepts and strategies, particularly within the context of the Saudi stock market (Tadawul).
- You MUST NOT give direct financial advice. Do not recommend buying or selling specific stocks (e.g., "Buy Aramco").
- When asked for a recommendation, you MUST politely decline and instead explain HOW the user can research and make their own informed decisions.
- Your tone should be encouraging, educational, and responsible.
- Keep your answers clear, concise, and in Arabic.`,PASTE_ANALYZER:`You are an intelligent data extraction tool for Arabic and English financial transaction SMS messages from Saudi Arabia. Your task is to analyze the provided text and respond ONLY with a valid JSON object containing the keys: "merchant", "amount", "date", "paymentMethod", and "categoryId".
- **CRITICAL RULE**: Extract data ONLY from the user's text. Do not invent or infer information. If a piece of information is not present in the text, its corresponding JSON value should be null.
- **ERROR HANDLING**: If the provided text does not seem to be a financial transaction SMS at all, you MUST respond with a JSON object containing a single key "error" with the value "النص المقدم لا يبدو كرسالة معاملة مالية.".

- **Amount Extraction**:
  - The 'amount' is the primary transaction value.
  - Look for a number after keywords like "بـ" or "Amount:".
  - You MUST ignore any numbers associated with "Remaining limit", "الصرف المتبقي", or card numbers.

- **Date Extraction**:
  - The 'date' MUST be in "YYYY-MM-DD" format.
  - If the text provides a full timestamp like "2025-09-06 15:11:57", extract only the date part "2025-09-06".
  - If the text uses "DD/MM/YY", you must convert it. Example: '01/09/25' becomes '2025-09-01'.

- **Merchant Extraction**:
  - The 'merchant' is the store or service name.
  - Look for text after keywords like "من" or "Merchant:".

{{PAYMENT_METHOD_MAPPING}}

- **Category ID**:
  - Analyze the merchant name and suggest the most relevant ID from the provided list of available categories. If unsure, use the ID for the category named 'أخرى'.

---
**EXAMPLES**

1.  **Input**: "شراء-POS\\nبـ182 SAR\\nمن Adel Inte\\nمدى-ابل*2855\\nفي 01/09/25 22:11"
    **Output**: { "merchant": "Adel Inte", "amount": 182, "date": "2025-09-01", "paymentMethod": "bank-default", "categoryId": "cat-5" }

2.  **Input**: "شراء-POS\\nبـ‬‪95.78 ‬‪SAR\\nمن ‬‪BINDAWOOD\\nإئتمانية **4278 ‬‪(Apple Pay)\\nفي ‬‪03/09/25 ‬‪14:45\\nالصرف المتبقي ‬‪12146.95 ‬‪SAR"
    **Output**: { "merchant": "BINDAWOOD", "amount": 95.78, "date": "2025-09-03", "paymentMethod": "snb-card", "categoryId": "cat-1" }

3.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 115.00\\nMerchant: AlHamra Roundabout Statio\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,502.34\\nOn: 2025-09-06 15:11:57"
    **Output**: { "merchant": "AlHamra Roundabout Statio", "amount": 115.00, "date": "2025-09-06", "paymentMethod": "enbd-card", "categoryId": "cat-3" }

4.  **Input**: "POS Purchase (Apple Pay)\\nCard: Visa card XX8095\\nAmount: SAR 10.00\\nMerchant: MKAN CO\\nIn: SAUDI ARABIA\\nRemaining limit SAR 2,782.27\\nOn: 2025-09-03 23:44:56"
    **Output**: { "merchant": "MKAN CO", "amount": 10.00, "date": "2025-09-03", "paymentMethod": "enbd-card", "categoryId": "cat-7" }
---
`,ICON_SUGGESTER:"You are an emoji expert. Your task is to suggest a single, relevant emoji for a given category name. You must respond with ONLY the emoji character and nothing else.",BUDGET_PLANNER:`You are a helpful and encouraging financial planning assistant in Arabic. Your goal is to help the user create a realistic monthly budget based on their spending history and a total budget amount they provide. Use the 50/30/20 rule (50% for Needs, 30% for Wants, 20% for Savings/Debt) as a general framework, but you MUST adapt it to the user's actual spending patterns revealed in their transaction data. Your response MUST be in Arabic and formatted using Markdown. It should contain: 1. A brief, encouraging introductory sentence. 2. A breakdown of the total budget into Needs, Wants, and Savings, with the suggested amount for each. 3. A detailed table with three columns: "الفئة", "المبلغ المقترح", and "ملاحظات". 4. In the table, allocate the "Needs" and "Wants" amounts across the user's actual spending categories. 5. The "Notes" column should provide a brief justification. 6. Conclude with a short, motivational tip.`,EXCHANGE_RATE:`You are an expert currency exchange rate assistant. Your task is to provide the current exchange rate between two currencies. You MUST respond with ONLY a valid JSON object containing the keys: "rate", "fromCurrency", "toCurrency", and "lastUpdated".

- The 'rate' should be a decimal number representing how many units of 'toCurrency' equal 1 unit of 'fromCurrency'.
- The 'fromCurrency' and 'toCurrency' should be the exact currency codes provided by the user.
- The 'lastUpdated' should be the current date in "YYYY-MM-DD" format.

**IMPORTANT**: If you cannot determine the exact current exchange rate, provide a reasonable estimate based on recent market trends and clearly state this in your response.

**EXAMPLE**:
Input: "USD to SAR"
Output: {"rate": 3.75, "fromCurrency": "USD", "toCurrency": "SAR", "lastUpdated": "2024-01-15"}`},Qa=async(n,e,t=!1)=>{if(!Dd)throw new Error("لم تتم تهيئة خدمة الذكاء الاصطناعي. يرجى التأكد من صحة إعدادات الاتصال.");try{return(await Dd.models.generateContent({model:UM,contents:e,config:{systemInstruction:n,...t&&{responseMimeType:"application/json"}}})).text}catch(i){console.error("Gemini API Error:",i);let o="عفواً، حدث خطأ أثناء الاتصال بالخادم. يرجى المحاولة مرة أخرى.";throw i instanceof Error&&"message"in i&&i.message.includes("403")&&(o="تم رفض الوصول (403). يرجى التحقق من قيود مفتاح API الخاص بك في Google Cloud Console."),new Error(o)}},pE=(n,e)=>Qa(Ka.FINANCIAL_ANALYST,`User Query: "${n}"

Financial Data: ${JSON.stringify(e)}`),gE=(n,e,t,i)=>{const o=Object.keys(t),l=Object.keys(i);let u=`- **Payment Method Mapping**:
  - The 'paymentMethod' MUST be one of these exact values: [${[...l,...o].map(g=>`'${g}'`).join(", ")}].
`;Object.values(i).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a bank/mada transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),Object.values(t).forEach(g=>{const m=[g.name.split(" ")[0],...g.smsSamples||[]].filter(Boolean);m.length>0&&(u+=`  - If the text is a credit card transaction and contains any of these: '${m.join("', '")}', use '${g.id}'.
`)}),u+="  - If no specific bank account keywords match for a bank/mada transaction, default to the first bank account ID in the list.";const f=Ka.PASTE_ANALYZER.replace("{{PAYMENT_METHOD_MAPPING}}",u);return Qa(f,`Text to analyze: "${n}"

Available Categories: ${JSON.stringify(e)}

First bank account ID is '${l[0]}'`,!0)},yE=n=>Qa(Ka.INVESTMENT_COACH,n),Zm=n=>Qa(Ka.ICON_SUGGESTER,`Category: ${n}`),vE=(n,e,t)=>Qa(Ka.BUDGET_PLANNER,`Total monthly budget is: ${n} SAR. My spending categories are: ${JSON.stringify(e)}. My transactions from the last 60 days are: ${JSON.stringify(t)}`),_E=async(n,e)=>{const t=`Get current exchange rate from ${n} to ${e}`,i=await Qa(Ka.EXCHANGE_RATE,t,!0);try{const o=JSON.parse(i);return{rate:parseFloat(o.rate),fromCurrency:o.fromCurrency,toCurrency:o.toCurrency,lastUpdated:o.lastUpdated}}catch(o){throw console.error("Error parsing exchange rate:",o),new Error("خطأ في تحليل معدل التحويل. يرجى المحاولة مرة أخرى.")}},OM=Object.freeze(Object.defineProperty({__proto__:null,analyzeFinancialData:pE,analyzePastedText:gE,generateBudgetPlan:vE,generateInvestmentAdvice:yE,getExchangeRate:_E,initializeAi:mE,suggestCategoryIcon:Zm},Symbol.toStringTag,{value:"Module"})),jM="modulepreload",FM=function(n){return"/fd/"+n},fT={},xi=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let u=function(m){return Promise.all(m.map(T=>Promise.resolve(T).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),g=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));o=u(t.map(m=>{if(m=FM(m),m in fT)return;fT[m]=!0;const T=m.endsWith(".css"),x=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=T?"stylesheet":jM,T||(b.as="script"),b.crossOrigin="",b.href=m,g&&b.setAttribute("nonce",g),document.head.appendChild(b),T)return new Promise((w,L)=>{b.addEventListener("load",w),b.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return o.then(u=>{for(const f of u||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})},qM=()=>{};var hT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},BM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[t++];e[i++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[t++],u=n[t++],f=n[t++],g=((o&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(l&63)<<6|u&63)}}return e.join("")},xE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const l=n[o],u=o+1<n.length,f=u?n[o+1]:0,g=o+2<n.length,m=g?n[o+2]:0,T=l>>2,x=(l&3)<<4|f>>4;let b=(f&15)<<2|m>>6,w=m&63;g||(w=64,u||(b=64)),i.push(t[T],t[x],t[b],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(TE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):BM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const l=t[n.charAt(o++)],f=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,l==null||f==null||m==null||x==null)throw new zM;const b=l<<2|f>>4;if(i.push(b),m!==64){const w=f<<4&240|m>>2;if(i.push(w),x!==64){const L=m<<6&192|x;i.push(L)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const HM=function(n){const e=TE(n);return xE.encodeByteArray(e,!0)},Pd=function(n){return HM(n).replace(/\./g,"")},EE=function(n){try{return xE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M=()=>GM().__FIREBASE_DEFAULTS__,YM=()=>{if(typeof process>"u"||typeof hT>"u")return;const n=hT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},JM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&EE(n[1]);return e&&JSON.parse(e)},sf=()=>{try{return qM()||$M()||YM()||JM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bE=n=>{var e,t;return(t=(e=sf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},KM=n=>{const e=bE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},AE=()=>{var n;return(n=sf())==null?void 0:n.config},SE=n=>{var e;return(e=sf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Pd(JSON.stringify(t)),Pd(JSON.stringify(u)),""].join(".")}const mu={};function WM(){const n={prod:[],emulator:[]};for(const e of Object.keys(mu))mu[e]?n.emulator.push(e):n.prod.push(e);return n}function ZM(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let mT=!1;function wE(n,e){if(typeof window>"u"||typeof document>"u"||!Xa(window.location.host)||mu[n]===e||mu[n]||mT)return;mu[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=WM().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function f(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function m(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{mT=!0,u()},b}function T(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function x(){const b=ZM(i),w=t("text"),L=document.getElementById(w)||document.createElement("span"),k=t("learnmore"),j=document.getElementById(k)||document.createElement("a"),Y=t("preprendIcon"),O=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const B=b.element;f(B),T(j,k);const ne=m();g(O,Y),B.append(O,L,j,ne),document.body.appendChild(B)}l?(L.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_n())}function tD(){var e;const n=(e=sf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sD(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function iD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rD(){const n=_n();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function oD(){return!tD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aD(){try{return typeof indexedDB=="object"}catch{return!1}}function lD(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD="FirebaseError";class ji extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=uD,Object.setPrototypeOf(this,ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Iu.prototype.create)}}class Iu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],u=l?cD(l,i):"Error",f=`${this.serviceName}: ${u} (${o}).`;return new ji(o,f,i)}}function cD(n,e){return n.replace(dD,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const dD=/\{\$([^}]+)}/g;function fD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _o(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const l=n[o],u=e[o];if(pT(l)&&pT(u)){if(!_o(l,u))return!1}else if(l!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function pT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,l]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function uu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function hD(n,e){const t=new mD(n,e);return t.subscribe.bind(t)}class mD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");pD(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=Nm),o.error===void 0&&(o.error=Nm),o.complete===void 0&&(o.complete=Nm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Nm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(n){return n&&n._delegate?n._delegate:n}class To{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new QM;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vD(e))try{this.getOrInitializeService({instanceIdentifier:po})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});i.resolve(l)}catch{}}}}clearInstance(e=po){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=po){return this.instances.has(e)}getOptions(e=po){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const l=this.instances.get(i);return l&&e(l,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:yD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=po){return this.component?this.component.multipleInstances?e:po:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yD(n){return n===po?void 0:n}function vD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ze||(Ze={}));const TD={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},xD=Ze.INFO,ED={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},bD=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=ED[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kp{constructor(e){this.name=e,this._logLevel=xD,this._logHandler=bD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...e),this._logHandler(this,Ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...e),this._logHandler(this,Ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...e),this._logHandler(this,Ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...e),this._logHandler(this,Ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...e),this._logHandler(this,Ze.ERROR,...e)}}const AD=(n,e)=>e.some(t=>n instanceof t);let gT,yT;function SD(){return gT||(gT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CD(){return yT||(yT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const IE=new WeakMap,ep=new WeakMap,NE=new WeakMap,Rm=new WeakMap,Vp=new WeakMap;function wD(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(br(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&IE.set(t,n)}).catch(()=>{}),Vp.set(e,n),e}function ID(n){if(ep.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});ep.set(n,e)}let tp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ep.get(n);if(e==="objectStoreNames")return n.objectStoreNames||NE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return br(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ND(n){tp=n(tp)}function RD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Mm(this),e,...t);return NE.set(i,e.sort?e.sort():[e]),br(i)}:CD().includes(n)?function(...e){return n.apply(Mm(this),e),br(IE.get(this))}:function(...e){return br(n.apply(Mm(this),e))}}function MD(n){return typeof n=="function"?RD(n):(n instanceof IDBTransaction&&ID(n),AD(n,SD())?new Proxy(n,tp):n)}function br(n){if(n instanceof IDBRequest)return wD(n);if(Rm.has(n))return Rm.get(n);const e=MD(n);return e!==n&&(Rm.set(n,e),Vp.set(e,n)),e}const Mm=n=>Vp.get(n);function DD(n,e,{blocked:t,upgrade:i,blocking:o,terminated:l}={}){const u=indexedDB.open(n,e),f=br(u);return i&&u.addEventListener("upgradeneeded",g=>{i(br(u.result),g.oldVersion,g.newVersion,br(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),f.then(g=>{l&&g.addEventListener("close",()=>l()),o&&g.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),f}const PD=["get","getKey","getAll","getAllKeys","count"],kD=["put","add","delete","clear"],Dm=new Map;function vT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dm.get(e))return Dm.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=kD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||PD.includes(t)))return;const l=async function(u,...f){const g=this.transaction(u,o?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(f.shift())),(await Promise.all([m[t](...f),o&&g.done]))[0]};return Dm.set(e,l),l}ND(n=>({...n,get:(e,t,i)=>vT(e,t)||n.get(e,t,i),has:(e,t)=>!!vT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(LD(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function LD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",_T="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=new kp("@firebase/app"),UD="@firebase/app-compat",OD="@firebase/analytics-compat",jD="@firebase/analytics",FD="@firebase/app-check-compat",qD="@firebase/app-check",BD="@firebase/auth",zD="@firebase/auth-compat",HD="@firebase/database",GD="@firebase/data-connect",$D="@firebase/database-compat",YD="@firebase/functions",JD="@firebase/functions-compat",KD="@firebase/installations",QD="@firebase/installations-compat",XD="@firebase/messaging",WD="@firebase/messaging-compat",ZD="@firebase/performance",e2="@firebase/performance-compat",t2="@firebase/remote-config",n2="@firebase/remote-config-compat",s2="@firebase/storage",i2="@firebase/storage-compat",r2="@firebase/firestore",o2="@firebase/ai",a2="@firebase/firestore-compat",l2="firebase",u2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",c2={[np]:"fire-core",[UD]:"fire-core-compat",[jD]:"fire-analytics",[OD]:"fire-analytics-compat",[qD]:"fire-app-check",[FD]:"fire-app-check-compat",[BD]:"fire-auth",[zD]:"fire-auth-compat",[HD]:"fire-rtdb",[GD]:"fire-data-connect",[$D]:"fire-rtdb-compat",[YD]:"fire-fn",[JD]:"fire-fn-compat",[KD]:"fire-iid",[QD]:"fire-iid-compat",[XD]:"fire-fcm",[WD]:"fire-fcm-compat",[ZD]:"fire-perf",[e2]:"fire-perf-compat",[t2]:"fire-rc",[n2]:"fire-rc-compat",[s2]:"fire-gcs",[i2]:"fire-gcs-compat",[r2]:"fire-fst",[a2]:"fire-fst-compat",[o2]:"fire-vertex","fire-js":"fire-js",[l2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd=new Map,d2=new Map,ip=new Map;function TT(n,e){try{n.container.addComponent(e)}catch(t){Pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ua(n){const e=n.name;if(ip.has(e))return Pi.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,n);for(const t of kd.values())TT(t,n);for(const t of d2.values())TT(t,n);return!0}function Lp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ss(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ar=new Iu("app","Firebase",f2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new To("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=u2;function RE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:sp,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw Ar.create("bad-app-name",{appName:String(o)});if(t||(t=AE()),!t)throw Ar.create("no-options");const l=kd.get(o);if(l){if(_o(t,l.options)&&_o(i,l.config))return l;throw Ar.create("duplicate-app",{appName:o})}const u=new _D(o);for(const g of ip.values())u.addComponent(g);const f=new h2(t,i,u);return kd.set(o,f),f}function ME(n=sp){const e=kd.get(n);if(!e&&n===sp&&AE())return RE();if(!e)throw Ar.create("no-app",{appName:n});return e}function Sr(n,e,t){let i=c2[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pi.warn(u.join(" "));return}Ua(new To(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="firebase-heartbeat-database",p2=1,xu="firebase-heartbeat-store";let Pm=null;function DE(){return Pm||(Pm=DD(m2,p2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ar.create("idb-open",{originalErrorMessage:n.message})})),Pm}async function g2(n){try{const t=(await DE()).transaction(xu),i=await t.objectStore(xu).get(PE(n));return await t.done,i}catch(e){if(e instanceof ji)Pi.warn(e.message);else{const t=Ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Pi.warn(t.message)}}}async function xT(n,e){try{const i=(await DE()).transaction(xu,"readwrite");await i.objectStore(xu).put(e,PE(n)),await i.done}catch(t){if(t instanceof ji)Pi.warn(t.message);else{const i=Ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Pi.warn(i.message)}}}function PE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=1024,v2=30;class _2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new x2(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=ET();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>v2){const u=E2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Pi.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ET(),{heartbeatsToSend:i,unsentEntries:o}=T2(this._heartbeatsCache.heartbeats),l=Pd(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Pi.warn(t),""}}}function ET(){return new Date().toISOString().substring(0,10)}function T2(n,e=y2){const t=[];let i=n.slice();for(const o of n){const l=t.find(u=>u.agent===o.agent);if(l){if(l.dates.push(o.date),bT(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),bT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class x2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return aD()?lD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await g2(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function bT(n){return Pd(JSON.stringify({version:2,heartbeats:n})).length}function E2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(n){Ua(new To("platform-logger",e=>new VD(e),"PRIVATE")),Ua(new To("heartbeat",e=>new _2(e),"PRIVATE")),Sr(np,_T,n),Sr(np,_T,"esm2020"),Sr("fire-js","")}b2("");var A2="firebase",S2="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr(A2,S2,"app");var AT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Cr,kE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,C){function R(){}R.prototype=C.prototype,N.F=C.prototype,N.prototype=new R,N.prototype.constructor=N,N.D=function(M,V,F){for(var P=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)P[Ue-2]=arguments[Ue];return C.prototype[V].apply(M,P)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(N,C,R){R||(R=0);const M=Array(16);if(typeof C=="string")for(var V=0;V<16;++V)M[V]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(V=0;V<16;++V)M[V]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=N.g[0],R=N.g[1],V=N.g[2];let F=N.g[3],P;P=C+(F^R&(V^F))+M[0]+3614090360&4294967295,C=R+(P<<7&4294967295|P>>>25),P=F+(V^C&(R^V))+M[1]+3905402710&4294967295,F=C+(P<<12&4294967295|P>>>20),P=V+(R^F&(C^R))+M[2]+606105819&4294967295,V=F+(P<<17&4294967295|P>>>15),P=R+(C^V&(F^C))+M[3]+3250441966&4294967295,R=V+(P<<22&4294967295|P>>>10),P=C+(F^R&(V^F))+M[4]+4118548399&4294967295,C=R+(P<<7&4294967295|P>>>25),P=F+(V^C&(R^V))+M[5]+1200080426&4294967295,F=C+(P<<12&4294967295|P>>>20),P=V+(R^F&(C^R))+M[6]+2821735955&4294967295,V=F+(P<<17&4294967295|P>>>15),P=R+(C^V&(F^C))+M[7]+4249261313&4294967295,R=V+(P<<22&4294967295|P>>>10),P=C+(F^R&(V^F))+M[8]+1770035416&4294967295,C=R+(P<<7&4294967295|P>>>25),P=F+(V^C&(R^V))+M[9]+2336552879&4294967295,F=C+(P<<12&4294967295|P>>>20),P=V+(R^F&(C^R))+M[10]+4294925233&4294967295,V=F+(P<<17&4294967295|P>>>15),P=R+(C^V&(F^C))+M[11]+2304563134&4294967295,R=V+(P<<22&4294967295|P>>>10),P=C+(F^R&(V^F))+M[12]+1804603682&4294967295,C=R+(P<<7&4294967295|P>>>25),P=F+(V^C&(R^V))+M[13]+4254626195&4294967295,F=C+(P<<12&4294967295|P>>>20),P=V+(R^F&(C^R))+M[14]+2792965006&4294967295,V=F+(P<<17&4294967295|P>>>15),P=R+(C^V&(F^C))+M[15]+1236535329&4294967295,R=V+(P<<22&4294967295|P>>>10),P=C+(V^F&(R^V))+M[1]+4129170786&4294967295,C=R+(P<<5&4294967295|P>>>27),P=F+(R^V&(C^R))+M[6]+3225465664&4294967295,F=C+(P<<9&4294967295|P>>>23),P=V+(C^R&(F^C))+M[11]+643717713&4294967295,V=F+(P<<14&4294967295|P>>>18),P=R+(F^C&(V^F))+M[0]+3921069994&4294967295,R=V+(P<<20&4294967295|P>>>12),P=C+(V^F&(R^V))+M[5]+3593408605&4294967295,C=R+(P<<5&4294967295|P>>>27),P=F+(R^V&(C^R))+M[10]+38016083&4294967295,F=C+(P<<9&4294967295|P>>>23),P=V+(C^R&(F^C))+M[15]+3634488961&4294967295,V=F+(P<<14&4294967295|P>>>18),P=R+(F^C&(V^F))+M[4]+3889429448&4294967295,R=V+(P<<20&4294967295|P>>>12),P=C+(V^F&(R^V))+M[9]+568446438&4294967295,C=R+(P<<5&4294967295|P>>>27),P=F+(R^V&(C^R))+M[14]+3275163606&4294967295,F=C+(P<<9&4294967295|P>>>23),P=V+(C^R&(F^C))+M[3]+4107603335&4294967295,V=F+(P<<14&4294967295|P>>>18),P=R+(F^C&(V^F))+M[8]+1163531501&4294967295,R=V+(P<<20&4294967295|P>>>12),P=C+(V^F&(R^V))+M[13]+2850285829&4294967295,C=R+(P<<5&4294967295|P>>>27),P=F+(R^V&(C^R))+M[2]+4243563512&4294967295,F=C+(P<<9&4294967295|P>>>23),P=V+(C^R&(F^C))+M[7]+1735328473&4294967295,V=F+(P<<14&4294967295|P>>>18),P=R+(F^C&(V^F))+M[12]+2368359562&4294967295,R=V+(P<<20&4294967295|P>>>12),P=C+(R^V^F)+M[5]+4294588738&4294967295,C=R+(P<<4&4294967295|P>>>28),P=F+(C^R^V)+M[8]+2272392833&4294967295,F=C+(P<<11&4294967295|P>>>21),P=V+(F^C^R)+M[11]+1839030562&4294967295,V=F+(P<<16&4294967295|P>>>16),P=R+(V^F^C)+M[14]+4259657740&4294967295,R=V+(P<<23&4294967295|P>>>9),P=C+(R^V^F)+M[1]+2763975236&4294967295,C=R+(P<<4&4294967295|P>>>28),P=F+(C^R^V)+M[4]+1272893353&4294967295,F=C+(P<<11&4294967295|P>>>21),P=V+(F^C^R)+M[7]+4139469664&4294967295,V=F+(P<<16&4294967295|P>>>16),P=R+(V^F^C)+M[10]+3200236656&4294967295,R=V+(P<<23&4294967295|P>>>9),P=C+(R^V^F)+M[13]+681279174&4294967295,C=R+(P<<4&4294967295|P>>>28),P=F+(C^R^V)+M[0]+3936430074&4294967295,F=C+(P<<11&4294967295|P>>>21),P=V+(F^C^R)+M[3]+3572445317&4294967295,V=F+(P<<16&4294967295|P>>>16),P=R+(V^F^C)+M[6]+76029189&4294967295,R=V+(P<<23&4294967295|P>>>9),P=C+(R^V^F)+M[9]+3654602809&4294967295,C=R+(P<<4&4294967295|P>>>28),P=F+(C^R^V)+M[12]+3873151461&4294967295,F=C+(P<<11&4294967295|P>>>21),P=V+(F^C^R)+M[15]+530742520&4294967295,V=F+(P<<16&4294967295|P>>>16),P=R+(V^F^C)+M[2]+3299628645&4294967295,R=V+(P<<23&4294967295|P>>>9),P=C+(V^(R|~F))+M[0]+4096336452&4294967295,C=R+(P<<6&4294967295|P>>>26),P=F+(R^(C|~V))+M[7]+1126891415&4294967295,F=C+(P<<10&4294967295|P>>>22),P=V+(C^(F|~R))+M[14]+2878612391&4294967295,V=F+(P<<15&4294967295|P>>>17),P=R+(F^(V|~C))+M[5]+4237533241&4294967295,R=V+(P<<21&4294967295|P>>>11),P=C+(V^(R|~F))+M[12]+1700485571&4294967295,C=R+(P<<6&4294967295|P>>>26),P=F+(R^(C|~V))+M[3]+2399980690&4294967295,F=C+(P<<10&4294967295|P>>>22),P=V+(C^(F|~R))+M[10]+4293915773&4294967295,V=F+(P<<15&4294967295|P>>>17),P=R+(F^(V|~C))+M[1]+2240044497&4294967295,R=V+(P<<21&4294967295|P>>>11),P=C+(V^(R|~F))+M[8]+1873313359&4294967295,C=R+(P<<6&4294967295|P>>>26),P=F+(R^(C|~V))+M[15]+4264355552&4294967295,F=C+(P<<10&4294967295|P>>>22),P=V+(C^(F|~R))+M[6]+2734768916&4294967295,V=F+(P<<15&4294967295|P>>>17),P=R+(F^(V|~C))+M[13]+1309151649&4294967295,R=V+(P<<21&4294967295|P>>>11),P=C+(V^(R|~F))+M[4]+4149444226&4294967295,C=R+(P<<6&4294967295|P>>>26),P=F+(R^(C|~V))+M[11]+3174756917&4294967295,F=C+(P<<10&4294967295|P>>>22),P=V+(C^(F|~R))+M[2]+718787259&4294967295,V=F+(P<<15&4294967295|P>>>17),P=R+(F^(V|~C))+M[9]+3951481745&4294967295,N.g[0]=N.g[0]+C&4294967295,N.g[1]=N.g[1]+(V+(P<<21&4294967295|P>>>11))&4294967295,N.g[2]=N.g[2]+V&4294967295,N.g[3]=N.g[3]+F&4294967295}i.prototype.v=function(N,C){C===void 0&&(C=N.length);const R=C-this.blockSize,M=this.C;let V=this.h,F=0;for(;F<C;){if(V==0)for(;F<=R;)o(this,N,F),F+=this.blockSize;if(typeof N=="string"){for(;F<C;)if(M[V++]=N.charCodeAt(F++),V==this.blockSize){o(this,M),V=0;break}}else for(;F<C;)if(M[V++]=N[F++],V==this.blockSize){o(this,M),V=0;break}}this.h=V,this.o+=C},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var C=1;C<N.length-8;++C)N[C]=0;C=this.o*8;for(var R=N.length-8;R<N.length;++R)N[R]=C&255,C/=256;for(this.v(N),N=Array(16),C=0,R=0;R<4;++R)for(let M=0;M<32;M+=8)N[C++]=this.g[R]>>>M&255;return N};function l(N,C){var R=f;return Object.prototype.hasOwnProperty.call(R,N)?R[N]:R[N]=C(N)}function u(N,C){this.h=C;const R=[];let M=!0;for(let V=N.length-1;V>=0;V--){const F=N[V]|0;M&&F==C||(R[V]=F,M=!1)}this.g=R}var f={};function g(N){return-128<=N&&N<128?l(N,function(C){return new u([C|0],C<0?-1:0)}):new u([N|0],N<0?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return x;if(N<0)return j(m(-N));const C=[];let R=1;for(let M=0;N>=R;M++)C[M]=N/R|0,R*=4294967296;return new u(C,0)}function T(N,C){if(N.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(N.charAt(0)=="-")return j(T(N.substring(1),C));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=m(Math.pow(C,8));let M=x;for(let F=0;F<N.length;F+=8){var V=Math.min(8,N.length-F);const P=parseInt(N.substring(F,F+V),C);V<8?(V=m(Math.pow(C,V)),M=M.j(V).add(m(P))):(M=M.j(R),M=M.add(m(P)))}return M}var x=g(0),b=g(1),w=g(16777216);n=u.prototype,n.m=function(){if(k(this))return-j(this).m();let N=0,C=1;for(let R=0;R<this.g.length;R++){const M=this.i(R);N+=(M>=0?M:4294967296+M)*C,C*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(L(this))return"0";if(k(this))return"-"+j(this).toString(N);const C=m(Math.pow(N,6));var R=this;let M="";for(;;){const V=ne(R,C).g;R=Y(R,V.j(C));let F=((R.g.length>0?R.g[0]:R.h)>>>0).toString(N);if(R=V,L(R))return F+M;for(;F.length<6;)F="0"+F;M=F+M}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function L(N){if(N.h!=0)return!1;for(let C=0;C<N.g.length;C++)if(N.g[C]!=0)return!1;return!0}function k(N){return N.h==-1}n.l=function(N){return N=Y(this,N),k(N)?-1:L(N)?0:1};function j(N){const C=N.g.length,R=[];for(let M=0;M<C;M++)R[M]=~N.g[M];return new u(R,~N.h).add(b)}n.abs=function(){return k(this)?j(this):this},n.add=function(N){const C=Math.max(this.g.length,N.g.length),R=[];let M=0;for(let V=0;V<=C;V++){let F=M+(this.i(V)&65535)+(N.i(V)&65535),P=(F>>>16)+(this.i(V)>>>16)+(N.i(V)>>>16);M=P>>>16,F&=65535,P&=65535,R[V]=P<<16|F}return new u(R,R[R.length-1]&-2147483648?-1:0)};function Y(N,C){return N.add(j(C))}n.j=function(N){if(L(this)||L(N))return x;if(k(this))return k(N)?j(this).j(j(N)):j(j(this).j(N));if(k(N))return j(this.j(j(N)));if(this.l(w)<0&&N.l(w)<0)return m(this.m()*N.m());const C=this.g.length+N.g.length,R=[];for(var M=0;M<2*C;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(let V=0;V<N.g.length;V++){const F=this.i(M)>>>16,P=this.i(M)&65535,Ue=N.i(V)>>>16,it=N.i(V)&65535;R[2*M+2*V]+=P*it,O(R,2*M+2*V),R[2*M+2*V+1]+=F*it,O(R,2*M+2*V+1),R[2*M+2*V+1]+=P*Ue,O(R,2*M+2*V+1),R[2*M+2*V+2]+=F*Ue,O(R,2*M+2*V+2)}for(N=0;N<C;N++)R[N]=R[2*N+1]<<16|R[2*N];for(N=C;N<2*C;N++)R[N]=0;return new u(R,0)};function O(N,C){for(;(N[C]&65535)!=N[C];)N[C+1]+=N[C]>>>16,N[C]&=65535,C++}function B(N,C){this.g=N,this.h=C}function ne(N,C){if(L(C))throw Error("division by zero");if(L(N))return new B(x,x);if(k(N))return C=ne(j(N),C),new B(j(C.g),j(C.h));if(k(C))return C=ne(N,j(C)),new B(j(C.g),C.h);if(N.g.length>30){if(k(N)||k(C))throw Error("slowDivide_ only works with positive integers.");for(var R=b,M=C;M.l(N)<=0;)R=ie(R),M=ie(M);var V=H(R,1),F=H(M,1);for(M=H(M,2),R=H(R,2);!L(M);){var P=F.add(M);P.l(N)<=0&&(V=V.add(R),F=P),M=H(M,1),R=H(R,1)}return C=Y(N,V.j(C)),new B(V,C)}for(V=x;N.l(C)>=0;){for(R=Math.max(1,Math.floor(N.m()/C.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),F=m(R),P=F.j(C);k(P)||P.l(N)>0;)R-=M,F=m(R),P=F.j(C);L(F)&&(F=b),V=V.add(F),N=Y(N,P)}return new B(V,N)}n.B=function(N){return ne(this,N).h},n.and=function(N){const C=Math.max(this.g.length,N.g.length),R=[];for(let M=0;M<C;M++)R[M]=this.i(M)&N.i(M);return new u(R,this.h&N.h)},n.or=function(N){const C=Math.max(this.g.length,N.g.length),R=[];for(let M=0;M<C;M++)R[M]=this.i(M)|N.i(M);return new u(R,this.h|N.h)},n.xor=function(N){const C=Math.max(this.g.length,N.g.length),R=[];for(let M=0;M<C;M++)R[M]=this.i(M)^N.i(M);return new u(R,this.h^N.h)};function ie(N){const C=N.g.length+1,R=[];for(let M=0;M<C;M++)R[M]=N.i(M)<<1|N.i(M-1)>>>31;return new u(R,N.h)}function H(N,C){const R=C>>5;C%=32;const M=N.g.length-R,V=[];for(let F=0;F<M;F++)V[F]=C>0?N.i(F+R)>>>C|N.i(F+R+1)<<32-C:N.i(F+R);return new u(V,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,kE=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=T,Cr=u}).apply(typeof AT<"u"?AT:typeof self<"u"?self:typeof window<"u"?window:{});var cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var VE,cu,LE,Td,rp,UE,OE,jE;(function(){var n,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof cd=="object"&&cd];for(var E=0;E<p.length;++E){var S=p[E];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=t(this);function o(p,E){if(E)e:{var S=i;p=p.split(".");for(var D=0;D<p.length-1;D++){var J=p[D];if(!(J in S))break e;S=S[J]}p=p[p.length-1],D=S[p],E=E(D),E!=D&&E!=null&&e(S,p,{configurable:!0,writable:!0,value:E})}}o("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(p){return p||function(E){var S=[],D;for(D in E)Object.prototype.hasOwnProperty.call(E,D)&&S.push([D,E[D]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function f(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function g(p,E,S){return p.call.apply(p.bind,arguments)}function m(p,E,S){return m=g,m.apply(null,arguments)}function T(p,E){var S=Array.prototype.slice.call(arguments,1);return function(){var D=S.slice();return D.push.apply(D,arguments),p.apply(this,D)}}function x(p,E){function S(){}S.prototype=E.prototype,p.Z=E.prototype,p.prototype=new S,p.prototype.constructor=p,p.Ob=function(D,J,Z){for(var ye=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ye[ze-2]=arguments[ze];return E.prototype[J].apply(D,ye)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function w(p){const E=p.length;if(E>0){const S=Array(E);for(let D=0;D<E;D++)S[D]=p[D];return S}return[]}function L(p,E){for(let D=1;D<arguments.length;D++){const J=arguments[D];var S=typeof J;if(S=S!="object"?S:J?Array.isArray(J)?"array":S:"null",S=="array"||S=="object"&&typeof J.length=="number"){S=p.length||0;const Z=J.length||0;p.length=S+Z;for(let ye=0;ye<Z;ye++)p[S+ye]=J[ye]}else p.push(J)}}class k{constructor(E,S){this.i=E,this.j=S,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function j(p){u.setTimeout(()=>{throw p},0)}function Y(){var p=N;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class O{constructor(){this.h=this.g=null}add(E,S){const D=B.get();D.set(E,S),this.h?this.h.next=D:this.g=D,this.h=D}}var B=new k(()=>new ne,p=>p.reset());class ne{constructor(){this.next=this.g=this.h=null}set(E,S){this.h=E,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,H=!1,N=new O,C=()=>{const p=Promise.resolve(void 0);ie=()=>{p.then(R)}};function R(){for(var p;p=Y();){try{p.h.call(p.g)}catch(S){j(S)}var E=B;E.j(p),E.h<100&&(E.h++,p.next=E.g,E.g=p)}H=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};u.addEventListener("test",S,E),u.removeEventListener("test",S,E)}catch{}return p})();function P(p){return/^[\s\xa0]*$/.test(p)}function Ue(p,E){V.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,E)}x(Ue,V),Ue.prototype.init=function(p,E){const S=this.type=p.type,D=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget,E||(S=="mouseover"?E=p.fromElement:S=="mouseout"&&(E=p.toElement)),this.relatedTarget=E,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Ue.Z.h.call(this)},Ue.prototype.h=function(){Ue.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var it="closure_listenable_"+(Math.random()*1e6|0),ee=0;function W(p,E,S,D,J){this.listener=p,this.proxy=null,this.src=E,this.type=S,this.capture=!!D,this.ha=J,this.key=++ee,this.da=this.fa=!1}function pe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Me(p,E,S){for(const D in p)E.call(S,p[D],D,p)}function Ie(p,E){for(const S in p)E.call(void 0,p[S],S,p)}function q(p){const E={};for(const S in p)E[S]=p[S];return E}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ve(p,E){let S,D;for(let J=1;J<arguments.length;J++){D=arguments[J];for(S in D)p[S]=D[S];for(let Z=0;Z<oe.length;Z++)S=oe[Z],Object.prototype.hasOwnProperty.call(D,S)&&(p[S]=D[S])}}function _e(p){this.src=p,this.g={},this.h=0}_e.prototype.add=function(p,E,S,D,J){const Z=p.toString();p=this.g[Z],p||(p=this.g[Z]=[],this.h++);const ye=Oe(p,E,D,J);return ye>-1?(E=p[ye],S||(E.fa=!1)):(E=new W(E,this.src,Z,!!D,J),E.fa=S,p.push(E)),E};function Ne(p,E){const S=E.type;if(S in p.g){var D=p.g[S],J=Array.prototype.indexOf.call(D,E,void 0),Z;(Z=J>=0)&&Array.prototype.splice.call(D,J,1),Z&&(pe(E),p.g[S].length==0&&(delete p.g[S],p.h--))}}function Oe(p,E,S,D){for(let J=0;J<p.length;++J){const Z=p[J];if(!Z.da&&Z.listener==E&&Z.capture==!!S&&Z.ha==D)return J}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),fe={};function ge(p,E,S,D,J){if(Array.isArray(E)){for(let Z=0;Z<E.length;Z++)ge(p,E[Z],S,D,J);return null}return S=Or(S),p&&p[it]?p.J(E,S,f(D)?!!D.capture:!1,J):$e(p,E,S,!1,D,J)}function $e(p,E,S,D,J,Z){if(!E)throw Error("Invalid event type");const ye=f(J)?!!J.capture:!!J;let ze=Ws(p);if(ze||(p[Ye]=ze=new _e(p)),S=ze.add(E,S,D,ye,Z),S.proxy)return S;if(D=Pt(),S.proxy=D,D.src=p,D.listener=S,p.addEventListener)F||(J=ye),J===void 0&&(J=!1),p.addEventListener(E.toString(),D,J);else if(p.attachEvent)p.attachEvent(_t(E.toString()),D);else if(p.addListener&&p.removeListener)p.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Pt(){function p(S){return E.call(p.src,p.listener,S)}const E=Xs;return p}function bn(p,E,S,D,J){if(Array.isArray(E))for(var Z=0;Z<E.length;Z++)bn(p,E[Z],S,D,J);else D=f(D)?!!D.capture:!!D,S=Or(S),p&&p[it]?(p=p.i,Z=String(E).toString(),Z in p.g&&(E=p.g[Z],S=Oe(E,S,D,J),S>-1&&(pe(E[S]),Array.prototype.splice.call(E,S,1),E.length==0&&(delete p.g[Z],p.h--)))):p&&(p=Ws(p))&&(E=p.g[E.toString()],p=-1,E&&(p=Oe(E,S,D,J)),(S=p>-1?E[p]:null)&&Pn(S))}function Pn(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[it])Ne(E.i,p);else{var S=p.type,D=p.proxy;E.removeEventListener?E.removeEventListener(S,D,p.capture):E.detachEvent?E.detachEvent(_t(S),D):E.addListener&&E.removeListener&&E.removeListener(D),(S=Ws(E))?(Ne(S,p),S.h==0&&(S.src=null,E[Ye]=null)):pe(p)}}}function _t(p){return p in fe?fe[p]:fe[p]="on"+p}function Xs(p,E){if(p.da)p=!0;else{E=new Ue(E,this);const S=p.listener,D=p.ha||p.src;p.fa&&Pn(p),p=S.call(D,E)}return p}function Ws(p){return p=p[Ye],p instanceof _e?p:null}var Ur="__closure_events_fn_"+(Math.random()*1e9>>>0);function Or(p){return typeof p=="function"?p:(p[Ur]||(p[Ur]=function(E){return p.handleEvent(E)}),p[Ur])}function Nt(){M.call(this),this.i=new _e(this),this.M=this,this.G=null}x(Nt,M),Nt.prototype[it]=!0,Nt.prototype.removeEventListener=function(p,E,S,D){bn(this,p,E,S,D)};function kt(p,E){var S,D=p.G;if(D)for(S=[];D;D=D.G)S.push(D);if(p=p.M,D=E.type||E,typeof E=="string")E=new V(E,p);else if(E instanceof V)E.target=E.target||p;else{var J=E;E=new V(D,p),ve(E,J)}J=!0;let Z,ye;if(S)for(ye=S.length-1;ye>=0;ye--)Z=E.g=S[ye],J=As(Z,D,!0,E)&&J;if(Z=E.g=p,J=As(Z,D,!0,E)&&J,J=As(Z,D,!1,E)&&J,S)for(ye=0;ye<S.length;ye++)Z=E.g=S[ye],J=As(Z,D,!1,E)&&J}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var p=this.i;for(const E in p.g){const S=p.g[E];for(let D=0;D<S.length;D++)pe(S[D]);delete p.g[E],p.h--}}this.G=null},Nt.prototype.J=function(p,E,S,D){return this.i.add(String(p),E,!1,S,D)},Nt.prototype.K=function(p,E,S,D){return this.i.add(String(p),E,!0,S,D)};function As(p,E,S,D){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();let J=!0;for(let Z=0;Z<E.length;++Z){const ye=E[Z];if(ye&&!ye.da&&ye.capture==S){const ze=ye.listener,Vt=ye.ha||ye.src;ye.fa&&Ne(p.i,ye),J=ze.call(Vt,D)!==!1&&J}}return J&&!D.defaultPrevented}function il(p,E){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:u.setTimeout(p,E||0)}function Do(p){p.g=il(()=>{p.g=null,p.i&&(p.i=!1,Do(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class en extends M{constructor(E,S){super(),this.m=E,this.l=S,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Do(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zs(p){M.call(this),this.h=p,this.g={}}x(Zs,M);var qi=[];function Bi(p){Me(p.g,function(E,S){this.g.hasOwnProperty(S)&&Pn(E)},p),p.g={}}Zs.prototype.N=function(){Zs.Z.N.call(this),Bi(this)},Zs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var os=u.JSON.stringify,Po=u.JSON.parse,jr=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function G(){}function me(){}var he={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Te(){V.call(this,"d")}x(Te,V);function De(){V.call(this,"c")}x(De,V);var Fe={},Fr=null;function ei(){return Fr=Fr||new Nt}Fe.Ia="serverreachability";function ko(p){V.call(this,Fe.Ia,p)}x(ko,V);function Hn(p){const E=ei();kt(E,new ko(E))}Fe.STAT_EVENT="statevent";function ti(p,E){V.call(this,Fe.STAT_EVENT,p),this.stat=E}x(ti,V);function Rt(p){const E=ei();kt(E,new ti(E,p))}Fe.Ja="timingevent";function xe(p,E){V.call(this,Fe.Ja,p),this.size=E}x(xe,V);function mt(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},E)}function Ft(){this.g=!0}Ft.prototype.ua=function(){this.g=!1};function An(p,E,S,D,J,Z){p.info(function(){if(p.g)if(Z){var ye="",ze=Z.split("&");for(let lt=0;lt<ze.length;lt++){var Vt=ze[lt].split("=");if(Vt.length>1){const Ct=Vt[0];Vt=Vt[1];const Jn=Ct.split("_");ye=Jn.length>=2&&Jn[1]=="type"?ye+(Ct+"="+Vt+"&"):ye+(Ct+"=redacted&")}}}else ye=null;else ye=Z;return"XMLHTTP REQ ("+D+") [attempt "+J+"]: "+E+`
`+S+`
`+ye})}function Ss(p,E,S,D,J,Z,ye){p.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+J+"]: "+E+`
`+S+`
`+Z+" "+ye})}function Qe(p,E,S,D){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+Cf(p,S)+(D?" "+D:"")})}function qr(p,E){p.info(function(){return"TIMEOUT: "+E})}Ft.prototype.info=function(){};function Cf(p,E){if(!p.g)return E;if(!E)return null;try{const Z=JSON.parse(E);if(Z){for(p=0;p<Z.length;p++)if(Array.isArray(Z[p])){var S=Z[p];if(!(S.length<2)){var D=S[1];if(Array.isArray(D)&&!(D.length<1)){var J=D[0];if(J!="noop"&&J!="stop"&&J!="close")for(let ye=1;ye<D.length;ye++)D[ye]=""}}}}return os(Z)}catch{return E}}var Br={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ol;function zr(){}x(zr,G),zr.prototype.g=function(){return new XMLHttpRequest},ol=new zr;function ni(p){return encodeURIComponent(String(p))}function qu(p){var E=1;p=p.split(":");const S=[];for(;E>0&&p.length;)S.push(p.shift()),E--;return p.length&&S.push(p.join(":")),S}function as(p,E,S,D){this.j=p,this.i=E,this.l=S,this.S=D||1,this.V=new Zs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ls}function ls(){this.i=null,this.g="",this.h=!1}var qt={},tn={};function Cs(p,E,S){p.M=1,p.A=Hr(zt(E)),p.u=S,p.R=!0,Vo(p,null)}function Vo(p,E){p.F=Date.now(),ws(p),p.B=zt(p.A);var S=p.B,D=p.S;Array.isArray(D)||(D=[String(D)]),jo(S.i,"t",D),p.C=0,S=p.j.L,p.h=new ls,p.g=nc(p.j,S?E:null,!p.u),p.P>0&&(p.O=new en(m(p.Y,p,p.g),p.P)),E=p.V,S=p.g,D=p.ba;var J="readystatechange";Array.isArray(J)||(J&&(qi[0]=J.toString()),J=qi);for(let Z=0;Z<J.length;Z++){const ye=ge(S,J[Z],D||E.handleEvent,!1,E.h||E);if(!ye)break;E.g[ye.key]=ye}E=p.J?q(p.J):{},p.u?(p.v||(p.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,E)):(p.v="GET",p.g.ea(p.B,p.v,null,E)),Hn(),An(p.i,p.v,p.B,p.l,p.S,p.u)}as.prototype.ba=function(p){p=p.target;const E=this.O;E&&ds(p)==3?E.j():this.Y(p)},as.prototype.Y=function(p){try{if(p==this.g)e:{const ze=ds(this.g),Vt=this.g.ya(),lt=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||ln(this.g)))){this.K||ze!=4||Vt==7||(Vt==8||lt<=0?Hn(3):Hn(2)),Is(this);var E=this.g.ca();this.X=E;var S=wf(this);if(this.o=E==200,Ss(this.i,this.v,this.B,this.l,this.S,ze,E),this.o){if(this.U&&!this.L){t:{if(this.g){var D,J=this.g;if((D=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(D)){var Z=D;break t}}Z=null}if(p=Z)Qe(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ns(this,p);else{this.o=!1,this.m=3,Rt(12),kn(this),Gn(this);break e}}if(this.R){p=!0;let Ct;for(;!this.K&&this.C<S.length;)if(Ct=zu(this,S),Ct==tn){ze==4&&(this.m=4,Rt(14),p=!1),Qe(this.i,this.l,null,"[Incomplete Response]");break}else if(Ct==qt){this.m=4,Rt(15),Qe(this.i,this.l,S,"[Invalid Chunk]"),p=!1;break}else Qe(this.i,this.l,Ct,null),Ns(this,Ct);if(Bu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||S.length!=0||this.h.h||(this.m=1,Rt(16),p=!1),this.o=this.o&&p,!p)Qe(this.i,this.l,S,"[Invalid Chunked Response]"),kn(this),Gn(this);else if(S.length>0&&!this.W){this.W=!0;var ye=this.j;ye.g==this&&ye.aa&&!ye.P&&(ye.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),xl(ye),ye.P=!0,Rt(11))}}else Qe(this.i,this.l,S,null),Ns(this,S);ze==4&&kn(this),this.o&&!this.K&&(ze==4?Wu(this.j,this):(this.o=!1,ws(this)))}else ii(this.g),E==400&&S.indexOf("Unknown SID")>0?(this.m=3,Rt(12)):(this.m=0,Rt(13)),kn(this),Gn(this)}}}catch{}finally{}};function wf(p){if(!Bu(p))return p.g.la();const E=ln(p.g);if(E==="")return"";let S="";const D=E.length,J=ds(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return kn(p),Gn(p),"";p.h.i=new u.TextDecoder}for(let Z=0;Z<D;Z++)p.h.h=!0,S+=p.h.i.decode(E[Z],{stream:!(J&&Z==D-1)});return E.length=0,p.h.g+=S,p.C=0,p.h.g}function Bu(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function zu(p,E){var S=p.C,D=E.indexOf(`
`,S);return D==-1?tn:(S=Number(E.substring(S,D)),isNaN(S)?qt:(D+=1,D+S>E.length?tn:(E=E.slice(D,D+S),p.C=D+S,E)))}as.prototype.cancel=function(){this.K=!0,kn(this)};function ws(p){p.T=Date.now()+p.H,Lo(p,p.H)}function Lo(p,E){if(p.D!=null)throw Error("WatchDog timer not null");p.D=mt(m(p.aa,p),E)}function Is(p){p.D&&(u.clearTimeout(p.D),p.D=null)}as.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(qr(this.i,this.B),this.M!=2&&(Hn(),Rt(17)),kn(this),this.m=2,Gn(this)):Lo(this,this.T-p)};function Gn(p){p.j.I==0||p.K||Wu(p.j,p)}function kn(p){Is(p);var E=p.O;E&&typeof E.dispose=="function"&&E.dispose(),p.O=null,Bi(p.V),p.g&&(E=p.g,p.g=null,E.abort(),E.dispose())}function Ns(p,E){try{var S=p.j;if(S.I!=0&&(S.g==p||Ms(S.h,p))){if(!p.L&&Ms(S.h,p)&&S.I==3){try{var D=S.Ba.g.parse(E)}catch{D=null}if(Array.isArray(D)&&D.length==3){var J=D;if(J[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<p.F)Ho(S),Qi(S);else break e;Xr(S),Rt(18)}}else S.xa=J[1],0<S.xa-S.K&&J[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=mt(m(S.Va,S),6e3));Rs(S.h)<=1&&S.ta&&(S.ta=void 0)}else Us(S,11)}else if((p.L||S.g==p)&&Ho(S),!P(E))for(J=S.Ba.g.parse(E),E=0;E<J.length;E++){let lt=J[E];const Ct=lt[0];if(!(Ct<=S.K))if(S.K=Ct,lt=lt[1],S.I==2)if(lt[0]=="c"){S.M=lt[1],S.ba=lt[2];const Jn=lt[3];Jn!=null&&(S.ka=Jn,S.j.info("VER="+S.ka));const Os=lt[4];Os!=null&&(S.za=Os,S.j.info("SVER="+S.za));const fs=lt[5];fs!=null&&typeof fs=="number"&&fs>0&&(D=1.5*fs,S.O=D,S.j.info("backChannelRequestTimeoutMs_="+D)),D=S;const hs=p.g;if(hs){const Wr=hs.g?hs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wr){var Z=D.h;Z.g||Wr.indexOf("spdy")==-1&&Wr.indexOf("quic")==-1&&Wr.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(ul(Z,Z.h),Z.h=null))}if(D.G){const Go=hs.g?hs.g.getResponseHeader("X-HTTP-Session-Id"):null;Go&&(D.wa=Go,dt(D.J,D.G,Go))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-p.F,S.j.info("Handshake RTT: "+S.T+"ms")),D=S;var ye=p;if(D.na=tc(D,D.L?D.ba:null,D.W),ye.L){cl(D.h,ye);var ze=ye,Vt=D.O;Vt&&(ze.H=Vt),ze.D&&(Is(ze),ws(ze)),D.g=ye}else Qu(D);S.i.length>0&&Ls(S)}else lt[0]!="stop"&&lt[0]!="close"||Us(S,7);else S.I==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?Us(S,7):_l(S):lt[0]!="noop"&&S.l&&S.l.qa(lt),S.A=0)}}Hn(4)}catch{}}var Bt=class{constructor(p,E){this.g=p,this.map=E}};function al(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ll(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Rs(p){return p.h?1:p.g?p.g.size:0}function Ms(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function ul(p,E){p.g?p.g.add(E):p.h=E}function cl(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}al.prototype.cancel=function(){if(this.i=dl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function dl(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const S of p.g.values())E=E.concat(S.G);return E}return w(p.i)}var Hu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Uo(p,E){if(p){p=p.split("&");for(let S=0;S<p.length;S++){const D=p[S].indexOf("=");let J,Z=null;D>=0?(J=p[S].substring(0,D),Z=p[S].substring(D+1)):J=p[S],E(J,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function Vn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;p instanceof Vn?(this.l=p.l,nn(this,p.j),this.o=p.o,this.g=p.g,zi(this,p.u),this.h=p.h,fl(this,Ju(p.i)),this.m=p.m):p&&(E=String(p).match(Hu))?(this.l=!1,nn(this,E[1]||"",!0),this.o=Ds(E[2]||""),this.g=Ds(E[3]||"",!0),zi(this,E[4]),this.h=Ds(E[5]||"",!0),fl(this,E[6]||"",!0),this.m=Ds(E[7]||"")):(this.l=!1,this.i=new Gi(null,this.l))}Vn.prototype.toString=function(){const p=[];var E=this.j;E&&p.push(Gr(E,Oo,!0),":");var S=this.g;return(S||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Gr(E,Oo,!0),"@"),p.push(ni(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&p.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Gr(S,S.charAt(0)=="/"?hl:Gu,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Gr(S,$u)),p.join("")},Vn.prototype.resolve=function(p){const E=zt(this);let S=!!p.j;S?nn(E,p.j):S=!!p.o,S?E.o=p.o:S=!!p.g,S?E.g=p.g:S=p.u!=null;var D=p.h;if(S)zi(E,p.u);else if(S=!!p.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var J=E.h.lastIndexOf("/");J!=-1&&(D=E.h.slice(0,J+1)+D)}if(J=D,J==".."||J==".")D="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){D=J.lastIndexOf("/",0)==0,J=J.split("/");const Z=[];for(let ye=0;ye<J.length;){const ze=J[ye++];ze=="."?D&&ye==J.length&&Z.push(""):ze==".."?((Z.length>1||Z.length==1&&Z[0]!="")&&Z.pop(),D&&ye==J.length&&Z.push("")):(Z.push(ze),D=!0)}D=Z.join("/")}else D=J}return S?E.h=D:S=p.i.toString()!=="",S?fl(E,Ju(p.i)):S=!!p.m,S&&(E.m=p.m),E};function zt(p){return new Vn(p)}function nn(p,E,S){p.j=S?Ds(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function zi(p,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);p.u=E}else p.u=null}function fl(p,E,S){E instanceof Gi?(p.i=E,Fo(p.i,p.l)):(S||(E=Gr(E,Hi)),p.i=new Gi(E,p.l))}function dt(p,E,S){p.i.set(E,S)}function Hr(p){return dt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Ds(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Gr(p,E,S){return typeof p=="string"?(p=encodeURI(p).replace(E,Sn),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Sn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Oo=/[#\/\?@]/g,Gu=/[#\?:]/g,hl=/[#\?]/g,Hi=/[#\?@]/g,$u=/#/g;function Gi(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function Cn(p){p.g||(p.g=new Map,p.h=0,p.i&&Uo(p.i,function(E,S){p.add(decodeURIComponent(E.replace(/\+/g," ")),S)}))}n=Gi.prototype,n.add=function(p,E){Cn(this),this.i=null,p=$i(this,p);let S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(E),this.h+=1,this};function Yu(p,E){Cn(p),E=$i(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function ml(p,E){return Cn(p),E=$i(p,E),p.g.has(E)}n.forEach=function(p,E){Cn(this),this.g.forEach(function(S,D){S.forEach(function(J){p.call(E,J,D,this)},this)},this)};function pl(p,E){Cn(p);let S=[];if(typeof E=="string")ml(p,E)&&(S=S.concat(p.g.get($i(p,E))));else for(p=Array.from(p.g.values()),E=0;E<p.length;E++)S=S.concat(p[E]);return S}n.set=function(p,E){return Cn(this),this.i=null,p=$i(this,p),ml(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},n.get=function(p,E){return p?(p=pl(this,p),p.length>0?String(p[0]):E):E};function jo(p,E,S){Yu(p,E),S.length>0&&(p.i=null,p.g.set($i(p,E),w(S)),p.h+=S.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(let D=0;D<E.length;D++){var S=E[D];const J=ni(S);S=pl(this,S);for(let Z=0;Z<S.length;Z++){let ye=J;S[Z]!==""&&(ye+="="+ni(S[Z])),p.push(ye)}}return this.i=p.join("&")};function Ju(p){const E=new Gi;return E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),E}function $i(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function Fo(p,E){E&&!p.j&&(Cn(p),p.i=null,p.g.forEach(function(S,D){const J=D.toLowerCase();D!=J&&(Yu(this,D),jo(this,J,S))},p)),p.j=E}function us(p,E){const S=new Ft;if(u.Image){const D=new Image;D.onload=T($n,S,"TestLoadImage: loaded",!0,E,D),D.onerror=T($n,S,"TestLoadImage: error",!1,E,D),D.onabort=T($n,S,"TestLoadImage: abort",!1,E,D),D.ontimeout=T($n,S,"TestLoadImage: timeout",!1,E,D),u.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=p}else E(!1)}function gl(p,E){const S=new Ft,D=new AbortController,J=setTimeout(()=>{D.abort(),$n(S,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:D.signal}).then(Z=>{clearTimeout(J),Z.ok?$n(S,"TestPingServer: ok",!0,E):$n(S,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(J),$n(S,"TestPingServer: error",!1,E)})}function $n(p,E,S,D,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),D(S)}catch{}}function Yi(){this.g=new jr}function Ps(p){this.i=p.Sb||null,this.h=p.ab||!1}x(Ps,G),Ps.prototype.g=function(){return new $r(this.i,this.h)};function $r(p,E){Nt.call(this),this.H=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x($r,Nt),n=$r.prototype,n.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=E,this.readyState=1,cs(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(E.body=p),(this.H||u).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ji(this)),this.readyState=0},n.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qo(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function qo(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}n.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?Ji(this):cs(this),this.readyState==3&&qo(this)}},n.Oa=function(p){this.g&&(this.response=this.responseText=p,Ji(this))},n.Na=function(p){this.g&&(this.response=p,Ji(this))},n.ga=function(){this.g&&Ji(this)};function Ji(p){p.readyState=4,p.l=null,p.j=null,p.B=null,cs(p)}n.setRequestHeader=function(p,E){this.A.append(p,E)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var S=E.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=E.next();return p.join(`\r
`)};function cs(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty($r.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Yn(p){let E="";return Me(p,function(S,D){E+=D,E+=":",E+=S,E+=`\r
`}),E}function Yr(p,E,S){e:{for(D in S){var D=!1;break e}D=!0}D||(S=Yn(S),typeof p=="string"?S!=null&&ni(S):dt(p,E,S))}function pt(p){Nt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(pt,Nt);var ks=/^https?$/i,yl=["POST","PUT"];n=pt.prototype,n.Fa=function(p){this.H=p},n.ea=function(p,E,S,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ol.g(),this.g.onreadystatechange=b(m(this.Ca,this));try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(Z){Jr(this,Z);return}if(p=S||"",S=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var J in D)S.set(J,D[J]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const Z of D.keys())S.set(Z,D.get(Z));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(S.keys()).find(Z=>Z.toLowerCase()=="content-type"),J=u.FormData&&p instanceof u.FormData,!(Array.prototype.indexOf.call(yl,E,void 0)>=0)||D||J||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,ye]of S)this.g.setRequestHeader(Z,ye);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Z){Jr(this,Z)}};function Jr(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.o=5,vl(p),si(p)}function vl(p){p.A||(p.A=!0,kt(p,"complete"),kt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,kt(this,"complete"),kt(this,"abort"),si(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Kr(this):this.Xa())},n.Xa=function(){Kr(this)};function Kr(p){if(p.h&&typeof l<"u"){if(p.v&&ds(p)==4)setTimeout(p.Ca.bind(p),0);else if(kt(p,"readystatechange"),ds(p)==4){p.h=!1;try{const Z=p.ca();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var S;if(!(S=E)){var D;if(D=Z===0){let ye=String(p.D).match(Hu)[1]||null;!ye&&u.self&&u.self.location&&(ye=u.self.location.protocol.slice(0,-1)),D=!ks.test(ye?ye.toLowerCase():"")}S=D}if(S)kt(p,"complete"),kt(p,"success");else{p.o=6;try{var J=ds(p)>2?p.g.statusText:""}catch{J=""}p.l=J+" ["+p.ca()+"]",vl(p)}}finally{si(p)}}}}function si(p,E){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const S=p.g;p.g=null,E||kt(p,"ready");try{S.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ds(p){return p.g?p.g.readyState:0}n.ca=function(){try{return ds(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),Po(E)}};function ln(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ii(p){const E={};p=(p.g&&ds(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<p.length;D++){if(P(p[D]))continue;var S=qu(p[D]);const J=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Z=E[J]||[];E[J]=Z,Z.push(S)}Ie(E,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(p,E,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||E}function Ki(p){this.za=0,this.i=[],this.j=new Ft,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vs("baseRetryDelayMs",5e3,p),this.Za=Vs("retryDelaySeedMs",1e4,p),this.Ta=Vs("forwardChannelMaxRetries",2,p),this.va=Vs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new al(p&&p.concurrentRequestLimit),this.Ba=new Yi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ki.prototype,n.ka=8,n.I=1,n.connect=function(p,E,S,D){Rt(0),this.W=p,this.H=E||{},S&&D!==void 0&&(this.H.OSID=S,this.H.OAID=D),this.F=this.X,this.J=tc(this,null,this.W),Ls(this)};function _l(p){if(Bo(p),p.I==3){var E=p.V++,S=zt(p.J);if(dt(S,"SID",p.M),dt(S,"RID",E),dt(S,"TYPE","terminate"),Qr(p,S),E=new as(p,p.j,E),E.M=2,E.A=Hr(zt(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(E.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=E.A,S=!0),S||(E.g=nc(E.j,null),E.g.ea(E.A)),E.F=Date.now(),ws(E)}ec(p)}function Qi(p){p.g&&(xl(p),p.g.cancel(),p.g=null)}function Bo(p){Qi(p),p.v&&(u.clearTimeout(p.v),p.v=null),Ho(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&u.clearTimeout(p.m),p.m=null)}function Ls(p){if(!ll(p.h)&&!p.m){p.m=!0;var E=p.Ea;ie||C(),H||(ie(),H=!0),N.add(E,p),p.D=0}}function zo(p,E){return Rs(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=E.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=mt(m(p.Ea,p,E),Zu(p,p.D)),p.D++,!0)}n.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const J=new as(this,this.j,p);let Z=this.o;if(this.U&&(Z?(Z=q(Z),ve(Z,this.U)):Z=this.U),this.u!==null||this.R||(J.J=Z,Z=null),this.S)e:{for(var E=0,S=0;S<this.i.length;S++){t:{var D=this.i[S];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(E+=D,E>4096){E=S;break e}if(E===4096||S===this.i.length-1){E=S+1;break e}}E=1e3}else E=1e3;E=Ku(this,J,E),S=zt(this.J),dt(S,"RID",p),dt(S,"CVER",22),this.G&&dt(S,"X-HTTP-Session-Id",this.G),Qr(this,S),Z&&(this.R?E="headers="+ni(Yn(Z))+"&"+E:this.u&&Yr(S,this.u,Z)),ul(this.h,J),this.Ra&&dt(S,"TYPE","init"),this.S?(dt(S,"$req",E),dt(S,"SID","null"),J.U=!0,Cs(J,S,null)):Cs(J,S,E),this.I=2}}else this.I==3&&(p?Tl(this,p):this.i.length==0||ll(this.h)||Tl(this))};function Tl(p,E){var S;E?S=E.l:S=p.V++;const D=zt(p.J);dt(D,"SID",p.M),dt(D,"RID",S),dt(D,"AID",p.K),Qr(p,D),p.u&&p.o&&Yr(D,p.u,p.o),S=new as(p,p.j,S,p.D+1),p.u===null&&(S.J=p.o),E&&(p.i=E.G.concat(p.i)),E=Ku(p,S,1e3),S.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ul(p.h,S),Cs(S,D,E)}function Qr(p,E){p.H&&Me(p.H,function(S,D){dt(E,D,S)}),p.l&&Me({},function(S,D){dt(E,D,S)})}function Ku(p,E,S){S=Math.min(p.i.length,S);const D=p.l?m(p.l.Ka,p.l,p):null;e:{var J=p.i;let ze=-1;for(;;){const Vt=["count="+S];ze==-1?S>0?(ze=J[0].g,Vt.push("ofs="+ze)):ze=0:Vt.push("ofs="+ze);let lt=!0;for(let Ct=0;Ct<S;Ct++){var Z=J[Ct].g;const Jn=J[Ct].map;if(Z-=ze,Z<0)ze=Math.max(0,J[Ct].g-100),lt=!1;else try{Z="req"+Z+"_"||"";try{var ye=Jn instanceof Map?Jn:Object.entries(Jn);for(const[Os,fs]of ye){let hs=fs;f(fs)&&(hs=os(fs)),Vt.push(Z+Os+"="+encodeURIComponent(hs))}}catch(Os){throw Vt.push(Z+"type="+encodeURIComponent("_badmap")),Os}}catch{D&&D(Jn)}}if(lt){ye=Vt.join("&");break e}}ye=void 0}return p=p.i.splice(0,S),E.G=p,ye}function Qu(p){if(!p.g&&!p.v){p.Y=1;var E=p.Da;ie||C(),H||(ie(),H=!0),N.add(E,p),p.A=0}}function Xr(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=mt(m(p.Da,p),Zu(p,p.A)),p.A++,!0)}n.Da=function(){if(this.v=null,Xu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=mt(m(this.Wa,this),p)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Rt(10),Qi(this),Xu(this))};function xl(p){p.B!=null&&(u.clearTimeout(p.B),p.B=null)}function Xu(p){p.g=new as(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var E=zt(p.na);dt(E,"RID","rpc"),dt(E,"SID",p.M),dt(E,"AID",p.K),dt(E,"CI",p.F?"0":"1"),!p.F&&p.ia&&dt(E,"TO",p.ia),dt(E,"TYPE","xmlhttp"),Qr(p,E),p.u&&p.o&&Yr(E,p.u,p.o),p.O&&(p.g.H=p.O);var S=p.g;p=p.ba,S.M=1,S.A=Hr(zt(E)),S.u=null,S.R=!0,Vo(S,p)}n.Va=function(){this.C!=null&&(this.C=null,Qi(this),Xr(this),Rt(19))};function Ho(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Wu(p,E){var S=null;if(p.g==E){Ho(p),xl(p),p.g=null;var D=2}else if(Ms(p.h,E))S=E.G,cl(p.h,E),D=1;else return;if(p.I!=0){if(E.o)if(D==1){S=E.u?E.u.length:0,E=Date.now()-E.F;var J=p.D;D=ei(),kt(D,new xe(D,S)),Ls(p)}else Qu(p);else if(J=E.m,J==3||J==0&&E.X>0||!(D==1&&zo(p,E)||D==2&&Xr(p)))switch(S&&S.length>0&&(E=p.h,E.i=E.i.concat(S)),J){case 1:Us(p,5);break;case 4:Us(p,10);break;case 3:Us(p,6);break;default:Us(p,2)}}}function Zu(p,E){let S=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(S*=2),S*E}function Us(p,E){if(p.j.info("Error code "+E),E==2){var S=m(p.bb,p),D=p.Ua;const J=!D;D=new Vn(D||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||nn(D,"https"),Hr(D),J?us(D.toString(),S):gl(D.toString(),S)}else Rt(2);p.I=0,p.l&&p.l.pa(E),ec(p),Bo(p)}n.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function ec(p){if(p.I=0,p.ja=[],p.l){const E=dl(p.h);(E.length!=0||p.i.length!=0)&&(L(p.ja,E),L(p.ja,p.i),p.h.i.length=0,w(p.i),p.i.length=0),p.l.oa()}}function tc(p,E,S){var D=S instanceof Vn?zt(S):new Vn(S);if(D.g!="")E&&(D.g=E+"."+D.g),zi(D,D.u);else{var J=u.location;D=J.protocol,E=E?E+"."+J.hostname:J.hostname,J=+J.port;const Z=new Vn(null);D&&nn(Z,D),E&&(Z.g=E),J&&zi(Z,J),S&&(Z.h=S),D=Z}return S=p.G,E=p.wa,S&&E&&dt(D,S,E),dt(D,"VER",p.ka),Qr(p,D),D}function nc(p,E,S){if(E&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Aa&&!p.ma?new pt(new Ps({ab:S})):new pt(p.ma),E.Fa(p.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sc(){}n=sc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Xi(){}Xi.prototype.g=function(p,E){return new Tn(p,E)};function Tn(p,E){Nt.call(this),this.g=new Ki(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(p?p["X-WebChannel-Client-Profile"]=E.sa:p={"X-WebChannel-Client-Profile":E.sa}),this.g.U=p,(p=E&&E.Qb)&&!P(p)&&(this.g.u=p),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!P(E)&&(this.g.G=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new ri(this)}x(Tn,Nt),Tn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){_l(this.g)},Tn.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.v&&(S={},S.__data__=os(p),p=S);E.i.push(new Bt(E.Ya++,p)),E.I==3&&Ls(E)},Tn.prototype.N=function(){this.g.l=null,delete this.j,_l(this.g),delete this.g,Tn.Z.N.call(this)};function ic(p){Te.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const S in E){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}x(ic,Te);function rc(){De.call(this),this.status=1}x(rc,De);function ri(p){this.g=p}x(ri,sc),ri.prototype.ra=function(){kt(this.g,"a")},ri.prototype.qa=function(p){kt(this.g,new ic(p))},ri.prototype.pa=function(p){kt(this.g,new rc)},ri.prototype.oa=function(){kt(this.g,"b")},Xi.prototype.createWebChannel=Xi.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,jE=function(){return new Xi},OE=function(){return ei()},UE=Fe,rp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Br.NO_ERROR=0,Br.TIMEOUT=8,Br.HTTP_ERROR=6,Td=Br,rl.COMPLETE="complete",LE=rl,me.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,cu=me,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,VE=pt}).apply(typeof cd<"u"?cd:typeof self<"u"?self:typeof window<"u"?window:{});const ST="@firebase/firestore",CT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Za="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new kp("@firebase/firestore");function xa(){return xo.logLevel}function Ee(n,...e){if(xo.logLevel<=Ze.DEBUG){const t=e.map(Up);xo.debug(`Firestore (${Za}): ${n}`,...t)}}function ki(n,...e){if(xo.logLevel<=Ze.ERROR){const t=e.map(Up);xo.error(`Firestore (${Za}): ${n}`,...t)}}function Eo(n,...e){if(xo.logLevel<=Ze.WARN){const t=e.map(Up);xo.warn(`Firestore (${Za}): ${n}`,...t)}}function Up(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,FE(n,i,t)}function FE(n,e,t){let i=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ki(i),new Error(i)}function ct(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||FE(e,o,i)}function Be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends ji{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gn.UNAUTHENTICATED)))}shutdown(){}}class C2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class w2{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ct(this.o===void 0,42304);let i=this.i;const o=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Ri;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ri,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await o(this.currentUser)}))},f=g=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>f(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?f(g):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ri)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ct(typeof i.accessToken=="string",31837,{l:i}),new qE(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ct(e===null||typeof e=="string",2055,{h:e}),new gn(e)}}class I2{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N2{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new I2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ss(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ct(this.o===void 0,3512);const i=l=>{l.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Ee("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const o=l=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ct(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=M2(40);for(let l=0;l<o.length;++l)i.length<20&&o[l]<t&&(i+=e.charAt(o[l]%62))}return i}}function et(n,e){return n<e?-1:n>e?1:0}function op(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),l=e.charAt(i);if(o!==l)return km(o)===km(l)?et(o,l):km(o)?1:-1}return et(n.length,e.length)}const D2=55296,P2=57343;function km(n){const e=n.charCodeAt(0);return e>=D2&&e<=P2}function Oa(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="__name__";class zs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ve(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ve(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return zs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const l=zs.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return et(e.length,t.length)}static compareSegments(e,t){const i=zs.isNumericId(e),o=zs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?zs.extractNumericId(e).compare(zs.extractNumericId(t)):op(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Cr.fromString(e.substring(4,e.length-2))}}class St extends zs{construct(e,t,i){return new St(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new St(t)}static emptyPath(){return new St([])}}const k2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class on extends zs{construct(e,t,i){return new on(e,t,i)}static isValidIdentifier(e){return k2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),on.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===IT}static keyField(){return new on([IT])}static fromServerFormat(e){const t=[];let i="",o=0;const l=()=>{if(i.length===0)throw new Se(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new Se(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[o+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Se(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,o+=2}else f==="`"?(u=!u,o++):f!=="."||u?(i+=f,o++):(l(),o++)}if(l(),u)throw new Se(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new on(t)}static emptyPath(){return new on([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.path=e}static fromPath(e){return new Re(St.fromString(e))}static fromName(e){return new Re(St.fromString(e).popFirst(5))}static empty(){return new Re(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&St.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return St.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Re(new St(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(n,e,t){if(!t)throw new Se(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HE(n,e,t,i){if(e===!0&&i===!0)throw new Se(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function NT(n){if(!Re.isDocumentKey(n))throw new Se(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RT(n){if(Re.isDocumentKey(n))throw new Se(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function GE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Op(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ve(12329,{type:typeof n})}function Vi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Se(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Op(n);throw new Se(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ru(n,e){if(!GE(n))throw new Se(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(o&&typeof u!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Se(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=-62135596800,DT=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*DT);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<MT)throw new Se(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DT}_compareTo(e){return this.seconds===e.seconds?et(this.nanoseconds,e.nanoseconds):et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ru(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-MT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Kt("string",xt._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{static fromTimestamp(e){return new je(e)}static min(){return new je(new xt(0,0))}static max(){return new je(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu=-1;function V2(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=je.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new Ir(o,Re.empty(),e)}function L2(n){return new Ir(n.readTime,n.key,Eu)}class Ir{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ir(je.min(),Re.empty(),Eu)}static max(){return new Ir(je.max(),Re.empty(),Eu)}}function U2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Re.comparator(n.documentKey,e.documentKey),t!==0?t:et(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==O2)throw n;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue(((i,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.reject(t)}static resolve(e){return new ue(((t,i)=>{t(e)}))}static reject(e){return new ue(((t,i)=>{i(e)}))}static waitFor(e){return new ue(((t,i)=>{let o=0,l=0,u=!1;e.forEach((f=>{++o,f.next((()=>{++l,u&&l===o&&t()}),(g=>i(g)))})),u=!0,l===o&&t()}))}static or(e){let t=ue.resolve(!1);for(const i of e)t=t.next((o=>o?ue.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,l)=>{i.push(t.call(this,o,l))})),this.waitFor(i)}static mapArray(e,t){return new ue(((i,o)=>{const l=e.length,u=new Array(l);let f=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((T=>{u[m]=T,++f,f===l&&i(u)}),(T=>o(T)))}}))}static doWhile(e,t){return new ue(((i,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):i()};l()}))}}function F2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}of.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp=-1;function af(n){return n==null}function Vd(n){return n===0&&1/n==-1/0}function q2(n){return typeof n=="number"&&Number.isInteger(n)&&!Vd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E="";function B2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PT(e)),e=z2(n.get(t),e);return PT(e)}function z2(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const l=n.charAt(o);switch(l){case"\0":t+="";break;case $E:t+="";break;default:t+=l}}return t}function PT(n){return n+$E+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Co(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t){this.comparator=e,this.root=t||hn.EMPTY}insert(e,t){return new It(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,hn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dd(this.root,e,this.comparator,!0)}}class dd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class hn{constructor(e,t,i,o,l){this.key=e,this.value=t,this.color=i??hn.RED,this.left=o??hn.EMPTY,this.right=l??hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,l){return new hn(e??this.key,t??this.value,i??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const l=i(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,i),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return hn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}hn.EMPTY=null,hn.RED=!0,hn.BLACK=!1;hn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,t,i,o,l){return this}insert(e,t,i){return new hn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new VT(this.data.getIterator())}getIteratorFrom(e){return new VT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Zt(this.comparator);return t.data=e,t}}class VT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.fields=e,e.sort(on.comparator)}static empty(){return new vs([])}unionWith(e){let t=new Zt(on.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new vs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new JE("Invalid base64 string: "+l):l}})(e);return new an(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let u=0;u<o.length;++u)l+=String.fromCharCode(o[u]);return l})(e);return new an(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const H2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nr(n){if(ct(!!n,39018),typeof n=="string"){let e=0;const t=H2.exec(n);if(ct(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ot(n.seconds),nanos:Ot(n.nanos)}}function Ot(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Rr(n){return typeof n=="string"?an.fromBase64String(n):an.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="server_timestamp",QE="__type__",XE="__previous_value__",WE="__local_write_time__";function Fp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[QE])==null?void 0:i.stringValue)===KE}function lf(n){const e=n.mapValue.fields[XE];return Fp(e)?lf(e):e}function bu(n){const e=Nr(n.mapValue.fields[WE].timestampValue);return new xt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t,i,o,l,u,f,g,m,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=T}}const Ld="(default)";class ja{constructor(e,t){this.projectId=e,this.database=t||Ld}static empty(){return new ja("","")}get isDefaultDatabase(){return this.database===Ld}isEqual(e){return e instanceof ja&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="__type__",$2="__max__",fd={mapValue:{}},eb="__vector__",Ud="value";function Mr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fp(n)?4:J2(n)?9007199254740991:Y2(n)?10:11:Ve(28295,{value:n})}function Ks(n,e){if(n===e)return!0;const t=Mr(n);if(t!==Mr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bu(n).isEqual(bu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const u=Nr(o.timestampValue),f=Nr(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return Rr(o.bytesValue).isEqual(Rr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return Ot(o.geoPointValue.latitude)===Ot(l.geoPointValue.latitude)&&Ot(o.geoPointValue.longitude)===Ot(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return Ot(o.integerValue)===Ot(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const u=Ot(o.doubleValue),f=Ot(l.doubleValue);return u===f?Vd(u)===Vd(f):isNaN(u)&&isNaN(f)}return!1})(n,e);case 9:return Oa(n.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return(function(o,l){const u=o.mapValue.fields||{},f=l.mapValue.fields||{};if(kT(u)!==kT(f))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(f[g]===void 0||!Ks(u[g],f[g])))return!1;return!0})(n,e);default:return Ve(52216,{left:n})}}function Au(n,e){return(n.values||[]).find((t=>Ks(t,e)))!==void 0}function Fa(n,e){if(n===e)return 0;const t=Mr(n),i=Mr(e);if(t!==i)return et(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return et(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=Ot(l.integerValue||l.doubleValue),g=Ot(u.integerValue||u.doubleValue);return f<g?-1:f>g?1:f===g?0:isNaN(f)?isNaN(g)?0:-1:1})(n,e);case 3:return LT(n.timestampValue,e.timestampValue);case 4:return LT(bu(n),bu(e));case 5:return op(n.stringValue,e.stringValue);case 6:return(function(l,u){const f=Rr(l),g=Rr(u);return f.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),g=u.split("/");for(let m=0;m<f.length&&m<g.length;m++){const T=et(f[m],g[m]);if(T!==0)return T}return et(f.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=et(Ot(l.latitude),Ot(u.latitude));return f!==0?f:et(Ot(l.longitude),Ot(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return UT(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var b,w,L,k;const f=l.fields||{},g=u.fields||{},m=(b=f[Ud])==null?void 0:b.arrayValue,T=(w=g[Ud])==null?void 0:w.arrayValue,x=et(((L=m==null?void 0:m.values)==null?void 0:L.length)||0,((k=T==null?void 0:T.values)==null?void 0:k.length)||0);return x!==0?x:UT(m,T)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===fd.mapValue&&u===fd.mapValue)return 0;if(l===fd.mapValue)return 1;if(u===fd.mapValue)return-1;const f=l.fields||{},g=Object.keys(f),m=u.fields||{},T=Object.keys(m);g.sort(),T.sort();for(let x=0;x<g.length&&x<T.length;++x){const b=op(g[x],T[x]);if(b!==0)return b;const w=Fa(f[g[x]],m[T[x]]);if(w!==0)return w}return et(g.length,T.length)})(n.mapValue,e.mapValue);default:throw Ve(23264,{he:t})}}function LT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return et(n,e);const t=Nr(n),i=Nr(e),o=et(t.seconds,i.seconds);return o!==0?o:et(t.nanos,i.nanos)}function UT(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const l=Fa(t[o],i[o]);if(l)return l}return et(t.length,i.length)}function qa(n){return ap(n)}function ap(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Nr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Rr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Re.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const l of t.values||[])o?o=!1:i+=",",i+=ap(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const u of i)l?l=!1:o+=",",o+=`${u}:${ap(t.fields[u])}`;return o+"}"})(n.mapValue):Ve(61005,{value:n})}function xd(n){switch(Mr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lf(n);return e?16+xd(e):16;case 5:return 2*n.stringValue.length;case 6:return Rr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,l)=>o+xd(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return Co(i.fields,((l,u)=>{o+=l.length+xd(u)})),o})(n.mapValue);default:throw Ve(13486,{value:n})}}function lp(n){return!!n&&"integerValue"in n}function qp(n){return!!n&&"arrayValue"in n}function OT(n){return!!n&&"nullValue"in n}function jT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ed(n){return!!n&&"mapValue"in n}function Y2(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[ZE])==null?void 0:i.stringValue)===eb}function pu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Co(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=pu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pu(n.arrayValue.values[t]);return e}return{...n}}function J2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===$2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.value=e}static empty(){return new is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ed(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pu(t)}setAll(e){let t=on.emptyPath(),i={},o=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const g=this.getFieldsMap(t);this.applyChanges(g,i,o),i={},o=[],t=f.popLast()}u?i[f.lastSegment()]=pu(u):o.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,o)}delete(e){const t=this.field(e.popLast());Ed(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Ed(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){Co(t,((o,l)=>e[o]=l));for(const o of i)delete e[o]}clone(){return new is(pu(this.value))}}function tb(n){const e=[];return Co(n.fields,((t,i)=>{const o=new on([t]);if(Ed(i)){const l=tb(i.mapValue).fields;if(l.length===0)e.push(o);else for(const u of l)e.push(o.child(u))}else e.push(o)})),new vs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,t,i,o,l,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new yn(e,0,je.min(),je.min(),je.min(),is.empty(),0)}static newFoundDocument(e,t,i,o){return new yn(e,1,t,je.min(),i,o,0)}static newNoDocument(e,t){return new yn(e,2,t,je.min(),je.min(),is.empty(),0)}static newUnknownDocument(e,t){return new yn(e,3,t,je.min(),je.min(),is.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t){this.position=e,this.inclusive=t}}function FT(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const l=e[o],u=n.position[o];if(l.field.isKeyField()?i=Re.comparator(Re.fromName(u.referenceValue),t.key):i=Fa(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function qT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,t="asc"){this.field=e,this.dir=t}}function K2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{}class Wt extends nb{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new X2(e,t,i):t==="array-contains"?new eP(e,i):t==="in"?new tP(e,i):t==="not-in"?new nP(e,i):t==="array-contains-any"?new sP(e,i):new Wt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new W2(e,i):new Z2(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fa(t,this.value)):t!==null&&Mr(this.value)===Mr(t)&&this.matchesComparison(Fa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Qs extends nb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Qs(e,t)}matches(e){return sb(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function sb(n){return n.op==="and"}function ib(n){return Q2(n)&&sb(n)}function Q2(n){for(const e of n.filters)if(e instanceof Qs)return!1;return!0}function up(n){if(n instanceof Wt)return n.field.canonicalString()+n.op.toString()+qa(n.value);if(ib(n))return n.filters.map((e=>up(e))).join(",");{const e=n.filters.map((t=>up(t))).join(",");return`${n.op}(${e})`}}function rb(n,e){return n instanceof Wt?(function(i,o){return o instanceof Wt&&i.op===o.op&&i.field.isEqual(o.field)&&Ks(i.value,o.value)})(n,e):n instanceof Qs?(function(i,o){return o instanceof Qs&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((l,u,f)=>l&&rb(u,o.filters[f])),!0):!1})(n,e):void Ve(19439)}function ob(n){return n instanceof Wt?(function(t){return`${t.field.canonicalString()} ${t.op} ${qa(t.value)}`})(n):n instanceof Qs?(function(t){return t.op.toString()+" {"+t.getFilters().map(ob).join(" ,")+"}"})(n):"Filter"}class X2 extends Wt{constructor(e,t,i){super(e,t,i),this.key=Re.fromName(i.referenceValue)}matches(e){const t=Re.comparator(e.key,this.key);return this.matchesComparison(t)}}class W2 extends Wt{constructor(e,t){super(e,"in",t),this.keys=ab("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Z2 extends Wt{constructor(e,t){super(e,"not-in",t),this.keys=ab("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ab(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Re.fromName(i.referenceValue)))}class eP extends Wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qp(t)&&Au(t.arrayValue,this.value)}}class tP extends Wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Au(this.value.arrayValue,t)}}class nP extends Wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Au(this.value.arrayValue,t)}}class sP extends Wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Au(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,t=null,i=[],o=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function BT(n,e=null,t=[],i=[],o=null,l=null,u=null){return new iP(n,e,t,i,o,l,u)}function Bp(n){const e=Be(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>up(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),af(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>qa(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>qa(i))).join(",")),e.Te=t}return e.Te}function zp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!K2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!qT(n.startAt,e.startAt)&&qT(n.endAt,e.endAt)}function cp(n){return Re.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t=null,i=[],o=[],l=null,u="F",f=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function rP(n,e,t,i,o,l,u,f){return new uf(n,e,t,i,o,l,u,f)}function Hp(n){return new uf(n)}function zT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function oP(n){return n.collectionGroup!==null}function gu(n){const e=Be(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new Zt(on.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(f=f.add(m.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new jd(l,i))})),t.has(on.keyField().canonicalString())||e.Ie.push(new jd(on.keyField(),i))}return e.Ie}function Hs(n){const e=Be(n);return e.Ee||(e.Ee=aP(e,gu(n))),e.Ee}function aP(n,e){if(n.limitType==="F")return BT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new jd(o.field,l)}));const t=n.endAt?new Od(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Od(n.startAt.position,n.startAt.inclusive):null;return BT(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function dp(n,e,t){return new uf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cf(n,e){return zp(Hs(n),Hs(e))&&n.limitType===e.limitType}function lb(n){return`${Bp(Hs(n))}|lt:${n.limitType}`}function Ea(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>ob(o))).join(", ")}]`),af(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>qa(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>qa(o))).join(",")),`Target(${i})`})(Hs(n))}; limitType=${n.limitType})`}function df(n,e){return e.isFoundDocument()&&(function(i,o){const l=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Re.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,o){for(const l of gu(i))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const l of i.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(u,f,g){const m=FT(u,f,g);return u.inclusive?m<=0:m<0})(i.startAt,gu(i),o)||i.endAt&&!(function(u,f,g){const m=FT(u,f,g);return u.inclusive?m>=0:m>0})(i.endAt,gu(i),o))})(n,e)}function lP(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ub(n){return(e,t)=>{let i=!1;for(const o of gu(n)){const l=uP(o,e,t);if(l!==0)return l;i=i||o.field.isKeyField()}return 0}}function uP(n,e,t){const i=n.field.isKeyField()?Re.comparator(e.key,t.key):(function(l,u,f){const g=u.data.field(l),m=f.data.field(l);return g!==null&&m!==null?Fa(g,m):Ve(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ve(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,l]of i)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Co(this.inner,((t,i)=>{for(const[o,l]of i)e(o,l)}))}isEmpty(){return YE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP=new It(Re.comparator);function Li(){return cP}const cb=new It(Re.comparator);function du(...n){let e=cb;for(const t of n)e=e.insert(t.key,t);return e}function db(n){let e=cb;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function go(){return yu()}function fb(){return yu()}function yu(){return new wo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const dP=new It(Re.comparator),fP=new Zt(Re.comparator);function tt(...n){let e=fP;for(const t of n)e=e.add(t);return e}const hP=new Zt(et);function mP(){return hP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vd(e)?"-0":e}}function hb(n){return{integerValue:""+n}}function pP(n,e){return q2(e)?hb(e):Gp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this._=void 0}}function gP(n,e,t){return n instanceof Fd?(function(o,l){const u={fields:{[QE]:{stringValue:KE},[WE]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Fp(l)&&(l=lf(l)),l&&(u.fields[XE]=l),{mapValue:u}})(t,e):n instanceof Su?pb(n,e):n instanceof Cu?gb(n,e):(function(o,l){const u=mb(o,l),f=HT(u)+HT(o.Ae);return lp(u)&&lp(o.Ae)?hb(f):Gp(o.serializer,f)})(n,e)}function yP(n,e,t){return n instanceof Su?pb(n,e):n instanceof Cu?gb(n,e):t}function mb(n,e){return n instanceof qd?(function(i){return lp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Fd extends ff{}class Su extends ff{constructor(e){super(),this.elements=e}}function pb(n,e){const t=yb(e);for(const i of n.elements)t.some((o=>Ks(o,i)))||t.push(i);return{arrayValue:{values:t}}}class Cu extends ff{constructor(e){super(),this.elements=e}}function gb(n,e){let t=yb(e);for(const i of n.elements)t=t.filter((o=>!Ks(o,i)));return{arrayValue:{values:t}}}class qd extends ff{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function HT(n){return Ot(n.integerValue||n.doubleValue)}function yb(n){return qp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function vP(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Su&&o instanceof Su||i instanceof Cu&&o instanceof Cu?Oa(i.elements,o.elements,Ks):i instanceof qd&&o instanceof qd?Ks(i.Ae,o.Ae):i instanceof Fd&&o instanceof Fd})(n.transform,e.transform)}class _P{constructor(e,t){this.version=e,this.transformResults=t}}class Gs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gs}static exists(e){return new Gs(void 0,e)}static updateTime(e){return new Gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class hf{}function vb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $p(n.key,Gs.none()):new Mu(n.key,n.data,Gs.none());{const t=n.data,i=is.empty();let o=new Zt(on.comparator);for(let l of e.fields)if(!o.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),o=o.add(l)}return new Io(n.key,i,new vs(o.toArray()),Gs.none())}}function TP(n,e,t){n instanceof Mu?(function(o,l,u){const f=o.value.clone(),g=$T(o.fieldTransforms,l,u.transformResults);f.setAll(g),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):n instanceof Io?(function(o,l,u){if(!bd(o.precondition,l))return void l.convertToUnknownDocument(u.version);const f=$T(o.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(_b(o)),g.setAll(f),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(o,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function vu(n,e,t,i){return n instanceof Mu?(function(l,u,f,g){if(!bd(l.precondition,u))return f;const m=l.value.clone(),T=YT(l.fieldTransforms,g,u);return m.setAll(T),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Io?(function(l,u,f,g){if(!bd(l.precondition,u))return f;const m=YT(l.fieldTransforms,g,u),T=u.data;return T.setAll(_b(l)),T.setAll(m),u.convertToFoundDocument(u.version,T).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((x=>x.field)))})(n,e,t,i):(function(l,u,f){return bd(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(n,e,t)}function xP(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),l=mb(i.transform,o||null);l!=null&&(t===null&&(t=is.empty()),t.set(i.field,l))}return t||null}function GT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&Oa(i,o,((l,u)=>vP(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mu extends hf{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Io extends hf{constructor(e,t,i,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function _b(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function $T(n,e,t){const i=new Map;ct(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const l=n[o],u=l.transform,f=e.data.field(l.field);i.set(l.field,yP(u,f,t[o]))}return i}function YT(n,e,t){const i=new Map;for(const o of n){const l=o.transform,u=t.data.field(o.field);i.set(o.field,gP(l,u,e))}return i}class $p extends hf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class EP extends hf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&TP(l,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=fb();return this.mutations.forEach((o=>{const l=e.get(o.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=t.has(o.key)?null:f;const g=vb(u,f);g!==null&&i.set(o.key,g),u.isValidDocument()||u.convertToNoDocument(je.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),tt())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,((t,i)=>GT(t,i)))&&Oa(this.baseMutations,e.baseMutations,((t,i)=>GT(t,i)))}}class Yp{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){ct(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return dP})();const l=e.mutations;for(let u=0;u<l.length;u++)o=o.insert(l[u].key,i[u].version);return new Yp(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,st;function CP(n){switch(n){case ce.OK:return Ve(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ve(15467,{code:n})}}function Tb(n){if(n===void 0)return ki("GRPC error has no .code"),ce.UNKNOWN;switch(n){case Jt.OK:return ce.OK;case Jt.CANCELLED:return ce.CANCELLED;case Jt.UNKNOWN:return ce.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return ce.INTERNAL;case Jt.UNAVAILABLE:return ce.UNAVAILABLE;case Jt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Jt.NOT_FOUND:return ce.NOT_FOUND;case Jt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Jt.ABORTED:return ce.ABORTED;case Jt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Jt.DATA_LOSS:return ce.DATA_LOSS;default:return Ve(39323,{code:n})}}(st=Jt||(Jt={}))[st.OK=0]="OK",st[st.CANCELLED=1]="CANCELLED",st[st.UNKNOWN=2]="UNKNOWN",st[st.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",st[st.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",st[st.NOT_FOUND=5]="NOT_FOUND",st[st.ALREADY_EXISTS=6]="ALREADY_EXISTS",st[st.PERMISSION_DENIED=7]="PERMISSION_DENIED",st[st.UNAUTHENTICATED=16]="UNAUTHENTICATED",st[st.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",st[st.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",st[st.ABORTED=10]="ABORTED",st[st.OUT_OF_RANGE=11]="OUT_OF_RANGE",st[st.UNIMPLEMENTED=12]="UNIMPLEMENTED",st[st.INTERNAL=13]="INTERNAL",st[st.UNAVAILABLE=14]="UNAVAILABLE",st[st.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=new Cr([4294967295,4294967295],0);function JT(n){const e=wP().encode(n),t=new kE;return t.update(e),new Uint8Array(t.digest())}function KT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Cr([t,i],0),new Cr([o,l],0)]}class Jp{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new fu(`Invalid padding: ${t}`);if(i<0)throw new fu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new fu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new fu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Cr.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(Cr.fromNumber(i)));return o.compare(IP)===1&&(o=new Cr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=JT(e),[i,o]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Jp(l,o,t);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const t=JT(e),[i,o]=KT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,o,l);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class fu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t,i,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,Du.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new mf(je.min(),o,new It(et),Li(),tt())}}class Du{constructor(e,t,i,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Du(i,t,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class xb{constructor(e,t){this.targetId=e,this.Ce=t}}class Eb{constructor(e,t,i=an.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class QT{constructor(){this.ve=0,this.Fe=XT(),this.Me=an.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=tt(),t=tt(),i=tt();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Ve(38017,{changeType:l})}})),new Du(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=XT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class NP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Li(),this.Je=hd(),this.He=hd(),this.Ye=new It(et)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(cp(l))if(i===0){const u=new Re(l.path);this.et(t,u,yn.newNoDocument(u,je.min()))}else ct(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const f=this.ut(e),g=f?this.ct(f,e,u):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:l=0}=t;let u,f;try{u=Rr(i).toUint8Array()}catch(g){if(g instanceof JE)return Eo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{f=new Jp(u,o,l)}catch(g){return Eo(g instanceof fu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&cp(f.target)){const g=new Re(f.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,yn.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.qe())}}));let i=tt();this.He.forEach(((l,u)=>{let f=!0;u.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const o=new mf(e,t,this.Ye,this.je,i);return this.je=Li(),this.Je=hd(),this.He=hd(),this.Ye=new It(et),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new QT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Zt(et),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Zt(et),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ee("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new QT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function hd(){return new It(Re.comparator)}function XT(){return new It(Re.comparator)}const RP={asc:"ASCENDING",desc:"DESCENDING"},MP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DP={and:"AND",or:"OR"};class PP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function fp(n,e){return n.useProto3Json||af(e)?e:{value:e}}function Bd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kP(n,e){return Bd(n,e.toTimestamp())}function $s(n){return ct(!!n,49232),je.fromTimestamp((function(t){const i=Nr(t);return new xt(i.seconds,i.nanos)})(n))}function Kp(n,e){return hp(n,e).canonicalString()}function hp(n,e){const t=(function(o){return new St(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Ab(n){const e=St.fromString(n);return ct(Nb(e),10190,{key:e.toString()}),e}function mp(n,e){return Kp(n.databaseId,e.path)}function Vm(n,e){const t=Ab(e);if(t.get(1)!==n.databaseId.projectId)throw new Se(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Se(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Re(Cb(t))}function Sb(n,e){return Kp(n.databaseId,e)}function VP(n){const e=Ab(n);return e.length===4?St.emptyPath():Cb(e)}function pp(n){return new St(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cb(n){return ct(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function WT(n,e,t){return{name:mp(n,e),fields:t.value.mapValue.fields}}function LP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ve(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(m,T){return m.useProto3Json?(ct(T===void 0||typeof T=="string",58123),an.fromBase64String(T||"")):(ct(T===void 0||T instanceof Buffer||T instanceof Uint8Array,16193),an.fromUint8Array(T||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(m){const T=m.code===void 0?ce.UNKNOWN:Tb(m.code);return new Se(T,m.message||"")})(u);t=new Eb(i,o,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=Vm(n,i.document.name),l=$s(i.document.updateTime),u=i.document.createTime?$s(i.document.createTime):je.min(),f=new is({mapValue:{fields:i.document.fields}}),g=yn.newFoundDocument(o,l,u,f),m=i.targetIds||[],T=i.removedTargetIds||[];t=new Ad(m,T,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=Vm(n,i.document),l=i.readTime?$s(i.readTime):je.min(),u=yn.newNoDocument(o,l),f=i.removedTargetIds||[];t=new Ad([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=Vm(n,i.document),l=i.removedTargetIds||[];t=new Ad([],l,o,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:l}=i,u=new SP(o,l),f=i.targetId;t=new xb(f,u)}}return t}function UP(n,e){let t;if(e instanceof Mu)t={update:WT(n,e.key,e.value)};else if(e instanceof $p)t={delete:mp(n,e.key)};else if(e instanceof Io)t={update:WT(n,e.key,e.data),updateMask:$P(e.fieldMask)};else{if(!(e instanceof EP))return Ve(16599,{Vt:e.type});t={verify:mp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof Fd)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Su)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Cu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof qd)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw Ve(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:kP(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ve(27497)})(n,e.precondition)),t}function OP(n,e){return n&&n.length>0?(ct(e!==void 0,14353),n.map((t=>(function(o,l){let u=o.updateTime?$s(o.updateTime):$s(l);return u.isEqual(je.min())&&(u=$s(l)),new _P(u,o.transformResults||[])})(t,e)))):[]}function jP(n,e){return{documents:[Sb(n,e.path)]}}function FP(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Sb(n,o);const l=(function(m){if(m.length!==0)return Ib(Qs.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((T=>(function(b){return{field:ba(b.field),direction:zP(b.dir)}})(T)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=fp(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:o}}function qP(n){let e=VP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){ct(i===1,65062);const T=t.from[0];T.allDescendants?o=T.collectionId:e=e.child(T.collectionId)}let l=[];t.where&&(l=(function(x){const b=wb(x);return b instanceof Qs&&ib(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((b=>(function(L){return new jd(Aa(L.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(L.direction))})(b)))})(t.orderBy));let f=null;t.limit&&(f=(function(x){let b;return b=typeof x=="object"?x.value:x,af(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(x){const b=!!x.before,w=x.values||[];return new Od(w,b)})(t.startAt));let m=null;return t.endAt&&(m=(function(x){const b=!x.before,w=x.values||[];return new Od(w,b)})(t.endAt)),rP(e,o,u,l,f,"F",g,m)}function BP(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function wb(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Aa(t.unaryFilter.field);return Wt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=Aa(t.unaryFilter.field);return Wt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Aa(t.unaryFilter.field);return Wt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Aa(t.unaryFilter.field);return Wt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Wt.create(Aa(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Qs.create(t.compositeFilter.filters.map((i=>wb(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(t.compositeFilter.op))})(n):Ve(30097,{filter:n})}function zP(n){return RP[n]}function HP(n){return MP[n]}function GP(n){return DP[n]}function ba(n){return{fieldPath:n.canonicalString()}}function Aa(n){return on.fromServerFormat(n.fieldPath)}function Ib(n){return n instanceof Wt?(function(t){if(t.op==="=="){if(jT(t.value))return{unaryFilter:{field:ba(t.field),op:"IS_NAN"}};if(OT(t.value))return{unaryFilter:{field:ba(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jT(t.value))return{unaryFilter:{field:ba(t.field),op:"IS_NOT_NAN"}};if(OT(t.value))return{unaryFilter:{field:ba(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ba(t.field),op:HP(t.op),value:t.value}}})(n):n instanceof Qs?(function(t){const i=t.getFilters().map((o=>Ib(o)));return i.length===1?i[0]:{compositeFilter:{op:GP(t.op),filters:i}}})(n):Ve(54877,{filter:n})}function $P(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Nb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,t,i,o,l=je.min(),u=je.min(),f=an.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=g}withSequenceNumber(e){return new Er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.yt=e}}function JP(n){const e=qP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.Cn=new QP}addToCollectionParentIndex(e,t){return this.Cn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Ir.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Ir.min())}updateCollectionGroup(e,t,i){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class QP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new Zt(St.comparator),l=!o.has(i);return this.index[t]=o.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new Zt(St.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rb=41943040;class Dn{static withCacheSize(e){return new Dn(e,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dn.DEFAULT_COLLECTION_PERCENTILE=10,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dn.DEFAULT=new Dn(Rb,Dn.DEFAULT_COLLECTION_PERCENTILE,Dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dn.DISABLED=new Dn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ba(0)}static cr(){return new Ba(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="LruGarbageCollector",XP=1048576;function tx([n,e],[t,i]){const o=et(n,t);return o===0?et(e,i):o}class WP{constructor(e){this.Ir=e,this.buffer=new Zt(tx),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ZP{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ee(ex,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tl(t)?Ee(ex,"Ignoring IndexedDB error during garbage collection: ",t):await el(t)}await this.Vr(3e5)}))}}class ek{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(of.ce);const i=new WP(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(ZT)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,l,u,f,g,m;const T=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,u=Date.now(),this.nthSequenceNumber(e,o)))).next((x=>(i=x,f=Date.now(),this.removeTargets(e,i,t)))).next((x=>(l=x,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((x=>(m=Date.now(),xa()<=Ze.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-T}ms
	Determined least recently used ${o} in `+(f-u)+`ms
	Removed ${l} targets in `+(g-f)+`ms
	Removed ${x} documents in `+(m-g)+`ms
Total Duration: ${m-T}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:x}))))}}function tk(n,e){return new ek(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(){this.changes=new wo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ue.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&vu(i.mutation,o,vs.empty(),xt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,tt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=tt()){const o=go();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((l=>{let u=du();return l.forEach(((f,g)=>{u=u.insert(f,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=go();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,tt())))}populateOverlays(e,t,i){const o=[];return i.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,i,o){let l=Li();const u=yu(),f=(function(){return yu()})();return t.forEach(((g,m)=>{const T=i.get(m.key);o.has(m.key)&&(T===void 0||T.mutation instanceof Io)?l=l.insert(m.key,m):T!==void 0?(u.set(m.key,T.mutation.getFieldMask()),vu(T.mutation,m,T.mutation.getFieldMask(),xt.now())):u.set(m.key,vs.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,T)=>u.set(m,T))),t.forEach(((m,T)=>f.set(m,new sk(T,u.get(m)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=yu();let o=new It(((u,f)=>u-f)),l=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let T=i.get(g)||vs.empty();T=f.applyToLocalView(m,T),i.set(g,T);const x=(o.get(f.batchId)||tt()).add(g);o=o.insert(f.batchId,x)}))})).next((()=>{const u=[],f=o.getReverseIterator();for(;f.hasNext();){const g=f.getNext(),m=g.key,T=g.value,x=fb();T.forEach((b=>{if(!l.has(b)){const w=vb(t.get(b),i.get(b));w!==null&&x.set(b,w),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,x))}return ue.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(u){return Re.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((l=>{const u=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-l.size):ue.resolve(go());let f=Eu,g=l;return u.next((m=>ue.forEach(m,((T,x)=>(f<x.largestBatchId&&(f=x.largestBatchId),l.get(T)?ue.resolve():this.remoteDocumentCache.getEntry(e,T).next((b=>{g=g.insert(T,b)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,tt()))).next((T=>({batchId:f,changes:db(T)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Re(t)).next((i=>{let o=du();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const l=t.collectionGroup;let u=du();return this.indexManager.getCollectionParents(e,l).next((f=>ue.forEach(f,(g=>{const m=(function(x,b){return new uf(b,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,o).next((T=>{T.forEach(((x,b)=>{u=u.insert(x,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,o)))).next((u=>{l.forEach(((g,m)=>{const T=m.getKey();u.get(T)===null&&(u=u.insert(T,yn.newInvalidDocument(T)))}));let f=du();return u.forEach(((g,m)=>{const T=l.get(g);T!==void 0&&vu(T.mutation,m,vs.empty(),xt.now()),df(t,m)&&(f=f.insert(g,m))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ue.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:$s(o.createTime)}})(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:JP(o.bundledQuery),readTime:$s(o.readTime)}})(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this.overlays=new It(Re.comparator),this.qr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const i=go();return ue.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&i.set(o,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,l)=>{this.St(e,t,l)})),ue.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ue.resolve()}getOverlaysForCollection(e,t,i){const o=go(),l=t.length+1,u=new Re(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const g=f.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&o.set(g.getKey(),g)}return ue.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let l=new It(((m,T)=>m-T));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let T=l.get(m.largestBatchId);T===null&&(T=go(),l=l.insert(m.largestBatchId,T)),T.set(m.getKey(),m)}}const f=go(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,T)=>f.set(m,T))),!(f.size()>=o)););return ue.resolve(f)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new AP(t,i));let l=this.qr.get(t);l===void 0&&(l=tt(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.Qr=new Zt(rn.$r),this.Ur=new Zt(rn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new rn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new rn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Re(new St([])),i=new rn(t,e),o=new rn(t,e+1),l=[];return this.Ur.forEachInRange([i,o],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Re(new St([])),i=new rn(t,e),o=new rn(t,e+1);let l=tt();return this.Ur.forEachInRange([i,o],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new rn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class rn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Re.comparator(e.key,t.key)||et(e.Yr,t.Yr)}static Kr(e,t){return et(e.Yr,t.Yr)||Re.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Zt(rn.$r)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new bP(l,t,i,o);this.mutationQueue.push(u);for(const f of o)this.Zr=this.Zr.add(new rn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ue.resolve(u)}lookupMutationBatch(e,t){return ue.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),l=o<0?0:o;return ue.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?jp:this.tr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new rn(t,0),o=new rn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,o],(u=>{const f=this.Xr(u.Yr);l.push(f)})),ue.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Zt(et);return t.forEach((o=>{const l=new rn(o,0),u=new rn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(f=>{i=i.add(f.Yr)}))})),ue.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let l=i;Re.isDocumentKey(l)||(l=l.child(""));const u=new rn(new Re(l),0);let f=new Zt(et);return this.Zr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===o&&(f=f.add(g.Yr)),!0)}),u),ue.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){ct(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ue.forEach(t.mutations,(o=>{const l=new rn(o.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new rn(t,0),o=this.Zr.firstAfterOrEqual(i);return ue.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e){this.ri=e,this.docs=(function(){return new It(Re.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),l=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ue.resolve(i?i.document.mutableCopy():yn.newInvalidDocument(t))}getEntries(e,t){let i=Li();return t.forEach((o=>{const l=this.docs.get(o);i=i.insert(o,l?l.document.mutableCopy():yn.newInvalidDocument(o))})),ue.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let l=Li();const u=t.path,f=new Re(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(f);for(;g.hasNext();){const{key:m,value:{document:T}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||U2(L2(T),i)<=0||(o.has(T.key)||df(t,T))&&(l=l.insert(T.key,T.mutableCopy()))}return ue.resolve(l)}getAllFromCollectionGroup(e,t,i,o){Ve(9500)}ii(e,t){return ue.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new ck(this)}getSize(e){return ue.resolve(this.size)}}class ck extends nk{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),ue.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.persistence=e,this.si=new wo((t=>Bp(t)),zp),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.oi=0,this._i=new Qp,this.targetCount=0,this.ai=Ba.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),ue.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ba(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Pr(t),ue.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,i){let o=0;const l=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)})),ue.waitFor(l).next((()=>o))}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return ue.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),ue.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((u=>{l.push(o.markPotentiallyOrphaned(e,u))})),ue.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return ue.resolve(i)}containsKey(e,t){return ue.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,t){this.ui={},this.overlays={},this.ci=new of(0),this.li=!1,this.li=!0,this.hi=new ak,this.referenceDelegate=e(this),this.Pi=new dk(this),this.indexManager=new KP,this.remoteDocumentCache=(function(o){return new uk(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new YP(t),this.Ii=new rk(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ok,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new lk(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ee("MemoryPersistence","Starting transaction:",e);const o=new fk(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return ue.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class fk extends j2{constructor(e){super(),this.currentSequenceNumber=e}}class Xp{constructor(e){this.persistence=e,this.Ri=new Qp,this.Vi=null}static mi(e){return new Xp(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),ue.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.fi,(i=>{const o=Re.fromPath(i);return this.gi(e,o).next((l=>{l||t.removeEntry(o,je.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ue.or([()=>ue.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class zd{constructor(e,t){this.persistence=e,this.pi=new wo((i=>B2(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=tk(this,t)}static mi(e,t){return new zd(e,t)}Ei(){}di(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return ue.forEach(this.pi,((i,o)=>this.br(e,i,o).next((l=>l?ue.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((f=>{f||(i++,l.removeEntry(u,je.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=xd(e.data.value)),t}br(e,t,i){return ue.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return ue.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=tt(),o=tt();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Wp(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return oD()?8:F2(_n())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const l={result:null};return this.ys(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,t,o,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new hk;return this.Ss(e,t,u).next((f=>{if(l.result=f,this.Vs)return this.bs(e,t,u,f.size)}))})).next((()=>l.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(xa()<=Ze.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",Ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ue.resolve()):(xa()<=Ze.DEBUG&&Ee("QueryEngine","Query:",Ea(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(xa()<=Ze.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",Ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hs(t))):ue.resolve())}ys(e,t){if(zT(t))return ue.resolve(null);let i=Hs(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=dp(t,null,"F"),i=Hs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=tt(...l);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.Ds(t,f);return this.Cs(t,m,u,g.readTime)?this.ys(e,dp(t,null,"F")):this.vs(e,m,t,g)}))))})))))}ws(e,t,i,o){return zT(t)||o.isEqual(je.min())?ue.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(t,l);return this.Cs(t,u,i,o)?ue.resolve(null):(xa()<=Ze.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ea(t)),this.vs(e,u,t,V2(o,Eu)).next((f=>f)))}))}Ds(e,t){let i=new Zt(ub(e));return t.forEach(((o,l)=>{df(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,i){return xa()<=Ze.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",Ea(t)),this.ps.getDocumentsMatchingQuery(e,t,Ir.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="LocalStore",pk=3e8;class gk{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new It(et),this.xs=new wo((l=>Bp(l)),zp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ik(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function yk(n,e,t,i){return new gk(n,e,t,i)}async function Db(n,e){const t=Be(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let g=tt();for(const m of o){u.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}for(const m of l){f.push(m.batchId);for(const T of m.mutations)g=g.add(T.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ls:m,removedBatchIds:u,addedBatchIds:f})))}))}))}function vk(n,e){const t=Be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,g,m,T){const x=m.batch,b=x.keys();let w=ue.resolve();return b.forEach((L=>{w=w.next((()=>T.getEntry(g,L))).next((k=>{const j=m.docVersions.get(L);ct(j!==null,48541),k.version.compareTo(j)<0&&(x.applyToRemoteDocument(k,m),k.isValidDocument()&&(k.setReadTime(m.commitVersion),T.addEntry(k)))}))})),w.next((()=>f.mutationQueue.removeMutationBatch(g,x)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let g=tt();for(let m=0;m<f.mutationResults.length;++m)f.mutationResults[m].transformResults.length>0&&(g=g.add(f.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function Pb(n){const e=Be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function _k(n,e){const t=Be(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const f=[];e.targetChanges.forEach(((T,x)=>{const b=o.get(x);if(!b)return;f.push(t.Pi.removeMatchingKeys(l,T.removedDocuments,x).next((()=>t.Pi.addMatchingKeys(l,T.addedDocuments,x))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(x)!==null?w=w.withResumeToken(an.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):T.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(T.resumeToken,i)),o=o.insert(x,w),(function(k,j,Y){return k.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=pk?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(b,w,T)&&f.push(t.Pi.updateTargetData(l,w))}));let g=Li(),m=tt();if(e.documentUpdates.forEach((T=>{e.resolvedLimboDocuments.has(T)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,T))})),f.push(Tk(l,u,e.documentUpdates).next((T=>{g=T.ks,m=T.qs}))),!i.isEqual(je.min())){const T=t.Pi.getLastRemoteSnapshotVersion(l).next((x=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(T)}return ue.waitFor(f).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.Ms=o,l)))}function Tk(n,e,t){let i=tt(),o=tt();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=Li();return t.forEach(((f,g)=>{const m=l.get(f);g.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(f)),g.isNoDocument()&&g.version.isEqual(je.min())?(e.removeEntry(f,g.readTime),u=u.insert(f,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(f,g)):Ee(Zp,"Ignoring outdated watch update for ",f,". Current version:",m.version," Watch version:",g.version)})),{ks:u,qs:o}}))}function xk(n,e){const t=Be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=jp),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Ek(n,e){const t=Be(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((l=>l?(o=l,ue.resolve(o)):t.Pi.allocateTargetId(i).next((u=>(o=new Er(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function gp(n,e,t){const i=Be(n),o=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!tl(u))throw u;Ee(Zp,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function nx(n,e,t){const i=Be(n);let o=je.min(),l=tt();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,m,T){const x=Be(g),b=x.xs.get(T);return b!==void 0?ue.resolve(x.Ms.get(b)):x.Pi.getTargetData(m,T)})(i,u,Hs(e)).next((f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?o:je.min(),t?l:tt()))).next((f=>(bk(i,lP(e),f),{documents:f,Qs:l})))))}function bk(n,e,t){let i=n.Os.get(e)||je.min();t.forEach(((o,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class sx{constructor(){this.activeTargetIds=mP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ak{constructor(){this.Mo=new sx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new sx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix="ConnectivityMonitor";class rx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ee(ix,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ee(ix,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md=null;function yp(){return md===null?md=(function(){return 268435456+Math.round(2147483648*Math.random())})():md++,"0x"+md.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="RestConnection",Ck={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wk{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===Ld?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,l){const u=yp(),f=this.zo(e,t.toUriEncodedString());Ee(Lm,`Sending RPC '${e}' ${u}:`,f,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,o,l);const{host:m}=new URL(f),T=Xa(m);return this.Jo(e,f,g,i,T).then((x=>(Ee(Lm,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw Eo(Lm,`RPC '${e}' ${u} failed with error: `,x,"url: ",f,"request:",i),x}))}Ho(e,t,i,o,l,u){return this.Go(e,t,i,o,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Za})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),i&&i.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const i=Ck[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn="WebChannelConnection";class Nk extends wk{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,l){const u=yp();return new Promise(((f,g)=>{const m=new VE;m.setWithCredentials(!0),m.listenOnce(LE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Td.NO_ERROR:const x=m.getResponseJson();Ee(pn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),f(x);break;case Td.TIMEOUT:Ee(pn,`RPC '${e}' ${u} timed out`),g(new Se(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Td.HTTP_ERROR:const b=m.getStatus();if(Ee(pn,`RPC '${e}' ${u} failed with status:`,b,"response text:",m.getResponseText()),b>0){let w=m.getResponseJson();Array.isArray(w)&&(w=w[0]);const L=w==null?void 0:w.error;if(L&&L.status&&L.message){const k=(function(Y){const O=Y.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(O)>=0?O:ce.UNKNOWN})(L.status);g(new Se(k,L.message))}else g(new Se(ce.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new Se(ce.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ee(pn,`RPC '${e}' ${u} completed.`)}}));const T=JSON.stringify(o);Ee(pn,`RPC '${e}' ${u} sending request:`,o),m.send(t,"POST",T,i,15)}))}T_(e,t,i){const o=yp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=jE(),f=OE(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(g.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const T=l.join("");Ee(pn,`Creating RPC '${e}' stream ${o}: ${T}`,g);const x=u.createWebChannel(T,g);this.I_(x);let b=!1,w=!1;const L=new Ik({Yo:j=>{w?Ee(pn,`Not sending because RPC '${e}' stream ${o} is closed:`,j):(b||(Ee(pn,`Opening RPC '${e}' stream ${o} transport.`),x.open(),b=!0),Ee(pn,`RPC '${e}' stream ${o} sending:`,j),x.send(j))},Zo:()=>x.close()}),k=(j,Y,O)=>{j.listen(Y,(B=>{try{O(B)}catch(ne){setTimeout((()=>{throw ne}),0)}}))};return k(x,cu.EventType.OPEN,(()=>{w||(Ee(pn,`RPC '${e}' stream ${o} transport opened.`),L.o_())})),k(x,cu.EventType.CLOSE,(()=>{w||(w=!0,Ee(pn,`RPC '${e}' stream ${o} transport closed`),L.a_(),this.E_(x))})),k(x,cu.EventType.ERROR,(j=>{w||(w=!0,Eo(pn,`RPC '${e}' stream ${o} transport errored. Name:`,j.name,"Message:",j.message),L.a_(new Se(ce.UNAVAILABLE,"The operation could not be completed")))})),k(x,cu.EventType.MESSAGE,(j=>{var Y;if(!w){const O=j.data[0];ct(!!O,16349);const B=O,ne=(B==null?void 0:B.error)||((Y=B[0])==null?void 0:Y.error);if(ne){Ee(pn,`RPC '${e}' stream ${o} received error:`,ne);const ie=ne.status;let H=(function(R){const M=Jt[R];if(M!==void 0)return Tb(M)})(ie),N=ne.message;H===void 0&&(H=ce.INTERNAL,N="Unknown error status: "+ie+" with message "+ne.message),w=!0,L.a_(new Se(H,N)),x.close()}else Ee(pn,`RPC '${e}' stream ${o} received:`,O),L.u_(O)}})),k(f,UE.STAT_EVENT,(j=>{j.stat===rp.PROXY?Ee(pn,`RPC '${e}' stream ${o} detected buffering proxy`):j.stat===rp.NOPROXY&&Ee(pn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{L.__()}),0),L}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Um(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(n){return new PP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,t,i=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&Ee("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="PersistentStream";class Vb{constructor(e,t,i,o,l,u,f,g){this.Mi=e,this.S_=i,this.b_=o,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new kb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(ki(t.toString()),ki("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Se(ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ee(ox,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ee(ox,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Rk extends Vb{constructor(e,t,i,o,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=LP(this.serializer,e),i=(function(l){if(!("targetChange"in l))return je.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?je.min():u.readTime?$s(u.readTime):je.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=pp(this.serializer),t.addTarget=(function(l,u){let f;const g=u.target;if(f=cp(g)?{documents:jP(l,g)}:{query:FP(l,g).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=bb(l,u.resumeToken);const m=fp(l,u.expectedCount);m!==null&&(f.expectedCount=m)}else if(u.snapshotVersion.compareTo(je.min())>0){f.readTime=Bd(l,u.snapshotVersion.toTimestamp());const m=fp(l,u.expectedCount);m!==null&&(f.expectedCount=m)}return f})(this.serializer,e);const i=BP(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=pp(this.serializer),t.removeTarget=e,this.q_(t)}}class Mk extends Vb{constructor(e,t,i,o,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=OP(e.writeResults,e.commitTime),i=$s(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=pp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>UP(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{}class Pk extends Dk{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Se(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,hp(t,i),o,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Se(ce.UNKNOWN,l.toString())}))}Ho(e,t,i,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,hp(t,i),o,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Se(ce.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class kk{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ki(t),this.aa=!1):Ee("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo="RemoteStore";class Vk{constructor(e,t,i,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{No(this)&&(Ee(bo,"Restarting streams for network reachability change."),await(async function(g){const m=Be(g);m.Ea.add(4),await Pu(m),m.Ra.set("Unknown"),m.Ea.delete(4),await gf(m)})(this))}))})),this.Ra=new kk(i,o)}}async function gf(n){if(No(n))for(const e of n.da)await e(!0)}async function Pu(n){for(const e of n.da)await e(!1)}function Lb(n,e){const t=Be(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sg(t)?ng(t):nl(t).O_()&&tg(t,e))}function eg(n,e){const t=Be(n),i=nl(t);t.Ia.delete(e),i.O_()&&Ub(t,e),t.Ia.size===0&&(i.O_()?i.L_():No(t)&&t.Ra.set("Unknown"))}function tg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nl(n).Y_(e)}function Ub(n,e){n.Va.Ue(e),nl(n).Z_(e)}function ng(n){n.Va=new NP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),nl(n).start(),n.Ra.ua()}function sg(n){return No(n)&&!nl(n).x_()&&n.Ia.size>0}function No(n){return Be(n).Ea.size===0}function Ob(n){n.Va=void 0}async function Lk(n){n.Ra.set("Online")}async function Uk(n){n.Ia.forEach(((e,t)=>{tg(n,e)}))}async function Ok(n,e){Ob(n),sg(n)?(n.Ra.ha(e),ng(n)):n.Ra.set("Unknown")}async function jk(n,e,t){if(n.Ra.set("Online"),e instanceof Eb&&e.state===2&&e.cause)try{await(async function(o,l){const u=l.cause;for(const f of l.targetIds)o.Ia.has(f)&&(await o.remoteSyncer.rejectListen(f,u),o.Ia.delete(f),o.Va.removeTarget(f))})(n,e)}catch(i){Ee(bo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Hd(n,i)}else if(e instanceof Ad?n.Va.Ze(e):e instanceof xb?n.Va.st(e):n.Va.tt(e),!t.isEqual(je.min()))try{const i=await Pb(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const f=l.Va.Tt(u);return f.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const T=l.Ia.get(m);T&&l.Ia.set(m,T.withResumeToken(g.resumeToken,u))}})),f.targetMismatches.forEach(((g,m)=>{const T=l.Ia.get(g);if(!T)return;l.Ia.set(g,T.withResumeToken(an.EMPTY_BYTE_STRING,T.snapshotVersion)),Ub(l,g);const x=new Er(T.target,g,m,T.sequenceNumber);tg(l,x)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(i){Ee(bo,"Failed to raise snapshot:",i),await Hd(n,i)}}async function Hd(n,e,t){if(!tl(e))throw e;n.Ea.add(1),await Pu(n),n.Ra.set("Offline"),t||(t=()=>Pb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ee(bo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await gf(n)}))}function jb(n,e){return e().catch((t=>Hd(n,t,e)))}async function yf(n){const e=Be(n),t=Dr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jp;for(;Fk(e);)try{const o=await xk(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,qk(e,o)}catch(o){await Hd(e,o)}Fb(e)&&qb(e)}function Fk(n){return No(n)&&n.Ta.length<10}function qk(n,e){n.Ta.push(e);const t=Dr(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Fb(n){return No(n)&&!Dr(n).x_()&&n.Ta.length>0}function qb(n){Dr(n).start()}async function Bk(n){Dr(n).ra()}async function zk(n){const e=Dr(n);for(const t of n.Ta)e.ea(t.mutations)}async function Hk(n,e,t){const i=n.Ta.shift(),o=Yp.from(i,e,t);await jb(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await yf(n)}async function Gk(n,e){e&&Dr(n).X_&&await(async function(i,o){if((function(u){return CP(u)&&u!==ce.ABORTED})(o.code)){const l=i.Ta.shift();Dr(i).B_(),await jb(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,o))),await yf(i)}})(n,e),Fb(n)&&qb(n)}async function ax(n,e){const t=Be(n);t.asyncQueue.verifyOperationInProgress(),Ee(bo,"RemoteStore received new credentials");const i=No(t);t.Ea.add(3),await Pu(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await gf(t)}async function $k(n,e){const t=Be(n);e?(t.Ea.delete(2),await gf(t)):e||(t.Ea.add(2),await Pu(t),t.Ra.set("Unknown"))}function nl(n){return n.ma||(n.ma=(function(t,i,o){const l=Be(t);return l.sa(),new Rk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:Lk.bind(null,n),t_:Uk.bind(null,n),r_:Ok.bind(null,n),H_:jk.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),sg(n)?ng(n):n.Ra.set("Unknown")):(await n.ma.stop(),Ob(n))}))),n.ma}function Dr(n){return n.fa||(n.fa=(function(t,i,o){const l=Be(t);return l.sa(),new Mk(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Bk.bind(null,n),r_:Gk.bind(null,n),ta:zk.bind(null,n),na:Hk.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await yf(n)):(await n.fa.stop(),n.Ta.length>0&&(Ee(bo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,t,i,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=l,this.deferred=new Ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,l){const u=Date.now()+i,f=new ig(e,t,u,o,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rg(n,e){if(ki("AsyncQueue",`${e}: ${n}`),tl(n))return new Se(ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{static emptySet(e){return new Da(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Re.comparator(t.key,i.key):(t,i)=>Re.comparator(t.key,i.key),this.keyedMap=du(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Da)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=i.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Da;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(){this.ga=new It(Re.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class za{constructor(e,t,i,o,l,u,f,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,o,l){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new za(e,t,Da.emptySet(t),u,i,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Jk{constructor(){this.queries=ux(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=Be(t),l=o.queries;o.queries=ux(),l.forEach(((u,f)=>{for(const g of f.Sa)g.onError(i)}))})(this,new Se(ce.ABORTED,"Firestore shutting down"))}}function ux(){return new wo((n=>lb(n)),cf)}async function Bb(n,e){const t=Be(n);let i=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(i=2):(l=new Yk,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const f=rg(u,`Initialization of query '${Ea(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&og(t)}async function zb(n,e){const t=Be(n),i=e.query;let o=3;const l=t.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Kk(n,e){const t=Be(n);let i=!1;for(const o of e){const l=o.query,u=t.queries.get(l);if(u){for(const f of u.Sa)f.Fa(o)&&(i=!0);u.wa=o}}i&&og(t)}function Qk(n,e,t){const i=Be(n),o=i.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);i.queries.delete(e)}function og(n){n.Ca.forEach((e=>{e.next()}))}var vp,cx;(cx=vp||(vp={})).Ma="default",cx.Cache="cache";class Hb{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new za(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=za.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e){this.key=e}}class $b{constructor(e){this.key=e}}class Xk{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=tt(),this.mutatedKeys=tt(),this.eu=ub(e),this.tu=new Da(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new lx,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=o,f=!1;const g=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((T,x)=>{const b=o.get(T),w=df(this.query,x)?x:null,L=!!b&&this.mutatedKeys.has(b.key),k=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let j=!1;b&&w?b.data.isEqual(w.data)?L!==k&&(i.track({type:3,doc:w}),j=!0):this.su(b,w)||(i.track({type:2,doc:w}),j=!0,(g&&this.eu(w,g)>0||m&&this.eu(w,m)<0)&&(f=!0)):!b&&w?(i.track({type:0,doc:w}),j=!0):b&&!w&&(i.track({type:1,doc:b}),j=!0,(g||m)&&(f=!0)),j&&(w?(u=u.add(w),l=k?l.add(T):l.delete(T)):(u=u.delete(T),l=l.delete(T)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const T=this.query.limitType==="F"?u.last():u.first();u=u.delete(T.key),l=l.delete(T.key),i.track({type:1,doc:T})}return{tu:u,iu:i,Cs:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((T,x)=>(function(w,L){const k=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:j})}};return k(w)-k(L)})(T.type,x.type)||this.eu(T.doc,x.doc))),this.ou(i),o=o??!1;const f=t&&!o?this._u():[],g=this.Xa.size===0&&this.current&&!o?1:0,m=g!==this.Za;return this.Za=g,u.length!==0||m?{snapshot:new za(this.query,e.tu,l,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=tt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new $b(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Gb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=tt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return za.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ag="SyncEngine";class Wk{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Zk{constructor(e){this.key=e,this.hu=!1}}class eV{constructor(e,t,i,o,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new wo((f=>lb(f)),cf),this.Iu=new Map,this.Eu=new Set,this.du=new It(Re.comparator),this.Au=new Map,this.Ru=new Qp,this.Vu={},this.mu=new Map,this.fu=Ba.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function tV(n,e,t=!0){const i=Wb(n);let o;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await Yb(i,e,t,!0),o}async function nV(n,e){const t=Wb(n);await Yb(t,e,!0,!1)}async function Yb(n,e,t,i){const o=await Ek(n.localStore,Hs(e)),l=o.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let f;return i&&(f=await sV(n,e,l,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&Lb(n.remoteStore,o),f}async function sV(n,e,t,i,o){n.pu=(x,b,w)=>(async function(k,j,Y,O){let B=j.view.ru(Y);B.Cs&&(B=await nx(k.localStore,j.query,!1).then((({documents:N})=>j.view.ru(N,B))));const ne=O&&O.targetChanges.get(j.targetId),ie=O&&O.targetMismatches.get(j.targetId)!=null,H=j.view.applyChanges(B,k.isPrimaryClient,ne,ie);return fx(k,j.targetId,H.au),H.snapshot})(n,x,b,w);const l=await nx(n.localStore,e,!0),u=new Xk(e,l.Qs),f=u.ru(l.documents),g=Du.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),m=u.applyChanges(f,n.isPrimaryClient,g);fx(n,t,m.au);const T=new Wk(e,t,u);return n.Tu.set(e,T),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function iV(n,e,t){const i=Be(n),o=i.Tu.get(e),l=i.Iu.get(o.targetId);if(l.length>1)return i.Iu.set(o.targetId,l.filter((u=>!cf(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await gp(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&eg(i.remoteStore,o.targetId),_p(i,o.targetId)})).catch(el)):(_p(i,o.targetId),await gp(i.localStore,o.targetId,!0))}async function rV(n,e){const t=Be(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),eg(t.remoteStore,i.targetId))}async function oV(n,e,t){const i=hV(n);try{const o=await(function(u,f){const g=Be(u),m=xt.now(),T=f.reduce(((w,L)=>w.add(L.key)),tt());let x,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let L=Li(),k=tt();return g.Ns.getEntries(w,T).next((j=>{L=j,L.forEach(((Y,O)=>{O.isValidDocument()||(k=k.add(Y))}))})).next((()=>g.localDocuments.getOverlayedDocuments(w,L))).next((j=>{x=j;const Y=[];for(const O of f){const B=xP(O,x.get(O.key).overlayedDocument);B!=null&&Y.push(new Io(O.key,B,tb(B.value.mapValue),Gs.exists(!0)))}return g.mutationQueue.addMutationBatch(w,m,Y,f)})).next((j=>{b=j;const Y=j.applyToLocalDocumentSet(x,k);return g.documentOverlayCache.saveOverlays(w,j.batchId,Y)}))})).then((()=>({batchId:b.batchId,changes:db(x)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(u,f,g){let m=u.Vu[u.currentUser.toKey()];m||(m=new It(et)),m=m.insert(f,g),u.Vu[u.currentUser.toKey()]=m})(i,o.batchId,t),await ku(i,o.changes),await yf(i.remoteStore)}catch(o){const l=rg(o,"Failed to persist write");t.reject(l)}}async function Jb(n,e){const t=Be(n);try{const i=await _k(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const u=t.Au.get(l);u&&(ct(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?ct(u.hu,14607):o.removedDocuments.size>0&&(ct(u.hu,42227),u.hu=!1))})),await ku(t,i,e)}catch(i){await el(i)}}function dx(n,e,t){const i=Be(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&o.push(f.snapshot)})),(function(u,f){const g=Be(u);g.onlineState=f;let m=!1;g.queries.forEach(((T,x)=>{for(const b of x.Sa)b.va(f)&&(m=!0)})),m&&og(g)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function aV(n,e,t){const i=Be(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),l=o&&o.key;if(l){let u=new It(Re.comparator);u=u.insert(l,yn.newNoDocument(l,je.min()));const f=tt().add(l),g=new mf(je.min(),new Map,new It(et),u,f);await Jb(i,g),i.du=i.du.remove(l),i.Au.delete(e),lg(i)}else await gp(i.localStore,e,!1).then((()=>_p(i,e,t))).catch(el)}async function lV(n,e){const t=Be(n),i=e.batch.batchId;try{const o=await vk(t.localStore,e);Qb(t,i,null),Kb(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ku(t,o)}catch(o){await el(o)}}async function uV(n,e,t){const i=Be(n);try{const o=await(function(u,f){const g=Be(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let T;return g.mutationQueue.lookupMutationBatch(m,f).next((x=>(ct(x!==null,37113),T=x.keys(),g.mutationQueue.removeMutationBatch(m,x)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,T,f))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,T))).next((()=>g.localDocuments.getDocuments(m,T)))}))})(i.localStore,e);Qb(i,e,t),Kb(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ku(i,o)}catch(o){await el(o)}}function Kb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Qb(n,e,t){const i=Be(n);let o=i.Vu[i.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),i.Vu[i.currentUser.toKey()]=o}}function _p(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Xb(n,i)}))}function Xb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(eg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),lg(n))}function fx(n,e,t){for(const i of t)i instanceof Gb?(n.Ru.addReference(i.key,e),cV(n,i)):i instanceof $b?(Ee(ag,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Xb(n,i.key)):Ve(19791,{wu:i})}function cV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Ee(ag,"New document in limbo: "+t),n.Eu.add(i),lg(n))}function lg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Re(St.fromString(e)),i=n.fu.next();n.Au.set(i,new Zk(t)),n.du=n.du.insert(t,i),Lb(n.remoteStore,new Er(Hs(Hp(t.path)),i,"TargetPurposeLimboResolution",of.ce))}}async function ku(n,e,t){const i=Be(n),o=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,g)=>{u.push(i.pu(g,e,t).then((m=>{var T;if((m||t)&&i.isPrimaryClient){const x=m?!m.fromCache:(T=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:T.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(m){o.push(m);const x=Wp.As(g.targetId,m);l.push(x)}})))})),await Promise.all(u),i.Pu.H_(o),await(async function(g,m){const T=Be(g);try{await T.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>ue.forEach(m,(b=>ue.forEach(b.Es,(w=>T.persistence.referenceDelegate.addReference(x,b.targetId,w))).next((()=>ue.forEach(b.ds,(w=>T.persistence.referenceDelegate.removeReference(x,b.targetId,w)))))))))}catch(x){if(!tl(x))throw x;Ee(Zp,"Failed to update sequence numbers: "+x)}for(const x of m){const b=x.targetId;if(!x.fromCache){const w=T.Ms.get(b),L=w.snapshotVersion,k=w.withLastLimboFreeSnapshotVersion(L);T.Ms=T.Ms.insert(b,k)}}})(i.localStore,l))}async function dV(n,e){const t=Be(n);if(!t.currentUser.isEqual(e)){Ee(ag,"User change. New user:",e.toKey());const i=await Db(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((g=>{g.reject(new Se(ce.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ku(t,i.Ls)}}function fV(n,e){const t=Be(n),i=t.Au.get(e);if(i&&i.hu)return tt().add(i.key);{let o=tt();const l=t.Iu.get(e);if(!l)return o;for(const u of l){const f=t.Tu.get(u);o=o.unionWith(f.view.nu)}return o}}function Wb(n){const e=Be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aV.bind(null,e),e.Pu.H_=Kk.bind(null,e.eventManager),e.Pu.yu=Qk.bind(null,e.eventManager),e}function hV(n){const e=Be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uV.bind(null,e),e}class Gd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yk(this.persistence,new mk,e.initialUser,this.serializer)}Cu(e){return new Mb(Xp.mi,this.serializer)}Du(e){return new Ak}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gd.provider={build:()=>new Gd};class mV extends Gd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ct(this.persistence.referenceDelegate instanceof zd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new ZP(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dn.withCacheSize(this.cacheSizeBytes):Dn.DEFAULT;return new Mb((i=>zd.mi(i,t)),this.serializer)}}class Tp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=dV.bind(null,this.syncEngine),await $k(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Jk})()}createDatastore(e){const t=pf(e.databaseInfo.databaseId),i=(function(l){return new Nk(l)})(e.databaseInfo);return(function(l,u,f,g){return new Pk(l,u,f,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,l,u,f){return new Vk(i,o,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>dx(this.syncEngine,t,0)),(function(){return rx.v()?new rx:new Sk})())}createSyncEngine(e,t){return(function(o,l,u,f,g,m,T){const x=new eV(o,l,u,f,g,m);return T&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const l=Be(o);Ee(bo,"RemoteStore shutting down."),l.Ea.add(5),await Pu(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ki("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr="FirestoreClient";class pV{constructor(e,t,i,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=gn.UNAUTHENTICATED,this.clientId=rf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{Ee(Pr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ee(Pr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=rg(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Om(n,e){n.asyncQueue.verifyOperationInProgress(),Ee(Pr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await Db(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function hx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await gV(n);Ee(Pr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>ax(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>ax(e.remoteStore,o))),n._onlineComponents=e}async function gV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ee(Pr,"Using user provided OfflineComponentProvider");try{await Om(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ce.FAILED_PRECONDITION||o.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Eo("Error using user provided cache. Falling back to memory cache: "+t),await Om(n,new Gd)}}else Ee(Pr,"Using default OfflineComponentProvider"),await Om(n,new mV(void 0));return n._offlineComponents}async function eA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ee(Pr,"Using user provided OnlineComponentProvider"),await hx(n,n._uninitializedComponentsProvider._online)):(Ee(Pr,"Using default OnlineComponentProvider"),await hx(n,new Tp))),n._onlineComponents}function yV(n){return eA(n).then((e=>e.syncEngine))}async function tA(n){const e=await eA(n),t=e.eventManager;return t.onListen=tV.bind(null,e.syncEngine),t.onUnlisten=iV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=nV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rV.bind(null,e.syncEngine),t}function vV(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,m){const T=new Zb({next:b=>{T.Nu(),u.enqueueAndForget((()=>zb(l,x)));const w=b.docs.has(f);!w&&b.fromCache?m.reject(new Se(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&g&&g.source==="server"?m.reject(new Se(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(b)},error:b=>m.reject(b)}),x=new Hb(Hp(f.path),T,{includeMetadataChanges:!0,qa:!0});return Bb(l,x)})(await tA(n),n.asyncQueue,e,t,i))),i.promise}function _V(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,g,m){const T=new Zb({next:b=>{T.Nu(),u.enqueueAndForget((()=>zb(l,x))),b.fromCache&&g.source==="server"?m.reject(new Se(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(b)},error:b=>m.reject(b)}),x=new Hb(f,T,{includeMetadataChanges:!0,qa:!0});return Bb(l,x)})(await tA(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="firestore.googleapis.com",px=!0;class gx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sA,this.ssl=px}else this.host=e.host,this.ssl=e.ssl??px;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Rb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<XP)throw new Se(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vf{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new BE;switch(i.type){case"firstParty":return new N2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=mx.get(t);i&&(Ee("ComponentProvider","Removing Datastore"),mx.delete(t),i.terminate())})(this),Promise.resolve()}}function iA(n,e,t,i={}){var m;n=Vi(n,vf);const o=Xa(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;o&&(CE(`https://${f}`),wE("Firestore",!0)),l.host!==sA&&l.host!==f&&Eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:f,ssl:o,emulatorOptions:i};if(!_o(g,u)&&(n._setSettings(g),i.mockUserToken)){let T,x;if(typeof i.mockUserToken=="string")T=i.mockUserToken,x=gn.MOCK_USER;else{T=XM(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Se(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new gn(b)}n._authCredentials=new C2(new qE(T,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Vu(this.firestore,e,this._query)}}class Qt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}toJSON(){return{type:Qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ru(t,Qt._jsonSchema))return new Qt(e,i||null,new Re(St.fromString(t.referencePath)))}}Qt._jsonSchemaVersion="firestore/documentReference/1.0",Qt._jsonSchema={type:Kt("string",Qt._jsonSchemaVersion),referencePath:Kt("string")};class Mi extends Vu{constructor(e,t,i){super(e,t,Hp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new Re(e))}withConverter(e){return new Mi(this.firestore,e,this._path)}}function TV(n,e,...t){if(n=En(n),zE("collection","path",e),n instanceof vf){const i=St.fromString(e,...t);return RT(i),new Mi(n,null,i)}{if(!(n instanceof Qt||n instanceof Mi))throw new Se(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(St.fromString(e,...t));return RT(i),new Mi(n.firestore,null,i)}}function xV(n,e,...t){if(n=En(n),arguments.length===1&&(e=rf.newId()),zE("doc","path",e),n instanceof vf){const i=St.fromString(e,...t);return NT(i),new Qt(n,null,new Re(i))}{if(!(n instanceof Qt||n instanceof Mi))throw new Se(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(St.fromString(e,...t));return NT(i),new Qt(n.firestore,n instanceof Mi?n.converter:null,new Re(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="AsyncQueue";class vx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new kb(this,"async_queue_retry"),this._c=()=>{const i=Um();i&&Ee(yx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Um();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Um();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ri;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tl(e))throw e;Ee(yx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ki("INTERNAL UNHANDLED ERROR: ",_x(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=ig.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&Ve(47125,{Pc:_x(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _x(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class sl extends vf{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new vx,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vx(e),this._firestoreClient=void 0,await e}}}function rA(n,e){const t=typeof n=="object"?n:ME(),i=typeof n=="string"?n:Ld,o=Lp(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const l=KM("firestore");l&&iA(o,...l)}return o}function _f(n){if(n._terminated)throw new Se(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||EV(n),n._firestoreClient}function EV(n){var i,o,l;const e=n._freezeSettings(),t=(function(f,g,m,T){return new G2(f,g,m,T.host,T.ssl,T.experimentalForceLongPolling,T.experimentalAutoDetectLongPolling,nA(T.experimentalLongPollingOptions),T.useFetchStreams,T.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new pV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const g=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zn(an.fromBase64String(e))}catch(t){throw new Se(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new zn(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ru(e,zn._jsonSchema))return zn.fromBase64String(e.bytes)}}zn._jsonSchemaVersion="firestore/bytes/1.0",zn._jsonSchema={type:Kt("string",zn._jsonSchemaVersion),bytes:Kt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new on(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return et(this._lat,e._lat)||et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ts._jsonSchemaVersion}}static fromJSON(e){if(Ru(e,Ts._jsonSchema))return new Ts(e.latitude,e.longitude)}}Ts._jsonSchemaVersion="firestore/geoPoint/1.0",Ts._jsonSchema={type:Kt("string",Ts._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ru(e,xs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xs(e.vectorValues);throw new Se(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xs._jsonSchemaVersion="firestore/vectorValue/1.0",xs._jsonSchema={type:Kt("string",xs._jsonSchemaVersion),vectorValues:Kt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=/^__.*__$/;class AV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Io(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mu(e,this.data,t,this.fieldTransforms)}}function oA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:n})}}class cg{constructor(e,t,i,o,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $d(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oA(this.Ac)&&bV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class SV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||pf(e)}Cc(e,t,i,o=!1){return new cg({Ac:e,methodName:t,Dc:i,path:on.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function CV(n){const e=n._freezeSettings(),t=pf(n._databaseId);return new SV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function wV(n,e,t,i,o,l={}){const u=n.Cc(l.merge||l.mergeFields?2:0,e,t,o);cA("Data must be an object, but it was:",u,i);const f=lA(i,u);let g,m;if(l.merge)g=new vs(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const T=[];for(const x of l.mergeFields){const b=IV(e,x,t);if(!u.contains(b))throw new Se(ce.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);RV(T,b)||T.push(b)}g=new vs(T),m=u.fieldTransforms.filter((x=>g.covers(x.field)))}else g=null,m=u.fieldTransforms;return new AV(new is(f),g,m)}function aA(n,e){if(uA(n=En(n)))return cA("Unsupported field value:",e,n),lA(n,e);if(n instanceof ug)return(function(i,o){if(!oA(o.Ac))throw o.Sc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,o){const l=[];let u=0;for(const f of i){let g=aA(f,o.wc(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,o){if((i=En(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return pP(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=xt.fromDate(i);return{timestampValue:Bd(o.serializer,l)}}if(i instanceof xt){const l=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Bd(o.serializer,l)}}if(i instanceof Ts)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof zn)return{bytesValue:bb(o.serializer,i._byteString)};if(i instanceof Qt){const l=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Kp(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof xs)return(function(u,f){return{mapValue:{fields:{[ZE]:{stringValue:eb},[Ud]:{arrayValue:{values:u.toArray().map((m=>{if(typeof m!="number")throw f.Sc("VectorValues must only contain numeric values.");return Gp(f.serializer,m)}))}}}}}})(i,o);throw o.Sc(`Unsupported field value: ${Op(i)}`)})(n,e)}function lA(n,e){const t={};return YE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Co(n,((i,o)=>{const l=aA(o,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function uA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof Ts||n instanceof zn||n instanceof Qt||n instanceof ug||n instanceof xs)}function cA(n,e,t){if(!uA(t)||!GE(t)){const i=Op(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function IV(n,e,t){if((e=En(e))instanceof Tf)return e._internalPath;if(typeof e=="string")return dA(n,e);throw $d("Field path arguments must be of type string or ",n,!1,void 0,t)}const NV=new RegExp("[~\\*/\\[\\]]");function dA(n,e,t){if(e.search(NV)>=0)throw $d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Tf(...e.split("."))._internalPath}catch{throw $d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $d(n,e,t,i,o){const l=i&&!i.isEmpty(),u=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${o}`),g+=")"),new Se(ce.INVALID_ARGUMENT,f+n+g)}function RV(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,i,o,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class MV extends fA{data(){return super.data()}}function hA(n,e){return typeof e=="string"?dA(n,e):e instanceof Tf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Se(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mA{convertValue(e,t="none"){switch(Mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Rr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Co(e,((o,l)=>{i[o]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,o,l;const t=(l=(o=(i=e.fields)==null?void 0:i[Ud].arrayValue)==null?void 0:o.values)==null?void 0:l.map((u=>Ot(u.doubleValue)));return new xs(t)}convertGeoPoint(e){return new Ts(Ot(e.latitude),Ot(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=lf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(bu(e));default:return null}}convertTimestamp(e){const t=Nr(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=St.fromString(e);ct(Nb(i),9688,{name:e});const o=new ja(i.get(1),i.get(3)),l=new Re(i.popFirst(5));return o.isEqual(t)||ki(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PV(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Ca{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wr extends fA{constructor(e,t,i,o,l,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _u(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(hA("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=wr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}wr._jsonSchemaVersion="firestore/documentSnapshot/1.0",wr._jsonSchema={type:Kt("string",wr._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class _u extends wr{data(e={}){return super.data(e)}}class yo{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Ca(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new _u(this._firestore,this._userDataWriter,i.key,i,new Ca(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((f=>{const g=new _u(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Ca(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const g=new _u(o._firestore,o._userDataWriter,f.doc.key,f.doc,new Ca(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,T=-1;return f.type!==0&&(m=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),T=u.indexOf(f.doc.key)),{type:kV(f.type),doc:g,oldIndex:m,newIndex:T}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=yo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VV(n){n=Vi(n,Qt);const e=Vi(n.firestore,sl);return vV(_f(e),n._key).then((t=>jV(e,n,t)))}yo._jsonSchemaVersion="firestore/querySnapshot/1.0",yo._jsonSchema={type:Kt("string",yo._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class pA extends mA{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,t)}}function LV(n){n=Vi(n,Vu);const e=Vi(n.firestore,sl),t=_f(e),i=new pA(e);return DV(n._query),_V(t,n._query).then((o=>new yo(e,i,n,o)))}function UV(n,e,t){n=Vi(n,Qt);const i=Vi(n.firestore,sl),o=PV(n.converter,e,t);return dg(i,[wV(CV(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,Gs.none())])}function OV(n){return dg(Vi(n.firestore,sl),[new $p(n._key,Gs.none())])}function dg(n,e){return(function(i,o){const l=new Ri;return i.asyncQueue.enqueueAndForget((async()=>oV(await yV(i),o,l))),l.promise})(_f(n),e)}function jV(n,e,t){const i=t.docs.get(e._key),o=new pA(n);return new wr(n,o,e._key,i,new Ca(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(o){Za=o})(Wa),Ua(new To("firestore",((i,{instanceIdentifier:o,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new sl(new w2(i.getProvider("auth-internal")),new R2(u,i.getProvider("app-check-internal")),(function(m,T){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Se(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ja(m.options.projectId,T)})(u,o),u);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Sr(ST,CT,e),Sr(ST,CT,"esm2020")})();const pd=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:mA,Bytes:zn,CollectionReference:Mi,DocumentReference:Qt,DocumentSnapshot:wr,FieldPath:Tf,FieldValue:ug,Firestore:sl,FirestoreError:Se,GeoPoint:Ts,Query:Vu,QueryDocumentSnapshot:_u,QuerySnapshot:yo,SnapshotMetadata:Ca,Timestamp:xt,VectorValue:xs,_AutoId:rf,_ByteString:an,_DatabaseId:ja,_DocumentKey:Re,_EmptyAuthCredentialsProvider:BE,_FieldPath:on,_cast:Vi,_logWarn:Eo,_validateIsNotUsedTogether:HE,collection:TV,connectFirestoreEmulator:iA,deleteDoc:OV,doc:xV,ensureFirestoreConfigured:_f,executeWrite:dg,getDoc:VV,getDocs:LV,getFirestore:rA,setDoc:UV},Symbol.toStringTag,{value:"Module"}));function gA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yA=gA,vA=new Iu("auth","Firebase",gA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=new kp("@firebase/auth");function FV(n,...e){Yd.logLevel<=Ze.WARN&&Yd.warn(`Auth (${Wa}): ${n}`,...e)}function Sd(n,...e){Yd.logLevel<=Ze.ERROR&&Yd.error(`Auth (${Wa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(n,...e){throw fg(n,...e)}function Ys(n,...e){return fg(n,...e)}function _A(n,e,t){const i={...yA(),[e]:t};return new Iu("auth","Firebase",i).create(e,{appName:n.name})}function Di(n){return _A(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return vA.create(n,...e)}function ke(n,e,...t){if(!n)throw fg(e,...t)}function Ii(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Sd(e),new Error(e)}function Ui(n,e){n||Ii(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function qV(){return Tx()==="http:"||Tx()==="https:"}function Tx(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qV()||sD()||"connection"in navigator)?navigator.onLine:!0}function zV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ui(t>e,"Short delay should be less than long delay!"),this.isMobile=eD()||iD()}get(){return BV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n,e){Ui(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ii("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ii("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ii("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$V=new Lu(3e4,6e4);function Lr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Fi(n,e,t,i,o={}){return xA(n,o,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=Nu({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return nD()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Xa(n.emulatorConfig.host)&&(m.credentials="include"),TA.fetch()(await EA(n,n.config.apiHost,t,f),m)})}async function xA(n,e,t){n._canInitEmulator=!1;const i={...HV,...e};try{const o=new JV(n),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw gd(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[g,m]=f.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw gd(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw gd(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw gd(n,"user-disabled",u);const T=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw _A(n,T,m);Es(n,T)}}catch(o){if(o instanceof ji)throw o;Es(n,"network-request-failed",{message:String(o)})}}async function Uu(n,e,t,i,o={}){const l=await Fi(n,e,t,i,o);return"mfaPendingCredential"in l&&Es(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function EA(n,e,t,i){const o=`${e}${t}?${i}`,l=n,u=l.config.emulator?hg(n.config,o):`${n.config.apiScheme}://${o}`;return GV.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function YV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ys(this.auth,"network-request-failed")),$V.get())})}}function gd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=Ys(n,e,i);return o.customData._tokenResponse=t,o}function xx(n){return n!==void 0&&n.enterprise!==void 0}class KV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return YV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function QV(n,e){return Fi(n,"GET","/v2/recaptchaConfig",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XV(n,e){return Fi(n,"POST","/v1/accounts:delete",e)}async function Jd(n,e){return Fi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bA(n,e=!1){const t=En(n),i=await t.getIdToken(e),o=mg(i);ke(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:o,token:i,authTime:Tu(jm(o.auth_time)),issuedAtTime:Tu(jm(o.iat)),expirationTime:Tu(jm(o.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function jm(n){return Number(n)*1e3}function mg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Sd("JWT malformed, contained fewer than 3 sections"),null;try{const o=EE(t);return o?JSON.parse(o):(Sd("Failed to decode base64 JWT payload"),null)}catch(o){return Sd("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Ex(n){const e=mg(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ha(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ji&&WV(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function WV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tu(this.lastLoginAt),this.creationTime=Tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kd(n){var x;const e=n.auth,t=await n.getIdToken(),i=await Ha(n,Jd(e,{idToken:t}));ke(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const l=(x=o.providerUserInfo)!=null&&x.length?SA(o.providerUserInfo):[],u=eL(n.providerData,l),f=n.isAnonymous,g=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),m=f?g:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Ep(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(n,T)}async function AA(n){const e=En(n);await Kd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eL(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function SA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tL(n,e){const t=await xA(n,{},async()=>{const i=Nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=n.config,u=await EA(n,o,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:f,body:i};return n.emulatorConfig&&Xa(n.emulatorConfig.host)&&(g.credentials="include"),TA.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nL(n,e){return Fi(n,"POST","/v2/accounts:revokeToken",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=Ex(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:l}=await tL(e,t);this.updateTokensAndExpiration(i,o,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:l}=t,u=new Pa;return i&&(ke(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(ke(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),l&&(ke(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pa,this.toJSON())}_performRefresh(){return Ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class _s{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new ZV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ep(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ha(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bA(this,e)}reload(){return AA(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _s({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Kd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ss(this.auth.app))return Promise.reject(Di(this.auth));const e=await this.getIdToken();return await Ha(this,XV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,f=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,T=t.lastLoginAt??void 0,{uid:x,emailVerified:b,isAnonymous:w,providerData:L,stsTokenManager:k}=t;ke(x&&k,e,"internal-error");const j=Pa.fromJSON(this.name,k);ke(typeof x=="string",e,"internal-error"),Tr(i,e.name),Tr(o,e.name),ke(typeof b=="boolean",e,"internal-error"),ke(typeof w=="boolean",e,"internal-error"),Tr(l,e.name),Tr(u,e.name),Tr(f,e.name),Tr(g,e.name),Tr(m,e.name),Tr(T,e.name);const Y=new _s({uid:x,auth:e,email:o,emailVerified:b,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:j,createdAt:m,lastLoginAt:T});return L&&Array.isArray(L)&&(Y.providerData=L.map(O=>({...O}))),g&&(Y._redirectEventId=g),Y}static async _fromIdTokenResponse(e,t,i=!1){const o=new Pa;o.updateFromServerResponse(t);const l=new _s({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Kd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];ke(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?SA(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(l!=null&&l.length),f=new Pa;f.updateFromIdToken(i);const g=new _s({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:u}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Ep(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=new Map;function Ni(n){Ui(n instanceof Function,"Expected a class definition");let e=bx.get(n);return e?(Ui(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,bx.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}CA.type="NONE";const bp=CA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(n,e,t){return`firebase:${n}:${e}:${t}`}class ka{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:l}=this.auth;this.fullUserKey=Cd(this.userKey,o.apiKey,l),this.fullPersistenceKey=Cd("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jd(this.auth,{idToken:e}).catch(()=>{});return t?_s._fromGetAccountInfoResponse(this.auth,t,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ka(Ni(bp),e,i);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=o[0]||Ni(bp);const u=Cd(i,e.config.apiKey,e.name);let f=null;for(const m of t)try{const T=await m._get(u);if(T){let x;if(typeof T=="string"){const b=await Jd(e,{idToken:T}).catch(()=>{});if(!b)break;x=await _s._fromGetAccountInfoResponse(e,b,T)}else x=_s._fromJSON(e,T);m!==l&&(f=x),l=m;break}}catch{}const g=o.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new ka(l,e,i):(l=g[0],f&&await l._set(u,f.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new ka(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DA(e))return"Blackberry";if(PA(e))return"Webos";if(IA(e))return"Safari";if((e.includes("chrome/")||NA(e))&&!e.includes("edge/"))return"Chrome";if(MA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function wA(n=_n()){return/firefox\//i.test(n)}function IA(n=_n()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NA(n=_n()){return/crios\//i.test(n)}function RA(n=_n()){return/iemobile/i.test(n)}function MA(n=_n()){return/android/i.test(n)}function DA(n=_n()){return/blackberry/i.test(n)}function PA(n=_n()){return/webos/i.test(n)}function pg(n=_n()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function sL(n=_n()){var e;return pg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function iL(){return rD()&&document.documentMode===10}function kA(n=_n()){return pg(n)||MA(n)||PA(n)||DA(n)||/windows phone/i.test(n)||RA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(n,e=[]){let t;switch(n){case"Browser":t=Ax(_n());break;case"Worker":t=`${Ax(_n())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wa}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,f)=>{try{const g=e(l);u(g)}catch(g){f(g)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oL(n,e={}){return Fi(n,"GET","/v2/passwordPolicy",Lr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=6;class lL{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??aL,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sx(this),this.idTokenSubscription=new Sx(this),this.beforeStateQueue=new rL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ni(t)),this._initializationPromise=this.queue(async()=>{var i,o,l;if(!this._deleted&&(this.persistenceManager=await ka.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jd(this,{idToken:e}),i=await _s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(ss(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,f=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===f)&&(g!=null&&g.user)&&(i=g.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Kd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ss(this.app))return Promise.reject(Di(this));const t=e?En(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ss(this.app)?Promise.reject(Di(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ss(this.app)?Promise.reject(Di(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oL(this),t=new lL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Iu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await nL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ni(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await ka.create(this,[Ni(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,o);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(ss(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&FV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ro(n){return En(n)}class Sx{constructor(e){this.auth=e,this.observer=null,this.addObserver=hD(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cL(n){xf=n}function LA(n){return xf.loadJS(n)}function dL(){return xf.recaptchaEnterpriseScript}function fL(){return xf.gapiScript}function hL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class mL{constructor(){this.enterprise=new pL}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class pL{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const gL="recaptcha-enterprise",UA="NO_RECAPTCHA";class yL{constructor(e){this.type=gL,this.auth=Ro(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{QV(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const m=new KV(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(g=>{f(g)})})}function o(l,u,f){const g=window.grecaptcha;xx(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(UA)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new mL().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!t&&xx(window.grecaptcha))o(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=dL();g.length!==0&&(g+=f),LA(g).then(()=>{o(f,l,u)}).catch(m=>{u(m)})}}).catch(f=>{u(f)})})}}async function Cx(n,e,t,i=!1,o=!1){const l=new yL(n);let u;if(o)u=UA;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const g=f.phoneEnrollmentInfo.phoneNumber,m=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const g=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Ap(n,e,t,i,o){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await Cx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Cx(n,e,t,t==="getOobCode");return i(n,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(n,e){const t=Lp(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(_o(l,e??{}))return o;Es(o,"already-initialized")}return t.initialize({options:e})}function vL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ni);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function jA(n,e,t){const i=Ro(n);ke(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,l=FA(e),{host:u,port:f}=_L(e),g=f===null?"":`:${f}`,m={url:`${l}//${u}${g}/`},T=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){ke(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ke(_o(m,i.config.emulator)&&_o(T,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=T,i.settings.appVerificationDisabledForTesting=!0,Xa(u)?(CE(`${l}//${u}${g}`),wE("Auth",!0)):TL()}function FA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _L(n){const e=FA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const l=o[1];return{host:l,port:wx(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:wx(u)}}}function wx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function TL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ii("not implemented")}_getIdTokenResponse(e){return Ii("not implemented")}_linkToIdToken(e,t){return Ii("not implemented")}_getReauthenticationResolver(e){return Ii("not implemented")}}async function xL(n,e){return Fi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL(n,e){return Uu(n,"POST","/v1/accounts:signInWithPassword",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bL(n,e){return Uu(n,"POST","/v1/accounts:signInWithEmailLink",Lr(n,e))}async function AL(n,e){return Uu(n,"POST","/v1/accounts:signInWithEmailLink",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga extends Ef{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Ga(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ga(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,t,"signInWithPassword",EL);case"emailLink":return bL(e,{email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ap(e,i,"signUpPassword",xL);case"emailLink":return AL(e,{idToken:t,email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Va(n,e){return Uu(n,"POST","/v1/accounts:signInWithIdp",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL="http://localhost";class kr extends Ef{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new kr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Es("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...l}=t;if(!i||!o)return null;const u=new kr(i,o);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Va(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Va(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Va(e,t)}buildRequest(){const e={requestUri:SL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function wL(n){const e=lu(uu(n)).link,t=e?lu(uu(e)).deep_link_id:null,i=lu(uu(n)).deep_link_id;return(i?lu(uu(i)).link:null)||i||t||e||n}class bf{constructor(e){const t=lu(uu(e)),i=t.apiKey??null,o=t.oobCode??null,l=CL(t.mode??null);ke(i&&o&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=wL(e);try{return new bf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(){this.providerId=Mo.PROVIDER_ID}static credential(e,t){return Ga._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=bf.parseLink(t);return ke(i,"argument-error"),Ga._fromEmailAndCode(e,i.code,i.tenantId)}}Mo.PROVIDER_ID="password";Mo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Mo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou extends qA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Ou{constructor(){super("facebook.com")}static credential(e){return kr._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bi.credential(e.oauthAccessToken)}catch{return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends Ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return kr._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ai.credential(t,i)}catch{return null}}}Ai.GOOGLE_SIGN_IN_METHOD="google.com";Ai.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends Ou{constructor(){super("github.com")}static credential(e){return kr._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.GITHUB_SIGN_IN_METHOD="github.com";Si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Ou{constructor(){super("twitter.com")}static credential(e,t){return kr._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ci.credential(t,i)}catch{return null}}}Ci.TWITTER_SIGN_IN_METHOD="twitter.com";Ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IL(n,e){return Uu(n,"POST","/v1/accounts:signUp",Lr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const l=await _s._fromIdTokenResponse(e,i,o),u=Ix(i);return new Ao({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=Ix(i);return new Ao({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function Ix(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends ji{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Qd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Qd(e,t,i,o)}}function BA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Qd._fromErrorAndOperation(n,l,e,i):l})}async function NL(n,e,t=!1){const i=await Ha(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ao._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL(n,e,t=!1){const{auth:i}=n;if(ss(i.app))return Promise.reject(Di(i));const o="reauthenticate";try{const l=await Ha(n,BA(i,o,e,n),t);ke(l.idToken,i,"internal-error");const u=mg(l.idToken);ke(u,i,"internal-error");const{sub:f}=u;return ke(n.uid===f,i,"user-mismatch"),Ao._forOperation(n,o,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Es(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zA(n,e,t=!1){if(ss(n.app))return Promise.reject(Di(n));const i="signIn",o=await BA(n,i,e),l=await Ao._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(l.user),l}async function HA(n,e){return zA(Ro(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GA(n){const e=Ro(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ML(n,e,t){if(ss(n.app))return Promise.reject(Di(n));const i=Ro(n),u=await Ap(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",IL).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&GA(n),g}),f=await Ao._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(f.user),f}function DL(n,e,t){return ss(n.app)?Promise.reject(Di(n)):HA(En(n),Mo.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&GA(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PL(n,e){return Fi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kL(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=En(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Ha(i,PL(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const f=i.providerData.find(({providerId:g})=>g==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function $A(n,e,t,i){return En(n).onIdTokenChanged(e,t,i)}function YA(n,e,t){return En(n).beforeAuthStateChanged(e,t)}function VL(n,e,t,i){return En(n).onAuthStateChanged(e,t,i)}function LL(n){return En(n).signOut()}const Xd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Xd,"1"),this.storage.removeItem(Xd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=1e3,OL=10;class KA extends JA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);iL()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,OL):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},UL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}KA.type="LOCAL";const QA=KA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA extends JA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}XA.type="SESSION";const gg=XA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new Af(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:l}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const f=Array.from(u).map(async m=>m(t.origin,l)),g=await jL(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Af.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,u;return new Promise((f,g)=>{const m=yg("",20);o.port1.start();const T=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(x){const b=x;if(b.data.eventId===m)switch(b.data.status){case"ack":clearTimeout(T),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(b.data.response);break;default:clearTimeout(T),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(){return window}function qL(n){Js().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(){return typeof Js().WorkerGlobalScope<"u"&&typeof Js().importScripts=="function"}async function BL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function zL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function HL(){return WA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA="firebaseLocalStorageDb",GL=1,Wd="firebaseLocalStorage",eS="fbase_key";class ju{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Sf(n,e){return n.transaction([Wd],e?"readwrite":"readonly").objectStore(Wd)}function $L(){const n=indexedDB.deleteDatabase(ZA);return new ju(n).toPromise()}function Sp(){const n=indexedDB.open(ZA,GL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Wd,{keyPath:eS})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Wd)?e(i):(i.close(),await $L(),e(await Sp()))})})}async function Nx(n,e,t){const i=Sf(n,!0).put({[eS]:e,value:t});return new ju(i).toPromise()}async function YL(n,e){const t=Sf(n,!1).get(e),i=await new ju(t).toPromise();return i===void 0?null:i.value}function Rx(n,e){const t=Sf(n,!0).delete(e);return new ju(t).toPromise()}const JL=800,KL=3;class tS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>KL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return WA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Af._getInstance(HL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await BL(),!this.activeServiceWorker)return;this.sender=new FL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||zL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await Nx(e,Xd,"1"),await Rx(e,Xd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Nx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>YL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Rx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=Sf(o,!1).getAll();return new ju(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tS.type="LOCAL";const nS=tS;new Lu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QL(n,e){return e?Ni(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg extends Ef{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Va(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Va(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Va(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function XL(n){return zA(n.auth,new vg(n),n.bypassAuthState)}function WL(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),RL(t,new vg(n),n.bypassAuthState)}async function ZL(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),NL(t,new vg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t,i,o,l=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XL;case"linkViaPopup":case"linkViaRedirect":return ZL;case"reauthViaPopup":case"reauthViaRedirect":return WL;default:Es(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new Lu(2e3,1e4);class wa extends sS{constructor(e,t,i,o,l){super(e,t,o,l),this.provider=i,this.authWindow=null,this.pollId=null,wa.currentPopupAction&&wa.currentPopupAction.cancel(),wa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=yg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ys(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ys(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ys(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e4.get())};e()}}wa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4="pendingRedirect",wd=new Map;class n4 extends sS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=wd.get(this.auth._key());if(!e){try{const i=await s4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}wd.set(this.auth._key(),e)}return this.bypassAuthState||wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function s4(n,e){const t=o4(e),i=r4(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function i4(n,e){wd.set(n._key(),e)}function r4(n){return Ni(n._redirectPersistence)}function o4(n){return Cd(t4,n.config.apiKey,n.name)}async function a4(n,e,t=!1){if(ss(n.app))return Promise.reject(Di(n));const i=Ro(n),o=QL(i,e),u=await new n4(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=600*1e3;class u4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!iS(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Ys(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=l4&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mx(e))}saveEventToCache(e){this.cachedEventUids.add(Mx(e)),this.lastProcessedEventTime=Date.now()}}function Mx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function iS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function c4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(n,e={}){return Fi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h4=/^https?/;async function m4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await d4(n);for(const t of e)try{if(p4(t))return}catch{}Es(n,"unauthorized-domain")}function p4(n){const e=xp(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!h4.test(t))return!1;if(f4.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=new Lu(3e4,6e4);function Dx(){const n=Js().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function y4(n){return new Promise((e,t)=>{var o,l,u;function i(){Dx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dx(),t(Ys(n,"network-request-failed"))},timeout:g4.get()})}if((l=(o=Js().gapi)==null?void 0:o.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=Js().gapi)!=null&&u.load)i();else{const f=hL("iframefcb");return Js()[f]=()=>{gapi.load?i():t(Ys(n,"network-request-failed"))},LA(`${fL()}?onload=${f}`).catch(g=>t(g))}}).catch(e=>{throw Id=null,e})}let Id=null;function v4(n){return Id=Id||y4(n),Id}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=new Lu(5e3,15e3),T4="__/auth/iframe",x4="emulator/auth/iframe",E4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},b4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A4(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hg(e,x4):`https://${n.config.authDomain}/${T4}`,i={apiKey:e.apiKey,appName:n.name,v:Wa},o=b4.get(n.config.apiHost);o&&(i.eid=o);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Nu(i).slice(1)}`}async function S4(n){const e=await v4(n),t=Js().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:A4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E4,dontclear:!0},i=>new Promise(async(o,l)=>{await i.restyle({setHideOnLeave:!1});const u=Ys(n,"network-request-failed"),f=Js().setTimeout(()=>{l(u)},_4.get());function g(){Js().clearTimeout(f),o(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},w4=500,I4=600,N4="_blank",R4="http://localhost";class Px{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function M4(n,e,t,i=w4,o=I4){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const g={...C4,width:i.toString(),height:o.toString(),top:l,left:u},m=_n().toLowerCase();t&&(f=NA(m)?N4:t),wA(m)&&(e=e||R4,g.scrollbars="yes");const T=Object.entries(g).reduce((b,[w,L])=>`${b}${w}=${L},`,"");if(sL(m)&&f!=="_self")return D4(e||"",f),new Px(null);const x=window.open(e||"",f,T);ke(x,n,"popup-blocked");try{x.focus()}catch{}return new Px(x)}function D4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="__/auth/handler",k4="emulator/auth/handler",V4=encodeURIComponent("fac");async function kx(n,e,t,i,o,l){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Wa,eventId:o};if(e instanceof qA){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",fD(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[T,x]of Object.entries({}))u[T]=x}if(e instanceof Ou){const T=e.getScopes().filter(x=>x!=="");T.length>0&&(u.scopes=T.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const T of Object.keys(f))f[T]===void 0&&delete f[T];const g=await n._getAppCheckToken(),m=g?`#${V4}=${encodeURIComponent(g)}`:"";return`${L4(n)}?${Nu(f).slice(1)}${m}`}function L4({config:n}){return n.emulator?hg(n,k4):`https://${n.authDomain}/${P4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="webStorageSupport";class U4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gg,this._completeRedirectFn=a4,this._overrideRedirectResult=i4}async _openPopup(e,t,i,o){var u;Ui((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await kx(e,t,i,xp(),o);return M4(e,l,yg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const l=await kx(e,t,i,xp(),o);return qL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(Ui(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await S4(e),i=new u4(e);return t.register("authEvent",o=>(ke(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fm,{type:Fm},o=>{var u;const l=(u=o==null?void 0:o[0])==null?void 0:u[Fm];l!==void 0&&t(!!l),Es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=m4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kA()||IA()||pg()}}const rS=U4;var Vx="@firebase/auth",Lx="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function F4(n){Ua(new To("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;ke(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VA(n)},m=new uL(i,o,l,g);return vL(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ua(new To("auth-internal",e=>{const t=Ro(e.getProvider("auth").getImmediate());return(i=>new O4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sr(Vx,Lx,j4(n)),Sr(Vx,Lx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=300,B4=SE("authIdTokenMaxAge")||q4;let Ux=null;const z4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>B4)return;const o=t==null?void 0:t.token;Ux!==o&&(Ux=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function oS(n=ME()){const e=Lp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=OA(n,{popupRedirectResolver:rS,persistence:[nS,QA,gg]}),i=SE("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=z4(l.toString());YA(t,u,()=>u(t.currentUser)),$A(t,f=>u(f))}}const o=bE("auth");return o&&jA(t,`http://${o}`),t}function H4(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}cL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const l=Ys("internal-error");l.customData=o,t(l)},i.type="text/javascript",i.charset="UTF-8",H4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});F4("Browser");const yd=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:bf,AuthCredential:Ef,EmailAuthCredential:Ga,EmailAuthProvider:Mo,FacebookAuthProvider:bi,GithubAuthProvider:Si,GoogleAuthProvider:Ai,OAuthCredential:kr,TwitterAuthProvider:Ci,beforeAuthStateChanged:YA,browserLocalPersistence:QA,browserPopupRedirectResolver:rS,browserSessionPersistence:gg,connectAuthEmulator:jA,createUserWithEmailAndPassword:ML,getAuth:oS,getIdTokenResult:bA,inMemoryPersistence:bp,indexedDBLocalPersistence:nS,initializeAuth:OA,onAuthStateChanged:VL,onIdTokenChanged:$A,prodErrorMap:yA,reload:AA,signInWithCredential:HA,signInWithEmailAndPassword:DL,signOut:LL,updateProfile:kL},Symbol.toStringTag,{value:"Module"}));let qm=null,Ei=null,ys=null;const G4=()=>{try{return Ma().hasFirebase?(qm=RE(jt.firebase),Ei=rA(qm),ys=oS(qm),console.log("🔥 تم تهيئة Firebase بنجاح"),{success:!0}):(console.warn("⚠️ تحذير: مفاتيح Firebase API غير متوفرة. لن يتم تهيئة Firebase."),{success:!1,error:"مفاتيح Firebase غير متوفرة"})}catch(n){return console.error("❌ خطأ في تهيئة Firebase:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}};G4();const wi={async signUp(n,e,t){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{createUserWithEmailAndPassword:i,updateProfile:o}=await xi(async()=>{const{createUserWithEmailAndPassword:u,updateProfile:f}=await Promise.resolve().then(()=>yd);return{createUserWithEmailAndPassword:u,updateProfile:f}},void 0),l=await i(ys,n,e);return await o(l.user,{displayName:t}),await this.saveData("users",l.user.uid,{email:n,displayName:t,createdAt:new Date().toISOString(),transactions:[],categories:[],cards:{},bankAccounts:{},investments:{currentValue:0},installments:[]}),{success:!0,user:l.user}}catch(i){return console.error("خطأ في التسجيل:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async signIn(n,e){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{signInWithEmailAndPassword:t}=await xi(async()=>{const{signInWithEmailAndPassword:o}=await Promise.resolve().then(()=>yd);return{signInWithEmailAndPassword:o}},void 0);return{success:!0,user:(await t(ys,n,e)).user}}catch(t){return console.error("خطأ في تسجيل الدخول:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async signOut(){if(!ys)return{success:!1,error:"Firebase غير مهيأ"};try{const{signOut:n}=await xi(async()=>{const{signOut:e}=await Promise.resolve().then(()=>yd);return{signOut:e}},void 0);return await n(ys),{success:!0}}catch(n){return console.error("خطأ في تسجيل الخروج:",n),{success:!1,error:n instanceof Error?n.message:"خطأ غير معروف"}}},async getCurrentUser(){return ys?ys.currentUser:null},async onAuthStateChanged(n){if(!ys)return n(null),()=>{};try{const{onAuthStateChanged:e}=await xi(async()=>{const{onAuthStateChanged:t}=await Promise.resolve().then(()=>yd);return{onAuthStateChanged:t}},void 0);return e(ys,t=>{console.log("🔐 تغيير في حالة المصادقة:",t?`مسجل دخول: ${t.email}`:"غير مسجل دخول"),n(t)})}catch(e){return console.error("❌ خطأ في تحميل onAuthStateChanged:",e),n(null),()=>{}}},async saveData(n,e,t){if(!Ei)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:i,setDoc:o}=await xi(async()=>{const{doc:u,setDoc:f}=await Promise.resolve().then(()=>pd);return{doc:u,setDoc:f}},void 0),l=i(Ei,n,e);return await o(l,{...t,lastUpdated:new Date().toISOString()}),{success:!0,id:e}}catch(i){return console.error("خطأ في حفظ البيانات:",i),{success:!1,error:i instanceof Error?i.message:"خطأ غير معروف"}}},async getData(n,e){if(!Ei)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,getDoc:i}=await xi(async()=>{const{doc:u,getDoc:f}=await Promise.resolve().then(()=>pd);return{doc:u,getDoc:f}},void 0),o=t(Ei,n,e),l=await i(o);return l.exists()?{success:!0,data:l.data()}:{success:!1,error:"المستند غير موجود"}}catch(t){return console.error("خطأ في جلب البيانات:",t),t instanceof Error?t.message.includes("permission")?{success:!1,error:"خطأ في الأذونات: تأكد من تسجيل الدخول وإعداد قواعد Firestore"}:t.message.includes("network")?{success:!1,error:"خطأ في الشبكة: تحقق من الاتصال بالإنترنت"}:{success:!1,error:t.message}:{success:!1,error:"خطأ غير معروف"}}},async getAllDocuments(n){if(!Ei)return{success:!1,error:"Firebase غير مهيأ"};try{const{collection:e,getDocs:t}=await xi(async()=>{const{collection:l,getDocs:u}=await Promise.resolve().then(()=>pd);return{collection:l,getDocs:u}},void 0),i=await t(e(Ei,n)),o=[];return i.forEach(l=>{o.push({id:l.id,...l.data()})}),{success:!0,data:o}}catch(e){return console.error("خطأ في جلب المستندات:",e),{success:!1,error:e instanceof Error?e.message:"خطأ غير معروف"}}},async deleteDocument(n,e){if(!Ei)return{success:!1,error:"Firebase غير مهيأ"};try{const{doc:t,deleteDoc:i}=await xi(async()=>{const{doc:l,deleteDoc:u}=await Promise.resolve().then(()=>pd);return{doc:l,deleteDoc:u}},void 0),o=t(Ei,n,e);return await i(o),{success:!0}}catch(t){return console.error("خطأ في حذف المستند:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async syncLocalDataToFirebase(n,e){try{return await this.saveData("users",n,{financialData:e,syncTimestamp:new Date().toISOString()})}catch(t){return console.error("خطأ في مزامنة البيانات:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}},async getDataFromFirebase(n){var e;try{const t=await this.getData("users",n);return t.success&&((e=t.data)!=null&&e.financialData)?{success:!0,data:t.data.financialData}:{success:!1,error:"لا توجد بيانات محفوظة"}}catch(t){return console.error("خطأ في جلب البيانات من Firebase:",t),{success:!1,error:t instanceof Error?t.message:"خطأ غير معروف"}}}},Ox=({onSuccess:n,onClose:e,hideCloseButton:t=!1,darkMode:i=!1,language:o="ar"})=>{const[l,u]=de.useState(!0),[f,g]=de.useState({email:"",password:"",displayName:""}),[m,T]=de.useState(!1),[x,b]=de.useState(""),w=async k=>{k.preventDefault(),T(!0),b("");try{let j;if(l)j=await wi.signIn(f.email,f.password);else{if(!f.displayName.trim()){b("الاسم مطلوب"),T(!1);return}j=await wi.signUp(f.email,f.password,f.displayName)}j.success?n(j.user):b(j.error||"حدث خطأ غير متوقع")}catch{b("حدث خطأ في الاتصال")}finally{T(!1)}},L=k=>{g(j=>({...j,[k.target.name]:k.target.value}))};return d.jsx("div",{className:`${t?"":"fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] overflow-hidden"} flex items-center justify-center p-4`,style:t?{}:{position:"fixed",top:0,left:0,right:0,bottom:0},children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:l?"🔐 تسجيل الدخول":"📝 إنشاء حساب جديد"}),!t&&d.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600 transition-colors",children:"✕"})]}),d.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!l&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-slate-700 mb-1",children:"الاسم الكامل"}),d.jsx("input",{type:"text",id:"displayName",name:"displayName",value:f.displayName,onChange:L,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!l})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"البريد الإلكتروني"}),d.jsx("input",{type:"email",id:"email",name:"email",value:f.email,onChange:L,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@email.com",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"كلمة المرور"}),d.jsx("input",{type:"password",id:"password",name:"password",value:f.password,onChange:L,className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور",required:!0,minLength:6})]}),x&&d.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:d.jsx("p",{className:"text-red-600 text-sm",children:x})}),d.jsx("button",{type:"submit",disabled:m,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold rounded-lg transition-colors",children:m?"⏳ جاري المعالجة...":l?"🔐 تسجيل الدخول":"📝 إنشاء حساب"})]}),d.jsx("div",{className:"mt-6 text-center",children:d.jsx("button",{onClick:()=>u(!l),className:"text-blue-600 hover:text-blue-700 font-medium",children:l?"ليس لديك حساب؟ إنشاء حساب جديد":"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},aS=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),d.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),La=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),d.jsx("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})]}),$4=()=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[d.jsx("path",{d:"M9.5 2.672a.5.5 0 1 0 1 0V.672a.5.5 0 0 0-1 0v2zm4.5.012a.5.5 0 0 0-.707-.707l-1.414 1.414a.5.5 0 0 0 .707.707l1.414-1.414zM11.328 14a.5.5 0 0 0 .707.707l1.414-1.414a.5.5 0 0 0-.707-.707l-1.414 1.414zM16 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5zM2 8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0 0 1h2A.5.5 0 0 0 2 8zm4.5-.012a.5.5 0 0 0 .707-.707L5.793 5.864a.5.5 0 1 0-.707.707L6.5 7.988zM4.672 2.5a.5.5 0 0 0-.707.707l1.414 1.414a.5.5 0 0 0 .707-.707L4.672 2.5zM.5 8a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 0-1h-2A.5.5 0 0 0 .5 8zM8 0a.5.5 0 0 0-.5.5v2a.5.5 0 0 0 1 0v-2A.5.5 0 0 0 8 0z"}),d.jsx("path",{d:"M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})]}),Y4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),J4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),K4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h7"})}),Q4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M5 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),X4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-8 w-8 ${n}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Fu=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Bm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),zm=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),W4=({className:n})=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:`w-6 h-6 ${n}`,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Z4=({selectedYear:n,selectedMonth:e,onYearChange:t,onMonthChange:i,onAddTransaction:o,currentUser:l,onSignOut:u,language:f="ar"})=>{const g=de.useMemo(()=>{const T=new Date().getFullYear(),x=[];for(let b=T+1;b>=2020;b--)x.push(b);return x},[]),m=de.useMemo(()=>[{value:"all",label:"كل الشهور"},{value:1,label:"يناير"},{value:2,label:"فبراير"},{value:3,label:"مارس"},{value:4,label:"أبريل"},{value:5,label:"مايو"},{value:6,label:"يونيو"},{value:7,label:"يوليو"},{value:8,label:"أغسطس"},{value:9,label:"سبتمبر"},{value:10,label:"أكتوبر"},{value:11,label:"نوفمبر"},{value:12,label:"ديسمبر"}],[]);return d.jsx("header",{className:"bg-slate-50/95 backdrop-blur-lg border-b border-slate-200 py-3 shadow-sm",children:d.jsx("div",{className:"container mx-auto px-4",children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center text-center sm:text-right gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center text-xl",children:"💰"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-wide",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-xs text-slate-500",children:"Developed by K.A Team"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-2 bg-slate-200 p-1.5 rounded-lg",children:[d.jsx("select",{value:n,onChange:T=>t(parseInt(T.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:g.map(T=>d.jsx("option",{value:T,children:T},T))}),d.jsx("select",{value:e,onChange:T=>i(T.target.value==="all"?"all":parseInt(T.target.value)),className:"bg-slate-200 text-slate-800 font-semibold border-0 focus:ring-0 appearance-none p-2 rounded-md",children:m.map(T=>d.jsx("option",{value:T.value,children:T.label},T.value))})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:l.displayName||"المستخدم"}),d.jsx("p",{className:"text-xs text-slate-500",children:l.email})]}),d.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 font-bold text-sm",children:(l.displayName||l.email||"U").charAt(0).toUpperCase()})}),d.jsx("button",{onClick:u,className:"px-3 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"🚪 خروج"})]}),d.jsxs("button",{onClick:o,className:"hidden md:flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2.5 rounded-lg transition-all duration-300",children:[d.jsx(X4,{className:"w-5 h-5"}),d.jsx("span",{children:se("add.transaction",f)})]})]})]})})})},eU=(n="ar")=>[{id:"summary",label:`📊 ${se("tab.summary",n)}`,icon:Y4},{id:"analysis",label:`📈 ${se("tab.analysis",n)}`,icon:J4},{id:"transactions",label:`💳 ${se("tab.transactions",n)}`,icon:K4},{id:"budget",label:`✨ ${se("tab.budget",n)}`},{id:"investment",label:`💹 ${se("tab.investment",n)}`},{id:"ai-assistant",label:`🤖 ${se("tab.ai.assistant",n)}`},{id:"cards",label:`💳 ${se("tab.cards",n)}`},{id:"bank",label:`🏦 ${se("tab.bank",n)}`},{id:"installments",label:`📱 ${se("tab.installments",n)}`},{id:"debts-loans",label:`📊 ${se("tab.debts.loans",n)}`},{id:"settings",label:`⚙️ ${se("tab.settings",n)}`}],jx=["summary","analysis","transactions"],tU=({activeTab:n,setActiveTab:e,language:t="ar"})=>{const[i,o]=de.useState(!1),l=eU(t),u=m=>{e(m),o(!1)},f=l.filter(m=>jx.includes(m.id)),g=l.filter(m=>!jx.includes(m.id));return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"hidden md:flex flex-wrap justify-center mb-8 tab-bar rounded-xl p-2",children:l.map(m=>d.jsx("button",{onClick:()=>u(m.id),className:`tab-btn px-4 py-2 mx-1 mb-1 rounded-lg font-semibold text-sm flex items-center gap-2 ${n===m.id?"active":""}`,children:m.label},m.id))}),d.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 h-20 bg-white/80 backdrop-blur-lg border-t border-slate-200 z-40 flex justify-around items-center",children:[f.map(m=>{const T=m.icon;return d.jsxs("button",{onClick:()=>u(m.id),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${n===m.id?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[T&&d.jsx(T,{}),d.jsx("span",{className:"text-xs",children:m.label.split(" ")[1]})]},m.id)}),d.jsxs("button",{onClick:()=>o(!i),className:`flex flex-col items-center justify-center gap-1 transition-colors w-full h-full ${i?"text-blue-600":"text-slate-500 hover:text-slate-900"}`,children:[d.jsx(Q4,{}),d.jsx("span",{className:"text-xs",children:"المزيد"})]})]}),i&&d.jsx("div",{className:"md:hidden fixed inset-0 bg-gray-900/50 backdrop-blur-sm z-50 flex justify-center items-end",onClick:()=>o(!1),children:d.jsxs("div",{className:"bg-white w-full rounded-t-2xl p-4 border-t border-slate-200 animate-fade-in",onClick:m=>m.stopPropagation(),children:[d.jsx("div",{className:"w-16 h-1 bg-slate-300 rounded-full mx-auto mb-4"}),d.jsx("div",{className:"grid grid-cols-3 gap-4 text-center",children:g.map(m=>d.jsxs("button",{onClick:()=>u(m.id),className:`p-3 rounded-lg flex flex-col items-center gap-2 ${n===m.id?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:[d.jsx("span",{className:"text-2xl",children:m.label.split(" ")[0]}),d.jsx("span",{className:"text-xs font-semibold",children:m.label.split(" ")[1]})]},m.id))})]})})]})},nU=({className:n,darkMode:e=!1})=>d.jsx("div",{className:`absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-${e?"slate-700/80":"slate-200/80"} to-transparent ${n}`}),Hm=({darkMode:n=!1})=>d.jsxs("div",{className:"glass-card p-6 h-96 relative overflow-hidden",children:[d.jsx("div",{className:`h-6 w-1/2 rounded mb-6 ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-5/6 rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-full rounded ${n?"bg-slate-700":"bg-slate-200"}`}),d.jsx("div",{className:`h-4 w-3/4 rounded ${n?"bg-slate-700":"bg-slate-200"}`})]}),d.jsx(nU,{darkMode:n})]}),sU=({darkMode:n=!1})=>d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx("div",{className:"h-16 mb-3"}),d.jsx("div",{className:`flex flex-wrap justify-center mb-8 rounded-xl p-2 h-14 ${n?"bg-slate-700":"bg-slate-100"}`}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsx(Hm,{}),d.jsx(Hm,{}),d.jsx(Hm,{})]})]}),Le=n=>(n||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),iU=({title:n,details:e,barColor:t,darkMode:i=!1,language:o="ar"})=>d.jsxs("div",{className:`p-4 rounded-xl border shadow-sm hover:shadow-md transition-shadow h-32 flex flex-col justify-between ${i?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h4",{className:`font-bold text-sm ${i?"text-slate-200":"text-slate-800"}`,children:n}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"💳"})})]}),d.jsxs("div",{className:`p-2 rounded-lg border ${i?"bg-slate-700 border-slate-600":"bg-slate-50 border-gray-200"}`,children:[d.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[d.jsxs("span",{className:i?"text-slate-400":"text-slate-600",children:[se("due",o),":"]}),d.jsx("span",{className:`font-semibold number-display text-xs ${i?"text-slate-200":"text-slate-900"}`,children:Le(e.balance)})]}),d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:i?"text-slate-400":"text-slate-600",children:[se("remaining",o),":"]}),d.jsx("span",{className:`font-semibold number-display text-xs ${i?"text-slate-200":"text-emerald-700"}`,children:Le(e.available)})]})]}),d.jsx("div",{className:`rounded-full h-1.5 overflow-hidden ${i?"bg-slate-600":"bg-slate-200"}`,children:d.jsx("div",{className:`${t} rounded-full h-1.5 transition-all duration-300`,style:{width:`${Math.min(100,e.usagePercentage)}%`}})})]}),rU=({calculations:n,categories:e,darkMode:t=!1,language:i="ar"})=>{const o=Object.values(n.expensesByCategory).reduce((u,f)=>u+Number(f),0);if(o===0)return d.jsx("p",{className:`text-center p-4 text-sm ${t?"text-slate-400":"text-slate-500"}`,children:se("no.data",i)});const l=Object.entries(n.expensesByCategory).sort(([,u],[,f])=>f-u);return d.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto pr-2",children:l.map(([u,f])=>{const g=e.find(T=>T.id===u);g?`${g.icon}${g.name}`:se("other",i);const m=Number(f)/o*100;return d.jsxs("div",{className:`p-3 rounded-lg border shadow-sm hover:shadow-md transition-shadow h-20 flex flex-col justify-between ${t?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-base",children:(g==null?void 0:g.icon)||"📊"}),d.jsx("span",{className:`font-medium truncate text-sm ${t?"text-slate-300":"text-slate-700"}`,title:g==null?void 0:g.name,children:(g==null?void 0:g.name)||se("other",i)})]}),d.jsx("span",{className:`font-semibold number-display text-sm px-2 py-1 rounded border ${t?"text-slate-200 bg-slate-700 border-slate-600":"text-slate-900 bg-slate-50 border-gray-200"}`,children:Le(f)})]}),d.jsx("div",{className:`mt-2 rounded-full h-1.5 overflow-hidden ${t?"bg-slate-600":"bg-slate-200"}`,children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${m.toFixed(1)}%`}})}),d.jsxs("div",{className:`text-xs mt-1 text-center ${t?"text-slate-400":"text-slate-500"}`,children:[m.toFixed(1),"%"]})]},u)})})},oU=({calculations:n,categories:e,darkMode:t=!1,language:i="ar"})=>{const{totalIncome:o,totalExpenses:l,cardDetails:u,cardPayments:f,bankAccountDetails:g,totalDebt:m,totalAvailable:T,totalLimits:x,totalBankBalance:b}=n,w=o-l,L=["bg-blue-500","bg-red-500","bg-green-500","bg-purple-500","bg-yellow-500"];return d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsxs("h3",{className:`font-semibold text-lg mb-4 ${t?"text-slate-200":"text-slate-800"}`,children:["💳 ",se("card.debts.summary",i)]}),d.jsx("div",{className:"space-y-4",children:Object.values(u).map((k,j)=>d.jsx(iU,{title:k.name,details:k,barColor:L[j%L.length],darkMode:t,language:i},k.id))}),d.jsx("div",{className:`mt-4 p-3 rounded-lg ${t?"bg-slate-700":"bg-slate-100"}`,children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:`font-semibold text-xs mb-2 ${t?"text-red-400":"text-red-600"}`,children:se("total.debts",i)}),d.jsx("p",{className:`font-bold text-sm number-display ${t?"text-red-400":"text-red-600"}`,children:Le(m)})]}),d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:`font-semibold text-xs mb-2 ${t?"text-emerald-400":"text-emerald-600"}`,children:se("total.available",i)}),d.jsx("p",{className:`font-bold text-sm number-display ${t?"text-emerald-400":"text-emerald-600"}`,children:Le(T)})]}),d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-600 font-semibold text-xs mb-2 whitespace-nowrap",children:"إجمالي الحدود"}),d.jsx("p",{className:"font-bold text-sm text-blue-600 number-display",children:Le(x)})]})]})})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"🏦 ملخص الحسابات البنكية"}),d.jsx("div",{className:"space-y-3",children:Object.values(g).map(k=>{const j=k.balance>0?"bank-card-positive":k.balance<0?"bank-card-negative":"bank-card-neutral";return d.jsxs("div",{className:`card-consistent ${j} h-32 flex flex-col justify-between`,children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800",children:k.name}),d.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-sm",children:"🏛️"})})]}),d.jsx("div",{className:"text-center",children:d.jsx("p",{className:"font-bold text-2xl text-blue-900 number-display",children:Le(k.balance)})}),d.jsxs("div",{className:"flex justify-center gap-6 mt-1",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-emerald-600 font-semibold text-xs mb-0.5",children:"الإيداعات"}),d.jsxs("p",{className:"text-emerald-700 font-bold text-sm",children:["+",Le(k.deposits)]})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-red-600 font-semibold text-xs mb-0.5",children:"السحوبات"}),d.jsxs("p",{className:"text-red-700 font-bold text-sm",children:["-",Le(k.withdrawals)]})]})]})]},k.id)})}),d.jsxs("div",{className:"mt-4 card-consistent text-center",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-2",children:"🏦 إجمالي الأرصدة البنكية"}),d.jsx("p",{className:"font-bold text-xl text-blue-900 number-display",children:Le(b)})]})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📈 تقرير مالي شامل"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي الدخل:"}),d.jsx("span",{className:"font-bold text-sm text-emerald-500 number-display",children:Le(o)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"إجمالي المصاريف:"}),d.jsx("span",{className:"font-bold text-sm text-red-500 number-display",children:Le(l)})]}),d.jsx("hr",{className:"my-2 border-slate-200"}),Object.values(u).map((k,j)=>d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["مصاريف ",k.name,":"]}),d.jsx("span",{className:`font-semibold ${L[j%L.length].replace("bg-","text-")} number-display`,children:Le(k.balance+(f[k.id]||0))})]},k.id)),d.jsx("hr",{className:"my-2 border-slate-200 border-dashed"}),Object.entries(f).map(([k,j])=>{var Y;return d.jsxs("div",{className:"flex justify-between text-xs",children:[d.jsxs("span",{className:"text-slate-500",children:["إجمالي سداد ",(Y=u[k])==null?void 0:Y.name,":"]}),d.jsx("span",{className:"font-semibold text-emerald-500 number-display",children:Le(j)})]},k)}),d.jsx("hr",{className:"my-2 border-slate-200"}),d.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[d.jsx("span",{children:"الصافي:"}),d.jsx("span",{className:`number-display ${w>=0?"text-emerald-500":"text-red-500"}`,children:Le(w)})]})]})]}),d.jsxs("div",{className:"card-consistent xl:col-span-1",children:[d.jsx("h3",{className:"font-semibold text-lg text-slate-800 mb-4",children:"📊 ملخص الفئات"}),d.jsx(rU,{calculations:n,categories:e})]})]})},aU=({transactions:n,allTransactions:e,categories:t,deleteTransaction:i,editTransaction:o,state:l,darkMode:u=!1,language:f="ar"})=>{const[g,m]=de.useState(""),[T,x]=de.useState(""),[b,w]=de.useState(""),[L,k]=de.useState(""),[j,Y]=de.useState(""),O=H=>{const N={cash:"💵 نقدي","tabby-bnpl":"📱 تابي (BNPL)","tamara-bnpl":"📱 تمارا (BNPL)"};return N[H]?N[H]:l.cards[H]?`💳 ${l.cards[H].name}`:l.bankAccounts[H]?`🏦 ${l.bankAccounts[H].name}`:H},B=H=>{const N={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(N[H])return N[H];if(H.endsWith("-payment")){const C=H.replace("-payment","");if(l.cards[C])return`💳 سداد ${l.cards[C].name}`}return H},ne=de.useMemo(()=>{let H=n;if(L&&j){const N=new Date(L),C=new Date(j);C.setHours(23,59,59,999),H=e.filter(R=>{const M=new Date(R.date);return M>=N&&M<=C})}return H=H.filter(N=>{const C=g.toLowerCase(),R=t.find(P=>P.id===N.categoryId),M=N.description.toLowerCase().includes(C)||(R==null?void 0:R.name.toLowerCase().includes(C)),V=!T||N.paymentMethod===T,F=!b||N.categoryId===b;return M&&V&&F}),H.sort((N,C)=>{const R=parseInt(N.id.replace("trans-","").split("-")[0]);return parseInt(C.id.replace("trans-","").split("-")[0])-R})},[n,e,g,T,b,L,j,t]),ie=de.useMemo(()=>ne.reduce((H,N)=>(N.type==="income"||N.type.toString().includes("payment")||N.type==="investment-withdrawal"?H.positive+=N.amount:H.negative+=N.amount,H),{positive:0,negative:0}),[ne]);return d.jsx("div",{className:"space-y-6 animate-fade-in",children:d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-4",children:"📋 سجل المعاملات والتقارير"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 items-end p-4 bg-slate-100 rounded-lg mb-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-slate-600 mb-1",children:"من تاريخ"}),d.jsx("input",{type:"date",id:"dateFrom",value:L,onChange:H=>k(H.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى تاريخ"}),d.jsx("input",{type:"date",id:"dateTo",value:j,onChange:H=>Y(H.target.value),className:"w-full p-2"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:"وسيلة الدفع"}),d.jsxs("select",{id:"filterMethod",value:T,onChange:H=>x(H.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الوسائل"}),Object.values(l.bankAccounts).map(H=>d.jsxs("option",{value:H.id,children:["🏦 ",H.name]},H.id)),d.jsx("option",{value:"cash",children:"💵 نقدي"}),Object.values(l.cards).map(H=>d.jsxs("option",{value:H.id,children:["💳 ",H.name]},H.id)),d.jsx("option",{value:"tabby-bnpl",children:"📱 تابي"}),d.jsx("option",{value:"tamara-bnpl",children:"📱 تمارا"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium text-slate-600 mb-1",children:"الفئة"}),d.jsxs("select",{id:"filterCategory",value:b,onChange:H=>w(H.target.value),className:"p-2 w-full",children:[d.jsx("option",{value:"",children:"كل الفئات"}),t.map(H=>d.jsx("option",{value:H.id,children:H.name},H.id))]})]}),d.jsxs("div",{className:"sm:col-span-2 lg:col-span-4",children:[d.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-slate-600 mb-1",children:"بحث بالوصف"}),d.jsx("input",{type:"text",id:"searchTerm",placeholder:"🔍...",value:g,onChange:H=>m(H.target.value),className:"p-2 w-full"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center mb-6",children:[d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-emerald-700",children:"إجمالي الإيجابي"}),d.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-emerald-600 text-lg",children:"💰"})})]}),d.jsx("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200",children:d.jsx("p",{className:"font-bold text-sm text-emerald-800 number-display",children:Le(ie.positive)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-red-700",children:"إجمالي السلبي"}),d.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-red-600 text-lg",children:"💸"})})]}),d.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200",children:d.jsx("p",{className:"font-bold text-sm text-red-800 number-display",children:Le(ie.negative)})})]}),d.jsxs("div",{className:"card-consistent",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsx("h3",{className:"font-semibold text-lg text-sky-700",children:"الصافي"}),d.jsx("div",{className:"w-8 h-8 bg-sky-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-sky-600 text-lg",children:"📊"})})]}),d.jsx("div",{className:"bg-sky-50 p-3 rounded-lg border border-sky-200",children:d.jsx("p",{className:"font-bold text-sm text-sky-800 number-display",children:Le(ie.positive-ie.negative)})})]})]}),d.jsxs("div",{className:"overflow-x-auto",children:[d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الوسيلة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right py-3 px-4 font-semibold hidden sm:table-cell",children:"الوصف"}),d.jsx("th",{className:"text-center py-3 px-4 font-semibold"})]})}),d.jsx("tbody",{children:ne.map(H=>{const N=t.find(R=>R.id===H.categoryId),C=H.type==="income"||H.type.toString().includes("payment")||H.type==="investment-withdrawal";return d.jsxs("tr",{className:"border-b border-gray-200/50 hover:bg-gray-50",children:[d.jsx("td",{className:"p-3",children:H.date}),d.jsx("td",{className:"p-3",children:O(H.paymentMethod)}),d.jsx("td",{className:"p-3",children:B(H.type)}),d.jsxs("td",{className:`p-3 font-semibold number-display ${C?"text-emerald-500":"text-red-500"}`,children:[C?"+":"-"," ",Le(H.amount)]}),d.jsx("td",{className:"p-3",children:N?`${N.icon} ${N.name}`:"غير محدد"}),d.jsx("td",{className:"p-3 text-slate-500 hidden sm:table-cell",children:H.description||"-"}),d.jsx("td",{className:"p-3 text-center",children:d.jsxs("div",{className:"flex gap-2 justify-center",children:[d.jsx("button",{onClick:()=>o(H.id),className:"text-slate-400 hover:text-blue-500 p-1 transition-colors",title:"تعديل الحركة",children:"✏️"}),d.jsx("button",{onClick:()=>i(H.id),className:"text-slate-400 hover:text-red-500 p-1 transition-colors",title:"حذف الحركة",children:d.jsx(La,{})})]})})]},H.id)})})]}),ne.length===0&&d.jsxs("div",{className:"text-center p-8 text-slate-500",children:[d.jsx("p",{children:"لا توجد معاملات تطابق الفلاتر المحددة."}),d.jsx("p",{className:"text-xs mt-1",children:"جرب توسيع النطاق الزمني أو تعديل الفلاتر الأخرى."})]})]})]})})},lU=()=>d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]}),uU=({calculations:n,filteredTransactions:e,darkMode:t=!1,language:i="ar"})=>{const[o,l]=de.useState([{id:"1",text:'أهلاً بك! أنا مساعدك المالي الشامل. يمكنك أن تسألني أسئلة تفصيلية عن وضعك المالي، مثل "ما هو إجمالي ديوني؟" أو "هل إنفاقي هذا الشهر يتوافق مع أهدافي؟"',sender:"ai"}]),[u,f]=de.useState(""),[g,m]=de.useState(!1),T=de.useRef(null);de.useEffect(()=>{var b;(b=T.current)==null||b.scrollTo(0,T.current.scrollHeight)},[o,g]);const x=async b=>{b.preventDefault();const w=u.trim();if(!w||g)return;const L={id:Date.now().toString(),text:w,sender:"user"};l(k=>[...k,L]),f(""),m(!0);try{const j=await pE(w,{periodSummary:n,transactions:e}),Y={id:(Date.now()+1).toString(),text:j,sender:"ai"};l(O=>[...O,Y])}catch(k){const j={id:(Date.now()+1).toString(),text:k instanceof Error?k.message:"عذراً، حدث خطأ ما. يرجى المحاولة مرة أخرى.",sender:"ai"};l(Y=>[...Y,j])}finally{m(!1)}};return d.jsxs("div",{className:"glass-card overflow-hidden flex flex-col",style:{height:"70vh"},children:[d.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 المحلل المالي الذكي"}),d.jsx("p",{className:"text-sm text-slate-500",children:"اسأل أي شيء عن بياناتك المالية للشهر المحدد"})]}),d.jsxs("div",{ref:T,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[o.map(b=>d.jsx("div",{className:`chat-bubble ${b.sender==="user"?"user-bubble":"ai-bubble"}`,children:d.jsx("p",{dangerouslySetInnerHTML:{__html:b.text.replace(/\n/g,"<br />")}})},b.id)),g&&d.jsx(lU,{})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:x,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:u,onChange:b=>f(b.target.value),className:"w-full p-3",placeholder:"اكتب سؤالك هنا...",required:!0,autoComplete:"off",disabled:g}),d.jsx("button",{type:"submit",disabled:g,className:"p-3 magical-button text-white rounded-lg flex-shrink-0 disabled:opacity-50",children:d.jsx(aS,{})})]})})]})},cU=({calculations:n,categories:e,allTransactions:t,darkMode:i=!1,language:o="ar"})=>{const l=de.useRef(null),u=de.useRef(null),f=de.useRef({}),g=de.useMemo(()=>Object.entries(n.expensesByCategory).map(([T,x])=>{const b=e.find(w=>w.id===T);return{name:b?`${b.icon} ${b.name}`:"غير محدد",value:x}}).sort((T,x)=>x.value-T.value),[n.expensesByCategory,e]),m=de.useMemo(()=>{const T={},x=new Date;for(let b=5;b>=0;b--){const L=new Date(x.getFullYear(),x.getMonth()-b,1).toLocaleString("en-US",{month:"short",year:"numeric"});T[L]={income:0,expenses:0}}return t.forEach(b=>{const L=new Date(b.date).toLocaleString("en-US",{month:"short",year:"numeric"});T[L]&&(b.type==="income"&&(T[L].income+=b.amount),(b.type==="expense"||b.type==="bnpl-payment")&&(T[L].expenses+=b.amount))}),{labels:Object.keys(T),incomeData:Object.values(T).map(b=>b.income),expensesData:Object.values(T).map(b=>b.expenses)}},[t]);return de.useEffect(()=>{var x,b;const T=window.Chart;if(T){if((x=f.current.pie)==null||x.destroy(),(b=f.current.bar)==null||b.destroy(),l.current&&g.length>0){const w=l.current.getContext("2d");w&&(f.current.pie=new T(w,{type:"doughnut",data:{labels:g.map(L=>L.name),datasets:[{data:g.map(L=>L.value),backgroundColor:["#3b82f6","#60a5fa","#93c5fd","#bfdbfe","#d1d5db","#9ca3af","#6b7280"],borderColor:"#ffffff",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}if(u.current&&m.labels.length>0){const w=u.current.getContext("2d");w&&(f.current.bar=new T(w,{type:"bar",data:{labels:m.labels,datasets:[{label:"الدخل",data:m.incomeData,backgroundColor:"#10b981",borderRadius:4},{label:"المصاريف",data:m.expensesData,backgroundColor:"#ef4444",borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{color:"#64748b"},grid:{color:"#e2e8f0"}},x:{ticks:{color:"#64748b"},grid:{display:!1}}},plugins:{legend:{labels:{color:"#475569",font:{family:"Cairo"}}}}}}))}return()=>{var w,L;(w=f.current.pie)==null||w.destroy(),(L=f.current.bar)==null||L.destroy()}}},[g,m]),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📊 توزيع مصاريف الفترة"}),d.jsx("div",{className:"h-80",children:g.length>0?d.jsx("canvas",{ref:l}):d.jsx("p",{className:"text-center text-slate-500 mt-10",children:"لا توجد مصاريف لعرضها."})})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📈 الدخل مقابل المصاريف (آخر 6 أشهر)"}),d.jsx("div",{className:"h-80",children:d.jsx("canvas",{ref:u})})]})]})},dU=({state:n,setLoading:e,setModal:t,darkMode:i=!1,language:o="ar"})=>{const[l,u]=de.useState(""),[f,g]=de.useState(""),m=async()=>{const T=parseFloat(l);if(isNaN(T)||T<=0){t({title:se("error",o),body:`<p>${se("invalid.amount",o)}</p>`,confirmText:se("confirm",o),hideCancel:!0});return}e(!0,se("loading",o)),g("");try{const x=new Date;x.setDate(x.getDate()-60);const b=n.transactions.filter(L=>new Date(L.date)>=x&&L.type==="expense");if(b.length<5)throw new Error("لا توجد بيانات كافية عن إنفاقك لإنشاء خطة دقيقة. يرجى إضافة 5 معاملات على الأقل.");const w=await vE(T,n.categories,b);g(w)}catch(x){const b=x instanceof Error?x.message:"حدث خطأ غير متوقع.";t({title:se("error",o),body:`<p>${b}</p>`,confirmText:se("confirm",o),hideCancel:!0})}finally{e(!1)}};return d.jsxs("div",{className:"glass-card p-6 animate-fade-in",children:[d.jsxs("h3",{className:`text-xl font-bold mb-4 ${i?"text-slate-200":"text-slate-900"}`,children:["✨ ",se("budget",o)]}),d.jsxs("div",{className:`flex flex-col sm:flex-row items-end gap-4 mb-6 p-4 rounded-lg ${i?"bg-slate-700":"bg-slate-100"}`,children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("label",{htmlFor:"monthly-budget-input",className:`block text-sm font-medium mb-1 ${i?"text-slate-300":"text-slate-600"}`,children:se("budget.limit",o)}),d.jsx("input",{type:"number",id:"monthly-budget-input",className:`w-full p-2 ${i?"bg-slate-600 text-slate-200 border-slate-500":"bg-white text-slate-900 border-gray-300"} border rounded`,placeholder:"5000",value:l,onChange:T=>u(T.target.value)})]}),d.jsxs("button",{onClick:m,className:"w-full sm:w-auto px-6 py-2 magical-button text-white rounded-lg font-semibold flex-shrink-0",children:["✨ ",se("generate.report",o)]})]}),d.jsx("div",{className:"prose max-w-none",children:f?d.jsx("div",{className:i?"text-slate-200":"text-slate-900",dangerouslySetInnerHTML:{__html:f.replace(/### (.*)/g,`<h4 class="text-lg font-bold ${i?"text-slate-200":"text-slate-900"} mt-3 mb-2">$1</h4>`).replace(/\n/g,"<br />")}}):d.jsx("p",{className:`text-center ${i?"text-slate-400":"text-slate-500"}`,children:se("no.data",o)})})]})},fU=({state:n,setState:e,calculations:t,setModal:i,darkMode:o=!1,language:l="ar"})=>{const[u,f]=de.useState([{id:"1",text:'أهلاً بك! أنا مرشدك لفهم عالم الاستثمار. يمكنك سؤالي عن استراتيجيات، أو مفاهيم مثل "ما هو الاستثمار طويل الأجل؟". تذكر، أنا لا أقدم نصائح مباشرة لشراء أسهم معينة.',sender:"ai"}]),[g,m]=de.useState(""),[T,x]=de.useState(!1),b=de.useRef(null);de.useEffect(()=>{var j;(j=b.current)==null||j.scrollTo(0,b.current.scrollHeight)},[u,T]);const w=j=>{j.preventDefault();const Y=j.target,O=parseFloat(Y.elements.namedItem("investment-amount").value),B=Y.elements.namedItem("investment-type").value,ne=Y.elements.namedItem("payment-method").value;if(isNaN(O)||O<=0){i({title:"خطأ",body:"<p>الرجاء إدخال مبلغ صحيح.</p>"});return}const ie={amount:O,date:new Date().toISOString().split("T")[0],description:B==="deposit"?"إيداع في المحفظة الاستثمارية":"سحب من المحفظة الاستثمارية",paymentMethod:ne,type:B==="deposit"?"investment-deposit":"investment-withdrawal",categoryId:null};e(H=>({...H,transactions:[...H.transactions,{...ie,id:`trans-${Date.now()}`}]})),Y.reset()},L=async j=>{j.preventDefault();const Y=g.trim();if(!(!Y||T)){f(O=>[...O,{id:Date.now().toString(),text:Y,sender:"user"}]),m(""),x(!0);try{const O=await yE(Y);f(B=>[...B,{id:(Date.now()+1).toString(),text:O,sender:"ai"}])}catch(O){f(B=>[...B,{id:(Date.now()+1).toString(),text:O instanceof Error?O.message:"عذراً، حدث خطأ.",sender:"ai"}])}finally{x(!1)}}},k=()=>{const j=`<div><label class="block text-sm font-medium text-slate-600 mb-1">القيمة الحالية للمحفظة (ريال)</label><input type="number" id="edit-investment-value" class="w-full p-2" value="${n.investments.currentValue}"><p class="text-xs text-slate-500 mt-2">أدخل القيمة السوقية الحالية لجميع استثماراتك.</p></div>`;i({show:!0,title:"تحديث قيمة المحفظة",body:j,confirmText:"حفظ",onConfirm:()=>{const Y=parseFloat(document.getElementById("edit-investment-value").value);if(isNaN(Y)||Y<0)return alert("الرجاء إدخال قيمة صحيحة."),!1;e(O=>({...O,investments:{...O.investments,currentValue:Y}}))}})};return d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[d.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[d.jsxs("div",{className:"glass-card p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"💰 القيمة الحالية للمحفظة"}),d.jsx("p",{className:"text-4xl font-bold text-emerald-500 number-display",children:Le(n.investments.currentValue)}),d.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["إجمالي المستثمر: ",d.jsx("span",{className:"font-semibold number-display text-slate-600",children:Le(t.totalInvestmentDeposits)})]}),d.jsx("button",{onClick:k,className:"mt-4 w-full px-4 py-2 bg-slate-200 text-slate-800 rounded-lg hover:bg-slate-300 transition-colors text-sm",children:"✏️ تحديث القيمة الحالية"})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"💸 إضافة حركة استثمارية"}),d.jsxs("form",{onSubmit:w,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-amount",className:"block text-sm font-medium text-slate-600",children:"المبلغ"}),d.jsx("input",{type:"number",id:"investment-amount",name:"investment-amount",className:"mt-1 w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"investment-type",className:"block text-sm font-medium text-slate-600",children:"نوع الحركة"}),d.jsxs("select",{id:"investment-type",name:"investment-type",className:"mt-1 w-full p-2",children:[d.jsx("option",{value:"deposit",children:"إيداع للمحفظة"}),d.jsx("option",{value:"withdrawal",children:"سحب من المحفظة"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"payment-method",className:"block text-sm font-medium text-slate-600",children:"الحساب البنكي"}),d.jsx("select",{id:"payment-method",name:"payment-method",className:"mt-1 w-full p-2",children:Object.values(n.bankAccounts).map(j=>d.jsxs("option",{value:j.id,children:["🏦 ",j.name]},j.id))})]}),d.jsx("button",{type:"submit",className:"w-full magical-button text-white font-semibold py-2 rounded-lg",children:"تنفيذ الحركة"})]})]})]}),d.jsxs("div",{className:"lg:col-span-2 glass-card overflow-hidden flex flex-col",style:{height:"75vh"},children:[d.jsxs("div",{className:"p-4 bg-gray-100 text-center flex-shrink-0",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"🤖 مستشارك الاستثماري الذكي"}),d.jsx("p",{className:"text-sm text-slate-500",children:"اسأل عن المفاهيم والاستراتيجيات لاتخاذ قرارات أفضل"})]}),d.jsxs("div",{ref:b,className:"p-4 flex-grow overflow-y-auto flex flex-col gap-4",children:[u.map(j=>d.jsx("div",{className:`chat-bubble ${j.sender==="user"?"user-bubble":"ai-bubble"}`,dangerouslySetInnerHTML:{__html:j.text.replace(/\n/g,"<br/>")}},j.id)),T&&d.jsxs("div",{className:"ai-bubble chat-bubble typing-indicator flex items-center space-x-1 p-3 self-start",children:[d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),d.jsx("span",{className:"block w-2 h-2 bg-gray-400 rounded-full animate-pulse"})]})]}),d.jsx("div",{className:"p-4 border-t border-gray-200 flex-shrink-0",children:d.jsxs("form",{onSubmit:L,className:"flex gap-2",children:[d.jsx("input",{type:"text",value:g,onChange:j=>m(j.target.value),className:"w-full p-3",placeholder:"اسأل عن الاستثمار...",required:!0,autoComplete:"off",disabled:T}),d.jsx("button",{type:"submit",className:"p-3 magical-button text-white rounded-lg flex-shrink-0",disabled:T,children:d.jsx(aS,{})})]})})]})]})},hU=({card:n,statementDetails:e,openCardFormModal:t,deleteCard:i})=>{const o=l=>!l||l.length===0?'<tr><td colspan="3" class="text-center text-slate-500 py-3">لا توجد حركات</td></tr>':l.map(u=>`
            <tr class="hover:bg-slate-50">
                <td class="p-2">${u.postingDate||u.date}</td>
                <td class="p-2 truncate" title="${u.description}">${u.description}</td>
                <td class="p-2 number-display text-red-500">${Le(u.amount)}</td>
            </tr>
        `).join("");return d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow flex flex-col",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"💳"})}),d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل بطاقة ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>i(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف بطاقة ${n.name}`,children:d.jsx(La,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-amber-700 text-sm font-medium",children:"المبلغ المستحق للكشف الحالي"}),d.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-amber-600 text-lg",children:"📅"})})]}),d.jsx("div",{className:"bg-white p-3 rounded-lg border border-amber-200 mb-2",children:d.jsxs("p",{className:"font-bold text-2xl text-amber-800 number-display text-center",children:[Le(e.statementDueAmount)," ريال"]})}),d.jsxs("div",{className:"flex justify-between items-center text-xs",children:[d.jsx("span",{className:"text-amber-600 font-medium",children:"تاريخ الاستحقاق:"}),d.jsx("span",{className:"font-semibold text-amber-700 bg-amber-100 px-2 py-1 rounded",children:e.dueDate.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]}),d.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border border-gray-200",children:d.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 text-sm font-medium mb-1",children:"الرصيد الإجمالي المستحق"}),d.jsxs("p",{className:"font-bold text-red-800 number-display",children:[Le(n.balance)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[d.jsx("p",{className:"text-blue-700 text-sm font-medium mb-1",children:"الحد الائتماني"}),d.jsxs("p",{className:"font-bold text-blue-800 number-display",children:[Le(n.limit)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 text-center",children:[d.jsx("p",{className:"text-green-700 text-sm font-medium mb-1",children:"الرصيد المتاح"}),d.jsxs("p",{className:"font-bold text-green-800 number-display",children:[Le(n.available)," ريال"]})]}),d.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200 text-center",children:[d.jsx("p",{className:"text-orange-700 text-sm font-medium mb-1",children:"نسبة الاستخدام"}),d.jsxs("p",{className:`font-bold ${n.usagePercentage>80?"text-red-800":n.usagePercentage>60?"text-yellow-800":"text-green-800"}`,children:[n.usagePercentage.toFixed(1),"%"]})]})]})})]}),d.jsxs("div",{className:"mt-4 flex-grow flex flex-col",children:[d.jsxs("h4",{className:"font-semibold text-slate-600 mb-2 border-b border-slate-200 pb-1",children:["المعاملات القادمة (",e.upcomingTransactions.length,")"]}),d.jsx("div",{className:"flex-grow max-h-32 overflow-y-auto",children:d.jsx("table",{className:"w-full text-xs",dangerouslySetInnerHTML:{__html:`<tbody>${o(e.upcomingTransactions)}</tbody>`}})})]})]})},mU=({state:n,openCardFormModal:e,deleteCard:t})=>{const i=de.useMemo(()=>{const l={};return Object.values(n.cards).forEach(u=>{const f=new Date,g=f.getDate(),m=f.getMonth(),T=f.getFullYear();let x,b,w;g>u.statementDay?x=new Date(T,m,u.statementDay):x=new Date(T,m-1,u.statementDay),b=new Date(x.getFullYear(),x.getMonth()-1,u.statementDay+1);let L=x.getMonth()+1,k=x.getFullYear();L>11&&(L=0,k+=1),w=new Date(k,L,u.dueDay);const j=n.transactions.filter(B=>{const ne=new Date(B.postingDate||B.date);return B.paymentMethod===u.id&&(B.type==="expense"||B.type==="bnpl-payment")&&ne>=b&&ne<=x}),Y=n.transactions.filter(B=>{const ne=new Date(B.postingDate||B.date);return B.paymentMethod===u.id&&(B.type==="expense"||B.type==="bnpl-payment")&&ne>x}),O=j.reduce((B,ne)=>B+ne.amount,0);l[u.id]={statementDueAmount:O,dueDate:w,totalOutstanding:0,upcomingTransactions:Y}}),l},[n.transactions,n.cards]),o=Object.values(n.cards);return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة البطاقات"}),d.jsx("button",{onClick:()=>e(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة بطاقة"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(l=>{const u=n.transactions.filter(g=>g.paymentMethod===l.id&&(g.type==="expense"||g.type==="bnpl-payment")).reduce((g,m)=>g+m.amount,0)-n.transactions.filter(g=>g.type===`${l.id}-payment`).reduce((g,m)=>g+m.amount,0),f={...l,balance:u,available:l.limit-u,usagePercentage:l.limit>0?u/l.limit*100:0};return d.jsx(hU,{card:f,statementDetails:i[f.id],openCardFormModal:e,deleteCard:t},f.id)})})]})},pU=(n,e)=>{const t={income:"💰 دخل",expense:"💸 مصاريف","bnpl-payment":"📱 سداد قسط","investment-deposit":"💹 إيداع استثماري","investment-withdrawal":"💹 سحب استثماري"};if(t[n])return t[n];if(n.endsWith("-payment")){const i=n.replace("-payment","");if(e.cards[i])return`💳 سداد ${e.cards[i].name}`}return n},gU=({account:n,openBankAccountFormModal:e,deleteBankAccount:t})=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:"🏦"})}),d.jsx("h4",{className:"text-xl font-bold text-slate-900",children:n.name})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>e(n.id),className:"text-sm bg-white/80 hover:bg-white w-8 h-8 rounded-full flex items-center justify-center transition-colors shadow-sm","aria-label":`تعديل حساب ${n.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>t(n.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف حساب ${n.name}`,children:d.jsx(La,{})})]})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm mb-4",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-center mb-2",children:"الرصيد الحالي"}),d.jsx("p",{className:"text-3xl font-bold text-blue-900 number-display text-center",children:Le(n.balance)})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-emerald-50 p-3 rounded-lg border border-emerald-200 text-center",children:[d.jsx("p",{className:"text-emerald-700 font-semibold text-sm mb-1",children:"إيداعات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-emerald-800 number-display",children:Le(n.deposits)})]}),d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-200 text-center",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"سحوبات الفترة"}),d.jsx("p",{className:"text-lg font-bold text-red-800 number-display",children:Le(n.withdrawals)})]})]})]}),yU=({state:n,setState:e,calculations:t,filteredTransactions:i,categories:o,setModal:l,openBankAccountFormModal:u,deleteBankAccount:f,openTransferModal:g})=>d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"إدارة الحسابات البنكية"}),d.jsxs("div",{className:"flex gap-3",children:[Object.keys(n.bankAccounts).length>1&&d.jsx("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة حساب"})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.values(t.bankAccountDetails).map(m=>d.jsx(gU,{account:m,openBankAccountFormModal:u,deleteBankAccount:f},m.id))}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 معاملات الحسابات البنكية (الفترة المحددة)"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الحساب"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"النوع"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الفئة"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"})]})}),d.jsx("tbody",{children:i.filter(m=>n.bankAccounts[m.paymentMethod]).sort((m,T)=>new Date(T.date).getTime()-new Date(m.date).getTime()).map(m=>{var w;const T=["income","investment-withdrawal"].includes(m.type),x=T?"text-emerald-500":"text-red-500",b=o.find(L=>L.id===m.categoryId);return d.jsxs("tr",{className:"border-b border-gray-200/50",children:[d.jsx("td",{className:"p-3",children:m.date}),d.jsx("td",{className:"p-3",children:(w=n.bankAccounts[m.paymentMethod])==null?void 0:w.name}),d.jsx("td",{className:"p-3",children:pU(m.type,n)}),d.jsxs("td",{className:`p-3 font-semibold ${x} number-display`,children:[T?"+":"-",Le(m.amount)]}),d.jsx("td",{className:"p-3",children:b?`${b.icon} ${b.name}`:"-"}),d.jsx("td",{className:"p-3 text-slate-500",children:m.description||"-"})]},m.id)})})]})})]})]}),vd=(n,e)=>{const t={cash:"💵 نقدي","tabby-bnpl":"📱 تابي","tamara-bnpl":"📱 تمارا",reconciliation:"🔄 تسوية"};return t[n]?t[n]:e.cards[n]?`💳 ${e.cards[n].name}`:e.bankAccounts[n]?`🏦 ${e.bankAccounts[n].name}`:n},vU=({state:n,setState:e,filteredTransactions:t,setModal:i})=>{const[o,l]=wp.useState(!1),u=()=>{const O=n.installments.filter(C=>C.paid<C.total),B=O.filter(C=>C.provider==="tabby-bnpl"),ne=O.filter(C=>C.provider==="tamara-bnpl"),ie=B.reduce((C,R)=>{const M=R.total-R.paid;return C+R.installmentAmount*M},0),H=ne.reduce((C,R)=>{const M=R.total-R.paid;return C+R.installmentAmount*M},0),N=ie+H;return{tabbyTotal:ie,tamaraTotal:H,grandTotal:N,activeCount:O.length,completedCount:n.installments.filter(C=>C.paid>=C.total).length}},f=()=>{const O=n.installments.filter(ie=>ie.paid<ie.total);if(O.length===0)return null;const B=n.transactions.filter(ie=>ie.isInstallmentPayment);if(B.length===0){const ie=O.sort((C,R)=>new Date(C.createdAt).getTime()-new Date(R.createdAt).getTime())[0],H=new Date(ie.createdAt),N=new Date(H);return N.setDate(N.getDate()+30),N.toISOString().split("T")[0]}let ne=null;for(const ie of O){const H=B.filter(N=>N.installmentId===ie.id).sort((N,C)=>new Date(C.date).getTime()-new Date(N.date).getTime());if(H.length>0){const N=H[0],C=new Date(N.date),R=new Date(C);R.setDate(R.getDate()+30),(!ne||R<new Date(ne))&&(ne=R.toISOString().split("T")[0])}else{const N=new Date(ie.createdAt),C=new Date(N);C.setDate(C.getDate()+30),(!ne||C<new Date(ne))&&(ne=C.toISOString().split("T")[0])}}return ne},g=()=>n.installments.filter(B=>B.paid<B.total).reduce((B,ne)=>B+ne.installmentAmount,0),m=()=>{const O=n.installments.filter(ne=>ne.paid<ne.total),B=n.transactions.filter(ne=>ne.isInstallmentPayment);return O.map(ne=>{const ie=B.filter(N=>N.installmentId===ne.id).sort((N,C)=>new Date(C.date).getTime()-new Date(N.date).getTime());let H;if(ie.length>0){const N=ie[0],C=new Date(N.date),R=new Date(C);R.setDate(R.getDate()+30),H=R.toISOString().split("T")[0]}else{const N=new Date(ne.createdAt),C=new Date(N);C.setDate(C.getDate()+30),H=C.toISOString().split("T")[0]}return{installment:ne,nextPaymentDate:H}}).sort((ne,ie)=>new Date(ne.nextPaymentDate).getTime()-new Date(ie.nextPaymentDate).getTime())},T=O=>{const B=n.transactions.find(H=>H.id===O);if(!B||!B.isInstallmentPayment||!n.installments.find(H=>H.id===B.installmentId))return;const ie=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">المبلغ</label>
                    <input type="number" id="edit-amount" value="${B.amount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">التاريخ</label>
                    <input type="date" id="edit-date" value="${B.date}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">الوصف</label>
                    <input type="text" id="edit-description" value="${B.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label>
                    <select id="edit-payment-method" class="w-full p-3 border border-slate-300 rounded-lg">
                        ${Object.values(n.bankAccounts).map(H=>`<option value="${H.id}" ${B.paymentMethod===H.id?"selected":""}>🏦 ${H.name}</option>`).join("")}
                        <option value="cash" ${B.paymentMethod==="cash"?"selected":""}>💵 نقدي</option>
                        ${Object.values(n.cards).map(H=>`<option value="${H.id}" ${B.paymentMethod===H.id?"selected":""}>💳 ${H.name}</option>`).join("")}
                    </select>
                </div>
            </div>
        `;i({show:!0,title:"تعديل حركة القسط",body:ie,confirmText:"حفظ التعديلات",onConfirm:()=>{const H=parseFloat(document.getElementById("edit-amount").value),N=document.getElementById("edit-date").value,C=document.getElementById("edit-description").value,R=document.getElementById("edit-payment-method").value;e(M=>({...M,transactions:M.transactions.map(V=>V.id===O?{...V,amount:H,date:N,description:C,paymentMethod:R}:V)})),i({show:!1})}})},x=O=>{const B=n.transactions.find(ie=>ie.id===O);if(!B||!B.isInstallmentPayment)return;i({show:!0,title:"حذف حركة القسط",body:"<p>هل أنت متأكد من حذف هذه الحركة؟ سيتم تقليل عدد الأقساط المدفوعة للقسط المرتبط.</p>",confirmText:"حذف",onConfirm:()=>{const ie=B.installmentId;e(H=>({...H,transactions:H.transactions.filter(N=>N.id!==O),installments:H.installments.map(N=>N.id===ie?{...N,paid:Math.max(0,N.paid-1)}:N)})),i({show:!1})}})},b=O=>{const B=n.installments.find(ie=>ie.id===O);if(!B)return;const ne=`
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">وصف القسط</label>
                    <input type="text" id="edit-description" value="${B.description}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">قيمة القسط</label>
                    <input type="number" id="edit-amount" value="${B.installmentAmount}" step="0.01" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط الإجمالي</label>
                    <input type="number" id="edit-total" value="${B.total}" min="1" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 mb-2">عدد الأقساط المدفوعة</label>
                    <input type="number" id="edit-paid" value="${B.paid}" min="0" max="${B.total}" class="w-full p-3 border border-slate-300 rounded-lg" />
                </div>
            </div>
        `;i({show:!0,title:"تعديل خطة القسط",body:ne,confirmText:"حفظ التعديلات",onConfirm:()=>{const ie=document.getElementById("edit-description").value,H=parseFloat(document.getElementById("edit-amount").value),N=parseInt(document.getElementById("edit-total").value),C=parseInt(document.getElementById("edit-paid").value);e(R=>({...R,installments:R.installments.map(M=>M.id===O?{...M,description:ie,installmentAmount:H,total:N,paid:C}:M)})),i({show:!1})}})},w=O=>{const B=n.installments.find(ie=>ie.id===O);if(!B)return;const ne=`<p>هل أنت متأكد من حذف خطة القسط "${B.description}"؟ سيتم حذف جميع الحركات المرتبطة بها.</p>`;i({show:!0,title:"حذف خطة القسط",body:ne,confirmText:"حذف",onConfirm:()=>{e(ie=>({...ie,installments:ie.installments.filter(H=>H.id!==O),transactions:ie.transactions.filter(H=>H.installmentId!==O)})),i({show:!1})}})},L=O=>{const B=n.installments.find(H=>H.id===O);if(!B||B.paid>=B.total)return;let ne="";Object.values(n.bankAccounts).forEach(H=>{ne+=`<option value="${H.id}">🏦 ${H.name}</option>`}),ne+='<option value="cash">💵 نقدي</option>',Object.values(n.cards).forEach(H=>{ne+=`<option value="${H.id}">💳 ${H.name}</option>`});const ie=`<p class="mb-4">اختر مصدر الدفع لسداد قسط "${B.description}" بقيمة ${Le(B.installmentAmount)} ريال.</p><div><label for="installment-payment-source" class="block text-sm font-medium text-slate-600 mb-2">مصدر الدفع</label><select id="installment-payment-source" class="w-full p-3">${ne}</select></div>`;i({show:!0,title:"سداد قسط",body:ie,confirmText:"تأكيد الدفع",onConfirm:()=>{var M;const H=document.getElementById("installment-payment-source").value,N=n.categories.find(V=>V.name==="سداد فواتير"||V.name==="💳 سداد فواتير"),C=(N==null?void 0:N.id)||((M=n.categories.find(V=>V.name==="أخرى"))==null?void 0:M.id)||"",R={id:"trans-"+Date.now(),amount:B.installmentAmount,date:new Date().toISOString().split("T")[0],description:`سداد القسط ${B.paid+1} لـ: ${B.description}`,paymentMethod:H,type:"bnpl-payment",categoryId:C,isInstallmentPayment:!0,installmentId:O};e(V=>{const F=V.installments.map(P=>{if(P.id===O){const Ue={...P,paid:P.paid+1};return console.log("🔄 تحديث قسط:",{id:P.id,paid:P.paid,newPaid:Ue.paid,total:P.total}),Ue}return P});return{...V,transactions:[...V.transactions,R],installments:F}})}})},k=n.installments.filter(O=>O.paid<O.total),j=n.transactions.filter(O=>O.isInstallmentPayment),Y=u();return f(),g(),d.jsxs("div",{className:"animate-fade-in",children:[d.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200 shadow-sm mb-6",children:[d.jsx("div",{className:"flex justify-between items-start mb-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-2xl",children:"📊"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"ملخص الأقساط"}),d.jsx("p",{className:"text-sm text-slate-600",children:"إجمالي الأقساط النشطة والمستحقة"})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"🎯"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"إجمالي الأقساط"})]}),d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Le(Y.grandTotal)})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تابي"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le(Y.tabbyTotal)})]}),d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("span",{className:"text-2xl",children:"📱"}),d.jsx("span",{className:"font-semibold text-blue-800",children:"تمارا"})]}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le(Y.tamaraTotal)})]})]}),m().length>0&&d.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("span",{className:"text-2xl",children:"⏰"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:"مواعيد الأقساط التالية"}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقرب المواعيد"})]})]}),d.jsx("div",{className:"space-y-2",children:m().slice(0,3).map((O,B)=>d.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-slate-700",children:O.installment.description}),d.jsx("p",{className:"text-xs text-slate-500",children:vd(O.installment.provider,n)})]}),d.jsxs("div",{className:"text-right",children:[d.jsx("p",{className:"text-sm font-bold text-blue-900",children:new Date(O.nextPaymentDate).toLocaleDateString("en-GB")}),d.jsx("p",{className:"text-xs text-slate-600",children:Le(O.installment.installmentAmount)})]})]},O.installment.id))})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"flex gap-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-2xl font-bold text-blue-900",children:Y.activeCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط نشطة"})]}),d.jsx("div",{className:"text-center",children:d.jsxs("button",{onClick:()=>l(!0),className:"text-center hover:bg-green-50 p-2 rounded-lg transition-colors",children:[d.jsx("p",{className:"text-2xl font-bold text-green-600",children:Y.completedCount}),d.jsx("p",{className:"text-sm text-slate-600",children:"أقساط مكتملة"})]})})]}),m().length>0&&d.jsx("button",{onClick:()=>{n.installments.filter(B=>B.paid<B.total).forEach(B=>{L(B.id)})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"💳 دفع جميع الأقساط"})]})]}),d.jsx("h3",{className:"text-2xl font-bold mb-4 text-slate-900",children:"📱 خطط الأقساط النشطة"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:k.length>0?k.map(O=>{const B=O.paid/O.total*100;return console.log("📊 عرض قسط:",{id:O.id,paid:O.paid,total:O.total,progress:B}),d.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-lg",children:"📱"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-slate-900",children:O.description}),d.jsx("p",{className:"text-sm text-slate-500",children:vd(O.provider,n)})]})]}),d.jsx("div",{className:"bg-blue-50 px-3 py-1 rounded-lg border border-blue-200",children:d.jsxs("span",{className:"font-bold text-blue-800 number-display text-sm",children:[Le(O.installmentAmount),"/شهر"]})})]}),d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-gray-200 mb-3",children:[d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5 mb-2 overflow-hidden",children:d.jsx("div",{className:"bg-blue-700 h-2.5 rounded-full transition-all duration-500",style:{width:`${B}%`}})}),d.jsxs("div",{className:"flex justify-between text-xs text-slate-600",children:[d.jsxs("span",{className:"font-medium",children:[O.paid," / ",O.total," مدفوع"]}),d.jsxs("span",{className:"font-medium",children:["متبقي: ",O.total-O.paid]})]}),d.jsx("div",{className:"text-center mt-2",children:d.jsxs("span",{className:"text-xs text-slate-500",children:[B.toFixed(1),"% مكتمل"]})})]}),d.jsxs("div",{className:"flex gap-2 mt-3",children:[d.jsx("button",{onClick:()=>L(O.id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-300 text-sm shadow-md font-semibold",children:"💳 دفع القسط التالي"}),d.jsx("button",{onClick:()=>b(O.id),className:"px-3 py-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors text-sm",title:"تعديل القسط",children:"✏️"}),d.jsx("button",{onClick:()=>w(O.id),className:"px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-sm",title:"حذف القسط",children:"🗑️"})]})]},O.id)}):d.jsx("div",{className:"md:col-span-2 text-center p-6 glass-card",children:d.jsx("p",{className:"text-slate-500",children:"🎉 لا توجد أقساط نشطة حاليًا!"})})}),d.jsxs("div",{className:"glass-card p-6 mt-8",children:[d.jsx("h3",{className:"text-xl font-bold mb-4 text-slate-900",children:"📋 سجل دفعات الأقساط"}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full text-sm",children:[d.jsx("thead",{className:"border-b border-gray-200",children:d.jsxs("tr",{children:[d.jsx("th",{className:"text-right p-3 font-semibold",children:"التاريخ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الوصف"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المصدر"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"المبلغ"}),d.jsx("th",{className:"text-right p-3 font-semibold",children:"الإجراءات"})]})}),d.jsx("tbody",{children:j.sort((O,B)=>new Date(B.date).getTime()-new Date(O.date).getTime()).map(O=>d.jsxs("tr",{className:"border-b border-gray-200/50",children:[d.jsx("td",{className:"p-3",children:new Date(O.date).toLocaleDateString("en-GB")}),d.jsx("td",{className:"p-3 text-slate-600",children:O.description}),d.jsx("td",{className:"p-3",children:vd(O.paymentMethod,n)}),d.jsx("td",{className:"p-3 text-red-500 font-semibold number-display",children:Le(O.amount)}),d.jsx("td",{className:"p-3",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>T(O.id),className:"px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs transition-colors",title:"تعديل",children:"✏️"}),d.jsx("button",{onClick:()=>x(O.id),className:"px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs transition-colors",title:"حذف",children:"🗑️"})]})})]},O.id))})]})})]}),o&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:O=>O.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"✅ الأقساط المكتملة"}),d.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[Object.values(n.installments).filter(O=>O.paid>=O.total).map(O=>d.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-green-800",children:O.description}),d.jsx("p",{className:"text-sm text-green-600",children:vd(O.provider,n)})]}),d.jsx("span",{className:"bg-green-200 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"مكتمل"})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:O.total}),d.jsx("p",{className:"text-green-600 text-sm",children:"إجمالي الأقساط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:Le(O.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"قيمة القسط"})]}),d.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-bold text-lg",children:Le(O.total*O.installmentAmount)}),d.jsx("p",{className:"text-green-600 text-sm",children:"المجموع الكلي"})]})]})]},O.id)),Object.values(n.installments).filter(O=>O.paid>=O.total).length===0&&d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),d.jsx("p",{className:"text-lg",children:"لا توجد أقساط مكتملة حالياً"}),d.jsx("p",{className:"text-sm",children:"ستظهر الأقساط المكتملة هنا عند إنهائها"})]})]}),d.jsx("div",{className:"flex justify-end mt-6",children:d.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إغلاق"})})]})})})]})},Fx=({onClose:n,onSave:e,initialData:t,type:i,darkMode:o=!1,language:l="ar"})=>{const[u,f]=de.useState({[i==="toMe"?"debtor":"creditor"]:"",amount:0,description:"",date:new Date().toISOString().split("T")[0],status:"pending",source:"",reason:""}),[g,m]=de.useState({});wp.useEffect(()=>{t&&f(t)},[t]);const T=L=>{const{name:k,value:j}=L.target;f(Y=>({...Y,[k]:k==="amount"?parseFloat(j)||0:j})),g[k]&&m(Y=>({...Y,[k]:""}))},x=()=>{const L={};return u[i==="toMe"?"debtor":"creditor"]||(L[i==="toMe"?"debtor":"creditor"]="اسم المدين/الدائن مطلوب"),u.amount<=0&&(L.amount="المبلغ يجب أن يكون أكبر من صفر"),u.description.trim()||(L.description="وصف الدين مطلوب"),u.date||(L.date="تاريخ الدين مطلوب"),m(L),Object.keys(L).length===0},b=L=>{L.preventDefault(),x()&&e(u,t==null?void 0:t.id)},w=i==="toMe";return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:L=>L.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:w?"إضافة دين لي":"إضافة دين علي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(Fu,{})})]}),d.jsxs("form",{onSubmit:b,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:w?"debtor":"creditor",className:"block text-sm font-medium text-slate-600 mb-2",children:w?"اسم المدين":"اسم الدائن"}),d.jsx("input",{type:"text",id:w?"debtor":"creditor",name:w?"debtor":"creditor",value:u[w?"debtor":"creditor"],onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w?"اسم الشخص الذي يدين لي":"اسم الشخص الذي أدين له",required:!0}),g[w?"debtor":"creditor"]&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g[w?"debtor":"creditor"]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",value:u.amount,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0.00",required:!0}),g.amount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.amount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-slate-600 mb-2",children:w?"من أين دينني":"أين أضفت الدين"}),d.jsx("input",{type:"text",id:"source",name:"source",value:u.source,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:w?"مثال: بنك الراجحي، تطبيق ستور":"مثال: بنك الأهلي، تطبيق تابي"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600 mb-2",children:"السبب (اختياري)"}),d.jsx("textarea",{id:"reason",name:"reason",value:u.reason,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"سبب الدين أو تفاصيل إضافية..."})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-2",children:"وصف الدين"}),d.jsx("input",{type:"text",id:"description",name:"description",value:u.description,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"وصف مختصر للدين",required:!0}),g.description&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.description})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ الدين"}),d.jsx("input",{type:"date",id:"date",name:"date",value:u.date,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.date&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.date})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-2",children:"الحالة"}),d.jsxs("select",{id:"status",name:"status",value:u.status,onChange:T,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"pending",children:"معلق"}),d.jsx("option",{value:"partial",children:"جزئي"}),d.jsx("option",{value:"paid",children:"مدفوع"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"إضافة الدين"})]})]})]})})})},_U=({state:n,setState:e,setModal:t,openLoanFormModal:i,darkMode:o=!1,language:l="ar"})=>{const[u,f]=de.useState("loans"),[g,m]=de.useState(!1),[T,x]=de.useState(!1),[b,w]=de.useState(!1),L=M=>{switch(M){case"car":return"🚗";case"house":return"🏠";case"personal":return"👤";case"business":return"💼";case"education":return"🎓";default:return"💰"}},k=M=>{switch(M){case"car":return"سيارة";case"house":return"بيت";case"personal":return"شخصي";case"business":return"تجاري";case"education":return"تعليمي";default:return"أخرى"}},j=M=>{switch(M){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"defaulted":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"partial":return"bg-orange-100 text-orange-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Y=M=>{switch(M){case"active":return"نشط";case"completed":return"مكتمل";case"defaulted":return"متأخر";case"pending":return"معلق";case"partial":return"جزئي";case"paid":return"مدفوع";default:return"غير محدد"}},O=M=>{e(V=>({...V,loans:Object.fromEntries(Object.entries(V.loans).filter(([F])=>F!==M))}))},B=M=>{const V={...M,id:`debt-to-me-${Date.now()}`,createdAt:new Date().toISOString()};e(F=>({...F,debtsToMe:{...F.debtsToMe,[V.id]:V}})),x(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين من "${V.debtor}" بقيمة ${Le(V.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},ne=M=>{const V={...M,id:`debt-from-me-${Date.now()}`,createdAt:new Date().toISOString()};e(F=>({...F,debtsFromMe:{...F.debtsFromMe,[V.id]:V}})),w(!1),t({show:!0,title:"تم إضافة الدين بنجاح",body:`<p>تم إضافة الدين لـ "${V.creditor}" بقيمة ${Le(V.amount)} ريال.</p>`,hideCancel:!0,confirmText:"موافق"})},ie=M=>{e(V=>({...V,debtsToMe:Object.fromEntries(Object.entries(V.debtsToMe).filter(([F])=>F!==M))}))},H=M=>{e(V=>({...V,debtsFromMe:Object.fromEntries(Object.entries(V.debtsFromMe).filter(([F])=>F!==M))}))},N=Object.values(n.loans).filter(M=>M.status==="active").length,C=Object.values(n.debtsToMe).filter(M=>M.status!=="paid").length,R=Object.values(n.debtsFromMe).filter(M=>M.status!=="paid").length;return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"📊 الديون والقروض"})}),d.jsxs("div",{className:"flex space-x-1 bg-slate-100 p-1 rounded-lg",children:[d.jsxs("button",{onClick:()=>f("loans"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="loans"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["🏦 القروض (",N,")"]}),d.jsxs("button",{onClick:()=>f("debts-to-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-to-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💰 الديون لي (",C,")"]}),d.jsxs("button",{onClick:()=>f("debts-from-me"),className:`flex-1 py-2 px-4 rounded-md font-medium transition-colors ${u==="debts-from-me"?"bg-white text-blue-600 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:["💸 الديون علي (",R,")"]})]}),u==="loans"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"القروض الكبيرة"}),d.jsx("button",{onClick:()=>i(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"+ إضافة قرض"})]}),Object.keys(n.loans).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"🏦"}),d.jsx("p",{className:"text-lg",children:"لا توجد قروض مسجلة"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة قرض" لبدء إدارة قروضك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.loans).map(M=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-blue-600 text-xl",children:L(M.type)})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:M.name}),d.jsxs("p",{className:"text-sm text-slate-500",children:[k(M.type)," - ",M.lender]})]})]}),d.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[d.jsx("button",{onClick:()=>i(M.id),className:"text-sm bg-blue-100 hover:bg-blue-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`تعديل قرض ${M.name}`,children:"✏️"}),d.jsx("button",{onClick:()=>O(M.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف قرض ${M.name}`,children:d.jsx(La,{})})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-blue-700 font-semibold text-sm mb-1",children:"المبلغ الإجمالي"}),d.jsx("p",{className:"text-xl font-bold text-blue-900",children:Le(M.totalAmount)})]}),(M.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[d.jsx("span",{className:"font-medium text-slate-700",children:"التقدم"}),d.jsxs("span",{className:"font-medium text-slate-700",children:[Math.round((M.prepaidAmount||0)/M.totalAmount*100),"%"]})]}),d.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3 mb-2",children:d.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${(M.prepaidAmount||0)/M.totalAmount*100}%`}})}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[d.jsxs("div",{className:"bg-green-50 p-2 rounded",children:[d.jsx("p",{className:"text-green-700 font-bold text-sm",children:Math.floor((M.prepaidAmount||0)/M.monthlyPayment)}),d.jsx("p",{className:"text-green-600 text-xs",children:"مدفوع"})]}),d.jsxs("div",{className:"bg-blue-50 p-2 rounded",children:[d.jsx("p",{className:"text-blue-700 font-bold text-sm",children:M.totalMonths-Math.floor((M.prepaidAmount||0)/M.monthlyPayment)}),d.jsx("p",{className:"text-blue-600 text-xs",children:"متبقي"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"القسط الشهري"}),d.jsx("p",{className:"font-semibold text-slate-800",children:Le(M.monthlyPayment)})]}),d.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-1",children:"المدة المتبقية"}),d.jsxs("p",{className:"font-semibold text-slate-800",children:[M.remainingMonths||0," شهر"]})]})]}),(M.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-orange-700 font-semibold text-sm mb-1",children:"مدفوع مسبقاً"}),d.jsx("p",{className:"text-orange-900 font-bold text-lg",children:Le(M.prepaidAmount||0)})]}),d.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-yellow-700 font-semibold text-sm mb-1",children:"القسط التالي"}),d.jsx("p",{className:"text-yellow-900 font-bold text-lg",children:new Date(new Date().getFullYear(),new Date().getMonth()+1,1).toLocaleDateString("en-GB")})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(M.status)}`,children:Y(M.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["بدأ في: ",new Date(M.startDate).toLocaleDateString("en-GB")]})]})]})]},M.id))})]}),u==="debts-to-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة لي"}),d.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold",children:"+ إضافة دين لي"})]}),Object.keys(n.debtsToMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💰"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة لك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين لي" لتسجيل الأموال المستحقة لك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsToMe).map(M=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:M.debtor}),d.jsx("p",{className:"text-sm text-slate-500",children:M.description})]}),d.jsx("button",{onClick:()=>ie(M.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${M.debtor}`,children:d.jsx(La,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-green-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-green-900",children:Le(M.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(M.status)}`,children:Y(M.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(M.date).toLocaleDateString("ar-SA")]})]})]})]},M.id))})]}),u==="debts-from-me"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"الديون المستحقة علي"}),d.jsx("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold",children:"+ إضافة دين علي"})]}),Object.keys(n.debtsFromMe).length===0?d.jsxs("div",{className:"text-center py-12 text-slate-500",children:[d.jsx("div",{className:"text-6xl mb-4",children:"💸"}),d.jsx("p",{className:"text-lg",children:"لا توجد ديون مستحقة عليك"}),d.jsx("p",{className:"text-sm",children:'اضغط على "إضافة دين علي" لتسجيل الأموال المستحقة عليك'})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.values(n.debtsFromMe).map(M=>d.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex justify-between items-start mb-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-lg font-bold text-slate-900",children:M.creditor}),d.jsx("p",{className:"text-sm text-slate-500",children:M.description})]}),d.jsx("button",{onClick:()=>H(M.id),className:"text-sm bg-red-100 hover:bg-red-200 w-8 h-8 rounded-full flex items-center justify-center transition-colors","aria-label":`حذف دين ${M.creditor}`,children:d.jsx(La,{})})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-red-700 font-semibold text-sm mb-1",children:"المبلغ المستحق"}),d.jsx("p",{className:"text-xl font-bold text-red-900",children:Le(M.amount)})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j(M.status)}`,children:Y(M.status)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["تاريخ: ",new Date(M.date).toLocaleDateString("ar-SA")]})]})]})]},M.id))})]}),T&&d.jsx(Fx,{onClose:()=>x(!1),onSave:B,type:"toMe"}),b&&d.jsx(Fx,{onClose:()=>w(!1),onSave:ne,type:"fromMe"})]})},TU=({state:n,setState:e,setModal:t,setLoading:i,onRestore:o,darkMode:l=!1,language:u="ar"})=>{const[f,g]=de.useState(Ma()),[m,T]=de.useState({connected:!1}),[x,b]=de.useState(!0),[w,L]=de.useState({firebase:f.hasFirebase,gemini:f.hasGemini});de.useEffect(()=>{const fe=Ma();g(fe),L({firebase:fe.hasFirebase,gemini:fe.hasGemini}),fe.hasFirebase?(async()=>{try{b(!0);const $e=await wi.getData("test","connection");T({connected:!0})}catch($e){T({connected:!1,error:$e instanceof Error?$e.message:"خطأ في الاتصال"})}finally{b(!1)}})():(T({connected:!1,error:"مفاتيح Firebase غير متوفرة"}),b(!1))},[]);const k=({isValid:fe})=>fe?d.jsx(Bm,{className:"w-6 h-6 text-green-500"}):d.jsx(zm,{className:"w-6 h-6 text-red-500"}),j=()=>d.jsx(W4,{className:"w-6 h-6 text-yellow-500"}),[Y,O]=de.useState({name:"",icon:""}),[B,ne]=de.useState(null),[ie,H]=de.useState({name:"",icon:""}),[N,C]=de.useState({name:"",icon:""}),R=()=>{if(!Y.name.trim()||!Y.icon.trim()){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}const ge={id:`cat-${Date.now()}`,name:Y.name.trim(),icon:Y.icon.trim()};e($e=>({...$e,categories:[...$e.categories,ge]})),O({name:"",icon:""}),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})},[M,V]=de.useState(!1),F=async()=>{const fe=Y.name.trim();if(!fe){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}V(!0);try{const{suggestCategoryIcon:ge,initializeAi:$e}=await xi(async()=>{const{suggestCategoryIcon:bn,initializeAi:Pn}=await Promise.resolve().then(()=>OM);return{suggestCategoryIcon:bn,initializeAi:Pn}},void 0);$e();const Pt=await ge(fe);Pt&&Pt.trim()?O(bn=>({...bn,icon:Pt.trim()})):t({title:se("error",u),body:`<p>${se("unknown.error",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}catch(ge){console.error("Icon suggestion error:",ge),t({title:se("error",u),body:`<p>${se("try.again",u)}</p><p>${se("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}finally{V(!1)}},P=fe=>{n.transactions.some(ge=>ge.categoryId===fe)?t({title:se("cannot.delete",u),body:`<p>${se("cannot.delete.category",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}):(e(ge=>({...ge,categories:ge.categories.filter($e=>$e.id!==fe)})),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}))},[Ue,it]=de.useState(!1),ee=async()=>{const fe=ie.name.trim();if(!fe){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}try{it(!0);const ge=await Zm(fe);ge&&ge.trim()?H($e=>({...$e,icon:ge.trim()})):t({title:se("error",u),body:`<p>${se("unknown.error",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}catch(ge){console.error("Transaction type icon suggestion error:",ge),t({title:se("error",u),body:`<p>${se("try.again",u)}</p><p>${se("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}finally{it(!1)}},[W,pe]=de.useState(!1),Me=async()=>{const fe=N.name.trim();if(!fe){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}try{pe(!0);const ge=await Zm(fe);ge&&ge.trim()?C($e=>({...$e,icon:ge.trim()})):t({title:se("error",u),body:`<p>${se("unknown.error",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}catch(ge){console.error("Payment method icon suggestion error:",ge),t({title:se("error",u),body:`<p>${se("try.again",u)}</p><p>${se("details",u)}: ${ge.message}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}finally{pe(!1)}},Ie=()=>{if(!ie.name.trim()||!ie.icon.trim()){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}const ge={id:`custom-type-${Date.now()}`,name:ie.name.trim(),icon:ie.icon.trim(),isCustom:!0};e($e=>({...$e,customTransactionTypes:[...$e.customTransactionTypes||[],ge]})),H({name:"",icon:""}),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})},q=fe=>{n.transactions.some(ge=>ge.type===fe)?t({title:se("cannot.delete",u),body:`<p>${se("cannot.delete.transaction.type",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}):(e(ge=>({...ge,customTransactionTypes:(ge.customTransactionTypes||[]).filter($e=>$e.id!==fe)})),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}))},oe=()=>{if(!N.name.trim()||!N.icon.trim()){t({title:se("error",u),body:`<p>${se("required.field",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});return}const ge={id:`custom-payment-${Date.now()}`,name:N.name.trim(),icon:N.icon.trim(),isCustom:!0};e($e=>({...$e,customPaymentMethods:[...$e.customPaymentMethods||[],ge]})),C({name:"",icon:""}),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})},ve=fe=>{n.transactions.some(ge=>ge.paymentMethod===fe)?t({title:se("cannot.delete",u),body:`<p>${se("cannot.delete.payment.method",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}):(e(ge=>({...ge,customPaymentMethods:(ge.customPaymentMethods||[]).filter($e=>$e.id!==fe)})),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)}))},_e=()=>{try{const fe=JSON.stringify(n,null,2),ge=new Blob([fe],{type:"application/json"}),$e=URL.createObjectURL(ge),Pt=document.createElement("a");Pt.href=$e,Pt.download=`masrof_backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Pt),Pt.click(),document.body.removeChild(Pt),URL.revokeObjectURL($e),t({title:se("success",u),body:"<p>تم إنشاء النسخة الاحتياطية بنجاح</p>",hideCancel:!0,confirmText:se("confirm",u)})}catch{t({title:se("error",u),body:"<p>فشل في إنشاء النسخة الاحتياطية</p>",hideCancel:!0,confirmText:se("confirm",u)})}},Ne=()=>{t({title:"استعادة البيانات المحلية",body:"<p>هل تريد استعادة البيانات من النسخ الاحتياطية المحلية؟</p>",confirmText:"نعم، استعادة",onConfirm:()=>{try{let fe=localStorage.getItem("financial_dashboard_backup_1");if(fe||(fe=localStorage.getItem("financial_dashboard_backup_2")),fe){const ge=JSON.parse(fe);e(ge),t({title:se("success",u),body:"<p>تم استعادة البيانات بنجاح</p>",hideCancel:!0,confirmText:se("confirm",u)})}else t({title:se("error",u),body:"<p>لم توجد نسخ احتياطية محلية</p>",hideCancel:!0,confirmText:se("confirm",u)})}catch{t({title:se("error",u),body:"<p>فشل في استعادة البيانات</p>",hideCancel:!0,confirmText:se("confirm",u)})}}})},Oe=async()=>{i(!0,se("loading",u));try{const fe=await wi.saveData("backups",`backup_${new Date().toISOString().split("T")[0]}`,{...n,backupDate:new Date().toISOString(),version:"1.0.0"});if(fe.success)t({title:se("success",u),body:`<p>${se("success",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)});else throw new Error(fe.error)}catch{t({title:se("error",u),body:`<p>${se("unknown.error",u)}</p>`,hideCancel:!0,confirmText:se("confirm",u)})}finally{i(!1)}},Ye=fe=>{var Pt;const ge=(Pt=fe.target.files)==null?void 0:Pt[0];if(!ge)return;const $e=new FileReader;$e.onload=bn=>{var Pn;try{const _t=JSON.parse((Pn=bn.target)==null?void 0:Pn.result);if(_t!=null&&_t.transactions&&(_t!=null&&_t.categories))o?o(_t):t({show:!0,title:se("restore.backup",u),body:`<p>${se("confirm.restore",u)}</p>`,confirmText:se("confirm",u),onConfirm:()=>{const Xs={transactions:_t.transactions||[],categories:_t.categories||[],installments:_t.installments||[],investments:_t.investments||{currentValue:0},cards:_t.cards||{},bankAccounts:_t.bankAccounts||{}};e(Xs),t({title:se("success",u),body:`<p>${se("success",u)}</p>`,confirmText:se("confirm",u),hideCancel:!0})}});else throw new Error("Invalid backup file format.")}catch{t({show:!0,title:se("error",u),body:`<p>${se("unknown.error",u)}</p>`,confirmText:se("confirm",u),hideCancel:!0})}},$e.readAsText(ge),fe.target.value=""};return d.jsxs("div",{className:"space-y-6 animate-fade-in",children:[d.jsx("div",{className:"flex justify-between items-center",children:d.jsxs("h2",{className:`text-2xl font-bold ${l?"text-slate-200":"text-slate-900"}`,children:["⚙️ ",se("settings",u)]})}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsxs("h3",{className:`text-lg font-bold mb-4 ${l?"text-slate-200":"text-slate-900"}`,children:["🔑 ",se("api.status",u)]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg ${l?"bg-slate-700":"bg-slate-50"}`,children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🔥"}),d.jsxs("div",{children:[d.jsx("h4",{className:`font-semibold ${l?"text-slate-200":"text-slate-800"}`,children:"Firebase Configuration"}),d.jsxs("p",{className:`text-sm ${l?"text-slate-400":"text-slate-600"}`,children:["Project ID: ",jt.firebase.projectId]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:w.firebase?m.connected?d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(j,{}),d.jsx("span",{className:"text-sm text-yellow-600",children:"مفاتيح موجودة لكن غير متصل"})]}):d.jsxs(d.Fragment,{children:[d.jsx(zm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"مفاتيح غير متوفرة"})]})})]}),d.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"text-2xl",children:"🤖"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800",children:"Gemini AI API"}),d.jsxs("p",{className:"text-sm text-slate-600",children:["Model: ",jt.gemini.model]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:w.gemini?d.jsxs(d.Fragment,{children:[d.jsx(Bm,{className:"w-6 h-6 text-green-500"}),d.jsx("span",{className:"text-sm text-green-600",children:"مُعد"})]}):d.jsxs(d.Fragment,{children:[d.jsx(zm,{className:"w-6 h-6 text-red-500"}),d.jsx("span",{className:"text-sm text-red-600",children:"غير مُعد"})]})})]})]}),!f.isValid&&d.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[d.jsx("h5",{className:"font-semibold text-red-800 mb-2",children:"⚠️ تحذيرات:"}),d.jsx("ul",{className:"space-y-1",children:f.errors.map((fe,ge)=>d.jsxs("li",{className:"text-sm text-red-600",children:["• ",fe]},ge))})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📱 معلومات المشروع"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"اسم التطبيق"}),d.jsx("p",{className:"font-semibold text-slate-800",children:jt.app.name})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"الإصدار"}),d.jsx("p",{className:"font-semibold text-slate-800",children:jt.app.version})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"البيئة"}),d.jsx("p",{className:"font-semibold text-slate-800",children:jt.app.environment})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"حالة النظام"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(k,{isValid:f.isValid&&m.connected}),d.jsx("span",{className:`text-sm font-semibold ${f.isValid&&m.connected?"text-green-600":"text-red-600"}`,children:f.isValid&&m.connected?"جاهز":"يحتاج إعداد"})]})]}),d.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"تطوير"}),d.jsx("p",{className:"font-semibold text-slate-800",children:"Khaleel Alsani"})]})]})]}),(!f.isValid||!m.connected)&&d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📝 تعليمات الإعداد"}),d.jsxs("div",{className:"space-y-4",children:[!w.gemini&&d.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"🤖 إعداد Gemini API:"}),d.jsxs("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside",children:[d.jsxs("li",{children:["اذهب إلى ",d.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",className:"underline",children:"Google AI Studio"})]}),d.jsx("li",{children:"أنشئ مفتاح API جديد"}),d.jsxs("li",{children:["أضف المفتاح كـ GitHub Secret باسم ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"VITE_GEMINI_API_KEY"})]}),d.jsxs("li",{children:["أو ضعه في ملف ",d.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," للتطوير المحلي"]})]})]}),!w.firebase&&d.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔥 إعداد Firebase:"}),d.jsxs("p",{className:"text-sm text-blue-700",children:["تأكد من إضافة جميع مفاتيح Firebase كـ GitHub Secrets:",d.jsx("br",{}),"• VITE_FIREBASE_API_KEY",d.jsx("br",{}),"• VITE_FIREBASE_AUTH_DOMAIN",d.jsx("br",{}),"• VITE_FIREBASE_PROJECT_ID",d.jsx("br",{}),"• VITE_FIREBASE_STORAGE_BUCKET",d.jsx("br",{}),"• VITE_FIREBASE_MESSAGING_SENDER_ID",d.jsx("br",{}),"• VITE_FIREBASE_APP_ID"]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"📂 إدارة الفئات"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"➕ إضافة فئة جديدة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم الفئة",value:Y.name,onChange:fe=>O(ge=>({...ge,name:fe.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 🍔)",value:Y.icon,onChange:fe=>O(ge=>({...ge,icon:fe.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:F,disabled:!Y.name.trim()||M,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:M?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"})]})]}),d.jsx("button",{onClick:R,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة الفئة"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.categories.map(fe=>d.jsxs("div",{className:"p-3 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-lg",children:fe.icon}),d.jsx("span",{className:"text-sm font-medium text-slate-800",children:fe.name})]}),d.jsx("button",{onClick:()=>P(fe.id),className:"text-red-500 hover:text-red-700 text-sm",title:"حذف الفئة",children:"🗑️"})]},fe.id))})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"⚙️ إدارة أنواع الحركات ووسائل الدفع"}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"📝 أنواع الحركات المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم نوع الحركة (مثل: سحب نقدي)",value:ie.name,onChange:fe=>H(ge=>({...ge,name:fe.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💸)",value:ie.icon,onChange:fe=>H(ge=>({...ge,icon:fe.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:ee,disabled:!ie.name.trim()||Ue,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:Ue?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:Ie,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customTransactionTypes||[]).map(fe=>d.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:fe.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:fe.name})]}),d.jsx("button",{onClick:()=>q(fe.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف نوع الحركة",children:"🗑️"})]},fe.id))})]}),d.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-3",children:"💳 وسائل الدفع المخصصة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsx("input",{type:"text",placeholder:"اسم وسيلة الدفع (مثل: PayPal)",value:N.name,onChange:fe=>C(ge=>({...ge,name:fe.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"الأيقونة (مثل: 💳)",value:N.icon,onChange:fe=>C(ge=>({...ge,icon:fe.target.value})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{type:"button",onClick:Me,disabled:!N.name.trim()||W,className:"px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[44px]",title:"اقتراح أيقونة بالذكاء الاصطناعي",children:W?d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):"🤖"}),d.jsx("button",{onClick:oe,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"➕ إضافة"})]})]}),d.jsx("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-2",children:(n.customPaymentMethods||[]).map(fe=>d.jsxs("div",{className:"p-2 bg-white border border-slate-200 rounded-lg flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm",children:fe.icon}),d.jsx("span",{className:"text-xs font-medium text-slate-800",children:fe.name})]}),d.jsx("button",{onClick:()=>ve(fe.id),className:"text-red-500 hover:text-red-700 text-xs",title:"حذف وسيلة الدفع",children:"🗑️"})]},fe.id))})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 أنواع الحركات المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💰 دخل"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💸 مصاريف"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 سداد قسط"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 إيداع استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💹 سحب استثماري"}),d.jsx("span",{className:"text-blue-600",children:"مدمج"})]})]})]}),d.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[d.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"💳 وسائل الدفع المدمجة"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💵 نقدي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تابي"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"📱 تمارا"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{children:"💳 سداد البطاقات"}),d.jsx("span",{className:"text-green-600",children:"مدمج"})]})]})]})]})]}),d.jsxs("div",{className:"glass-card p-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900",children:"💾 النسخ الاحتياطي والاستعادة"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📤 نسخة احتياطية محلية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ جميع بياناتك في ملف آمن."}),d.jsx("button",{onClick:_e,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"💾 تحميل ملف"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"☁️ نسخة احتياطية سحابية"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"احفظ بياناتك في السحابة للوصول من أي مكان."}),d.jsx("button",{onClick:Oe,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:"☁️ حفظ في السحابة"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-slate-800 mb-2",children:"📥 استعادة البيانات"}),d.jsx("p",{className:"text-slate-600 mb-3 text-sm",children:"استعد بياناتك من ملف نسخة احتياطية."}),d.jsx("input",{type:"file",id:"backup-file",accept:".json",className:"hidden",onChange:Ye}),d.jsx("button",{onClick:()=>{var fe;return(fe=document.getElementById("backup-file"))==null?void 0:fe.click()},className:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg transition-colors mb-2",children:"📥 استعادة من ملف"}),d.jsx("button",{onClick:Ne,className:"w-full px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors",children:"🔄 استعادة محلية"})]})]})]}),d.jsx("div",{className:"text-center",children:d.jsx("button",{onClick:()=>{g(Ma()),window.location.reload()},disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:x?"جاري التحقق...":"🔄 إعادة التحقق"})})]})},xU=({onClose:n,onSave:e,initialData:t,categories:i,cards:o,bankAccounts:l,loans:u,setModalConfig:f,darkMode:g=!1,language:m="ar"})=>{var ee;const[T,x]=de.useState({amount:0,date:new Date().toISOString().split("T")[0],description:"",paymentMethod:Object.keys(l)[0]||"cash",type:"expense",categoryId:((ee=i.find(W=>W.name==="أخرى"))==null?void 0:ee.id)||null}),[b,w]=de.useState(!1),[L,k]=de.useState(""),[j,Y]=de.useState({isOpen:!1,text:""}),[O,B]=de.useState(!1),[ne,ie]=de.useState(!1),[H,N]=de.useState(4),[C,R]=de.useState(Object.keys(l)[0]||"cash");de.useEffect(()=>{var W;t?x(t):(W=navigator.clipboard)!=null&&W.readText&&(async()=>{try{const pe=await navigator.clipboard.readText();pe&&pe.trim().length>10&&sessionStorage.getItem("ignoredClipboardText")!==pe&&Y({isOpen:!0,text:pe})}catch{console.info("Clipboard read access denied or not supported.")}})()},[t]);const M=W=>{const{name:pe,value:Me}=W.target;if(pe==="paymentMethod"){const Ie=Me.includes("bnpl");ie(Ie),Ie&&x(q=>({...q,type:"expense"}))}x(Ie=>({...Ie,[pe]:pe==="amount"?parseFloat(Me):Me}))},V=W=>{if(W.preventDefault(),T.type==="income"&&Object.keys(u).length>0&&Object.values(u).filter(Me=>Me.status==="active").length>0){B(!0);return}ne&&T.paymentMethod.includes("bnpl")?e({...T,bnplData:{installmentsCount:H,initialPaymentSource:C,installmentAmount:T.amount/H}},t==null?void 0:t.id):e(T,t==null?void 0:t.id)},F=async W=>{if(W.trim()){w(!0),k("");try{const pe=await gE(W,i,o,l),Me=JSON.parse(pe);Me.error?k(Me.error):x(Ie=>({...Ie,amount:Me.amount||Ie.amount,date:Me.date||Ie.date,description:Me.merchant||Ie.description,paymentMethod:Me.paymentMethod||Ie.paymentMethod,categoryId:Me.categoryId||Ie.categoryId}))}catch(pe){k(pe instanceof Error?pe.message:se("unknown.error",m)),console.error(pe)}finally{w(!1)}}},P=async()=>{k("");try{if(navigator.permissions&&navigator.permissions.query&&(await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){k("تم رفض الوصول إلى الحافظة. لتفعيل هذه الميزة، يرجى الذهاب إلى إعدادات الموقع في متصفحك والسماح بالوصول إلى الحافظة.");return}const W=await navigator.clipboard.readText();W&&W.trim().length>0?F(W):k("الحافظة فارغة. الرجاء نسخ نص المعاملة أولاً.")}catch(W){console.error("Clipboard operation failed: ",W),k("فشل الوصول إلى الحافظة. يرجى منح الإذن عند طلبه، أو التحقق من إعدادات المتصفح.")}},Ue=de.useMemo(()=>{const W=[{value:"cash",label:"💵 نقدي"}];return Object.values(l).forEach(pe=>W.push({value:pe.id,label:`🏦 ${pe.name}`})),Object.values(o).forEach(pe=>W.push({value:pe.id,label:`💳 ${pe.name}`})),W.push({value:"tabby-bnpl",label:"📱 تابي"}),W.push({value:"tamara-bnpl",label:"📱 تمارا"}),W},[l,o]),it=de.useMemo(()=>{const W=[{value:"expense",label:"💸 مصاريف"},{value:"income",label:"💰 دخل"},{value:"bnpl-payment",label:"📱 سداد قسط"},{value:"investment-deposit",label:"💹 إيداع استثماري"},{value:"investment-withdrawal",label:"💹 سحب استثماري"}];return Object.values(o).forEach(pe=>W.push({value:`${pe.id}-payment`,label:`💳 سداد ${pe.name}`})),W},[o]);return d.jsxs(d.Fragment,{children:[j.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4",onClick:()=>Y({isOpen:!1,text:""}),children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:W=>W.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"اكتشاف نص في الحافظة"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"وجدنا نصاً في حافظة النصوص. هل تود لصقه وتحليله لتعبئة الحقول تلقائياً؟"}),d.jsx("pre",{className:"bg-slate-100 p-3 rounded-md text-xs text-slate-500 max-h-24 overflow-y-auto whitespace-pre-wrap font-sans",children:j.text}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{onClick:()=>{sessionStorage.setItem("ignoredClipboardText",j.text),Y({isOpen:!1,text:""})},className:"px-4 py-2 bg-slate-200 rounded-lg",children:"تجاهل"}),d.jsx("button",{onClick:()=>{Y({isOpen:!1,text:""}),F(j.text)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"لصق وتحليل"})]})]})})}),d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:W=>W.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحركة":"إضافة حركة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(Fu,{})})]}),d.jsxs("button",{type:"button",onClick:P,disabled:b,className:"w-full flex items-center justify-center gap-2 mb-4 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50",children:[d.jsx($4,{}),d.jsx("span",{children:"لصق وتحليل من الحافظة"})]}),b&&d.jsxs("div",{className:"text-center p-4 mb-4 bg-blue-50 rounded-lg",children:[d.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"}),d.jsx("p",{className:"text-blue-600 mt-2 text-sm",children:"جاري التحليل..."})]}),L&&d.jsx("p",{className:"text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg",children:L}),d.jsxs("form",{onSubmit:V,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"form-label",children:"المبلغ"}),d.jsx("input",{type:"number",name:"amount",value:T.amount,onChange:M,className:"w-full",required:!0,step:"0.01"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"date",className:"form-label",children:"التاريخ"}),d.jsx("input",{type:"date",name:"date",value:T.date,onChange:M,className:"w-full",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"form-label",children:"الوصف"}),d.jsx("input",{type:"text",name:"description",value:T.description,onChange:M,className:"w-full",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"form-label",children:"نوع الحركة"}),d.jsx("select",{name:"type",value:T.type,onChange:M,className:"w-full",children:it.map(W=>d.jsx("option",{value:W.value,children:W.label},W.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"paymentMethod",className:"form-label",children:"وسيلة الدفع"}),d.jsx("select",{name:"paymentMethod",value:T.paymentMethod,onChange:M,className:"w-full",children:Ue.map(W=>d.jsx("option",{value:W.value,children:W.label},W.value))})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"categoryId",className:"form-label",children:"الفئة"}),d.jsxs("select",{name:"categoryId",value:T.categoryId||"",onChange:M,className:"w-full",children:[d.jsx("option",{value:"",children:"-- اختر فئة --"}),i.map(W=>d.jsxs("option",{value:W.id,children:[W.icon," ",W.name]},W.id))]})]}),ne&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[d.jsx("h3",{className:"font-semibold text-blue-800",children:"📱 إعدادات التقسيط"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"installmentsCount",className:"form-label",children:"عدد الأقساط"}),d.jsxs("select",{value:H,onChange:W=>N(parseInt(W.target.value)),className:"w-full",children:[d.jsx("option",{value:2,children:"قسطين (2)"}),d.jsx("option",{value:3,children:"3 أقساط"}),d.jsx("option",{value:4,children:"4 أقساط"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"initialPaymentSource",className:"form-label",children:"مصدر الدفعة الأولى"}),d.jsx("select",{value:C,onChange:W=>R(W.target.value),className:"w-full",children:Ue.filter(W=>!W.value.includes("bnpl")).map(W=>d.jsx("option",{value:W.value,children:W.label},W.value))})]})]}),d.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:d.jsxs("p",{className:"text-sm text-blue-700",children:[d.jsx("strong",{children:"الدفعة الأولى:"})," ",(T.amount/H).toFixed(2)," ريال",d.jsx("br",{}),d.jsx("strong",{children:"المبلغ المتبقي:"})," ",(T.amount*(H-1)/H).toFixed(2)," ريال"]})})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحركة"})]})]})})}),O&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md animate-fade-in",onClick:W=>W.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"خصم أقساط القروض"}),d.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"لديك قروض نشطة. هل تريد خصم أقساطها من هذا الراتب؟"}),d.jsx("div",{className:"space-y-3 mb-6",children:Object.values(u).filter(W=>W.status==="active").map(W=>d.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:d.jsx("div",{className:"flex justify-between items-center",children:d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold text-blue-800",children:W.name}),d.jsxs("p",{className:"text-sm text-blue-600",children:["القسط: ",W.monthlyPayment.toLocaleString()," ريال"]})]})})},W.id))}),d.jsxs("div",{className:"flex justify-end gap-3",children:[d.jsx("button",{onClick:()=>{B(!1),e(T,t==null?void 0:t.id)},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"لا، حفظ الراتب فقط"}),d.jsx("button",{onClick:()=>{B(!1);const W=Object.values(u).filter(Ie=>Ie.status==="active"),pe=W.reduce((Ie,q)=>Ie+q.monthlyPayment,0),Me={...T};W.map(Ie=>({id:`trans-${Date.now()}-loan-${Ie.id}`,amount:Ie.monthlyPayment,date:T.date,description:`قسط شهري - ${Ie.name}`,paymentMethod:T.paymentMethod,type:"expense",categoryId:null})),e(Me,t==null?void 0:t.id),f({title:"تم حفظ الراتب وخصم الأقساط",body:`<p>تم خصم ${pe.toLocaleString()} ريال كأقساط قروض من الراتب.</p>`,hideCancel:!0,confirmText:"موافق"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"نعم، خصم الأقساط"})]})]})})})]})},EU=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:o="ar"})=>{var m;const[l,u]=de.useState({name:"",limit:0,dueDay:15,statementDay:25,smsSamples:[]});de.useEffect(()=>{t&&u(t)},[t]);const f=T=>{const{name:x,value:b,type:w}=T.target;u(x==="smsSamples"?L=>({...L,smsSamples:b.split(",").map(k=>k.trim()).filter(Boolean)}):L=>({...L,[x]:w==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل البطاقة":"إضافة بطاقة جديدة"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(Fu,{})})]}),d.jsxs("form",{onSubmit:g,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم البطاقة"}),d.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:"w-full p-2",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"limit",className:"block text-sm font-medium text-slate-600 mb-1",children:"الحد الائتماني"}),d.jsx("input",{type:"number",name:"limit",value:l.limit,onChange:f,className:"w-full p-2",required:!0,step:"100"})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"statementDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم إصدار الكشف (شهرياً)"}),d.jsx("input",{type:"number",name:"statementDay",value:l.statementDay,onChange:f,className:"w-full p-2",required:!0,min:"1",max:"31"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"dueDay",className:"block text-sm font-medium text-slate-600 mb-1",children:"يوم الاستحقاق (شهرياً)"}),d.jsx("input",{type:"number",name:"dueDay",value:l.dueDay,onChange:f,className:"w-full p-2",required:!0,min:"1",max:"31"})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:f,className:"w-full p-2",placeholder:"مثال: SNB, الأهلي, إئتمانية"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة البطاقة"})]})]})})})},bU=({onClose:n,onSave:e,initialData:t,darkMode:i=!1,language:o="ar"})=>{var m;const[l,u]=de.useState({name:"",balance:0,currency:"SAR",smsSamples:[]});de.useEffect(()=>{t&&u(t)},[t]);const f=T=>{const{name:x,value:b,type:w}=T.target;u(x==="smsSamples"?L=>({...L,smsSamples:b.split(",").map(k=>k.trim()).filter(Boolean)}):L=>({...L,[x]:w==="number"?parseFloat(b)||0:b}))},g=T=>{T.preventDefault(),e(l,t==null?void 0:t.id)};return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg animate-fade-in",onClick:T=>T.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل الحساب":"إضافة حساب بنكي"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(Fu,{})})]}),d.jsxs("form",{onSubmit:g,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:"اسم الحساب"}),d.jsx("input",{type:"text",name:"name",value:l.name,onChange:f,className:"w-full p-2",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"balance",className:"block text-sm font-medium text-slate-600 mb-1",children:"الرصيد الافتتاحي"}),d.jsx("input",{type:"number",name:"balance",value:l.balance,onChange:f,className:"w-full p-2",required:!0,step:"10"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-slate-600 mb-1",children:"العملة"}),d.jsxs("select",{name:"currency",value:l.currency||"SAR",onChange:f,className:"w-full p-2",required:!0,children:[d.jsx("option",{value:"SAR",children:"🇸🇦 ريال سعودي (SAR)"}),d.jsx("option",{value:"AED",children:"🇦🇪 درهم إماراتي (AED)"}),d.jsx("option",{value:"USD",children:"🇺🇸 دولار أمريكي (USD)"}),d.jsx("option",{value:"EUR",children:"🇪🇺 يورو (EUR)"}),d.jsx("option",{value:"GBP",children:"🇬🇧 جنيه إسترليني (GBP)"}),d.jsx("option",{value:"JOD",children:"🇯🇴 دينار أردني (JOD)"}),d.jsx("option",{value:"KWD",children:"🇰🇼 دينار كويتي (KWD)"}),d.jsx("option",{value:"QAR",children:"🇶🇦 ريال قطري (QAR)"}),d.jsx("option",{value:"BHD",children:"🇧🇭 دينار بحريني (BHD)"}),d.jsx("option",{value:"OMR",children:"🇴🇲 ريال عماني (OMR)"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"smsSamples",className:"block text-sm font-medium text-slate-600 mb-1",children:"الكلمات المفتاحية للرسائل (افصل بفواصل)"}),d.jsx("input",{type:"text",name:"smsSamples",value:((m=l.smsSamples)==null?void 0:m.join(", "))||"",onChange:f,className:"w-full p-2",placeholder:"مثال: Alrajhi, الراجحي, مدى"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"كلمات فريدة من رسائل البنك للمساعدة في التعرف التلقائي عند لصق نص رسالة."})]}),d.jsx("button",{type:"submit",className:"w-full py-3 magical-button text-white font-semibold rounded-lg mt-6",children:t?"حفظ التعديلات":"إضافة الحساب"})]})]})})})},AU=({onClose:n,onSave:e,initialData:t,bankAccounts:i,darkMode:o=!1,language:l="ar"})=>{const[u,f]=de.useState({type:"car",name:"",totalAmount:0,downPayment:0,finalPayment:0,monthlyPayment:0,startDate:new Date().toISOString().split("T")[0],endDate:"",remainingMonths:0,totalMonths:0,lender:"",status:"active",linkedAccount:"",prepaidAmount:0,prepaidInstallments:0}),[g,m]=de.useState({});de.useEffect(()=>{t&&f(t)},[t]),de.useEffect(()=>{if(u.totalAmount>0&&u.downPayment>=0&&u.finalPayment>=0&&u.monthlyPayment>0){const k=u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0);if(k>0){const j=Math.ceil(k/u.monthlyPayment),Y=new Date(u.startDate),O=new Date(Y);O.setMonth(O.getMonth()+j),f(B=>({...B,totalMonths:j,endDate:O.toISOString().split("T")[0],remainingMonths:j}))}}},[u.totalAmount,u.downPayment,u.finalPayment,u.monthlyPayment,u.startDate,u.prepaidAmount]),de.useEffect(()=>{if(u.prepaidAmount&&u.monthlyPayment>0){const k=Math.floor(u.prepaidAmount/u.monthlyPayment);f(j=>({...j,prepaidInstallments:k}))}else f(k=>({...k,prepaidInstallments:0}))},[u.prepaidAmount,u.monthlyPayment]);const T=[{value:"car",label:"سيارة",icon:"🚗"},{value:"house",label:"بيت",icon:"🏠"},{value:"personal",label:"شخصي",icon:"👤"},{value:"business",label:"تجاري",icon:"💼"},{value:"education",label:"تعليمي",icon:"🎓"}],x=k=>{const{name:j,value:Y}=k.target;f(O=>({...O,[j]:j.includes("Amount")||j.includes("Payment")||j.includes("Months")?parseFloat(Y)||0:Y})),g[j]&&m(O=>({...O,[j]:""}))},b=()=>{const k={};return u.name.trim()||(k.name="اسم القرض مطلوب"),u.totalAmount<=0&&(k.totalAmount="المبلغ الإجمالي يجب أن يكون أكبر من صفر"),u.downPayment<0&&(k.downPayment="الدفعة الأولى لا يمكن أن تكون سالبة"),u.finalPayment<0&&(k.finalPayment="الدفعة الأخيرة لا يمكن أن تكون سالبة"),u.monthlyPayment<=0&&(k.monthlyPayment="القسط الشهري يجب أن يكون أكبر من صفر"),u.lender.trim()||(k.lender="اسم البنك أو المؤسسة مطلوب"),u.startDate||(k.startDate="تاريخ بداية القرض مطلوب"),u.downPayment+u.finalPayment>=u.totalAmount&&(k.downPayment="مجموع الدفعة الأولى والأخيرة يجب أن يكون أقل من المبلغ الإجمالي"),m(k),Object.keys(k).length===0},w=k=>{if(k.preventDefault(),!b())return;const j={...u,id:(t==null?void 0:t.id)||`loan-${Date.now()}`,createdAt:(t==null?void 0:t.createdAt)||new Date().toISOString()};e(j)},L=Object.values(i).map(k=>({value:k.id,label:`${k.name} (${k.currency})`}));return d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:n,children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-2xl animate-fade-in max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t?"تعديل القرض":"إضافة قرض جديد"}),d.jsx("button",{onClick:n,className:"text-slate-400 hover:text-slate-600",children:d.jsx(Fu,{})})]}),d.jsxs("form",{onSubmit:w,className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-2",children:"نوع القرض"}),d.jsx("select",{id:"type",name:"type",value:u.type,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:T.map(k=>d.jsxs("option",{value:k.value,children:[k.icon," ",k.label]},k.value))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-2",children:"اسم القرض"}),d.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: قرض سيارة تويوتا",required:!0}),g.name&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.name})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ الإجمالي"}),d.jsx("input",{type:"number",id:"totalAmount",name:"totalAmount",value:u.totalAmount,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.totalAmount&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.totalAmount})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"downPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأولى"}),d.jsx("input",{type:"number",id:"downPayment",name:"downPayment",value:u.downPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.downPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.downPayment})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"finalPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"الدفعة الأخيرة"}),d.jsx("input",{type:"number",id:"finalPayment",name:"finalPayment",value:u.finalPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.finalPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.finalPayment})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"monthlyPayment",className:"block text-sm font-medium text-slate-600 mb-2",children:"القسط الشهري"}),d.jsx("input",{type:"number",id:"monthlyPayment",name:"monthlyPayment",value:u.monthlyPayment,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",required:!0}),g.monthlyPayment&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.monthlyPayment})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"prepaidAmount",className:"block text-sm font-medium text-slate-600 mb-2",children:"المبلغ المدفوع مسبقاً (اختياري)"}),d.jsx("input",{type:"number",id:"prepaidAmount",name:"prepaidAmount",value:u.prepaidAmount||0,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",step:"0.01",min:"0",placeholder:"0"}),d.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"المبلغ الذي تم دفعه قبل إضافة القرض للنظام"}),(u.prepaidAmount||0)>0&&d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mt-2",children:[d.jsxs("p",{className:"text-blue-700 font-semibold text-sm",children:["الأقساط المدفوعة مسبقاً: ",u.prepaidInstallments||0," قسط"]}),d.jsxs("p",{className:"text-blue-600 text-sm",children:["المبلغ المتبقي: ",formatCurrency(u.totalAmount-u.downPayment-u.finalPayment-(u.prepaidAmount||0))," ريال"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ بداية القرض"}),d.jsx("input",{type:"date",id:"startDate",name:"startDate",value:u.startDate,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),g.startDate&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.startDate})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-slate-600 mb-2",children:"تاريخ انتهاء القرض (محسوب تلقائياً)"}),d.jsx("input",{type:"date",id:"endDate",name:"endDate",value:u.endDate||"",className:"w-full p-3 border border-slate-300 rounded-lg bg-gray-50",disabled:!0})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"lender",className:"block text-sm font-medium text-slate-600 mb-2",children:"البنك أو المؤسسة"}),d.jsx("input",{type:"text",id:"lender",name:"lender",value:u.lender,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: البنك الأهلي التجاري",required:!0}),g.lender&&d.jsx("p",{className:"text-red-500 text-sm mt-1",children:g.lender})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"linkedAccount",className:"block text-sm font-medium text-slate-600 mb-2",children:"ربط بالحساب البنكي (اختياري)"}),d.jsxs("select",{id:"linkedAccount",name:"linkedAccount",value:u.linkedAccount,onChange:x,className:"w-full p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"اختر حساب بنكي"}),L.map(k=>d.jsx("option",{value:k.value,children:k.label},k.value))]})]})]}),u.totalMonths>0&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"المعلومات المحسوبة"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة الإجمالية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.totalMonths," شهر"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-blue-700",children:"المدة المتبقية:"}),d.jsxs("span",{className:"font-semibold text-blue-900",children:[" ",u.remainingMonths," شهر"]})]})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition-colors font-medium",children:"إلغاء"}),d.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"حفظ التعديلات":"إضافة القرض"})]})]})]})})})},SU=()=>{var qi,Bi,os,Po,jr;const[n,e]=de.useState(!1),[t,i]=de.useState(ud),[o,l]=de.useState(new Date().getFullYear()),[u,f]=de.useState(new Date().getMonth()+1),[g,m]=de.useState("summary"),[T,x]=de.useState({isLoading:!1,text:""}),[b,w]=de.useState(null),[L,k]=de.useState({isOpen:!1}),[j,Y]=de.useState({isOpen:!1}),[O,B]=de.useState({isOpen:!1}),[ne,ie]=de.useState({isOpen:!1}),[H,N]=de.useState({isOpen:!1}),[C,R]=de.useState({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),[M,V]=de.useState(!1),[F,P]=de.useState(""),[Ue,it]=de.useState(null),[ee,W]=de.useState(!1),[pe,Me]=de.useState(!0);de.useEffect(()=>{(async()=>{mE();const me=await wi.onAuthStateChanged(async he=>{try{he?(console.log("✅ تم تسجيل دخول المستخدم:",he.email),it(he),await Ie(he.uid)):(console.log("❌ لا يوجد مستخدم مسجل دخول"),it(null),await q())}catch(Te){console.error("خطأ في تحميل بيانات المستخدم:",Te),await q()}finally{Me(!1),e(!0)}});return()=>{typeof me=="function"&&me()}})()},[]),de.useEffect(()=>(L.isOpen||j.isOpen||O.isOpen||ne.isOpen||H.isOpen||b||T.isLoading?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open"),()=>{document.body.classList.remove("modal-open")}),[L.isOpen,j.isOpen,O.isOpen,ne.isOpen,H.isOpen,b,T.isLoading]),de.useEffect(()=>{t.settings.darkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const G=document.documentElement;t.settings.language==="ar"?(G.setAttribute("lang","ar"),G.setAttribute("dir","rtl")):(G.setAttribute("lang","en"),G.setAttribute("dir","ltr"))},[t.settings.darkMode,t.settings.language]),de.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(G=>{console.log("Service Worker registered successfully:",G)}).catch(G=>{console.log("Service Worker registration failed:",G)})},[]),de.useEffect(()=>{var G,me;H.isOpen&&C.fromAccount&&C.toAccount&&((G=t.bankAccounts[C.fromAccount])==null?void 0:G.currency)!==((me=t.bankAccounts[C.toAccount])==null?void 0:me.currency)&&en()},[C.fromAccount,C.toAccount,H.isOpen]);const Ie=async G=>{var me;try{const he=await wi.getData("users",G);if(he.success&&he.data){const Te=ud(),De={...Te,...he.data,cards:{...Te.cards,...he.data.cards||{}},bankAccounts:{...Te.bankAccounts,...he.data.bankAccounts||{}},investments:{...Te.investments,...he.data.investments||{}}};i(De),console.log("✅ تم تحميل بيانات المستخدم من Firebase")}else he.success||(console.warn("⚠️ فشل في تحميل بيانات المستخدم من Firebase:",he.error),(me=he.error)!=null&&me.includes("الأذونات")&&w({title:"تحذير - إعداد Firebase",body:`<p>فشل في تحميل البيانات من السحابة. يرجى:</p>
                               <ul>
                                 <li>تأكد من تسجيل الدخول</li>
                                 <li>تحقق من إعداد قواعد Firestore</li>
                                 <li>راجع ملف FIREBASE_SETUP.md للإرشادات</li>
                               </ul>
                               <p>سيتم استخدام البيانات المحلية مؤقتاً.</p>`,confirmText:"موافق",hideCancel:!0}))}catch(he){console.error("خطأ في تحميل بيانات المستخدم:",he)}},q=async()=>{try{let G=localStorage.getItem("financial_dashboard_state");if(G||(G=localStorage.getItem("financial_dashboard_backup_1"),G&&console.log("🔄 تم تحميل البيانات من النسخة الاحتياطية الأولى")),G||(G=localStorage.getItem("financial_dashboard_backup_2"),G&&console.log("🔄 تم تحميل البيانات من النسخة الاحتياطية الثانية")),G){const me=JSON.parse(G),he=ud(),Te={...he,...me,cards:{...he.cards,...me.cards||{}},bankAccounts:{...he.bankAccounts,...me.bankAccounts||{}},investments:{...he.investments,...me.investments||{}}};i(Te),console.log("✅ تم تحميل البيانات بنجاح")}else console.log("ℹ️ لم توجد بيانات محفوظة، سيتم استخدام البيانات الافتراضية")}catch(G){console.error("❌ خطأ في تحميل البيانات المحلية:",G)}};de.useEffect(()=>{if(n&&!pe){try{localStorage.setItem("financial_dashboard_state",JSON.stringify(t)),localStorage.setItem("financial_dashboard_backup_1",JSON.stringify(t)),localStorage.setItem("financial_dashboard_backup_2",JSON.stringify(t)),console.log("✅ تم حفظ البيانات في localStorage مع نسخ احتياطية")}catch(G){console.error("❌ خطأ في حفظ البيانات:",G)}if(Ue){const me=setTimeout(async()=>{try{const he=await wi.saveData("users",Ue.uid,t);he.success?console.log("✅ تم حفظ البيانات في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",he.error)}catch(he){console.error("❌ خطأ في حفظ البيانات في Firebase:",he)}},2e3);return()=>clearTimeout(me)}}},[t,n,Ue,pe]);const oe=(G,me="")=>x({isLoading:G,text:me}),ve=de.useCallback(()=>t.transactions?t.transactions.filter(G=>{const me=new Date(G.date),he=me.getFullYear()===o,Te=u==="all"||me.getMonth()+1===u;return he&&Te}):[],[t.transactions,o,u]),_e=de.useMemo(()=>ve(),[ve]),Ne=de.useMemo(()=>{const G={},me={},he={},Te={};t.cards&&typeof t.cards=="object"&&Object.values(t.cards).forEach(xe=>{xe&&xe.id&&(he[xe.id]={...xe,balance:0,available:xe.limit,usagePercentage:0})}),t.bankAccounts&&typeof t.bankAccounts=="object"&&Object.values(t.bankAccounts).forEach(xe=>{xe&&xe.id&&(Te[xe.id]={...xe,deposits:0,withdrawals:0})});let De=0,Fe=0,Fr=0,ei=0;_e.forEach(xe=>{if(xe.type==="income")De+=xe.amount;else if(xe.type==="expense")Fe+=xe.amount,xe.categoryId&&(G[xe.categoryId]=(G[xe.categoryId]||0)+xe.amount);else if(xe.type==="bnpl-payment")Fe+=xe.amount,xe.categoryId&&(G[xe.categoryId]=(G[xe.categoryId]||0)+xe.amount);else if(xe.type==="investment-deposit")Fr+=xe.amount,Fe+=xe.amount;else if(xe.type==="investment-withdrawal")ei+=xe.amount,De+=xe.amount;else if(xe.type.endsWith("-payment")){const mt=xe.type.replace("-payment","");me[mt]?me[mt]+=xe.amount:me[mt]=xe.amount}}),Object.keys(t.cards).forEach(xe=>{const mt=t.cards[xe];let Ft=0;t.transactions.forEach(An=>{An.paymentMethod===xe&&An.type==="expense"&&(Ft+=An.amount),An.type===`${xe}-payment`&&(Ft-=An.amount)}),he[xe].balance=Ft,he[xe].available=mt.limit-Ft,he[xe].usagePercentage=mt.limit>0?Ft/mt.limit*100:0}),Object.keys(t.bankAccounts).forEach(xe=>{const mt=t.bankAccounts[xe];let Ft=0,An=0,Ss=mt.balance;t.transactions.forEach(Qe=>{Qe.paymentMethod===xe&&(["income","investment-withdrawal"].includes(Qe.type)?Ss+=Qe.amount:["expense","investment-deposit"].includes(Qe.type)&&(Ss-=Qe.amount)),Qe.type.endsWith("-payment")&&Qe.paymentMethod===xe&&(Ss-=Qe.amount),Qe.type==="expense"&&Qe.isInstallmentPayment&&Qe.paymentMethod===xe&&(Ss-=Qe.amount)}),_e.forEach(Qe=>{Qe.paymentMethod===xe&&(["income","investment-withdrawal"].includes(Qe.type)?Ft+=Qe.amount:["expense","investment-deposit"].includes(Qe.type)&&(An+=Qe.amount)),Qe.type.endsWith("-payment")&&Qe.paymentMethod===xe&&(An+=Qe.amount),Qe.type==="expense"&&Qe.isInstallmentPayment&&Qe.paymentMethod===xe&&(An+=Qe.amount)}),Te[xe].balance=Ss,Te[xe].deposits=Ft,Te[xe].withdrawals=An});const ko=Object.values(he).reduce((xe,mt)=>xe+mt.balance,0),Hn=Object.values(he).reduce((xe,mt)=>xe+mt.available,0),ti=Object.values(he).reduce((xe,mt)=>xe+mt.limit,0),Rt=Object.values(Te).reduce((xe,mt)=>xe+mt.balance,0);return{totalIncome:De,totalExpenses:Fe,cardDetails:he,cardPayments:me,bankAccountDetails:Te,totalDebt:ko,totalAvailable:Hn,totalLimits:ti,totalBankBalance:Rt,totalInvestmentDeposits:Fr,totalInvestmentWithdrawals:ei,expensesByCategory:G}},[_e,t.transactions,t.cards,t.bankAccounts]),Oe=(G,me)=>{i(he=>{if(me){const Te=he.transactions.map(De=>De.id===me?{...De,...G}:De);return{...he,transactions:Te}}else if(G.bnplData&&G.paymentMethod.includes("bnpl")){const Te={id:`installment-${Date.now()}`,provider:G.paymentMethod,description:G.description,totalAmount:G.amount,installmentAmount:G.bnplData.installmentAmount,total:G.bnplData.installmentsCount,paid:1,createdAt:G.date},De={id:`trans-${Date.now()}-1`,amount:G.bnplData.installmentAmount,date:G.date,description:`الدفعة الأولى لـ: ${G.description}`,paymentMethod:G.bnplData.initialPaymentSource,type:"expense",categoryId:G.categoryId,isInstallmentPayment:!0,installmentId:Te.id};return{...he,transactions:[...he.transactions,De],installments:[...he.installments,Te]}}else{const Te={id:`trans-${Date.now()}`,...G};return{...he,transactions:[...he.transactions,Te]}}}),k({isOpen:!1})},Ye=G=>{w({title:"تأكيد الحذف",body:"<p>هل أنت متأكد من رغبتك في حذف هذه الحركة؟ لا يمكن التراجع عن هذا الإجراء.</p>",confirmText:"نعم, حذف",onConfirm:()=>{i(me=>{const he=me.transactions.find(Fe=>Fe.id===G);if(!he)return me;const Te=me.transactions.filter(Fe=>Fe.id!==G);let De=me.installments;return he.isInstallmentPayment&&he.installmentId&&(De=me.installments.map(Fe=>Fe.id===he.installmentId?{...Fe,paid:Math.max(0,Fe.paid-1)}:Fe)),{...me,transactions:Te,installments:De}}),w(null)}})},fe=G=>{const me=t.transactions.find(he=>he.id===G);me&&k({isOpen:!0,initialData:me})},ge=async G=>{it(G),W(!1),await Ie(G.uid)},$e=async()=>{try{const G=await wi.signOut();G.success?(console.log("✅ تم تسجيل الخروج بنجاح"),it(null),await q()):console.error("❌ خطأ في تسجيل الخروج:",G.error)}catch(G){console.error("❌ خطأ في تسجيل الخروج:",G)}},Pt=(G,me)=>{i(he=>{const Te={...he.cards};if(me)Te[me]={...Te[me],...G,id:me};else{const De=`card-${Date.now()}`;Te[De]={...G,id:De}}return{...he,cards:Te}}),Y({isOpen:!1})},bn=G=>{var me;t.transactions.some(he=>he.paymentMethod===G||he.type===`${G}-payment`)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذه البطاقة لأنها مستخدمة في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف بطاقة "${(me=t.cards[G])==null?void 0:me.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(he=>{const Te={...he.cards};return delete Te[G],{...he,cards:Te}}),w(null)}})},Pn=(G,me)=>{i(he=>{const Te={...he.bankAccounts};if(me)Te[me]={...Te[me],...G,id:me};else{const De=`bank-${Date.now()}`;Te[De]={...G,id:De}}return{...he,bankAccounts:Te}}),B({isOpen:!1})},_t=G=>{var me;t.transactions.some(he=>he.paymentMethod===G)?w({title:"لا يمكن الحذف",body:"<p>لا يمكن حذف هذا الحساب لأنه مستخدم في بعض الحركات. يرجى تعديل الحركات أولاً.</p>",hideCancel:!0,confirmText:"موافق"}):w({title:"تأكيد الحذف",body:`<p>هل أنت متأكد من رغبتك في حذف حساب "${(me=t.bankAccounts[G])==null?void 0:me.name}"؟</p>`,confirmText:"نعم, حذف",onConfirm:()=>{i(he=>{const Te={...he.bankAccounts};return delete Te[G],{...he,bankAccounts:Te}}),w(null)}})},Xs=G=>{w({title:"استعادة نسخة احتياطية",body:"<p>هل أنت متأكد من استعادة هذه البيانات؟ سيتم استبدال جميع البيانات الحالية.</p>",confirmText:"استعادة",cancelText:"إلغاء",onConfirm:()=>{try{const me=ud();if(G.creditCards&&!G.cards){const Te={};Object.entries(G.creditCards).forEach(([De,Fe])=>{Te[De]={id:De,name:De.toUpperCase(),limit:Fe.creditLimit||0,balance:Fe.currentBalance||0,dueDay:Fe.dueDay||1,smsSamples:[],keywords:[]}}),G.cards=Te}if(G.cards&&typeof G.cards=="object"&&(G.cards.snb||G.cards.enbd)){const Te={};G.cards.snb&&(Te["snb-card"]={id:"snb-card",name:"SNB الأهلي",limit:G.cards.snb.limit||0,dueDay:G.cards.snb.dueDay||1,statementDay:25,smsSamples:["SNB","الأهلي","إئتمانية"]}),G.cards.enbd&&(Te["enbd-card"]={id:"enbd-card",name:"ENBD الإمارات",limit:G.cards.enbd.limit||0,dueDay:G.cards.enbd.dueDay||1,statementDay:28,smsSamples:["ENBD","الإمارات","Visa card"]}),G.cards=Te}G.bank&&!G.bankAccounts&&(G.bankAccounts={"bank-default":{id:"bank-default",name:"حساب البنك",balance:G.bank.balance||0,smsSamples:["مدى","mada","Alrajhi","الراجحي","Inma","الإنماء","بنك"]}}),G.transactions&&Array.isArray(G.transactions)&&(G.transactions=G.transactions.map(Te=>Te.paymentMethod==="mada-bank"?{...Te,paymentMethod:"bank-default"}:Te));const he={...me,...G};i(he),Ue&&(async()=>{try{const De=await wi.saveData("users",Ue.uid,he);De.success?console.log("✅ تم حفظ البيانات المستعادة في Firebase"):console.warn("⚠️ فشل في حفظ البيانات في Firebase:",De.error)}catch(De){console.error("❌ خطأ في حفظ البيانات في Firebase:",De)}})(),w({title:"تم الاستعادة بنجاح",body:"<p>تم استعادة بياناتك بنجاح وحفظها في السحابة.</p>",confirmText:"موافق",hideCancel:!0})}catch{w({title:"خطأ في الاستعادة",body:"<p>حدث خطأ أثناء استعادة البيانات. يرجى المحاولة مرة أخرى.</p>",confirmText:"موافق",hideCancel:!0})}}})},Ws=G=>Y({isOpen:!0,initialData:G?t.cards[G]:null}),Ur=G=>B({isOpen:!0,initialData:G?t.bankAccounts[G]:null}),Or=G=>ie({isOpen:!0,initialData:G?t.loans[G]:null}),Nt=()=>{i(G=>({...G,settings:{...G.settings,darkMode:!G.settings.darkMode}}))},kt=()=>{i(G=>({...G,settings:{...G.settings,notifications:!G.settings.notifications}}))},As=()=>{i(G=>({...G,settings:{...G.settings,language:G.settings.language==="ar"?"en":"ar"}}))},il=()=>{if(!C.fromAccount||!C.toAccount||C.amount<=0){w({title:"خطأ",body:"<p>يرجى ملء جميع البيانات بشكل صحيح.</p>",hideCancel:!0,confirmText:"موافق"});return}if(C.fromAccount===C.toAccount){w({title:"خطأ",body:"<p>لا يمكن التحويل لنفس الحساب.</p>",hideCancel:!0,confirmText:"موافق"});return}const G=t.bankAccounts[C.fromAccount],me=t.bankAccounts[C.toAccount],he=C.amount*C.exchangeRate,Te={id:`trans-${Date.now()}-withdrawal`,amount:C.amount,date:new Date().toISOString().split("T")[0],description:`تحويل إلى ${(me==null?void 0:me.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.fromAccount,type:"expense",categoryId:null},De={id:`trans-${Date.now()}-deposit`,amount:he,date:new Date().toISOString().split("T")[0],description:`تحويل من ${(G==null?void 0:G.name)||"حساب آخر"}: ${C.description}${C.exchangeRate!==1?` (معدل: ${C.exchangeRate})`:""}`,paymentMethod:C.toAccount,type:"income",categoryId:null};i(Fe=>({...Fe,transactions:[...Fe.transactions,Te,De]})),N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),P(""),w({title:"نجح التحويل",body:"<p>تم التحويل بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},Do=G=>{if(i(me=>({...me,loans:{...me.loans,[G.id]:G}})),!G.id.includes("edit")){const me=[];G.downPayment>0&&me.push({id:`trans-${Date.now()}-down-payment`,amount:G.downPayment,date:G.startDate,description:`دفعة أولى - ${G.name}`,paymentMethod:G.linkedAccount||"cash",type:"expense",categoryId:null}),me.push({id:`trans-${Date.now()}-loan-deposit`,amount:G.totalAmount,date:G.startDate,description:`إيداع قرض - ${G.name} من ${G.lender}`,paymentMethod:G.linkedAccount||"cash",type:"income",categoryId:null}),G.finalPayment>0&&G.endDate&&me.push({id:`trans-${Date.now()}-final-payment`,amount:G.finalPayment,date:G.endDate,description:`دفعة أخيرة - ${G.name}`,paymentMethod:G.linkedAccount||"cash",type:"expense",categoryId:null}),i(he=>({...he,transactions:[...he.transactions,...me]}))}ie({isOpen:!1}),w({title:"تم إضافة القرض بنجاح",body:"<p>تم إضافة القرض والحركات المرتبطة به بنجاح!</p>",hideCancel:!0,confirmText:"موافق"})},en=async()=>{if(!C.fromAccount||!C.toAccount)return;const G=t.bankAccounts[C.fromAccount],me=t.bankAccounts[C.toAccount];if(!G||!me)return;const he=G.currency||"SAR",Te=me.currency||"SAR";if(he===Te){R(De=>({...De,exchangeRate:1})),P("");return}V(!0),P("");try{const De=await _E(he,Te);R(Fe=>({...Fe,exchangeRate:De.rate}))}catch(De){P(De instanceof Error?De.message:"فشل في الحصول على معدل التحويل"),console.error("Exchange rate error:",De)}finally{V(!1)}};if(!n||pe)return d.jsx(sU,{});if(!Ue)return d.jsx("div",{className:"bg-slate-100 min-h-screen font-sans flex items-center justify-center",children:d.jsxs("div",{className:"w-full max-w-md px-4",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"w-16 h-16 bg-blue-500/10 rounded-2xl flex items-center justify-center text-3xl mx-auto mb-4",children:"💰"}),d.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"لوحة التحكم المالية"}),d.jsx("p",{className:"text-slate-600 mt-2",children:"قم بتسجيل الدخول للوصول لنظام إدارة المصاريف"})]}),d.jsx(Ox,{onSuccess:ge,onClose:()=>{},hideCloseButton:!0})]})});`${o}${u==="all"?"كل الشهور":new Date(o,u-1).toLocaleString("ar-SA",{month:"long"})}`;const Zs=()=>{switch(g){case"summary":return d.jsx(oU,{calculations:Ne,categories:t.categories,darkMode:t.settings.darkMode,language:t.settings.language});case"transactions":return d.jsx(aU,{transactions:_e,allTransactions:t.transactions,categories:t.categories,deleteTransaction:Ye,editTransaction:fe,state:t,darkMode:t.settings.darkMode,language:t.settings.language});case"ai-assistant":return d.jsx(uU,{calculations:Ne,filteredTransactions:_e,darkMode:t.settings.darkMode,language:t.settings.language});case"analysis":return d.jsx(cU,{calculations:Ne,categories:t.categories,allTransactions:t.transactions,darkMode:t.settings.darkMode,language:t.settings.language});case"budget":return d.jsx(dU,{state:t,setLoading:oe,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"investment":return d.jsx(fU,{state:t,setState:i,calculations:Ne,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"cards":return d.jsx(mU,{state:t,openCardFormModal:Ws,deleteCard:bn,darkMode:t.settings.darkMode,language:t.settings.language});case"bank":return d.jsx(yU,{state:t,setState:i,calculations:Ne,filteredTransactions:_e,categories:t.categories,setModal:w,openBankAccountFormModal:Ur,deleteBankAccount:_t,openTransferModal:()=>N({isOpen:!0}),darkMode:t.settings.darkMode,language:t.settings.language});case"installments":return d.jsx(vU,{state:t,setState:i,filteredTransactions:_e,setModal:w,darkMode:t.settings.darkMode,language:t.settings.language});case"debts-loans":return d.jsx(_U,{state:t,setState:i,setModal:w,openLoanFormModal:Or,darkMode:t.settings.darkMode,language:t.settings.language});case"settings":return d.jsx(TU,{state:t,setState:i,setModal:w,setLoading:oe,onRestore:Xs,darkMode:t.settings.darkMode,language:t.settings.language});default:return d.jsx("div",{children:"Tab not found"})}};return d.jsxs("div",{className:`min-h-screen font-sans ${t.settings.darkMode?"dark":""}`,children:[d.jsx(Z4,{selectedYear:o,selectedMonth:u,onYearChange:l,onMonthChange:G=>f(G),onAddTransaction:()=>k({isOpen:!0}),currentUser:Ue,onSignOut:$e,language:t.settings.language}),d.jsx("div",{className:`backdrop-blur-sm border-b p-4 ${t.settings.darkMode?"bg-slate-800/80 border-slate-700":"bg-white/80 border-slate-200"}`,children:d.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:`text-sm font-medium ${t.settings.darkMode?"text-slate-200":"text-slate-700"}`,children:se("dark.mode",t.settings.language)}),d.jsx(QC,{darkMode:t.settings.darkMode,onToggle:Nt})]}),d.jsx(WC,{notifications:t.settings.notifications,onToggle:kt,language:t.settings.language})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:As,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${t.settings.darkMode?"bg-slate-700 hover:bg-slate-600 text-slate-200":"bg-blue-100 hover:bg-blue-200 text-slate-700"}`,children:[d.jsx("span",{className:"text-sm font-medium",children:se("language",t.settings.language)}),d.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${t.settings.darkMode?"bg-blue-500":"bg-blue-600"}`,children:d.jsx("span",{className:"text-white font-bold text-xs",children:t.settings.language==="ar"?"A":"E"})})]})})]})}),d.jsxs("main",{className:"container mx-auto px-2 sm:px-4 max-w-7xl mt-8 mb-20",children:[d.jsx(tU,{activeTab:g,setActiveTab:m,language:t.settings.language}),Zs()]}),d.jsx("button",{onClick:()=>k({isOpen:!0}),className:"md:hidden fixed bottom-24 right-4 bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center z-40 text-2xl",children:"+"}),L.isOpen&&d.jsx(xU,{onClose:()=>k({isOpen:!1}),onSave:Oe,initialData:L.initialData,categories:t.categories,cards:t.cards,bankAccounts:t.bankAccounts,loans:t.loans,setModalConfig:w,darkMode:t.settings.darkMode,language:t.settings.language}),j.isOpen&&d.jsx(EU,{onClose:()=>Y({isOpen:!1}),onSave:Pt,initialData:j.initialData}),O.isOpen&&d.jsx(bU,{onClose:()=>B({isOpen:!1}),onSave:Pn,initialData:O.initialData}),ne.isOpen&&d.jsx(AU,{onClose:()=>ie({isOpen:!1}),onSave:Do,initialData:ne.initialData,bankAccounts:t.bankAccounts}),H.isOpen&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),P("")},children:d.jsx("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto",onClick:G=>G.stopPropagation(),children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"💸 تحويل بين الحسابات"}),d.jsx("button",{onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),P("")},className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"fromAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"من الحساب"}),d.jsxs("select",{id:"fromAccount",name:"fromAccount",value:C.fromAccount,onChange:G=>R(me=>({...me,fromAccount:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب المصدر"}),Object.entries(t.bankAccounts).map(([G,me])=>d.jsx("option",{value:G,children:me.name},G))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"toAccount",className:"block text-sm font-medium text-slate-600 mb-1",children:"إلى الحساب"}),d.jsxs("select",{id:"toAccount",name:"toAccount",value:C.toAccount,onChange:G=>R(me=>({...me,toAccount:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"اختر الحساب الهدف"}),Object.entries(t.bankAccounts).filter(([G])=>G!==C.fromAccount).map(([G,me])=>d.jsx("option",{value:G,children:me.name},G))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:"المبلغ"}),d.jsx("input",{type:"number",id:"amount",name:"amount",step:"0.01",value:C.amount,onChange:G=>R(me=>({...me,amount:parseFloat(G.target.value)||0})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00",required:!0})]}),C.fromAccount&&C.toAccount&&((qi=t.bankAccounts[C.fromAccount])==null?void 0:qi.currency)!==((Bi=t.bankAccounts[C.toAccount])==null?void 0:Bi.currency)&&d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["💱 معدل التحويل (",(os=t.bankAccounts[C.fromAccount])==null?void 0:os.currency," → ",(Po=t.bankAccounts[C.toAccount])==null?void 0:Po.currency,")"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"number",step:"0.0001",value:C.exchangeRate,onChange:G=>R(me=>({...me,exchangeRate:parseFloat(G.target.value)||1})),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0000"}),d.jsxs("button",{type:"button",onClick:en,disabled:M,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2",title:"تحديث معدل التحويل تلقائياً",children:[M?d.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):"🔄",d.jsx("span",{className:"hidden sm:inline",children:"تحديث"})]})]}),F&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:F}),d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["المبلغ المحول: ",(C.amount*C.exchangeRate).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})," ",(jr=t.bankAccounts[C.toAccount])==null?void 0:jr.currency]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-slate-600 mb-1",children:"الوصف (اختياري)"}),d.jsx("input",{type:"text",id:"description",name:"description",value:C.description,onChange:G=>R(me=>({...me,description:G.target.value})),className:"w-full p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"مثل: تحويل للطوارئ"})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[d.jsx("button",{type:"button",onClick:()=>{N({isOpen:!1}),R({fromAccount:"",toAccount:"",amount:0,description:"",exchangeRate:1}),P("")},className:"px-4 py-2 bg-slate-200 rounded-lg hover:bg-slate-300 transition-colors",children:"إلغاء"}),d.jsx("button",{type:"button",onClick:il,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"تحويل"})]})]})})}),b&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex items-center justify-center p-4",onClick:()=>w(null),children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:G=>G.stopPropagation(),children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:b.title}),d.jsx("div",{className:"text-slate-600",dangerouslySetInnerHTML:{__html:b.body}}),d.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[!b.hideCancel&&d.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 bg-slate-200 rounded-lg",children:"إلغاء"}),d.jsx("button",{onClick:()=>{(!b.onConfirm||b.onConfirm()!==!1)&&w(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:b.confirmText||"موافق"})]})]})}),T.isLoading&&d.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[10001] flex flex-col items-center justify-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"}),d.jsx("p",{className:"text-white mt-4",children:T.text||"جاري التحميل..."})]}),ee&&Ue&&d.jsx(Ox,{onSuccess:ge,onClose:()=>W(!1)})]})},lS=document.getElementById("root");if(!lS)throw new Error("Could not find root element");const CU=KC.createRoot(lS);CU.render(d.jsx(wp.StrictMode,{children:d.jsx(SU,{})}));
